{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7011748102449236, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.264917366845268, "policy_loss": 0.004273923447542878, "vf_loss": 6.252891499655587, "vf_explained_var": 0.0005059726969905632, "kl": 0.03875960777144111, "entropy": 1.6011719077352493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1139735017977064, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.897976631083816, "policy_loss": -0.0047660523431779685, "vf_loss": 6.899220468379833, "vf_explained_var": -0.0007991032941000802, "kl": 0.017611140468054346, "entropy": 1.6047323842528005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 59.0, "episode_reward_min": -1977.0, "episode_reward_mean": -570.2222222222222, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -1841.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 69.0, "predator_policy": 895.0}, "policy_reward_mean": {"prey_policy": -568.0277777777778, "predator_policy": 282.9166666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-688.0, -170.0, -442.0, -552.0, -688.0, -417.0, -1977.0, -564.0, -412.0, -1201.0, -567.0, 59.0, -997.0, -211.0, -150.0, -189.0, -573.0, -525.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-542.0, -946.0, -60.0, -560.0, -308.0, -359.0, -340.0, -847.0, -1414.0, 6.0, -867.0, 0.0, -1366.0, -1841.0, -228.0, -1186.0, -444.0, -533.0, -916.0, -820.0, -1253.0, -369.0, 69.0, -25.0, -182.0, -1770.0, -442.0, -84.0, -50.0, -250.0, 21.0, -425.0, -50.0, -1058.0, -720.0, -290.0], "policy_predator_policy_reward": [395.0, 405.0, 190.0, 260.0, 110.0, 115.0, 430.0, 205.0, 0.0, 720.0, 0.0, 450.0, 335.0, 895.0, 350.0, 500.0, 215.0, 350.0, 525.0, 10.0, 490.0, 565.0, 0.0, 15.0, 90.0, 865.0, 275.0, 40.0, 0.0, 150.0, 155.0, 60.0, 535.0, 0.0, 30.0, 455.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7227711391832852, "mean_inference_ms": 1.6579031325614306, "mean_action_processing_ms": 0.286916313716609, "mean_env_wait_ms": 0.2184442925150062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007279713948567708, "StateBufferConnector_ms": 0.0038637055291069877, "ViewRequirementAgentConnector_ms": 0.12697643703884548}, "num_episodes": 18, "episode_return_max": 59.0, "episode_return_min": -1977.0, "episode_return_mean": -570.2222222222222, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.46176412682526, "num_env_steps_trained_throughput_per_sec": 82.46176412682526, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 48507.338, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48507.295, "sample_time_ms": 1387.507, "learn_time_ms": 47106.559, "learn_throughput": 84.914, "synch_weights_time_ms": 11.813}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-36-50", "timestamp": 1723498610, "time_this_iter_s": 48.52108311653137, "time_total_s": 48.52108311653137, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a85eff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.52108311653137, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.93857142857143, "ram_util_percent": 82.32714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7525198517968414, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5612780563415045, "policy_loss": -0.011810032963240272, "vf_loss": 5.5714688530674685, "vf_explained_var": 6.12664159643587e-05, "kl": 0.00539749360830423, "entropy": 1.5918439252666696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4282274911327968, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.478618925336807, "policy_loss": -0.016173358088625328, "vf_loss": 7.49272776104155, "vf_explained_var": -0.0012907705294392096, "kl": 0.010322640977229142, "entropy": 1.5886919951943494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 59.0, "episode_reward_min": -1977.0, "episode_reward_mean": -499.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -1841.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 69.0, "predator_policy": 895.0}, "policy_reward_mean": {"prey_policy": -509.52777777777777, "predator_policy": 259.65277777777777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-688.0, -170.0, -442.0, -552.0, -688.0, -417.0, -1977.0, -564.0, -412.0, -1201.0, -567.0, 59.0, -997.0, -211.0, -150.0, -189.0, -573.0, -525.0, -484.0, -480.0, -689.0, -661.0, -190.0, -199.0, -749.0, -266.0, -189.0, -324.0, -150.0, -758.0, 48.0, -833.0, -241.0, -15.0, -670.0, -877.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-542.0, -946.0, -60.0, -560.0, -308.0, -359.0, -340.0, -847.0, -1414.0, 6.0, -867.0, 0.0, -1366.0, -1841.0, -228.0, -1186.0, -444.0, -533.0, -916.0, -820.0, -1253.0, -369.0, 69.0, -25.0, -182.0, -1770.0, -442.0, -84.0, -50.0, -250.0, 21.0, -425.0, -50.0, -1058.0, -720.0, -290.0, -231.0, -593.0, -276.0, -1159.0, -670.0, -639.0, -1181.0, -240.0, -230.0, -210.0, -255.0, -144.0, -820.0, -649.0, -551.0, 0.0, -660.0, 46.0, -69.0, -525.0, -105.0, -265.0, -439.0, -949.0, 0.0, 48.0, -784.0, -854.0, -131.0, -490.0, 0.0, -80.0, -789.0, -571.0, -1446.0, -326.0], "policy_predator_policy_reward": [395.0, 405.0, 190.0, 260.0, 110.0, 115.0, 430.0, 205.0, 0.0, 720.0, 0.0, 450.0, 335.0, 895.0, 350.0, 500.0, 215.0, 350.0, 525.0, 10.0, 490.0, 565.0, 0.0, 15.0, 90.0, 865.0, 275.0, 40.0, 0.0, 150.0, 155.0, 60.0, 535.0, 0.0, 30.0, 455.0, 0.0, 340.0, 550.0, 405.0, 395.0, 225.0, 545.0, 215.0, 55.0, 195.0, 0.0, 200.0, 225.0, 495.0, 0.0, 285.0, 90.0, 335.0, 0.0, 270.0, 60.0, 160.0, 485.0, 145.0, 0.0, 0.0, 450.0, 355.0, 0.0, 380.0, 0.0, 65.0, 335.0, 355.0, 750.0, 145.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7253425616898669, "mean_inference_ms": 1.652475384010206, "mean_action_processing_ms": 0.28489983046078343, "mean_env_wait_ms": 0.21966683800116346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007023413976033528, "StateBufferConnector_ms": 0.005331635475158691, "ViewRequirementAgentConnector_ms": 0.13996627595689562}, "num_episodes": 18, "episode_return_max": 59.0, "episode_return_min": -1977.0, "episode_return_mean": -499.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.3506451859054, "num_env_steps_trained_throughput_per_sec": 81.3506451859054, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 48838.604, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48838.561, "sample_time_ms": 1371.771, "learn_time_ms": 47445.801, "learn_throughput": 84.307, "synch_weights_time_ms": 17.851}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-37-42", "timestamp": 1723498662, "time_this_iter_s": 49.20853924751282, "time_total_s": 97.72962236404419, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8875790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 97.72962236404419, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.549315068493144, "ram_util_percent": 82.92191780821916}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9857072305269342, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.411226527400748, "policy_loss": -0.014763926207728525, "vf_loss": 6.423103014375798, "vf_explained_var": 0.0004383158431482063, "kl": 0.00962473715404491, "entropy": 1.578258955730963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6477967815109031, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.18586766631515, "policy_loss": -0.012591067836595275, "vf_loss": 7.196344991714235, "vf_explained_var": -0.0017014094130702751, "kl": 0.010568791340202579, "entropy": 1.5698562352114884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 102.0, "episode_reward_min": -1977.0, "episode_reward_mean": -492.037037037037, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -513.7037037037037, "predator_policy": 267.68518518518516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-688.0, -170.0, -442.0, -552.0, -688.0, -417.0, -1977.0, -564.0, -412.0, -1201.0, -567.0, 59.0, -997.0, -211.0, -150.0, -189.0, -573.0, -525.0, -484.0, -480.0, -689.0, -661.0, -190.0, -199.0, -749.0, -266.0, -189.0, -324.0, -150.0, -758.0, 48.0, -833.0, -241.0, -15.0, -670.0, -877.0, -119.0, -509.0, -853.0, -151.0, -182.0, -1283.0, -15.0, -88.0, -528.0, -533.0, -1002.0, -1088.0, -841.0, -57.0, -884.0, -552.0, 4.0, 102.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-542.0, -946.0, -60.0, -560.0, -308.0, -359.0, -340.0, -847.0, -1414.0, 6.0, -867.0, 0.0, -1366.0, -1841.0, -228.0, -1186.0, -444.0, -533.0, -916.0, -820.0, -1253.0, -369.0, 69.0, -25.0, -182.0, -1770.0, -442.0, -84.0, -50.0, -250.0, 21.0, -425.0, -50.0, -1058.0, -720.0, -290.0, -231.0, -593.0, -276.0, -1159.0, -670.0, -639.0, -1181.0, -240.0, -230.0, -210.0, -255.0, -144.0, -820.0, -649.0, -551.0, 0.0, -660.0, 46.0, -69.0, -525.0, -105.0, -265.0, -439.0, -949.0, 0.0, 48.0, -784.0, -854.0, -131.0, -490.0, 0.0, -80.0, -789.0, -571.0, -1446.0, -326.0, -112.0, -267.0, -790.0, -309.0, -1265.0, -493.0, -428.0, 17.0, -640.0, 23.0, -983.0, -1380.0, -30.0, 0.0, 26.0, -234.0, -760.0, -323.0, -1048.0, -145.0, -787.0, -1280.0, -1143.0, -1210.0, -86.0, -1940.0, 45.0, -452.0, -530.0, -909.0, -137.0, -1330.0, 0.0, 4.0, 78.0, 24.0], "policy_predator_policy_reward": [395.0, 405.0, 190.0, 260.0, 110.0, 115.0, 430.0, 205.0, 0.0, 720.0, 0.0, 450.0, 335.0, 895.0, 350.0, 500.0, 215.0, 350.0, 525.0, 10.0, 490.0, 565.0, 0.0, 15.0, 90.0, 865.0, 275.0, 40.0, 0.0, 150.0, 155.0, 60.0, 535.0, 0.0, 30.0, 455.0, 0.0, 340.0, 550.0, 405.0, 395.0, 225.0, 545.0, 215.0, 55.0, 195.0, 0.0, 200.0, 225.0, 495.0, 0.0, 285.0, 90.0, 335.0, 0.0, 270.0, 60.0, 160.0, 485.0, 145.0, 0.0, 0.0, 450.0, 355.0, 0.0, 380.0, 0.0, 65.0, 335.0, 355.0, 750.0, 145.0, 260.0, 0.0, 115.0, 475.0, 650.0, 255.0, 65.0, 195.0, 115.0, 320.0, 565.0, 515.0, 0.0, 15.0, 0.0, 120.0, 105.0, 450.0, 525.0, 135.0, 585.0, 480.0, 550.0, 715.0, 225.0, 960.0, 195.0, 155.0, 80.0, 475.0, 295.0, 620.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7221731130794027, "mean_inference_ms": 1.6362190148285276, "mean_action_processing_ms": 0.2812353799972225, "mean_env_wait_ms": 0.216644772647957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006747908062405056, "StateBufferConnector_ms": 0.004548496670193142, "ViewRequirementAgentConnector_ms": 0.12568698989020455}, "num_episodes": 18, "episode_return_max": 102.0, "episode_return_min": -1977.0, "episode_return_mean": -492.037037037037, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.35339112912419, "num_env_steps_trained_throughput_per_sec": 78.35339112912419, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 49575.993, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49575.918, "sample_time_ms": 1348.3, "learn_time_ms": 48207.26, "learn_throughput": 82.975, "synch_weights_time_ms": 16.756}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-38-33", "timestamp": 1723498713, "time_this_iter_s": 51.08688402175903, "time_total_s": 148.81650638580322, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8815a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 148.81650638580322, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.165753424657538, "ram_util_percent": 83.19041095890411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9363123993394236, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4061559394553855, "policy_loss": -0.017117223084938748, "vf_loss": 6.419289250348611, "vf_explained_var": 0.00019059228518652536, "kl": 0.01327969620966391, "entropy": 1.5600658242033902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4317994381857928, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.871313356722474, "policy_loss": -0.01060358319756767, "vf_loss": 6.880664300666284, "vf_explained_var": -0.0038029946347393055, "kl": 0.006263264066038264, "entropy": 1.5558239840325856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 102.0, "episode_reward_min": -1977.0, "episode_reward_mean": -508.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -521.3958333333334, "predator_policy": 267.3958333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-688.0, -170.0, -442.0, -552.0, -688.0, -417.0, -1977.0, -564.0, -412.0, -1201.0, -567.0, 59.0, -997.0, -211.0, -150.0, -189.0, -573.0, -525.0, -484.0, -480.0, -689.0, -661.0, -190.0, -199.0, -749.0, -266.0, -189.0, -324.0, -150.0, -758.0, 48.0, -833.0, -241.0, -15.0, -670.0, -877.0, -119.0, -509.0, -853.0, -151.0, -182.0, -1283.0, -15.0, -88.0, -528.0, -533.0, -1002.0, -1088.0, -841.0, -57.0, -884.0, -552.0, 4.0, 102.0, -735.0, -70.0, -330.0, -1332.0, -537.0, -789.0, -493.0, 85.0, -534.0, -928.0, -522.0, -1028.0, -372.0, -928.0, -310.0, -1035.0, -149.0, 1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-542.0, -946.0, -60.0, -560.0, -308.0, -359.0, -340.0, -847.0, -1414.0, 6.0, -867.0, 0.0, -1366.0, -1841.0, -228.0, -1186.0, -444.0, -533.0, -916.0, -820.0, -1253.0, -369.0, 69.0, -25.0, -182.0, -1770.0, -442.0, -84.0, -50.0, -250.0, 21.0, -425.0, -50.0, -1058.0, -720.0, -290.0, -231.0, -593.0, -276.0, -1159.0, -670.0, -639.0, -1181.0, -240.0, -230.0, -210.0, -255.0, -144.0, -820.0, -649.0, -551.0, 0.0, -660.0, 46.0, -69.0, -525.0, -105.0, -265.0, -439.0, -949.0, 0.0, 48.0, -784.0, -854.0, -131.0, -490.0, 0.0, -80.0, -789.0, -571.0, -1446.0, -326.0, -112.0, -267.0, -790.0, -309.0, -1265.0, -493.0, -428.0, 17.0, -640.0, 23.0, -983.0, -1380.0, -30.0, 0.0, 26.0, -234.0, -760.0, -323.0, -1048.0, -145.0, -787.0, -1280.0, -1143.0, -1210.0, -86.0, -1940.0, 45.0, -452.0, -530.0, -909.0, -137.0, -1330.0, 0.0, 4.0, 78.0, 24.0, -860.0, -600.0, -210.0, 0.0, -260.0, -200.0, -460.0, -1757.0, -276.0, -1256.0, -909.0, -470.0, -208.0, -950.0, 61.0, 24.0, -556.0, -453.0, -828.0, -1030.0, -1052.0, -130.0, -1113.0, -940.0, -520.0, -117.0, -1040.0, -768.0, -160.0, -470.0, -979.0, -721.0, -46.0, -348.0, 1.0, 0.0], "policy_predator_policy_reward": [395.0, 405.0, 190.0, 260.0, 110.0, 115.0, 430.0, 205.0, 0.0, 720.0, 0.0, 450.0, 335.0, 895.0, 350.0, 500.0, 215.0, 350.0, 525.0, 10.0, 490.0, 565.0, 0.0, 15.0, 90.0, 865.0, 275.0, 40.0, 0.0, 150.0, 155.0, 60.0, 535.0, 0.0, 30.0, 455.0, 0.0, 340.0, 550.0, 405.0, 395.0, 225.0, 545.0, 215.0, 55.0, 195.0, 0.0, 200.0, 225.0, 495.0, 0.0, 285.0, 90.0, 335.0, 0.0, 270.0, 60.0, 160.0, 485.0, 145.0, 0.0, 0.0, 450.0, 355.0, 0.0, 380.0, 0.0, 65.0, 335.0, 355.0, 750.0, 145.0, 260.0, 0.0, 115.0, 475.0, 650.0, 255.0, 65.0, 195.0, 115.0, 320.0, 565.0, 515.0, 0.0, 15.0, 0.0, 120.0, 105.0, 450.0, 525.0, 135.0, 585.0, 480.0, 550.0, 715.0, 225.0, 960.0, 195.0, 155.0, 80.0, 475.0, 295.0, 620.0, 0.0, 0.0, 0.0, 0.0, 425.0, 300.0, 110.0, 30.0, 130.0, 0.0, 0.0, 885.0, 510.0, 485.0, 335.0, 255.0, 615.0, 50.0, 0.0, 0.0, 315.0, 160.0, 515.0, 415.0, 440.0, 220.0, 375.0, 650.0, 40.0, 225.0, 355.0, 525.0, 275.0, 45.0, 55.0, 610.0, 185.0, 60.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7187174912918263, "mean_inference_ms": 1.6129425751456052, "mean_action_processing_ms": 0.2771969850311187, "mean_env_wait_ms": 0.21354184022362047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006728370984395345, "StateBufferConnector_ms": 0.004241367181142171, "ViewRequirementAgentConnector_ms": 0.12730161348978677}, "num_episodes": 18, "episode_return_max": 102.0, "episode_return_min": -1977.0, "episode_return_mean": -508.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.25968308714101, "num_env_steps_trained_throughput_per_sec": 82.25968308714101, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 49338.62, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49338.553, "sample_time_ms": 1321.704, "learn_time_ms": 47996.645, "learn_throughput": 83.339, "synch_weights_time_ms": 16.945}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-39-21", "timestamp": 1723498761, "time_this_iter_s": 48.656378984451294, "time_total_s": 197.47288537025452, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a887c310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 197.47288537025452, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.627536231884058, "ram_util_percent": 82.98695652173912}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.144664556008798, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.868268416167567, "policy_loss": -0.017429832773401387, "vf_loss": 7.882253180357514, "vf_explained_var": -0.0005170746770485369, "kl": 0.011483589804577787, "entropy": 1.5462037044858175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.007474284323435, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.074842800665154, "policy_loss": -0.011499445342271535, "vf_loss": 8.08487027889837, "vf_explained_var": -0.0024469003160163838, "kl": 0.007359924505488604, "entropy": 1.538737441307653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 102.0, "episode_reward_min": -1977.0, "episode_reward_mean": -553.4040404040404, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -567.1060606060606, "predator_policy": 290.4040404040404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-688.0, -170.0, -442.0, -552.0, -688.0, -417.0, -1977.0, -564.0, -412.0, -1201.0, -567.0, 59.0, -997.0, -211.0, -150.0, -189.0, -573.0, -525.0, -484.0, -480.0, -689.0, -661.0, -190.0, -199.0, -749.0, -266.0, -189.0, -324.0, -150.0, -758.0, 48.0, -833.0, -241.0, -15.0, -670.0, -877.0, -119.0, -509.0, -853.0, -151.0, -182.0, -1283.0, -15.0, -88.0, -528.0, -533.0, -1002.0, -1088.0, -841.0, -57.0, -884.0, -552.0, 4.0, 102.0, -735.0, -70.0, -330.0, -1332.0, -537.0, -789.0, -493.0, 85.0, -534.0, -928.0, -522.0, -1028.0, -372.0, -928.0, -310.0, -1035.0, -149.0, 1.0, -535.0, -1215.0, -886.0, -270.0, -642.0, -801.0, -30.0, -19.0, -1233.0, -78.0, -1659.0, -649.0, -700.0, -971.0, -164.0, -1670.0, -487.0, -503.0, -532.0, -460.0, -400.0, -838.0, -334.0, -340.0, -205.0, -1600.0, -990.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-542.0, -946.0, -60.0, -560.0, -308.0, -359.0, -340.0, -847.0, -1414.0, 6.0, -867.0, 0.0, -1366.0, -1841.0, -228.0, -1186.0, -444.0, -533.0, -916.0, -820.0, -1253.0, -369.0, 69.0, -25.0, -182.0, -1770.0, -442.0, -84.0, -50.0, -250.0, 21.0, -425.0, -50.0, -1058.0, -720.0, -290.0, -231.0, -593.0, -276.0, -1159.0, -670.0, -639.0, -1181.0, -240.0, -230.0, -210.0, -255.0, -144.0, -820.0, -649.0, -551.0, 0.0, -660.0, 46.0, -69.0, -525.0, -105.0, -265.0, -439.0, -949.0, 0.0, 48.0, -784.0, -854.0, -131.0, -490.0, 0.0, -80.0, -789.0, -571.0, -1446.0, -326.0, -112.0, -267.0, -790.0, -309.0, -1265.0, -493.0, -428.0, 17.0, -640.0, 23.0, -983.0, -1380.0, -30.0, 0.0, 26.0, -234.0, -760.0, -323.0, -1048.0, -145.0, -787.0, -1280.0, -1143.0, -1210.0, -86.0, -1940.0, 45.0, -452.0, -530.0, -909.0, -137.0, -1330.0, 0.0, 4.0, 78.0, 24.0, -860.0, -600.0, -210.0, 0.0, -260.0, -200.0, -460.0, -1757.0, -276.0, -1256.0, -909.0, -470.0, -208.0, -950.0, 61.0, 24.0, -556.0, -453.0, -828.0, -1030.0, -1052.0, -130.0, -1113.0, -940.0, -520.0, -117.0, -1040.0, -768.0, -160.0, -470.0, -979.0, -721.0, -46.0, -348.0, 1.0, 0.0, -10.0, -1110.0, -1395.0, -880.0, -880.0, -1351.0, -107.0, -683.0, 0.0, -1287.0, -1020.0, -661.0, 0.0, -75.0, -130.0, 21.0, -823.0, -1680.0, 8.0, -231.0, -1499.0, -1700.0, -190.0, -1194.0, -292.0, -1293.0, -1120.0, -926.0, -589.0, 0.0, -1470.0, -1360.0, -748.0, -324.0, -210.0, -743.0, -442.0, -470.0, -380.0, -370.0, -260.0, -510.0, -914.0, -494.0, -629.0, -135.0, -1030.0, -10.0, 0.0, -670.0, -1230.0, -1370.0, -610.0, -1730.0], "policy_predator_policy_reward": [395.0, 405.0, 190.0, 260.0, 110.0, 115.0, 430.0, 205.0, 0.0, 720.0, 0.0, 450.0, 335.0, 895.0, 350.0, 500.0, 215.0, 350.0, 525.0, 10.0, 490.0, 565.0, 0.0, 15.0, 90.0, 865.0, 275.0, 40.0, 0.0, 150.0, 155.0, 60.0, 535.0, 0.0, 30.0, 455.0, 0.0, 340.0, 550.0, 405.0, 395.0, 225.0, 545.0, 215.0, 55.0, 195.0, 0.0, 200.0, 225.0, 495.0, 0.0, 285.0, 90.0, 335.0, 0.0, 270.0, 60.0, 160.0, 485.0, 145.0, 0.0, 0.0, 450.0, 355.0, 0.0, 380.0, 0.0, 65.0, 335.0, 355.0, 750.0, 145.0, 260.0, 0.0, 115.0, 475.0, 650.0, 255.0, 65.0, 195.0, 115.0, 320.0, 565.0, 515.0, 0.0, 15.0, 0.0, 120.0, 105.0, 450.0, 525.0, 135.0, 585.0, 480.0, 550.0, 715.0, 225.0, 960.0, 195.0, 155.0, 80.0, 475.0, 295.0, 620.0, 0.0, 0.0, 0.0, 0.0, 425.0, 300.0, 110.0, 30.0, 130.0, 0.0, 0.0, 885.0, 510.0, 485.0, 335.0, 255.0, 615.0, 50.0, 0.0, 0.0, 315.0, 160.0, 515.0, 415.0, 440.0, 220.0, 375.0, 650.0, 40.0, 225.0, 355.0, 525.0, 275.0, 45.0, 55.0, 610.0, 185.0, 60.0, 0.0, 0.0, 585.0, 0.0, 315.0, 745.0, 735.0, 610.0, 295.0, 225.0, 5.0, 640.0, 515.0, 365.0, 0.0, 45.0, 70.0, 20.0, 590.0, 680.0, 0.0, 145.0, 720.0, 820.0, 590.0, 145.0, 460.0, 425.0, 495.0, 580.0, 240.0, 185.0, 690.0, 470.0, 490.0, 95.0, 210.0, 240.0, 350.0, 30.0, 275.0, 15.0, 365.0, 5.0, 25.0, 545.0, 265.0, 165.0, 190.0, 510.0, 185.0, 280.0, 470.0, 530.0, 700.0, 650.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7117405990137513, "mean_inference_ms": 1.5899532915255334, "mean_action_processing_ms": 0.27310469284977135, "mean_env_wait_ms": 0.210111617283318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006917871610082761, "StateBufferConnector_ms": 0.0039808677904533615, "ViewRequirementAgentConnector_ms": 0.1230861201430812}, "num_episodes": 27, "episode_return_max": 102.0, "episode_return_min": -1977.0, "episode_return_mean": -553.4040404040404, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.85250248818511, "num_env_steps_trained_throughput_per_sec": 82.85250248818511, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 49126.611, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49126.547, "sample_time_ms": 1312.828, "learn_time_ms": 47792.74, "learn_throughput": 83.695, "synch_weights_time_ms": 16.952}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-40-10", "timestamp": 1723498810, "time_this_iter_s": 48.30758094787598, "time_total_s": 245.7804663181305, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a887e3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 245.7804663181305, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.208823529411767, "ram_util_percent": 83.00735294117649}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3107269272602424, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.834620526732591, "policy_loss": -0.011864257862584458, "vf_loss": 6.843975201864091, "vf_explained_var": 0.00010681824078635564, "kl": 0.008365270144585574, "entropy": 1.528082745605045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3150443200554167, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.588262669749992, "policy_loss": -0.009325320604528306, "vf_loss": 7.595990585145496, "vf_explained_var": -0.0001018263990916903, "kl": 0.00798701633387681, "entropy": 1.5402156950935484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 102.0, "episode_reward_min": -1685.0, "episode_reward_mean": -588.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -591.21, "predator_policy": 296.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-525.0, -484.0, -480.0, -689.0, -661.0, -190.0, -199.0, -749.0, -266.0, -189.0, -324.0, -150.0, -758.0, 48.0, -833.0, -241.0, -15.0, -670.0, -877.0, -119.0, -509.0, -853.0, -151.0, -182.0, -1283.0, -15.0, -88.0, -528.0, -533.0, -1002.0, -1088.0, -841.0, -57.0, -884.0, -552.0, 4.0, 102.0, -735.0, -70.0, -330.0, -1332.0, -537.0, -789.0, -493.0, 85.0, -534.0, -928.0, -522.0, -1028.0, -372.0, -928.0, -310.0, -1035.0, -149.0, 1.0, -535.0, -1215.0, -886.0, -270.0, -642.0, -801.0, -30.0, -19.0, -1233.0, -78.0, -1659.0, -649.0, -700.0, -971.0, -164.0, -1670.0, -487.0, -503.0, -532.0, -460.0, -400.0, -838.0, -334.0, -340.0, -205.0, -1600.0, -990.0, -155.0, -1450.0, -169.0, -682.0, -1185.0, -1323.0, -622.0, -94.0, -775.0, -931.0, -1685.0, -1011.0, -54.0, -479.0, -940.0, -773.0, -851.0, -640.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-720.0, -290.0, -231.0, -593.0, -276.0, -1159.0, -670.0, -639.0, -1181.0, -240.0, -230.0, -210.0, -255.0, -144.0, -820.0, -649.0, -551.0, 0.0, -660.0, 46.0, -69.0, -525.0, -105.0, -265.0, -439.0, -949.0, 0.0, 48.0, -784.0, -854.0, -131.0, -490.0, 0.0, -80.0, -789.0, -571.0, -1446.0, -326.0, -112.0, -267.0, -790.0, -309.0, -1265.0, -493.0, -428.0, 17.0, -640.0, 23.0, -983.0, -1380.0, -30.0, 0.0, 26.0, -234.0, -760.0, -323.0, -1048.0, -145.0, -787.0, -1280.0, -1143.0, -1210.0, -86.0, -1940.0, 45.0, -452.0, -530.0, -909.0, -137.0, -1330.0, 0.0, 4.0, 78.0, 24.0, -860.0, -600.0, -210.0, 0.0, -260.0, -200.0, -460.0, -1757.0, -276.0, -1256.0, -909.0, -470.0, -208.0, -950.0, 61.0, 24.0, -556.0, -453.0, -828.0, -1030.0, -1052.0, -130.0, -1113.0, -940.0, -520.0, -117.0, -1040.0, -768.0, -160.0, -470.0, -979.0, -721.0, -46.0, -348.0, 1.0, 0.0, -10.0, -1110.0, -1395.0, -880.0, -880.0, -1351.0, -107.0, -683.0, 0.0, -1287.0, -1020.0, -661.0, 0.0, -75.0, -130.0, 21.0, -823.0, -1680.0, 8.0, -231.0, -1499.0, -1700.0, -190.0, -1194.0, -292.0, -1293.0, -1120.0, -926.0, -589.0, 0.0, -1470.0, -1360.0, -748.0, -324.0, -210.0, -743.0, -442.0, -470.0, -380.0, -370.0, -260.0, -510.0, -914.0, -494.0, -629.0, -135.0, -1030.0, -10.0, 0.0, -670.0, -1230.0, -1370.0, -610.0, -1730.0, -370.0, 0.0, -1140.0, -1190.0, -54.0, -310.0, -737.0, -350.0, -1070.0, -670.0, -940.0, -1248.0, -417.0, -760.0, -354.0, 0.0, -620.0, -985.0, -927.0, -749.0, -1290.0, -1310.0, -1227.0, -769.0, -130.0, -74.0, 1.0, -960.0, -740.0, -1025.0, -1263.0, -600.0, -1757.0, -209.0, -930.0, -220.0], "policy_predator_policy_reward": [30.0, 455.0, 0.0, 340.0, 550.0, 405.0, 395.0, 225.0, 545.0, 215.0, 55.0, 195.0, 0.0, 200.0, 225.0, 495.0, 0.0, 285.0, 90.0, 335.0, 0.0, 270.0, 60.0, 160.0, 485.0, 145.0, 0.0, 0.0, 450.0, 355.0, 0.0, 380.0, 0.0, 65.0, 335.0, 355.0, 750.0, 145.0, 260.0, 0.0, 115.0, 475.0, 650.0, 255.0, 65.0, 195.0, 115.0, 320.0, 565.0, 515.0, 0.0, 15.0, 0.0, 120.0, 105.0, 450.0, 525.0, 135.0, 585.0, 480.0, 550.0, 715.0, 225.0, 960.0, 195.0, 155.0, 80.0, 475.0, 295.0, 620.0, 0.0, 0.0, 0.0, 0.0, 425.0, 300.0, 110.0, 30.0, 130.0, 0.0, 0.0, 885.0, 510.0, 485.0, 335.0, 255.0, 615.0, 50.0, 0.0, 0.0, 315.0, 160.0, 515.0, 415.0, 440.0, 220.0, 375.0, 650.0, 40.0, 225.0, 355.0, 525.0, 275.0, 45.0, 55.0, 610.0, 185.0, 60.0, 0.0, 0.0, 585.0, 0.0, 315.0, 745.0, 735.0, 610.0, 295.0, 225.0, 5.0, 640.0, 515.0, 365.0, 0.0, 45.0, 70.0, 20.0, 590.0, 680.0, 0.0, 145.0, 720.0, 820.0, 590.0, 145.0, 460.0, 425.0, 495.0, 580.0, 240.0, 185.0, 690.0, 470.0, 490.0, 95.0, 210.0, 240.0, 350.0, 30.0, 275.0, 15.0, 365.0, 5.0, 25.0, 545.0, 265.0, 165.0, 190.0, 510.0, 185.0, 280.0, 470.0, 530.0, 700.0, 650.0, 75.0, 140.0, 525.0, 355.0, 190.0, 5.0, 185.0, 220.0, 190.0, 365.0, 540.0, 325.0, 120.0, 435.0, 170.0, 90.0, 445.0, 385.0, 230.0, 515.0, 165.0, 750.0, 670.0, 315.0, 15.0, 135.0, 0.0, 480.0, 465.0, 360.0, 525.0, 565.0, 805.0, 310.0, 0.0, 510.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7040518533058421, "mean_inference_ms": 1.5619193816864732, "mean_action_processing_ms": 0.2682770708450284, "mean_env_wait_ms": 0.2067050076230338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006216168403625488, "StateBufferConnector_ms": 0.0038443803787231445, "ViewRequirementAgentConnector_ms": 0.11651110649108887}, "num_episodes": 18, "episode_return_max": 102.0, "episode_return_min": -1685.0, "episode_return_mean": -588.67, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.88820465294211, "num_env_steps_trained_throughput_per_sec": 82.88820465294211, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 48981.806, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48981.745, "sample_time_ms": 1283.988, "learn_time_ms": 47677.519, "learn_throughput": 83.897, "synch_weights_time_ms": 16.329}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-40-58", "timestamp": 1723498858, "time_this_iter_s": 48.29976415634155, "time_total_s": 294.08023047447205, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88789d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 294.08023047447205, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.334782608695654, "ram_util_percent": 83.1376811594203}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2568602209684079, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.37811186856063, "policy_loss": -0.009759014617853733, "vf_loss": 8.385991062941375, "vf_explained_var": 0.00015786293322447116, "kl": 0.006266045336174526, "entropy": 1.513985164455636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8469192321022982, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.09717530800552, "policy_loss": -0.011630889880052083, "vf_loss": 8.10689447115338, "vf_explained_var": 0.002436210207207493, "kl": 0.009558720123513248, "entropy": 1.5401413964846777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 102.0, "episode_reward_min": -2245.0, "episode_reward_mean": -671.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -679.445, "predator_policy": 343.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-877.0, -119.0, -509.0, -853.0, -151.0, -182.0, -1283.0, -15.0, -88.0, -528.0, -533.0, -1002.0, -1088.0, -841.0, -57.0, -884.0, -552.0, 4.0, 102.0, -735.0, -70.0, -330.0, -1332.0, -537.0, -789.0, -493.0, 85.0, -534.0, -928.0, -522.0, -1028.0, -372.0, -928.0, -310.0, -1035.0, -149.0, 1.0, -535.0, -1215.0, -886.0, -270.0, -642.0, -801.0, -30.0, -19.0, -1233.0, -78.0, -1659.0, -649.0, -700.0, -971.0, -164.0, -1670.0, -487.0, -503.0, -532.0, -460.0, -400.0, -838.0, -334.0, -340.0, -205.0, -1600.0, -990.0, -155.0, -1450.0, -169.0, -682.0, -1185.0, -1323.0, -622.0, -94.0, -775.0, -931.0, -1685.0, -1011.0, -54.0, -479.0, -940.0, -773.0, -851.0, -640.0, -1184.0, -1180.0, -1216.0, -387.0, -750.0, -750.0, -580.0, -2245.0, -1987.0, -245.0, -1153.0, -355.0, -1390.0, -945.0, -272.0, -234.0, -485.0, -334.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1446.0, -326.0, -112.0, -267.0, -790.0, -309.0, -1265.0, -493.0, -428.0, 17.0, -640.0, 23.0, -983.0, -1380.0, -30.0, 0.0, 26.0, -234.0, -760.0, -323.0, -1048.0, -145.0, -787.0, -1280.0, -1143.0, -1210.0, -86.0, -1940.0, 45.0, -452.0, -530.0, -909.0, -137.0, -1330.0, 0.0, 4.0, 78.0, 24.0, -860.0, -600.0, -210.0, 0.0, -260.0, -200.0, -460.0, -1757.0, -276.0, -1256.0, -909.0, -470.0, -208.0, -950.0, 61.0, 24.0, -556.0, -453.0, -828.0, -1030.0, -1052.0, -130.0, -1113.0, -940.0, -520.0, -117.0, -1040.0, -768.0, -160.0, -470.0, -979.0, -721.0, -46.0, -348.0, 1.0, 0.0, -10.0, -1110.0, -1395.0, -880.0, -880.0, -1351.0, -107.0, -683.0, 0.0, -1287.0, -1020.0, -661.0, 0.0, -75.0, -130.0, 21.0, -823.0, -1680.0, 8.0, -231.0, -1499.0, -1700.0, -190.0, -1194.0, -292.0, -1293.0, -1120.0, -926.0, -589.0, 0.0, -1470.0, -1360.0, -748.0, -324.0, -210.0, -743.0, -442.0, -470.0, -380.0, -370.0, -260.0, -510.0, -914.0, -494.0, -629.0, -135.0, -1030.0, -10.0, 0.0, -670.0, -1230.0, -1370.0, -610.0, -1730.0, -370.0, 0.0, -1140.0, -1190.0, -54.0, -310.0, -737.0, -350.0, -1070.0, -670.0, -940.0, -1248.0, -417.0, -760.0, -354.0, 0.0, -620.0, -985.0, -927.0, -749.0, -1290.0, -1310.0, -1227.0, -769.0, -130.0, -74.0, 1.0, -960.0, -740.0, -1025.0, -1263.0, -600.0, -1757.0, -209.0, -930.0, -220.0, -950.0, -1459.0, -1715.0, -950.0, -726.0, -1490.0, -640.0, -302.0, -770.0, -740.0, -390.0, -1280.0, 15.0, -1750.0, -1640.0, -1500.0, -1767.0, -1710.0, -1290.0, 0.0, -1296.0, -1002.0, -1110.0, -230.0, -970.0, -930.0, -455.0, -1520.0, -116.0, -736.0, -1830.0, 46.0, -1100.0, -100.0, -391.0, -328.0], "policy_predator_policy_reward": [750.0, 145.0, 260.0, 0.0, 115.0, 475.0, 650.0, 255.0, 65.0, 195.0, 115.0, 320.0, 565.0, 515.0, 0.0, 15.0, 0.0, 120.0, 105.0, 450.0, 525.0, 135.0, 585.0, 480.0, 550.0, 715.0, 225.0, 960.0, 195.0, 155.0, 80.0, 475.0, 295.0, 620.0, 0.0, 0.0, 0.0, 0.0, 425.0, 300.0, 110.0, 30.0, 130.0, 0.0, 0.0, 885.0, 510.0, 485.0, 335.0, 255.0, 615.0, 50.0, 0.0, 0.0, 315.0, 160.0, 515.0, 415.0, 440.0, 220.0, 375.0, 650.0, 40.0, 225.0, 355.0, 525.0, 275.0, 45.0, 55.0, 610.0, 185.0, 60.0, 0.0, 0.0, 585.0, 0.0, 315.0, 745.0, 735.0, 610.0, 295.0, 225.0, 5.0, 640.0, 515.0, 365.0, 0.0, 45.0, 70.0, 20.0, 590.0, 680.0, 0.0, 145.0, 720.0, 820.0, 590.0, 145.0, 460.0, 425.0, 495.0, 580.0, 240.0, 185.0, 690.0, 470.0, 490.0, 95.0, 210.0, 240.0, 350.0, 30.0, 275.0, 15.0, 365.0, 5.0, 25.0, 545.0, 265.0, 165.0, 190.0, 510.0, 185.0, 280.0, 470.0, 530.0, 700.0, 650.0, 75.0, 140.0, 525.0, 355.0, 190.0, 5.0, 185.0, 220.0, 190.0, 365.0, 540.0, 325.0, 120.0, 435.0, 170.0, 90.0, 445.0, 385.0, 230.0, 515.0, 165.0, 750.0, 670.0, 315.0, 15.0, 135.0, 0.0, 480.0, 465.0, 360.0, 525.0, 565.0, 805.0, 310.0, 0.0, 510.0, 440.0, 785.0, 855.0, 630.0, 245.0, 755.0, 335.0, 220.0, 335.0, 425.0, 640.0, 280.0, 765.0, 390.0, 0.0, 895.0, 910.0, 580.0, 480.0, 565.0, 485.0, 660.0, 460.0, 525.0, 0.0, 510.0, 795.0, 235.0, 220.0, 360.0, 670.0, 880.0, 195.0, 520.0, 25.0, 360.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6930365699479963, "mean_inference_ms": 1.5322342765524426, "mean_action_processing_ms": 0.2628046060346973, "mean_env_wait_ms": 0.2023633996467106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005562186241149902, "StateBufferConnector_ms": 0.0031555891036987305, "ViewRequirementAgentConnector_ms": 0.10644245147705078}, "num_episodes": 18, "episode_return_max": 102.0, "episode_return_min": -2245.0, "episode_return_mean": -671.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.95806012028748, "num_env_steps_trained_throughput_per_sec": 82.95806012028748, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 48872.568, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48872.511, "sample_time_ms": 1268.926, "learn_time_ms": 47584.108, "learn_throughput": 84.062, "synch_weights_time_ms": 15.791}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-41-46", "timestamp": 1723498906, "time_this_iter_s": 48.254932165145874, "time_total_s": 342.3351626396179, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a887c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 342.3351626396179, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.27205882352942, "ram_util_percent": 82.82794117647056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7367604246215216, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.427467253851512, "policy_loss": -0.008686677866157086, "vf_loss": 7.4346422498188325, "vf_explained_var": -0.00013919642993382047, "kl": 0.00503893607200876, "entropy": 1.5089580665189752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6740096985978425, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.986714492777668, "policy_loss": -0.011051386307737736, "vf_loss": 6.995626092083239, "vf_explained_var": 0.0022635096595400857, "kl": 0.010698895675836841, "entropy": 1.5325193875681156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 102.0, "episode_reward_min": -2245.0, "episode_reward_mean": -678.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1830.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 98.0, "predator_policy": 910.0}, "policy_reward_mean": {"prey_policy": -704.185, "predator_policy": 364.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.0, -735.0, -70.0, -330.0, -1332.0, -537.0, -789.0, -493.0, 85.0, -534.0, -928.0, -522.0, -1028.0, -372.0, -928.0, -310.0, -1035.0, -149.0, 1.0, -535.0, -1215.0, -886.0, -270.0, -642.0, -801.0, -30.0, -19.0, -1233.0, -78.0, -1659.0, -649.0, -700.0, -971.0, -164.0, -1670.0, -487.0, -503.0, -532.0, -460.0, -400.0, -838.0, -334.0, -340.0, -205.0, -1600.0, -990.0, -155.0, -1450.0, -169.0, -682.0, -1185.0, -1323.0, -622.0, -94.0, -775.0, -931.0, -1685.0, -1011.0, -54.0, -479.0, -940.0, -773.0, -851.0, -640.0, -1184.0, -1180.0, -1216.0, -387.0, -750.0, -750.0, -580.0, -2245.0, -1987.0, -245.0, -1153.0, -355.0, -1390.0, -945.0, -272.0, -234.0, -485.0, -334.0, -619.0, -315.0, -1418.0, -2245.0, -1.0, -220.0, -674.0, -394.0, -109.0, -701.0, -235.0, -368.0, -545.0, -215.0, -428.0, -885.0, -640.0, -224.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [78.0, 24.0, -860.0, -600.0, -210.0, 0.0, -260.0, -200.0, -460.0, -1757.0, -276.0, -1256.0, -909.0, -470.0, -208.0, -950.0, 61.0, 24.0, -556.0, -453.0, -828.0, -1030.0, -1052.0, -130.0, -1113.0, -940.0, -520.0, -117.0, -1040.0, -768.0, -160.0, -470.0, -979.0, -721.0, -46.0, -348.0, 1.0, 0.0, -10.0, -1110.0, -1395.0, -880.0, -880.0, -1351.0, -107.0, -683.0, 0.0, -1287.0, -1020.0, -661.0, 0.0, -75.0, -130.0, 21.0, -823.0, -1680.0, 8.0, -231.0, -1499.0, -1700.0, -190.0, -1194.0, -292.0, -1293.0, -1120.0, -926.0, -589.0, 0.0, -1470.0, -1360.0, -748.0, -324.0, -210.0, -743.0, -442.0, -470.0, -380.0, -370.0, -260.0, -510.0, -914.0, -494.0, -629.0, -135.0, -1030.0, -10.0, 0.0, -670.0, -1230.0, -1370.0, -610.0, -1730.0, -370.0, 0.0, -1140.0, -1190.0, -54.0, -310.0, -737.0, -350.0, -1070.0, -670.0, -940.0, -1248.0, -417.0, -760.0, -354.0, 0.0, -620.0, -985.0, -927.0, -749.0, -1290.0, -1310.0, -1227.0, -769.0, -130.0, -74.0, 1.0, -960.0, -740.0, -1025.0, -1263.0, -600.0, -1757.0, -209.0, -930.0, -220.0, -950.0, -1459.0, -1715.0, -950.0, -726.0, -1490.0, -640.0, -302.0, -770.0, -740.0, -390.0, -1280.0, 15.0, -1750.0, -1640.0, -1500.0, -1767.0, -1710.0, -1290.0, 0.0, -1296.0, -1002.0, -1110.0, -230.0, -970.0, -930.0, -455.0, -1520.0, -116.0, -736.0, -1830.0, 46.0, -1100.0, -100.0, -391.0, -328.0, -430.0, -814.0, -150.0, -480.0, -768.0, -1790.0, -1480.0, -1730.0, -309.0, 98.0, -1200.0, -10.0, -1318.0, -191.0, -214.0, -1240.0, -245.0, 6.0, -430.0, -606.0, -1560.0, -10.0, -1280.0, -68.0, -545.0, -1320.0, -100.0, -1060.0, -8.0, -1520.0, -1300.0, -400.0, -1316.0, -414.0, -1430.0, 16.0], "policy_predator_policy_reward": [0.0, 0.0, 425.0, 300.0, 110.0, 30.0, 130.0, 0.0, 0.0, 885.0, 510.0, 485.0, 335.0, 255.0, 615.0, 50.0, 0.0, 0.0, 315.0, 160.0, 515.0, 415.0, 440.0, 220.0, 375.0, 650.0, 40.0, 225.0, 355.0, 525.0, 275.0, 45.0, 55.0, 610.0, 185.0, 60.0, 0.0, 0.0, 585.0, 0.0, 315.0, 745.0, 735.0, 610.0, 295.0, 225.0, 5.0, 640.0, 515.0, 365.0, 0.0, 45.0, 70.0, 20.0, 590.0, 680.0, 0.0, 145.0, 720.0, 820.0, 590.0, 145.0, 460.0, 425.0, 495.0, 580.0, 240.0, 185.0, 690.0, 470.0, 490.0, 95.0, 210.0, 240.0, 350.0, 30.0, 275.0, 15.0, 365.0, 5.0, 25.0, 545.0, 265.0, 165.0, 190.0, 510.0, 185.0, 280.0, 470.0, 530.0, 700.0, 650.0, 75.0, 140.0, 525.0, 355.0, 190.0, 5.0, 185.0, 220.0, 190.0, 365.0, 540.0, 325.0, 120.0, 435.0, 170.0, 90.0, 445.0, 385.0, 230.0, 515.0, 165.0, 750.0, 670.0, 315.0, 15.0, 135.0, 0.0, 480.0, 465.0, 360.0, 525.0, 565.0, 805.0, 310.0, 0.0, 510.0, 440.0, 785.0, 855.0, 630.0, 245.0, 755.0, 335.0, 220.0, 335.0, 425.0, 640.0, 280.0, 765.0, 390.0, 0.0, 895.0, 910.0, 580.0, 480.0, 565.0, 485.0, 660.0, 460.0, 525.0, 0.0, 510.0, 795.0, 235.0, 220.0, 360.0, 670.0, 880.0, 195.0, 520.0, 25.0, 360.0, 215.0, 410.0, 315.0, 0.0, 720.0, 420.0, 810.0, 155.0, 55.0, 155.0, 545.0, 445.0, 640.0, 195.0, 405.0, 655.0, 130.0, 0.0, 5.0, 330.0, 680.0, 655.0, 550.0, 430.0, 710.0, 610.0, 570.0, 375.0, 420.0, 680.0, 110.0, 705.0, 445.0, 645.0, 570.0, 620.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6835746062591441, "mean_inference_ms": 1.5091903225966303, "mean_action_processing_ms": 0.25884262701751903, "mean_env_wait_ms": 0.19939794535687266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005081772804260254, "StateBufferConnector_ms": 0.0031740665435791016, "ViewRequirementAgentConnector_ms": 0.10757553577423096}, "num_episodes": 18, "episode_return_max": 102.0, "episode_return_min": -2245.0, "episode_return_mean": -678.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.13057750715598, "num_env_steps_trained_throughput_per_sec": 82.13057750715598, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 48851.366, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48851.305, "sample_time_ms": 1259.245, "learn_time_ms": 47572.301, "learn_throughput": 84.083, "synch_weights_time_ms": 15.767}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-42-35", "timestamp": 1723498955, "time_this_iter_s": 48.73094582557678, "time_total_s": 391.0661084651947, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88781f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 391.0661084651947, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.084057971014495, "ram_util_percent": 83.07391304347824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.607513637959011, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.9495628364502435, "policy_loss": -0.013067642115204343, "vf_loss": 5.96055252816942, "vf_explained_var": 6.808670109541959e-05, "kl": 0.006926499580354584, "entropy": 1.501286884085842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6731042607436106, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.0362279622012345, "policy_loss": -0.012462052147066782, "vf_loss": 6.046928076012425, "vf_explained_var": 0.0016999634170027638, "kl": 0.008809709846282394, "entropy": 1.5288406754927661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 32.0, "episode_reward_min": -2245.0, "episode_reward_mean": -621.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1920.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 98.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -675.135, "predator_policy": 364.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-270.0, -642.0, -801.0, -30.0, -19.0, -1233.0, -78.0, -1659.0, -649.0, -700.0, -971.0, -164.0, -1670.0, -487.0, -503.0, -532.0, -460.0, -400.0, -838.0, -334.0, -340.0, -205.0, -1600.0, -990.0, -155.0, -1450.0, -169.0, -682.0, -1185.0, -1323.0, -622.0, -94.0, -775.0, -931.0, -1685.0, -1011.0, -54.0, -479.0, -940.0, -773.0, -851.0, -640.0, -1184.0, -1180.0, -1216.0, -387.0, -750.0, -750.0, -580.0, -2245.0, -1987.0, -245.0, -1153.0, -355.0, -1390.0, -945.0, -272.0, -234.0, -485.0, -334.0, -619.0, -315.0, -1418.0, -2245.0, -1.0, -220.0, -674.0, -394.0, -109.0, -701.0, -235.0, -368.0, -545.0, -215.0, -428.0, -885.0, -640.0, -224.0, -359.0, -1325.0, -111.0, -271.0, -73.0, -409.0, 0.0, -217.0, -743.0, -149.0, -127.0, -305.0, -287.0, -130.0, -565.0, -1074.0, -172.0, -298.0, -47.0, 32.0, -170.0, -35.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-107.0, -683.0, 0.0, -1287.0, -1020.0, -661.0, 0.0, -75.0, -130.0, 21.0, -823.0, -1680.0, 8.0, -231.0, -1499.0, -1700.0, -190.0, -1194.0, -292.0, -1293.0, -1120.0, -926.0, -589.0, 0.0, -1470.0, -1360.0, -748.0, -324.0, -210.0, -743.0, -442.0, -470.0, -380.0, -370.0, -260.0, -510.0, -914.0, -494.0, -629.0, -135.0, -1030.0, -10.0, 0.0, -670.0, -1230.0, -1370.0, -610.0, -1730.0, -370.0, 0.0, -1140.0, -1190.0, -54.0, -310.0, -737.0, -350.0, -1070.0, -670.0, -940.0, -1248.0, -417.0, -760.0, -354.0, 0.0, -620.0, -985.0, -927.0, -749.0, -1290.0, -1310.0, -1227.0, -769.0, -130.0, -74.0, 1.0, -960.0, -740.0, -1025.0, -1263.0, -600.0, -1757.0, -209.0, -930.0, -220.0, -950.0, -1459.0, -1715.0, -950.0, -726.0, -1490.0, -640.0, -302.0, -770.0, -740.0, -390.0, -1280.0, 15.0, -1750.0, -1640.0, -1500.0, -1767.0, -1710.0, -1290.0, 0.0, -1296.0, -1002.0, -1110.0, -230.0, -970.0, -930.0, -455.0, -1520.0, -116.0, -736.0, -1830.0, 46.0, -1100.0, -100.0, -391.0, -328.0, -430.0, -814.0, -150.0, -480.0, -768.0, -1790.0, -1480.0, -1730.0, -309.0, 98.0, -1200.0, -10.0, -1318.0, -191.0, -214.0, -1240.0, -245.0, 6.0, -430.0, -606.0, -1560.0, -10.0, -1280.0, -68.0, -545.0, -1320.0, -100.0, -1060.0, -8.0, -1520.0, -1300.0, -400.0, -1316.0, -414.0, -1430.0, 16.0, -299.0, -530.0, -1330.0, -1260.0, -184.0, -57.0, -126.0, -780.0, -150.0, -3.0, -770.0, -104.0, 0.0, 0.0, -508.0, 21.0, -1148.0, -470.0, -400.0, -54.0, 18.0, -375.0, -13.0, -1317.0, 11.0, -1258.0, -289.0, -151.0, -1677.0, 47.0, -970.0, -1214.0, 8.0, -1920.0, -190.0, -798.0, -18.0, -89.0, 0.0, 32.0, 0.0, -930.0, 0.0, -70.0], "policy_predator_policy_reward": [295.0, 225.0, 5.0, 640.0, 515.0, 365.0, 0.0, 45.0, 70.0, 20.0, 590.0, 680.0, 0.0, 145.0, 720.0, 820.0, 590.0, 145.0, 460.0, 425.0, 495.0, 580.0, 240.0, 185.0, 690.0, 470.0, 490.0, 95.0, 210.0, 240.0, 350.0, 30.0, 275.0, 15.0, 365.0, 5.0, 25.0, 545.0, 265.0, 165.0, 190.0, 510.0, 185.0, 280.0, 470.0, 530.0, 700.0, 650.0, 75.0, 140.0, 525.0, 355.0, 190.0, 5.0, 185.0, 220.0, 190.0, 365.0, 540.0, 325.0, 120.0, 435.0, 170.0, 90.0, 445.0, 385.0, 230.0, 515.0, 165.0, 750.0, 670.0, 315.0, 15.0, 135.0, 0.0, 480.0, 465.0, 360.0, 525.0, 565.0, 805.0, 310.0, 0.0, 510.0, 440.0, 785.0, 855.0, 630.0, 245.0, 755.0, 335.0, 220.0, 335.0, 425.0, 640.0, 280.0, 765.0, 390.0, 0.0, 895.0, 910.0, 580.0, 480.0, 565.0, 485.0, 660.0, 460.0, 525.0, 0.0, 510.0, 795.0, 235.0, 220.0, 360.0, 670.0, 880.0, 195.0, 520.0, 25.0, 360.0, 215.0, 410.0, 315.0, 0.0, 720.0, 420.0, 810.0, 155.0, 55.0, 155.0, 545.0, 445.0, 640.0, 195.0, 405.0, 655.0, 130.0, 0.0, 5.0, 330.0, 680.0, 655.0, 550.0, 430.0, 710.0, 610.0, 570.0, 375.0, 420.0, 680.0, 110.0, 705.0, 445.0, 645.0, 570.0, 620.0, 335.0, 135.0, 750.0, 515.0, 130.0, 0.0, 320.0, 315.0, 0.0, 80.0, 430.0, 35.0, 0.0, 0.0, 245.0, 25.0, 285.0, 590.0, 110.0, 195.0, 190.0, 40.0, 350.0, 675.0, 550.0, 410.0, 90.0, 220.0, 225.0, 840.0, 415.0, 695.0, 960.0, 780.0, 455.0, 235.0, 60.0, 0.0, 0.0, 0.0, 320.0, 440.0, 35.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6718759884087411, "mean_inference_ms": 1.4903853134498386, "mean_action_processing_ms": 0.25572409156788134, "mean_env_wait_ms": 0.19664758338606425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004419207572937012, "StateBufferConnector_ms": 0.00325930118560791, "ViewRequirementAgentConnector_ms": 0.10362422466278076}, "num_episodes": 22, "episode_return_max": 32.0, "episode_return_min": -2245.0, "episode_return_mean": -621.57, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.87167755553017, "num_env_steps_trained_throughput_per_sec": 83.87167755553017, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 48722.537, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48722.479, "sample_time_ms": 1244.351, "learn_time_ms": 47459.114, "learn_throughput": 84.283, "synch_weights_time_ms": 15.271}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-43-23", "timestamp": 1723499003, "time_this_iter_s": 47.723443031311035, "time_total_s": 438.78955149650574, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88338b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 438.78955149650574, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.241176470588233, "ram_util_percent": 82.88676470588237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3328428551475837, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.310351938040799, "policy_loss": -0.011903694943431272, "vf_loss": 3.3201500639713633, "vf_explained_var": 0.0014253983421931191, "kl": 0.007018559744505971, "entropy": 1.498757323638472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9790578754806014, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.953573110999254, "policy_loss": -0.01049117694409298, "vf_loss": 4.9622552769524715, "vf_explained_var": 0.0007065922810287072, "kl": 0.00904501157409989, "entropy": 1.5125888320504042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 47.0, "episode_reward_min": -2245.0, "episode_reward_mean": -540.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1920.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 98.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -604.07, "predator_policy": 333.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-990.0, -155.0, -1450.0, -169.0, -682.0, -1185.0, -1323.0, -622.0, -94.0, -775.0, -931.0, -1685.0, -1011.0, -54.0, -479.0, -940.0, -773.0, -851.0, -640.0, -1184.0, -1180.0, -1216.0, -387.0, -750.0, -750.0, -580.0, -2245.0, -1987.0, -245.0, -1153.0, -355.0, -1390.0, -945.0, -272.0, -234.0, -485.0, -334.0, -619.0, -315.0, -1418.0, -2245.0, -1.0, -220.0, -674.0, -394.0, -109.0, -701.0, -235.0, -368.0, -545.0, -215.0, -428.0, -885.0, -640.0, -224.0, -359.0, -1325.0, -111.0, -271.0, -73.0, -409.0, 0.0, -217.0, -743.0, -149.0, -127.0, -305.0, -287.0, -130.0, -565.0, -1074.0, -172.0, -298.0, -47.0, 32.0, -170.0, -35.0, -657.0, -533.0, -292.0, -32.0, -229.0, -195.0, 12.0, -601.0, -300.0, -894.0, 47.0, -605.0, -70.0, -197.0, -425.0, -338.0, -92.0, -677.0, -14.0, 28.0, -33.0, -238.0, -182.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-610.0, -1730.0, -370.0, 0.0, -1140.0, -1190.0, -54.0, -310.0, -737.0, -350.0, -1070.0, -670.0, -940.0, -1248.0, -417.0, -760.0, -354.0, 0.0, -620.0, -985.0, -927.0, -749.0, -1290.0, -1310.0, -1227.0, -769.0, -130.0, -74.0, 1.0, -960.0, -740.0, -1025.0, -1263.0, -600.0, -1757.0, -209.0, -930.0, -220.0, -950.0, -1459.0, -1715.0, -950.0, -726.0, -1490.0, -640.0, -302.0, -770.0, -740.0, -390.0, -1280.0, 15.0, -1750.0, -1640.0, -1500.0, -1767.0, -1710.0, -1290.0, 0.0, -1296.0, -1002.0, -1110.0, -230.0, -970.0, -930.0, -455.0, -1520.0, -116.0, -736.0, -1830.0, 46.0, -1100.0, -100.0, -391.0, -328.0, -430.0, -814.0, -150.0, -480.0, -768.0, -1790.0, -1480.0, -1730.0, -309.0, 98.0, -1200.0, -10.0, -1318.0, -191.0, -214.0, -1240.0, -245.0, 6.0, -430.0, -606.0, -1560.0, -10.0, -1280.0, -68.0, -545.0, -1320.0, -100.0, -1060.0, -8.0, -1520.0, -1300.0, -400.0, -1316.0, -414.0, -1430.0, 16.0, -299.0, -530.0, -1330.0, -1260.0, -184.0, -57.0, -126.0, -780.0, -150.0, -3.0, -770.0, -104.0, 0.0, 0.0, -508.0, 21.0, -1148.0, -470.0, -400.0, -54.0, 18.0, -375.0, -13.0, -1317.0, 11.0, -1258.0, -289.0, -151.0, -1677.0, 47.0, -970.0, -1214.0, 8.0, -1920.0, -190.0, -798.0, -18.0, -89.0, 0.0, 32.0, 0.0, -930.0, 0.0, -70.0, -81.0, -1311.0, 2.0, -1070.0, -1420.0, 3.0, -109.0, 12.0, -270.0, -224.0, 5.0, -400.0, -8.0, 5.0, -1117.0, -89.0, -986.0, -129.0, -634.0, -610.0, 12.0, 35.0, -470.0, -740.0, -130.0, -50.0, -127.0, -470.0, 0.0, -850.0, 12.0, -870.0, -223.0, 6.0, -1780.0, 3.0, -35.0, 1.0, 25.0, 3.0, -10.0, -58.0, -179.0, -299.0, -380.0, -22.0], "policy_predator_policy_reward": [700.0, 650.0, 75.0, 140.0, 525.0, 355.0, 190.0, 5.0, 185.0, 220.0, 190.0, 365.0, 540.0, 325.0, 120.0, 435.0, 170.0, 90.0, 445.0, 385.0, 230.0, 515.0, 165.0, 750.0, 670.0, 315.0, 15.0, 135.0, 0.0, 480.0, 465.0, 360.0, 525.0, 565.0, 805.0, 310.0, 0.0, 510.0, 440.0, 785.0, 855.0, 630.0, 245.0, 755.0, 335.0, 220.0, 335.0, 425.0, 640.0, 280.0, 765.0, 390.0, 0.0, 895.0, 910.0, 580.0, 480.0, 565.0, 485.0, 660.0, 460.0, 525.0, 0.0, 510.0, 795.0, 235.0, 220.0, 360.0, 670.0, 880.0, 195.0, 520.0, 25.0, 360.0, 215.0, 410.0, 315.0, 0.0, 720.0, 420.0, 810.0, 155.0, 55.0, 155.0, 545.0, 445.0, 640.0, 195.0, 405.0, 655.0, 130.0, 0.0, 5.0, 330.0, 680.0, 655.0, 550.0, 430.0, 710.0, 610.0, 570.0, 375.0, 420.0, 680.0, 110.0, 705.0, 445.0, 645.0, 570.0, 620.0, 335.0, 135.0, 750.0, 515.0, 130.0, 0.0, 320.0, 315.0, 0.0, 80.0, 430.0, 35.0, 0.0, 0.0, 245.0, 25.0, 285.0, 590.0, 110.0, 195.0, 190.0, 40.0, 350.0, 675.0, 550.0, 410.0, 90.0, 220.0, 225.0, 840.0, 415.0, 695.0, 960.0, 780.0, 455.0, 235.0, 60.0, 0.0, 0.0, 0.0, 320.0, 440.0, 35.0, 0.0, 75.0, 660.0, 535.0, 0.0, 595.0, 530.0, 0.0, 65.0, 115.0, 150.0, 200.0, 0.0, 15.0, 0.0, 45.0, 560.0, 260.0, 555.0, 350.0, 0.0, 0.0, 0.0, 235.0, 370.0, 50.0, 60.0, 85.0, 315.0, 0.0, 425.0, 205.0, 315.0, 60.0, 65.0, 310.0, 790.0, 0.0, 20.0, 0.0, 0.0, 10.0, 25.0, 155.0, 85.0, 25.0, 195.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6628748384270885, "mean_inference_ms": 1.4727781313765738, "mean_action_processing_ms": 0.25249833201687105, "mean_env_wait_ms": 0.19440647801982722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037050247192382812, "StateBufferConnector_ms": 0.0032880306243896484, "ViewRequirementAgentConnector_ms": 0.10159945487976074}, "num_episodes": 23, "episode_return_max": 47.0, "episode_return_min": -2245.0, "episode_return_mean": -540.89, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.98047056003134, "num_env_steps_trained_throughput_per_sec": 82.98047056003134, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 48670.696, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48670.64, "sample_time_ms": 1234.91, "learn_time_ms": 47417.189, "learn_throughput": 84.358, "synch_weights_time_ms": 14.897}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-44-11", "timestamp": 1723499051, "time_this_iter_s": 48.24977898597717, "time_total_s": 487.0393304824829, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a887cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 487.0393304824829, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.905882352941177, "ram_util_percent": 83.03823529411767}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2987108574657844, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9651238208725337, "policy_loss": -0.01210473570972681, "vf_loss": 2.9752132815027994, "vf_explained_var": 0.00045116849677272577, "kl": 0.006717572999016138, "entropy": 1.494195840409193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9160728245815903, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.346122810008034, "policy_loss": -0.012214134622700315, "vf_loss": 3.356771842386357, "vf_explained_var": 0.00285046933189271, "kl": 0.007825529403672324, "entropy": 1.5195612593933387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 47.0, "episode_reward_min": -2245.0, "episode_reward_mean": -447.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1920.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 98.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -523.42, "predator_policy": 299.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-640.0, -1184.0, -1180.0, -1216.0, -387.0, -750.0, -750.0, -580.0, -2245.0, -1987.0, -245.0, -1153.0, -355.0, -1390.0, -945.0, -272.0, -234.0, -485.0, -334.0, -619.0, -315.0, -1418.0, -2245.0, -1.0, -220.0, -674.0, -394.0, -109.0, -701.0, -235.0, -368.0, -545.0, -215.0, -428.0, -885.0, -640.0, -224.0, -359.0, -1325.0, -111.0, -271.0, -73.0, -409.0, 0.0, -217.0, -743.0, -149.0, -127.0, -305.0, -287.0, -130.0, -565.0, -1074.0, -172.0, -298.0, -47.0, 32.0, -170.0, -35.0, -657.0, -533.0, -292.0, -32.0, -229.0, -195.0, 12.0, -601.0, -300.0, -894.0, 47.0, -605.0, -70.0, -197.0, -425.0, -338.0, -92.0, -677.0, -14.0, 28.0, -33.0, -238.0, -182.0, -70.0, -239.0, -354.0, -389.0, -64.0, -673.0, -19.0, -5.0, -478.0, 17.0, -187.0, 4.0, -59.0, -203.0, -394.0, -12.0, -738.0, -941.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-930.0, -220.0, -950.0, -1459.0, -1715.0, -950.0, -726.0, -1490.0, -640.0, -302.0, -770.0, -740.0, -390.0, -1280.0, 15.0, -1750.0, -1640.0, -1500.0, -1767.0, -1710.0, -1290.0, 0.0, -1296.0, -1002.0, -1110.0, -230.0, -970.0, -930.0, -455.0, -1520.0, -116.0, -736.0, -1830.0, 46.0, -1100.0, -100.0, -391.0, -328.0, -430.0, -814.0, -150.0, -480.0, -768.0, -1790.0, -1480.0, -1730.0, -309.0, 98.0, -1200.0, -10.0, -1318.0, -191.0, -214.0, -1240.0, -245.0, 6.0, -430.0, -606.0, -1560.0, -10.0, -1280.0, -68.0, -545.0, -1320.0, -100.0, -1060.0, -8.0, -1520.0, -1300.0, -400.0, -1316.0, -414.0, -1430.0, 16.0, -299.0, -530.0, -1330.0, -1260.0, -184.0, -57.0, -126.0, -780.0, -150.0, -3.0, -770.0, -104.0, 0.0, 0.0, -508.0, 21.0, -1148.0, -470.0, -400.0, -54.0, 18.0, -375.0, -13.0, -1317.0, 11.0, -1258.0, -289.0, -151.0, -1677.0, 47.0, -970.0, -1214.0, 8.0, -1920.0, -190.0, -798.0, -18.0, -89.0, 0.0, 32.0, 0.0, -930.0, 0.0, -70.0, -81.0, -1311.0, 2.0, -1070.0, -1420.0, 3.0, -109.0, 12.0, -270.0, -224.0, 5.0, -400.0, -8.0, 5.0, -1117.0, -89.0, -986.0, -129.0, -634.0, -610.0, 12.0, 35.0, -470.0, -740.0, -130.0, -50.0, -127.0, -470.0, 0.0, -850.0, 12.0, -870.0, -223.0, 6.0, -1780.0, 3.0, -35.0, 1.0, 25.0, 3.0, -10.0, -58.0, -179.0, -299.0, -380.0, -22.0, 21.0, -186.0, -109.0, -470.0, -720.0, 6.0, 1.0, -1000.0, -109.0, -10.0, -138.0, -1210.0, -47.0, 3.0, 0.0, -40.0, -930.0, -123.0, 0.0, 17.0, 12.0, -399.0, 0.0, 4.0, 15.0, -149.0, -910.0, 7.0, -324.0, -280.0, -4.0, -63.0, -128.0, -1400.0, -91.0, -1700.0], "policy_predator_policy_reward": [0.0, 510.0, 440.0, 785.0, 855.0, 630.0, 245.0, 755.0, 335.0, 220.0, 335.0, 425.0, 640.0, 280.0, 765.0, 390.0, 0.0, 895.0, 910.0, 580.0, 480.0, 565.0, 485.0, 660.0, 460.0, 525.0, 0.0, 510.0, 795.0, 235.0, 220.0, 360.0, 670.0, 880.0, 195.0, 520.0, 25.0, 360.0, 215.0, 410.0, 315.0, 0.0, 720.0, 420.0, 810.0, 155.0, 55.0, 155.0, 545.0, 445.0, 640.0, 195.0, 405.0, 655.0, 130.0, 0.0, 5.0, 330.0, 680.0, 655.0, 550.0, 430.0, 710.0, 610.0, 570.0, 375.0, 420.0, 680.0, 110.0, 705.0, 445.0, 645.0, 570.0, 620.0, 335.0, 135.0, 750.0, 515.0, 130.0, 0.0, 320.0, 315.0, 0.0, 80.0, 430.0, 35.0, 0.0, 0.0, 245.0, 25.0, 285.0, 590.0, 110.0, 195.0, 190.0, 40.0, 350.0, 675.0, 550.0, 410.0, 90.0, 220.0, 225.0, 840.0, 415.0, 695.0, 960.0, 780.0, 455.0, 235.0, 60.0, 0.0, 0.0, 0.0, 320.0, 440.0, 35.0, 0.0, 75.0, 660.0, 535.0, 0.0, 595.0, 530.0, 0.0, 65.0, 115.0, 150.0, 200.0, 0.0, 15.0, 0.0, 45.0, 560.0, 260.0, 555.0, 350.0, 0.0, 0.0, 0.0, 235.0, 370.0, 50.0, 60.0, 85.0, 315.0, 0.0, 425.0, 205.0, 315.0, 60.0, 65.0, 310.0, 790.0, 0.0, 20.0, 0.0, 0.0, 10.0, 25.0, 155.0, 85.0, 25.0, 195.0, 0.0, 95.0, 150.0, 190.0, 0.0, 360.0, 480.0, 130.0, 55.0, 0.0, 55.0, 620.0, 10.0, 15.0, 35.0, 0.0, 220.0, 355.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 75.0, 0.0, 275.0, 425.0, 140.0, 70.0, 45.0, 10.0, 400.0, 390.0, 225.0, 625.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6573680318165998, "mean_inference_ms": 1.4618641925371383, "mean_action_processing_ms": 0.2508529296909842, "mean_env_wait_ms": 0.193031862625073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003708362579345703, "StateBufferConnector_ms": 0.0032578706741333008, "ViewRequirementAgentConnector_ms": 0.1004185676574707}, "num_episodes": 18, "episode_return_max": 47.0, "episode_return_min": -2245.0, "episode_return_mean": -447.24, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.90842755317223, "num_env_steps_trained_throughput_per_sec": 82.90842755317223, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 48644.563, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48644.507, "sample_time_ms": 1207.94, "learn_time_ms": 47417.477, "learn_throughput": 84.357, "synch_weights_time_ms": 15.269}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-45-00", "timestamp": 1723499100, "time_this_iter_s": 48.283787965774536, "time_total_s": 535.3231184482574, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88339d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 535.3231184482574, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 21.36470588235294, "ram_util_percent": 82.71470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.429708705471937, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1348964168911888, "policy_loss": -0.012747123210922515, "vf_loss": 1.1457814880622128, "vf_explained_var": 0.004234515958362156, "kl": 0.0062068383262386334, "entropy": 1.4799930405364465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.722194250393166, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.466288852123987, "policy_loss": -0.014225464095928208, "vf_loss": 2.4792597355035246, "vf_explained_var": -0.005463332379305804, "kl": 0.006272907583323948, "entropy": 1.5058125803710292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -2245.0, "episode_reward_mean": -319.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1920.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 98.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -385.225, "predator_policy": 225.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-334.0, -619.0, -315.0, -1418.0, -2245.0, -1.0, -220.0, -674.0, -394.0, -109.0, -701.0, -235.0, -368.0, -545.0, -215.0, -428.0, -885.0, -640.0, -224.0, -359.0, -1325.0, -111.0, -271.0, -73.0, -409.0, 0.0, -217.0, -743.0, -149.0, -127.0, -305.0, -287.0, -130.0, -565.0, -1074.0, -172.0, -298.0, -47.0, 32.0, -170.0, -35.0, -657.0, -533.0, -292.0, -32.0, -229.0, -195.0, 12.0, -601.0, -300.0, -894.0, 47.0, -605.0, -70.0, -197.0, -425.0, -338.0, -92.0, -677.0, -14.0, 28.0, -33.0, -238.0, -182.0, -70.0, -239.0, -354.0, -389.0, -64.0, -673.0, -19.0, -5.0, -478.0, 17.0, -187.0, 4.0, -59.0, -203.0, -394.0, -12.0, -738.0, -941.0, -355.0, -588.0, 29.0, -106.0, -14.0, 23.0, -158.0, -53.0, -24.0, -295.0, 60.0, -219.0, -59.0, -103.0, -23.0, -473.0, -596.0, -235.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-391.0, -328.0, -430.0, -814.0, -150.0, -480.0, -768.0, -1790.0, -1480.0, -1730.0, -309.0, 98.0, -1200.0, -10.0, -1318.0, -191.0, -214.0, -1240.0, -245.0, 6.0, -430.0, -606.0, -1560.0, -10.0, -1280.0, -68.0, -545.0, -1320.0, -100.0, -1060.0, -8.0, -1520.0, -1300.0, -400.0, -1316.0, -414.0, -1430.0, 16.0, -299.0, -530.0, -1330.0, -1260.0, -184.0, -57.0, -126.0, -780.0, -150.0, -3.0, -770.0, -104.0, 0.0, 0.0, -508.0, 21.0, -1148.0, -470.0, -400.0, -54.0, 18.0, -375.0, -13.0, -1317.0, 11.0, -1258.0, -289.0, -151.0, -1677.0, 47.0, -970.0, -1214.0, 8.0, -1920.0, -190.0, -798.0, -18.0, -89.0, 0.0, 32.0, 0.0, -930.0, 0.0, -70.0, -81.0, -1311.0, 2.0, -1070.0, -1420.0, 3.0, -109.0, 12.0, -270.0, -224.0, 5.0, -400.0, -8.0, 5.0, -1117.0, -89.0, -986.0, -129.0, -634.0, -610.0, 12.0, 35.0, -470.0, -740.0, -130.0, -50.0, -127.0, -470.0, 0.0, -850.0, 12.0, -870.0, -223.0, 6.0, -1780.0, 3.0, -35.0, 1.0, 25.0, 3.0, -10.0, -58.0, -179.0, -299.0, -380.0, -22.0, 21.0, -186.0, -109.0, -470.0, -720.0, 6.0, 1.0, -1000.0, -109.0, -10.0, -138.0, -1210.0, -47.0, 3.0, 0.0, -40.0, -930.0, -123.0, 0.0, 17.0, 12.0, -399.0, 0.0, 4.0, 15.0, -149.0, -910.0, 7.0, -324.0, -280.0, -4.0, -63.0, -128.0, -1400.0, -91.0, -1700.0, -180.0, -380.0, -420.0, -398.0, 29.0, 0.0, -250.0, 14.0, 36.0, -110.0, -17.0, 25.0, -280.0, -38.0, 2.0, -120.0, 1.0, -50.0, -30.0, -640.0, 57.0, 3.0, -326.0, -118.0, -125.0, 1.0, -213.0, 0.0, -128.0, 10.0, -450.0, -323.0, -700.0, -326.0, -350.0, -120.0], "policy_predator_policy_reward": [25.0, 360.0, 215.0, 410.0, 315.0, 0.0, 720.0, 420.0, 810.0, 155.0, 55.0, 155.0, 545.0, 445.0, 640.0, 195.0, 405.0, 655.0, 130.0, 0.0, 5.0, 330.0, 680.0, 655.0, 550.0, 430.0, 710.0, 610.0, 570.0, 375.0, 420.0, 680.0, 110.0, 705.0, 445.0, 645.0, 570.0, 620.0, 335.0, 135.0, 750.0, 515.0, 130.0, 0.0, 320.0, 315.0, 0.0, 80.0, 430.0, 35.0, 0.0, 0.0, 245.0, 25.0, 285.0, 590.0, 110.0, 195.0, 190.0, 40.0, 350.0, 675.0, 550.0, 410.0, 90.0, 220.0, 225.0, 840.0, 415.0, 695.0, 960.0, 780.0, 455.0, 235.0, 60.0, 0.0, 0.0, 0.0, 320.0, 440.0, 35.0, 0.0, 75.0, 660.0, 535.0, 0.0, 595.0, 530.0, 0.0, 65.0, 115.0, 150.0, 200.0, 0.0, 15.0, 0.0, 45.0, 560.0, 260.0, 555.0, 350.0, 0.0, 0.0, 0.0, 235.0, 370.0, 50.0, 60.0, 85.0, 315.0, 0.0, 425.0, 205.0, 315.0, 60.0, 65.0, 310.0, 790.0, 0.0, 20.0, 0.0, 0.0, 10.0, 25.0, 155.0, 85.0, 25.0, 195.0, 0.0, 95.0, 150.0, 190.0, 0.0, 360.0, 480.0, 130.0, 55.0, 0.0, 55.0, 620.0, 10.0, 15.0, 35.0, 0.0, 220.0, 355.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 75.0, 0.0, 275.0, 425.0, 140.0, 70.0, 45.0, 10.0, 400.0, 390.0, 225.0, 625.0, 115.0, 90.0, 230.0, 0.0, 0.0, 0.0, 0.0, 130.0, 60.0, 0.0, 0.0, 15.0, 20.0, 140.0, 65.0, 0.0, 15.0, 10.0, 125.0, 250.0, 0.0, 0.0, 60.0, 165.0, 65.0, 0.0, 25.0, 85.0, 60.0, 35.0, 110.0, 190.0, 420.0, 10.0, 60.0, 175.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6527390807424489, "mean_inference_ms": 1.4521698726889116, "mean_action_processing_ms": 0.24955359408549072, "mean_env_wait_ms": 0.19147794520397154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00372159481048584, "StateBufferConnector_ms": 0.003248929977416992, "ViewRequirementAgentConnector_ms": 0.09891986846923828}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -2245.0, "episode_return_mean": -319.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.005885589212, "num_env_steps_trained_throughput_per_sec": 83.005885589212, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 48546.512, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48546.456, "sample_time_ms": 1185.765, "learn_time_ms": 47343.215, "learn_throughput": 84.489, "synch_weights_time_ms": 13.938}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-45-48", "timestamp": 1723499148, "time_this_iter_s": 48.22726011276245, "time_total_s": 583.5503785610199, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aad3da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 583.5503785610199, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 20.95, "ram_util_percent": 82.77499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3756904435457376, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.032212267413972, "policy_loss": -0.013831833888722396, "vf_loss": 1.0447875829679625, "vf_explained_var": 0.0025827596742640097, "kl": 0.004188398751728519, "entropy": 1.4761359995004362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.630276175623848, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.267287560871669, "policy_loss": -0.01333968060894342, "vf_loss": 2.279004240792895, "vf_explained_var": 1.8885873612903413e-05, "kl": 0.008114940705162853, "entropy": 1.517801881214929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -1325.0, "episode_reward_mean": -234.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1920.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 57.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -279.95, "predator_policy": 162.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-224.0, -359.0, -1325.0, -111.0, -271.0, -73.0, -409.0, 0.0, -217.0, -743.0, -149.0, -127.0, -305.0, -287.0, -130.0, -565.0, -1074.0, -172.0, -298.0, -47.0, 32.0, -170.0, -35.0, -657.0, -533.0, -292.0, -32.0, -229.0, -195.0, 12.0, -601.0, -300.0, -894.0, 47.0, -605.0, -70.0, -197.0, -425.0, -338.0, -92.0, -677.0, -14.0, 28.0, -33.0, -238.0, -182.0, -70.0, -239.0, -354.0, -389.0, -64.0, -673.0, -19.0, -5.0, -478.0, 17.0, -187.0, 4.0, -59.0, -203.0, -394.0, -12.0, -738.0, -941.0, -355.0, -588.0, 29.0, -106.0, -14.0, 23.0, -158.0, -53.0, -24.0, -295.0, 60.0, -219.0, -59.0, -103.0, -23.0, -473.0, -596.0, -235.0, -94.0, -13.0, -64.0, -55.0, -62.0, -76.0, -12.0, -89.0, -43.0, -146.0, -48.0, 24.0, -20.0, -120.0, -22.0, -13.0, 28.0, -1076.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1430.0, 16.0, -299.0, -530.0, -1330.0, -1260.0, -184.0, -57.0, -126.0, -780.0, -150.0, -3.0, -770.0, -104.0, 0.0, 0.0, -508.0, 21.0, -1148.0, -470.0, -400.0, -54.0, 18.0, -375.0, -13.0, -1317.0, 11.0, -1258.0, -289.0, -151.0, -1677.0, 47.0, -970.0, -1214.0, 8.0, -1920.0, -190.0, -798.0, -18.0, -89.0, 0.0, 32.0, 0.0, -930.0, 0.0, -70.0, -81.0, -1311.0, 2.0, -1070.0, -1420.0, 3.0, -109.0, 12.0, -270.0, -224.0, 5.0, -400.0, -8.0, 5.0, -1117.0, -89.0, -986.0, -129.0, -634.0, -610.0, 12.0, 35.0, -470.0, -740.0, -130.0, -50.0, -127.0, -470.0, 0.0, -850.0, 12.0, -870.0, -223.0, 6.0, -1780.0, 3.0, -35.0, 1.0, 25.0, 3.0, -10.0, -58.0, -179.0, -299.0, -380.0, -22.0, 21.0, -186.0, -109.0, -470.0, -720.0, 6.0, 1.0, -1000.0, -109.0, -10.0, -138.0, -1210.0, -47.0, 3.0, 0.0, -40.0, -930.0, -123.0, 0.0, 17.0, 12.0, -399.0, 0.0, 4.0, 15.0, -149.0, -910.0, 7.0, -324.0, -280.0, -4.0, -63.0, -128.0, -1400.0, -91.0, -1700.0, -180.0, -380.0, -420.0, -398.0, 29.0, 0.0, -250.0, 14.0, 36.0, -110.0, -17.0, 25.0, -280.0, -38.0, 2.0, -120.0, 1.0, -50.0, -30.0, -640.0, 57.0, 3.0, -326.0, -118.0, -125.0, 1.0, -213.0, 0.0, -128.0, 10.0, -450.0, -323.0, -700.0, -326.0, -350.0, -120.0, -115.0, -69.0, -127.0, 9.0, -170.0, 21.0, 9.0, -209.0, 0.0, -137.0, 4.0, -160.0, 0.0, -82.0, 1.0, -205.0, -20.0, -73.0, -150.0, -121.0, -60.0, -68.0, 24.0, 0.0, -290.0, 0.0, -100.0, -70.0, -99.0, 7.0, -63.0, 10.0, 27.0, 1.0, -690.0, -901.0], "policy_predator_policy_reward": [570.0, 620.0, 335.0, 135.0, 750.0, 515.0, 130.0, 0.0, 320.0, 315.0, 0.0, 80.0, 430.0, 35.0, 0.0, 0.0, 245.0, 25.0, 285.0, 590.0, 110.0, 195.0, 190.0, 40.0, 350.0, 675.0, 550.0, 410.0, 90.0, 220.0, 225.0, 840.0, 415.0, 695.0, 960.0, 780.0, 455.0, 235.0, 60.0, 0.0, 0.0, 0.0, 320.0, 440.0, 35.0, 0.0, 75.0, 660.0, 535.0, 0.0, 595.0, 530.0, 0.0, 65.0, 115.0, 150.0, 200.0, 0.0, 15.0, 0.0, 45.0, 560.0, 260.0, 555.0, 350.0, 0.0, 0.0, 0.0, 235.0, 370.0, 50.0, 60.0, 85.0, 315.0, 0.0, 425.0, 205.0, 315.0, 60.0, 65.0, 310.0, 790.0, 0.0, 20.0, 0.0, 0.0, 10.0, 25.0, 155.0, 85.0, 25.0, 195.0, 0.0, 95.0, 150.0, 190.0, 0.0, 360.0, 480.0, 130.0, 55.0, 0.0, 55.0, 620.0, 10.0, 15.0, 35.0, 0.0, 220.0, 355.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 75.0, 0.0, 275.0, 425.0, 140.0, 70.0, 45.0, 10.0, 400.0, 390.0, 225.0, 625.0, 115.0, 90.0, 230.0, 0.0, 0.0, 0.0, 0.0, 130.0, 60.0, 0.0, 0.0, 15.0, 20.0, 140.0, 65.0, 0.0, 15.0, 10.0, 125.0, 250.0, 0.0, 0.0, 60.0, 165.0, 65.0, 0.0, 25.0, 85.0, 60.0, 35.0, 110.0, 190.0, 420.0, 10.0, 60.0, 175.0, 0.0, 90.0, 80.0, 25.0, 85.0, 0.0, 40.0, 105.0, 0.0, 75.0, 0.0, 80.0, 25.0, 45.0, 5.0, 110.0, 50.0, 0.0, 45.0, 80.0, 30.0, 50.0, 0.0, 0.0, 155.0, 115.0, 50.0, 0.0, 70.0, 0.0, 0.0, 40.0, 0.0, 0.0, 45.0, 470.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6484998360023481, "mean_inference_ms": 1.4440341619609527, "mean_action_processing_ms": 0.24857423775532664, "mean_env_wait_ms": 0.1903213530672749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038176774978637695, "StateBufferConnector_ms": 0.003427267074584961, "ViewRequirementAgentConnector_ms": 0.09850108623504639}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -1325.0, "episode_return_mean": -234.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.52769773229925, "num_env_steps_trained_throughput_per_sec": 80.52769773229925, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 48408.671, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48408.624, "sample_time_ms": 1175.017, "learn_time_ms": 47216.486, "learn_throughput": 84.716, "synch_weights_time_ms": 13.863}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-46-38", "timestamp": 1723499198, "time_this_iter_s": 49.71090602874756, "time_total_s": 633.2612845897675, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a887c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 633.2612845897675, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.347887323943667, "ram_util_percent": 83.03521126760563}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.372964712819725, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4815938717158383, "policy_loss": -0.014563483754714961, "vf_loss": 1.4950718663356923, "vf_explained_var": 0.0011334265350664734, "kl": 0.007236587264520421, "entropy": 1.472946338678794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3895939855979234, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6752579080364693, "policy_loss": -0.01170645365713253, "vf_loss": 3.6852364035510514, "vf_explained_var": -0.0009741214848069286, "kl": 0.008639835816639976, "entropy": 1.521533298618579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -1336.0, "episode_reward_mean": -194.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1780.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 57.0, "predator_policy": 840.0}, "policy_reward_mean": {"prey_policy": -200.925, "predator_policy": 103.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-229.0, -195.0, 12.0, -601.0, -300.0, -894.0, 47.0, -605.0, -70.0, -197.0, -425.0, -338.0, -92.0, -677.0, -14.0, 28.0, -33.0, -238.0, -182.0, -70.0, -239.0, -354.0, -389.0, -64.0, -673.0, -19.0, -5.0, -478.0, 17.0, -187.0, 4.0, -59.0, -203.0, -394.0, -12.0, -738.0, -941.0, -355.0, -588.0, 29.0, -106.0, -14.0, 23.0, -158.0, -53.0, -24.0, -295.0, 60.0, -219.0, -59.0, -103.0, -23.0, -473.0, -596.0, -235.0, -94.0, -13.0, -64.0, -55.0, -62.0, -76.0, -12.0, -89.0, -43.0, -146.0, -48.0, 24.0, -20.0, -120.0, -22.0, -13.0, 28.0, -1076.0, 0.0, -310.0, -1021.0, 33.0, -263.0, -56.0, -20.0, -114.0, 7.0, -22.0, 21.0, 23.0, -291.0, 7.0, 6.0, -39.0, -81.0, -162.0, 0.0, -1336.0, -174.0, -285.0, -139.0, 13.0, -284.0, 51.0, -87.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-270.0, -224.0, 5.0, -400.0, -8.0, 5.0, -1117.0, -89.0, -986.0, -129.0, -634.0, -610.0, 12.0, 35.0, -470.0, -740.0, -130.0, -50.0, -127.0, -470.0, 0.0, -850.0, 12.0, -870.0, -223.0, 6.0, -1780.0, 3.0, -35.0, 1.0, 25.0, 3.0, -10.0, -58.0, -179.0, -299.0, -380.0, -22.0, 21.0, -186.0, -109.0, -470.0, -720.0, 6.0, 1.0, -1000.0, -109.0, -10.0, -138.0, -1210.0, -47.0, 3.0, 0.0, -40.0, -930.0, -123.0, 0.0, 17.0, 12.0, -399.0, 0.0, 4.0, 15.0, -149.0, -910.0, 7.0, -324.0, -280.0, -4.0, -63.0, -128.0, -1400.0, -91.0, -1700.0, -180.0, -380.0, -420.0, -398.0, 29.0, 0.0, -250.0, 14.0, 36.0, -110.0, -17.0, 25.0, -280.0, -38.0, 2.0, -120.0, 1.0, -50.0, -30.0, -640.0, 57.0, 3.0, -326.0, -118.0, -125.0, 1.0, -213.0, 0.0, -128.0, 10.0, -450.0, -323.0, -700.0, -326.0, -350.0, -120.0, -115.0, -69.0, -127.0, 9.0, -170.0, 21.0, 9.0, -209.0, 0.0, -137.0, 4.0, -160.0, 0.0, -82.0, 1.0, -205.0, -20.0, -73.0, -150.0, -121.0, -60.0, -68.0, 24.0, 0.0, -290.0, 0.0, -100.0, -70.0, -99.0, 7.0, -63.0, 10.0, 27.0, 1.0, -690.0, -901.0, 0.0, 0.0, -300.0, -320.0, -205.0, -1656.0, 0.0, 33.0, -108.0, -425.0, -42.0, -54.0, 15.0, -255.0, -240.0, -139.0, -26.0, 13.0, -20.0, -27.0, 56.0, -70.0, 22.0, -9.0, -301.0, -150.0, 0.0, 7.0, 3.0, -2.0, -21.0, -63.0, -178.0, -73.0, -409.0, -38.0, 0.0, 0.0, -901.0, -1050.0, -340.0, -24.0, 0.0, -570.0, -149.0, -130.0, 0.0, 13.0, -200.0, -369.0, -4.0, 10.0, 4.0, -206.0], "policy_predator_policy_reward": [115.0, 150.0, 200.0, 0.0, 15.0, 0.0, 45.0, 560.0, 260.0, 555.0, 350.0, 0.0, 0.0, 0.0, 235.0, 370.0, 50.0, 60.0, 85.0, 315.0, 0.0, 425.0, 205.0, 315.0, 60.0, 65.0, 310.0, 790.0, 0.0, 20.0, 0.0, 0.0, 10.0, 25.0, 155.0, 85.0, 25.0, 195.0, 0.0, 95.0, 150.0, 190.0, 0.0, 360.0, 480.0, 130.0, 55.0, 0.0, 55.0, 620.0, 10.0, 15.0, 35.0, 0.0, 220.0, 355.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 75.0, 0.0, 275.0, 425.0, 140.0, 70.0, 45.0, 10.0, 400.0, 390.0, 225.0, 625.0, 115.0, 90.0, 230.0, 0.0, 0.0, 0.0, 0.0, 130.0, 60.0, 0.0, 0.0, 15.0, 20.0, 140.0, 65.0, 0.0, 15.0, 10.0, 125.0, 250.0, 0.0, 0.0, 60.0, 165.0, 65.0, 0.0, 25.0, 85.0, 60.0, 35.0, 110.0, 190.0, 420.0, 10.0, 60.0, 175.0, 0.0, 90.0, 80.0, 25.0, 85.0, 0.0, 40.0, 105.0, 0.0, 75.0, 0.0, 80.0, 25.0, 45.0, 5.0, 110.0, 50.0, 0.0, 45.0, 80.0, 30.0, 50.0, 0.0, 0.0, 155.0, 115.0, 50.0, 0.0, 70.0, 0.0, 0.0, 40.0, 0.0, 0.0, 45.0, 470.0, 0.0, 0.0, 150.0, 160.0, 0.0, 840.0, 0.0, 0.0, 150.0, 120.0, 0.0, 40.0, 95.0, 125.0, 125.0, 140.0, 0.0, 20.0, 0.0, 25.0, 0.0, 35.0, 10.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 45.0, 35.0, 135.0, 85.0, 200.0, 0.0, 0.0, 0.0, 615.0, 170.0, 20.0, 0.0, 285.0, 95.0, 45.0, 0.0, 0.0, 140.0, 145.0, 15.0, 30.0, 0.0, 115.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6442243994800748, "mean_inference_ms": 1.4333745818545947, "mean_action_processing_ms": 0.2471662061192592, "mean_env_wait_ms": 0.18899602800966464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003873586654663086, "StateBufferConnector_ms": 0.0033538341522216797, "ViewRequirementAgentConnector_ms": 0.09405875205993652}, "num_episodes": 27, "episode_return_max": 60.0, "episode_return_min": -1336.0, "episode_return_mean": -194.2, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.93496728159539, "num_env_steps_trained_throughput_per_sec": 82.93496728159539, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 48369.078, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48369.031, "sample_time_ms": 1163.847, "learn_time_ms": 47188.625, "learn_throughput": 84.766, "synch_weights_time_ms": 13.287}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-47-26", "timestamp": 1723499246, "time_this_iter_s": 48.250787019729614, "time_total_s": 681.5120716094971, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88783a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 681.5120716094971, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 22.116176470588236, "ram_util_percent": 82.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4575043875704368, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6438500500229933, "policy_loss": -0.01474794921411014, "vf_loss": 2.657019408102389, "vf_explained_var": 0.00044906826877089405, "kl": 0.010523885870996718, "entropy": 1.4561432103631358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4556837095154656, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.014096935590108, "policy_loss": -0.014364540719836161, "vf_loss": 4.026565021560305, "vf_explained_var": -0.0038755429484856824, "kl": 0.009482243624507218, "entropy": 1.5155701636006593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -1336.0, "episode_reward_mean": -189.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1700.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 57.0, "predator_policy": 840.0}, "policy_reward_mean": {"prey_policy": -194.89, "predator_policy": 100.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.0, -70.0, -239.0, -354.0, -389.0, -64.0, -673.0, -19.0, -5.0, -478.0, 17.0, -187.0, 4.0, -59.0, -203.0, -394.0, -12.0, -738.0, -941.0, -355.0, -588.0, 29.0, -106.0, -14.0, 23.0, -158.0, -53.0, -24.0, -295.0, 60.0, -219.0, -59.0, -103.0, -23.0, -473.0, -596.0, -235.0, -94.0, -13.0, -64.0, -55.0, -62.0, -76.0, -12.0, -89.0, -43.0, -146.0, -48.0, 24.0, -20.0, -120.0, -22.0, -13.0, 28.0, -1076.0, 0.0, -310.0, -1021.0, 33.0, -263.0, -56.0, -20.0, -114.0, 7.0, -22.0, 21.0, 23.0, -291.0, 7.0, 6.0, -39.0, -81.0, -162.0, 0.0, -1336.0, -174.0, -285.0, -139.0, 13.0, -284.0, 51.0, -87.0, -116.0, -232.0, 23.0, -255.0, -941.0, -248.0, -60.0, -672.0, 6.0, -482.0, -144.0, -222.0, -362.0, -150.0, -30.0, 30.0, 36.0, -505.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-380.0, -22.0, 21.0, -186.0, -109.0, -470.0, -720.0, 6.0, 1.0, -1000.0, -109.0, -10.0, -138.0, -1210.0, -47.0, 3.0, 0.0, -40.0, -930.0, -123.0, 0.0, 17.0, 12.0, -399.0, 0.0, 4.0, 15.0, -149.0, -910.0, 7.0, -324.0, -280.0, -4.0, -63.0, -128.0, -1400.0, -91.0, -1700.0, -180.0, -380.0, -420.0, -398.0, 29.0, 0.0, -250.0, 14.0, 36.0, -110.0, -17.0, 25.0, -280.0, -38.0, 2.0, -120.0, 1.0, -50.0, -30.0, -640.0, 57.0, 3.0, -326.0, -118.0, -125.0, 1.0, -213.0, 0.0, -128.0, 10.0, -450.0, -323.0, -700.0, -326.0, -350.0, -120.0, -115.0, -69.0, -127.0, 9.0, -170.0, 21.0, 9.0, -209.0, 0.0, -137.0, 4.0, -160.0, 0.0, -82.0, 1.0, -205.0, -20.0, -73.0, -150.0, -121.0, -60.0, -68.0, 24.0, 0.0, -290.0, 0.0, -100.0, -70.0, -99.0, 7.0, -63.0, 10.0, 27.0, 1.0, -690.0, -901.0, 0.0, 0.0, -300.0, -320.0, -205.0, -1656.0, 0.0, 33.0, -108.0, -425.0, -42.0, -54.0, 15.0, -255.0, -240.0, -139.0, -26.0, 13.0, -20.0, -27.0, 56.0, -70.0, 22.0, -9.0, -301.0, -150.0, 0.0, 7.0, 3.0, -2.0, -21.0, -63.0, -178.0, -73.0, -409.0, -38.0, 0.0, 0.0, -901.0, -1050.0, -340.0, -24.0, 0.0, -570.0, -149.0, -130.0, 0.0, 13.0, -200.0, -369.0, -4.0, 10.0, 4.0, -206.0, -80.0, -171.0, -311.0, -166.0, 23.0, 0.0, -110.0, -400.0, -1302.0, -329.0, -40.0, -473.0, 0.0, -120.0, -1417.0, 25.0, 6.0, 0.0, -957.0, -400.0, -97.0, -127.0, -390.0, -57.0, -61.0, -816.0, -250.0, -40.0, -20.0, -85.0, 16.0, -206.0, 18.0, 18.0, -538.0, -587.0], "policy_predator_policy_reward": [25.0, 195.0, 0.0, 95.0, 150.0, 190.0, 0.0, 360.0, 480.0, 130.0, 55.0, 0.0, 55.0, 620.0, 10.0, 15.0, 35.0, 0.0, 220.0, 355.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 75.0, 0.0, 275.0, 425.0, 140.0, 70.0, 45.0, 10.0, 400.0, 390.0, 225.0, 625.0, 115.0, 90.0, 230.0, 0.0, 0.0, 0.0, 0.0, 130.0, 60.0, 0.0, 0.0, 15.0, 20.0, 140.0, 65.0, 0.0, 15.0, 10.0, 125.0, 250.0, 0.0, 0.0, 60.0, 165.0, 65.0, 0.0, 25.0, 85.0, 60.0, 35.0, 110.0, 190.0, 420.0, 10.0, 60.0, 175.0, 0.0, 90.0, 80.0, 25.0, 85.0, 0.0, 40.0, 105.0, 0.0, 75.0, 0.0, 80.0, 25.0, 45.0, 5.0, 110.0, 50.0, 0.0, 45.0, 80.0, 30.0, 50.0, 0.0, 0.0, 155.0, 115.0, 50.0, 0.0, 70.0, 0.0, 0.0, 40.0, 0.0, 0.0, 45.0, 470.0, 0.0, 0.0, 150.0, 160.0, 0.0, 840.0, 0.0, 0.0, 150.0, 120.0, 0.0, 40.0, 95.0, 125.0, 125.0, 140.0, 0.0, 20.0, 0.0, 25.0, 0.0, 35.0, 10.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 45.0, 35.0, 135.0, 85.0, 200.0, 0.0, 0.0, 0.0, 615.0, 170.0, 20.0, 0.0, 285.0, 95.0, 45.0, 0.0, 0.0, 140.0, 145.0, 15.0, 30.0, 0.0, 115.0, 90.0, 45.0, 40.0, 205.0, 0.0, 0.0, 160.0, 95.0, 685.0, 5.0, 95.0, 170.0, 0.0, 60.0, 720.0, 0.0, 0.0, 0.0, 440.0, 435.0, 80.0, 0.0, 225.0, 0.0, 100.0, 415.0, 20.0, 120.0, 30.0, 45.0, 95.0, 125.0, 0.0, 0.0, 285.0, 335.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6400519966112692, "mean_inference_ms": 1.4267891713183178, "mean_action_processing_ms": 0.2466824065316497, "mean_env_wait_ms": 0.1881931484650038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036164522171020508, "StateBufferConnector_ms": 0.003240346908569336, "ViewRequirementAgentConnector_ms": 0.09110891819000244}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -1336.0, "episode_return_mean": -189.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.85428287520514, "num_env_steps_trained_throughput_per_sec": 83.85428287520514, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 48311.401, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48311.355, "sample_time_ms": 1142.415, "learn_time_ms": 47153.14, "learn_throughput": 84.83, "synch_weights_time_ms": 13.036}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-48-14", "timestamp": 1723499294, "time_this_iter_s": 47.75170016288757, "time_total_s": 729.2637717723846, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88821f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 729.2637717723846, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.56029411764706, "ram_util_percent": 83.10147058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6677221349938205, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.959903915344723, "policy_loss": -0.013823352232033377, "vf_loss": 3.972103986412129, "vf_explained_var": 0.0026854688528353573, "kl": 0.010821859651252609, "entropy": 1.4558606795532993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3873906402045457, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.589018847954967, "policy_loss": -0.01021284875459969, "vf_loss": 5.59781904901777, "vf_explained_var": -0.0014547314908769395, "kl": 0.007063340324516601, "entropy": 1.514456406535295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -1438.0, "episode_reward_mean": -242.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1700.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 57.0, "predator_policy": 840.0}, "policy_reward_mean": {"prey_policy": -236.08, "predator_policy": 115.025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-941.0, -355.0, -588.0, 29.0, -106.0, -14.0, 23.0, -158.0, -53.0, -24.0, -295.0, 60.0, -219.0, -59.0, -103.0, -23.0, -473.0, -596.0, -235.0, -94.0, -13.0, -64.0, -55.0, -62.0, -76.0, -12.0, -89.0, -43.0, -146.0, -48.0, 24.0, -20.0, -120.0, -22.0, -13.0, 28.0, -1076.0, 0.0, -310.0, -1021.0, 33.0, -263.0, -56.0, -20.0, -114.0, 7.0, -22.0, 21.0, 23.0, -291.0, 7.0, 6.0, -39.0, -81.0, -162.0, 0.0, -1336.0, -174.0, -285.0, -139.0, 13.0, -284.0, 51.0, -87.0, -116.0, -232.0, 23.0, -255.0, -941.0, -248.0, -60.0, -672.0, 6.0, -482.0, -144.0, -222.0, -362.0, -150.0, -30.0, 30.0, 36.0, -505.0, -115.0, -665.0, -1438.0, -45.0, -438.0, -726.0, -110.0, -1416.0, -295.0, -543.0, -493.0, -491.0, -782.0, -715.0, 14.0, -705.0, -30.0, -340.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-91.0, -1700.0, -180.0, -380.0, -420.0, -398.0, 29.0, 0.0, -250.0, 14.0, 36.0, -110.0, -17.0, 25.0, -280.0, -38.0, 2.0, -120.0, 1.0, -50.0, -30.0, -640.0, 57.0, 3.0, -326.0, -118.0, -125.0, 1.0, -213.0, 0.0, -128.0, 10.0, -450.0, -323.0, -700.0, -326.0, -350.0, -120.0, -115.0, -69.0, -127.0, 9.0, -170.0, 21.0, 9.0, -209.0, 0.0, -137.0, 4.0, -160.0, 0.0, -82.0, 1.0, -205.0, -20.0, -73.0, -150.0, -121.0, -60.0, -68.0, 24.0, 0.0, -290.0, 0.0, -100.0, -70.0, -99.0, 7.0, -63.0, 10.0, 27.0, 1.0, -690.0, -901.0, 0.0, 0.0, -300.0, -320.0, -205.0, -1656.0, 0.0, 33.0, -108.0, -425.0, -42.0, -54.0, 15.0, -255.0, -240.0, -139.0, -26.0, 13.0, -20.0, -27.0, 56.0, -70.0, 22.0, -9.0, -301.0, -150.0, 0.0, 7.0, 3.0, -2.0, -21.0, -63.0, -178.0, -73.0, -409.0, -38.0, 0.0, 0.0, -901.0, -1050.0, -340.0, -24.0, 0.0, -570.0, -149.0, -130.0, 0.0, 13.0, -200.0, -369.0, -4.0, 10.0, 4.0, -206.0, -80.0, -171.0, -311.0, -166.0, 23.0, 0.0, -110.0, -400.0, -1302.0, -329.0, -40.0, -473.0, 0.0, -120.0, -1417.0, 25.0, 6.0, 0.0, -957.0, -400.0, -97.0, -127.0, -390.0, -57.0, -61.0, -816.0, -250.0, -40.0, -20.0, -85.0, 16.0, -206.0, 18.0, 18.0, -538.0, -587.0, 5.0, -240.0, -130.0, -1200.0, -1143.0, -950.0, -70.0, -35.0, -283.0, -510.0, -880.0, -326.0, -250.0, 0.0, -1176.0, -1170.0, -1020.0, 0.0, -888.0, -220.0, -280.0, -653.0, -870.0, -111.0, -496.0, -901.0, -900.0, -470.0, 2.0, 12.0, -380.0, -970.0, -108.0, 3.0, -516.0, -179.0], "policy_predator_policy_reward": [225.0, 625.0, 115.0, 90.0, 230.0, 0.0, 0.0, 0.0, 0.0, 130.0, 60.0, 0.0, 0.0, 15.0, 20.0, 140.0, 65.0, 0.0, 15.0, 10.0, 125.0, 250.0, 0.0, 0.0, 60.0, 165.0, 65.0, 0.0, 25.0, 85.0, 60.0, 35.0, 110.0, 190.0, 420.0, 10.0, 60.0, 175.0, 0.0, 90.0, 80.0, 25.0, 85.0, 0.0, 40.0, 105.0, 0.0, 75.0, 0.0, 80.0, 25.0, 45.0, 5.0, 110.0, 50.0, 0.0, 45.0, 80.0, 30.0, 50.0, 0.0, 0.0, 155.0, 115.0, 50.0, 0.0, 70.0, 0.0, 0.0, 40.0, 0.0, 0.0, 45.0, 470.0, 0.0, 0.0, 150.0, 160.0, 0.0, 840.0, 0.0, 0.0, 150.0, 120.0, 0.0, 40.0, 95.0, 125.0, 125.0, 140.0, 0.0, 20.0, 0.0, 25.0, 0.0, 35.0, 10.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 45.0, 35.0, 135.0, 85.0, 200.0, 0.0, 0.0, 0.0, 615.0, 170.0, 20.0, 0.0, 285.0, 95.0, 45.0, 0.0, 0.0, 140.0, 145.0, 15.0, 30.0, 0.0, 115.0, 90.0, 45.0, 40.0, 205.0, 0.0, 0.0, 160.0, 95.0, 685.0, 5.0, 95.0, 170.0, 0.0, 60.0, 720.0, 0.0, 0.0, 0.0, 440.0, 435.0, 80.0, 0.0, 225.0, 0.0, 100.0, 415.0, 20.0, 120.0, 30.0, 45.0, 95.0, 125.0, 0.0, 0.0, 285.0, 335.0, 120.0, 0.0, 50.0, 615.0, 650.0, 5.0, 0.0, 60.0, 255.0, 100.0, 60.0, 420.0, 95.0, 45.0, 480.0, 450.0, 405.0, 320.0, 455.0, 110.0, 50.0, 390.0, 0.0, 490.0, 0.0, 615.0, 260.0, 395.0, 0.0, 0.0, 490.0, 155.0, 20.0, 55.0, 190.0, 165.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6368396982037798, "mean_inference_ms": 1.4198607863957093, "mean_action_processing_ms": 0.24585275193107073, "mean_env_wait_ms": 0.18734103529880974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035866498947143555, "StateBufferConnector_ms": 0.0032110214233398438, "ViewRequirementAgentConnector_ms": 0.09162044525146484}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -1438.0, "episode_return_mean": -242.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.45113919430352, "num_env_steps_trained_throughput_per_sec": 84.45113919430352, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 48222.09, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48222.036, "sample_time_ms": 1136.593, "learn_time_ms": 47069.905, "learn_throughput": 84.98, "synch_weights_time_ms": 12.921}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-49-01", "timestamp": 1723499341, "time_this_iter_s": 47.393707036972046, "time_total_s": 776.6574788093567, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a85efaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 776.6574788093567, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.044776119402986, "ram_util_percent": 82.66417910447761}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5718642251201407, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.172466469315625, "policy_loss": -0.015825268041795838, "vf_loss": 4.1865567518920495, "vf_explained_var": 0.0014408528804779053, "kl": 0.011566561343888608, "entropy": 1.4571393878371628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4023355718642945, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.841598992877536, "policy_loss": -0.01102295815846119, "vf_loss": 4.850699111645815, "vf_explained_var": -0.004173493858367678, "kl": 0.009614243491787796, "entropy": 1.4804364135656407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 51.0, "episode_reward_min": -1438.0, "episode_reward_mean": -271.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1656.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 56.0, "predator_policy": 840.0}, "policy_reward_mean": {"prey_policy": -263.7, "predator_policy": 128.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-235.0, -94.0, -13.0, -64.0, -55.0, -62.0, -76.0, -12.0, -89.0, -43.0, -146.0, -48.0, 24.0, -20.0, -120.0, -22.0, -13.0, 28.0, -1076.0, 0.0, -310.0, -1021.0, 33.0, -263.0, -56.0, -20.0, -114.0, 7.0, -22.0, 21.0, 23.0, -291.0, 7.0, 6.0, -39.0, -81.0, -162.0, 0.0, -1336.0, -174.0, -285.0, -139.0, 13.0, -284.0, 51.0, -87.0, -116.0, -232.0, 23.0, -255.0, -941.0, -248.0, -60.0, -672.0, 6.0, -482.0, -144.0, -222.0, -362.0, -150.0, -30.0, 30.0, 36.0, -505.0, -115.0, -665.0, -1438.0, -45.0, -438.0, -726.0, -110.0, -1416.0, -295.0, -543.0, -493.0, -491.0, -782.0, -715.0, 14.0, -705.0, -30.0, -340.0, -12.0, 13.0, -845.0, -305.0, 0.0, -10.0, -26.0, -1138.0, -723.0, 7.0, -389.0, -307.0, -470.0, -374.0, -798.0, -1159.0, 12.0, -280.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-350.0, -120.0, -115.0, -69.0, -127.0, 9.0, -170.0, 21.0, 9.0, -209.0, 0.0, -137.0, 4.0, -160.0, 0.0, -82.0, 1.0, -205.0, -20.0, -73.0, -150.0, -121.0, -60.0, -68.0, 24.0, 0.0, -290.0, 0.0, -100.0, -70.0, -99.0, 7.0, -63.0, 10.0, 27.0, 1.0, -690.0, -901.0, 0.0, 0.0, -300.0, -320.0, -205.0, -1656.0, 0.0, 33.0, -108.0, -425.0, -42.0, -54.0, 15.0, -255.0, -240.0, -139.0, -26.0, 13.0, -20.0, -27.0, 56.0, -70.0, 22.0, -9.0, -301.0, -150.0, 0.0, 7.0, 3.0, -2.0, -21.0, -63.0, -178.0, -73.0, -409.0, -38.0, 0.0, 0.0, -901.0, -1050.0, -340.0, -24.0, 0.0, -570.0, -149.0, -130.0, 0.0, 13.0, -200.0, -369.0, -4.0, 10.0, 4.0, -206.0, -80.0, -171.0, -311.0, -166.0, 23.0, 0.0, -110.0, -400.0, -1302.0, -329.0, -40.0, -473.0, 0.0, -120.0, -1417.0, 25.0, 6.0, 0.0, -957.0, -400.0, -97.0, -127.0, -390.0, -57.0, -61.0, -816.0, -250.0, -40.0, -20.0, -85.0, 16.0, -206.0, 18.0, 18.0, -538.0, -587.0, 5.0, -240.0, -130.0, -1200.0, -1143.0, -950.0, -70.0, -35.0, -283.0, -510.0, -880.0, -326.0, -250.0, 0.0, -1176.0, -1170.0, -1020.0, 0.0, -888.0, -220.0, -280.0, -653.0, -870.0, -111.0, -496.0, -901.0, -900.0, -470.0, 2.0, 12.0, -380.0, -970.0, -108.0, 3.0, -516.0, -179.0, -57.0, 0.0, 11.0, 2.0, -950.0, -760.0, -340.0, -270.0, 0.0, 0.0, 0.0, -140.0, -51.0, -10.0, -950.0, -1108.0, -496.0, -712.0, 0.0, -33.0, -412.0, -292.0, -77.0, -670.0, -370.0, -300.0, -889.0, 0.0, -1029.0, -469.0, -927.0, -922.0, 12.0, 0.0, -20.0, -530.0], "policy_predator_policy_reward": [60.0, 175.0, 0.0, 90.0, 80.0, 25.0, 85.0, 0.0, 40.0, 105.0, 0.0, 75.0, 0.0, 80.0, 25.0, 45.0, 5.0, 110.0, 50.0, 0.0, 45.0, 80.0, 30.0, 50.0, 0.0, 0.0, 155.0, 115.0, 50.0, 0.0, 70.0, 0.0, 0.0, 40.0, 0.0, 0.0, 45.0, 470.0, 0.0, 0.0, 150.0, 160.0, 0.0, 840.0, 0.0, 0.0, 150.0, 120.0, 0.0, 40.0, 95.0, 125.0, 125.0, 140.0, 0.0, 20.0, 0.0, 25.0, 0.0, 35.0, 10.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 45.0, 35.0, 135.0, 85.0, 200.0, 0.0, 0.0, 0.0, 615.0, 170.0, 20.0, 0.0, 285.0, 95.0, 45.0, 0.0, 0.0, 140.0, 145.0, 15.0, 30.0, 0.0, 115.0, 90.0, 45.0, 40.0, 205.0, 0.0, 0.0, 160.0, 95.0, 685.0, 5.0, 95.0, 170.0, 0.0, 60.0, 720.0, 0.0, 0.0, 0.0, 440.0, 435.0, 80.0, 0.0, 225.0, 0.0, 100.0, 415.0, 20.0, 120.0, 30.0, 45.0, 95.0, 125.0, 0.0, 0.0, 285.0, 335.0, 120.0, 0.0, 50.0, 615.0, 650.0, 5.0, 0.0, 60.0, 255.0, 100.0, 60.0, 420.0, 95.0, 45.0, 480.0, 450.0, 405.0, 320.0, 455.0, 110.0, 50.0, 390.0, 0.0, 490.0, 0.0, 615.0, 260.0, 395.0, 0.0, 0.0, 490.0, 155.0, 20.0, 55.0, 190.0, 165.0, 25.0, 20.0, 0.0, 0.0, 350.0, 515.0, 290.0, 15.0, 0.0, 0.0, 60.0, 70.0, 30.0, 5.0, 310.0, 610.0, 125.0, 360.0, 30.0, 10.0, 40.0, 275.0, 130.0, 310.0, 180.0, 20.0, 325.0, 190.0, 125.0, 575.0, 690.0, 0.0, 0.0, 0.0, 270.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6337740635225637, "mean_inference_ms": 1.4129619406262781, "mean_action_processing_ms": 0.24494050040702567, "mean_env_wait_ms": 0.18642977612853337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370633602142334, "StateBufferConnector_ms": 0.0032339096069335938, "ViewRequirementAgentConnector_ms": 0.09372067451477051}, "num_episodes": 18, "episode_return_max": 51.0, "episode_return_min": -1438.0, "episode_return_mean": -271.2, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.89829978736402, "num_env_steps_trained_throughput_per_sec": 83.89829978736402, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 48168.053, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48168.0, "sample_time_ms": 1123.801, "learn_time_ms": 47028.71, "learn_throughput": 85.054, "synch_weights_time_ms": 12.931}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-49-49", "timestamp": 1723499389, "time_this_iter_s": 47.72801470756531, "time_total_s": 824.385493516922, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8833820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 824.385493516922, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.299999999999997, "ram_util_percent": 82.7865671641791}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3876381117515464, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.194778855010946, "policy_loss": -0.01130309593075364, "vf_loss": 5.204189045845516, "vf_explained_var": 0.0005432904712737552, "kl": 0.012619314103874046, "entropy": 1.414094529517744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.698378810775343, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.59015052028434, "policy_loss": -0.010335203414664618, "vf_loss": 5.598761217556302, "vf_explained_var": 0.0009595702249537069, "kl": 0.008622586669319605, "entropy": 1.4691206074265577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 103.0, "episode_reward_min": -1438.0, "episode_reward_mean": -316.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1710.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.0, "predator_policy": 820.0}, "policy_reward_mean": {"prey_policy": -314.265, "predator_policy": 156.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, -263.0, -56.0, -20.0, -114.0, 7.0, -22.0, 21.0, 23.0, -291.0, 7.0, 6.0, -39.0, -81.0, -162.0, 0.0, -1336.0, -174.0, -285.0, -139.0, 13.0, -284.0, 51.0, -87.0, -116.0, -232.0, 23.0, -255.0, -941.0, -248.0, -60.0, -672.0, 6.0, -482.0, -144.0, -222.0, -362.0, -150.0, -30.0, 30.0, 36.0, -505.0, -115.0, -665.0, -1438.0, -45.0, -438.0, -726.0, -110.0, -1416.0, -295.0, -543.0, -493.0, -491.0, -782.0, -715.0, 14.0, -705.0, -30.0, -340.0, -12.0, 13.0, -845.0, -305.0, 0.0, -10.0, -26.0, -1138.0, -723.0, 7.0, -389.0, -307.0, -470.0, -374.0, -798.0, -1159.0, 12.0, -280.0, -623.0, -399.0, -854.0, -310.0, 103.0, -1110.0, 1.0, -1152.0, 10.0, -35.0, -509.0, -271.0, -660.0, -70.0, -515.0, -128.0, 0.0, -60.0, -435.0, -597.0, -361.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 33.0, -108.0, -425.0, -42.0, -54.0, 15.0, -255.0, -240.0, -139.0, -26.0, 13.0, -20.0, -27.0, 56.0, -70.0, 22.0, -9.0, -301.0, -150.0, 0.0, 7.0, 3.0, -2.0, -21.0, -63.0, -178.0, -73.0, -409.0, -38.0, 0.0, 0.0, -901.0, -1050.0, -340.0, -24.0, 0.0, -570.0, -149.0, -130.0, 0.0, 13.0, -200.0, -369.0, -4.0, 10.0, 4.0, -206.0, -80.0, -171.0, -311.0, -166.0, 23.0, 0.0, -110.0, -400.0, -1302.0, -329.0, -40.0, -473.0, 0.0, -120.0, -1417.0, 25.0, 6.0, 0.0, -957.0, -400.0, -97.0, -127.0, -390.0, -57.0, -61.0, -816.0, -250.0, -40.0, -20.0, -85.0, 16.0, -206.0, 18.0, 18.0, -538.0, -587.0, 5.0, -240.0, -130.0, -1200.0, -1143.0, -950.0, -70.0, -35.0, -283.0, -510.0, -880.0, -326.0, -250.0, 0.0, -1176.0, -1170.0, -1020.0, 0.0, -888.0, -220.0, -280.0, -653.0, -870.0, -111.0, -496.0, -901.0, -900.0, -470.0, 2.0, 12.0, -380.0, -970.0, -108.0, 3.0, -516.0, -179.0, -57.0, 0.0, 11.0, 2.0, -950.0, -760.0, -340.0, -270.0, 0.0, 0.0, 0.0, -140.0, -51.0, -10.0, -950.0, -1108.0, -496.0, -712.0, 0.0, -33.0, -412.0, -292.0, -77.0, -670.0, -370.0, -300.0, -889.0, 0.0, -1029.0, -469.0, -927.0, -922.0, 12.0, 0.0, -20.0, -530.0, -650.0, -723.0, -246.0, -708.0, -1623.0, -121.0, -357.0, -348.0, 78.0, 0.0, -475.0, -1710.0, -46.0, 22.0, -1435.0, -707.0, 0.0, 10.0, -30.0, -55.0, -960.0, -29.0, -680.0, 4.0, -1100.0, -150.0, -100.0, -40.0, -40.0, -960.0, -363.0, 0.0, 0.0, 0.0, 0.0, -120.0, -277.0, -613.0, -462.0, -810.0, -40.0, -1066.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 150.0, 120.0, 0.0, 40.0, 95.0, 125.0, 125.0, 140.0, 0.0, 20.0, 0.0, 25.0, 0.0, 35.0, 10.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 45.0, 35.0, 135.0, 85.0, 200.0, 0.0, 0.0, 0.0, 615.0, 170.0, 20.0, 0.0, 285.0, 95.0, 45.0, 0.0, 0.0, 140.0, 145.0, 15.0, 30.0, 0.0, 115.0, 90.0, 45.0, 40.0, 205.0, 0.0, 0.0, 160.0, 95.0, 685.0, 5.0, 95.0, 170.0, 0.0, 60.0, 720.0, 0.0, 0.0, 0.0, 440.0, 435.0, 80.0, 0.0, 225.0, 0.0, 100.0, 415.0, 20.0, 120.0, 30.0, 45.0, 95.0, 125.0, 0.0, 0.0, 285.0, 335.0, 120.0, 0.0, 50.0, 615.0, 650.0, 5.0, 0.0, 60.0, 255.0, 100.0, 60.0, 420.0, 95.0, 45.0, 480.0, 450.0, 405.0, 320.0, 455.0, 110.0, 50.0, 390.0, 0.0, 490.0, 0.0, 615.0, 260.0, 395.0, 0.0, 0.0, 490.0, 155.0, 20.0, 55.0, 190.0, 165.0, 25.0, 20.0, 0.0, 0.0, 350.0, 515.0, 290.0, 15.0, 0.0, 0.0, 60.0, 70.0, 30.0, 5.0, 310.0, 610.0, 125.0, 360.0, 30.0, 10.0, 40.0, 275.0, 130.0, 310.0, 180.0, 20.0, 325.0, 190.0, 125.0, 575.0, 690.0, 0.0, 0.0, 0.0, 270.0, 0.0, 450.0, 300.0, 185.0, 370.0, 820.0, 70.0, 165.0, 230.0, 0.0, 25.0, 755.0, 320.0, 25.0, 0.0, 455.0, 535.0, 0.0, 0.0, 35.0, 15.0, 0.0, 480.0, 370.0, 35.0, 0.0, 590.0, 70.0, 0.0, 470.0, 15.0, 235.0, 0.0, 0.0, 0.0, 0.0, 60.0, 455.0, 0.0, 405.0, 270.0, 315.0, 430.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6298591528605848, "mean_inference_ms": 1.40295004889784, "mean_action_processing_ms": 0.2437091575956552, "mean_env_wait_ms": 0.1850475842497223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003476381301879883, "StateBufferConnector_ms": 0.002940058708190918, "ViewRequirementAgentConnector_ms": 0.08890807628631592}, "num_episodes": 22, "episode_return_max": 103.0, "episode_return_min": -1438.0, "episode_return_mean": -316.28, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.12769642669139, "num_env_steps_trained_throughput_per_sec": 84.12769642669139, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 48052.436, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48052.386, "sample_time_ms": 1113.474, "learn_time_ms": 46924.058, "learn_throughput": 85.244, "synch_weights_time_ms": 12.572}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-50-36", "timestamp": 1723499436, "time_this_iter_s": 47.59528613090515, "time_total_s": 871.9807796478271, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88acb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 871.9807796478271, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.808823529411768, "ram_util_percent": 82.89117647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4265945026168116, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.019788807157486, "policy_loss": -0.013388919363675452, "vf_loss": 6.031509613864636, "vf_explained_var": 0.0008560594112154037, "kl": 0.011120714157445446, "entropy": 1.4015953947627355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0382957943532833, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.983499336747266, "policy_loss": -0.0076678001707439465, "vf_loss": 5.989776842934745, "vf_explained_var": 0.0034683392476783227, "kl": 0.006951502010355144, "entropy": 1.462020881466134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 103.0, "episode_reward_min": -1895.0, "episode_reward_mean": -376.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1850.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 103.0, "predator_policy": 860.0}, "policy_reward_mean": {"prey_policy": -386.985, "predator_policy": 198.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-87.0, -116.0, -232.0, 23.0, -255.0, -941.0, -248.0, -60.0, -672.0, 6.0, -482.0, -144.0, -222.0, -362.0, -150.0, -30.0, 30.0, 36.0, -505.0, -115.0, -665.0, -1438.0, -45.0, -438.0, -726.0, -110.0, -1416.0, -295.0, -543.0, -493.0, -491.0, -782.0, -715.0, 14.0, -705.0, -30.0, -340.0, -12.0, 13.0, -845.0, -305.0, 0.0, -10.0, -26.0, -1138.0, -723.0, 7.0, -389.0, -307.0, -470.0, -374.0, -798.0, -1159.0, 12.0, -280.0, -623.0, -399.0, -854.0, -310.0, 103.0, -1110.0, 1.0, -1152.0, 10.0, -35.0, -509.0, -271.0, -660.0, -70.0, -515.0, -128.0, 0.0, -60.0, -435.0, -597.0, -361.0, 0.0, -140.0, -187.0, -585.0, -81.0, -333.0, -135.0, -444.0, 63.0, -138.0, -1895.0, -745.0, -545.0, -465.0, -890.0, -438.0, -123.0, -331.0, -382.0, -325.0, -263.0, -273.0, -464.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, -206.0, -80.0, -171.0, -311.0, -166.0, 23.0, 0.0, -110.0, -400.0, -1302.0, -329.0, -40.0, -473.0, 0.0, -120.0, -1417.0, 25.0, 6.0, 0.0, -957.0, -400.0, -97.0, -127.0, -390.0, -57.0, -61.0, -816.0, -250.0, -40.0, -20.0, -85.0, 16.0, -206.0, 18.0, 18.0, -538.0, -587.0, 5.0, -240.0, -130.0, -1200.0, -1143.0, -950.0, -70.0, -35.0, -283.0, -510.0, -880.0, -326.0, -250.0, 0.0, -1176.0, -1170.0, -1020.0, 0.0, -888.0, -220.0, -280.0, -653.0, -870.0, -111.0, -496.0, -901.0, -900.0, -470.0, 2.0, 12.0, -380.0, -970.0, -108.0, 3.0, -516.0, -179.0, -57.0, 0.0, 11.0, 2.0, -950.0, -760.0, -340.0, -270.0, 0.0, 0.0, 0.0, -140.0, -51.0, -10.0, -950.0, -1108.0, -496.0, -712.0, 0.0, -33.0, -412.0, -292.0, -77.0, -670.0, -370.0, -300.0, -889.0, 0.0, -1029.0, -469.0, -927.0, -922.0, 12.0, 0.0, -20.0, -530.0, -650.0, -723.0, -246.0, -708.0, -1623.0, -121.0, -357.0, -348.0, 78.0, 0.0, -475.0, -1710.0, -46.0, 22.0, -1435.0, -707.0, 0.0, 10.0, -30.0, -55.0, -960.0, -29.0, -680.0, 4.0, -1100.0, -150.0, -100.0, -40.0, -40.0, -960.0, -363.0, 0.0, 0.0, 0.0, 0.0, -120.0, -277.0, -613.0, -462.0, -810.0, -40.0, -1066.0, 0.0, 0.0, -280.0, 0.0, -321.0, -131.0, -110.0, -1100.0, 0.0, -466.0, 103.0, -1071.0, -15.0, -240.0, -950.0, 31.0, 0.0, 63.0, -120.0, -173.0, -1850.0, -1570.0, -1020.0, -565.0, -280.0, -810.0, -160.0, -1150.0, -1190.0, -660.0, -998.0, 0.0, 13.0, -566.0, -30.0, -1031.0, -517.0, -390.0, -920.0, -280.0, -293.0, -320.0, -573.0, 0.0, -160.0, -659.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 115.0, 90.0, 45.0, 40.0, 205.0, 0.0, 0.0, 160.0, 95.0, 685.0, 5.0, 95.0, 170.0, 0.0, 60.0, 720.0, 0.0, 0.0, 0.0, 440.0, 435.0, 80.0, 0.0, 225.0, 0.0, 100.0, 415.0, 20.0, 120.0, 30.0, 45.0, 95.0, 125.0, 0.0, 0.0, 285.0, 335.0, 120.0, 0.0, 50.0, 615.0, 650.0, 5.0, 0.0, 60.0, 255.0, 100.0, 60.0, 420.0, 95.0, 45.0, 480.0, 450.0, 405.0, 320.0, 455.0, 110.0, 50.0, 390.0, 0.0, 490.0, 0.0, 615.0, 260.0, 395.0, 0.0, 0.0, 490.0, 155.0, 20.0, 55.0, 190.0, 165.0, 25.0, 20.0, 0.0, 0.0, 350.0, 515.0, 290.0, 15.0, 0.0, 0.0, 60.0, 70.0, 30.0, 5.0, 310.0, 610.0, 125.0, 360.0, 30.0, 10.0, 40.0, 275.0, 130.0, 310.0, 180.0, 20.0, 325.0, 190.0, 125.0, 575.0, 690.0, 0.0, 0.0, 0.0, 270.0, 0.0, 450.0, 300.0, 185.0, 370.0, 820.0, 70.0, 165.0, 230.0, 0.0, 25.0, 755.0, 320.0, 25.0, 0.0, 455.0, 535.0, 0.0, 0.0, 35.0, 15.0, 0.0, 480.0, 370.0, 35.0, 0.0, 590.0, 70.0, 0.0, 470.0, 15.0, 235.0, 0.0, 0.0, 0.0, 0.0, 60.0, 455.0, 0.0, 405.0, 270.0, 315.0, 430.0, 0.0, 0.0, 140.0, 0.0, 10.0, 255.0, 180.0, 445.0, 170.0, 215.0, 190.0, 445.0, 120.0, 0.0, 475.0, 0.0, 0.0, 0.0, 85.0, 70.0, 665.0, 860.0, 330.0, 510.0, 545.0, 0.0, 245.0, 600.0, 340.0, 620.0, 520.0, 40.0, 205.0, 225.0, 525.0, 205.0, 335.0, 190.0, 445.0, 430.0, 350.0, 0.0, 10.0, 290.0, 355.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6263702328626458, "mean_inference_ms": 1.394257367388211, "mean_action_processing_ms": 0.24228959271961004, "mean_env_wait_ms": 0.18376719778485714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006938576698303223, "StateBufferConnector_ms": 0.0048389434814453125, "ViewRequirementAgentConnector_ms": 0.12942016124725342}, "num_episodes": 23, "episode_return_max": 103.0, "episode_return_min": -1895.0, "episode_return_mean": -376.42, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.88511028812506, "num_env_steps_trained_throughput_per_sec": 83.88511028812506, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 48051.672, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48051.623, "sample_time_ms": 1107.971, "learn_time_ms": 46928.667, "learn_throughput": 85.236, "synch_weights_time_ms": 12.758}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-51-24", "timestamp": 1723499484, "time_this_iter_s": 47.726948738098145, "time_total_s": 919.7077283859253, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88339d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 919.7077283859253, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.034328358208956, "ram_util_percent": 82.6641791044776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4529746618693469, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.095312340549691, "policy_loss": -0.01135329359073054, "vf_loss": 5.10531483869704, "vf_explained_var": 0.0003682714921456796, "kl": 0.009005284403380236, "entropy": 1.3821244896404328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.273073175880644, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.040623854329346, "policy_loss": -0.01320837715039493, "vf_loss": 6.051502955401385, "vf_explained_var": 0.007521309707530592, "kl": 0.011646370675630874, "entropy": 1.4401678420879223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 103.0, "episode_reward_min": -1895.0, "episode_reward_mean": -408.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1850.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 103.0, "predator_policy": 950.0}, "policy_reward_mean": {"prey_policy": -424.955, "predator_policy": 220.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-505.0, -115.0, -665.0, -1438.0, -45.0, -438.0, -726.0, -110.0, -1416.0, -295.0, -543.0, -493.0, -491.0, -782.0, -715.0, 14.0, -705.0, -30.0, -340.0, -12.0, 13.0, -845.0, -305.0, 0.0, -10.0, -26.0, -1138.0, -723.0, 7.0, -389.0, -307.0, -470.0, -374.0, -798.0, -1159.0, 12.0, -280.0, -623.0, -399.0, -854.0, -310.0, 103.0, -1110.0, 1.0, -1152.0, 10.0, -35.0, -509.0, -271.0, -660.0, -70.0, -515.0, -128.0, 0.0, -60.0, -435.0, -597.0, -361.0, 0.0, -140.0, -187.0, -585.0, -81.0, -333.0, -135.0, -444.0, 63.0, -138.0, -1895.0, -745.0, -545.0, -465.0, -890.0, -438.0, -123.0, -331.0, -382.0, -325.0, -263.0, -273.0, -464.0, 0.0, -1005.0, -100.0, -471.0, -592.0, -366.0, -540.0, -162.0, 0.0, -471.0, -575.0, -141.0, -194.0, -244.0, -1800.0, -505.0, 2.0, 5.0, 59.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-538.0, -587.0, 5.0, -240.0, -130.0, -1200.0, -1143.0, -950.0, -70.0, -35.0, -283.0, -510.0, -880.0, -326.0, -250.0, 0.0, -1176.0, -1170.0, -1020.0, 0.0, -888.0, -220.0, -280.0, -653.0, -870.0, -111.0, -496.0, -901.0, -900.0, -470.0, 2.0, 12.0, -380.0, -970.0, -108.0, 3.0, -516.0, -179.0, -57.0, 0.0, 11.0, 2.0, -950.0, -760.0, -340.0, -270.0, 0.0, 0.0, 0.0, -140.0, -51.0, -10.0, -950.0, -1108.0, -496.0, -712.0, 0.0, -33.0, -412.0, -292.0, -77.0, -670.0, -370.0, -300.0, -889.0, 0.0, -1029.0, -469.0, -927.0, -922.0, 12.0, 0.0, -20.0, -530.0, -650.0, -723.0, -246.0, -708.0, -1623.0, -121.0, -357.0, -348.0, 78.0, 0.0, -475.0, -1710.0, -46.0, 22.0, -1435.0, -707.0, 0.0, 10.0, -30.0, -55.0, -960.0, -29.0, -680.0, 4.0, -1100.0, -150.0, -100.0, -40.0, -40.0, -960.0, -363.0, 0.0, 0.0, 0.0, 0.0, -120.0, -277.0, -613.0, -462.0, -810.0, -40.0, -1066.0, 0.0, 0.0, -280.0, 0.0, -321.0, -131.0, -110.0, -1100.0, 0.0, -466.0, 103.0, -1071.0, -15.0, -240.0, -950.0, 31.0, 0.0, 63.0, -120.0, -173.0, -1850.0, -1570.0, -1020.0, -565.0, -280.0, -810.0, -160.0, -1150.0, -1190.0, -660.0, -998.0, 0.0, 13.0, -566.0, -30.0, -1031.0, -517.0, -390.0, -920.0, -280.0, -293.0, -320.0, -573.0, 0.0, -160.0, -659.0, 0.0, 0.0, -413.0, -1397.0, -200.0, -70.0, -920.0, -126.0, -971.0, -196.0, -506.0, -880.0, -1080.0, 0.0, -1250.0, -97.0, 0.0, 0.0, -1090.0, -181.0, -1086.0, -139.0, -303.0, -3.0, 21.0, -590.0, -479.0, -60.0, -1720.0, -1030.0, -860.0, -150.0, 0.0, -3.0, 91.0, -351.0, 10.0, -86.0], "policy_predator_policy_reward": [285.0, 335.0, 120.0, 0.0, 50.0, 615.0, 650.0, 5.0, 0.0, 60.0, 255.0, 100.0, 60.0, 420.0, 95.0, 45.0, 480.0, 450.0, 405.0, 320.0, 455.0, 110.0, 50.0, 390.0, 0.0, 490.0, 0.0, 615.0, 260.0, 395.0, 0.0, 0.0, 490.0, 155.0, 20.0, 55.0, 190.0, 165.0, 25.0, 20.0, 0.0, 0.0, 350.0, 515.0, 290.0, 15.0, 0.0, 0.0, 60.0, 70.0, 30.0, 5.0, 310.0, 610.0, 125.0, 360.0, 30.0, 10.0, 40.0, 275.0, 130.0, 310.0, 180.0, 20.0, 325.0, 190.0, 125.0, 575.0, 690.0, 0.0, 0.0, 0.0, 270.0, 0.0, 450.0, 300.0, 185.0, 370.0, 820.0, 70.0, 165.0, 230.0, 0.0, 25.0, 755.0, 320.0, 25.0, 0.0, 455.0, 535.0, 0.0, 0.0, 35.0, 15.0, 0.0, 480.0, 370.0, 35.0, 0.0, 590.0, 70.0, 0.0, 470.0, 15.0, 235.0, 0.0, 0.0, 0.0, 0.0, 60.0, 455.0, 0.0, 405.0, 270.0, 315.0, 430.0, 0.0, 0.0, 140.0, 0.0, 10.0, 255.0, 180.0, 445.0, 170.0, 215.0, 190.0, 445.0, 120.0, 0.0, 475.0, 0.0, 0.0, 0.0, 85.0, 70.0, 665.0, 860.0, 330.0, 510.0, 545.0, 0.0, 245.0, 600.0, 340.0, 620.0, 520.0, 40.0, 205.0, 225.0, 525.0, 205.0, 335.0, 190.0, 445.0, 430.0, 350.0, 0.0, 10.0, 290.0, 355.0, 0.0, 0.0, 0.0, 805.0, 0.0, 90.0, 80.0, 375.0, 200.0, 65.0, 510.0, 500.0, 520.0, 540.0, 0.0, 525.0, 660.0, 0.0, 0.0, 285.0, 515.0, 545.0, 105.0, 160.0, 5.0, 325.0, 50.0, 185.0, 110.0, 950.0, 0.0, 30.0, 475.0, 0.0, 5.0, 220.0, 45.0, 105.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6247229485508217, "mean_inference_ms": 1.3911918163680748, "mean_action_processing_ms": 0.24171109610325545, "mean_env_wait_ms": 0.18307578034704863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069571733474731445, "StateBufferConnector_ms": 0.004867434501647949, "ViewRequirementAgentConnector_ms": 0.12976348400115967}, "num_episodes": 18, "episode_return_max": 103.0, "episode_return_min": -1895.0, "episode_return_mean": -408.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.21743003014355, "num_env_steps_trained_throughput_per_sec": 83.21743003014355, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 48037.946, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48037.896, "sample_time_ms": 1132.082, "learn_time_ms": 46889.267, "learn_throughput": 85.307, "synch_weights_time_ms": 14.427}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-52-12", "timestamp": 1723499532, "time_this_iter_s": 48.08786940574646, "time_total_s": 967.7955977916718, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88783a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 967.7955977916718, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.54558823529412, "ram_util_percent": 82.77941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4928886589549837, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.452734074012312, "policy_loss": -0.011899619973905227, "vf_loss": 6.463282023535834, "vf_explained_var": -8.467886813733943e-05, "kl": 0.009011131772134324, "entropy": 1.3201787255428457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7811629103920446, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.307153331161176, "policy_loss": -0.010868139223752436, "vf_loss": 8.31628252993185, "vf_explained_var": 0.014861220689046951, "kl": 0.008694703913391446, "entropy": 1.4103721074326327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -2327.0, "episode_reward_mean": -444.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1930.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 980.0}, "policy_reward_mean": {"prey_policy": -467.785, "predator_policy": 245.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-340.0, -12.0, 13.0, -845.0, -305.0, 0.0, -10.0, -26.0, -1138.0, -723.0, 7.0, -389.0, -307.0, -470.0, -374.0, -798.0, -1159.0, 12.0, -280.0, -623.0, -399.0, -854.0, -310.0, 103.0, -1110.0, 1.0, -1152.0, 10.0, -35.0, -509.0, -271.0, -660.0, -70.0, -515.0, -128.0, 0.0, -60.0, -435.0, -597.0, -361.0, 0.0, -140.0, -187.0, -585.0, -81.0, -333.0, -135.0, -444.0, 63.0, -138.0, -1895.0, -745.0, -545.0, -465.0, -890.0, -438.0, -123.0, -331.0, -382.0, -325.0, -263.0, -273.0, -464.0, 0.0, -1005.0, -100.0, -471.0, -592.0, -366.0, -540.0, -162.0, 0.0, -471.0, -575.0, -141.0, -194.0, -244.0, -1800.0, -505.0, 2.0, 5.0, 59.0, -463.0, -2255.0, 21.0, -287.0, -711.0, -2327.0, -167.0, -421.0, -1088.0, -232.0, 209.0, -226.0, -200.0, -53.0, -1810.0, -1970.0, 311.0, -1485.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-516.0, -179.0, -57.0, 0.0, 11.0, 2.0, -950.0, -760.0, -340.0, -270.0, 0.0, 0.0, 0.0, -140.0, -51.0, -10.0, -950.0, -1108.0, -496.0, -712.0, 0.0, -33.0, -412.0, -292.0, -77.0, -670.0, -370.0, -300.0, -889.0, 0.0, -1029.0, -469.0, -927.0, -922.0, 12.0, 0.0, -20.0, -530.0, -650.0, -723.0, -246.0, -708.0, -1623.0, -121.0, -357.0, -348.0, 78.0, 0.0, -475.0, -1710.0, -46.0, 22.0, -1435.0, -707.0, 0.0, 10.0, -30.0, -55.0, -960.0, -29.0, -680.0, 4.0, -1100.0, -150.0, -100.0, -40.0, -40.0, -960.0, -363.0, 0.0, 0.0, 0.0, 0.0, -120.0, -277.0, -613.0, -462.0, -810.0, -40.0, -1066.0, 0.0, 0.0, -280.0, 0.0, -321.0, -131.0, -110.0, -1100.0, 0.0, -466.0, 103.0, -1071.0, -15.0, -240.0, -950.0, 31.0, 0.0, 63.0, -120.0, -173.0, -1850.0, -1570.0, -1020.0, -565.0, -280.0, -810.0, -160.0, -1150.0, -1190.0, -660.0, -998.0, 0.0, 13.0, -566.0, -30.0, -1031.0, -517.0, -390.0, -920.0, -280.0, -293.0, -320.0, -573.0, 0.0, -160.0, -659.0, 0.0, 0.0, -413.0, -1397.0, -200.0, -70.0, -920.0, -126.0, -971.0, -196.0, -506.0, -880.0, -1080.0, 0.0, -1250.0, -97.0, 0.0, 0.0, -1090.0, -181.0, -1086.0, -139.0, -303.0, -3.0, 21.0, -590.0, -479.0, -60.0, -1720.0, -1030.0, -860.0, -150.0, 0.0, -3.0, 91.0, -351.0, 10.0, -86.0, -1012.0, -166.0, -1825.0, -1930.0, 21.0, 0.0, -185.0, -427.0, -1180.0, -246.0, -1590.0, -1577.0, -190.0, -242.0, -1150.0, 9.0, -1553.0, -1070.0, -490.0, -142.0, -253.0, 197.0, 4.0, -1720.0, 40.0, -1230.0, -100.0, -238.0, -890.0, -1840.0, -1630.0, -1870.0, 156.0, 155.0, -955.0, -1180.0], "policy_predator_policy_reward": [190.0, 165.0, 25.0, 20.0, 0.0, 0.0, 350.0, 515.0, 290.0, 15.0, 0.0, 0.0, 60.0, 70.0, 30.0, 5.0, 310.0, 610.0, 125.0, 360.0, 30.0, 10.0, 40.0, 275.0, 130.0, 310.0, 180.0, 20.0, 325.0, 190.0, 125.0, 575.0, 690.0, 0.0, 0.0, 0.0, 270.0, 0.0, 450.0, 300.0, 185.0, 370.0, 820.0, 70.0, 165.0, 230.0, 0.0, 25.0, 755.0, 320.0, 25.0, 0.0, 455.0, 535.0, 0.0, 0.0, 35.0, 15.0, 0.0, 480.0, 370.0, 35.0, 0.0, 590.0, 70.0, 0.0, 470.0, 15.0, 235.0, 0.0, 0.0, 0.0, 0.0, 60.0, 455.0, 0.0, 405.0, 270.0, 315.0, 430.0, 0.0, 0.0, 140.0, 0.0, 10.0, 255.0, 180.0, 445.0, 170.0, 215.0, 190.0, 445.0, 120.0, 0.0, 475.0, 0.0, 0.0, 0.0, 85.0, 70.0, 665.0, 860.0, 330.0, 510.0, 545.0, 0.0, 245.0, 600.0, 340.0, 620.0, 520.0, 40.0, 205.0, 225.0, 525.0, 205.0, 335.0, 190.0, 445.0, 430.0, 350.0, 0.0, 10.0, 290.0, 355.0, 0.0, 0.0, 0.0, 805.0, 0.0, 90.0, 80.0, 375.0, 200.0, 65.0, 510.0, 500.0, 520.0, 540.0, 0.0, 525.0, 660.0, 0.0, 0.0, 285.0, 515.0, 545.0, 105.0, 160.0, 5.0, 325.0, 50.0, 185.0, 110.0, 950.0, 0.0, 30.0, 475.0, 0.0, 5.0, 220.0, 45.0, 105.0, 30.0, 565.0, 150.0, 520.0, 980.0, 0.0, 0.0, 325.0, 0.0, 85.0, 630.0, 15.0, 825.0, 125.0, 140.0, 560.0, 160.0, 680.0, 855.0, 45.0, 355.0, 180.0, 85.0, 635.0, 855.0, 455.0, 535.0, 190.0, 95.0, 0.0, 920.0, 815.0, 715.0, 0.0, 0.0, 0.0, 650.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6232396352908097, "mean_inference_ms": 1.3896242500463052, "mean_action_processing_ms": 0.2413449092845115, "mean_env_wait_ms": 0.18255917512222963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007027983665466309, "StateBufferConnector_ms": 0.004886627197265625, "ViewRequirementAgentConnector_ms": 0.1293632984161377}, "num_episodes": 18, "episode_return_max": 311.0, "episode_return_min": -2327.0, "episode_return_mean": -444.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.82641336206804, "num_env_steps_trained_throughput_per_sec": 82.82641336206804, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 48042.724, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48042.673, "sample_time_ms": 1134.113, "learn_time_ms": 46891.758, "learn_throughput": 85.303, "synch_weights_time_ms": 14.816}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-53-01", "timestamp": 1723499581, "time_this_iter_s": 48.32871699333191, "time_total_s": 1016.1243147850037, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88b8700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1016.1243147850037, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.811764705882354, "ram_util_percent": 82.8058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4174405962386458, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.967536297550907, "policy_loss": -0.011552659311041078, "vf_loss": 7.977656852631342, "vf_explained_var": 0.00022289983179203416, "kl": 0.009547437654400182, "entropy": 1.3126464093172991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.31707815247238, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.69750032702451, "policy_loss": -0.011542651976862795, "vf_loss": 8.707019285928636, "vf_explained_var": 0.02279765243252749, "kl": 0.010118465942305022, "entropy": 1.4227872014045715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -2327.0, "episode_reward_mean": -508.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -549.26, "predator_policy": 295.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-280.0, -623.0, -399.0, -854.0, -310.0, 103.0, -1110.0, 1.0, -1152.0, 10.0, -35.0, -509.0, -271.0, -660.0, -70.0, -515.0, -128.0, 0.0, -60.0, -435.0, -597.0, -361.0, 0.0, -140.0, -187.0, -585.0, -81.0, -333.0, -135.0, -444.0, 63.0, -138.0, -1895.0, -745.0, -545.0, -465.0, -890.0, -438.0, -123.0, -331.0, -382.0, -325.0, -263.0, -273.0, -464.0, 0.0, -1005.0, -100.0, -471.0, -592.0, -366.0, -540.0, -162.0, 0.0, -471.0, -575.0, -141.0, -194.0, -244.0, -1800.0, -505.0, 2.0, 5.0, 59.0, -463.0, -2255.0, 21.0, -287.0, -711.0, -2327.0, -167.0, -421.0, -1088.0, -232.0, 209.0, -226.0, -200.0, -53.0, -1810.0, -1970.0, 311.0, -1485.0, -349.0, -371.0, -1646.0, -1275.0, -710.0, 95.0, -1421.0, -370.0, -1110.0, -137.0, 166.0, -250.0, -194.0, -702.0, -1240.0, -1409.0, -1994.0, -282.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -530.0, -650.0, -723.0, -246.0, -708.0, -1623.0, -121.0, -357.0, -348.0, 78.0, 0.0, -475.0, -1710.0, -46.0, 22.0, -1435.0, -707.0, 0.0, 10.0, -30.0, -55.0, -960.0, -29.0, -680.0, 4.0, -1100.0, -150.0, -100.0, -40.0, -40.0, -960.0, -363.0, 0.0, 0.0, 0.0, 0.0, -120.0, -277.0, -613.0, -462.0, -810.0, -40.0, -1066.0, 0.0, 0.0, -280.0, 0.0, -321.0, -131.0, -110.0, -1100.0, 0.0, -466.0, 103.0, -1071.0, -15.0, -240.0, -950.0, 31.0, 0.0, 63.0, -120.0, -173.0, -1850.0, -1570.0, -1020.0, -565.0, -280.0, -810.0, -160.0, -1150.0, -1190.0, -660.0, -998.0, 0.0, 13.0, -566.0, -30.0, -1031.0, -517.0, -390.0, -920.0, -280.0, -293.0, -320.0, -573.0, 0.0, -160.0, -659.0, 0.0, 0.0, -413.0, -1397.0, -200.0, -70.0, -920.0, -126.0, -971.0, -196.0, -506.0, -880.0, -1080.0, 0.0, -1250.0, -97.0, 0.0, 0.0, -1090.0, -181.0, -1086.0, -139.0, -303.0, -3.0, 21.0, -590.0, -479.0, -60.0, -1720.0, -1030.0, -860.0, -150.0, 0.0, -3.0, 91.0, -351.0, 10.0, -86.0, -1012.0, -166.0, -1825.0, -1930.0, 21.0, 0.0, -185.0, -427.0, -1180.0, -246.0, -1590.0, -1577.0, -190.0, -242.0, -1150.0, 9.0, -1553.0, -1070.0, -490.0, -142.0, -253.0, 197.0, 4.0, -1720.0, 40.0, -1230.0, -100.0, -238.0, -890.0, -1840.0, -1630.0, -1870.0, 156.0, 155.0, -955.0, -1180.0, 156.0, -1050.0, -1800.0, -131.0, -1426.0, -1600.0, -1800.0, -930.0, -860.0, -280.0, -9.0, -41.0, -1390.0, -746.0, -1890.0, 0.0, -1210.0, -740.0, -92.0, -130.0, 131.0, 30.0, -60.0, -1505.0, -134.0, -420.0, -1650.0, 43.0, -1940.0, -665.0, -1314.0, -1770.0, -1340.0, -1339.0, -1360.0, 63.0], "policy_predator_policy_reward": [270.0, 0.0, 450.0, 300.0, 185.0, 370.0, 820.0, 70.0, 165.0, 230.0, 0.0, 25.0, 755.0, 320.0, 25.0, 0.0, 455.0, 535.0, 0.0, 0.0, 35.0, 15.0, 0.0, 480.0, 370.0, 35.0, 0.0, 590.0, 70.0, 0.0, 470.0, 15.0, 235.0, 0.0, 0.0, 0.0, 0.0, 60.0, 455.0, 0.0, 405.0, 270.0, 315.0, 430.0, 0.0, 0.0, 140.0, 0.0, 10.0, 255.0, 180.0, 445.0, 170.0, 215.0, 190.0, 445.0, 120.0, 0.0, 475.0, 0.0, 0.0, 0.0, 85.0, 70.0, 665.0, 860.0, 330.0, 510.0, 545.0, 0.0, 245.0, 600.0, 340.0, 620.0, 520.0, 40.0, 205.0, 225.0, 525.0, 205.0, 335.0, 190.0, 445.0, 430.0, 350.0, 0.0, 10.0, 290.0, 355.0, 0.0, 0.0, 0.0, 805.0, 0.0, 90.0, 80.0, 375.0, 200.0, 65.0, 510.0, 500.0, 520.0, 540.0, 0.0, 525.0, 660.0, 0.0, 0.0, 285.0, 515.0, 545.0, 105.0, 160.0, 5.0, 325.0, 50.0, 185.0, 110.0, 950.0, 0.0, 30.0, 475.0, 0.0, 5.0, 220.0, 45.0, 105.0, 30.0, 565.0, 150.0, 520.0, 980.0, 0.0, 0.0, 325.0, 0.0, 85.0, 630.0, 15.0, 825.0, 125.0, 140.0, 560.0, 160.0, 680.0, 855.0, 45.0, 355.0, 180.0, 85.0, 635.0, 855.0, 455.0, 535.0, 190.0, 95.0, 0.0, 920.0, 815.0, 715.0, 0.0, 0.0, 0.0, 650.0, 0.0, 545.0, 995.0, 565.0, 840.0, 540.0, 935.0, 520.0, 0.0, 430.0, 40.0, 105.0, 0.0, 715.0, 660.0, 860.0, 605.0, 235.0, 75.0, 10.0, 0.0, 5.0, 585.0, 730.0, 360.0, 0.0, 80.0, 825.0, 940.0, 425.0, 830.0, 845.0, 685.0, 0.0, 380.0, 635.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6249341249993896, "mean_inference_ms": 1.3987311732627317, "mean_action_processing_ms": 0.24246975133387527, "mean_env_wait_ms": 0.18311926916180105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070961713790893555, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.1408311128616333}, "num_episodes": 18, "episode_return_max": 311.0, "episode_return_min": -2327.0, "episode_return_mean": -508.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.22944146804157, "num_env_steps_trained_throughput_per_sec": 81.22944146804157, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 48148.115, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48148.06, "sample_time_ms": 1220.929, "learn_time_ms": 46909.827, "learn_throughput": 85.27, "synch_weights_time_ms": 15.168}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-53-50", "timestamp": 1723499630, "time_this_iter_s": 49.296385765075684, "time_total_s": 1065.4207005500793, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a887c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1065.4207005500793, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 23.685714285714287, "ram_util_percent": 82.29857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.419737974392674, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.211587744415121, "policy_loss": -0.009943881878264681, "vf_loss": 6.219839454580236, "vf_explained_var": -1.8325022288731165e-05, "kl": 0.011281130568585693, "entropy": 1.2816823542433442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.181770714944002, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.389387657781127, "policy_loss": -0.011101035619765599, "vf_loss": 8.398956113643747, "vf_explained_var": 0.027043279548170707, "kl": 0.007662877920023321, "entropy": 1.4144412221101226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -2327.0, "episode_reward_mean": -581.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1990.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -635.1, "predator_policy": 344.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333.0, -135.0, -444.0, 63.0, -138.0, -1895.0, -745.0, -545.0, -465.0, -890.0, -438.0, -123.0, -331.0, -382.0, -325.0, -263.0, -273.0, -464.0, 0.0, -1005.0, -100.0, -471.0, -592.0, -366.0, -540.0, -162.0, 0.0, -471.0, -575.0, -141.0, -194.0, -244.0, -1800.0, -505.0, 2.0, 5.0, 59.0, -463.0, -2255.0, 21.0, -287.0, -711.0, -2327.0, -167.0, -421.0, -1088.0, -232.0, 209.0, -226.0, -200.0, -53.0, -1810.0, -1970.0, 311.0, -1485.0, -349.0, -371.0, -1646.0, -1275.0, -710.0, 95.0, -1421.0, -370.0, -1110.0, -137.0, 166.0, -250.0, -194.0, -702.0, -1240.0, -1409.0, -1994.0, -282.0, -1061.0, 4.0, 200.0, -345.0, -1690.0, 33.0, -86.0, -50.0, -625.0, -1739.0, 76.0, 84.0, -650.0, -2155.0, -279.0, -560.0, -2247.0, -143.0, -273.0, -297.0, -481.0, -55.0, -1805.0, -588.0, 109.0, -18.0, -1880.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [103.0, -1071.0, -15.0, -240.0, -950.0, 31.0, 0.0, 63.0, -120.0, -173.0, -1850.0, -1570.0, -1020.0, -565.0, -280.0, -810.0, -160.0, -1150.0, -1190.0, -660.0, -998.0, 0.0, 13.0, -566.0, -30.0, -1031.0, -517.0, -390.0, -920.0, -280.0, -293.0, -320.0, -573.0, 0.0, -160.0, -659.0, 0.0, 0.0, -413.0, -1397.0, -200.0, -70.0, -920.0, -126.0, -971.0, -196.0, -506.0, -880.0, -1080.0, 0.0, -1250.0, -97.0, 0.0, 0.0, -1090.0, -181.0, -1086.0, -139.0, -303.0, -3.0, 21.0, -590.0, -479.0, -60.0, -1720.0, -1030.0, -860.0, -150.0, 0.0, -3.0, 91.0, -351.0, 10.0, -86.0, -1012.0, -166.0, -1825.0, -1930.0, 21.0, 0.0, -185.0, -427.0, -1180.0, -246.0, -1590.0, -1577.0, -190.0, -242.0, -1150.0, 9.0, -1553.0, -1070.0, -490.0, -142.0, -253.0, 197.0, 4.0, -1720.0, 40.0, -1230.0, -100.0, -238.0, -890.0, -1840.0, -1630.0, -1870.0, 156.0, 155.0, -955.0, -1180.0, 156.0, -1050.0, -1800.0, -131.0, -1426.0, -1600.0, -1800.0, -930.0, -860.0, -280.0, -9.0, -41.0, -1390.0, -746.0, -1890.0, 0.0, -1210.0, -740.0, -92.0, -130.0, 131.0, 30.0, -60.0, -1505.0, -134.0, -420.0, -1650.0, 43.0, -1940.0, -665.0, -1314.0, -1770.0, -1340.0, -1339.0, -1360.0, 63.0, -576.0, -1670.0, 0.0, 4.0, 0.0, 200.0, -397.0, -328.0, -1860.0, -1720.0, -67.0, -75.0, -191.0, -210.0, -322.0, -88.0, -20.0, -1700.0, -1489.0, -1270.0, -449.0, 165.0, 12.0, -58.0, 0.0, -1990.0, -1560.0, -1920.0, -68.0, -471.0, -255.0, -1220.0, -1417.0, -1860.0, -378.0, -25.0, -33.0, -1520.0, 178.0, -1230.0, 34.0, -1920.0, -1239.0, 9.0, -1770.0, -1490.0, -273.0, -1010.0, 189.0, -160.0, -363.0, 145.0, -1680.0, -1650.0], "policy_predator_policy_reward": [190.0, 445.0, 120.0, 0.0, 475.0, 0.0, 0.0, 0.0, 85.0, 70.0, 665.0, 860.0, 330.0, 510.0, 545.0, 0.0, 245.0, 600.0, 340.0, 620.0, 520.0, 40.0, 205.0, 225.0, 525.0, 205.0, 335.0, 190.0, 445.0, 430.0, 350.0, 0.0, 10.0, 290.0, 355.0, 0.0, 0.0, 0.0, 805.0, 0.0, 90.0, 80.0, 375.0, 200.0, 65.0, 510.0, 500.0, 520.0, 540.0, 0.0, 525.0, 660.0, 0.0, 0.0, 285.0, 515.0, 545.0, 105.0, 160.0, 5.0, 325.0, 50.0, 185.0, 110.0, 950.0, 0.0, 30.0, 475.0, 0.0, 5.0, 220.0, 45.0, 105.0, 30.0, 565.0, 150.0, 520.0, 980.0, 0.0, 0.0, 325.0, 0.0, 85.0, 630.0, 15.0, 825.0, 125.0, 140.0, 560.0, 160.0, 680.0, 855.0, 45.0, 355.0, 180.0, 85.0, 635.0, 855.0, 455.0, 535.0, 190.0, 95.0, 0.0, 920.0, 815.0, 715.0, 0.0, 0.0, 0.0, 650.0, 0.0, 545.0, 995.0, 565.0, 840.0, 540.0, 935.0, 520.0, 0.0, 430.0, 40.0, 105.0, 0.0, 715.0, 660.0, 860.0, 605.0, 235.0, 75.0, 10.0, 0.0, 5.0, 585.0, 730.0, 360.0, 0.0, 80.0, 825.0, 940.0, 425.0, 830.0, 845.0, 685.0, 0.0, 380.0, 635.0, 885.0, 300.0, 0.0, 0.0, 0.0, 0.0, 295.0, 85.0, 935.0, 955.0, 110.0, 65.0, 210.0, 105.0, 150.0, 210.0, 700.0, 395.0, 755.0, 265.0, 130.0, 230.0, 120.0, 10.0, 830.0, 510.0, 860.0, 465.0, 255.0, 5.0, 575.0, 340.0, 55.0, 975.0, 235.0, 25.0, 565.0, 715.0, 615.0, 140.0, 785.0, 620.0, 560.0, 615.0, 745.0, 710.0, 505.0, 190.0, 0.0, 80.0, 0.0, 200.0, 795.0, 655.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.627580450765302, "mean_inference_ms": 1.4124030244017232, "mean_action_processing_ms": 0.24401258410783572, "mean_env_wait_ms": 0.1840330361231688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007578611373901367, "StateBufferConnector_ms": 0.005169391632080078, "ViewRequirementAgentConnector_ms": 0.1466059684753418}, "num_episodes": 27, "episode_return_max": 311.0, "episode_return_min": -2327.0, "episode_return_mean": -581.0, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.93882589911262, "num_env_steps_trained_throughput_per_sec": 83.93882589911262, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 47946.256, "restore_workers_time_ms": 0.013, "training_step_time_ms": 47946.2, "sample_time_ms": 1208.574, "learn_time_ms": 46720.271, "learn_throughput": 85.616, "synch_weights_time_ms": 15.082}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-54-38", "timestamp": 1723499678, "time_this_iter_s": 47.701428174972534, "time_total_s": 1113.1221287250519, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88ac670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1113.1221287250519, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.798529411764704, "ram_util_percent": 82.36617647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4845070597986696, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.8329608614482575, "policy_loss": -0.008756400989220729, "vf_loss": 4.840537370954241, "vf_explained_var": -0.0003480678512936547, "kl": 0.007865982411215073, "entropy": 1.2596097540603113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.758990733459513, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.172883772471595, "policy_loss": -0.012080452173440741, "vf_loss": 9.18290024964267, "vf_explained_var": 0.05050349465753666, "kl": 0.0103199649247246, "entropy": 1.3724524296780742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 369.0, "episode_reward_min": -2327.0, "episode_reward_mean": -538.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1990.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -614.135, "predator_policy": 344.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -1005.0, -100.0, -471.0, -592.0, -366.0, -540.0, -162.0, 0.0, -471.0, -575.0, -141.0, -194.0, -244.0, -1800.0, -505.0, 2.0, 5.0, 59.0, -463.0, -2255.0, 21.0, -287.0, -711.0, -2327.0, -167.0, -421.0, -1088.0, -232.0, 209.0, -226.0, -200.0, -53.0, -1810.0, -1970.0, 311.0, -1485.0, -349.0, -371.0, -1646.0, -1275.0, -710.0, 95.0, -1421.0, -370.0, -1110.0, -137.0, 166.0, -250.0, -194.0, -702.0, -1240.0, -1409.0, -1994.0, -282.0, -1061.0, 4.0, 200.0, -345.0, -1690.0, 33.0, -86.0, -50.0, -625.0, -1739.0, 76.0, 84.0, -650.0, -2155.0, -279.0, -560.0, -2247.0, -143.0, -273.0, -297.0, -481.0, -55.0, -1805.0, -588.0, 109.0, -18.0, -1880.0, -150.0, -204.0, 30.0, 369.0, 185.0, 65.0, -759.0, 83.0, -16.0, 28.0, -807.0, 113.0, -138.0, -771.0, -207.0, -54.0, 98.0, -1738.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -413.0, -1397.0, -200.0, -70.0, -920.0, -126.0, -971.0, -196.0, -506.0, -880.0, -1080.0, 0.0, -1250.0, -97.0, 0.0, 0.0, -1090.0, -181.0, -1086.0, -139.0, -303.0, -3.0, 21.0, -590.0, -479.0, -60.0, -1720.0, -1030.0, -860.0, -150.0, 0.0, -3.0, 91.0, -351.0, 10.0, -86.0, -1012.0, -166.0, -1825.0, -1930.0, 21.0, 0.0, -185.0, -427.0, -1180.0, -246.0, -1590.0, -1577.0, -190.0, -242.0, -1150.0, 9.0, -1553.0, -1070.0, -490.0, -142.0, -253.0, 197.0, 4.0, -1720.0, 40.0, -1230.0, -100.0, -238.0, -890.0, -1840.0, -1630.0, -1870.0, 156.0, 155.0, -955.0, -1180.0, 156.0, -1050.0, -1800.0, -131.0, -1426.0, -1600.0, -1800.0, -930.0, -860.0, -280.0, -9.0, -41.0, -1390.0, -746.0, -1890.0, 0.0, -1210.0, -740.0, -92.0, -130.0, 131.0, 30.0, -60.0, -1505.0, -134.0, -420.0, -1650.0, 43.0, -1940.0, -665.0, -1314.0, -1770.0, -1340.0, -1339.0, -1360.0, 63.0, -576.0, -1670.0, 0.0, 4.0, 0.0, 200.0, -397.0, -328.0, -1860.0, -1720.0, -67.0, -75.0, -191.0, -210.0, -322.0, -88.0, -20.0, -1700.0, -1489.0, -1270.0, -449.0, 165.0, 12.0, -58.0, 0.0, -1990.0, -1560.0, -1920.0, -68.0, -471.0, -255.0, -1220.0, -1417.0, -1860.0, -378.0, -25.0, -33.0, -1520.0, 178.0, -1230.0, 34.0, -1920.0, -1239.0, 9.0, -1770.0, -1490.0, -273.0, -1010.0, 189.0, -160.0, -363.0, 145.0, -1680.0, -1650.0, -1740.0, 190.0, -39.0, -520.0, 199.0, -1154.0, 101.0, 183.0, 176.0, 9.0, 69.0, -479.0, -69.0, -1380.0, -55.0, -92.0, 134.0, -345.0, 74.0, -271.0, 138.0, -1890.0, 73.0, -100.0, -707.0, 79.0, -776.0, -630.0, -1620.0, 188.0, -749.0, -275.0, 28.0, 0.0, -1590.0, -1318.0], "policy_predator_policy_reward": [0.0, 0.0, 805.0, 0.0, 90.0, 80.0, 375.0, 200.0, 65.0, 510.0, 500.0, 520.0, 540.0, 0.0, 525.0, 660.0, 0.0, 0.0, 285.0, 515.0, 545.0, 105.0, 160.0, 5.0, 325.0, 50.0, 185.0, 110.0, 950.0, 0.0, 30.0, 475.0, 0.0, 5.0, 220.0, 45.0, 105.0, 30.0, 565.0, 150.0, 520.0, 980.0, 0.0, 0.0, 325.0, 0.0, 85.0, 630.0, 15.0, 825.0, 125.0, 140.0, 560.0, 160.0, 680.0, 855.0, 45.0, 355.0, 180.0, 85.0, 635.0, 855.0, 455.0, 535.0, 190.0, 95.0, 0.0, 920.0, 815.0, 715.0, 0.0, 0.0, 0.0, 650.0, 0.0, 545.0, 995.0, 565.0, 840.0, 540.0, 935.0, 520.0, 0.0, 430.0, 40.0, 105.0, 0.0, 715.0, 660.0, 860.0, 605.0, 235.0, 75.0, 10.0, 0.0, 5.0, 585.0, 730.0, 360.0, 0.0, 80.0, 825.0, 940.0, 425.0, 830.0, 845.0, 685.0, 0.0, 380.0, 635.0, 885.0, 300.0, 0.0, 0.0, 0.0, 0.0, 295.0, 85.0, 935.0, 955.0, 110.0, 65.0, 210.0, 105.0, 150.0, 210.0, 700.0, 395.0, 755.0, 265.0, 130.0, 230.0, 120.0, 10.0, 830.0, 510.0, 860.0, 465.0, 255.0, 5.0, 575.0, 340.0, 55.0, 975.0, 235.0, 25.0, 565.0, 715.0, 615.0, 140.0, 785.0, 620.0, 560.0, 615.0, 745.0, 710.0, 505.0, 190.0, 0.0, 80.0, 0.0, 200.0, 795.0, 655.0, 840.0, 560.0, 260.0, 95.0, 425.0, 560.0, 40.0, 45.0, 0.0, 0.0, 240.0, 235.0, 0.0, 690.0, 115.0, 115.0, 5.0, 190.0, 200.0, 25.0, 0.0, 945.0, 0.0, 140.0, 335.0, 155.0, 170.0, 465.0, 470.0, 755.0, 410.0, 560.0, 70.0, 0.0, 420.0, 750.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.628674876087738, "mean_inference_ms": 1.4215634536631716, "mean_action_processing_ms": 0.24530069320910425, "mean_env_wait_ms": 0.18468013661149638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004481673240661621, "StateBufferConnector_ms": 0.003214597702026367, "ViewRequirementAgentConnector_ms": 0.10796761512756348}, "num_episodes": 18, "episode_return_max": 369.0, "episode_return_min": -2327.0, "episode_return_mean": -538.47, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.27173118859308, "num_env_steps_trained_throughput_per_sec": 79.27173118859308, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 48169.134, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48169.078, "sample_time_ms": 1201.882, "learn_time_ms": 46949.44, "learn_throughput": 85.198, "synch_weights_time_ms": 15.299}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-55-28", "timestamp": 1723499728, "time_this_iter_s": 50.493358850479126, "time_total_s": 1163.615487575531, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88b2d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1163.615487575531, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 27.552112676056343, "ram_util_percent": 82.99154929577465}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4674321655873899, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.594924716438566, "policy_loss": -0.012958069401669992, "vf_loss": 1.6066020301567814, "vf_explained_var": 0.0004594097061762734, "kl": 0.008538354212924744, "entropy": 1.2745864103080105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.872054717780421, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.128462000246401, "policy_loss": -0.015773767743767216, "vf_loss": 8.142188244774228, "vf_explained_var": 0.10021657275144386, "kl": 0.01023759270801869, "entropy": 1.372893750036835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 369.0, "episode_reward_min": -2327.0, "episode_reward_mean": -452.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1990.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -542.435, "predator_policy": 316.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.0, -463.0, -2255.0, 21.0, -287.0, -711.0, -2327.0, -167.0, -421.0, -1088.0, -232.0, 209.0, -226.0, -200.0, -53.0, -1810.0, -1970.0, 311.0, -1485.0, -349.0, -371.0, -1646.0, -1275.0, -710.0, 95.0, -1421.0, -370.0, -1110.0, -137.0, 166.0, -250.0, -194.0, -702.0, -1240.0, -1409.0, -1994.0, -282.0, -1061.0, 4.0, 200.0, -345.0, -1690.0, 33.0, -86.0, -50.0, -625.0, -1739.0, 76.0, 84.0, -650.0, -2155.0, -279.0, -560.0, -2247.0, -143.0, -273.0, -297.0, -481.0, -55.0, -1805.0, -588.0, 109.0, -18.0, -1880.0, -150.0, -204.0, 30.0, 369.0, 185.0, 65.0, -759.0, 83.0, -16.0, 28.0, -807.0, 113.0, -138.0, -771.0, -207.0, -54.0, 98.0, -1738.0, 96.0, 203.0, 317.0, 182.0, -131.0, 158.0, -284.0, 154.0, -449.0, 263.0, 201.0, -89.0, 41.0, 317.0, -2.0, 11.0, 304.0, 169.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.0, -86.0, -1012.0, -166.0, -1825.0, -1930.0, 21.0, 0.0, -185.0, -427.0, -1180.0, -246.0, -1590.0, -1577.0, -190.0, -242.0, -1150.0, 9.0, -1553.0, -1070.0, -490.0, -142.0, -253.0, 197.0, 4.0, -1720.0, 40.0, -1230.0, -100.0, -238.0, -890.0, -1840.0, -1630.0, -1870.0, 156.0, 155.0, -955.0, -1180.0, 156.0, -1050.0, -1800.0, -131.0, -1426.0, -1600.0, -1800.0, -930.0, -860.0, -280.0, -9.0, -41.0, -1390.0, -746.0, -1890.0, 0.0, -1210.0, -740.0, -92.0, -130.0, 131.0, 30.0, -60.0, -1505.0, -134.0, -420.0, -1650.0, 43.0, -1940.0, -665.0, -1314.0, -1770.0, -1340.0, -1339.0, -1360.0, 63.0, -576.0, -1670.0, 0.0, 4.0, 0.0, 200.0, -397.0, -328.0, -1860.0, -1720.0, -67.0, -75.0, -191.0, -210.0, -322.0, -88.0, -20.0, -1700.0, -1489.0, -1270.0, -449.0, 165.0, 12.0, -58.0, 0.0, -1990.0, -1560.0, -1920.0, -68.0, -471.0, -255.0, -1220.0, -1417.0, -1860.0, -378.0, -25.0, -33.0, -1520.0, 178.0, -1230.0, 34.0, -1920.0, -1239.0, 9.0, -1770.0, -1490.0, -273.0, -1010.0, 189.0, -160.0, -363.0, 145.0, -1680.0, -1650.0, -1740.0, 190.0, -39.0, -520.0, 199.0, -1154.0, 101.0, 183.0, 176.0, 9.0, 69.0, -479.0, -69.0, -1380.0, -55.0, -92.0, 134.0, -345.0, 74.0, -271.0, 138.0, -1890.0, 73.0, -100.0, -707.0, 79.0, -776.0, -630.0, -1620.0, 188.0, -749.0, -275.0, 28.0, 0.0, -1590.0, -1318.0, -340.0, 176.0, -69.0, 152.0, 123.0, 159.0, 182.0, 0.0, -370.0, -191.0, 145.0, -187.0, -242.0, -497.0, 121.0, -32.0, -640.0, -394.0, 80.0, 183.0, 200.0, 1.0, -286.0, -108.0, 8.0, -142.0, 145.0, 172.0, -255.0, -32.0, -197.0, 38.0, 92.0, 167.0, 38.0, 101.0], "policy_predator_policy_reward": [105.0, 30.0, 565.0, 150.0, 520.0, 980.0, 0.0, 0.0, 325.0, 0.0, 85.0, 630.0, 15.0, 825.0, 125.0, 140.0, 560.0, 160.0, 680.0, 855.0, 45.0, 355.0, 180.0, 85.0, 635.0, 855.0, 455.0, 535.0, 190.0, 95.0, 0.0, 920.0, 815.0, 715.0, 0.0, 0.0, 0.0, 650.0, 0.0, 545.0, 995.0, 565.0, 840.0, 540.0, 935.0, 520.0, 0.0, 430.0, 40.0, 105.0, 0.0, 715.0, 660.0, 860.0, 605.0, 235.0, 75.0, 10.0, 0.0, 5.0, 585.0, 730.0, 360.0, 0.0, 80.0, 825.0, 940.0, 425.0, 830.0, 845.0, 685.0, 0.0, 380.0, 635.0, 885.0, 300.0, 0.0, 0.0, 0.0, 0.0, 295.0, 85.0, 935.0, 955.0, 110.0, 65.0, 210.0, 105.0, 150.0, 210.0, 700.0, 395.0, 755.0, 265.0, 130.0, 230.0, 120.0, 10.0, 830.0, 510.0, 860.0, 465.0, 255.0, 5.0, 575.0, 340.0, 55.0, 975.0, 235.0, 25.0, 565.0, 715.0, 615.0, 140.0, 785.0, 620.0, 560.0, 615.0, 745.0, 710.0, 505.0, 190.0, 0.0, 80.0, 0.0, 200.0, 795.0, 655.0, 840.0, 560.0, 260.0, 95.0, 425.0, 560.0, 40.0, 45.0, 0.0, 0.0, 240.0, 235.0, 0.0, 690.0, 115.0, 115.0, 5.0, 190.0, 200.0, 25.0, 0.0, 945.0, 0.0, 140.0, 335.0, 155.0, 170.0, 465.0, 470.0, 755.0, 410.0, 560.0, 70.0, 0.0, 420.0, 750.0, 130.0, 130.0, 120.0, 0.0, 0.0, 35.0, 0.0, 0.0, 35.0, 395.0, 65.0, 135.0, 120.0, 335.0, 65.0, 0.0, 185.0, 400.0, 0.0, 0.0, 0.0, 0.0, 190.0, 115.0, 100.0, 75.0, 0.0, 0.0, 80.0, 205.0, 170.0, 0.0, 45.0, 0.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6295571775961253, "mean_inference_ms": 1.4275749476215156, "mean_action_processing_ms": 0.24615749099805026, "mean_env_wait_ms": 0.18516534053795758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004999518394470215, "StateBufferConnector_ms": 0.003309488296508789, "ViewRequirementAgentConnector_ms": 0.11068844795227051}, "num_episodes": 18, "episode_return_max": 369.0, "episode_return_min": -2327.0, "episode_return_mean": -452.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.01732990131785, "num_env_steps_trained_throughput_per_sec": 82.01732990131785, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 48275.973, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48275.916, "sample_time_ms": 1208.865, "learn_time_ms": 47049.42, "learn_throughput": 85.017, "synch_weights_time_ms": 15.171}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-56-17", "timestamp": 1723499777, "time_this_iter_s": 48.810932874679565, "time_total_s": 1212.4264204502106, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88ace50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1212.4264204502106, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 24.43571428571429, "ram_util_percent": 80.43714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4180047014718333, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.432287040526274, "policy_loss": -0.013987375702216196, "vf_loss": 2.4451304773174267, "vf_explained_var": 5.087682179042271e-05, "kl": 0.007626239006139927, "entropy": 1.2440889939429267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.699281969587639, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.22552072207133, "policy_loss": -0.015880585563980122, "vf_loss": 9.23960192922562, "vf_explained_var": 0.09610059942517962, "kl": 0.008996961579877371, "entropy": 1.3277043109848385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 369.0, "episode_reward_min": -2247.0, "episode_reward_mean": -318.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1990.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -431.53, "predator_policy": 272.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1485.0, -349.0, -371.0, -1646.0, -1275.0, -710.0, 95.0, -1421.0, -370.0, -1110.0, -137.0, 166.0, -250.0, -194.0, -702.0, -1240.0, -1409.0, -1994.0, -282.0, -1061.0, 4.0, 200.0, -345.0, -1690.0, 33.0, -86.0, -50.0, -625.0, -1739.0, 76.0, 84.0, -650.0, -2155.0, -279.0, -560.0, -2247.0, -143.0, -273.0, -297.0, -481.0, -55.0, -1805.0, -588.0, 109.0, -18.0, -1880.0, -150.0, -204.0, 30.0, 369.0, 185.0, 65.0, -759.0, 83.0, -16.0, 28.0, -807.0, 113.0, -138.0, -771.0, -207.0, -54.0, 98.0, -1738.0, 96.0, 203.0, 317.0, 182.0, -131.0, 158.0, -284.0, 154.0, -449.0, 263.0, 201.0, -89.0, 41.0, 317.0, -2.0, 11.0, 304.0, 169.0, 84.0, 294.0, 359.0, -92.0, 168.0, -168.0, 64.0, 234.0, 295.0, 241.0, 259.0, 3.0, -145.0, -311.0, 234.0, 84.0, 148.0, -25.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-955.0, -1180.0, 156.0, -1050.0, -1800.0, -131.0, -1426.0, -1600.0, -1800.0, -930.0, -860.0, -280.0, -9.0, -41.0, -1390.0, -746.0, -1890.0, 0.0, -1210.0, -740.0, -92.0, -130.0, 131.0, 30.0, -60.0, -1505.0, -134.0, -420.0, -1650.0, 43.0, -1940.0, -665.0, -1314.0, -1770.0, -1340.0, -1339.0, -1360.0, 63.0, -576.0, -1670.0, 0.0, 4.0, 0.0, 200.0, -397.0, -328.0, -1860.0, -1720.0, -67.0, -75.0, -191.0, -210.0, -322.0, -88.0, -20.0, -1700.0, -1489.0, -1270.0, -449.0, 165.0, 12.0, -58.0, 0.0, -1990.0, -1560.0, -1920.0, -68.0, -471.0, -255.0, -1220.0, -1417.0, -1860.0, -378.0, -25.0, -33.0, -1520.0, 178.0, -1230.0, 34.0, -1920.0, -1239.0, 9.0, -1770.0, -1490.0, -273.0, -1010.0, 189.0, -160.0, -363.0, 145.0, -1680.0, -1650.0, -1740.0, 190.0, -39.0, -520.0, 199.0, -1154.0, 101.0, 183.0, 176.0, 9.0, 69.0, -479.0, -69.0, -1380.0, -55.0, -92.0, 134.0, -345.0, 74.0, -271.0, 138.0, -1890.0, 73.0, -100.0, -707.0, 79.0, -776.0, -630.0, -1620.0, 188.0, -749.0, -275.0, 28.0, 0.0, -1590.0, -1318.0, -340.0, 176.0, -69.0, 152.0, 123.0, 159.0, 182.0, 0.0, -370.0, -191.0, 145.0, -187.0, -242.0, -497.0, 121.0, -32.0, -640.0, -394.0, 80.0, 183.0, 200.0, 1.0, -286.0, -108.0, 8.0, -142.0, 145.0, 172.0, -255.0, -32.0, -197.0, 38.0, 92.0, 167.0, 38.0, 101.0, 173.0, -244.0, 122.0, 172.0, 194.0, 150.0, -174.0, -533.0, -102.0, 140.0, -372.0, -186.0, 173.0, -559.0, -22.0, 156.0, 31.0, 189.0, 2.0, 149.0, 149.0, 100.0, -91.0, -41.0, -395.0, -95.0, -1125.0, 189.0, 70.0, 134.0, -229.0, -42.0, -92.0, 160.0, -168.0, -42.0], "policy_predator_policy_reward": [0.0, 650.0, 0.0, 545.0, 995.0, 565.0, 840.0, 540.0, 935.0, 520.0, 0.0, 430.0, 40.0, 105.0, 0.0, 715.0, 660.0, 860.0, 605.0, 235.0, 75.0, 10.0, 0.0, 5.0, 585.0, 730.0, 360.0, 0.0, 80.0, 825.0, 940.0, 425.0, 830.0, 845.0, 685.0, 0.0, 380.0, 635.0, 885.0, 300.0, 0.0, 0.0, 0.0, 0.0, 295.0, 85.0, 935.0, 955.0, 110.0, 65.0, 210.0, 105.0, 150.0, 210.0, 700.0, 395.0, 755.0, 265.0, 130.0, 230.0, 120.0, 10.0, 830.0, 510.0, 860.0, 465.0, 255.0, 5.0, 575.0, 340.0, 55.0, 975.0, 235.0, 25.0, 565.0, 715.0, 615.0, 140.0, 785.0, 620.0, 560.0, 615.0, 745.0, 710.0, 505.0, 190.0, 0.0, 80.0, 0.0, 200.0, 795.0, 655.0, 840.0, 560.0, 260.0, 95.0, 425.0, 560.0, 40.0, 45.0, 0.0, 0.0, 240.0, 235.0, 0.0, 690.0, 115.0, 115.0, 5.0, 190.0, 200.0, 25.0, 0.0, 945.0, 0.0, 140.0, 335.0, 155.0, 170.0, 465.0, 470.0, 755.0, 410.0, 560.0, 70.0, 0.0, 420.0, 750.0, 130.0, 130.0, 120.0, 0.0, 0.0, 35.0, 0.0, 0.0, 35.0, 395.0, 65.0, 135.0, 120.0, 335.0, 65.0, 0.0, 185.0, 400.0, 0.0, 0.0, 0.0, 0.0, 190.0, 115.0, 100.0, 75.0, 0.0, 0.0, 80.0, 205.0, 170.0, 0.0, 45.0, 0.0, 0.0, 30.0, 10.0, 145.0, 0.0, 0.0, 15.0, 0.0, 360.0, 255.0, 110.0, 20.0, 260.0, 130.0, 260.0, 190.0, 65.0, 35.0, 65.0, 10.0, 90.0, 0.0, 0.0, 10.0, 5.0, 130.0, 120.0, 225.0, 150.0, 475.0, 0.0, 30.0, 160.0, 195.0, 0.0, 80.0, 170.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6311704044264446, "mean_inference_ms": 1.434212157603692, "mean_action_processing_ms": 0.2471398855772231, "mean_env_wait_ms": 0.18580604890608188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005636692047119141, "StateBufferConnector_ms": 0.003438115119934082, "ViewRequirementAgentConnector_ms": 0.11173713207244873}, "num_episodes": 18, "episode_return_max": 369.0, "episode_return_min": -2247.0, "episode_return_mean": -318.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.35782106524339, "num_env_steps_trained_throughput_per_sec": 83.35782106524339, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 48338.096, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48338.047, "sample_time_ms": 1226.544, "learn_time_ms": 47093.604, "learn_throughput": 84.937, "synch_weights_time_ms": 15.315}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-57-05", "timestamp": 1723499825, "time_this_iter_s": 48.028470039367676, "time_total_s": 1260.4548904895782, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8549940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1260.4548904895782, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 20.855882352941183, "ram_util_percent": 80.66470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5351687458930192, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.920582157247281, "policy_loss": -0.010970887485472732, "vf_loss": 1.930329091775985, "vf_explained_var": -0.0004344451995123, "kl": 0.008159730483222228, "entropy": 1.2209440264121565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.304458485457001, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.299810583629306, "policy_loss": -0.013937535932873961, "vf_loss": 9.312221298015938, "vf_explained_var": 0.11359233285384203, "kl": 0.007634115694278865, "entropy": 1.3447975950266318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 369.0, "episode_reward_min": -2247.0, "episode_reward_mean": -139.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1990.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -283.4, "predator_policy": 213.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.0, -1690.0, 33.0, -86.0, -50.0, -625.0, -1739.0, 76.0, 84.0, -650.0, -2155.0, -279.0, -560.0, -2247.0, -143.0, -273.0, -297.0, -481.0, -55.0, -1805.0, -588.0, 109.0, -18.0, -1880.0, -150.0, -204.0, 30.0, 369.0, 185.0, 65.0, -759.0, 83.0, -16.0, 28.0, -807.0, 113.0, -138.0, -771.0, -207.0, -54.0, 98.0, -1738.0, 96.0, 203.0, 317.0, 182.0, -131.0, 158.0, -284.0, 154.0, -449.0, 263.0, 201.0, -89.0, 41.0, 317.0, -2.0, 11.0, 304.0, 169.0, 84.0, 294.0, 359.0, -92.0, 168.0, -168.0, 64.0, 234.0, 295.0, 241.0, 259.0, 3.0, -145.0, -311.0, 234.0, 84.0, 148.0, -25.0, 105.0, -3.0, 180.0, -53.0, 358.0, 142.0, 85.0, 92.0, -181.0, 64.0, 113.0, 255.0, 312.0, -405.0, 220.0, 208.0, 127.0, 273.0, 319.0, 179.0, 162.0, -127.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-397.0, -328.0, -1860.0, -1720.0, -67.0, -75.0, -191.0, -210.0, -322.0, -88.0, -20.0, -1700.0, -1489.0, -1270.0, -449.0, 165.0, 12.0, -58.0, 0.0, -1990.0, -1560.0, -1920.0, -68.0, -471.0, -255.0, -1220.0, -1417.0, -1860.0, -378.0, -25.0, -33.0, -1520.0, 178.0, -1230.0, 34.0, -1920.0, -1239.0, 9.0, -1770.0, -1490.0, -273.0, -1010.0, 189.0, -160.0, -363.0, 145.0, -1680.0, -1650.0, -1740.0, 190.0, -39.0, -520.0, 199.0, -1154.0, 101.0, 183.0, 176.0, 9.0, 69.0, -479.0, -69.0, -1380.0, -55.0, -92.0, 134.0, -345.0, 74.0, -271.0, 138.0, -1890.0, 73.0, -100.0, -707.0, 79.0, -776.0, -630.0, -1620.0, 188.0, -749.0, -275.0, 28.0, 0.0, -1590.0, -1318.0, -340.0, 176.0, -69.0, 152.0, 123.0, 159.0, 182.0, 0.0, -370.0, -191.0, 145.0, -187.0, -242.0, -497.0, 121.0, -32.0, -640.0, -394.0, 80.0, 183.0, 200.0, 1.0, -286.0, -108.0, 8.0, -142.0, 145.0, 172.0, -255.0, -32.0, -197.0, 38.0, 92.0, 167.0, 38.0, 101.0, 173.0, -244.0, 122.0, 172.0, 194.0, 150.0, -174.0, -533.0, -102.0, 140.0, -372.0, -186.0, 173.0, -559.0, -22.0, 156.0, 31.0, 189.0, 2.0, 149.0, 149.0, 100.0, -91.0, -41.0, -395.0, -95.0, -1125.0, 189.0, 70.0, 134.0, -229.0, -42.0, -92.0, 160.0, -168.0, -42.0, -64.0, -71.0, 57.0, -345.0, 62.0, 63.0, 79.0, -1652.0, 194.0, 139.0, 49.0, 23.0, -142.0, -53.0, -111.0, 43.0, -295.0, -256.0, 140.0, -286.0, -217.0, 200.0, 128.0, 37.0, 179.0, 68.0, -440.0, -270.0, 187.0, 33.0, 12.0, 61.0, -37.0, -31.0, 156.0, 32.0, 167.0, 142.0, 93.0, -9.0, -488.0, 155.0, -1660.0, 178.0], "policy_predator_policy_reward": [295.0, 85.0, 935.0, 955.0, 110.0, 65.0, 210.0, 105.0, 150.0, 210.0, 700.0, 395.0, 755.0, 265.0, 130.0, 230.0, 120.0, 10.0, 830.0, 510.0, 860.0, 465.0, 255.0, 5.0, 575.0, 340.0, 55.0, 975.0, 235.0, 25.0, 565.0, 715.0, 615.0, 140.0, 785.0, 620.0, 560.0, 615.0, 745.0, 710.0, 505.0, 190.0, 0.0, 80.0, 0.0, 200.0, 795.0, 655.0, 840.0, 560.0, 260.0, 95.0, 425.0, 560.0, 40.0, 45.0, 0.0, 0.0, 240.0, 235.0, 0.0, 690.0, 115.0, 115.0, 5.0, 190.0, 200.0, 25.0, 0.0, 945.0, 0.0, 140.0, 335.0, 155.0, 170.0, 465.0, 470.0, 755.0, 410.0, 560.0, 70.0, 0.0, 420.0, 750.0, 130.0, 130.0, 120.0, 0.0, 0.0, 35.0, 0.0, 0.0, 35.0, 395.0, 65.0, 135.0, 120.0, 335.0, 65.0, 0.0, 185.0, 400.0, 0.0, 0.0, 0.0, 0.0, 190.0, 115.0, 100.0, 75.0, 0.0, 0.0, 80.0, 205.0, 170.0, 0.0, 45.0, 0.0, 0.0, 30.0, 10.0, 145.0, 0.0, 0.0, 15.0, 0.0, 360.0, 255.0, 110.0, 20.0, 260.0, 130.0, 260.0, 190.0, 65.0, 35.0, 65.0, 10.0, 90.0, 0.0, 0.0, 10.0, 5.0, 130.0, 120.0, 225.0, 150.0, 475.0, 0.0, 30.0, 160.0, 195.0, 0.0, 80.0, 170.0, 15.0, 85.0, 155.0, 115.0, 170.0, 55.0, 0.0, 785.0, 735.0, 25.0, 0.0, 0.0, 70.0, 130.0, 150.0, 160.0, 0.0, 0.0, 370.0, 210.0, 0.0, 130.0, 0.0, 0.0, 90.0, 5.0, 60.0, 0.0, 305.0, 0.0, 0.0, 0.0, 135.0, 60.0, 135.0, 85.0, 0.0, 0.0, 10.0, 0.0, 95.0, 235.0, 260.0, 530.0, 825.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.629800644896669, "mean_inference_ms": 1.4305005252145393, "mean_action_processing_ms": 0.24677673976986234, "mean_env_wait_ms": 0.18536301011563097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006396889686584473, "StateBufferConnector_ms": 0.003458857536315918, "ViewRequirementAgentConnector_ms": 0.09906947612762451}, "num_episodes": 22, "episode_return_max": 369.0, "episode_return_min": -2247.0, "episode_return_mean": -139.25, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.7018862826846, "num_env_steps_trained_throughput_per_sec": 81.7018862826846, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 48466.267, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48466.218, "sample_time_ms": 1225.457, "learn_time_ms": 47222.832, "learn_throughput": 84.705, "synch_weights_time_ms": 15.368}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-57-54", "timestamp": 1723499874, "time_this_iter_s": 48.988301038742065, "time_total_s": 1309.4431915283203, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88b5820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1309.4431915283203, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 23.488571428571426, "ram_util_percent": 81.36000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.515263763527391, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6573600015312275, "policy_loss": -0.01755898991666202, "vf_loss": 1.6736857140190387, "vf_explained_var": -0.0009140623624993379, "kl": 0.008221839485737752, "entropy": 1.209322979336693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.031777412424643, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.10229606477041, "policy_loss": -0.013400574579154926, "vf_loss": 9.113939840326864, "vf_explained_var": 0.09541789883028262, "kl": 0.00878401475210757, "entropy": 1.3201212584657014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -1880.0, "episode_reward_mean": 18.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1890.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.0}, "policy_reward_mean": {"prey_policy": -135.725, "predator_policy": 144.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1880.0, -150.0, -204.0, 30.0, 369.0, 185.0, 65.0, -759.0, 83.0, -16.0, 28.0, -807.0, 113.0, -138.0, -771.0, -207.0, -54.0, 98.0, -1738.0, 96.0, 203.0, 317.0, 182.0, -131.0, 158.0, -284.0, 154.0, -449.0, 263.0, 201.0, -89.0, 41.0, 317.0, -2.0, 11.0, 304.0, 169.0, 84.0, 294.0, 359.0, -92.0, 168.0, -168.0, 64.0, 234.0, 295.0, 241.0, 259.0, 3.0, -145.0, -311.0, 234.0, 84.0, 148.0, -25.0, 105.0, -3.0, 180.0, -53.0, 358.0, 142.0, 85.0, 92.0, -181.0, 64.0, 113.0, 255.0, 312.0, -405.0, 220.0, 208.0, 127.0, 273.0, 319.0, 179.0, 162.0, -127.0, -83.0, 13.0, 199.0, -65.0, 252.0, -580.0, 3.0, 389.0, 263.0, -256.0, 219.0, 219.0, 195.0, 294.0, 71.0, -5.0, -391.0, 275.0, 173.0, 126.0, 215.0, 121.0, 334.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1680.0, -1650.0, -1740.0, 190.0, -39.0, -520.0, 199.0, -1154.0, 101.0, 183.0, 176.0, 9.0, 69.0, -479.0, -69.0, -1380.0, -55.0, -92.0, 134.0, -345.0, 74.0, -271.0, 138.0, -1890.0, 73.0, -100.0, -707.0, 79.0, -776.0, -630.0, -1620.0, 188.0, -749.0, -275.0, 28.0, 0.0, -1590.0, -1318.0, -340.0, 176.0, -69.0, 152.0, 123.0, 159.0, 182.0, 0.0, -370.0, -191.0, 145.0, -187.0, -242.0, -497.0, 121.0, -32.0, -640.0, -394.0, 80.0, 183.0, 200.0, 1.0, -286.0, -108.0, 8.0, -142.0, 145.0, 172.0, -255.0, -32.0, -197.0, 38.0, 92.0, 167.0, 38.0, 101.0, 173.0, -244.0, 122.0, 172.0, 194.0, 150.0, -174.0, -533.0, -102.0, 140.0, -372.0, -186.0, 173.0, -559.0, -22.0, 156.0, 31.0, 189.0, 2.0, 149.0, 149.0, 100.0, -91.0, -41.0, -395.0, -95.0, -1125.0, 189.0, 70.0, 134.0, -229.0, -42.0, -92.0, 160.0, -168.0, -42.0, -64.0, -71.0, 57.0, -345.0, 62.0, 63.0, 79.0, -1652.0, 194.0, 139.0, 49.0, 23.0, -142.0, -53.0, -111.0, 43.0, -295.0, -256.0, 140.0, -286.0, -217.0, 200.0, 128.0, 37.0, 179.0, 68.0, -440.0, -270.0, 187.0, 33.0, 12.0, 61.0, -37.0, -31.0, 156.0, 32.0, 167.0, 142.0, 93.0, -9.0, -488.0, 155.0, -1660.0, 178.0, -233.0, -200.0, -75.0, -57.0, 12.0, 77.0, -477.0, 97.0, 181.0, -34.0, -629.0, -581.0, 25.0, -207.0, 197.0, 187.0, 158.0, -35.0, -351.0, -280.0, 175.0, -86.0, -73.0, 172.0, 0.0, 195.0, 156.0, 113.0, 128.0, -512.0, 31.0, -331.0, -235.0, -461.0, 46.0, 134.0, 4.0, 29.0, 27.0, -21.0, 18.0, 197.0, -61.0, 97.0, 188.0, 146.0], "policy_predator_policy_reward": [795.0, 655.0, 840.0, 560.0, 260.0, 95.0, 425.0, 560.0, 40.0, 45.0, 0.0, 0.0, 240.0, 235.0, 0.0, 690.0, 115.0, 115.0, 5.0, 190.0, 200.0, 25.0, 0.0, 945.0, 0.0, 140.0, 335.0, 155.0, 170.0, 465.0, 470.0, 755.0, 410.0, 560.0, 70.0, 0.0, 420.0, 750.0, 130.0, 130.0, 120.0, 0.0, 0.0, 35.0, 0.0, 0.0, 35.0, 395.0, 65.0, 135.0, 120.0, 335.0, 65.0, 0.0, 185.0, 400.0, 0.0, 0.0, 0.0, 0.0, 190.0, 115.0, 100.0, 75.0, 0.0, 0.0, 80.0, 205.0, 170.0, 0.0, 45.0, 0.0, 0.0, 30.0, 10.0, 145.0, 0.0, 0.0, 15.0, 0.0, 360.0, 255.0, 110.0, 20.0, 260.0, 130.0, 260.0, 190.0, 65.0, 35.0, 65.0, 10.0, 90.0, 0.0, 0.0, 10.0, 5.0, 130.0, 120.0, 225.0, 150.0, 475.0, 0.0, 30.0, 160.0, 195.0, 0.0, 80.0, 170.0, 15.0, 85.0, 155.0, 115.0, 170.0, 55.0, 0.0, 785.0, 735.0, 25.0, 0.0, 0.0, 70.0, 130.0, 150.0, 160.0, 0.0, 0.0, 370.0, 210.0, 0.0, 130.0, 0.0, 0.0, 90.0, 5.0, 60.0, 0.0, 305.0, 0.0, 0.0, 0.0, 135.0, 60.0, 135.0, 85.0, 0.0, 0.0, 10.0, 0.0, 95.0, 235.0, 260.0, 530.0, 825.0, 175.0, 175.0, 20.0, 125.0, 80.0, 30.0, 45.0, 270.0, 0.0, 105.0, 360.0, 270.0, 30.0, 155.0, 5.0, 0.0, 35.0, 105.0, 265.0, 110.0, 0.0, 130.0, 0.0, 120.0, 0.0, 0.0, 25.0, 0.0, 135.0, 320.0, 70.0, 225.0, 305.0, 0.0, 70.0, 25.0, 5.0, 135.0, 120.0, 0.0, 0.0, 0.0, 20.0, 65.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6281813584021796, "mean_inference_ms": 1.4402028197823977, "mean_action_processing_ms": 0.24602184613282774, "mean_env_wait_ms": 0.1850386078064897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008594512939453125, "StateBufferConnector_ms": 0.0033403635025024414, "ViewRequirementAgentConnector_ms": 0.09697484970092773}, "num_episodes": 23, "episode_return_max": 389.0, "episode_return_min": -1880.0, "episode_return_mean": 18.4, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.42187862629599, "num_env_steps_trained_throughput_per_sec": 80.42187862629599, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 48685.363, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48685.305, "sample_time_ms": 1301.398, "learn_time_ms": 47365.289, "learn_throughput": 84.45, "synch_weights_time_ms": 16.005}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "d8dc0_00000", "date": "2024-08-12_17-58-44", "timestamp": 1723499924, "time_this_iter_s": 49.77013397216797, "time_total_s": 1359.2133255004883, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8833b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1359.2133255004883, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 27.894285714285715, "ram_util_percent": 83.27571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5704915286371948, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7469847933325187, "policy_loss": -0.011810506918965272, "vf_loss": 1.757775520742255, "vf_explained_var": 0.003907174849636341, "kl": 0.006798514568436076, "entropy": 1.2403074502944946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.060493547828109, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.368938638293553, "policy_loss": -0.014500100474198542, "vf_loss": 9.382025279191437, "vf_explained_var": 0.14967492238554375, "kl": 0.0070672914451551045, "entropy": 1.3191385746632933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -1738.0, "episode_reward_mean": 96.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1660.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 825.0}, "policy_reward_mean": {"prey_policy": -53.985, "predator_policy": 102.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1738.0, 96.0, 203.0, 317.0, 182.0, -131.0, 158.0, -284.0, 154.0, -449.0, 263.0, 201.0, -89.0, 41.0, 317.0, -2.0, 11.0, 304.0, 169.0, 84.0, 294.0, 359.0, -92.0, 168.0, -168.0, 64.0, 234.0, 295.0, 241.0, 259.0, 3.0, -145.0, -311.0, 234.0, 84.0, 148.0, -25.0, 105.0, -3.0, 180.0, -53.0, 358.0, 142.0, 85.0, 92.0, -181.0, 64.0, 113.0, 255.0, 312.0, -405.0, 220.0, 208.0, 127.0, 273.0, 319.0, 179.0, 162.0, -127.0, -83.0, 13.0, 199.0, -65.0, 252.0, -580.0, 3.0, 389.0, 263.0, -256.0, 219.0, 219.0, 195.0, 294.0, 71.0, -5.0, -391.0, 275.0, 173.0, 126.0, 215.0, 121.0, 334.0, 135.0, 97.0, 189.0, 105.0, 343.0, 306.0, 233.0, 270.0, 22.0, 330.0, 358.0, 119.0, 232.0, 384.0, -39.0, 234.0, 156.0, 354.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1590.0, -1318.0, -340.0, 176.0, -69.0, 152.0, 123.0, 159.0, 182.0, 0.0, -370.0, -191.0, 145.0, -187.0, -242.0, -497.0, 121.0, -32.0, -640.0, -394.0, 80.0, 183.0, 200.0, 1.0, -286.0, -108.0, 8.0, -142.0, 145.0, 172.0, -255.0, -32.0, -197.0, 38.0, 92.0, 167.0, 38.0, 101.0, 173.0, -244.0, 122.0, 172.0, 194.0, 150.0, -174.0, -533.0, -102.0, 140.0, -372.0, -186.0, 173.0, -559.0, -22.0, 156.0, 31.0, 189.0, 2.0, 149.0, 149.0, 100.0, -91.0, -41.0, -395.0, -95.0, -1125.0, 189.0, 70.0, 134.0, -229.0, -42.0, -92.0, 160.0, -168.0, -42.0, -64.0, -71.0, 57.0, -345.0, 62.0, 63.0, 79.0, -1652.0, 194.0, 139.0, 49.0, 23.0, -142.0, -53.0, -111.0, 43.0, -295.0, -256.0, 140.0, -286.0, -217.0, 200.0, 128.0, 37.0, 179.0, 68.0, -440.0, -270.0, 187.0, 33.0, 12.0, 61.0, -37.0, -31.0, 156.0, 32.0, 167.0, 142.0, 93.0, -9.0, -488.0, 155.0, -1660.0, 178.0, -233.0, -200.0, -75.0, -57.0, 12.0, 77.0, -477.0, 97.0, 181.0, -34.0, -629.0, -581.0, 25.0, -207.0, 197.0, 187.0, 158.0, -35.0, -351.0, -280.0, 175.0, -86.0, -73.0, 172.0, 0.0, 195.0, 156.0, 113.0, 128.0, -512.0, 31.0, -331.0, -235.0, -461.0, 46.0, 134.0, 4.0, 29.0, 27.0, -21.0, 18.0, 197.0, -61.0, 97.0, 188.0, 146.0, -124.0, 109.0, -347.0, 189.0, 169.0, -130.0, 138.0, -223.0, 179.0, 139.0, 163.0, 18.0, 62.0, 46.0, 156.0, 59.0, -109.0, -9.0, 111.0, 164.0, 164.0, 194.0, 15.0, -86.0, 144.0, 83.0, 196.0, 178.0, -442.0, 68.0, -71.0, 155.0, 13.0, 93.0, 200.0, 104.0], "policy_predator_policy_reward": [420.0, 750.0, 130.0, 130.0, 120.0, 0.0, 0.0, 35.0, 0.0, 0.0, 35.0, 395.0, 65.0, 135.0, 120.0, 335.0, 65.0, 0.0, 185.0, 400.0, 0.0, 0.0, 0.0, 0.0, 190.0, 115.0, 100.0, 75.0, 0.0, 0.0, 80.0, 205.0, 170.0, 0.0, 45.0, 0.0, 0.0, 30.0, 10.0, 145.0, 0.0, 0.0, 15.0, 0.0, 360.0, 255.0, 110.0, 20.0, 260.0, 130.0, 260.0, 190.0, 65.0, 35.0, 65.0, 10.0, 90.0, 0.0, 0.0, 10.0, 5.0, 130.0, 120.0, 225.0, 150.0, 475.0, 0.0, 30.0, 160.0, 195.0, 0.0, 80.0, 170.0, 15.0, 85.0, 155.0, 115.0, 170.0, 55.0, 0.0, 785.0, 735.0, 25.0, 0.0, 0.0, 70.0, 130.0, 150.0, 160.0, 0.0, 0.0, 370.0, 210.0, 0.0, 130.0, 0.0, 0.0, 90.0, 5.0, 60.0, 0.0, 305.0, 0.0, 0.0, 0.0, 135.0, 60.0, 135.0, 85.0, 0.0, 0.0, 10.0, 0.0, 95.0, 235.0, 260.0, 530.0, 825.0, 175.0, 175.0, 20.0, 125.0, 80.0, 30.0, 45.0, 270.0, 0.0, 105.0, 360.0, 270.0, 30.0, 155.0, 5.0, 0.0, 35.0, 105.0, 265.0, 110.0, 0.0, 130.0, 0.0, 120.0, 0.0, 0.0, 25.0, 0.0, 135.0, 320.0, 70.0, 225.0, 305.0, 0.0, 70.0, 25.0, 5.0, 135.0, 120.0, 0.0, 0.0, 0.0, 20.0, 65.0, 0.0, 0.0, 150.0, 0.0, 170.0, 85.0, 145.0, 5.0, 190.0, 0.0, 25.0, 0.0, 80.0, 45.0, 55.0, 70.0, 0.0, 55.0, 130.0, 10.0, 15.0, 40.0, 0.0, 0.0, 40.0, 150.0, 0.0, 5.0, 10.0, 0.0, 110.0, 225.0, 40.0, 110.0, 40.0, 10.0, 40.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6273087527398882, "mean_inference_ms": 1.4478095577742045, "mean_action_processing_ms": 0.24561880276926273, "mean_env_wait_ms": 0.18486978865572787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008145928382873535, "StateBufferConnector_ms": 0.0033736228942871094, "ViewRequirementAgentConnector_ms": 0.09756743907928467}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": -1738.0, "episode_return_mean": 96.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.195311201922735, "num_env_steps_trained_throughput_per_sec": 4.195311201922735, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 139261.472, "restore_workers_time_ms": 0.014, "training_step_time_ms": 139261.407, "sample_time_ms": 1304.188, "learn_time_ms": 137936.703, "learn_throughput": 28.999, "synch_weights_time_ms": 17.084}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-14-38", "timestamp": 1723500878, "time_this_iter_s": 953.52090716362, "time_total_s": 2312.7342326641083, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88b2dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2312.7342326641083, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 52.020430107526884, "ram_util_percent": 83.29677419354839}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7948057400801825, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.174899887407898, "policy_loss": -0.017578797451363353, "vf_loss": 3.191110105678518, "vf_explained_var": 0.0014990369794229982, "kl": 0.009123912244877096, "entropy": 1.2789918871783705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.203164213422745, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.250361690319405, "policy_loss": -0.010640017926279041, "vf_loss": 9.259480084313287, "vf_explained_var": 0.03304452404143318, "kl": 0.007608031200920512, "entropy": 1.3199497673877332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -819.0, "episode_reward_mean": 101.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1660.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 825.0}, "policy_reward_mean": {"prey_policy": -53.895, "predator_policy": 104.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [169.0, 84.0, 294.0, 359.0, -92.0, 168.0, -168.0, 64.0, 234.0, 295.0, 241.0, 259.0, 3.0, -145.0, -311.0, 234.0, 84.0, 148.0, -25.0, 105.0, -3.0, 180.0, -53.0, 358.0, 142.0, 85.0, 92.0, -181.0, 64.0, 113.0, 255.0, 312.0, -405.0, 220.0, 208.0, 127.0, 273.0, 319.0, 179.0, 162.0, -127.0, -83.0, 13.0, 199.0, -65.0, 252.0, -580.0, 3.0, 389.0, 263.0, -256.0, 219.0, 219.0, 195.0, 294.0, 71.0, -5.0, -391.0, 275.0, 173.0, 126.0, 215.0, 121.0, 334.0, 135.0, 97.0, 189.0, 105.0, 343.0, 306.0, 233.0, 270.0, 22.0, 330.0, 358.0, 119.0, 232.0, 384.0, -39.0, 234.0, 156.0, 354.0, 230.0, 265.0, -205.0, -90.0, 340.0, 296.0, 287.0, -819.0, -255.0, 157.0, 260.0, -622.0, 34.0, 51.0, -125.0, 355.0, -166.0, 74.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [38.0, 101.0, 173.0, -244.0, 122.0, 172.0, 194.0, 150.0, -174.0, -533.0, -102.0, 140.0, -372.0, -186.0, 173.0, -559.0, -22.0, 156.0, 31.0, 189.0, 2.0, 149.0, 149.0, 100.0, -91.0, -41.0, -395.0, -95.0, -1125.0, 189.0, 70.0, 134.0, -229.0, -42.0, -92.0, 160.0, -168.0, -42.0, -64.0, -71.0, 57.0, -345.0, 62.0, 63.0, 79.0, -1652.0, 194.0, 139.0, 49.0, 23.0, -142.0, -53.0, -111.0, 43.0, -295.0, -256.0, 140.0, -286.0, -217.0, 200.0, 128.0, 37.0, 179.0, 68.0, -440.0, -270.0, 187.0, 33.0, 12.0, 61.0, -37.0, -31.0, 156.0, 32.0, 167.0, 142.0, 93.0, -9.0, -488.0, 155.0, -1660.0, 178.0, -233.0, -200.0, -75.0, -57.0, 12.0, 77.0, -477.0, 97.0, 181.0, -34.0, -629.0, -581.0, 25.0, -207.0, 197.0, 187.0, 158.0, -35.0, -351.0, -280.0, 175.0, -86.0, -73.0, 172.0, 0.0, 195.0, 156.0, 113.0, 128.0, -512.0, 31.0, -331.0, -235.0, -461.0, 46.0, 134.0, 4.0, 29.0, 27.0, -21.0, 18.0, 197.0, -61.0, 97.0, 188.0, 146.0, -124.0, 109.0, -347.0, 189.0, 169.0, -130.0, 138.0, -223.0, 179.0, 139.0, 163.0, 18.0, 62.0, 46.0, 156.0, 59.0, -109.0, -9.0, 111.0, 164.0, 164.0, 194.0, 15.0, -86.0, 144.0, 83.0, 196.0, 178.0, -442.0, 68.0, -71.0, 155.0, 13.0, 93.0, 200.0, 104.0, 102.0, 33.0, -63.0, 188.0, -211.0, -214.0, -250.0, -200.0, 197.0, 108.0, 136.0, 115.0, 131.0, 96.0, -863.0, -911.0, -610.0, -230.0, 145.0, -168.0, 87.0, 123.0, -521.0, -816.0, -41.0, -240.0, -297.0, 108.0, -115.0, -240.0, 134.0, 191.0, -290.0, -256.0, -129.0, 43.0], "policy_predator_policy_reward": [0.0, 30.0, 10.0, 145.0, 0.0, 0.0, 15.0, 0.0, 360.0, 255.0, 110.0, 20.0, 260.0, 130.0, 260.0, 190.0, 65.0, 35.0, 65.0, 10.0, 90.0, 0.0, 0.0, 10.0, 5.0, 130.0, 120.0, 225.0, 150.0, 475.0, 0.0, 30.0, 160.0, 195.0, 0.0, 80.0, 170.0, 15.0, 85.0, 155.0, 115.0, 170.0, 55.0, 0.0, 785.0, 735.0, 25.0, 0.0, 0.0, 70.0, 130.0, 150.0, 160.0, 0.0, 0.0, 370.0, 210.0, 0.0, 130.0, 0.0, 0.0, 90.0, 5.0, 60.0, 0.0, 305.0, 0.0, 0.0, 0.0, 135.0, 60.0, 135.0, 85.0, 0.0, 0.0, 10.0, 0.0, 95.0, 235.0, 260.0, 530.0, 825.0, 175.0, 175.0, 20.0, 125.0, 80.0, 30.0, 45.0, 270.0, 0.0, 105.0, 360.0, 270.0, 30.0, 155.0, 5.0, 0.0, 35.0, 105.0, 265.0, 110.0, 0.0, 130.0, 0.0, 120.0, 0.0, 0.0, 25.0, 0.0, 135.0, 320.0, 70.0, 225.0, 305.0, 0.0, 70.0, 25.0, 5.0, 135.0, 120.0, 0.0, 0.0, 0.0, 20.0, 65.0, 0.0, 0.0, 150.0, 0.0, 170.0, 85.0, 145.0, 5.0, 190.0, 0.0, 25.0, 0.0, 80.0, 45.0, 55.0, 70.0, 0.0, 55.0, 130.0, 10.0, 15.0, 40.0, 0.0, 0.0, 40.0, 150.0, 0.0, 5.0, 10.0, 0.0, 110.0, 225.0, 40.0, 110.0, 40.0, 10.0, 40.0, 10.0, 95.0, 0.0, 25.0, 115.0, 220.0, 0.0, 90.0, 270.0, 0.0, 35.0, 10.0, 35.0, 30.0, 30.0, 445.0, 510.0, 320.0, 265.0, 160.0, 20.0, 50.0, 0.0, 485.0, 230.0, 160.0, 155.0, 130.0, 110.0, 25.0, 205.0, 0.0, 30.0, 190.0, 190.0, 160.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6274127234449687, "mean_inference_ms": 1.4576321188703418, "mean_action_processing_ms": 0.2456016487568264, "mean_env_wait_ms": 0.18511456836138188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00782787799835205, "StateBufferConnector_ms": 0.0034112930297851562, "ViewRequirementAgentConnector_ms": 0.10093212127685547}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": -819.0, "episode_return_mean": 101.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.14219848639911, "num_env_steps_trained_throughput_per_sec": 79.14219848639911, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 139508.98, "restore_workers_time_ms": 0.015, "training_step_time_ms": 139508.915, "sample_time_ms": 1311.935, "learn_time_ms": 138177.609, "learn_throughput": 28.948, "synch_weights_time_ms": 15.835}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-15-28", "timestamp": 1723500928, "time_this_iter_s": 50.580479860305786, "time_total_s": 2363.314712524414, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88bde50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2363.314712524414, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.695833333333333, "ram_util_percent": 83.38749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7164095057381523, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5138759464183185, "policy_loss": -0.016369431576797513, "vf_loss": 5.528358431972523, "vf_explained_var": 0.00404187973844942, "kl": 0.012579599551990065, "entropy": 1.2601952842303685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.361106162380289, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.447666123809007, "policy_loss": -0.013284653241662357, "vf_loss": 9.45897807065772, "vf_explained_var": 0.024461616157854676, "kl": 0.00986342699951237, "entropy": 1.3261561670631328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -2423.0, "episode_reward_mean": -31.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1912.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -148.715, "predator_policy": 132.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.0, 105.0, -3.0, 180.0, -53.0, 358.0, 142.0, 85.0, 92.0, -181.0, 64.0, 113.0, 255.0, 312.0, -405.0, 220.0, 208.0, 127.0, 273.0, 319.0, 179.0, 162.0, -127.0, -83.0, 13.0, 199.0, -65.0, 252.0, -580.0, 3.0, 389.0, 263.0, -256.0, 219.0, 219.0, 195.0, 294.0, 71.0, -5.0, -391.0, 275.0, 173.0, 126.0, 215.0, 121.0, 334.0, 135.0, 97.0, 189.0, 105.0, 343.0, 306.0, 233.0, 270.0, 22.0, 330.0, 358.0, 119.0, 232.0, 384.0, -39.0, 234.0, 156.0, 354.0, 230.0, 265.0, -205.0, -90.0, 340.0, 296.0, 287.0, -819.0, -255.0, 157.0, 260.0, -622.0, 34.0, 51.0, -125.0, 355.0, -166.0, 74.0, -1439.0, 222.0, -60.0, -842.0, -622.0, -66.0, 143.0, 13.0, -53.0, -2423.0, -509.0, -382.0, -514.0, -2003.0, -449.0, -1123.0, 373.0, -1720.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-168.0, -42.0, -64.0, -71.0, 57.0, -345.0, 62.0, 63.0, 79.0, -1652.0, 194.0, 139.0, 49.0, 23.0, -142.0, -53.0, -111.0, 43.0, -295.0, -256.0, 140.0, -286.0, -217.0, 200.0, 128.0, 37.0, 179.0, 68.0, -440.0, -270.0, 187.0, 33.0, 12.0, 61.0, -37.0, -31.0, 156.0, 32.0, 167.0, 142.0, 93.0, -9.0, -488.0, 155.0, -1660.0, 178.0, -233.0, -200.0, -75.0, -57.0, 12.0, 77.0, -477.0, 97.0, 181.0, -34.0, -629.0, -581.0, 25.0, -207.0, 197.0, 187.0, 158.0, -35.0, -351.0, -280.0, 175.0, -86.0, -73.0, 172.0, 0.0, 195.0, 156.0, 113.0, 128.0, -512.0, 31.0, -331.0, -235.0, -461.0, 46.0, 134.0, 4.0, 29.0, 27.0, -21.0, 18.0, 197.0, -61.0, 97.0, 188.0, 146.0, -124.0, 109.0, -347.0, 189.0, 169.0, -130.0, 138.0, -223.0, 179.0, 139.0, 163.0, 18.0, 62.0, 46.0, 156.0, 59.0, -109.0, -9.0, 111.0, 164.0, 164.0, 194.0, 15.0, -86.0, 144.0, 83.0, 196.0, 178.0, -442.0, 68.0, -71.0, 155.0, 13.0, 93.0, 200.0, 104.0, 102.0, 33.0, -63.0, 188.0, -211.0, -214.0, -250.0, -200.0, 197.0, 108.0, 136.0, 115.0, 131.0, 96.0, -863.0, -911.0, -610.0, -230.0, 145.0, -168.0, 87.0, 123.0, -521.0, -816.0, -41.0, -240.0, -297.0, 108.0, -115.0, -240.0, 134.0, 191.0, -290.0, -256.0, -129.0, 43.0, -1219.0, -945.0, 126.0, -9.0, -288.0, -12.0, -595.0, -747.0, -770.0, -587.0, -77.0, -364.0, -251.0, 144.0, -300.0, 28.0, 24.0, -317.0, -1912.0, -1521.0, -472.0, -387.0, -59.0, -773.0, -231.0, -798.0, -1550.0, -1498.0, -702.0, -317.0, -1307.0, -771.0, 189.0, 184.0, -1599.0, -991.0], "policy_predator_policy_reward": [170.0, 15.0, 85.0, 155.0, 115.0, 170.0, 55.0, 0.0, 785.0, 735.0, 25.0, 0.0, 0.0, 70.0, 130.0, 150.0, 160.0, 0.0, 0.0, 370.0, 210.0, 0.0, 130.0, 0.0, 0.0, 90.0, 5.0, 60.0, 0.0, 305.0, 0.0, 0.0, 0.0, 135.0, 60.0, 135.0, 85.0, 0.0, 0.0, 10.0, 0.0, 95.0, 235.0, 260.0, 530.0, 825.0, 175.0, 175.0, 20.0, 125.0, 80.0, 30.0, 45.0, 270.0, 0.0, 105.0, 360.0, 270.0, 30.0, 155.0, 5.0, 0.0, 35.0, 105.0, 265.0, 110.0, 0.0, 130.0, 0.0, 120.0, 0.0, 0.0, 25.0, 0.0, 135.0, 320.0, 70.0, 225.0, 305.0, 0.0, 70.0, 25.0, 5.0, 135.0, 120.0, 0.0, 0.0, 0.0, 20.0, 65.0, 0.0, 0.0, 150.0, 0.0, 170.0, 85.0, 145.0, 5.0, 190.0, 0.0, 25.0, 0.0, 80.0, 45.0, 55.0, 70.0, 0.0, 55.0, 130.0, 10.0, 15.0, 40.0, 0.0, 0.0, 40.0, 150.0, 0.0, 5.0, 10.0, 0.0, 110.0, 225.0, 40.0, 110.0, 40.0, 10.0, 40.0, 10.0, 95.0, 0.0, 25.0, 115.0, 220.0, 0.0, 90.0, 270.0, 0.0, 35.0, 10.0, 35.0, 30.0, 30.0, 445.0, 510.0, 320.0, 265.0, 160.0, 20.0, 50.0, 0.0, 485.0, 230.0, 160.0, 155.0, 130.0, 110.0, 25.0, 205.0, 0.0, 30.0, 190.0, 190.0, 160.0, 0.0, 570.0, 155.0, 0.0, 105.0, 215.0, 25.0, 425.0, 75.0, 490.0, 245.0, 245.0, 130.0, 180.0, 70.0, 75.0, 210.0, 170.0, 70.0, 30.0, 980.0, 15.0, 335.0, 0.0, 450.0, 10.0, 505.0, 990.0, 55.0, 365.0, 205.0, 475.0, 480.0, 0.0, 0.0, 870.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.627189691549378, "mean_inference_ms": 1.4666563504017445, "mean_action_processing_ms": 0.24550642307136583, "mean_env_wait_ms": 0.18529779248632516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007141232490539551, "StateBufferConnector_ms": 0.003264188766479492, "ViewRequirementAgentConnector_ms": 0.09980213642120361}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": -2423.0, "episode_return_mean": -31.78, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.62997225213364, "num_env_steps_trained_throughput_per_sec": 79.62997225213364, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 139702.837, "restore_workers_time_ms": 0.015, "training_step_time_ms": 139702.77, "sample_time_ms": 1321.21, "learn_time_ms": 138360.992, "learn_throughput": 28.91, "synch_weights_time_ms": 16.772}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-16-19", "timestamp": 1723500979, "time_this_iter_s": 50.26503896713257, "time_total_s": 2413.5797514915466, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88b2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2413.5797514915466, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 28.326760563380283, "ram_util_percent": 82.8845070422535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6273746700198561, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.74036644350284, "policy_loss": -0.014570080364743868, "vf_loss": 7.75323247177891, "vf_explained_var": 0.0023869688548738993, "kl": 0.011360220468727813, "entropy": 1.2181865814501647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.736902199882679, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.639973843286908, "policy_loss": -0.013271497726987398, "vf_loss": 9.65122828660188, "vf_explained_var": 0.002372912471256559, "kl": 0.01008520835003315, "entropy": 1.3354718750116055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -2423.0, "episode_reward_mean": -305.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1915.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -370.19, "predator_policy": 217.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [252.0, -580.0, 3.0, 389.0, 263.0, -256.0, 219.0, 219.0, 195.0, 294.0, 71.0, -5.0, -391.0, 275.0, 173.0, 126.0, 215.0, 121.0, 334.0, 135.0, 97.0, 189.0, 105.0, 343.0, 306.0, 233.0, 270.0, 22.0, 330.0, 358.0, 119.0, 232.0, 384.0, -39.0, 234.0, 156.0, 354.0, 230.0, 265.0, -205.0, -90.0, 340.0, 296.0, 287.0, -819.0, -255.0, 157.0, 260.0, -622.0, 34.0, 51.0, -125.0, 355.0, -166.0, 74.0, -1439.0, 222.0, -60.0, -842.0, -622.0, -66.0, 143.0, 13.0, -53.0, -2423.0, -509.0, -382.0, -514.0, -2003.0, -449.0, -1123.0, 373.0, -1720.0, -623.0, -1607.0, -1652.0, -1444.0, -1996.0, -879.0, -789.0, -1301.0, -1722.0, -391.0, -721.0, -1785.0, -640.0, -840.0, -144.0, -559.0, -1379.0, -1293.0, -311.0, -1714.0, -1305.0, 291.0, -859.0, 85.0, -173.0, 197.0, -1362.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [181.0, -34.0, -629.0, -581.0, 25.0, -207.0, 197.0, 187.0, 158.0, -35.0, -351.0, -280.0, 175.0, -86.0, -73.0, 172.0, 0.0, 195.0, 156.0, 113.0, 128.0, -512.0, 31.0, -331.0, -235.0, -461.0, 46.0, 134.0, 4.0, 29.0, 27.0, -21.0, 18.0, 197.0, -61.0, 97.0, 188.0, 146.0, -124.0, 109.0, -347.0, 189.0, 169.0, -130.0, 138.0, -223.0, 179.0, 139.0, 163.0, 18.0, 62.0, 46.0, 156.0, 59.0, -109.0, -9.0, 111.0, 164.0, 164.0, 194.0, 15.0, -86.0, 144.0, 83.0, 196.0, 178.0, -442.0, 68.0, -71.0, 155.0, 13.0, 93.0, 200.0, 104.0, 102.0, 33.0, -63.0, 188.0, -211.0, -214.0, -250.0, -200.0, 197.0, 108.0, 136.0, 115.0, 131.0, 96.0, -863.0, -911.0, -610.0, -230.0, 145.0, -168.0, 87.0, 123.0, -521.0, -816.0, -41.0, -240.0, -297.0, 108.0, -115.0, -240.0, 134.0, 191.0, -290.0, -256.0, -129.0, 43.0, -1219.0, -945.0, 126.0, -9.0, -288.0, -12.0, -595.0, -747.0, -770.0, -587.0, -77.0, -364.0, -251.0, 144.0, -300.0, 28.0, 24.0, -317.0, -1912.0, -1521.0, -472.0, -387.0, -59.0, -773.0, -231.0, -798.0, -1550.0, -1498.0, -702.0, -317.0, -1307.0, -771.0, 189.0, 184.0, -1599.0, -991.0, -588.0, -550.0, -1028.0, -1814.0, -1592.0, -1790.0, -1330.0, -1149.0, -1702.0, -1539.0, -998.0, -1096.0, -684.0, -535.0, -1257.0, -1494.0, -1418.0, -1514.0, -410.0, -281.0, -667.0, -664.0, -1548.0, -1577.0, -69.0, -1281.0, -480.0, -860.0, -189.0, -515.0, -478.0, -526.0, -1653.0, -1106.0, -1915.0, -1238.0, -472.0, -199.0, -1469.0, -1680.0, -1443.0, -607.0, 74.0, 162.0, -1043.0, -1181.0, -168.0, 123.0, -312.0, -736.0, 23.0, 94.0, -1080.0, -1662.0], "policy_predator_policy_reward": [0.0, 105.0, 360.0, 270.0, 30.0, 155.0, 5.0, 0.0, 35.0, 105.0, 265.0, 110.0, 0.0, 130.0, 0.0, 120.0, 0.0, 0.0, 25.0, 0.0, 135.0, 320.0, 70.0, 225.0, 305.0, 0.0, 70.0, 25.0, 5.0, 135.0, 120.0, 0.0, 0.0, 0.0, 20.0, 65.0, 0.0, 0.0, 150.0, 0.0, 170.0, 85.0, 145.0, 5.0, 190.0, 0.0, 25.0, 0.0, 80.0, 45.0, 55.0, 70.0, 0.0, 55.0, 130.0, 10.0, 15.0, 40.0, 0.0, 0.0, 40.0, 150.0, 0.0, 5.0, 10.0, 0.0, 110.0, 225.0, 40.0, 110.0, 40.0, 10.0, 40.0, 10.0, 95.0, 0.0, 25.0, 115.0, 220.0, 0.0, 90.0, 270.0, 0.0, 35.0, 10.0, 35.0, 30.0, 30.0, 445.0, 510.0, 320.0, 265.0, 160.0, 20.0, 50.0, 0.0, 485.0, 230.0, 160.0, 155.0, 130.0, 110.0, 25.0, 205.0, 0.0, 30.0, 190.0, 190.0, 160.0, 0.0, 570.0, 155.0, 0.0, 105.0, 215.0, 25.0, 425.0, 75.0, 490.0, 245.0, 245.0, 130.0, 180.0, 70.0, 75.0, 210.0, 170.0, 70.0, 30.0, 980.0, 15.0, 335.0, 0.0, 450.0, 10.0, 505.0, 990.0, 55.0, 365.0, 205.0, 475.0, 480.0, 0.0, 0.0, 870.0, 0.0, 325.0, 190.0, 400.0, 835.0, 895.0, 835.0, 665.0, 370.0, 345.0, 900.0, 730.0, 485.0, 430.0, 0.0, 750.0, 700.0, 845.0, 365.0, 300.0, 0.0, 330.0, 280.0, 735.0, 605.0, 25.0, 685.0, 0.0, 500.0, 265.0, 295.0, 95.0, 350.0, 630.0, 750.0, 960.0, 900.0, 315.0, 45.0, 615.0, 820.0, 720.0, 25.0, 0.0, 55.0, 540.0, 825.0, 100.0, 30.0, 445.0, 430.0, 80.0, 0.0, 460.0, 920.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6281456909175924, "mean_inference_ms": 1.4790703266174434, "mean_action_processing_ms": 0.2454559959666903, "mean_env_wait_ms": 0.18572448669032796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007796764373779297, "StateBufferConnector_ms": 0.004026174545288086, "ViewRequirementAgentConnector_ms": 0.11320054531097412}, "num_episodes": 27, "episode_return_max": 389.0, "episode_return_min": -2423.0, "episode_return_mean": -305.58, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.97164882052367, "num_env_steps_trained_throughput_per_sec": 80.97164882052367, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 139718.511, "restore_workers_time_ms": 0.015, "training_step_time_ms": 139718.448, "sample_time_ms": 1238.116, "learn_time_ms": 138458.183, "learn_throughput": 28.89, "synch_weights_time_ms": 18.292}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-17-08", "timestamp": 1723501028, "time_this_iter_s": 49.44209098815918, "time_total_s": 2463.021842479706, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a85efaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2463.021842479706, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 26.267142857142858, "ram_util_percent": 83.0614285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6110606957995703, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.935244520631417, "policy_loss": -0.014207499725473109, "vf_loss": 7.947492191022035, "vf_explained_var": 0.0020894397188116003, "kl": 0.013065520810477866, "entropy": 1.2178614392482414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.631773745729809, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.305087856010154, "policy_loss": -0.016869746430939626, "vf_loss": 9.319390118311322, "vf_explained_var": -0.06829860191496592, "kl": 0.012837583244021128, "entropy": 1.384412801139569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -2423.0, "episode_reward_mean": -488.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1915.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -527.245, "predator_policy": 282.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 135.0, 97.0, 189.0, 105.0, 343.0, 306.0, 233.0, 270.0, 22.0, 330.0, 358.0, 119.0, 232.0, 384.0, -39.0, 234.0, 156.0, 354.0, 230.0, 265.0, -205.0, -90.0, 340.0, 296.0, 287.0, -819.0, -255.0, 157.0, 260.0, -622.0, 34.0, 51.0, -125.0, 355.0, -166.0, 74.0, -1439.0, 222.0, -60.0, -842.0, -622.0, -66.0, 143.0, 13.0, -53.0, -2423.0, -509.0, -382.0, -514.0, -2003.0, -449.0, -1123.0, 373.0, -1720.0, -623.0, -1607.0, -1652.0, -1444.0, -1996.0, -879.0, -789.0, -1301.0, -1722.0, -391.0, -721.0, -1785.0, -640.0, -840.0, -144.0, -559.0, -1379.0, -1293.0, -311.0, -1714.0, -1305.0, 291.0, -859.0, 85.0, -173.0, 197.0, -1362.0, -885.0, -679.0, -962.0, -625.0, -1653.0, -1006.0, 335.0, -783.0, -1395.0, -905.0, -1812.0, -978.0, -1183.0, -984.0, -950.0, -714.0, -764.0, -805.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 146.0, -124.0, 109.0, -347.0, 189.0, 169.0, -130.0, 138.0, -223.0, 179.0, 139.0, 163.0, 18.0, 62.0, 46.0, 156.0, 59.0, -109.0, -9.0, 111.0, 164.0, 164.0, 194.0, 15.0, -86.0, 144.0, 83.0, 196.0, 178.0, -442.0, 68.0, -71.0, 155.0, 13.0, 93.0, 200.0, 104.0, 102.0, 33.0, -63.0, 188.0, -211.0, -214.0, -250.0, -200.0, 197.0, 108.0, 136.0, 115.0, 131.0, 96.0, -863.0, -911.0, -610.0, -230.0, 145.0, -168.0, 87.0, 123.0, -521.0, -816.0, -41.0, -240.0, -297.0, 108.0, -115.0, -240.0, 134.0, 191.0, -290.0, -256.0, -129.0, 43.0, -1219.0, -945.0, 126.0, -9.0, -288.0, -12.0, -595.0, -747.0, -770.0, -587.0, -77.0, -364.0, -251.0, 144.0, -300.0, 28.0, 24.0, -317.0, -1912.0, -1521.0, -472.0, -387.0, -59.0, -773.0, -231.0, -798.0, -1550.0, -1498.0, -702.0, -317.0, -1307.0, -771.0, 189.0, 184.0, -1599.0, -991.0, -588.0, -550.0, -1028.0, -1814.0, -1592.0, -1790.0, -1330.0, -1149.0, -1702.0, -1539.0, -998.0, -1096.0, -684.0, -535.0, -1257.0, -1494.0, -1418.0, -1514.0, -410.0, -281.0, -667.0, -664.0, -1548.0, -1577.0, -69.0, -1281.0, -480.0, -860.0, -189.0, -515.0, -478.0, -526.0, -1653.0, -1106.0, -1915.0, -1238.0, -472.0, -199.0, -1469.0, -1680.0, -1443.0, -607.0, 74.0, 162.0, -1043.0, -1181.0, -168.0, 123.0, -312.0, -736.0, 23.0, 94.0, -1080.0, -1662.0, -277.0, -1408.0, -374.0, -945.0, -921.0, -951.0, -467.0, -1008.0, -1359.0, -1754.0, -807.0, -949.0, 160.0, 175.0, -488.0, -1400.0, -1703.0, -667.0, -463.0, -1187.0, -1812.0, -1040.0, -1358.0, -695.0, -1249.0, -719.0, -1136.0, -843.0, -1036.0, -844.0, -85.0, -1574.0, -934.0, -1110.0, -810.0, -1000.0], "policy_predator_policy_reward": [0.0, 0.0, 150.0, 0.0, 170.0, 85.0, 145.0, 5.0, 190.0, 0.0, 25.0, 0.0, 80.0, 45.0, 55.0, 70.0, 0.0, 55.0, 130.0, 10.0, 15.0, 40.0, 0.0, 0.0, 40.0, 150.0, 0.0, 5.0, 10.0, 0.0, 110.0, 225.0, 40.0, 110.0, 40.0, 10.0, 40.0, 10.0, 95.0, 0.0, 25.0, 115.0, 220.0, 0.0, 90.0, 270.0, 0.0, 35.0, 10.0, 35.0, 30.0, 30.0, 445.0, 510.0, 320.0, 265.0, 160.0, 20.0, 50.0, 0.0, 485.0, 230.0, 160.0, 155.0, 130.0, 110.0, 25.0, 205.0, 0.0, 30.0, 190.0, 190.0, 160.0, 0.0, 570.0, 155.0, 0.0, 105.0, 215.0, 25.0, 425.0, 75.0, 490.0, 245.0, 245.0, 130.0, 180.0, 70.0, 75.0, 210.0, 170.0, 70.0, 30.0, 980.0, 15.0, 335.0, 0.0, 450.0, 10.0, 505.0, 990.0, 55.0, 365.0, 205.0, 475.0, 480.0, 0.0, 0.0, 870.0, 0.0, 325.0, 190.0, 400.0, 835.0, 895.0, 835.0, 665.0, 370.0, 345.0, 900.0, 730.0, 485.0, 430.0, 0.0, 750.0, 700.0, 845.0, 365.0, 300.0, 0.0, 330.0, 280.0, 735.0, 605.0, 25.0, 685.0, 0.0, 500.0, 265.0, 295.0, 95.0, 350.0, 630.0, 750.0, 960.0, 900.0, 315.0, 45.0, 615.0, 820.0, 720.0, 25.0, 0.0, 55.0, 540.0, 825.0, 100.0, 30.0, 445.0, 430.0, 80.0, 0.0, 460.0, 920.0, 0.0, 800.0, 470.0, 170.0, 580.0, 330.0, 265.0, 585.0, 575.0, 885.0, 210.0, 540.0, 0.0, 0.0, 560.0, 545.0, 875.0, 100.0, 185.0, 560.0, 80.0, 960.0, 700.0, 375.0, 45.0, 740.0, 315.0, 680.0, 410.0, 520.0, 580.0, 365.0, 590.0, 690.0, 355.0, 650.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6282461341703718, "mean_inference_ms": 1.4775921584182619, "mean_action_processing_ms": 0.24563286458891143, "mean_env_wait_ms": 0.18593064012780908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005270838737487793, "StateBufferConnector_ms": 0.004098653793334961, "ViewRequirementAgentConnector_ms": 0.11400401592254639}, "num_episodes": 18, "episode_return_max": 384.0, "episode_return_min": -2423.0, "episode_return_mean": -488.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.1979506845396, "num_env_steps_trained_throughput_per_sec": 82.1979506845396, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 139819.437, "restore_workers_time_ms": 0.015, "training_step_time_ms": 139819.374, "sample_time_ms": 1238.76, "learn_time_ms": 138557.85, "learn_throughput": 28.869, "synch_weights_time_ms": 18.833}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-17-57", "timestamp": 1723501077, "time_this_iter_s": 48.69459795951843, "time_total_s": 2511.7164404392242, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88bc820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2511.7164404392242, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.707142857142856, "ram_util_percent": 82.82285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.610097569574124, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.885973502719213, "policy_loss": -0.010595695118459246, "vf_loss": 7.8952620889774705, "vf_explained_var": -0.0001874069057444416, "kl": 0.008713974822161838, "entropy": 1.163254093556177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.793216341008585, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.828613134919021, "policy_loss": -0.01759639184690381, "vf_loss": 7.843304113357786, "vf_explained_var": -0.13479628405243, "kl": 0.014527013754601217, "entropy": 1.4032764908497926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 373.0, "episode_reward_min": -2423.0, "episode_reward_mean": -636.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1915.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -656.635, "predator_policy": 338.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.0, 230.0, 265.0, -205.0, -90.0, 340.0, 296.0, 287.0, -819.0, -255.0, 157.0, 260.0, -622.0, 34.0, 51.0, -125.0, 355.0, -166.0, 74.0, -1439.0, 222.0, -60.0, -842.0, -622.0, -66.0, 143.0, 13.0, -53.0, -2423.0, -509.0, -382.0, -514.0, -2003.0, -449.0, -1123.0, 373.0, -1720.0, -623.0, -1607.0, -1652.0, -1444.0, -1996.0, -879.0, -789.0, -1301.0, -1722.0, -391.0, -721.0, -1785.0, -640.0, -840.0, -144.0, -559.0, -1379.0, -1293.0, -311.0, -1714.0, -1305.0, 291.0, -859.0, 85.0, -173.0, 197.0, -1362.0, -885.0, -679.0, -962.0, -625.0, -1653.0, -1006.0, 335.0, -783.0, -1395.0, -905.0, -1812.0, -978.0, -1183.0, -984.0, -950.0, -714.0, -764.0, -805.0, -544.0, -765.0, -1234.0, -422.0, 82.0, -591.0, -279.0, -393.0, -781.0, -777.0, -487.0, -703.0, -1404.0, -235.0, -1009.0, -496.0, -473.0, -409.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 104.0, 102.0, 33.0, -63.0, 188.0, -211.0, -214.0, -250.0, -200.0, 197.0, 108.0, 136.0, 115.0, 131.0, 96.0, -863.0, -911.0, -610.0, -230.0, 145.0, -168.0, 87.0, 123.0, -521.0, -816.0, -41.0, -240.0, -297.0, 108.0, -115.0, -240.0, 134.0, 191.0, -290.0, -256.0, -129.0, 43.0, -1219.0, -945.0, 126.0, -9.0, -288.0, -12.0, -595.0, -747.0, -770.0, -587.0, -77.0, -364.0, -251.0, 144.0, -300.0, 28.0, 24.0, -317.0, -1912.0, -1521.0, -472.0, -387.0, -59.0, -773.0, -231.0, -798.0, -1550.0, -1498.0, -702.0, -317.0, -1307.0, -771.0, 189.0, 184.0, -1599.0, -991.0, -588.0, -550.0, -1028.0, -1814.0, -1592.0, -1790.0, -1330.0, -1149.0, -1702.0, -1539.0, -998.0, -1096.0, -684.0, -535.0, -1257.0, -1494.0, -1418.0, -1514.0, -410.0, -281.0, -667.0, -664.0, -1548.0, -1577.0, -69.0, -1281.0, -480.0, -860.0, -189.0, -515.0, -478.0, -526.0, -1653.0, -1106.0, -1915.0, -1238.0, -472.0, -199.0, -1469.0, -1680.0, -1443.0, -607.0, 74.0, 162.0, -1043.0, -1181.0, -168.0, 123.0, -312.0, -736.0, 23.0, 94.0, -1080.0, -1662.0, -277.0, -1408.0, -374.0, -945.0, -921.0, -951.0, -467.0, -1008.0, -1359.0, -1754.0, -807.0, -949.0, 160.0, 175.0, -488.0, -1400.0, -1703.0, -667.0, -463.0, -1187.0, -1812.0, -1040.0, -1358.0, -695.0, -1249.0, -719.0, -1136.0, -843.0, -1036.0, -844.0, -85.0, -1574.0, -934.0, -1110.0, -810.0, -1000.0, -549.0, -770.0, -765.0, -680.0, -996.0, -1048.0, -507.0, -240.0, -122.0, 89.0, -257.0, -1149.0, -38.0, -566.0, -138.0, -860.0, -1050.0, -1046.0, -612.0, -1020.0, -1185.0, -97.0, -354.0, -1129.0, -1102.0, -1167.0, -660.0, -100.0, -1306.0, -1103.0, -840.0, -261.0, -388.0, -820.0, -744.0, -500.0], "policy_predator_policy_reward": [40.0, 10.0, 95.0, 0.0, 25.0, 115.0, 220.0, 0.0, 90.0, 270.0, 0.0, 35.0, 10.0, 35.0, 30.0, 30.0, 445.0, 510.0, 320.0, 265.0, 160.0, 20.0, 50.0, 0.0, 485.0, 230.0, 160.0, 155.0, 130.0, 110.0, 25.0, 205.0, 0.0, 30.0, 190.0, 190.0, 160.0, 0.0, 570.0, 155.0, 0.0, 105.0, 215.0, 25.0, 425.0, 75.0, 490.0, 245.0, 245.0, 130.0, 180.0, 70.0, 75.0, 210.0, 170.0, 70.0, 30.0, 980.0, 15.0, 335.0, 0.0, 450.0, 10.0, 505.0, 990.0, 55.0, 365.0, 205.0, 475.0, 480.0, 0.0, 0.0, 870.0, 0.0, 325.0, 190.0, 400.0, 835.0, 895.0, 835.0, 665.0, 370.0, 345.0, 900.0, 730.0, 485.0, 430.0, 0.0, 750.0, 700.0, 845.0, 365.0, 300.0, 0.0, 330.0, 280.0, 735.0, 605.0, 25.0, 685.0, 0.0, 500.0, 265.0, 295.0, 95.0, 350.0, 630.0, 750.0, 960.0, 900.0, 315.0, 45.0, 615.0, 820.0, 720.0, 25.0, 0.0, 55.0, 540.0, 825.0, 100.0, 30.0, 445.0, 430.0, 80.0, 0.0, 460.0, 920.0, 0.0, 800.0, 470.0, 170.0, 580.0, 330.0, 265.0, 585.0, 575.0, 885.0, 210.0, 540.0, 0.0, 0.0, 560.0, 545.0, 875.0, 100.0, 185.0, 560.0, 80.0, 960.0, 700.0, 375.0, 45.0, 740.0, 315.0, 680.0, 410.0, 520.0, 580.0, 365.0, 590.0, 690.0, 355.0, 650.0, 445.0, 330.0, 470.0, 210.0, 665.0, 145.0, 325.0, 0.0, 60.0, 55.0, 580.0, 235.0, 85.0, 240.0, 195.0, 410.0, 685.0, 630.0, 470.0, 385.0, 465.0, 330.0, 185.0, 595.0, 115.0, 750.0, 225.0, 300.0, 780.0, 620.0, 220.0, 385.0, 480.0, 255.0, 205.0, 630.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6285295635764675, "mean_inference_ms": 1.476467939804171, "mean_action_processing_ms": 0.24568462219898138, "mean_env_wait_ms": 0.18607297326952493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005236148834228516, "StateBufferConnector_ms": 0.004041314125061035, "ViewRequirementAgentConnector_ms": 0.11359906196594238}, "num_episodes": 18, "episode_return_max": 373.0, "episode_return_min": -2423.0, "episode_return_mean": -636.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.39987789385077, "num_env_steps_trained_throughput_per_sec": 83.39987789385077, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 139569.672, "restore_workers_time_ms": 0.015, "training_step_time_ms": 139569.61, "sample_time_ms": 1241.063, "learn_time_ms": 138305.687, "learn_throughput": 28.921, "synch_weights_time_ms": 18.937}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-18-45", "timestamp": 1723501125, "time_this_iter_s": 47.99684500694275, "time_total_s": 2559.713285446167, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88acd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2559.713285446167, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 22.844117647058823, "ram_util_percent": 83.06323529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6518842629970065, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.508630453341852, "policy_loss": -0.01204527175108158, "vf_loss": 6.519275244203194, "vf_explained_var": 6.22578398891227e-05, "kl": 0.009336530213074661, "entropy": 1.1649326034954617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.591813128051304, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.525989804192195, "policy_loss": -0.01812342618316136, "vf_loss": 6.541786274329695, "vf_explained_var": -0.06338603389326226, "kl": 0.011634722232298266, "entropy": 1.392935092991622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 373.0, "episode_reward_min": -2423.0, "episode_reward_mean": -701.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1915.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -716.88, "predator_policy": 365.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.0, -1439.0, 222.0, -60.0, -842.0, -622.0, -66.0, 143.0, 13.0, -53.0, -2423.0, -509.0, -382.0, -514.0, -2003.0, -449.0, -1123.0, 373.0, -1720.0, -623.0, -1607.0, -1652.0, -1444.0, -1996.0, -879.0, -789.0, -1301.0, -1722.0, -391.0, -721.0, -1785.0, -640.0, -840.0, -144.0, -559.0, -1379.0, -1293.0, -311.0, -1714.0, -1305.0, 291.0, -859.0, 85.0, -173.0, 197.0, -1362.0, -885.0, -679.0, -962.0, -625.0, -1653.0, -1006.0, 335.0, -783.0, -1395.0, -905.0, -1812.0, -978.0, -1183.0, -984.0, -950.0, -714.0, -764.0, -805.0, -544.0, -765.0, -1234.0, -422.0, 82.0, -591.0, -279.0, -393.0, -781.0, -777.0, -487.0, -703.0, -1404.0, -235.0, -1009.0, -496.0, -473.0, -409.0, -82.0, -153.0, -542.0, -468.0, -121.0, -115.0, -273.0, -739.0, -591.0, -300.0, -619.0, -751.0, -168.0, -236.0, 33.0, -634.0, -274.0, -184.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-129.0, 43.0, -1219.0, -945.0, 126.0, -9.0, -288.0, -12.0, -595.0, -747.0, -770.0, -587.0, -77.0, -364.0, -251.0, 144.0, -300.0, 28.0, 24.0, -317.0, -1912.0, -1521.0, -472.0, -387.0, -59.0, -773.0, -231.0, -798.0, -1550.0, -1498.0, -702.0, -317.0, -1307.0, -771.0, 189.0, 184.0, -1599.0, -991.0, -588.0, -550.0, -1028.0, -1814.0, -1592.0, -1790.0, -1330.0, -1149.0, -1702.0, -1539.0, -998.0, -1096.0, -684.0, -535.0, -1257.0, -1494.0, -1418.0, -1514.0, -410.0, -281.0, -667.0, -664.0, -1548.0, -1577.0, -69.0, -1281.0, -480.0, -860.0, -189.0, -515.0, -478.0, -526.0, -1653.0, -1106.0, -1915.0, -1238.0, -472.0, -199.0, -1469.0, -1680.0, -1443.0, -607.0, 74.0, 162.0, -1043.0, -1181.0, -168.0, 123.0, -312.0, -736.0, 23.0, 94.0, -1080.0, -1662.0, -277.0, -1408.0, -374.0, -945.0, -921.0, -951.0, -467.0, -1008.0, -1359.0, -1754.0, -807.0, -949.0, 160.0, 175.0, -488.0, -1400.0, -1703.0, -667.0, -463.0, -1187.0, -1812.0, -1040.0, -1358.0, -695.0, -1249.0, -719.0, -1136.0, -843.0, -1036.0, -844.0, -85.0, -1574.0, -934.0, -1110.0, -810.0, -1000.0, -549.0, -770.0, -765.0, -680.0, -996.0, -1048.0, -507.0, -240.0, -122.0, 89.0, -257.0, -1149.0, -38.0, -566.0, -138.0, -860.0, -1050.0, -1046.0, -612.0, -1020.0, -1185.0, -97.0, -354.0, -1129.0, -1102.0, -1167.0, -660.0, -100.0, -1306.0, -1103.0, -840.0, -261.0, -388.0, -820.0, -744.0, -500.0, -182.0, 0.0, -143.0, -170.0, -180.0, -1122.0, -441.0, -382.0, -316.0, 0.0, -10.0, -210.0, -327.0, -541.0, -620.0, -864.0, -960.0, -301.0, -23.0, -1647.0, -669.0, -625.0, -1876.0, -610.0, -448.0, 0.0, -110.0, -491.0, 76.0, -203.0, -1720.0, -219.0, -110.0, -549.0, -84.0, -310.0], "policy_predator_policy_reward": [160.0, 0.0, 570.0, 155.0, 0.0, 105.0, 215.0, 25.0, 425.0, 75.0, 490.0, 245.0, 245.0, 130.0, 180.0, 70.0, 75.0, 210.0, 170.0, 70.0, 30.0, 980.0, 15.0, 335.0, 0.0, 450.0, 10.0, 505.0, 990.0, 55.0, 365.0, 205.0, 475.0, 480.0, 0.0, 0.0, 870.0, 0.0, 325.0, 190.0, 400.0, 835.0, 895.0, 835.0, 665.0, 370.0, 345.0, 900.0, 730.0, 485.0, 430.0, 0.0, 750.0, 700.0, 845.0, 365.0, 300.0, 0.0, 330.0, 280.0, 735.0, 605.0, 25.0, 685.0, 0.0, 500.0, 265.0, 295.0, 95.0, 350.0, 630.0, 750.0, 960.0, 900.0, 315.0, 45.0, 615.0, 820.0, 720.0, 25.0, 0.0, 55.0, 540.0, 825.0, 100.0, 30.0, 445.0, 430.0, 80.0, 0.0, 460.0, 920.0, 0.0, 800.0, 470.0, 170.0, 580.0, 330.0, 265.0, 585.0, 575.0, 885.0, 210.0, 540.0, 0.0, 0.0, 560.0, 545.0, 875.0, 100.0, 185.0, 560.0, 80.0, 960.0, 700.0, 375.0, 45.0, 740.0, 315.0, 680.0, 410.0, 520.0, 580.0, 365.0, 590.0, 690.0, 355.0, 650.0, 445.0, 330.0, 470.0, 210.0, 665.0, 145.0, 325.0, 0.0, 60.0, 55.0, 580.0, 235.0, 85.0, 240.0, 195.0, 410.0, 685.0, 630.0, 470.0, 385.0, 465.0, 330.0, 185.0, 595.0, 115.0, 750.0, 225.0, 300.0, 780.0, 620.0, 220.0, 385.0, 480.0, 255.0, 205.0, 630.0, 5.0, 95.0, 65.0, 95.0, 175.0, 585.0, 165.0, 190.0, 165.0, 30.0, 105.0, 0.0, 280.0, 315.0, 625.0, 120.0, 385.0, 285.0, 685.0, 685.0, 395.0, 280.0, 940.0, 795.0, 65.0, 215.0, 135.0, 230.0, 60.0, 100.0, 820.0, 485.0, 245.0, 140.0, 40.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6277365796886201, "mean_inference_ms": 1.4727256478723563, "mean_action_processing_ms": 0.2453226438866584, "mean_env_wait_ms": 0.18573520766998527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005048155784606934, "StateBufferConnector_ms": 0.0039403438568115234, "ViewRequirementAgentConnector_ms": 0.10740411281585693}, "num_episodes": 18, "episode_return_max": 373.0, "episode_return_min": -2423.0, "episode_return_mean": -701.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 51.90014544289458, "num_env_steps_trained_throughput_per_sec": 51.90014544289458, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 142399.761, "restore_workers_time_ms": 0.015, "training_step_time_ms": 142399.699, "sample_time_ms": 1232.232, "learn_time_ms": 141144.631, "learn_throughput": 28.34, "synch_weights_time_ms": 18.937}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-20-02", "timestamp": 1723501202, "time_this_iter_s": 77.08395910263062, "time_total_s": 2636.7972445487976, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88bd4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2636.7972445487976, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 35.81052631578948, "ram_util_percent": 81.88552631578949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.066424261703693, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.735902463317548, "policy_loss": -0.009849647482950733, "vf_loss": 3.7447775747410206, "vf_explained_var": 0.010408773182561159, "kl": 0.006496923770412048, "entropy": 1.1641702082422045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.848820965630668, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.086868605916462, "policy_loss": -0.014408547640654934, "vf_loss": 4.099471788431601, "vf_explained_var": -0.1467061751103275, "kl": 0.009026816106706958, "entropy": 1.4151841777342338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 335.0, "episode_reward_min": -1996.0, "episode_reward_mean": -605.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1915.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 175.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -641.38, "predator_policy": 338.475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1444.0, -1996.0, -879.0, -789.0, -1301.0, -1722.0, -391.0, -721.0, -1785.0, -640.0, -840.0, -144.0, -559.0, -1379.0, -1293.0, -311.0, -1714.0, -1305.0, 291.0, -859.0, 85.0, -173.0, 197.0, -1362.0, -885.0, -679.0, -962.0, -625.0, -1653.0, -1006.0, 335.0, -783.0, -1395.0, -905.0, -1812.0, -978.0, -1183.0, -984.0, -950.0, -714.0, -764.0, -805.0, -544.0, -765.0, -1234.0, -422.0, 82.0, -591.0, -279.0, -393.0, -781.0, -777.0, -487.0, -703.0, -1404.0, -235.0, -1009.0, -496.0, -473.0, -409.0, -82.0, -153.0, -542.0, -468.0, -121.0, -115.0, -273.0, -739.0, -591.0, -300.0, -619.0, -751.0, -168.0, -236.0, 33.0, -634.0, -274.0, -184.0, -355.0, -207.0, -476.0, -546.0, -15.0, -134.0, -1195.0, -175.0, -15.0, -117.0, -210.0, -160.0, -196.0, -244.0, -375.0, 8.0, -332.0, -157.0, -450.0, -47.0, -124.0, -140.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1330.0, -1149.0, -1702.0, -1539.0, -998.0, -1096.0, -684.0, -535.0, -1257.0, -1494.0, -1418.0, -1514.0, -410.0, -281.0, -667.0, -664.0, -1548.0, -1577.0, -69.0, -1281.0, -480.0, -860.0, -189.0, -515.0, -478.0, -526.0, -1653.0, -1106.0, -1915.0, -1238.0, -472.0, -199.0, -1469.0, -1680.0, -1443.0, -607.0, 74.0, 162.0, -1043.0, -1181.0, -168.0, 123.0, -312.0, -736.0, 23.0, 94.0, -1080.0, -1662.0, -277.0, -1408.0, -374.0, -945.0, -921.0, -951.0, -467.0, -1008.0, -1359.0, -1754.0, -807.0, -949.0, 160.0, 175.0, -488.0, -1400.0, -1703.0, -667.0, -463.0, -1187.0, -1812.0, -1040.0, -1358.0, -695.0, -1249.0, -719.0, -1136.0, -843.0, -1036.0, -844.0, -85.0, -1574.0, -934.0, -1110.0, -810.0, -1000.0, -549.0, -770.0, -765.0, -680.0, -996.0, -1048.0, -507.0, -240.0, -122.0, 89.0, -257.0, -1149.0, -38.0, -566.0, -138.0, -860.0, -1050.0, -1046.0, -612.0, -1020.0, -1185.0, -97.0, -354.0, -1129.0, -1102.0, -1167.0, -660.0, -100.0, -1306.0, -1103.0, -840.0, -261.0, -388.0, -820.0, -744.0, -500.0, -182.0, 0.0, -143.0, -170.0, -180.0, -1122.0, -441.0, -382.0, -316.0, 0.0, -10.0, -210.0, -327.0, -541.0, -620.0, -864.0, -960.0, -301.0, -23.0, -1647.0, -669.0, -625.0, -1876.0, -610.0, -448.0, 0.0, -110.0, -491.0, 76.0, -203.0, -1720.0, -219.0, -110.0, -549.0, -84.0, -310.0, -200.0, -750.0, -257.0, -190.0, -926.0, -20.0, -1857.0, -604.0, 0.0, -30.0, -120.0, -129.0, -560.0, -1390.0, -80.0, -230.0, 0.0, -30.0, -94.0, -208.0, -120.0, -470.0, -103.0, -197.0, -145.0, -226.0, -369.0, -130.0, -50.0, -730.0, 1.0, -18.0, -210.0, -327.0, -170.0, -192.0, -820.0, -330.0, -190.0, 48.0, -239.0, -30.0, -130.0, -200.0], "policy_predator_policy_reward": [665.0, 370.0, 345.0, 900.0, 730.0, 485.0, 430.0, 0.0, 750.0, 700.0, 845.0, 365.0, 300.0, 0.0, 330.0, 280.0, 735.0, 605.0, 25.0, 685.0, 0.0, 500.0, 265.0, 295.0, 95.0, 350.0, 630.0, 750.0, 960.0, 900.0, 315.0, 45.0, 615.0, 820.0, 720.0, 25.0, 0.0, 55.0, 540.0, 825.0, 100.0, 30.0, 445.0, 430.0, 80.0, 0.0, 460.0, 920.0, 0.0, 800.0, 470.0, 170.0, 580.0, 330.0, 265.0, 585.0, 575.0, 885.0, 210.0, 540.0, 0.0, 0.0, 560.0, 545.0, 875.0, 100.0, 185.0, 560.0, 80.0, 960.0, 700.0, 375.0, 45.0, 740.0, 315.0, 680.0, 410.0, 520.0, 580.0, 365.0, 590.0, 690.0, 355.0, 650.0, 445.0, 330.0, 470.0, 210.0, 665.0, 145.0, 325.0, 0.0, 60.0, 55.0, 580.0, 235.0, 85.0, 240.0, 195.0, 410.0, 685.0, 630.0, 470.0, 385.0, 465.0, 330.0, 185.0, 595.0, 115.0, 750.0, 225.0, 300.0, 780.0, 620.0, 220.0, 385.0, 480.0, 255.0, 205.0, 630.0, 5.0, 95.0, 65.0, 95.0, 175.0, 585.0, 165.0, 190.0, 165.0, 30.0, 105.0, 0.0, 280.0, 315.0, 625.0, 120.0, 385.0, 285.0, 685.0, 685.0, 395.0, 280.0, 940.0, 795.0, 65.0, 215.0, 135.0, 230.0, 60.0, 100.0, 820.0, 485.0, 245.0, 140.0, 40.0, 170.0, 295.0, 300.0, 135.0, 105.0, 85.0, 385.0, 940.0, 975.0, 0.0, 15.0, 75.0, 40.0, 0.0, 755.0, 115.0, 20.0, 0.0, 15.0, 20.0, 165.0, 155.0, 225.0, 40.0, 100.0, 10.0, 165.0, 205.0, 50.0, 205.0, 200.0, 10.0, 15.0, 0.0, 205.0, 140.0, 65.0, 375.0, 325.0, 95.0, 0.0, 65.0, 80.0, 100.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6261978345318644, "mean_inference_ms": 1.4670854589980933, "mean_action_processing_ms": 0.24483555688748374, "mean_env_wait_ms": 0.18508535170310908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004781365394592285, "StateBufferConnector_ms": 0.003850102424621582, "ViewRequirementAgentConnector_ms": 0.10375082492828369}, "num_episodes": 22, "episode_return_max": 335.0, "episode_return_min": -1996.0, "episode_return_mean": -605.81, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.47044612393314, "num_env_steps_trained_throughput_per_sec": 84.47044612393314, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 142336.555, "restore_workers_time_ms": 0.015, "training_step_time_ms": 142336.493, "sample_time_ms": 1208.891, "learn_time_ms": 141104.97, "learn_throughput": 28.348, "synch_weights_time_ms": 18.941}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-20-49", "timestamp": 1723501249, "time_this_iter_s": 47.358874797821045, "time_total_s": 2684.1561193466187, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88bcee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2684.1561193466187, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.413432835820892, "ram_util_percent": 77.06716417910448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7719002201758995, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.449890246971575, "policy_loss": -0.010118541338914641, "vf_loss": 4.458867009606942, "vf_explained_var": 0.0023979203410880276, "kl": 0.007611877437290662, "entropy": 1.1226164516948518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.056692545407664, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.625581606859884, "policy_loss": -0.014520924209084895, "vf_loss": 4.638299743712895, "vf_explained_var": -0.0883099753705282, "kl": 0.0090139477847799, "entropy": 1.4079739973658607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 335.0, "episode_reward_min": -1812.0, "episode_reward_mean": -466.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1876.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 175.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -515.18, "predator_policy": 281.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1362.0, -885.0, -679.0, -962.0, -625.0, -1653.0, -1006.0, 335.0, -783.0, -1395.0, -905.0, -1812.0, -978.0, -1183.0, -984.0, -950.0, -714.0, -764.0, -805.0, -544.0, -765.0, -1234.0, -422.0, 82.0, -591.0, -279.0, -393.0, -781.0, -777.0, -487.0, -703.0, -1404.0, -235.0, -1009.0, -496.0, -473.0, -409.0, -82.0, -153.0, -542.0, -468.0, -121.0, -115.0, -273.0, -739.0, -591.0, -300.0, -619.0, -751.0, -168.0, -236.0, 33.0, -634.0, -274.0, -184.0, -355.0, -207.0, -476.0, -546.0, -15.0, -134.0, -1195.0, -175.0, -15.0, -117.0, -210.0, -160.0, -196.0, -244.0, -375.0, 8.0, -332.0, -157.0, -450.0, -47.0, -124.0, -140.0, -66.0, -118.0, -114.0, -362.0, -225.0, 1.0, -235.0, -55.0, -159.0, -100.0, -361.0, -416.0, -338.0, -130.0, -79.0, -562.0, -352.0, -196.0, -528.0, -336.0, -214.0, -572.0, -220.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1080.0, -1662.0, -277.0, -1408.0, -374.0, -945.0, -921.0, -951.0, -467.0, -1008.0, -1359.0, -1754.0, -807.0, -949.0, 160.0, 175.0, -488.0, -1400.0, -1703.0, -667.0, -463.0, -1187.0, -1812.0, -1040.0, -1358.0, -695.0, -1249.0, -719.0, -1136.0, -843.0, -1036.0, -844.0, -85.0, -1574.0, -934.0, -1110.0, -810.0, -1000.0, -549.0, -770.0, -765.0, -680.0, -996.0, -1048.0, -507.0, -240.0, -122.0, 89.0, -257.0, -1149.0, -38.0, -566.0, -138.0, -860.0, -1050.0, -1046.0, -612.0, -1020.0, -1185.0, -97.0, -354.0, -1129.0, -1102.0, -1167.0, -660.0, -100.0, -1306.0, -1103.0, -840.0, -261.0, -388.0, -820.0, -744.0, -500.0, -182.0, 0.0, -143.0, -170.0, -180.0, -1122.0, -441.0, -382.0, -316.0, 0.0, -10.0, -210.0, -327.0, -541.0, -620.0, -864.0, -960.0, -301.0, -23.0, -1647.0, -669.0, -625.0, -1876.0, -610.0, -448.0, 0.0, -110.0, -491.0, 76.0, -203.0, -1720.0, -219.0, -110.0, -549.0, -84.0, -310.0, -200.0, -750.0, -257.0, -190.0, -926.0, -20.0, -1857.0, -604.0, 0.0, -30.0, -120.0, -129.0, -560.0, -1390.0, -80.0, -230.0, 0.0, -30.0, -94.0, -208.0, -120.0, -470.0, -103.0, -197.0, -145.0, -226.0, -369.0, -130.0, -50.0, -730.0, 1.0, -18.0, -210.0, -327.0, -170.0, -192.0, -820.0, -330.0, -190.0, 48.0, -239.0, -30.0, -130.0, -200.0, -136.0, 0.0, 0.0, -933.0, -186.0, -58.0, -582.0, -200.0, -480.0, -210.0, 1.0, 0.0, -330.0, -160.0, -110.0, 0.0, -150.0, -259.0, -180.0, -10.0, -396.0, -660.0, -600.0, -286.0, -207.0, -266.0, -270.0, 0.0, -269.0, -10.0, -520.0, -417.0, -224.0, -458.0, -356.0, -250.0, -430.0, -828.0, -256.0, -380.0, -279.0, -140.0, -490.0, -1167.0, -485.0, -140.0], "policy_predator_policy_reward": [460.0, 920.0, 0.0, 800.0, 470.0, 170.0, 580.0, 330.0, 265.0, 585.0, 575.0, 885.0, 210.0, 540.0, 0.0, 0.0, 560.0, 545.0, 875.0, 100.0, 185.0, 560.0, 80.0, 960.0, 700.0, 375.0, 45.0, 740.0, 315.0, 680.0, 410.0, 520.0, 580.0, 365.0, 590.0, 690.0, 355.0, 650.0, 445.0, 330.0, 470.0, 210.0, 665.0, 145.0, 325.0, 0.0, 60.0, 55.0, 580.0, 235.0, 85.0, 240.0, 195.0, 410.0, 685.0, 630.0, 470.0, 385.0, 465.0, 330.0, 185.0, 595.0, 115.0, 750.0, 225.0, 300.0, 780.0, 620.0, 220.0, 385.0, 480.0, 255.0, 205.0, 630.0, 5.0, 95.0, 65.0, 95.0, 175.0, 585.0, 165.0, 190.0, 165.0, 30.0, 105.0, 0.0, 280.0, 315.0, 625.0, 120.0, 385.0, 285.0, 685.0, 685.0, 395.0, 280.0, 940.0, 795.0, 65.0, 215.0, 135.0, 230.0, 60.0, 100.0, 820.0, 485.0, 245.0, 140.0, 40.0, 170.0, 295.0, 300.0, 135.0, 105.0, 85.0, 385.0, 940.0, 975.0, 0.0, 15.0, 75.0, 40.0, 0.0, 755.0, 115.0, 20.0, 0.0, 15.0, 20.0, 165.0, 155.0, 225.0, 40.0, 100.0, 10.0, 165.0, 205.0, 50.0, 205.0, 200.0, 10.0, 15.0, 0.0, 205.0, 140.0, 65.0, 375.0, 325.0, 95.0, 0.0, 65.0, 80.0, 100.0, 90.0, 0.0, 70.0, 440.0, 375.0, 25.0, 105.0, 365.0, 55.0, 225.0, 240.0, 0.0, 0.0, 80.0, 175.0, 0.0, 55.0, 125.0, 125.0, 60.0, 30.0, 395.0, 300.0, 220.0, 250.0, 0.0, 135.0, 15.0, 125.0, 135.0, 65.0, 80.0, 295.0, 115.0, 215.0, 210.0, 200.0, 345.0, 385.0, 175.0, 125.0, 135.0, 70.0, 585.0, 500.0, 250.0, 155.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6239315868772851, "mean_inference_ms": 1.4597758146347923, "mean_action_processing_ms": 0.24395163442620824, "mean_env_wait_ms": 0.18429471409428036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033997297286987305, "StateBufferConnector_ms": 0.0030515193939208984, "ViewRequirementAgentConnector_ms": 0.0948324203491211}, "num_episodes": 23, "episode_return_max": 335.0, "episode_return_min": -1812.0, "episode_return_mean": -466.46, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.20767754129797, "num_env_steps_trained_throughput_per_sec": 84.20767754129797, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 142190.868, "restore_workers_time_ms": 0.015, "training_step_time_ms": 142190.807, "sample_time_ms": 1204.026, "learn_time_ms": 140964.389, "learn_throughput": 28.376, "synch_weights_time_ms": 18.761}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-21-37", "timestamp": 1723501297, "time_this_iter_s": 47.50661373138428, "time_total_s": 2731.662733078003, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88bd160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2731.662733078003, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 22.19558823529412, "ram_util_percent": 76.71470588235292}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0840575522215907, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9338747905675695, "policy_loss": -0.013933012069809058, "vf_loss": 2.946039065608272, "vf_explained_var": -0.0020929498962624364, "kl": 0.011791614861955005, "entropy": 1.1079722193813828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.428160252772942, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.848389972896172, "policy_loss": -0.01043862094659181, "vf_loss": 2.8573582497223344, "vf_explained_var": -0.053462145000538495, "kl": 0.007351716978410139, "entropy": 1.40437165694262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 82.0, "episode_reward_min": -1404.0, "episode_reward_mean": -330.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1876.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 89.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -390.12, "predator_policy": 225.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-805.0, -544.0, -765.0, -1234.0, -422.0, 82.0, -591.0, -279.0, -393.0, -781.0, -777.0, -487.0, -703.0, -1404.0, -235.0, -1009.0, -496.0, -473.0, -409.0, -82.0, -153.0, -542.0, -468.0, -121.0, -115.0, -273.0, -739.0, -591.0, -300.0, -619.0, -751.0, -168.0, -236.0, 33.0, -634.0, -274.0, -184.0, -355.0, -207.0, -476.0, -546.0, -15.0, -134.0, -1195.0, -175.0, -15.0, -117.0, -210.0, -160.0, -196.0, -244.0, -375.0, 8.0, -332.0, -157.0, -450.0, -47.0, -124.0, -140.0, -66.0, -118.0, -114.0, -362.0, -225.0, 1.0, -235.0, -55.0, -159.0, -100.0, -361.0, -416.0, -338.0, -130.0, -79.0, -562.0, -352.0, -196.0, -528.0, -336.0, -214.0, -572.0, -220.0, -154.0, -290.0, -334.0, -102.0, -114.0, -163.0, -209.0, -318.0, -435.0, -158.0, 7.0, -81.0, -516.0, -128.0, -84.0, -127.0, -270.0, -192.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-810.0, -1000.0, -549.0, -770.0, -765.0, -680.0, -996.0, -1048.0, -507.0, -240.0, -122.0, 89.0, -257.0, -1149.0, -38.0, -566.0, -138.0, -860.0, -1050.0, -1046.0, -612.0, -1020.0, -1185.0, -97.0, -354.0, -1129.0, -1102.0, -1167.0, -660.0, -100.0, -1306.0, -1103.0, -840.0, -261.0, -388.0, -820.0, -744.0, -500.0, -182.0, 0.0, -143.0, -170.0, -180.0, -1122.0, -441.0, -382.0, -316.0, 0.0, -10.0, -210.0, -327.0, -541.0, -620.0, -864.0, -960.0, -301.0, -23.0, -1647.0, -669.0, -625.0, -1876.0, -610.0, -448.0, 0.0, -110.0, -491.0, 76.0, -203.0, -1720.0, -219.0, -110.0, -549.0, -84.0, -310.0, -200.0, -750.0, -257.0, -190.0, -926.0, -20.0, -1857.0, -604.0, 0.0, -30.0, -120.0, -129.0, -560.0, -1390.0, -80.0, -230.0, 0.0, -30.0, -94.0, -208.0, -120.0, -470.0, -103.0, -197.0, -145.0, -226.0, -369.0, -130.0, -50.0, -730.0, 1.0, -18.0, -210.0, -327.0, -170.0, -192.0, -820.0, -330.0, -190.0, 48.0, -239.0, -30.0, -130.0, -200.0, -136.0, 0.0, 0.0, -933.0, -186.0, -58.0, -582.0, -200.0, -480.0, -210.0, 1.0, 0.0, -330.0, -160.0, -110.0, 0.0, -150.0, -259.0, -180.0, -10.0, -396.0, -660.0, -600.0, -286.0, -207.0, -266.0, -270.0, 0.0, -269.0, -10.0, -520.0, -417.0, -224.0, -458.0, -356.0, -250.0, -430.0, -828.0, -256.0, -380.0, -279.0, -140.0, -490.0, -1167.0, -485.0, -140.0, -470.0, -134.0, -410.0, -180.0, -446.0, -253.0, -72.0, -150.0, -70.0, -334.0, -330.0, -3.0, -229.0, -540.0, -143.0, -570.0, -290.0, -370.0, 0.0, -518.0, 2.0, 0.0, 0.0, -666.0, -320.0, -406.0, -679.0, -29.0, -40.0, -139.0, -88.0, -254.0, -340.0, -180.0, -99.0, -208.0], "policy_predator_policy_reward": [355.0, 650.0, 445.0, 330.0, 470.0, 210.0, 665.0, 145.0, 325.0, 0.0, 60.0, 55.0, 580.0, 235.0, 85.0, 240.0, 195.0, 410.0, 685.0, 630.0, 470.0, 385.0, 465.0, 330.0, 185.0, 595.0, 115.0, 750.0, 225.0, 300.0, 780.0, 620.0, 220.0, 385.0, 480.0, 255.0, 205.0, 630.0, 5.0, 95.0, 65.0, 95.0, 175.0, 585.0, 165.0, 190.0, 165.0, 30.0, 105.0, 0.0, 280.0, 315.0, 625.0, 120.0, 385.0, 285.0, 685.0, 685.0, 395.0, 280.0, 940.0, 795.0, 65.0, 215.0, 135.0, 230.0, 60.0, 100.0, 820.0, 485.0, 245.0, 140.0, 40.0, 170.0, 295.0, 300.0, 135.0, 105.0, 85.0, 385.0, 940.0, 975.0, 0.0, 15.0, 75.0, 40.0, 0.0, 755.0, 115.0, 20.0, 0.0, 15.0, 20.0, 165.0, 155.0, 225.0, 40.0, 100.0, 10.0, 165.0, 205.0, 50.0, 205.0, 200.0, 10.0, 15.0, 0.0, 205.0, 140.0, 65.0, 375.0, 325.0, 95.0, 0.0, 65.0, 80.0, 100.0, 90.0, 0.0, 70.0, 440.0, 375.0, 25.0, 105.0, 365.0, 55.0, 225.0, 240.0, 0.0, 0.0, 80.0, 175.0, 0.0, 55.0, 125.0, 125.0, 60.0, 30.0, 395.0, 300.0, 220.0, 250.0, 0.0, 135.0, 15.0, 125.0, 135.0, 65.0, 80.0, 295.0, 115.0, 215.0, 210.0, 200.0, 345.0, 385.0, 175.0, 125.0, 135.0, 70.0, 585.0, 500.0, 250.0, 155.0, 155.0, 295.0, 95.0, 205.0, 85.0, 280.0, 75.0, 45.0, 130.0, 160.0, 170.0, 0.0, 330.0, 230.0, 105.0, 290.0, 0.0, 225.0, 145.0, 215.0, 5.0, 0.0, 260.0, 325.0, 200.0, 10.0, 325.0, 255.0, 95.0, 0.0, 120.0, 95.0, 85.0, 165.0, 70.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6223946371159891, "mean_inference_ms": 1.454986406350121, "mean_action_processing_ms": 0.24353896275151307, "mean_env_wait_ms": 0.1837413420944873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004781603813171387, "StateBufferConnector_ms": 0.0029969215393066406, "ViewRequirementAgentConnector_ms": 0.09547770023345947}, "num_episodes": 18, "episode_return_max": 82.0, "episode_return_min": -1404.0, "episode_return_mean": -330.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.00004749765797, "num_env_steps_trained_throughput_per_sec": 81.00004749765797, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 142155.364, "restore_workers_time_ms": 0.014, "training_step_time_ms": 142155.311, "sample_time_ms": 1136.484, "learn_time_ms": 140997.193, "learn_throughput": 28.369, "synch_weights_time_ms": 18.238}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-22-26", "timestamp": 1723501346, "time_this_iter_s": 49.42007398605347, "time_total_s": 2781.0828070640564, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8833b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2781.0828070640564, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 27.42142857142857, "ram_util_percent": 79.09}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.068646684683189, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6105166300263987, "policy_loss": -0.013017017365724005, "vf_loss": 2.622111830635676, "vf_explained_var": 0.0024678995369603394, "kl": 0.009478782616899195, "entropy": 1.1181002263669615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.956418775660651, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.826308939444325, "policy_loss": -0.015845397926088443, "vf_loss": 2.840021134368957, "vf_explained_var": -0.02223205254191444, "kl": 0.01066600994641636, "entropy": 1.3844642478952962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 34.0, "episode_reward_min": -1195.0, "episode_reward_mean": -243.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1876.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 76.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -293.415, "predator_policy": 171.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-409.0, -82.0, -153.0, -542.0, -468.0, -121.0, -115.0, -273.0, -739.0, -591.0, -300.0, -619.0, -751.0, -168.0, -236.0, 33.0, -634.0, -274.0, -184.0, -355.0, -207.0, -476.0, -546.0, -15.0, -134.0, -1195.0, -175.0, -15.0, -117.0, -210.0, -160.0, -196.0, -244.0, -375.0, 8.0, -332.0, -157.0, -450.0, -47.0, -124.0, -140.0, -66.0, -118.0, -114.0, -362.0, -225.0, 1.0, -235.0, -55.0, -159.0, -100.0, -361.0, -416.0, -338.0, -130.0, -79.0, -562.0, -352.0, -196.0, -528.0, -336.0, -214.0, -572.0, -220.0, -154.0, -290.0, -334.0, -102.0, -114.0, -163.0, -209.0, -318.0, -435.0, -158.0, 7.0, -81.0, -516.0, -128.0, -84.0, -127.0, -270.0, -192.0, -145.0, -344.0, -25.0, -502.0, -99.0, -104.0, 9.0, -27.0, -241.0, -62.0, -94.0, 34.0, -50.0, -51.0, -115.0, -645.0, -95.0, -54.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-744.0, -500.0, -182.0, 0.0, -143.0, -170.0, -180.0, -1122.0, -441.0, -382.0, -316.0, 0.0, -10.0, -210.0, -327.0, -541.0, -620.0, -864.0, -960.0, -301.0, -23.0, -1647.0, -669.0, -625.0, -1876.0, -610.0, -448.0, 0.0, -110.0, -491.0, 76.0, -203.0, -1720.0, -219.0, -110.0, -549.0, -84.0, -310.0, -200.0, -750.0, -257.0, -190.0, -926.0, -20.0, -1857.0, -604.0, 0.0, -30.0, -120.0, -129.0, -560.0, -1390.0, -80.0, -230.0, 0.0, -30.0, -94.0, -208.0, -120.0, -470.0, -103.0, -197.0, -145.0, -226.0, -369.0, -130.0, -50.0, -730.0, 1.0, -18.0, -210.0, -327.0, -170.0, -192.0, -820.0, -330.0, -190.0, 48.0, -239.0, -30.0, -130.0, -200.0, -136.0, 0.0, 0.0, -933.0, -186.0, -58.0, -582.0, -200.0, -480.0, -210.0, 1.0, 0.0, -330.0, -160.0, -110.0, 0.0, -150.0, -259.0, -180.0, -10.0, -396.0, -660.0, -600.0, -286.0, -207.0, -266.0, -270.0, 0.0, -269.0, -10.0, -520.0, -417.0, -224.0, -458.0, -356.0, -250.0, -430.0, -828.0, -256.0, -380.0, -279.0, -140.0, -490.0, -1167.0, -485.0, -140.0, -470.0, -134.0, -410.0, -180.0, -446.0, -253.0, -72.0, -150.0, -70.0, -334.0, -330.0, -3.0, -229.0, -540.0, -143.0, -570.0, -290.0, -370.0, 0.0, -518.0, 2.0, 0.0, 0.0, -666.0, -320.0, -406.0, -679.0, -29.0, -40.0, -139.0, -88.0, -254.0, -340.0, -180.0, -99.0, -208.0, 0.0, -310.0, -270.0, -209.0, -50.0, 0.0, -770.0, -237.0, -154.0, -50.0, -200.0, -19.0, 3.0, 6.0, 0.0, -57.0, -161.0, -300.0, 13.0, -150.0, -240.0, -19.0, -306.0, 30.0, -30.0, -240.0, -40.0, -76.0, -58.0, -182.0, -400.0, -520.0, -115.0, -85.0, -29.0, -80.0], "policy_predator_policy_reward": [205.0, 630.0, 5.0, 95.0, 65.0, 95.0, 175.0, 585.0, 165.0, 190.0, 165.0, 30.0, 105.0, 0.0, 280.0, 315.0, 625.0, 120.0, 385.0, 285.0, 685.0, 685.0, 395.0, 280.0, 940.0, 795.0, 65.0, 215.0, 135.0, 230.0, 60.0, 100.0, 820.0, 485.0, 245.0, 140.0, 40.0, 170.0, 295.0, 300.0, 135.0, 105.0, 85.0, 385.0, 940.0, 975.0, 0.0, 15.0, 75.0, 40.0, 0.0, 755.0, 115.0, 20.0, 0.0, 15.0, 20.0, 165.0, 155.0, 225.0, 40.0, 100.0, 10.0, 165.0, 205.0, 50.0, 205.0, 200.0, 10.0, 15.0, 0.0, 205.0, 140.0, 65.0, 375.0, 325.0, 95.0, 0.0, 65.0, 80.0, 100.0, 90.0, 0.0, 70.0, 440.0, 375.0, 25.0, 105.0, 365.0, 55.0, 225.0, 240.0, 0.0, 0.0, 80.0, 175.0, 0.0, 55.0, 125.0, 125.0, 60.0, 30.0, 395.0, 300.0, 220.0, 250.0, 0.0, 135.0, 15.0, 125.0, 135.0, 65.0, 80.0, 295.0, 115.0, 215.0, 210.0, 200.0, 345.0, 385.0, 175.0, 125.0, 135.0, 70.0, 585.0, 500.0, 250.0, 155.0, 155.0, 295.0, 95.0, 205.0, 85.0, 280.0, 75.0, 45.0, 130.0, 160.0, 170.0, 0.0, 330.0, 230.0, 105.0, 290.0, 0.0, 225.0, 145.0, 215.0, 5.0, 0.0, 260.0, 325.0, 200.0, 10.0, 325.0, 255.0, 95.0, 0.0, 120.0, 95.0, 85.0, 165.0, 70.0, 45.0, 10.0, 155.0, 5.0, 130.0, 25.0, 0.0, 385.0, 120.0, 105.0, 0.0, 55.0, 60.0, 0.0, 0.0, 30.0, 0.0, 155.0, 65.0, 75.0, 0.0, 110.0, 55.0, 165.0, 145.0, 120.0, 100.0, 5.0, 60.0, 0.0, 125.0, 0.0, 275.0, 40.0, 65.0, 15.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6211562094417203, "mean_inference_ms": 1.4507187116492293, "mean_action_processing_ms": 0.2432527939272659, "mean_env_wait_ms": 0.18328817899921446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004801630973815918, "StateBufferConnector_ms": 0.0030226707458496094, "ViewRequirementAgentConnector_ms": 0.09538483619689941}, "num_episodes": 18, "episode_return_max": 34.0, "episode_return_min": -1195.0, "episode_return_mean": -243.03, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.46992588734962, "num_env_steps_trained_throughput_per_sec": 79.46992588734962, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 51844.179, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51844.13, "sample_time_ms": 1147.807, "learn_time_ms": 50675.698, "learn_throughput": 78.933, "synch_weights_time_ms": 17.826}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-23-17", "timestamp": 1723501397, "time_this_iter_s": 50.375969886779785, "time_total_s": 2831.458776950836, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aadfec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2831.458776950836, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 29.80416666666666, "ram_util_percent": 80.3861111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9815079178444293, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.974291084367762, "policy_loss": -0.014124868162685917, "vf_loss": 2.98725230895653, "vf_explained_var": 0.0008678357121805665, "kl": 0.0077576483106038905, "entropy": 1.0926091310208437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3513112111066383, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.854540611637963, "policy_loss": -0.011515159598704448, "vf_loss": 2.86431571270423, "vf_explained_var": -0.009779857485382645, "kl": 0.008700284014105905, "entropy": 1.401565379251248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 34.0, "episode_reward_min": -1195.0, "episode_reward_mean": -203.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1857.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 48.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -232.305, "predator_policy": 130.475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-546.0, -15.0, -134.0, -1195.0, -175.0, -15.0, -117.0, -210.0, -160.0, -196.0, -244.0, -375.0, 8.0, -332.0, -157.0, -450.0, -47.0, -124.0, -140.0, -66.0, -118.0, -114.0, -362.0, -225.0, 1.0, -235.0, -55.0, -159.0, -100.0, -361.0, -416.0, -338.0, -130.0, -79.0, -562.0, -352.0, -196.0, -528.0, -336.0, -214.0, -572.0, -220.0, -154.0, -290.0, -334.0, -102.0, -114.0, -163.0, -209.0, -318.0, -435.0, -158.0, 7.0, -81.0, -516.0, -128.0, -84.0, -127.0, -270.0, -192.0, -145.0, -344.0, -25.0, -502.0, -99.0, -104.0, 9.0, -27.0, -241.0, -62.0, -94.0, 34.0, -50.0, -51.0, -115.0, -645.0, -95.0, -54.0, -192.0, -158.0, -264.0, -40.0, -56.0, -102.0, -274.0, -57.0, -40.0, -34.0, -217.0, -32.0, -206.0, -130.0, -155.0, -809.0, -130.0, -337.0, -204.0, -61.0, -60.0, -169.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1857.0, -604.0, 0.0, -30.0, -120.0, -129.0, -560.0, -1390.0, -80.0, -230.0, 0.0, -30.0, -94.0, -208.0, -120.0, -470.0, -103.0, -197.0, -145.0, -226.0, -369.0, -130.0, -50.0, -730.0, 1.0, -18.0, -210.0, -327.0, -170.0, -192.0, -820.0, -330.0, -190.0, 48.0, -239.0, -30.0, -130.0, -200.0, -136.0, 0.0, 0.0, -933.0, -186.0, -58.0, -582.0, -200.0, -480.0, -210.0, 1.0, 0.0, -330.0, -160.0, -110.0, 0.0, -150.0, -259.0, -180.0, -10.0, -396.0, -660.0, -600.0, -286.0, -207.0, -266.0, -270.0, 0.0, -269.0, -10.0, -520.0, -417.0, -224.0, -458.0, -356.0, -250.0, -430.0, -828.0, -256.0, -380.0, -279.0, -140.0, -490.0, -1167.0, -485.0, -140.0, -470.0, -134.0, -410.0, -180.0, -446.0, -253.0, -72.0, -150.0, -70.0, -334.0, -330.0, -3.0, -229.0, -540.0, -143.0, -570.0, -290.0, -370.0, 0.0, -518.0, 2.0, 0.0, 0.0, -666.0, -320.0, -406.0, -679.0, -29.0, -40.0, -139.0, -88.0, -254.0, -340.0, -180.0, -99.0, -208.0, 0.0, -310.0, -270.0, -209.0, -50.0, 0.0, -770.0, -237.0, -154.0, -50.0, -200.0, -19.0, 3.0, 6.0, 0.0, -57.0, -161.0, -300.0, 13.0, -150.0, -240.0, -19.0, -306.0, 30.0, -30.0, -240.0, -40.0, -76.0, -58.0, -182.0, -400.0, -520.0, -115.0, -85.0, -29.0, -80.0, -117.0, -160.0, -134.0, -164.0, -350.0, -159.0, -10.0, -110.0, -90.0, -51.0, -217.0, 0.0, -174.0, -250.0, -100.0, -147.0, -80.0, -40.0, -87.0, 3.0, -833.0, -44.0, 8.0, -140.0, -381.0, -150.0, -90.0, -100.0, -140.0, -140.0, -434.0, -800.0, -184.0, -56.0, -207.0, -480.0, -410.0, -109.0, 0.0, -131.0, -76.0, -59.0, 21.0, -380.0], "policy_predator_policy_reward": [940.0, 975.0, 0.0, 15.0, 75.0, 40.0, 0.0, 755.0, 115.0, 20.0, 0.0, 15.0, 20.0, 165.0, 155.0, 225.0, 40.0, 100.0, 10.0, 165.0, 205.0, 50.0, 205.0, 200.0, 10.0, 15.0, 0.0, 205.0, 140.0, 65.0, 375.0, 325.0, 95.0, 0.0, 65.0, 80.0, 100.0, 90.0, 0.0, 70.0, 440.0, 375.0, 25.0, 105.0, 365.0, 55.0, 225.0, 240.0, 0.0, 0.0, 80.0, 175.0, 0.0, 55.0, 125.0, 125.0, 60.0, 30.0, 395.0, 300.0, 220.0, 250.0, 0.0, 135.0, 15.0, 125.0, 135.0, 65.0, 80.0, 295.0, 115.0, 215.0, 210.0, 200.0, 345.0, 385.0, 175.0, 125.0, 135.0, 70.0, 585.0, 500.0, 250.0, 155.0, 155.0, 295.0, 95.0, 205.0, 85.0, 280.0, 75.0, 45.0, 130.0, 160.0, 170.0, 0.0, 330.0, 230.0, 105.0, 290.0, 0.0, 225.0, 145.0, 215.0, 5.0, 0.0, 260.0, 325.0, 200.0, 10.0, 325.0, 255.0, 95.0, 0.0, 120.0, 95.0, 85.0, 165.0, 70.0, 45.0, 10.0, 155.0, 5.0, 130.0, 25.0, 0.0, 385.0, 120.0, 105.0, 0.0, 55.0, 60.0, 0.0, 0.0, 30.0, 0.0, 155.0, 65.0, 75.0, 0.0, 110.0, 55.0, 165.0, 145.0, 120.0, 100.0, 5.0, 60.0, 0.0, 125.0, 0.0, 275.0, 40.0, 65.0, 15.0, 40.0, 0.0, 85.0, 55.0, 85.0, 75.0, 170.0, 35.0, 45.0, 50.0, 35.0, 105.0, 10.0, 75.0, 75.0, 95.0, 95.0, 40.0, 40.0, 50.0, 0.0, 345.0, 315.0, 65.0, 35.0, 165.0, 160.0, 50.0, 10.0, 65.0, 60.0, 20.0, 405.0, 70.0, 40.0, 340.0, 10.0, 155.0, 160.0, 70.0, 0.0, 10.0, 65.0, 190.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6210314459753387, "mean_inference_ms": 1.4479362907134468, "mean_action_processing_ms": 0.2433341462789019, "mean_env_wait_ms": 0.1829331305900131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004819273948669434, "StateBufferConnector_ms": 0.002997756004333496, "ViewRequirementAgentConnector_ms": 0.0949258804321289}, "num_episodes": 22, "episode_return_max": 34.0, "episode_return_min": -1195.0, "episode_return_mean": -203.66, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.28611830724606, "num_env_steps_trained_throughput_per_sec": 81.28611830724606, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 51710.874, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51710.826, "sample_time_ms": 1133.966, "learn_time_ms": 50556.508, "learn_throughput": 79.119, "synch_weights_time_ms": 17.716}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-24-06", "timestamp": 1723501446, "time_this_iter_s": 49.24808406829834, "time_total_s": 2880.7068610191345, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88bd0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2880.7068610191345, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 26.555714285714284, "ram_util_percent": 82.0942857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9325714516576635, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7889053694470218, "policy_loss": -0.010340839593360822, "vf_loss": 1.7982791257598412, "vf_explained_var": 0.0008912603375772951, "kl": 0.006447240380674052, "entropy": 1.102256995723361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2366746374223596, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2097003534357382, "policy_loss": -0.010619457819370957, "vf_loss": 2.218948212691716, "vf_explained_var": -0.001946255990437099, "kl": 0.006857982029394301, "entropy": 1.4168065635615557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 34.0, "episode_reward_min": -1664.0, "episode_reward_mean": -228.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1460.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 30.0, "predator_policy": 720.0}, "policy_reward_mean": {"prey_policy": -235.53, "predator_policy": 121.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-225.0, 1.0, -235.0, -55.0, -159.0, -100.0, -361.0, -416.0, -338.0, -130.0, -79.0, -562.0, -352.0, -196.0, -528.0, -336.0, -214.0, -572.0, -220.0, -154.0, -290.0, -334.0, -102.0, -114.0, -163.0, -209.0, -318.0, -435.0, -158.0, 7.0, -81.0, -516.0, -128.0, -84.0, -127.0, -270.0, -192.0, -145.0, -344.0, -25.0, -502.0, -99.0, -104.0, 9.0, -27.0, -241.0, -62.0, -94.0, 34.0, -50.0, -51.0, -115.0, -645.0, -95.0, -54.0, -192.0, -158.0, -264.0, -40.0, -56.0, -102.0, -274.0, -57.0, -40.0, -34.0, -217.0, -32.0, -206.0, -130.0, -155.0, -809.0, -130.0, -337.0, -204.0, -61.0, -60.0, -169.0, -2.0, -103.0, -844.0, -42.0, -85.0, -1154.0, -97.0, -25.0, -55.0, -1598.0, 0.0, -1008.0, -79.0, -335.0, -1664.0, -4.0, -40.0, -24.0, -68.0, -45.0, -382.0, 10.0, -140.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-480.0, -210.0, 1.0, 0.0, -330.0, -160.0, -110.0, 0.0, -150.0, -259.0, -180.0, -10.0, -396.0, -660.0, -600.0, -286.0, -207.0, -266.0, -270.0, 0.0, -269.0, -10.0, -520.0, -417.0, -224.0, -458.0, -356.0, -250.0, -430.0, -828.0, -256.0, -380.0, -279.0, -140.0, -490.0, -1167.0, -485.0, -140.0, -470.0, -134.0, -410.0, -180.0, -446.0, -253.0, -72.0, -150.0, -70.0, -334.0, -330.0, -3.0, -229.0, -540.0, -143.0, -570.0, -290.0, -370.0, 0.0, -518.0, 2.0, 0.0, 0.0, -666.0, -320.0, -406.0, -679.0, -29.0, -40.0, -139.0, -88.0, -254.0, -340.0, -180.0, -99.0, -208.0, 0.0, -310.0, -270.0, -209.0, -50.0, 0.0, -770.0, -237.0, -154.0, -50.0, -200.0, -19.0, 3.0, 6.0, 0.0, -57.0, -161.0, -300.0, 13.0, -150.0, -240.0, -19.0, -306.0, 30.0, -30.0, -240.0, -40.0, -76.0, -58.0, -182.0, -400.0, -520.0, -115.0, -85.0, -29.0, -80.0, -117.0, -160.0, -134.0, -164.0, -350.0, -159.0, -10.0, -110.0, -90.0, -51.0, -217.0, 0.0, -174.0, -250.0, -100.0, -147.0, -80.0, -40.0, -87.0, 3.0, -833.0, -44.0, 8.0, -140.0, -381.0, -150.0, -90.0, -100.0, -140.0, -140.0, -434.0, -800.0, -184.0, -56.0, -207.0, -480.0, -410.0, -109.0, 0.0, -131.0, -76.0, -59.0, 21.0, -380.0, 8.0, -40.0, -50.0, -108.0, -522.0, -742.0, -248.0, -9.0, -160.0, -60.0, -900.0, -1054.0, -50.0, -167.0, 0.0, -210.0, 0.0, -110.0, -1128.0, -1100.0, 0.0, 0.0, -940.0, -768.0, -30.0, -129.0, -300.0, -440.0, -1214.0, -1460.0, 0.0, -19.0, 0.0, -85.0, -50.0, -4.0, -98.0, -50.0, -90.0, 0.0, -304.0, -518.0, 0.0, 10.0, -24.0, -256.0], "policy_predator_policy_reward": [225.0, 240.0, 0.0, 0.0, 80.0, 175.0, 0.0, 55.0, 125.0, 125.0, 60.0, 30.0, 395.0, 300.0, 220.0, 250.0, 0.0, 135.0, 15.0, 125.0, 135.0, 65.0, 80.0, 295.0, 115.0, 215.0, 210.0, 200.0, 345.0, 385.0, 175.0, 125.0, 135.0, 70.0, 585.0, 500.0, 250.0, 155.0, 155.0, 295.0, 95.0, 205.0, 85.0, 280.0, 75.0, 45.0, 130.0, 160.0, 170.0, 0.0, 330.0, 230.0, 105.0, 290.0, 0.0, 225.0, 145.0, 215.0, 5.0, 0.0, 260.0, 325.0, 200.0, 10.0, 325.0, 255.0, 95.0, 0.0, 120.0, 95.0, 85.0, 165.0, 70.0, 45.0, 10.0, 155.0, 5.0, 130.0, 25.0, 0.0, 385.0, 120.0, 105.0, 0.0, 55.0, 60.0, 0.0, 0.0, 30.0, 0.0, 155.0, 65.0, 75.0, 0.0, 110.0, 55.0, 165.0, 145.0, 120.0, 100.0, 5.0, 60.0, 0.0, 125.0, 0.0, 275.0, 40.0, 65.0, 15.0, 40.0, 0.0, 85.0, 55.0, 85.0, 75.0, 170.0, 35.0, 45.0, 50.0, 35.0, 105.0, 10.0, 75.0, 75.0, 95.0, 95.0, 40.0, 40.0, 50.0, 0.0, 345.0, 315.0, 65.0, 35.0, 165.0, 160.0, 50.0, 10.0, 65.0, 60.0, 20.0, 405.0, 70.0, 40.0, 340.0, 10.0, 155.0, 160.0, 70.0, 0.0, 10.0, 65.0, 190.0, 0.0, 0.0, 30.0, 0.0, 55.0, 345.0, 75.0, 90.0, 125.0, 80.0, 55.0, 680.0, 120.0, 75.0, 45.0, 105.0, 80.0, 10.0, 45.0, 45.0, 585.0, 0.0, 0.0, 640.0, 60.0, 20.0, 60.0, 370.0, 35.0, 290.0, 720.0, 0.0, 15.0, 45.0, 0.0, 25.0, 5.0, 0.0, 80.0, 0.0, 45.0, 180.0, 260.0, 0.0, 0.0, 140.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6213497256992736, "mean_inference_ms": 1.4452914350067658, "mean_action_processing_ms": 0.2431060975775551, "mean_env_wait_ms": 0.1827127911317168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047386884689331055, "StateBufferConnector_ms": 0.0029811859130859375, "ViewRequirementAgentConnector_ms": 0.0949106216430664}, "num_episodes": 23, "episode_return_max": 34.0, "episode_return_min": -1664.0, "episode_return_mean": -228.66, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.6127995397325, "num_env_steps_trained_throughput_per_sec": 81.6127995397325, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 51588.832, "restore_workers_time_ms": 0.013, "training_step_time_ms": 51588.781, "sample_time_ms": 1122.745, "learn_time_ms": 50447.015, "learn_throughput": 79.291, "synch_weights_time_ms": 16.385}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-24-55", "timestamp": 1723501495, "time_this_iter_s": 49.06892800331116, "time_total_s": 2929.7757890224457, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88bc0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2929.7757890224457, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 23.853623188405802, "ram_util_percent": 81.65217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0412317360519734, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9781986794143758, "policy_loss": -0.008532396713197823, "vf_loss": 2.9857556248468065, "vf_explained_var": 0.0008869641987735001, "kl": 0.006503017861221756, "entropy": 1.0951471727361124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9631594728540491, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.928001392455328, "policy_loss": -0.010788360051194787, "vf_loss": 3.937234269374262, "vf_explained_var": -0.0011276773044041225, "kl": 0.007777442757372338, "entropy": 1.3955848953711292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 34.0, "episode_reward_min": -2535.0, "episode_reward_mean": -278.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 30.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -254.94, "predator_policy": 115.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-220.0, -154.0, -290.0, -334.0, -102.0, -114.0, -163.0, -209.0, -318.0, -435.0, -158.0, 7.0, -81.0, -516.0, -128.0, -84.0, -127.0, -270.0, -192.0, -145.0, -344.0, -25.0, -502.0, -99.0, -104.0, 9.0, -27.0, -241.0, -62.0, -94.0, 34.0, -50.0, -51.0, -115.0, -645.0, -95.0, -54.0, -192.0, -158.0, -264.0, -40.0, -56.0, -102.0, -274.0, -57.0, -40.0, -34.0, -217.0, -32.0, -206.0, -130.0, -155.0, -809.0, -130.0, -337.0, -204.0, -61.0, -60.0, -169.0, -2.0, -103.0, -844.0, -42.0, -85.0, -1154.0, -97.0, -25.0, -55.0, -1598.0, 0.0, -1008.0, -79.0, -335.0, -1664.0, -4.0, -40.0, -24.0, -68.0, -45.0, -382.0, 10.0, -140.0, -120.0, -1130.0, -49.0, -2535.0, -107.0, -50.0, -29.0, -45.0, -285.0, -190.0, 0.0, -50.0, 0.0, -96.0, -1547.0, -1520.0, 19.0, -2075.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-485.0, -140.0, -470.0, -134.0, -410.0, -180.0, -446.0, -253.0, -72.0, -150.0, -70.0, -334.0, -330.0, -3.0, -229.0, -540.0, -143.0, -570.0, -290.0, -370.0, 0.0, -518.0, 2.0, 0.0, 0.0, -666.0, -320.0, -406.0, -679.0, -29.0, -40.0, -139.0, -88.0, -254.0, -340.0, -180.0, -99.0, -208.0, 0.0, -310.0, -270.0, -209.0, -50.0, 0.0, -770.0, -237.0, -154.0, -50.0, -200.0, -19.0, 3.0, 6.0, 0.0, -57.0, -161.0, -300.0, 13.0, -150.0, -240.0, -19.0, -306.0, 30.0, -30.0, -240.0, -40.0, -76.0, -58.0, -182.0, -400.0, -520.0, -115.0, -85.0, -29.0, -80.0, -117.0, -160.0, -134.0, -164.0, -350.0, -159.0, -10.0, -110.0, -90.0, -51.0, -217.0, 0.0, -174.0, -250.0, -100.0, -147.0, -80.0, -40.0, -87.0, 3.0, -833.0, -44.0, 8.0, -140.0, -381.0, -150.0, -90.0, -100.0, -140.0, -140.0, -434.0, -800.0, -184.0, -56.0, -207.0, -480.0, -410.0, -109.0, 0.0, -131.0, -76.0, -59.0, 21.0, -380.0, 8.0, -40.0, -50.0, -108.0, -522.0, -742.0, -248.0, -9.0, -160.0, -60.0, -900.0, -1054.0, -50.0, -167.0, 0.0, -210.0, 0.0, -110.0, -1128.0, -1100.0, 0.0, 0.0, -940.0, -768.0, -30.0, -129.0, -300.0, -440.0, -1214.0, -1460.0, 0.0, -19.0, 0.0, -85.0, -50.0, -4.0, -98.0, -50.0, -90.0, 0.0, -304.0, -518.0, 0.0, 10.0, -24.0, -256.0, 0.0, -300.0, -800.0, -875.0, -20.0, -79.0, -1695.0, -1940.0, -22.0, -210.0, -114.0, 4.0, 1.0, -70.0, -10.0, -110.0, -350.0, -110.0, -10.0, -370.0, 0.0, 0.0, -40.0, -30.0, 0.0, 0.0, -73.0, -138.0, -1080.0, -1167.0, -1240.0, -1120.0, 10.0, 9.0, -1510.0, -1470.0], "policy_predator_policy_reward": [250.0, 155.0, 155.0, 295.0, 95.0, 205.0, 85.0, 280.0, 75.0, 45.0, 130.0, 160.0, 170.0, 0.0, 330.0, 230.0, 105.0, 290.0, 0.0, 225.0, 145.0, 215.0, 5.0, 0.0, 260.0, 325.0, 200.0, 10.0, 325.0, 255.0, 95.0, 0.0, 120.0, 95.0, 85.0, 165.0, 70.0, 45.0, 10.0, 155.0, 5.0, 130.0, 25.0, 0.0, 385.0, 120.0, 105.0, 0.0, 55.0, 60.0, 0.0, 0.0, 30.0, 0.0, 155.0, 65.0, 75.0, 0.0, 110.0, 55.0, 165.0, 145.0, 120.0, 100.0, 5.0, 60.0, 0.0, 125.0, 0.0, 275.0, 40.0, 65.0, 15.0, 40.0, 0.0, 85.0, 55.0, 85.0, 75.0, 170.0, 35.0, 45.0, 50.0, 35.0, 105.0, 10.0, 75.0, 75.0, 95.0, 95.0, 40.0, 40.0, 50.0, 0.0, 345.0, 315.0, 65.0, 35.0, 165.0, 160.0, 50.0, 10.0, 65.0, 60.0, 20.0, 405.0, 70.0, 40.0, 340.0, 10.0, 155.0, 160.0, 70.0, 0.0, 10.0, 65.0, 190.0, 0.0, 0.0, 30.0, 0.0, 55.0, 345.0, 75.0, 90.0, 125.0, 80.0, 55.0, 680.0, 120.0, 75.0, 45.0, 105.0, 80.0, 10.0, 45.0, 45.0, 585.0, 0.0, 0.0, 640.0, 60.0, 20.0, 60.0, 370.0, 35.0, 290.0, 720.0, 0.0, 15.0, 45.0, 0.0, 25.0, 5.0, 0.0, 80.0, 0.0, 45.0, 180.0, 260.0, 0.0, 0.0, 140.0, 0.0, 150.0, 30.0, 430.0, 115.0, 50.0, 0.0, 990.0, 110.0, 15.0, 110.0, 0.0, 60.0, 35.0, 5.0, 20.0, 55.0, 175.0, 0.0, 145.0, 45.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 50.0, 65.0, 575.0, 125.0, 740.0, 100.0, 0.0, 0.0, 85.0, 820.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6213986449892842, "mean_inference_ms": 1.4446678778634146, "mean_action_processing_ms": 0.2433607520632823, "mean_env_wait_ms": 0.1826703456300075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004975676536560059, "StateBufferConnector_ms": 0.0030678510665893555, "ViewRequirementAgentConnector_ms": 0.09645247459411621}, "num_episodes": 18, "episode_return_max": 34.0, "episode_return_min": -2535.0, "episode_return_mean": -278.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.33915029913031, "num_env_steps_trained_throughput_per_sec": 80.33915029913031, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 51627.724, "restore_workers_time_ms": 0.013, "training_step_time_ms": 51627.668, "sample_time_ms": 1122.276, "learn_time_ms": 50488.143, "learn_throughput": 79.227, "synch_weights_time_ms": 14.824}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-25-45", "timestamp": 1723501545, "time_this_iter_s": 49.828869104385376, "time_total_s": 2979.604658126831, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aadfee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2979.604658126831, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 27.666197183098593, "ram_util_percent": 82.73943661971832}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9941162680822706, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5583360632891377, "policy_loss": -0.009053164388412836, "vf_loss": 3.566253006142914, "vf_explained_var": 0.0008148713086647962, "kl": 0.007574847513701772, "entropy": 1.1101717834119444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1526900742104447, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.022756227235946, "policy_loss": -0.012804430887526858, "vf_loss": 5.033625047799771, "vf_explained_var": -0.0029756974921655403, "kl": 0.009678013926715478, "entropy": 1.4050603781427655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 34.0, "episode_reward_min": -2535.0, "episode_reward_mean": -335.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 30.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -287.08, "predator_policy": 119.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.0, -145.0, -344.0, -25.0, -502.0, -99.0, -104.0, 9.0, -27.0, -241.0, -62.0, -94.0, 34.0, -50.0, -51.0, -115.0, -645.0, -95.0, -54.0, -192.0, -158.0, -264.0, -40.0, -56.0, -102.0, -274.0, -57.0, -40.0, -34.0, -217.0, -32.0, -206.0, -130.0, -155.0, -809.0, -130.0, -337.0, -204.0, -61.0, -60.0, -169.0, -2.0, -103.0, -844.0, -42.0, -85.0, -1154.0, -97.0, -25.0, -55.0, -1598.0, 0.0, -1008.0, -79.0, -335.0, -1664.0, -4.0, -40.0, -24.0, -68.0, -45.0, -382.0, 10.0, -140.0, -120.0, -1130.0, -49.0, -2535.0, -107.0, -50.0, -29.0, -45.0, -285.0, -190.0, 0.0, -50.0, 0.0, -96.0, -1547.0, -1520.0, 19.0, -2075.0, -125.0, -150.0, -864.0, -1128.0, -52.0, -851.0, -1025.0, -814.0, -5.0, -420.0, -391.0, -284.0, -196.0, -225.0, -918.0, -83.0, -148.0, -1760.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-99.0, -208.0, 0.0, -310.0, -270.0, -209.0, -50.0, 0.0, -770.0, -237.0, -154.0, -50.0, -200.0, -19.0, 3.0, 6.0, 0.0, -57.0, -161.0, -300.0, 13.0, -150.0, -240.0, -19.0, -306.0, 30.0, -30.0, -240.0, -40.0, -76.0, -58.0, -182.0, -400.0, -520.0, -115.0, -85.0, -29.0, -80.0, -117.0, -160.0, -134.0, -164.0, -350.0, -159.0, -10.0, -110.0, -90.0, -51.0, -217.0, 0.0, -174.0, -250.0, -100.0, -147.0, -80.0, -40.0, -87.0, 3.0, -833.0, -44.0, 8.0, -140.0, -381.0, -150.0, -90.0, -100.0, -140.0, -140.0, -434.0, -800.0, -184.0, -56.0, -207.0, -480.0, -410.0, -109.0, 0.0, -131.0, -76.0, -59.0, 21.0, -380.0, 8.0, -40.0, -50.0, -108.0, -522.0, -742.0, -248.0, -9.0, -160.0, -60.0, -900.0, -1054.0, -50.0, -167.0, 0.0, -210.0, 0.0, -110.0, -1128.0, -1100.0, 0.0, 0.0, -940.0, -768.0, -30.0, -129.0, -300.0, -440.0, -1214.0, -1460.0, 0.0, -19.0, 0.0, -85.0, -50.0, -4.0, -98.0, -50.0, -90.0, 0.0, -304.0, -518.0, 0.0, 10.0, -24.0, -256.0, 0.0, -300.0, -800.0, -875.0, -20.0, -79.0, -1695.0, -1940.0, -22.0, -210.0, -114.0, 4.0, 1.0, -70.0, -10.0, -110.0, -350.0, -110.0, -10.0, -370.0, 0.0, 0.0, -40.0, -30.0, 0.0, 0.0, -73.0, -138.0, -1080.0, -1167.0, -1240.0, -1120.0, 10.0, 9.0, -1510.0, -1470.0, -10.0, -240.0, -160.0, -80.0, -600.0, -929.0, -793.0, -980.0, 0.0, -132.0, -405.0, -1131.0, -700.0, -880.0, -659.0, -680.0, -10.0, 0.0, -404.0, -346.0, -270.0, -271.0, -129.0, -450.0, -401.0, 0.0, 0.0, -450.0, -903.0, -560.0, -140.0, -28.0, -60.0, -218.0, -885.0, -1800.0], "policy_predator_policy_reward": [70.0, 45.0, 10.0, 155.0, 5.0, 130.0, 25.0, 0.0, 385.0, 120.0, 105.0, 0.0, 55.0, 60.0, 0.0, 0.0, 30.0, 0.0, 155.0, 65.0, 75.0, 0.0, 110.0, 55.0, 165.0, 145.0, 120.0, 100.0, 5.0, 60.0, 0.0, 125.0, 0.0, 275.0, 40.0, 65.0, 15.0, 40.0, 0.0, 85.0, 55.0, 85.0, 75.0, 170.0, 35.0, 45.0, 50.0, 35.0, 105.0, 10.0, 75.0, 75.0, 95.0, 95.0, 40.0, 40.0, 50.0, 0.0, 345.0, 315.0, 65.0, 35.0, 165.0, 160.0, 50.0, 10.0, 65.0, 60.0, 20.0, 405.0, 70.0, 40.0, 340.0, 10.0, 155.0, 160.0, 70.0, 0.0, 10.0, 65.0, 190.0, 0.0, 0.0, 30.0, 0.0, 55.0, 345.0, 75.0, 90.0, 125.0, 80.0, 55.0, 680.0, 120.0, 75.0, 45.0, 105.0, 80.0, 10.0, 45.0, 45.0, 585.0, 0.0, 0.0, 640.0, 60.0, 20.0, 60.0, 370.0, 35.0, 290.0, 720.0, 0.0, 15.0, 45.0, 0.0, 25.0, 5.0, 0.0, 80.0, 0.0, 45.0, 180.0, 260.0, 0.0, 0.0, 140.0, 0.0, 150.0, 30.0, 430.0, 115.0, 50.0, 0.0, 990.0, 110.0, 15.0, 110.0, 0.0, 60.0, 35.0, 5.0, 20.0, 55.0, 175.0, 0.0, 145.0, 45.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 50.0, 65.0, 575.0, 125.0, 740.0, 100.0, 0.0, 0.0, 85.0, 820.0, 25.0, 100.0, 50.0, 40.0, 75.0, 590.0, 645.0, 0.0, 70.0, 10.0, 90.0, 595.0, 525.0, 30.0, 115.0, 410.0, 0.0, 5.0, 290.0, 40.0, 0.0, 150.0, 65.0, 230.0, 65.0, 140.0, 225.0, 0.0, 430.0, 115.0, 20.0, 65.0, 130.0, 0.0, 0.0, 925.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6217237618491305, "mean_inference_ms": 1.443528303831057, "mean_action_processing_ms": 0.2433585784750001, "mean_env_wait_ms": 0.18263940871477508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036029815673828125, "StateBufferConnector_ms": 0.0030753612518310547, "ViewRequirementAgentConnector_ms": 0.09432625770568848}, "num_episodes": 18, "episode_return_max": 34.0, "episode_return_min": -2535.0, "episode_return_mean": -335.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.21972963841763, "num_env_steps_trained_throughput_per_sec": 83.21972963841763, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 51567.975, "restore_workers_time_ms": 0.013, "training_step_time_ms": 51567.92, "sample_time_ms": 1126.847, "learn_time_ms": 50424.208, "learn_throughput": 79.327, "synch_weights_time_ms": 14.653}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-26-33", "timestamp": 1723501593, "time_this_iter_s": 48.10883188247681, "time_total_s": 3027.713490009308, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88bc9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3027.713490009308, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 22.772463768115944, "ram_util_percent": 81.65362318840579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.06457822357536, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.030530293530258, "policy_loss": -0.010148322732537669, "vf_loss": 5.038996502457472, "vf_explained_var": -0.00023698027802522852, "kl": 0.011214160825684737, "entropy": 1.0891267551000787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8803786880124815, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.069937575557245, "policy_loss": -0.008950809932377918, "vf_loss": 6.077396978903069, "vf_explained_var": -0.0021833492019189098, "kl": 0.0074570136884550275, "entropy": 1.4061084389686584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -2535.0, "episode_reward_mean": -376.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -323.735, "predator_policy": 135.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.0, -192.0, -158.0, -264.0, -40.0, -56.0, -102.0, -274.0, -57.0, -40.0, -34.0, -217.0, -32.0, -206.0, -130.0, -155.0, -809.0, -130.0, -337.0, -204.0, -61.0, -60.0, -169.0, -2.0, -103.0, -844.0, -42.0, -85.0, -1154.0, -97.0, -25.0, -55.0, -1598.0, 0.0, -1008.0, -79.0, -335.0, -1664.0, -4.0, -40.0, -24.0, -68.0, -45.0, -382.0, 10.0, -140.0, -120.0, -1130.0, -49.0, -2535.0, -107.0, -50.0, -29.0, -45.0, -285.0, -190.0, 0.0, -50.0, 0.0, -96.0, -1547.0, -1520.0, 19.0, -2075.0, -125.0, -150.0, -864.0, -1128.0, -52.0, -851.0, -1025.0, -814.0, -5.0, -420.0, -391.0, -284.0, -196.0, -225.0, -918.0, -83.0, -148.0, -1760.0, -90.0, -476.0, -300.0, -1372.0, 24.0, -110.0, 2.0, -22.0, -925.0, -43.0, -615.0, -505.0, -79.0, -850.0, -1195.0, -158.0, 15.0, -165.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.0, -80.0, -117.0, -160.0, -134.0, -164.0, -350.0, -159.0, -10.0, -110.0, -90.0, -51.0, -217.0, 0.0, -174.0, -250.0, -100.0, -147.0, -80.0, -40.0, -87.0, 3.0, -833.0, -44.0, 8.0, -140.0, -381.0, -150.0, -90.0, -100.0, -140.0, -140.0, -434.0, -800.0, -184.0, -56.0, -207.0, -480.0, -410.0, -109.0, 0.0, -131.0, -76.0, -59.0, 21.0, -380.0, 8.0, -40.0, -50.0, -108.0, -522.0, -742.0, -248.0, -9.0, -160.0, -60.0, -900.0, -1054.0, -50.0, -167.0, 0.0, -210.0, 0.0, -110.0, -1128.0, -1100.0, 0.0, 0.0, -940.0, -768.0, -30.0, -129.0, -300.0, -440.0, -1214.0, -1460.0, 0.0, -19.0, 0.0, -85.0, -50.0, -4.0, -98.0, -50.0, -90.0, 0.0, -304.0, -518.0, 0.0, 10.0, -24.0, -256.0, 0.0, -300.0, -800.0, -875.0, -20.0, -79.0, -1695.0, -1940.0, -22.0, -210.0, -114.0, 4.0, 1.0, -70.0, -10.0, -110.0, -350.0, -110.0, -10.0, -370.0, 0.0, 0.0, -40.0, -30.0, 0.0, 0.0, -73.0, -138.0, -1080.0, -1167.0, -1240.0, -1120.0, 10.0, 9.0, -1510.0, -1470.0, -10.0, -240.0, -160.0, -80.0, -600.0, -929.0, -793.0, -980.0, 0.0, -132.0, -405.0, -1131.0, -700.0, -880.0, -659.0, -680.0, -10.0, 0.0, -404.0, -346.0, -270.0, -271.0, -129.0, -450.0, -401.0, 0.0, 0.0, -450.0, -903.0, -560.0, -140.0, -28.0, -60.0, -218.0, -885.0, -1800.0, -140.0, -50.0, -806.0, -170.0, -200.0, -400.0, -747.0, -1415.0, 14.0, 10.0, -220.0, 0.0, -3.0, 0.0, -8.0, -49.0, -1280.0, -480.0, -98.0, 0.0, -720.0, -380.0, -650.0, -350.0, -237.0, -167.0, -660.0, -930.0, -1340.0, -690.0, -303.0, -30.0, 14.0, 1.0, -260.0, -90.0], "policy_predator_policy_reward": [15.0, 40.0, 0.0, 85.0, 55.0, 85.0, 75.0, 170.0, 35.0, 45.0, 50.0, 35.0, 105.0, 10.0, 75.0, 75.0, 95.0, 95.0, 40.0, 40.0, 50.0, 0.0, 345.0, 315.0, 65.0, 35.0, 165.0, 160.0, 50.0, 10.0, 65.0, 60.0, 20.0, 405.0, 70.0, 40.0, 340.0, 10.0, 155.0, 160.0, 70.0, 0.0, 10.0, 65.0, 190.0, 0.0, 0.0, 30.0, 0.0, 55.0, 345.0, 75.0, 90.0, 125.0, 80.0, 55.0, 680.0, 120.0, 75.0, 45.0, 105.0, 80.0, 10.0, 45.0, 45.0, 585.0, 0.0, 0.0, 640.0, 60.0, 20.0, 60.0, 370.0, 35.0, 290.0, 720.0, 0.0, 15.0, 45.0, 0.0, 25.0, 5.0, 0.0, 80.0, 0.0, 45.0, 180.0, 260.0, 0.0, 0.0, 140.0, 0.0, 150.0, 30.0, 430.0, 115.0, 50.0, 0.0, 990.0, 110.0, 15.0, 110.0, 0.0, 60.0, 35.0, 5.0, 20.0, 55.0, 175.0, 0.0, 145.0, 45.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 50.0, 65.0, 575.0, 125.0, 740.0, 100.0, 0.0, 0.0, 85.0, 820.0, 25.0, 100.0, 50.0, 40.0, 75.0, 590.0, 645.0, 0.0, 70.0, 10.0, 90.0, 595.0, 525.0, 30.0, 115.0, 410.0, 0.0, 5.0, 290.0, 40.0, 0.0, 150.0, 65.0, 230.0, 65.0, 140.0, 225.0, 0.0, 430.0, 115.0, 20.0, 65.0, 130.0, 0.0, 0.0, 925.0, 75.0, 25.0, 345.0, 155.0, 195.0, 105.0, 320.0, 470.0, 0.0, 0.0, 110.0, 0.0, 5.0, 0.0, 25.0, 10.0, 380.0, 455.0, 55.0, 0.0, 30.0, 455.0, 495.0, 0.0, 165.0, 160.0, 500.0, 240.0, 800.0, 35.0, 155.0, 20.0, 0.0, 0.0, 175.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6217853894072383, "mean_inference_ms": 1.441883221795523, "mean_action_processing_ms": 0.24325967680197608, "mean_env_wait_ms": 0.18257483429194704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035904645919799805, "StateBufferConnector_ms": 0.0034782886505126953, "ViewRequirementAgentConnector_ms": 0.09345853328704834}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -2535.0, "episode_return_mean": -376.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.65853992804173, "num_env_steps_trained_throughput_per_sec": 82.65853992804173, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 51610.991, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51610.932, "sample_time_ms": 1119.866, "learn_time_ms": 50474.622, "learn_throughput": 79.248, "synch_weights_time_ms": 14.491}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-27-22", "timestamp": 1723501642, "time_this_iter_s": 48.44763112068176, "time_total_s": 3076.1611211299896, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88ac160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3076.1611211299896, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.146376811594205, "ram_util_percent": 80.5811594202899}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8779846235873208, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.838499106427349, "policy_loss": -0.008455328142920894, "vf_loss": 4.845800112794946, "vf_explained_var": 0.0005862432497519034, "kl": 0.007695452357233806, "entropy": 1.0578815632396275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.545152336327487, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.080414538156418, "policy_loss": -0.009026979409631283, "vf_loss": 6.08795535980709, "vf_explained_var": -0.0009706989482597068, "kl": 0.007430709675925462, "entropy": 1.3813564412808292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -2535.0, "episode_reward_mean": -455.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -388.575, "predator_policy": 161.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.0, -2.0, -103.0, -844.0, -42.0, -85.0, -1154.0, -97.0, -25.0, -55.0, -1598.0, 0.0, -1008.0, -79.0, -335.0, -1664.0, -4.0, -40.0, -24.0, -68.0, -45.0, -382.0, 10.0, -140.0, -120.0, -1130.0, -49.0, -2535.0, -107.0, -50.0, -29.0, -45.0, -285.0, -190.0, 0.0, -50.0, 0.0, -96.0, -1547.0, -1520.0, 19.0, -2075.0, -125.0, -150.0, -864.0, -1128.0, -52.0, -851.0, -1025.0, -814.0, -5.0, -420.0, -391.0, -284.0, -196.0, -225.0, -918.0, -83.0, -148.0, -1760.0, -90.0, -476.0, -300.0, -1372.0, 24.0, -110.0, 2.0, -22.0, -925.0, -43.0, -615.0, -505.0, -79.0, -850.0, -1195.0, -158.0, 15.0, -165.0, -700.0, -960.0, -859.0, -430.0, -948.0, 14.0, -261.0, -889.0, -669.0, -624.0, -457.0, -277.0, -465.0, -418.0, -1314.0, -1.0, -699.0, 22.0, -180.0, -290.0, -770.0, -260.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [21.0, -380.0, 8.0, -40.0, -50.0, -108.0, -522.0, -742.0, -248.0, -9.0, -160.0, -60.0, -900.0, -1054.0, -50.0, -167.0, 0.0, -210.0, 0.0, -110.0, -1128.0, -1100.0, 0.0, 0.0, -940.0, -768.0, -30.0, -129.0, -300.0, -440.0, -1214.0, -1460.0, 0.0, -19.0, 0.0, -85.0, -50.0, -4.0, -98.0, -50.0, -90.0, 0.0, -304.0, -518.0, 0.0, 10.0, -24.0, -256.0, 0.0, -300.0, -800.0, -875.0, -20.0, -79.0, -1695.0, -1940.0, -22.0, -210.0, -114.0, 4.0, 1.0, -70.0, -10.0, -110.0, -350.0, -110.0, -10.0, -370.0, 0.0, 0.0, -40.0, -30.0, 0.0, 0.0, -73.0, -138.0, -1080.0, -1167.0, -1240.0, -1120.0, 10.0, 9.0, -1510.0, -1470.0, -10.0, -240.0, -160.0, -80.0, -600.0, -929.0, -793.0, -980.0, 0.0, -132.0, -405.0, -1131.0, -700.0, -880.0, -659.0, -680.0, -10.0, 0.0, -404.0, -346.0, -270.0, -271.0, -129.0, -450.0, -401.0, 0.0, 0.0, -450.0, -903.0, -560.0, -140.0, -28.0, -60.0, -218.0, -885.0, -1800.0, -140.0, -50.0, -806.0, -170.0, -200.0, -400.0, -747.0, -1415.0, 14.0, 10.0, -220.0, 0.0, -3.0, 0.0, -8.0, -49.0, -1280.0, -480.0, -98.0, 0.0, -720.0, -380.0, -650.0, -350.0, -237.0, -167.0, -660.0, -930.0, -1340.0, -690.0, -303.0, -30.0, 14.0, 1.0, -260.0, -90.0, -500.0, -720.0, -430.0, -1270.0, -799.0, -550.0, -334.0, -486.0, -1310.0, -448.0, 2.0, 12.0, -531.0, 0.0, -627.0, -757.0, -729.0, -490.0, -640.0, -469.0, -573.0, -239.0, -174.0, -223.0, -260.0, -570.0, -858.0, -50.0, -639.0, -1620.0, -40.0, -271.0, -630.0, -609.0, 22.0, 0.0, -70.0, -350.0, -439.0, -116.0, -545.0, -690.0, -320.0, -130.0], "policy_predator_policy_reward": [190.0, 0.0, 0.0, 30.0, 0.0, 55.0, 345.0, 75.0, 90.0, 125.0, 80.0, 55.0, 680.0, 120.0, 75.0, 45.0, 105.0, 80.0, 10.0, 45.0, 45.0, 585.0, 0.0, 0.0, 640.0, 60.0, 20.0, 60.0, 370.0, 35.0, 290.0, 720.0, 0.0, 15.0, 45.0, 0.0, 25.0, 5.0, 0.0, 80.0, 0.0, 45.0, 180.0, 260.0, 0.0, 0.0, 140.0, 0.0, 150.0, 30.0, 430.0, 115.0, 50.0, 0.0, 990.0, 110.0, 15.0, 110.0, 0.0, 60.0, 35.0, 5.0, 20.0, 55.0, 175.0, 0.0, 145.0, 45.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 50.0, 65.0, 575.0, 125.0, 740.0, 100.0, 0.0, 0.0, 85.0, 820.0, 25.0, 100.0, 50.0, 40.0, 75.0, 590.0, 645.0, 0.0, 70.0, 10.0, 90.0, 595.0, 525.0, 30.0, 115.0, 410.0, 0.0, 5.0, 290.0, 40.0, 0.0, 150.0, 65.0, 230.0, 65.0, 140.0, 225.0, 0.0, 430.0, 115.0, 20.0, 65.0, 130.0, 0.0, 0.0, 925.0, 75.0, 25.0, 345.0, 155.0, 195.0, 105.0, 320.0, 470.0, 0.0, 0.0, 110.0, 0.0, 5.0, 0.0, 25.0, 10.0, 380.0, 455.0, 55.0, 0.0, 30.0, 455.0, 495.0, 0.0, 165.0, 160.0, 500.0, 240.0, 800.0, 35.0, 155.0, 20.0, 0.0, 0.0, 175.0, 10.0, 405.0, 115.0, 645.0, 95.0, 490.0, 0.0, 390.0, 0.0, 765.0, 45.0, 0.0, 0.0, 45.0, 225.0, 45.0, 450.0, 335.0, 215.0, 400.0, 85.0, 350.0, 5.0, 120.0, 0.0, 40.0, 325.0, 105.0, 385.0, 115.0, 830.0, 165.0, 145.0, 515.0, 25.0, 0.0, 0.0, 85.0, 155.0, 90.0, 175.0, 0.0, 465.0, 180.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6208949822208228, "mean_inference_ms": 1.4389077585497778, "mean_action_processing_ms": 0.24303631297556977, "mean_env_wait_ms": 0.182416229337398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004311680793762207, "StateBufferConnector_ms": 0.0035049915313720703, "ViewRequirementAgentConnector_ms": 0.09549212455749512}, "num_episodes": 22, "episode_return_max": 24.0, "episode_return_min": -2535.0, "episode_return_mean": -455.0, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.32113505394639, "num_env_steps_trained_throughput_per_sec": 82.32113505394639, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 48762.903, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48762.845, "sample_time_ms": 1131.663, "learn_time_ms": 47614.022, "learn_throughput": 84.009, "synch_weights_time_ms": 15.106}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-28-10", "timestamp": 1723501690, "time_this_iter_s": 48.64114212989807, "time_total_s": 3124.8022632598877, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aae06b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3124.8022632598877, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 23.855072463768117, "ram_util_percent": 81.37971014492751}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.004627610388256, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.26876092360764, "policy_loss": -0.006604673005837612, "vf_loss": 7.27388997557302, "vf_explained_var": -0.0001542919842654435, "kl": 0.009837476474242702, "entropy": 1.0261540650690675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.819401285888026, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4750749166680395, "policy_loss": -0.010117857327940996, "vf_loss": 7.4835794928212644, "vf_explained_var": -0.0010712428383095555, "kl": 0.008066442731078094, "entropy": 1.3649603137894282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -2535.0, "episode_reward_mean": -485.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1940.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -429.645, "predator_policy": 186.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-140.0, -120.0, -1130.0, -49.0, -2535.0, -107.0, -50.0, -29.0, -45.0, -285.0, -190.0, 0.0, -50.0, 0.0, -96.0, -1547.0, -1520.0, 19.0, -2075.0, -125.0, -150.0, -864.0, -1128.0, -52.0, -851.0, -1025.0, -814.0, -5.0, -420.0, -391.0, -284.0, -196.0, -225.0, -918.0, -83.0, -148.0, -1760.0, -90.0, -476.0, -300.0, -1372.0, 24.0, -110.0, 2.0, -22.0, -925.0, -43.0, -615.0, -505.0, -79.0, -850.0, -1195.0, -158.0, 15.0, -165.0, -700.0, -960.0, -859.0, -430.0, -948.0, 14.0, -261.0, -889.0, -669.0, -624.0, -457.0, -277.0, -465.0, -418.0, -1314.0, -1.0, -699.0, 22.0, -180.0, -290.0, -770.0, -260.0, -130.0, -809.0, -240.0, -655.0, -387.0, -623.0, -432.0, -164.0, -910.0, -327.0, -872.0, -205.0, -195.0, -708.0, -478.0, -340.0, -985.0, -820.0, -214.0, -330.0, -195.0, -572.0, -256.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.0, -256.0, 0.0, -300.0, -800.0, -875.0, -20.0, -79.0, -1695.0, -1940.0, -22.0, -210.0, -114.0, 4.0, 1.0, -70.0, -10.0, -110.0, -350.0, -110.0, -10.0, -370.0, 0.0, 0.0, -40.0, -30.0, 0.0, 0.0, -73.0, -138.0, -1080.0, -1167.0, -1240.0, -1120.0, 10.0, 9.0, -1510.0, -1470.0, -10.0, -240.0, -160.0, -80.0, -600.0, -929.0, -793.0, -980.0, 0.0, -132.0, -405.0, -1131.0, -700.0, -880.0, -659.0, -680.0, -10.0, 0.0, -404.0, -346.0, -270.0, -271.0, -129.0, -450.0, -401.0, 0.0, 0.0, -450.0, -903.0, -560.0, -140.0, -28.0, -60.0, -218.0, -885.0, -1800.0, -140.0, -50.0, -806.0, -170.0, -200.0, -400.0, -747.0, -1415.0, 14.0, 10.0, -220.0, 0.0, -3.0, 0.0, -8.0, -49.0, -1280.0, -480.0, -98.0, 0.0, -720.0, -380.0, -650.0, -350.0, -237.0, -167.0, -660.0, -930.0, -1340.0, -690.0, -303.0, -30.0, 14.0, 1.0, -260.0, -90.0, -500.0, -720.0, -430.0, -1270.0, -799.0, -550.0, -334.0, -486.0, -1310.0, -448.0, 2.0, 12.0, -531.0, 0.0, -627.0, -757.0, -729.0, -490.0, -640.0, -469.0, -573.0, -239.0, -174.0, -223.0, -260.0, -570.0, -858.0, -50.0, -639.0, -1620.0, -40.0, -271.0, -630.0, -609.0, 22.0, 0.0, -70.0, -350.0, -439.0, -116.0, -545.0, -690.0, -320.0, -130.0, -230.0, -20.0, -1004.0, -660.0, -440.0, -240.0, -650.0, -680.0, -217.0, -500.0, -638.0, -620.0, -522.0, -230.0, -312.0, -427.0, -380.0, -1090.0, -557.0, -220.0, -755.0, -622.0, -180.0, -190.0, -250.0, -140.0, -489.0, -1134.0, -748.0, -425.0, -550.0, -210.0, -749.0, -851.0, -560.0, -840.0, 3.0, -437.0, -290.0, -360.0, -290.0, -150.0, -369.0, -728.0, -331.0, -430.0], "policy_predator_policy_reward": [140.0, 0.0, 150.0, 30.0, 430.0, 115.0, 50.0, 0.0, 990.0, 110.0, 15.0, 110.0, 0.0, 60.0, 35.0, 5.0, 20.0, 55.0, 175.0, 0.0, 145.0, 45.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 50.0, 65.0, 575.0, 125.0, 740.0, 100.0, 0.0, 0.0, 85.0, 820.0, 25.0, 100.0, 50.0, 40.0, 75.0, 590.0, 645.0, 0.0, 70.0, 10.0, 90.0, 595.0, 525.0, 30.0, 115.0, 410.0, 0.0, 5.0, 290.0, 40.0, 0.0, 150.0, 65.0, 230.0, 65.0, 140.0, 225.0, 0.0, 430.0, 115.0, 20.0, 65.0, 130.0, 0.0, 0.0, 925.0, 75.0, 25.0, 345.0, 155.0, 195.0, 105.0, 320.0, 470.0, 0.0, 0.0, 110.0, 0.0, 5.0, 0.0, 25.0, 10.0, 380.0, 455.0, 55.0, 0.0, 30.0, 455.0, 495.0, 0.0, 165.0, 160.0, 500.0, 240.0, 800.0, 35.0, 155.0, 20.0, 0.0, 0.0, 175.0, 10.0, 405.0, 115.0, 645.0, 95.0, 490.0, 0.0, 390.0, 0.0, 765.0, 45.0, 0.0, 0.0, 45.0, 225.0, 45.0, 450.0, 335.0, 215.0, 400.0, 85.0, 350.0, 5.0, 120.0, 0.0, 40.0, 325.0, 105.0, 385.0, 115.0, 830.0, 165.0, 145.0, 515.0, 25.0, 0.0, 0.0, 85.0, 155.0, 90.0, 175.0, 0.0, 465.0, 180.0, 10.0, 30.0, 90.0, 375.0, 480.0, 235.0, 205.0, 610.0, 65.0, 160.0, 170.0, 320.0, 315.0, 260.0, 60.0, 310.0, 265.0, 560.0, 0.0, 305.0, 145.0, 15.0, 490.0, 110.0, 55.0, 5.0, 190.0, 325.0, 590.0, 465.0, 230.0, 215.0, 205.0, 145.0, 470.0, 0.0, 580.0, 0.0, 220.0, 55.0, 265.0, 160.0, 85.0, 375.0, 150.0, 355.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.619873477916296, "mean_inference_ms": 1.4357276170375974, "mean_action_processing_ms": 0.24279336659026207, "mean_env_wait_ms": 0.1822510303592172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004749894142150879, "StateBufferConnector_ms": 0.003549337387084961, "ViewRequirementAgentConnector_ms": 0.09425616264343262}, "num_episodes": 23, "episode_return_max": 24.0, "episode_return_min": -2535.0, "episode_return_mean": -485.34, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.18523655417587, "num_env_steps_trained_throughput_per_sec": 79.18523655417587, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 49078.966, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49078.904, "sample_time_ms": 1135.26, "learn_time_ms": 47925.953, "learn_throughput": 83.462, "synch_weights_time_ms": 15.1}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-29-01", "timestamp": 1723501741, "time_this_iter_s": 50.569331884384155, "time_total_s": 3175.371595144272, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88bdc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3175.371595144272, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 26.887500000000003, "ram_util_percent": 82.1888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9775800560517285, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.638145973821166, "policy_loss": -0.006371413849087225, "vf_loss": 6.643354352315267, "vf_explained_var": 0.00045909351772732205, "kl": 0.007753527135813514, "entropy": 1.0378513216341614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.168015825243854, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.113065306850212, "policy_loss": -0.01094323206426842, "vf_loss": 7.121922228576015, "vf_explained_var": -0.0012157195774966448, "kl": 0.010431559185546998, "entropy": 1.3677755547579002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -2075.0, "episode_reward_mean": -502.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1800.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 925.0}, "policy_reward_mean": {"prey_policy": -460.54, "predator_policy": 209.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2075.0, -125.0, -150.0, -864.0, -1128.0, -52.0, -851.0, -1025.0, -814.0, -5.0, -420.0, -391.0, -284.0, -196.0, -225.0, -918.0, -83.0, -148.0, -1760.0, -90.0, -476.0, -300.0, -1372.0, 24.0, -110.0, 2.0, -22.0, -925.0, -43.0, -615.0, -505.0, -79.0, -850.0, -1195.0, -158.0, 15.0, -165.0, -700.0, -960.0, -859.0, -430.0, -948.0, 14.0, -261.0, -889.0, -669.0, -624.0, -457.0, -277.0, -465.0, -418.0, -1314.0, -1.0, -699.0, 22.0, -180.0, -290.0, -770.0, -260.0, -130.0, -809.0, -240.0, -655.0, -387.0, -623.0, -432.0, -164.0, -910.0, -327.0, -872.0, -205.0, -195.0, -708.0, -478.0, -340.0, -985.0, -820.0, -214.0, -330.0, -195.0, -572.0, -256.0, -302.0, -489.0, -245.0, -175.0, -562.0, -870.0, -696.0, -907.0, -767.0, -936.0, -597.0, -487.0, -820.0, -370.0, -242.0, -375.0, -89.0, -699.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1510.0, -1470.0, -10.0, -240.0, -160.0, -80.0, -600.0, -929.0, -793.0, -980.0, 0.0, -132.0, -405.0, -1131.0, -700.0, -880.0, -659.0, -680.0, -10.0, 0.0, -404.0, -346.0, -270.0, -271.0, -129.0, -450.0, -401.0, 0.0, 0.0, -450.0, -903.0, -560.0, -140.0, -28.0, -60.0, -218.0, -885.0, -1800.0, -140.0, -50.0, -806.0, -170.0, -200.0, -400.0, -747.0, -1415.0, 14.0, 10.0, -220.0, 0.0, -3.0, 0.0, -8.0, -49.0, -1280.0, -480.0, -98.0, 0.0, -720.0, -380.0, -650.0, -350.0, -237.0, -167.0, -660.0, -930.0, -1340.0, -690.0, -303.0, -30.0, 14.0, 1.0, -260.0, -90.0, -500.0, -720.0, -430.0, -1270.0, -799.0, -550.0, -334.0, -486.0, -1310.0, -448.0, 2.0, 12.0, -531.0, 0.0, -627.0, -757.0, -729.0, -490.0, -640.0, -469.0, -573.0, -239.0, -174.0, -223.0, -260.0, -570.0, -858.0, -50.0, -639.0, -1620.0, -40.0, -271.0, -630.0, -609.0, 22.0, 0.0, -70.0, -350.0, -439.0, -116.0, -545.0, -690.0, -320.0, -130.0, -230.0, -20.0, -1004.0, -660.0, -440.0, -240.0, -650.0, -680.0, -217.0, -500.0, -638.0, -620.0, -522.0, -230.0, -312.0, -427.0, -380.0, -1090.0, -557.0, -220.0, -755.0, -622.0, -180.0, -190.0, -250.0, -140.0, -489.0, -1134.0, -748.0, -425.0, -550.0, -210.0, -749.0, -851.0, -560.0, -840.0, 3.0, -437.0, -290.0, -360.0, -290.0, -150.0, -369.0, -728.0, -331.0, -430.0, -429.0, -138.0, -850.0, -129.0, -80.0, -430.0, -600.0, -70.0, -860.0, -302.0, -1040.0, -520.0, -571.0, -750.0, -867.0, -620.0, -980.0, -372.0, -501.0, -1190.0, -463.0, -424.0, -448.0, -529.0, -970.0, -590.0, -680.0, -30.0, -176.0, -466.0, -498.0, -377.0, -179.0, 0.0, -799.0, -480.0], "policy_predator_policy_reward": [85.0, 820.0, 25.0, 100.0, 50.0, 40.0, 75.0, 590.0, 645.0, 0.0, 70.0, 10.0, 90.0, 595.0, 525.0, 30.0, 115.0, 410.0, 0.0, 5.0, 290.0, 40.0, 0.0, 150.0, 65.0, 230.0, 65.0, 140.0, 225.0, 0.0, 430.0, 115.0, 20.0, 65.0, 130.0, 0.0, 0.0, 925.0, 75.0, 25.0, 345.0, 155.0, 195.0, 105.0, 320.0, 470.0, 0.0, 0.0, 110.0, 0.0, 5.0, 0.0, 25.0, 10.0, 380.0, 455.0, 55.0, 0.0, 30.0, 455.0, 495.0, 0.0, 165.0, 160.0, 500.0, 240.0, 800.0, 35.0, 155.0, 20.0, 0.0, 0.0, 175.0, 10.0, 405.0, 115.0, 645.0, 95.0, 490.0, 0.0, 390.0, 0.0, 765.0, 45.0, 0.0, 0.0, 45.0, 225.0, 45.0, 450.0, 335.0, 215.0, 400.0, 85.0, 350.0, 5.0, 120.0, 0.0, 40.0, 325.0, 105.0, 385.0, 115.0, 830.0, 165.0, 145.0, 515.0, 25.0, 0.0, 0.0, 85.0, 155.0, 90.0, 175.0, 0.0, 465.0, 180.0, 10.0, 30.0, 90.0, 375.0, 480.0, 235.0, 205.0, 610.0, 65.0, 160.0, 170.0, 320.0, 315.0, 260.0, 60.0, 310.0, 265.0, 560.0, 0.0, 305.0, 145.0, 15.0, 490.0, 110.0, 55.0, 5.0, 190.0, 325.0, 590.0, 465.0, 230.0, 215.0, 205.0, 145.0, 470.0, 0.0, 580.0, 0.0, 220.0, 55.0, 265.0, 160.0, 85.0, 375.0, 150.0, 355.0, 150.0, 130.0, 135.0, 0.0, 490.0, 95.0, 170.0, 330.0, 165.0, 585.0, 15.0, 340.0, 350.0, 95.0, 530.0, 120.0, 460.0, 520.0, 65.0, 695.0, 60.0, 290.0, 0.0, 205.0, 285.0, 740.0, 0.0, 0.0, 340.0, 170.0, 230.0, 255.0, 245.0, 90.0, 0.0, 120.0, 460.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6188989717795772, "mean_inference_ms": 1.4332261825535335, "mean_action_processing_ms": 0.24262720883238345, "mean_env_wait_ms": 0.18215948648078434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005026340484619141, "StateBufferConnector_ms": 0.003512740135192871, "ViewRequirementAgentConnector_ms": 0.09379851818084717}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -2075.0, "episode_return_mean": -502.88, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.61413485235694, "num_env_steps_trained_throughput_per_sec": 76.61413485235694, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 49549.774, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49549.711, "sample_time_ms": 1151.769, "learn_time_ms": 48379.331, "learn_throughput": 82.68, "synch_weights_time_ms": 15.713}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-29-53", "timestamp": 1723501793, "time_this_iter_s": 52.243298053741455, "time_total_s": 3227.6148931980133, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aadfef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3227.6148931980133, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 32.12702702702702, "ram_util_percent": 80.84729729729729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7957624979120084, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.156032374548533, "policy_loss": -0.008186311706920307, "vf_loss": 5.163150242901353, "vf_explained_var": -0.0006015156311963601, "kl": 0.007122867760920737, "entropy": 1.03205159618741, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.069649302171021, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.401289803893478, "policy_loss": -0.012923061278545193, "vf_loss": 6.412445748546136, "vf_explained_var": -0.0013690170156892645, "kl": 0.008835525365595998, "entropy": 1.3502170352708727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -1760.0, "episode_reward_mean": -518.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1800.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 925.0}, "policy_reward_mean": {"prey_policy": -487.605, "predator_policy": 228.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1760.0, -90.0, -476.0, -300.0, -1372.0, 24.0, -110.0, 2.0, -22.0, -925.0, -43.0, -615.0, -505.0, -79.0, -850.0, -1195.0, -158.0, 15.0, -165.0, -700.0, -960.0, -859.0, -430.0, -948.0, 14.0, -261.0, -889.0, -669.0, -624.0, -457.0, -277.0, -465.0, -418.0, -1314.0, -1.0, -699.0, 22.0, -180.0, -290.0, -770.0, -260.0, -130.0, -809.0, -240.0, -655.0, -387.0, -623.0, -432.0, -164.0, -910.0, -327.0, -872.0, -205.0, -195.0, -708.0, -478.0, -340.0, -985.0, -820.0, -214.0, -330.0, -195.0, -572.0, -256.0, -302.0, -489.0, -245.0, -175.0, -562.0, -870.0, -696.0, -907.0, -767.0, -936.0, -597.0, -487.0, -820.0, -370.0, -242.0, -375.0, -89.0, -699.0, -1076.0, -283.0, -1324.0, -389.0, -873.0, -1270.0, -495.0, -1180.0, -510.0, -55.0, -621.0, -978.0, -388.0, -252.0, -825.0, -380.0, -279.0, -149.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-885.0, -1800.0, -140.0, -50.0, -806.0, -170.0, -200.0, -400.0, -747.0, -1415.0, 14.0, 10.0, -220.0, 0.0, -3.0, 0.0, -8.0, -49.0, -1280.0, -480.0, -98.0, 0.0, -720.0, -380.0, -650.0, -350.0, -237.0, -167.0, -660.0, -930.0, -1340.0, -690.0, -303.0, -30.0, 14.0, 1.0, -260.0, -90.0, -500.0, -720.0, -430.0, -1270.0, -799.0, -550.0, -334.0, -486.0, -1310.0, -448.0, 2.0, 12.0, -531.0, 0.0, -627.0, -757.0, -729.0, -490.0, -640.0, -469.0, -573.0, -239.0, -174.0, -223.0, -260.0, -570.0, -858.0, -50.0, -639.0, -1620.0, -40.0, -271.0, -630.0, -609.0, 22.0, 0.0, -70.0, -350.0, -439.0, -116.0, -545.0, -690.0, -320.0, -130.0, -230.0, -20.0, -1004.0, -660.0, -440.0, -240.0, -650.0, -680.0, -217.0, -500.0, -638.0, -620.0, -522.0, -230.0, -312.0, -427.0, -380.0, -1090.0, -557.0, -220.0, -755.0, -622.0, -180.0, -190.0, -250.0, -140.0, -489.0, -1134.0, -748.0, -425.0, -550.0, -210.0, -749.0, -851.0, -560.0, -840.0, 3.0, -437.0, -290.0, -360.0, -290.0, -150.0, -369.0, -728.0, -331.0, -430.0, -429.0, -138.0, -850.0, -129.0, -80.0, -430.0, -600.0, -70.0, -860.0, -302.0, -1040.0, -520.0, -571.0, -750.0, -867.0, -620.0, -980.0, -372.0, -501.0, -1190.0, -463.0, -424.0, -448.0, -529.0, -970.0, -590.0, -680.0, -30.0, -176.0, -466.0, -498.0, -377.0, -179.0, 0.0, -799.0, -480.0, -1060.0, -1011.0, -303.0, -360.0, -969.0, -1160.0, -744.0, -310.0, -670.0, -728.0, -1061.0, -944.0, 4.0, -1024.0, -875.0, -1105.0, -290.0, -650.0, -120.0, 0.0, -380.0, -716.0, -658.0, -965.0, -571.0, -707.0, -160.0, -347.0, -520.0, -680.0, -270.0, -450.0, -606.0, -83.0, -300.0, -619.0], "policy_predator_policy_reward": [0.0, 925.0, 75.0, 25.0, 345.0, 155.0, 195.0, 105.0, 320.0, 470.0, 0.0, 0.0, 110.0, 0.0, 5.0, 0.0, 25.0, 10.0, 380.0, 455.0, 55.0, 0.0, 30.0, 455.0, 495.0, 0.0, 165.0, 160.0, 500.0, 240.0, 800.0, 35.0, 155.0, 20.0, 0.0, 0.0, 175.0, 10.0, 405.0, 115.0, 645.0, 95.0, 490.0, 0.0, 390.0, 0.0, 765.0, 45.0, 0.0, 0.0, 45.0, 225.0, 45.0, 450.0, 335.0, 215.0, 400.0, 85.0, 350.0, 5.0, 120.0, 0.0, 40.0, 325.0, 105.0, 385.0, 115.0, 830.0, 165.0, 145.0, 515.0, 25.0, 0.0, 0.0, 85.0, 155.0, 90.0, 175.0, 0.0, 465.0, 180.0, 10.0, 30.0, 90.0, 375.0, 480.0, 235.0, 205.0, 610.0, 65.0, 160.0, 170.0, 320.0, 315.0, 260.0, 60.0, 310.0, 265.0, 560.0, 0.0, 305.0, 145.0, 15.0, 490.0, 110.0, 55.0, 5.0, 190.0, 325.0, 590.0, 465.0, 230.0, 215.0, 205.0, 145.0, 470.0, 0.0, 580.0, 0.0, 220.0, 55.0, 265.0, 160.0, 85.0, 375.0, 150.0, 355.0, 150.0, 130.0, 135.0, 0.0, 490.0, 95.0, 170.0, 330.0, 165.0, 585.0, 15.0, 340.0, 350.0, 95.0, 530.0, 120.0, 460.0, 520.0, 65.0, 695.0, 60.0, 290.0, 0.0, 205.0, 285.0, 740.0, 0.0, 0.0, 340.0, 170.0, 230.0, 255.0, 245.0, 90.0, 0.0, 120.0, 460.0, 480.0, 515.0, 210.0, 170.0, 430.0, 375.0, 270.0, 395.0, 460.0, 65.0, 210.0, 525.0, 170.0, 355.0, 565.0, 235.0, 335.0, 95.0, 0.0, 65.0, 320.0, 155.0, 335.0, 310.0, 445.0, 445.0, 245.0, 10.0, 75.0, 300.0, 275.0, 65.0, 150.0, 260.0, 375.0, 395.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6178013834927186, "mean_inference_ms": 1.4303986857142075, "mean_action_processing_ms": 0.24242108336446613, "mean_env_wait_ms": 0.18201846971347152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005431532859802246, "StateBufferConnector_ms": 0.003474593162536621, "ViewRequirementAgentConnector_ms": 0.09167277812957764}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -1760.0, "episode_return_mean": -518.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.59141562504831, "num_env_steps_trained_throughput_per_sec": 78.59141562504831, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 49701.12, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49701.057, "sample_time_ms": 1137.417, "learn_time_ms": 48543.349, "learn_throughput": 82.401, "synch_weights_time_ms": 16.623}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-30-44", "timestamp": 1723501844, "time_this_iter_s": 50.92261099815369, "time_total_s": 3278.537504196167, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8816700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3278.537504196167, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 26.820833333333333, "ram_util_percent": 80.20972222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0488152972289493, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.830773581398858, "policy_loss": -0.00979880758009299, "vf_loss": 5.839107021452889, "vf_explained_var": 0.0030363711730512994, "kl": 0.009769054265363803, "entropy": 1.0259464587168718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.036536927040292, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.117685005399916, "policy_loss": -0.006989967309569241, "vf_loss": 6.123336841441967, "vf_explained_var": -0.0003359180278878994, "kl": 0.0066906847590323245, "entropy": 1.3608622122063208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -1715.0, "episode_reward_mean": -508.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1630.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 860.0}, "policy_reward_mean": {"prey_policy": -490.245, "predator_policy": 235.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-430.0, -948.0, 14.0, -261.0, -889.0, -669.0, -624.0, -457.0, -277.0, -465.0, -418.0, -1314.0, -1.0, -699.0, 22.0, -180.0, -290.0, -770.0, -260.0, -130.0, -809.0, -240.0, -655.0, -387.0, -623.0, -432.0, -164.0, -910.0, -327.0, -872.0, -205.0, -195.0, -708.0, -478.0, -340.0, -985.0, -820.0, -214.0, -330.0, -195.0, -572.0, -256.0, -302.0, -489.0, -245.0, -175.0, -562.0, -870.0, -696.0, -907.0, -767.0, -936.0, -597.0, -487.0, -820.0, -370.0, -242.0, -375.0, -89.0, -699.0, -1076.0, -283.0, -1324.0, -389.0, -873.0, -1270.0, -495.0, -1180.0, -510.0, -55.0, -621.0, -978.0, -388.0, -252.0, -825.0, -380.0, -279.0, -149.0, -188.0, -162.0, -340.0, -556.0, -1058.0, -40.0, -155.0, -165.0, -1244.0, -376.0, -155.0, -380.0, -260.0, -1715.0, -147.0, -245.0, -440.0, -710.0, -340.0, -716.0, -254.0, -525.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-334.0, -486.0, -1310.0, -448.0, 2.0, 12.0, -531.0, 0.0, -627.0, -757.0, -729.0, -490.0, -640.0, -469.0, -573.0, -239.0, -174.0, -223.0, -260.0, -570.0, -858.0, -50.0, -639.0, -1620.0, -40.0, -271.0, -630.0, -609.0, 22.0, 0.0, -70.0, -350.0, -439.0, -116.0, -545.0, -690.0, -320.0, -130.0, -230.0, -20.0, -1004.0, -660.0, -440.0, -240.0, -650.0, -680.0, -217.0, -500.0, -638.0, -620.0, -522.0, -230.0, -312.0, -427.0, -380.0, -1090.0, -557.0, -220.0, -755.0, -622.0, -180.0, -190.0, -250.0, -140.0, -489.0, -1134.0, -748.0, -425.0, -550.0, -210.0, -749.0, -851.0, -560.0, -840.0, 3.0, -437.0, -290.0, -360.0, -290.0, -150.0, -369.0, -728.0, -331.0, -430.0, -429.0, -138.0, -850.0, -129.0, -80.0, -430.0, -600.0, -70.0, -860.0, -302.0, -1040.0, -520.0, -571.0, -750.0, -867.0, -620.0, -980.0, -372.0, -501.0, -1190.0, -463.0, -424.0, -448.0, -529.0, -970.0, -590.0, -680.0, -30.0, -176.0, -466.0, -498.0, -377.0, -179.0, 0.0, -799.0, -480.0, -1060.0, -1011.0, -303.0, -360.0, -969.0, -1160.0, -744.0, -310.0, -670.0, -728.0, -1061.0, -944.0, 4.0, -1024.0, -875.0, -1105.0, -290.0, -650.0, -120.0, 0.0, -380.0, -716.0, -658.0, -965.0, -571.0, -707.0, -160.0, -347.0, -520.0, -680.0, -270.0, -450.0, -606.0, -83.0, -300.0, -619.0, -193.0, -165.0, -458.0, 16.0, 0.0, -860.0, -330.0, -661.0, -660.0, -1033.0, -56.0, -364.0, -419.0, -91.0, -330.0, 0.0, -494.0, -1610.0, -140.0, -691.0, -70.0, -300.0, -310.0, -450.0, -340.0, -100.0, -1095.0, -1630.0, -377.0, 0.0, -520.0, -40.0, -350.0, -780.0, -1005.0, -420.0, -310.0, -630.0, -501.0, -860.0, -539.0, -100.0, -850.0, -200.0], "policy_predator_policy_reward": [390.0, 0.0, 765.0, 45.0, 0.0, 0.0, 45.0, 225.0, 45.0, 450.0, 335.0, 215.0, 400.0, 85.0, 350.0, 5.0, 120.0, 0.0, 40.0, 325.0, 105.0, 385.0, 115.0, 830.0, 165.0, 145.0, 515.0, 25.0, 0.0, 0.0, 85.0, 155.0, 90.0, 175.0, 0.0, 465.0, 180.0, 10.0, 30.0, 90.0, 375.0, 480.0, 235.0, 205.0, 610.0, 65.0, 160.0, 170.0, 320.0, 315.0, 260.0, 60.0, 310.0, 265.0, 560.0, 0.0, 305.0, 145.0, 15.0, 490.0, 110.0, 55.0, 5.0, 190.0, 325.0, 590.0, 465.0, 230.0, 215.0, 205.0, 145.0, 470.0, 0.0, 580.0, 0.0, 220.0, 55.0, 265.0, 160.0, 85.0, 375.0, 150.0, 355.0, 150.0, 130.0, 135.0, 0.0, 490.0, 95.0, 170.0, 330.0, 165.0, 585.0, 15.0, 340.0, 350.0, 95.0, 530.0, 120.0, 460.0, 520.0, 65.0, 695.0, 60.0, 290.0, 0.0, 205.0, 285.0, 740.0, 0.0, 0.0, 340.0, 170.0, 230.0, 255.0, 245.0, 90.0, 0.0, 120.0, 460.0, 480.0, 515.0, 210.0, 170.0, 430.0, 375.0, 270.0, 395.0, 460.0, 65.0, 210.0, 525.0, 170.0, 355.0, 565.0, 235.0, 335.0, 95.0, 0.0, 65.0, 320.0, 155.0, 335.0, 310.0, 445.0, 445.0, 245.0, 10.0, 75.0, 300.0, 275.0, 65.0, 150.0, 260.0, 375.0, 395.0, 150.0, 20.0, 125.0, 155.0, 290.0, 230.0, 340.0, 95.0, 5.0, 630.0, 225.0, 155.0, 195.0, 160.0, 105.0, 60.0, 860.0, 0.0, 85.0, 370.0, 60.0, 155.0, 0.0, 380.0, 5.0, 175.0, 595.0, 415.0, 40.0, 190.0, 125.0, 190.0, 395.0, 295.0, 580.0, 135.0, 300.0, 300.0, 230.0, 415.0, 190.0, 195.0, 0.0, 525.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6166360666006762, "mean_inference_ms": 1.4274389587937555, "mean_action_processing_ms": 0.24232007123067084, "mean_env_wait_ms": 0.18178417400042363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054051876068115234, "StateBufferConnector_ms": 0.003045320510864258, "ViewRequirementAgentConnector_ms": 0.09112095832824707}, "num_episodes": 22, "episode_return_max": 22.0, "episode_return_min": -1715.0, "episode_return_mean": -508.89, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.06025500492552, "num_env_steps_trained_throughput_per_sec": 80.06025500492552, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 49664.014, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49663.944, "sample_time_ms": 1124.043, "learn_time_ms": 48520.214, "learn_throughput": 82.44, "synch_weights_time_ms": 16.217}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-31-34", "timestamp": 1723501894, "time_this_iter_s": 49.99989414215088, "time_total_s": 3328.537398338318, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aadfe4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3328.537398338318, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 25.87183098591549, "ram_util_percent": 80.71549295774648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9767355580809256, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.470779154792664, "policy_loss": -0.007511325816441544, "vf_loss": 6.477185554605312, "vf_explained_var": 0.0009360032737570465, "kl": 0.007366179456523491, "entropy": 1.0019157864113963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9667305781727746, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.094487391199384, "policy_loss": -0.009554348057431598, "vf_loss": 6.102467966079712, "vf_explained_var": 0.00017978022338221313, "kl": 0.007868974035868415, "entropy": 1.3326030103617874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": -35.0, "episode_reward_min": -1715.0, "episode_reward_mean": -537.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1649.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 860.0}, "policy_reward_mean": {"prey_policy": -522.0, "predator_policy": 253.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-387.0, -623.0, -432.0, -164.0, -910.0, -327.0, -872.0, -205.0, -195.0, -708.0, -478.0, -340.0, -985.0, -820.0, -214.0, -330.0, -195.0, -572.0, -256.0, -302.0, -489.0, -245.0, -175.0, -562.0, -870.0, -696.0, -907.0, -767.0, -936.0, -597.0, -487.0, -820.0, -370.0, -242.0, -375.0, -89.0, -699.0, -1076.0, -283.0, -1324.0, -389.0, -873.0, -1270.0, -495.0, -1180.0, -510.0, -55.0, -621.0, -978.0, -388.0, -252.0, -825.0, -380.0, -279.0, -149.0, -188.0, -162.0, -340.0, -556.0, -1058.0, -40.0, -155.0, -165.0, -1244.0, -376.0, -155.0, -380.0, -260.0, -1715.0, -147.0, -245.0, -440.0, -710.0, -340.0, -716.0, -254.0, -525.0, -949.0, -619.0, -749.0, -548.0, -915.0, -97.0, -937.0, -223.0, -780.0, -280.0, -175.0, -270.0, -1600.0, -35.0, -655.0, -1060.0, -151.0, -582.0, -425.0, -1364.0, -470.0, -377.0, -380.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-217.0, -500.0, -638.0, -620.0, -522.0, -230.0, -312.0, -427.0, -380.0, -1090.0, -557.0, -220.0, -755.0, -622.0, -180.0, -190.0, -250.0, -140.0, -489.0, -1134.0, -748.0, -425.0, -550.0, -210.0, -749.0, -851.0, -560.0, -840.0, 3.0, -437.0, -290.0, -360.0, -290.0, -150.0, -369.0, -728.0, -331.0, -430.0, -429.0, -138.0, -850.0, -129.0, -80.0, -430.0, -600.0, -70.0, -860.0, -302.0, -1040.0, -520.0, -571.0, -750.0, -867.0, -620.0, -980.0, -372.0, -501.0, -1190.0, -463.0, -424.0, -448.0, -529.0, -970.0, -590.0, -680.0, -30.0, -176.0, -466.0, -498.0, -377.0, -179.0, 0.0, -799.0, -480.0, -1060.0, -1011.0, -303.0, -360.0, -969.0, -1160.0, -744.0, -310.0, -670.0, -728.0, -1061.0, -944.0, 4.0, -1024.0, -875.0, -1105.0, -290.0, -650.0, -120.0, 0.0, -380.0, -716.0, -658.0, -965.0, -571.0, -707.0, -160.0, -347.0, -520.0, -680.0, -270.0, -450.0, -606.0, -83.0, -300.0, -619.0, -193.0, -165.0, -458.0, 16.0, 0.0, -860.0, -330.0, -661.0, -660.0, -1033.0, -56.0, -364.0, -419.0, -91.0, -330.0, 0.0, -494.0, -1610.0, -140.0, -691.0, -70.0, -300.0, -310.0, -450.0, -340.0, -100.0, -1095.0, -1630.0, -377.0, 0.0, -520.0, -40.0, -350.0, -780.0, -1005.0, -420.0, -310.0, -630.0, -501.0, -860.0, -539.0, -100.0, -850.0, -200.0, -572.0, -832.0, -300.0, -1649.0, -510.0, -964.0, -698.0, -370.0, -640.0, -1070.0, -320.0, -47.0, -750.0, -1127.0, -320.0, -148.0, -730.0, -835.0, -720.0, -190.0, -20.0, -360.0, -650.0, -40.0, -1240.0, -1240.0, -70.0, 0.0, -654.0, -471.0, -1090.0, -730.0, -40.0, -256.0, -1041.0, -236.0, -690.0, -325.0, -1329.0, -870.0, -450.0, -325.0, -657.0, -100.0, -100.0, -700.0], "policy_predator_policy_reward": [160.0, 170.0, 320.0, 315.0, 260.0, 60.0, 310.0, 265.0, 560.0, 0.0, 305.0, 145.0, 15.0, 490.0, 110.0, 55.0, 5.0, 190.0, 325.0, 590.0, 465.0, 230.0, 215.0, 205.0, 145.0, 470.0, 0.0, 580.0, 0.0, 220.0, 55.0, 265.0, 160.0, 85.0, 375.0, 150.0, 355.0, 150.0, 130.0, 135.0, 0.0, 490.0, 95.0, 170.0, 330.0, 165.0, 585.0, 15.0, 340.0, 350.0, 95.0, 530.0, 120.0, 460.0, 520.0, 65.0, 695.0, 60.0, 290.0, 0.0, 205.0, 285.0, 740.0, 0.0, 0.0, 340.0, 170.0, 230.0, 255.0, 245.0, 90.0, 0.0, 120.0, 460.0, 480.0, 515.0, 210.0, 170.0, 430.0, 375.0, 270.0, 395.0, 460.0, 65.0, 210.0, 525.0, 170.0, 355.0, 565.0, 235.0, 335.0, 95.0, 0.0, 65.0, 320.0, 155.0, 335.0, 310.0, 445.0, 445.0, 245.0, 10.0, 75.0, 300.0, 275.0, 65.0, 150.0, 260.0, 375.0, 395.0, 150.0, 20.0, 125.0, 155.0, 290.0, 230.0, 340.0, 95.0, 5.0, 630.0, 225.0, 155.0, 195.0, 160.0, 105.0, 60.0, 860.0, 0.0, 85.0, 370.0, 60.0, 155.0, 0.0, 380.0, 5.0, 175.0, 595.0, 415.0, 40.0, 190.0, 125.0, 190.0, 395.0, 295.0, 580.0, 135.0, 300.0, 300.0, 230.0, 415.0, 190.0, 195.0, 0.0, 525.0, 5.0, 450.0, 750.0, 580.0, 620.0, 105.0, 265.0, 255.0, 520.0, 275.0, 160.0, 110.0, 350.0, 590.0, 165.0, 80.0, 365.0, 420.0, 190.0, 440.0, 120.0, 85.0, 135.0, 285.0, 375.0, 505.0, 0.0, 35.0, 240.0, 230.0, 410.0, 350.0, 65.0, 80.0, 540.0, 155.0, 260.0, 330.0, 270.0, 565.0, 10.0, 295.0, 220.0, 160.0, 290.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6158871739721479, "mean_inference_ms": 1.4236754462877366, "mean_action_processing_ms": 0.24173728548099443, "mean_env_wait_ms": 0.1815346446924055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005964159965515137, "StateBufferConnector_ms": 0.0030721426010131836, "ViewRequirementAgentConnector_ms": 0.0915757417678833}, "num_episodes": 23, "episode_return_max": -35.0, "episode_return_min": -1715.0, "episode_return_mean": -537.8, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.7932987018314, "num_env_steps_trained_throughput_per_sec": 82.7932987018314, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 49574.433, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49574.364, "sample_time_ms": 1098.017, "learn_time_ms": 48456.889, "learn_throughput": 82.548, "synch_weights_time_ms": 15.925}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-32-22", "timestamp": 1723501942, "time_this_iter_s": 48.3627610206604, "time_total_s": 3376.9001593589783, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8878790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3376.9001593589783, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 22.83623188405797, "ram_util_percent": 79.61739130434785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.850917139302486, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.49991817146382, "policy_loss": -0.0076107078283611275, "vf_loss": 5.506356556453402, "vf_explained_var": -0.00017716165572877914, "kl": 0.007815364643247547, "entropy": 0.9528019508356771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9259462781053371, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.47856200927149, "policy_loss": -0.010675677352846063, "vf_loss": 5.4874875305821655, "vf_explained_var": -0.0006139605133621781, "kl": 0.008750754092233888, "entropy": 1.2860427894289532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1715.0, "episode_reward_mean": -543.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1730.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 875.0}, "policy_reward_mean": {"prey_policy": -528.385, "predator_policy": 256.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-256.0, -302.0, -489.0, -245.0, -175.0, -562.0, -870.0, -696.0, -907.0, -767.0, -936.0, -597.0, -487.0, -820.0, -370.0, -242.0, -375.0, -89.0, -699.0, -1076.0, -283.0, -1324.0, -389.0, -873.0, -1270.0, -495.0, -1180.0, -510.0, -55.0, -621.0, -978.0, -388.0, -252.0, -825.0, -380.0, -279.0, -149.0, -188.0, -162.0, -340.0, -556.0, -1058.0, -40.0, -155.0, -165.0, -1244.0, -376.0, -155.0, -380.0, -260.0, -1715.0, -147.0, -245.0, -440.0, -710.0, -340.0, -716.0, -254.0, -525.0, -949.0, -619.0, -749.0, -548.0, -915.0, -97.0, -937.0, -223.0, -780.0, -280.0, -175.0, -270.0, -1600.0, -35.0, -655.0, -1060.0, -151.0, -582.0, -425.0, -1364.0, -470.0, -377.0, -380.0, -319.0, -655.0, -132.0, -214.0, -435.0, -119.0, -125.0, -1205.0, -85.0, -234.0, -1644.0, -900.0, -258.0, 0.0, -433.0, -1625.0, -20.0, -951.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-331.0, -430.0, -429.0, -138.0, -850.0, -129.0, -80.0, -430.0, -600.0, -70.0, -860.0, -302.0, -1040.0, -520.0, -571.0, -750.0, -867.0, -620.0, -980.0, -372.0, -501.0, -1190.0, -463.0, -424.0, -448.0, -529.0, -970.0, -590.0, -680.0, -30.0, -176.0, -466.0, -498.0, -377.0, -179.0, 0.0, -799.0, -480.0, -1060.0, -1011.0, -303.0, -360.0, -969.0, -1160.0, -744.0, -310.0, -670.0, -728.0, -1061.0, -944.0, 4.0, -1024.0, -875.0, -1105.0, -290.0, -650.0, -120.0, 0.0, -380.0, -716.0, -658.0, -965.0, -571.0, -707.0, -160.0, -347.0, -520.0, -680.0, -270.0, -450.0, -606.0, -83.0, -300.0, -619.0, -193.0, -165.0, -458.0, 16.0, 0.0, -860.0, -330.0, -661.0, -660.0, -1033.0, -56.0, -364.0, -419.0, -91.0, -330.0, 0.0, -494.0, -1610.0, -140.0, -691.0, -70.0, -300.0, -310.0, -450.0, -340.0, -100.0, -1095.0, -1630.0, -377.0, 0.0, -520.0, -40.0, -350.0, -780.0, -1005.0, -420.0, -310.0, -630.0, -501.0, -860.0, -539.0, -100.0, -850.0, -200.0, -572.0, -832.0, -300.0, -1649.0, -510.0, -964.0, -698.0, -370.0, -640.0, -1070.0, -320.0, -47.0, -750.0, -1127.0, -320.0, -148.0, -730.0, -835.0, -720.0, -190.0, -20.0, -360.0, -650.0, -40.0, -1240.0, -1240.0, -70.0, 0.0, -654.0, -471.0, -1090.0, -730.0, -40.0, -256.0, -1041.0, -236.0, -690.0, -325.0, -1329.0, -870.0, -450.0, -325.0, -657.0, -100.0, -100.0, -700.0, -79.0, -560.0, -60.0, -1255.0, -517.0, -310.0, -524.0, -20.0, -860.0, -50.0, -480.0, 11.0, -140.0, -60.0, -733.0, -1467.0, -430.0, -100.0, -243.0, -326.0, -789.0, -1730.0, -913.0, -742.0, -10.0, -768.0, 0.0, 0.0, -598.0, -330.0, -970.0, -1430.0, -40.0, 0.0, -1067.0, -714.0], "policy_predator_policy_reward": [355.0, 150.0, 130.0, 135.0, 0.0, 490.0, 95.0, 170.0, 330.0, 165.0, 585.0, 15.0, 340.0, 350.0, 95.0, 530.0, 120.0, 460.0, 520.0, 65.0, 695.0, 60.0, 290.0, 0.0, 205.0, 285.0, 740.0, 0.0, 0.0, 340.0, 170.0, 230.0, 255.0, 245.0, 90.0, 0.0, 120.0, 460.0, 480.0, 515.0, 210.0, 170.0, 430.0, 375.0, 270.0, 395.0, 460.0, 65.0, 210.0, 525.0, 170.0, 355.0, 565.0, 235.0, 335.0, 95.0, 0.0, 65.0, 320.0, 155.0, 335.0, 310.0, 445.0, 445.0, 245.0, 10.0, 75.0, 300.0, 275.0, 65.0, 150.0, 260.0, 375.0, 395.0, 150.0, 20.0, 125.0, 155.0, 290.0, 230.0, 340.0, 95.0, 5.0, 630.0, 225.0, 155.0, 195.0, 160.0, 105.0, 60.0, 860.0, 0.0, 85.0, 370.0, 60.0, 155.0, 0.0, 380.0, 5.0, 175.0, 595.0, 415.0, 40.0, 190.0, 125.0, 190.0, 395.0, 295.0, 580.0, 135.0, 300.0, 300.0, 230.0, 415.0, 190.0, 195.0, 0.0, 525.0, 5.0, 450.0, 750.0, 580.0, 620.0, 105.0, 265.0, 255.0, 520.0, 275.0, 160.0, 110.0, 350.0, 590.0, 165.0, 80.0, 365.0, 420.0, 190.0, 440.0, 120.0, 85.0, 135.0, 285.0, 375.0, 505.0, 0.0, 35.0, 240.0, 230.0, 410.0, 350.0, 65.0, 80.0, 540.0, 155.0, 260.0, 330.0, 270.0, 565.0, 10.0, 295.0, 220.0, 160.0, 290.0, 130.0, 40.0, 280.0, 120.0, 540.0, 390.0, 305.0, 215.0, 115.0, 215.0, 260.0, 175.0, 175.0, 75.0, 0.0, 520.0, 475.0, 230.0, 215.0, 225.0, 110.0, 0.0, 875.0, 390.0, 365.0, 365.0, 155.0, 0.0, 0.0, 245.0, 250.0, 0.0, 775.0, 20.0, 0.0, 440.0, 390.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6147162782634991, "mean_inference_ms": 1.4211584201827825, "mean_action_processing_ms": 0.24160733383494365, "mean_env_wait_ms": 0.1813981702624144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005705118179321289, "StateBufferConnector_ms": 0.003035306930541992, "ViewRequirementAgentConnector_ms": 0.09301626682281494}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": -1715.0, "episode_return_mean": -543.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.8523502420696, "num_env_steps_trained_throughput_per_sec": 80.8523502420696, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 49620.531, "restore_workers_time_ms": 0.023, "training_step_time_ms": 49620.438, "sample_time_ms": 1097.339, "learn_time_ms": 48503.252, "learn_throughput": 82.469, "synch_weights_time_ms": 16.297}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-33-12", "timestamp": 1723501992, "time_this_iter_s": 49.4904887676239, "time_total_s": 3426.390648126602, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a883ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3426.390648126602, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 25.792857142857144, "ram_util_percent": 80.2557142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8976467429645478, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6460292336802, "policy_loss": -0.006202662068975981, "vf_loss": 6.650935716477651, "vf_explained_var": 0.0007047478168729752, "kl": 0.008641207505933526, "entropy": 1.0029652425536404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8220965225545187, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.478945212137131, "policy_loss": -0.009024074447227928, "vf_loss": 5.486541474433173, "vf_explained_var": -0.000873412183983616, "kl": 0.007139031277565825, "entropy": 1.2835185545462149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1715.0, "episode_reward_mean": -527.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1790.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 875.0}, "policy_reward_mean": {"prey_policy": -520.89, "predator_policy": 257.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-699.0, -1076.0, -283.0, -1324.0, -389.0, -873.0, -1270.0, -495.0, -1180.0, -510.0, -55.0, -621.0, -978.0, -388.0, -252.0, -825.0, -380.0, -279.0, -149.0, -188.0, -162.0, -340.0, -556.0, -1058.0, -40.0, -155.0, -165.0, -1244.0, -376.0, -155.0, -380.0, -260.0, -1715.0, -147.0, -245.0, -440.0, -710.0, -340.0, -716.0, -254.0, -525.0, -949.0, -619.0, -749.0, -548.0, -915.0, -97.0, -937.0, -223.0, -780.0, -280.0, -175.0, -270.0, -1600.0, -35.0, -655.0, -1060.0, -151.0, -582.0, -425.0, -1364.0, -470.0, -377.0, -380.0, -319.0, -655.0, -132.0, -214.0, -435.0, -119.0, -125.0, -1205.0, -85.0, -234.0, -1644.0, -900.0, -258.0, 0.0, -433.0, -1625.0, -20.0, -951.0, -424.0, -435.0, -131.0, -54.0, -766.0, -746.0, -220.0, -1101.0, -223.0, -535.0, -648.0, -197.0, -400.0, -311.0, -535.0, -115.0, -335.0, -335.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-799.0, -480.0, -1060.0, -1011.0, -303.0, -360.0, -969.0, -1160.0, -744.0, -310.0, -670.0, -728.0, -1061.0, -944.0, 4.0, -1024.0, -875.0, -1105.0, -290.0, -650.0, -120.0, 0.0, -380.0, -716.0, -658.0, -965.0, -571.0, -707.0, -160.0, -347.0, -520.0, -680.0, -270.0, -450.0, -606.0, -83.0, -300.0, -619.0, -193.0, -165.0, -458.0, 16.0, 0.0, -860.0, -330.0, -661.0, -660.0, -1033.0, -56.0, -364.0, -419.0, -91.0, -330.0, 0.0, -494.0, -1610.0, -140.0, -691.0, -70.0, -300.0, -310.0, -450.0, -340.0, -100.0, -1095.0, -1630.0, -377.0, 0.0, -520.0, -40.0, -350.0, -780.0, -1005.0, -420.0, -310.0, -630.0, -501.0, -860.0, -539.0, -100.0, -850.0, -200.0, -572.0, -832.0, -300.0, -1649.0, -510.0, -964.0, -698.0, -370.0, -640.0, -1070.0, -320.0, -47.0, -750.0, -1127.0, -320.0, -148.0, -730.0, -835.0, -720.0, -190.0, -20.0, -360.0, -650.0, -40.0, -1240.0, -1240.0, -70.0, 0.0, -654.0, -471.0, -1090.0, -730.0, -40.0, -256.0, -1041.0, -236.0, -690.0, -325.0, -1329.0, -870.0, -450.0, -325.0, -657.0, -100.0, -100.0, -700.0, -79.0, -560.0, -60.0, -1255.0, -517.0, -310.0, -524.0, -20.0, -860.0, -50.0, -480.0, 11.0, -140.0, -60.0, -733.0, -1467.0, -430.0, -100.0, -243.0, -326.0, -789.0, -1730.0, -913.0, -742.0, -10.0, -768.0, 0.0, 0.0, -598.0, -330.0, -970.0, -1430.0, -40.0, 0.0, -1067.0, -714.0, 0.0, -879.0, -340.0, -430.0, -76.0, -110.0, 0.0, -244.0, -639.0, -762.0, -1401.0, -350.0, -320.0, -60.0, -1778.0, -358.0, 0.0, -448.0, 0.0, -1200.0, -1790.0, -8.0, -400.0, 3.0, -390.0, -720.0, -218.0, -678.0, -330.0, -655.0, -70.0, -165.0, -440.0, -350.0, -640.0, -145.0], "policy_predator_policy_reward": [120.0, 460.0, 480.0, 515.0, 210.0, 170.0, 430.0, 375.0, 270.0, 395.0, 460.0, 65.0, 210.0, 525.0, 170.0, 355.0, 565.0, 235.0, 335.0, 95.0, 0.0, 65.0, 320.0, 155.0, 335.0, 310.0, 445.0, 445.0, 245.0, 10.0, 75.0, 300.0, 275.0, 65.0, 150.0, 260.0, 375.0, 395.0, 150.0, 20.0, 125.0, 155.0, 290.0, 230.0, 340.0, 95.0, 5.0, 630.0, 225.0, 155.0, 195.0, 160.0, 105.0, 60.0, 860.0, 0.0, 85.0, 370.0, 60.0, 155.0, 0.0, 380.0, 5.0, 175.0, 595.0, 415.0, 40.0, 190.0, 125.0, 190.0, 395.0, 295.0, 580.0, 135.0, 300.0, 300.0, 230.0, 415.0, 190.0, 195.0, 0.0, 525.0, 5.0, 450.0, 750.0, 580.0, 620.0, 105.0, 265.0, 255.0, 520.0, 275.0, 160.0, 110.0, 350.0, 590.0, 165.0, 80.0, 365.0, 420.0, 190.0, 440.0, 120.0, 85.0, 135.0, 285.0, 375.0, 505.0, 0.0, 35.0, 240.0, 230.0, 410.0, 350.0, 65.0, 80.0, 540.0, 155.0, 260.0, 330.0, 270.0, 565.0, 10.0, 295.0, 220.0, 160.0, 290.0, 130.0, 40.0, 280.0, 120.0, 540.0, 390.0, 305.0, 215.0, 115.0, 215.0, 260.0, 175.0, 175.0, 75.0, 0.0, 520.0, 475.0, 230.0, 215.0, 225.0, 110.0, 0.0, 875.0, 390.0, 365.0, 365.0, 155.0, 0.0, 0.0, 245.0, 250.0, 0.0, 775.0, 20.0, 0.0, 440.0, 390.0, 350.0, 105.0, 160.0, 175.0, 55.0, 0.0, 50.0, 140.0, 440.0, 195.0, 325.0, 680.0, 80.0, 80.0, 180.0, 855.0, 160.0, 65.0, 95.0, 570.0, 355.0, 795.0, 200.0, 0.0, 465.0, 245.0, 435.0, 150.0, 285.0, 165.0, 120.0, 0.0, 250.0, 205.0, 135.0, 315.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6138701738092839, "mean_inference_ms": 1.4184337317411262, "mean_action_processing_ms": 0.24135785114869573, "mean_env_wait_ms": 0.18126755351715879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005197405815124512, "StateBufferConnector_ms": 0.0029935836791992188, "ViewRequirementAgentConnector_ms": 0.09435844421386719}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": -1715.0, "episode_return_mean": -527.03, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.69347144832922, "num_env_steps_trained_throughput_per_sec": 80.69347144832922, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 49598.669, "restore_workers_time_ms": 0.024, "training_step_time_ms": 49598.581, "sample_time_ms": 1095.658, "learn_time_ms": 48483.15, "learn_throughput": 82.503, "synch_weights_time_ms": 16.323}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-34-02", "timestamp": 1723502042, "time_this_iter_s": 49.61827778816223, "time_total_s": 3476.0089259147644, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88b2d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3476.0089259147644, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 24.938028169014085, "ram_util_percent": 81.04507042253522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.866744563283113, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.896606400404027, "policy_loss": -0.007766834263093572, "vf_loss": 5.9030179268468626, "vf_explained_var": 0.00047866140723859193, "kl": 0.009035406029494769, "entropy": 1.0153274667956842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.03201135040591, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.44023984550799, "policy_loss": -0.009489119047220185, "vf_loss": 5.448085404703857, "vf_explained_var": -0.0008062917719442378, "kl": 0.008217863177017263, "entropy": 1.2346259169477634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1715.0, "episode_reward_mean": -487.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1790.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 875.0}, "policy_reward_mean": {"prey_policy": -495.88, "predator_policy": 252.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149.0, -188.0, -162.0, -340.0, -556.0, -1058.0, -40.0, -155.0, -165.0, -1244.0, -376.0, -155.0, -380.0, -260.0, -1715.0, -147.0, -245.0, -440.0, -710.0, -340.0, -716.0, -254.0, -525.0, -949.0, -619.0, -749.0, -548.0, -915.0, -97.0, -937.0, -223.0, -780.0, -280.0, -175.0, -270.0, -1600.0, -35.0, -655.0, -1060.0, -151.0, -582.0, -425.0, -1364.0, -470.0, -377.0, -380.0, -319.0, -655.0, -132.0, -214.0, -435.0, -119.0, -125.0, -1205.0, -85.0, -234.0, -1644.0, -900.0, -258.0, 0.0, -433.0, -1625.0, -20.0, -951.0, -424.0, -435.0, -131.0, -54.0, -766.0, -746.0, -220.0, -1101.0, -223.0, -535.0, -648.0, -197.0, -400.0, -311.0, -535.0, -115.0, -335.0, -335.0, -411.0, -381.0, -217.0, -426.0, -535.0, -290.0, -505.0, -100.0, -595.0, -771.0, -295.0, -149.0, -400.0, -84.0, -376.0, -509.0, -422.0, -1484.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-300.0, -619.0, -193.0, -165.0, -458.0, 16.0, 0.0, -860.0, -330.0, -661.0, -660.0, -1033.0, -56.0, -364.0, -419.0, -91.0, -330.0, 0.0, -494.0, -1610.0, -140.0, -691.0, -70.0, -300.0, -310.0, -450.0, -340.0, -100.0, -1095.0, -1630.0, -377.0, 0.0, -520.0, -40.0, -350.0, -780.0, -1005.0, -420.0, -310.0, -630.0, -501.0, -860.0, -539.0, -100.0, -850.0, -200.0, -572.0, -832.0, -300.0, -1649.0, -510.0, -964.0, -698.0, -370.0, -640.0, -1070.0, -320.0, -47.0, -750.0, -1127.0, -320.0, -148.0, -730.0, -835.0, -720.0, -190.0, -20.0, -360.0, -650.0, -40.0, -1240.0, -1240.0, -70.0, 0.0, -654.0, -471.0, -1090.0, -730.0, -40.0, -256.0, -1041.0, -236.0, -690.0, -325.0, -1329.0, -870.0, -450.0, -325.0, -657.0, -100.0, -100.0, -700.0, -79.0, -560.0, -60.0, -1255.0, -517.0, -310.0, -524.0, -20.0, -860.0, -50.0, -480.0, 11.0, -140.0, -60.0, -733.0, -1467.0, -430.0, -100.0, -243.0, -326.0, -789.0, -1730.0, -913.0, -742.0, -10.0, -768.0, 0.0, 0.0, -598.0, -330.0, -970.0, -1430.0, -40.0, 0.0, -1067.0, -714.0, 0.0, -879.0, -340.0, -430.0, -76.0, -110.0, 0.0, -244.0, -639.0, -762.0, -1401.0, -350.0, -320.0, -60.0, -1778.0, -358.0, 0.0, -448.0, 0.0, -1200.0, -1790.0, -8.0, -400.0, 3.0, -390.0, -720.0, -218.0, -678.0, -330.0, -655.0, -70.0, -165.0, -440.0, -350.0, -640.0, -145.0, -309.0, -542.0, -240.0, -506.0, -162.0, -470.0, 0.0, -961.0, -220.0, -850.0, -70.0, -740.0, -100.0, -1010.0, -110.0, -450.0, -780.0, -220.0, -170.0, -1356.0, -620.0, -220.0, -310.0, 6.0, -320.0, -820.0, -134.0, -20.0, -250.0, -691.0, -790.0, -404.0, -320.0, -457.0, -1157.0, -997.0], "policy_predator_policy_reward": [375.0, 395.0, 150.0, 20.0, 125.0, 155.0, 290.0, 230.0, 340.0, 95.0, 5.0, 630.0, 225.0, 155.0, 195.0, 160.0, 105.0, 60.0, 860.0, 0.0, 85.0, 370.0, 60.0, 155.0, 0.0, 380.0, 5.0, 175.0, 595.0, 415.0, 40.0, 190.0, 125.0, 190.0, 395.0, 295.0, 580.0, 135.0, 300.0, 300.0, 230.0, 415.0, 190.0, 195.0, 0.0, 525.0, 5.0, 450.0, 750.0, 580.0, 620.0, 105.0, 265.0, 255.0, 520.0, 275.0, 160.0, 110.0, 350.0, 590.0, 165.0, 80.0, 365.0, 420.0, 190.0, 440.0, 120.0, 85.0, 135.0, 285.0, 375.0, 505.0, 0.0, 35.0, 240.0, 230.0, 410.0, 350.0, 65.0, 80.0, 540.0, 155.0, 260.0, 330.0, 270.0, 565.0, 10.0, 295.0, 220.0, 160.0, 290.0, 130.0, 40.0, 280.0, 120.0, 540.0, 390.0, 305.0, 215.0, 115.0, 215.0, 260.0, 175.0, 175.0, 75.0, 0.0, 520.0, 475.0, 230.0, 215.0, 225.0, 110.0, 0.0, 875.0, 390.0, 365.0, 365.0, 155.0, 0.0, 0.0, 245.0, 250.0, 0.0, 775.0, 20.0, 0.0, 440.0, 390.0, 350.0, 105.0, 160.0, 175.0, 55.0, 0.0, 50.0, 140.0, 440.0, 195.0, 325.0, 680.0, 80.0, 80.0, 180.0, 855.0, 160.0, 65.0, 95.0, 570.0, 355.0, 795.0, 200.0, 0.0, 465.0, 245.0, 435.0, 150.0, 285.0, 165.0, 120.0, 0.0, 250.0, 205.0, 135.0, 315.0, 255.0, 185.0, 200.0, 165.0, 195.0, 220.0, 305.0, 230.0, 305.0, 230.0, 275.0, 245.0, 300.0, 305.0, 225.0, 235.0, 125.0, 280.0, 115.0, 640.0, 325.0, 220.0, 50.0, 105.0, 275.0, 465.0, 70.0, 0.0, 125.0, 440.0, 225.0, 460.0, 320.0, 35.0, 500.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6132593025554872, "mean_inference_ms": 1.416468457551352, "mean_action_processing_ms": 0.24119195563230617, "mean_env_wait_ms": 0.18117312331405608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005130767822265625, "StateBufferConnector_ms": 0.003044605255126953, "ViewRequirementAgentConnector_ms": 0.09730362892150879}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": -1715.0, "episode_return_mean": -487.76, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.4313484827282, "num_env_steps_trained_throughput_per_sec": 80.4313484827282, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 49765.302, "restore_workers_time_ms": 0.023, "training_step_time_ms": 49765.215, "sample_time_ms": 1097.922, "learn_time_ms": 48647.632, "learn_throughput": 82.224, "synch_weights_time_ms": 16.063}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-34-51", "timestamp": 1723502091, "time_this_iter_s": 49.78796577453613, "time_total_s": 3525.7968916893005, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aadfe0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3525.7968916893005, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 24.705633802816898, "ram_util_percent": 81.78450704225352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8278000175322175, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.114658372364347, "policy_loss": -0.0069083491750504995, "vf_loss": 5.120511483263086, "vf_explained_var": -0.00032897727199332423, "kl": 0.007034935964882395, "entropy": 1.0081258342379615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.084704062326875, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.183501695325135, "policy_loss": -0.010361399057828796, "vf_loss": 4.1920152221407205, "vf_explained_var": -0.0009246303290917129, "kl": 0.00923932968500958, "entropy": 1.2185929490144922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1644.0, "episode_reward_mean": -467.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1790.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 11.0, "predator_policy": 875.0}, "policy_reward_mean": {"prey_policy": -482.78, "predator_policy": 248.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-525.0, -949.0, -619.0, -749.0, -548.0, -915.0, -97.0, -937.0, -223.0, -780.0, -280.0, -175.0, -270.0, -1600.0, -35.0, -655.0, -1060.0, -151.0, -582.0, -425.0, -1364.0, -470.0, -377.0, -380.0, -319.0, -655.0, -132.0, -214.0, -435.0, -119.0, -125.0, -1205.0, -85.0, -234.0, -1644.0, -900.0, -258.0, 0.0, -433.0, -1625.0, -20.0, -951.0, -424.0, -435.0, -131.0, -54.0, -766.0, -746.0, -220.0, -1101.0, -223.0, -535.0, -648.0, -197.0, -400.0, -311.0, -535.0, -115.0, -335.0, -335.0, -411.0, -381.0, -217.0, -426.0, -535.0, -290.0, -505.0, -100.0, -595.0, -771.0, -295.0, -149.0, -400.0, -84.0, -376.0, -509.0, -422.0, -1484.0, -395.0, -268.0, -277.0, -85.0, -785.0, -135.0, -205.0, -234.0, -88.0, -326.0, -543.0, -85.0, -255.0, -155.0, -170.0, -428.0, -493.0, -328.0, -225.0, -1255.0, -880.0, -180.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-850.0, -200.0, -572.0, -832.0, -300.0, -1649.0, -510.0, -964.0, -698.0, -370.0, -640.0, -1070.0, -320.0, -47.0, -750.0, -1127.0, -320.0, -148.0, -730.0, -835.0, -720.0, -190.0, -20.0, -360.0, -650.0, -40.0, -1240.0, -1240.0, -70.0, 0.0, -654.0, -471.0, -1090.0, -730.0, -40.0, -256.0, -1041.0, -236.0, -690.0, -325.0, -1329.0, -870.0, -450.0, -325.0, -657.0, -100.0, -100.0, -700.0, -79.0, -560.0, -60.0, -1255.0, -517.0, -310.0, -524.0, -20.0, -860.0, -50.0, -480.0, 11.0, -140.0, -60.0, -733.0, -1467.0, -430.0, -100.0, -243.0, -326.0, -789.0, -1730.0, -913.0, -742.0, -10.0, -768.0, 0.0, 0.0, -598.0, -330.0, -970.0, -1430.0, -40.0, 0.0, -1067.0, -714.0, 0.0, -879.0, -340.0, -430.0, -76.0, -110.0, 0.0, -244.0, -639.0, -762.0, -1401.0, -350.0, -320.0, -60.0, -1778.0, -358.0, 0.0, -448.0, 0.0, -1200.0, -1790.0, -8.0, -400.0, 3.0, -390.0, -720.0, -218.0, -678.0, -330.0, -655.0, -70.0, -165.0, -440.0, -350.0, -640.0, -145.0, -309.0, -542.0, -240.0, -506.0, -162.0, -470.0, 0.0, -961.0, -220.0, -850.0, -70.0, -740.0, -100.0, -1010.0, -110.0, -450.0, -780.0, -220.0, -170.0, -1356.0, -620.0, -220.0, -310.0, 6.0, -320.0, -820.0, -134.0, -20.0, -250.0, -691.0, -790.0, -404.0, -320.0, -457.0, -1157.0, -997.0, -590.0, -240.0, -340.0, -423.0, -170.0, -392.0, -10.0, -160.0, -1480.0, -330.0, -30.0, -310.0, -170.0, -200.0, -534.0, -70.0, -233.0, -20.0, -614.0, -362.0, -648.0, -310.0, -130.0, -20.0, -360.0, -120.0, -530.0, 0.0, 0.0, -950.0, -290.0, -1093.0, -138.0, -1150.0, -8.0, -650.0, -10.0, -480.0, -980.0, -1170.0, -950.0, -480.0, -30.0, -390.0], "policy_predator_policy_reward": [0.0, 525.0, 5.0, 450.0, 750.0, 580.0, 620.0, 105.0, 265.0, 255.0, 520.0, 275.0, 160.0, 110.0, 350.0, 590.0, 165.0, 80.0, 365.0, 420.0, 190.0, 440.0, 120.0, 85.0, 135.0, 285.0, 375.0, 505.0, 0.0, 35.0, 240.0, 230.0, 410.0, 350.0, 65.0, 80.0, 540.0, 155.0, 260.0, 330.0, 270.0, 565.0, 10.0, 295.0, 220.0, 160.0, 290.0, 130.0, 40.0, 280.0, 120.0, 540.0, 390.0, 305.0, 215.0, 115.0, 215.0, 260.0, 175.0, 175.0, 75.0, 0.0, 520.0, 475.0, 230.0, 215.0, 225.0, 110.0, 0.0, 875.0, 390.0, 365.0, 365.0, 155.0, 0.0, 0.0, 245.0, 250.0, 0.0, 775.0, 20.0, 0.0, 440.0, 390.0, 350.0, 105.0, 160.0, 175.0, 55.0, 0.0, 50.0, 140.0, 440.0, 195.0, 325.0, 680.0, 80.0, 80.0, 180.0, 855.0, 160.0, 65.0, 95.0, 570.0, 355.0, 795.0, 200.0, 0.0, 465.0, 245.0, 435.0, 150.0, 285.0, 165.0, 120.0, 0.0, 250.0, 205.0, 135.0, 315.0, 255.0, 185.0, 200.0, 165.0, 195.0, 220.0, 305.0, 230.0, 305.0, 230.0, 275.0, 245.0, 300.0, 305.0, 225.0, 235.0, 125.0, 280.0, 115.0, 640.0, 325.0, 220.0, 50.0, 105.0, 275.0, 465.0, 70.0, 0.0, 125.0, 440.0, 225.0, 460.0, 320.0, 35.0, 500.0, 170.0, 150.0, 285.0, 295.0, 200.0, 185.0, 100.0, 75.0, 10.0, 265.0, 760.0, 135.0, 70.0, 80.0, 85.0, 220.0, 150.0, 60.0, 105.0, 370.0, 280.0, 235.0, 180.0, 0.0, 65.0, 105.0, 120.0, 165.0, 210.0, 410.0, 370.0, 450.0, 505.0, 515.0, 280.0, 205.0, 125.0, 225.0, 40.0, 115.0, 780.0, 280.0, 270.0, 135.0, 105.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6126821143332944, "mean_inference_ms": 1.4151031207740612, "mean_action_processing_ms": 0.24112168384949567, "mean_env_wait_ms": 0.181201175316883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004374384880065918, "StateBufferConnector_ms": 0.003052353858947754, "ViewRequirementAgentConnector_ms": 0.09887981414794922}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": -1644.0, "episode_return_mean": -467.76, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.62364916047214, "num_env_steps_trained_throughput_per_sec": 81.62364916047214, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 49826.656, "restore_workers_time_ms": 0.023, "training_step_time_ms": 49826.57, "sample_time_ms": 1118.822, "learn_time_ms": 48686.85, "learn_throughput": 82.158, "synch_weights_time_ms": 16.331}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-35-41", "timestamp": 1723502141, "time_this_iter_s": 49.02996110916138, "time_total_s": 3574.826852798462, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aae34ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3574.826852798462, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 24.518840579710147, "ram_util_percent": 80.78115942028985}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7845402002334594, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4723655045978608, "policy_loss": -0.006831565893639529, "vf_loss": 3.4780995131800414, "vf_explained_var": -0.0010123104960830123, "kl": 0.007317020942274491, "entropy": 0.9695624775987454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2733677735088995, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.569391893709778, "policy_loss": -0.010123438029254358, "vf_loss": 3.5778462296440487, "vf_explained_var": -0.0028519676475928573, "kl": 0.008345525236537378, "entropy": 1.1797120968500774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 9.0, "episode_reward_min": -1655.0, "episode_reward_mean": -397.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1790.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 11.0, "predator_policy": 875.0}, "policy_reward_mean": {"prey_policy": -421.09, "predator_policy": 222.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-380.0, -319.0, -655.0, -132.0, -214.0, -435.0, -119.0, -125.0, -1205.0, -85.0, -234.0, -1644.0, -900.0, -258.0, 0.0, -433.0, -1625.0, -20.0, -951.0, -424.0, -435.0, -131.0, -54.0, -766.0, -746.0, -220.0, -1101.0, -223.0, -535.0, -648.0, -197.0, -400.0, -311.0, -535.0, -115.0, -335.0, -335.0, -411.0, -381.0, -217.0, -426.0, -535.0, -290.0, -505.0, -100.0, -595.0, -771.0, -295.0, -149.0, -400.0, -84.0, -376.0, -509.0, -422.0, -1484.0, -395.0, -268.0, -277.0, -85.0, -785.0, -135.0, -205.0, -234.0, -88.0, -326.0, -543.0, -85.0, -255.0, -155.0, -170.0, -428.0, -493.0, -328.0, -225.0, -1255.0, -880.0, -180.0, -175.0, -291.0, -1655.0, -375.0, -255.0, -525.0, -365.0, -165.0, -65.0, -169.0, -163.0, 0.0, 0.0, -70.0, -245.0, -210.0, -557.0, -331.0, -450.0, -91.0, -225.0, -430.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-100.0, -700.0, -79.0, -560.0, -60.0, -1255.0, -517.0, -310.0, -524.0, -20.0, -860.0, -50.0, -480.0, 11.0, -140.0, -60.0, -733.0, -1467.0, -430.0, -100.0, -243.0, -326.0, -789.0, -1730.0, -913.0, -742.0, -10.0, -768.0, 0.0, 0.0, -598.0, -330.0, -970.0, -1430.0, -40.0, 0.0, -1067.0, -714.0, 0.0, -879.0, -340.0, -430.0, -76.0, -110.0, 0.0, -244.0, -639.0, -762.0, -1401.0, -350.0, -320.0, -60.0, -1778.0, -358.0, 0.0, -448.0, 0.0, -1200.0, -1790.0, -8.0, -400.0, 3.0, -390.0, -720.0, -218.0, -678.0, -330.0, -655.0, -70.0, -165.0, -440.0, -350.0, -640.0, -145.0, -309.0, -542.0, -240.0, -506.0, -162.0, -470.0, 0.0, -961.0, -220.0, -850.0, -70.0, -740.0, -100.0, -1010.0, -110.0, -450.0, -780.0, -220.0, -170.0, -1356.0, -620.0, -220.0, -310.0, 6.0, -320.0, -820.0, -134.0, -20.0, -250.0, -691.0, -790.0, -404.0, -320.0, -457.0, -1157.0, -997.0, -590.0, -240.0, -340.0, -423.0, -170.0, -392.0, -10.0, -160.0, -1480.0, -330.0, -30.0, -310.0, -170.0, -200.0, -534.0, -70.0, -233.0, -20.0, -614.0, -362.0, -648.0, -310.0, -130.0, -20.0, -360.0, -120.0, -530.0, 0.0, 0.0, -950.0, -290.0, -1093.0, -138.0, -1150.0, -8.0, -650.0, -10.0, -480.0, -980.0, -1170.0, -950.0, -480.0, -30.0, -390.0, -180.0, -140.0, -180.0, -401.0, -1640.0, -980.0, -443.0, -297.0, -460.0, -110.0, -610.0, -440.0, -290.0, -370.0, -300.0, -190.0, -130.0, 0.0, -219.0, -100.0, -30.0, -588.0, 0.0, 0.0, 0.0, 0.0, -40.0, -230.0, -130.0, -450.0, -200.0, -530.0, -370.0, -827.0, -660.0, -171.0, -400.0, -530.0, -136.0, -30.0, -175.0, -590.0, -320.0, -510.0, 0.0, 9.0], "policy_predator_policy_reward": [290.0, 130.0, 40.0, 280.0, 120.0, 540.0, 390.0, 305.0, 215.0, 115.0, 215.0, 260.0, 175.0, 175.0, 75.0, 0.0, 520.0, 475.0, 230.0, 215.0, 225.0, 110.0, 0.0, 875.0, 390.0, 365.0, 365.0, 155.0, 0.0, 0.0, 245.0, 250.0, 0.0, 775.0, 20.0, 0.0, 440.0, 390.0, 350.0, 105.0, 160.0, 175.0, 55.0, 0.0, 50.0, 140.0, 440.0, 195.0, 325.0, 680.0, 80.0, 80.0, 180.0, 855.0, 160.0, 65.0, 95.0, 570.0, 355.0, 795.0, 200.0, 0.0, 465.0, 245.0, 435.0, 150.0, 285.0, 165.0, 120.0, 0.0, 250.0, 205.0, 135.0, 315.0, 255.0, 185.0, 200.0, 165.0, 195.0, 220.0, 305.0, 230.0, 305.0, 230.0, 275.0, 245.0, 300.0, 305.0, 225.0, 235.0, 125.0, 280.0, 115.0, 640.0, 325.0, 220.0, 50.0, 105.0, 275.0, 465.0, 70.0, 0.0, 125.0, 440.0, 225.0, 460.0, 320.0, 35.0, 500.0, 170.0, 150.0, 285.0, 295.0, 200.0, 185.0, 100.0, 75.0, 10.0, 265.0, 760.0, 135.0, 70.0, 80.0, 85.0, 220.0, 150.0, 60.0, 105.0, 370.0, 280.0, 235.0, 180.0, 0.0, 65.0, 105.0, 120.0, 165.0, 210.0, 410.0, 370.0, 450.0, 505.0, 515.0, 280.0, 205.0, 125.0, 225.0, 40.0, 115.0, 780.0, 280.0, 270.0, 135.0, 105.0, 20.0, 125.0, 140.0, 150.0, 100.0, 865.0, 315.0, 50.0, 190.0, 125.0, 315.0, 210.0, 210.0, 85.0, 150.0, 175.0, 65.0, 0.0, 150.0, 0.0, 205.0, 250.0, 0.0, 0.0, 0.0, 0.0, 90.0, 110.0, 110.0, 225.0, 245.0, 275.0, 255.0, 385.0, 230.0, 270.0, 210.0, 270.0, 0.0, 75.0, 345.0, 195.0, 75.0, 325.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6121375795955555, "mean_inference_ms": 1.4136569851460925, "mean_action_processing_ms": 0.24100267812645193, "mean_env_wait_ms": 0.18123930029665902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003767251968383789, "StateBufferConnector_ms": 0.003031015396118164, "ViewRequirementAgentConnector_ms": 0.0986027717590332}, "num_episodes": 23, "episode_return_max": 9.0, "episode_return_min": -1655.0, "episode_return_mean": -397.93, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.4074784612234, "num_env_steps_trained_throughput_per_sec": 82.4074784612234, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 49821.565, "restore_workers_time_ms": 0.023, "training_step_time_ms": 49821.479, "sample_time_ms": 1104.968, "learn_time_ms": 48696.384, "learn_throughput": 82.142, "synch_weights_time_ms": 15.669}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-36-29", "timestamp": 1723502189, "time_this_iter_s": 48.58822798728943, "time_total_s": 3623.4150807857513, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aae06f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3623.4150807857513, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 23.24, "ram_util_percent": 80.93857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8402913787692943, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.7612634989319655, "policy_loss": -0.006084245725204705, "vf_loss": 4.766242303293218, "vf_explained_var": -0.0017248527713553616, "kl": 0.007369633374106516, "entropy": 0.9585602763153258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.165847775923512, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.945122409749914, "policy_loss": -0.009344848510242565, "vf_loss": 3.9529482296534946, "vf_explained_var": -0.008224085840598616, "kl": 0.00759509379405649, "entropy": 1.191140795258618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 9.0, "episode_reward_min": -1655.0, "episode_reward_mean": -360.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1790.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 9.0, "predator_policy": 865.0}, "policy_reward_mean": {"prey_policy": -388.765, "predator_policy": 208.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-951.0, -424.0, -435.0, -131.0, -54.0, -766.0, -746.0, -220.0, -1101.0, -223.0, -535.0, -648.0, -197.0, -400.0, -311.0, -535.0, -115.0, -335.0, -335.0, -411.0, -381.0, -217.0, -426.0, -535.0, -290.0, -505.0, -100.0, -595.0, -771.0, -295.0, -149.0, -400.0, -84.0, -376.0, -509.0, -422.0, -1484.0, -395.0, -268.0, -277.0, -85.0, -785.0, -135.0, -205.0, -234.0, -88.0, -326.0, -543.0, -85.0, -255.0, -155.0, -170.0, -428.0, -493.0, -328.0, -225.0, -1255.0, -880.0, -180.0, -175.0, -291.0, -1655.0, -375.0, -255.0, -525.0, -365.0, -165.0, -65.0, -169.0, -163.0, 0.0, 0.0, -70.0, -245.0, -210.0, -557.0, -331.0, -450.0, -91.0, -225.0, -430.0, 9.0, -26.0, -296.0, -155.0, -185.0, -110.0, -297.0, -340.0, -719.0, -385.0, -216.0, -90.0, -284.0, -321.0, -300.0, -167.0, -269.0, -478.0, -390.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1067.0, -714.0, 0.0, -879.0, -340.0, -430.0, -76.0, -110.0, 0.0, -244.0, -639.0, -762.0, -1401.0, -350.0, -320.0, -60.0, -1778.0, -358.0, 0.0, -448.0, 0.0, -1200.0, -1790.0, -8.0, -400.0, 3.0, -390.0, -720.0, -218.0, -678.0, -330.0, -655.0, -70.0, -165.0, -440.0, -350.0, -640.0, -145.0, -309.0, -542.0, -240.0, -506.0, -162.0, -470.0, 0.0, -961.0, -220.0, -850.0, -70.0, -740.0, -100.0, -1010.0, -110.0, -450.0, -780.0, -220.0, -170.0, -1356.0, -620.0, -220.0, -310.0, 6.0, -320.0, -820.0, -134.0, -20.0, -250.0, -691.0, -790.0, -404.0, -320.0, -457.0, -1157.0, -997.0, -590.0, -240.0, -340.0, -423.0, -170.0, -392.0, -10.0, -160.0, -1480.0, -330.0, -30.0, -310.0, -170.0, -200.0, -534.0, -70.0, -233.0, -20.0, -614.0, -362.0, -648.0, -310.0, -130.0, -20.0, -360.0, -120.0, -530.0, 0.0, 0.0, -950.0, -290.0, -1093.0, -138.0, -1150.0, -8.0, -650.0, -10.0, -480.0, -980.0, -1170.0, -950.0, -480.0, -30.0, -390.0, -180.0, -140.0, -180.0, -401.0, -1640.0, -980.0, -443.0, -297.0, -460.0, -110.0, -610.0, -440.0, -290.0, -370.0, -300.0, -190.0, -130.0, 0.0, -219.0, -100.0, -30.0, -588.0, 0.0, 0.0, 0.0, 0.0, -40.0, -230.0, -130.0, -450.0, -200.0, -530.0, -370.0, -827.0, -660.0, -171.0, -400.0, -530.0, -136.0, -30.0, -175.0, -590.0, -320.0, -510.0, 0.0, 9.0, 0.0, -56.0, -516.0, -120.0, -150.0, -160.0, -290.0, -150.0, -100.0, -60.0, -647.0, -210.0, -80.0, -800.0, -1238.0, -236.0, -460.0, -260.0, -90.0, -286.0, -41.0, -104.0, -526.0, -88.0, -627.0, -189.0, -20.0, -640.0, -140.0, -237.0, 1.0, -540.0, -373.0, -385.0, -580.0, -460.0], "policy_predator_policy_reward": [440.0, 390.0, 350.0, 105.0, 160.0, 175.0, 55.0, 0.0, 50.0, 140.0, 440.0, 195.0, 325.0, 680.0, 80.0, 80.0, 180.0, 855.0, 160.0, 65.0, 95.0, 570.0, 355.0, 795.0, 200.0, 0.0, 465.0, 245.0, 435.0, 150.0, 285.0, 165.0, 120.0, 0.0, 250.0, 205.0, 135.0, 315.0, 255.0, 185.0, 200.0, 165.0, 195.0, 220.0, 305.0, 230.0, 305.0, 230.0, 275.0, 245.0, 300.0, 305.0, 225.0, 235.0, 125.0, 280.0, 115.0, 640.0, 325.0, 220.0, 50.0, 105.0, 275.0, 465.0, 70.0, 0.0, 125.0, 440.0, 225.0, 460.0, 320.0, 35.0, 500.0, 170.0, 150.0, 285.0, 295.0, 200.0, 185.0, 100.0, 75.0, 10.0, 265.0, 760.0, 135.0, 70.0, 80.0, 85.0, 220.0, 150.0, 60.0, 105.0, 370.0, 280.0, 235.0, 180.0, 0.0, 65.0, 105.0, 120.0, 165.0, 210.0, 410.0, 370.0, 450.0, 505.0, 515.0, 280.0, 205.0, 125.0, 225.0, 40.0, 115.0, 780.0, 280.0, 270.0, 135.0, 105.0, 20.0, 125.0, 140.0, 150.0, 100.0, 865.0, 315.0, 50.0, 190.0, 125.0, 315.0, 210.0, 210.0, 85.0, 150.0, 175.0, 65.0, 0.0, 150.0, 0.0, 205.0, 250.0, 0.0, 0.0, 0.0, 0.0, 90.0, 110.0, 110.0, 225.0, 245.0, 275.0, 255.0, 385.0, 230.0, 270.0, 210.0, 270.0, 0.0, 75.0, 345.0, 195.0, 75.0, 325.0, 0.0, 0.0, 30.0, 0.0, 210.0, 130.0, 25.0, 130.0, 70.0, 185.0, 10.0, 40.0, 330.0, 230.0, 370.0, 170.0, 295.0, 460.0, 100.0, 235.0, 160.0, 0.0, 55.0, 0.0, 180.0, 150.0, 280.0, 215.0, 260.0, 100.0, 145.0, 65.0, 60.0, 210.0, 195.0, 85.0, 270.0, 380.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6115929133382814, "mean_inference_ms": 1.4123979195375165, "mean_action_processing_ms": 0.2408933546187592, "mean_env_wait_ms": 0.1812379226351474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735780715942383, "StateBufferConnector_ms": 0.00298154354095459, "ViewRequirementAgentConnector_ms": 0.09777426719665527}, "num_episodes": 18, "episode_return_max": 9.0, "episode_return_min": -1655.0, "episode_return_mean": -360.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.31840976117245, "num_env_steps_trained_throughput_per_sec": 78.31840976117245, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 49877.474, "restore_workers_time_ms": 0.023, "training_step_time_ms": 49877.392, "sample_time_ms": 1104.862, "learn_time_ms": 48752.445, "learn_throughput": 82.047, "synch_weights_time_ms": 15.991}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-37-20", "timestamp": 1723502240, "time_this_iter_s": 51.1175422668457, "time_total_s": 3674.532623052597, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8833ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3674.532623052597, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 26.980555555555554, "ram_util_percent": 81.87222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8103903675363178, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8673289937317055, "policy_loss": -0.006035651027831056, "vf_loss": 3.8722681955054954, "vf_explained_var": -0.0014026818767426505, "kl": 0.007309626967646486, "entropy": 0.9531965558175688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.229708587397974, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.99328044041124, "policy_loss": -0.007916439940571469, "vf_loss": 3.999981963823712, "vf_explained_var": -0.009709365689565265, "kl": 0.006074545488199981, "entropy": 1.1818971085800696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 9.0, "episode_reward_min": -1655.0, "episode_reward_mean": -324.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1640.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 9.0, "predator_policy": 865.0}, "policy_reward_mean": {"prey_policy": -354.38, "predator_policy": 192.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335.0, -411.0, -381.0, -217.0, -426.0, -535.0, -290.0, -505.0, -100.0, -595.0, -771.0, -295.0, -149.0, -400.0, -84.0, -376.0, -509.0, -422.0, -1484.0, -395.0, -268.0, -277.0, -85.0, -785.0, -135.0, -205.0, -234.0, -88.0, -326.0, -543.0, -85.0, -255.0, -155.0, -170.0, -428.0, -493.0, -328.0, -225.0, -1255.0, -880.0, -180.0, -175.0, -291.0, -1655.0, -375.0, -255.0, -525.0, -365.0, -165.0, -65.0, -169.0, -163.0, 0.0, 0.0, -70.0, -245.0, -210.0, -557.0, -331.0, -450.0, -91.0, -225.0, -430.0, 9.0, -26.0, -296.0, -155.0, -185.0, -110.0, -297.0, -340.0, -719.0, -385.0, -216.0, -90.0, -284.0, -321.0, -300.0, -167.0, -269.0, -478.0, -390.0, -215.0, -184.0, -595.0, -33.0, -245.0, -335.0, -482.0, -304.0, -189.0, -305.0, -205.0, -140.0, -100.0, -318.0, -125.0, -343.0, -333.0, -94.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-640.0, -145.0, -309.0, -542.0, -240.0, -506.0, -162.0, -470.0, 0.0, -961.0, -220.0, -850.0, -70.0, -740.0, -100.0, -1010.0, -110.0, -450.0, -780.0, -220.0, -170.0, -1356.0, -620.0, -220.0, -310.0, 6.0, -320.0, -820.0, -134.0, -20.0, -250.0, -691.0, -790.0, -404.0, -320.0, -457.0, -1157.0, -997.0, -590.0, -240.0, -340.0, -423.0, -170.0, -392.0, -10.0, -160.0, -1480.0, -330.0, -30.0, -310.0, -170.0, -200.0, -534.0, -70.0, -233.0, -20.0, -614.0, -362.0, -648.0, -310.0, -130.0, -20.0, -360.0, -120.0, -530.0, 0.0, 0.0, -950.0, -290.0, -1093.0, -138.0, -1150.0, -8.0, -650.0, -10.0, -480.0, -980.0, -1170.0, -950.0, -480.0, -30.0, -390.0, -180.0, -140.0, -180.0, -401.0, -1640.0, -980.0, -443.0, -297.0, -460.0, -110.0, -610.0, -440.0, -290.0, -370.0, -300.0, -190.0, -130.0, 0.0, -219.0, -100.0, -30.0, -588.0, 0.0, 0.0, 0.0, 0.0, -40.0, -230.0, -130.0, -450.0, -200.0, -530.0, -370.0, -827.0, -660.0, -171.0, -400.0, -530.0, -136.0, -30.0, -175.0, -590.0, -320.0, -510.0, 0.0, 9.0, 0.0, -56.0, -516.0, -120.0, -150.0, -160.0, -290.0, -150.0, -100.0, -60.0, -647.0, -210.0, -80.0, -800.0, -1238.0, -236.0, -460.0, -260.0, -90.0, -286.0, -41.0, -104.0, -526.0, -88.0, -627.0, -189.0, -20.0, -640.0, -140.0, -237.0, 1.0, -540.0, -373.0, -385.0, -580.0, -460.0, -210.0, -540.0, -229.0, -420.0, -1028.0, -202.0, 8.0, -86.0, -95.0, -415.0, -760.0, 0.0, -760.0, -207.0, -280.0, -279.0, -379.0, 0.0, -20.0, -820.0, -165.0, -210.0, -10.0, -260.0, -320.0, 0.0, -678.0, -170.0, -304.0, 4.0, -258.0, -360.0, -780.0, -48.0, -179.0, -50.0], "policy_predator_policy_reward": [135.0, 315.0, 255.0, 185.0, 200.0, 165.0, 195.0, 220.0, 305.0, 230.0, 305.0, 230.0, 275.0, 245.0, 300.0, 305.0, 225.0, 235.0, 125.0, 280.0, 115.0, 640.0, 325.0, 220.0, 50.0, 105.0, 275.0, 465.0, 70.0, 0.0, 125.0, 440.0, 225.0, 460.0, 320.0, 35.0, 500.0, 170.0, 150.0, 285.0, 295.0, 200.0, 185.0, 100.0, 75.0, 10.0, 265.0, 760.0, 135.0, 70.0, 80.0, 85.0, 220.0, 150.0, 60.0, 105.0, 370.0, 280.0, 235.0, 180.0, 0.0, 65.0, 105.0, 120.0, 165.0, 210.0, 410.0, 370.0, 450.0, 505.0, 515.0, 280.0, 205.0, 125.0, 225.0, 40.0, 115.0, 780.0, 280.0, 270.0, 135.0, 105.0, 20.0, 125.0, 140.0, 150.0, 100.0, 865.0, 315.0, 50.0, 190.0, 125.0, 315.0, 210.0, 210.0, 85.0, 150.0, 175.0, 65.0, 0.0, 150.0, 0.0, 205.0, 250.0, 0.0, 0.0, 0.0, 0.0, 90.0, 110.0, 110.0, 225.0, 245.0, 275.0, 255.0, 385.0, 230.0, 270.0, 210.0, 270.0, 0.0, 75.0, 345.0, 195.0, 75.0, 325.0, 0.0, 0.0, 30.0, 0.0, 210.0, 130.0, 25.0, 130.0, 70.0, 185.0, 10.0, 40.0, 330.0, 230.0, 370.0, 170.0, 295.0, 460.0, 100.0, 235.0, 160.0, 0.0, 55.0, 0.0, 180.0, 150.0, 280.0, 215.0, 260.0, 100.0, 145.0, 65.0, 60.0, 210.0, 195.0, 85.0, 270.0, 380.0, 215.0, 320.0, 265.0, 200.0, 220.0, 415.0, 45.0, 0.0, 160.0, 105.0, 190.0, 235.0, 365.0, 120.0, 160.0, 95.0, 0.0, 190.0, 205.0, 330.0, 35.0, 135.0, 0.0, 130.0, 115.0, 105.0, 105.0, 425.0, 65.0, 110.0, 10.0, 265.0, 175.0, 320.0, 135.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6111353701512894, "mean_inference_ms": 1.4111186965097504, "mean_action_processing_ms": 0.24076907238618156, "mean_env_wait_ms": 0.18118773620433615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003771543502807617, "StateBufferConnector_ms": 0.003025531768798828, "ViewRequirementAgentConnector_ms": 0.09680545330047607}, "num_episodes": 18, "episode_return_max": 9.0, "episode_return_min": -1655.0, "episode_return_mean": -324.56, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.81068921810432, "num_env_steps_trained_throughput_per_sec": 79.81068921810432, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 49668.37, "restore_workers_time_ms": 0.023, "training_step_time_ms": 49668.278, "sample_time_ms": 1103.538, "learn_time_ms": 48544.888, "learn_throughput": 82.398, "synch_weights_time_ms": 15.837}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-38-10", "timestamp": 1723502290, "time_this_iter_s": 50.17145609855652, "time_total_s": 3724.7040791511536, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88b6700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3724.7040791511536, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 26.39861111111111, "ram_util_percent": 82.66111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.555396174359574, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1641714638503142, "policy_loss": -0.008237126305645144, "vf_loss": 3.1712385156167247, "vf_explained_var": -0.0004323021129325584, "kl": 0.007800478939004891, "entropy": 0.8974899817080725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.453220172376229, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9018375093974766, "policy_loss": -0.0094673606778973, "vf_loss": 2.9096752813253453, "vf_explained_var": -0.004276763194452518, "kl": 0.00814792640519569, "entropy": 1.2049273833395944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 31.0, "episode_reward_min": -1655.0, "episode_reward_mean": -289.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1640.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 25.0, "predator_policy": 865.0}, "policy_reward_mean": {"prey_policy": -315.615, "predator_policy": 171.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.0, -785.0, -135.0, -205.0, -234.0, -88.0, -326.0, -543.0, -85.0, -255.0, -155.0, -170.0, -428.0, -493.0, -328.0, -225.0, -1255.0, -880.0, -180.0, -175.0, -291.0, -1655.0, -375.0, -255.0, -525.0, -365.0, -165.0, -65.0, -169.0, -163.0, 0.0, 0.0, -70.0, -245.0, -210.0, -557.0, -331.0, -450.0, -91.0, -225.0, -430.0, 9.0, -26.0, -296.0, -155.0, -185.0, -110.0, -297.0, -340.0, -719.0, -385.0, -216.0, -90.0, -284.0, -321.0, -300.0, -167.0, -269.0, -478.0, -390.0, -215.0, -184.0, -595.0, -33.0, -245.0, -335.0, -482.0, -304.0, -189.0, -305.0, -205.0, -140.0, -100.0, -318.0, -125.0, -343.0, -333.0, -94.0, -262.0, -177.0, -327.0, -344.0, -518.0, 0.0, -345.0, 31.0, -459.0, -321.0, -350.0, -420.0, -80.0, -90.0, -735.0, -124.0, -236.0, -45.0, -87.0, -198.0, -400.0, -185.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, -160.0, -1480.0, -330.0, -30.0, -310.0, -170.0, -200.0, -534.0, -70.0, -233.0, -20.0, -614.0, -362.0, -648.0, -310.0, -130.0, -20.0, -360.0, -120.0, -530.0, 0.0, 0.0, -950.0, -290.0, -1093.0, -138.0, -1150.0, -8.0, -650.0, -10.0, -480.0, -980.0, -1170.0, -950.0, -480.0, -30.0, -390.0, -180.0, -140.0, -180.0, -401.0, -1640.0, -980.0, -443.0, -297.0, -460.0, -110.0, -610.0, -440.0, -290.0, -370.0, -300.0, -190.0, -130.0, 0.0, -219.0, -100.0, -30.0, -588.0, 0.0, 0.0, 0.0, 0.0, -40.0, -230.0, -130.0, -450.0, -200.0, -530.0, -370.0, -827.0, -660.0, -171.0, -400.0, -530.0, -136.0, -30.0, -175.0, -590.0, -320.0, -510.0, 0.0, 9.0, 0.0, -56.0, -516.0, -120.0, -150.0, -160.0, -290.0, -150.0, -100.0, -60.0, -647.0, -210.0, -80.0, -800.0, -1238.0, -236.0, -460.0, -260.0, -90.0, -286.0, -41.0, -104.0, -526.0, -88.0, -627.0, -189.0, -20.0, -640.0, -140.0, -237.0, 1.0, -540.0, -373.0, -385.0, -580.0, -460.0, -210.0, -540.0, -229.0, -420.0, -1028.0, -202.0, 8.0, -86.0, -95.0, -415.0, -760.0, 0.0, -760.0, -207.0, -280.0, -279.0, -379.0, 0.0, -20.0, -820.0, -165.0, -210.0, -10.0, -260.0, -320.0, 0.0, -678.0, -170.0, -304.0, 4.0, -258.0, -360.0, -780.0, -48.0, -179.0, -50.0, -176.0, -351.0, -432.0, -160.0, -707.0, -40.0, -319.0, -460.0, -1053.0, -70.0, 0.0, 0.0, -520.0, -160.0, 16.0, 0.0, -249.0, -420.0, -180.0, -341.0, -280.0, -280.0, -520.0, -250.0, -210.0, 25.0, -120.0, -200.0, -130.0, -1240.0, -118.0, -66.0, -356.0, -100.0, 0.0, -90.0, -93.0, -129.0, -548.0, -190.0, -840.0, -30.0, -440.0, -130.0], "policy_predator_policy_reward": [75.0, 10.0, 265.0, 760.0, 135.0, 70.0, 80.0, 85.0, 220.0, 150.0, 60.0, 105.0, 370.0, 280.0, 235.0, 180.0, 0.0, 65.0, 105.0, 120.0, 165.0, 210.0, 410.0, 370.0, 450.0, 505.0, 515.0, 280.0, 205.0, 125.0, 225.0, 40.0, 115.0, 780.0, 280.0, 270.0, 135.0, 105.0, 20.0, 125.0, 140.0, 150.0, 100.0, 865.0, 315.0, 50.0, 190.0, 125.0, 315.0, 210.0, 210.0, 85.0, 150.0, 175.0, 65.0, 0.0, 150.0, 0.0, 205.0, 250.0, 0.0, 0.0, 0.0, 0.0, 90.0, 110.0, 110.0, 225.0, 245.0, 275.0, 255.0, 385.0, 230.0, 270.0, 210.0, 270.0, 0.0, 75.0, 345.0, 195.0, 75.0, 325.0, 0.0, 0.0, 30.0, 0.0, 210.0, 130.0, 25.0, 130.0, 70.0, 185.0, 10.0, 40.0, 330.0, 230.0, 370.0, 170.0, 295.0, 460.0, 100.0, 235.0, 160.0, 0.0, 55.0, 0.0, 180.0, 150.0, 280.0, 215.0, 260.0, 100.0, 145.0, 65.0, 60.0, 210.0, 195.0, 85.0, 270.0, 380.0, 215.0, 320.0, 265.0, 200.0, 220.0, 415.0, 45.0, 0.0, 160.0, 105.0, 190.0, 235.0, 365.0, 120.0, 160.0, 95.0, 0.0, 190.0, 205.0, 330.0, 35.0, 135.0, 0.0, 130.0, 115.0, 105.0, 105.0, 425.0, 65.0, 110.0, 10.0, 265.0, 175.0, 320.0, 135.0, 0.0, 230.0, 35.0, 225.0, 190.0, 260.0, 160.0, 250.0, 185.0, 495.0, 110.0, 0.0, 0.0, 0.0, 335.0, 15.0, 0.0, 0.0, 210.0, 200.0, 0.0, 65.0, 145.0, 275.0, 75.0, 70.0, 35.0, 90.0, 140.0, 0.0, 635.0, 10.0, 50.0, 40.0, 180.0, 0.0, 45.0, 30.0, 105.0, 265.0, 275.0, 210.0, 260.0, 185.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6107449217987969, "mean_inference_ms": 1.4099091264002839, "mean_action_processing_ms": 0.24080828750903246, "mean_env_wait_ms": 0.181130160963653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035126209259033203, "StateBufferConnector_ms": 0.0030156373977661133, "ViewRequirementAgentConnector_ms": 0.09758663177490234}, "num_episodes": 22, "episode_return_max": 31.0, "episode_return_min": -1655.0, "episode_return_mean": -289.03, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.20633614879264, "num_env_steps_trained_throughput_per_sec": 82.20633614879264, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 49444.561, "restore_workers_time_ms": 0.024, "training_step_time_ms": 49444.468, "sample_time_ms": 1117.151, "learn_time_ms": 48309.113, "learn_throughput": 82.8, "synch_weights_time_ms": 14.97}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-38-59", "timestamp": 1723502339, "time_this_iter_s": 48.6887788772583, "time_total_s": 3773.392858028412, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aadfedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3773.392858028412, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 23.76521739130435, "ram_util_percent": 81.74927536231885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1654258419123906, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7450380484893837, "policy_loss": -0.007115690979525131, "vf_loss": 2.751158536805047, "vf_explained_var": 5.6842962900797524e-05, "kl": 0.006634670924490796, "entropy": 0.8658053928897494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5343459345676282, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7777904623399965, "policy_loss": -0.010770280650698594, "vf_loss": 3.787227540672141, "vf_explained_var": -0.024707300669301754, "kl": 0.006665971067033379, "entropy": 1.1937697908865712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 31.0, "episode_reward_min": -1655.0, "episode_reward_mean": -273.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1640.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 93.0, "predator_policy": 865.0}, "policy_reward_mean": {"prey_policy": -289.78, "predator_policy": 153.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.0, -175.0, -291.0, -1655.0, -375.0, -255.0, -525.0, -365.0, -165.0, -65.0, -169.0, -163.0, 0.0, 0.0, -70.0, -245.0, -210.0, -557.0, -331.0, -450.0, -91.0, -225.0, -430.0, 9.0, -26.0, -296.0, -155.0, -185.0, -110.0, -297.0, -340.0, -719.0, -385.0, -216.0, -90.0, -284.0, -321.0, -300.0, -167.0, -269.0, -478.0, -390.0, -215.0, -184.0, -595.0, -33.0, -245.0, -335.0, -482.0, -304.0, -189.0, -305.0, -205.0, -140.0, -100.0, -318.0, -125.0, -343.0, -333.0, -94.0, -262.0, -177.0, -327.0, -344.0, -518.0, 0.0, -345.0, 31.0, -459.0, -321.0, -350.0, -420.0, -80.0, -90.0, -735.0, -124.0, -236.0, -45.0, -87.0, -198.0, -400.0, -185.0, -73.0, 8.0, -70.0, -210.0, -255.0, -175.0, -47.0, -464.0, -35.0, -240.0, -175.0, -1402.0, 21.0, -157.0, -20.0, -481.0, -1035.0, -268.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.0, -390.0, -180.0, -140.0, -180.0, -401.0, -1640.0, -980.0, -443.0, -297.0, -460.0, -110.0, -610.0, -440.0, -290.0, -370.0, -300.0, -190.0, -130.0, 0.0, -219.0, -100.0, -30.0, -588.0, 0.0, 0.0, 0.0, 0.0, -40.0, -230.0, -130.0, -450.0, -200.0, -530.0, -370.0, -827.0, -660.0, -171.0, -400.0, -530.0, -136.0, -30.0, -175.0, -590.0, -320.0, -510.0, 0.0, 9.0, 0.0, -56.0, -516.0, -120.0, -150.0, -160.0, -290.0, -150.0, -100.0, -60.0, -647.0, -210.0, -80.0, -800.0, -1238.0, -236.0, -460.0, -260.0, -90.0, -286.0, -41.0, -104.0, -526.0, -88.0, -627.0, -189.0, -20.0, -640.0, -140.0, -237.0, 1.0, -540.0, -373.0, -385.0, -580.0, -460.0, -210.0, -540.0, -229.0, -420.0, -1028.0, -202.0, 8.0, -86.0, -95.0, -415.0, -760.0, 0.0, -760.0, -207.0, -280.0, -279.0, -379.0, 0.0, -20.0, -820.0, -165.0, -210.0, -10.0, -260.0, -320.0, 0.0, -678.0, -170.0, -304.0, 4.0, -258.0, -360.0, -780.0, -48.0, -179.0, -50.0, -176.0, -351.0, -432.0, -160.0, -707.0, -40.0, -319.0, -460.0, -1053.0, -70.0, 0.0, 0.0, -520.0, -160.0, 16.0, 0.0, -249.0, -420.0, -180.0, -341.0, -280.0, -280.0, -520.0, -250.0, -210.0, 25.0, -120.0, -200.0, -130.0, -1240.0, -118.0, -66.0, -356.0, -100.0, 0.0, -90.0, -93.0, -129.0, -548.0, -190.0, -840.0, -30.0, -440.0, -130.0, -20.0, -128.0, -56.0, 9.0, 0.0, -160.0, -140.0, -160.0, -395.0, -160.0, -51.0, -254.0, 93.0, -280.0, -474.0, -530.0, -640.0, -10.0, -100.0, -380.0, -310.0, -20.0, -956.0, -1001.0, 26.0, -60.0, -40.0, -272.0, 0.0, -40.0, -516.0, -480.0, -1370.0, -410.0, -20.0, -518.0], "policy_predator_policy_reward": [135.0, 105.0, 20.0, 125.0, 140.0, 150.0, 100.0, 865.0, 315.0, 50.0, 190.0, 125.0, 315.0, 210.0, 210.0, 85.0, 150.0, 175.0, 65.0, 0.0, 150.0, 0.0, 205.0, 250.0, 0.0, 0.0, 0.0, 0.0, 90.0, 110.0, 110.0, 225.0, 245.0, 275.0, 255.0, 385.0, 230.0, 270.0, 210.0, 270.0, 0.0, 75.0, 345.0, 195.0, 75.0, 325.0, 0.0, 0.0, 30.0, 0.0, 210.0, 130.0, 25.0, 130.0, 70.0, 185.0, 10.0, 40.0, 330.0, 230.0, 370.0, 170.0, 295.0, 460.0, 100.0, 235.0, 160.0, 0.0, 55.0, 0.0, 180.0, 150.0, 280.0, 215.0, 260.0, 100.0, 145.0, 65.0, 60.0, 210.0, 195.0, 85.0, 270.0, 380.0, 215.0, 320.0, 265.0, 200.0, 220.0, 415.0, 45.0, 0.0, 160.0, 105.0, 190.0, 235.0, 365.0, 120.0, 160.0, 95.0, 0.0, 190.0, 205.0, 330.0, 35.0, 135.0, 0.0, 130.0, 115.0, 105.0, 105.0, 425.0, 65.0, 110.0, 10.0, 265.0, 175.0, 320.0, 135.0, 0.0, 230.0, 35.0, 225.0, 190.0, 260.0, 160.0, 250.0, 185.0, 495.0, 110.0, 0.0, 0.0, 0.0, 335.0, 15.0, 0.0, 0.0, 210.0, 200.0, 0.0, 65.0, 145.0, 275.0, 75.0, 70.0, 35.0, 90.0, 140.0, 0.0, 635.0, 10.0, 50.0, 40.0, 180.0, 0.0, 45.0, 30.0, 105.0, 265.0, 275.0, 210.0, 260.0, 185.0, 200.0, 75.0, 0.0, 30.0, 25.0, 90.0, 0.0, 10.0, 80.0, 140.0, 160.0, 85.0, 45.0, 140.0, 0.0, 265.0, 275.0, 295.0, 320.0, 135.0, 105.0, 120.0, 35.0, 545.0, 10.0, 25.0, 30.0, 0.0, 155.0, 20.0, 0.0, 245.0, 270.0, 680.0, 65.0, 260.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6101908623294335, "mean_inference_ms": 1.4077441157979822, "mean_action_processing_ms": 0.24045928255487492, "mean_env_wait_ms": 0.18101079226302477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00352632999420166, "StateBufferConnector_ms": 0.0030329227447509766, "ViewRequirementAgentConnector_ms": 0.0990525484085083}, "num_episodes": 18, "episode_return_max": 31.0, "episode_return_min": -1655.0, "episode_return_mean": -273.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.62946636201771, "num_env_steps_trained_throughput_per_sec": 82.62946636201771, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 49289.204, "restore_workers_time_ms": 0.024, "training_step_time_ms": 49289.121, "sample_time_ms": 1114.408, "learn_time_ms": 48156.714, "learn_throughput": 83.062, "synch_weights_time_ms": 14.656}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-39-48", "timestamp": 1723502388, "time_this_iter_s": 48.446836948394775, "time_total_s": 3821.8396949768066, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8838310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3821.8396949768066, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 23.398550724637676, "ram_util_percent": 80.81159420289855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.557779861316479, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.003148142433671, "policy_loss": -0.008905683179686546, "vf_loss": 3.010238008145933, "vf_explained_var": 0.0009536719196057194, "kl": 0.012105395986311133, "entropy": 0.9501811487334115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.504361868756158, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0929389017599602, "policy_loss": -0.011701090001900281, "vf_loss": 3.1029789551856024, "vf_explained_var": 0.0012393222914801705, "kl": 0.008305124276974966, "entropy": 1.2389853655976593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 89.0, "episode_reward_min": -1402.0, "episode_reward_mean": -250.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1370.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 93.0, "predator_policy": 680.0}, "policy_reward_mean": {"prey_policy": -264.0, "predator_policy": 138.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, -26.0, -296.0, -155.0, -185.0, -110.0, -297.0, -340.0, -719.0, -385.0, -216.0, -90.0, -284.0, -321.0, -300.0, -167.0, -269.0, -478.0, -390.0, -215.0, -184.0, -595.0, -33.0, -245.0, -335.0, -482.0, -304.0, -189.0, -305.0, -205.0, -140.0, -100.0, -318.0, -125.0, -343.0, -333.0, -94.0, -262.0, -177.0, -327.0, -344.0, -518.0, 0.0, -345.0, 31.0, -459.0, -321.0, -350.0, -420.0, -80.0, -90.0, -735.0, -124.0, -236.0, -45.0, -87.0, -198.0, -400.0, -185.0, -73.0, 8.0, -70.0, -210.0, -255.0, -175.0, -47.0, -464.0, -35.0, -240.0, -175.0, -1402.0, 21.0, -157.0, -20.0, -481.0, -1035.0, -268.0, -63.0, -75.0, -8.0, -253.0, 51.0, -571.0, 15.0, 0.0, -383.0, 13.0, -220.0, -130.0, -1188.0, -45.0, -162.0, -190.0, -650.0, 89.0, -70.0, -150.0, -132.0, -149.0, -430.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 9.0, 0.0, -56.0, -516.0, -120.0, -150.0, -160.0, -290.0, -150.0, -100.0, -60.0, -647.0, -210.0, -80.0, -800.0, -1238.0, -236.0, -460.0, -260.0, -90.0, -286.0, -41.0, -104.0, -526.0, -88.0, -627.0, -189.0, -20.0, -640.0, -140.0, -237.0, 1.0, -540.0, -373.0, -385.0, -580.0, -460.0, -210.0, -540.0, -229.0, -420.0, -1028.0, -202.0, 8.0, -86.0, -95.0, -415.0, -760.0, 0.0, -760.0, -207.0, -280.0, -279.0, -379.0, 0.0, -20.0, -820.0, -165.0, -210.0, -10.0, -260.0, -320.0, 0.0, -678.0, -170.0, -304.0, 4.0, -258.0, -360.0, -780.0, -48.0, -179.0, -50.0, -176.0, -351.0, -432.0, -160.0, -707.0, -40.0, -319.0, -460.0, -1053.0, -70.0, 0.0, 0.0, -520.0, -160.0, 16.0, 0.0, -249.0, -420.0, -180.0, -341.0, -280.0, -280.0, -520.0, -250.0, -210.0, 25.0, -120.0, -200.0, -130.0, -1240.0, -118.0, -66.0, -356.0, -100.0, 0.0, -90.0, -93.0, -129.0, -548.0, -190.0, -840.0, -30.0, -440.0, -130.0, -20.0, -128.0, -56.0, 9.0, 0.0, -160.0, -140.0, -160.0, -395.0, -160.0, -51.0, -254.0, 93.0, -280.0, -474.0, -530.0, -640.0, -10.0, -100.0, -380.0, -310.0, -20.0, -956.0, -1001.0, 26.0, -60.0, -40.0, -272.0, 0.0, -40.0, -516.0, -480.0, -1370.0, -410.0, -20.0, -518.0, -165.0, -23.0, -162.0, -108.0, -18.0, 0.0, -240.0, -218.0, -130.0, 71.0, -980.0, -176.0, -50.0, 40.0, 0.0, 0.0, -718.0, -270.0, 13.0, 0.0, -274.0, -136.0, -260.0, 0.0, -780.0, -883.0, 75.0, -250.0, -180.0, -252.0, 0.0, -380.0, -930.0, -520.0, 0.0, 89.0, -10.0, -240.0, 0.0, -300.0, -167.0, -80.0, -119.0, -110.0, -390.0, -430.0], "policy_predator_policy_reward": [0.0, 0.0, 30.0, 0.0, 210.0, 130.0, 25.0, 130.0, 70.0, 185.0, 10.0, 40.0, 330.0, 230.0, 370.0, 170.0, 295.0, 460.0, 100.0, 235.0, 160.0, 0.0, 55.0, 0.0, 180.0, 150.0, 280.0, 215.0, 260.0, 100.0, 145.0, 65.0, 60.0, 210.0, 195.0, 85.0, 270.0, 380.0, 215.0, 320.0, 265.0, 200.0, 220.0, 415.0, 45.0, 0.0, 160.0, 105.0, 190.0, 235.0, 365.0, 120.0, 160.0, 95.0, 0.0, 190.0, 205.0, 330.0, 35.0, 135.0, 0.0, 130.0, 115.0, 105.0, 105.0, 425.0, 65.0, 110.0, 10.0, 265.0, 175.0, 320.0, 135.0, 0.0, 230.0, 35.0, 225.0, 190.0, 260.0, 160.0, 250.0, 185.0, 495.0, 110.0, 0.0, 0.0, 0.0, 335.0, 15.0, 0.0, 0.0, 210.0, 200.0, 0.0, 65.0, 145.0, 275.0, 75.0, 70.0, 35.0, 90.0, 140.0, 0.0, 635.0, 10.0, 50.0, 40.0, 180.0, 0.0, 45.0, 30.0, 105.0, 265.0, 275.0, 210.0, 260.0, 185.0, 200.0, 75.0, 0.0, 30.0, 25.0, 90.0, 0.0, 10.0, 80.0, 140.0, 160.0, 85.0, 45.0, 140.0, 0.0, 265.0, 275.0, 295.0, 320.0, 135.0, 105.0, 120.0, 35.0, 545.0, 10.0, 25.0, 30.0, 0.0, 155.0, 20.0, 0.0, 245.0, 270.0, 680.0, 65.0, 260.0, 10.0, 45.0, 80.0, 80.0, 115.0, 0.0, 10.0, 145.0, 60.0, 65.0, 45.0, 465.0, 120.0, 0.0, 25.0, 0.0, 0.0, 140.0, 465.0, 0.0, 0.0, 55.0, 135.0, 130.0, 0.0, 475.0, 0.0, 45.0, 85.0, 245.0, 25.0, 155.0, 35.0, 450.0, 350.0, 0.0, 0.0, 70.0, 110.0, 70.0, 80.0, 20.0, 95.0, 70.0, 10.0, 270.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6095697258396983, "mean_inference_ms": 1.4055000129277277, "mean_action_processing_ms": 0.24025684047696597, "mean_env_wait_ms": 0.1808326734472316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004007935523986816, "StateBufferConnector_ms": 0.003194093704223633, "ViewRequirementAgentConnector_ms": 0.1036369800567627}, "num_episodes": 23, "episode_return_max": 89.0, "episode_return_min": -1402.0, "episode_return_mean": -250.15, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.68566385296603, "num_env_steps_trained_throughput_per_sec": 81.68566385296603, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 49354.716, "restore_workers_time_ms": 0.024, "training_step_time_ms": 49354.631, "sample_time_ms": 1114.663, "learn_time_ms": 48221.042, "learn_throughput": 82.951, "synch_weights_time_ms": 15.366}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-40-37", "timestamp": 1723502437, "time_this_iter_s": 49.02016496658325, "time_total_s": 3870.85985994339, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8816700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3870.85985994339, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 24.68405797101449, "ram_util_percent": 81.13478260869564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3656659994333509, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.158658469417108, "policy_loss": -0.005626793044358098, "vf_loss": 3.1629032855942136, "vf_explained_var": 0.008604885093749516, "kl": 0.009213201313091912, "entropy": 0.8834035840299395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0567225957673694, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.006157520839146, "policy_loss": -0.013624975521107594, "vf_loss": 4.018061602557147, "vf_explained_var": -0.013285921774213276, "kl": 0.00860446038771318, "entropy": 1.2182937897071637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 89.0, "episode_reward_min": -1402.0, "episode_reward_mean": -249.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1780.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 93.0, "predator_policy": 910.0}, "policy_reward_mean": {"prey_policy": -261.81, "predator_policy": 136.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-390.0, -215.0, -184.0, -595.0, -33.0, -245.0, -335.0, -482.0, -304.0, -189.0, -305.0, -205.0, -140.0, -100.0, -318.0, -125.0, -343.0, -333.0, -94.0, -262.0, -177.0, -327.0, -344.0, -518.0, 0.0, -345.0, 31.0, -459.0, -321.0, -350.0, -420.0, -80.0, -90.0, -735.0, -124.0, -236.0, -45.0, -87.0, -198.0, -400.0, -185.0, -73.0, 8.0, -70.0, -210.0, -255.0, -175.0, -47.0, -464.0, -35.0, -240.0, -175.0, -1402.0, 21.0, -157.0, -20.0, -481.0, -1035.0, -268.0, -63.0, -75.0, -8.0, -253.0, 51.0, -571.0, 15.0, 0.0, -383.0, 13.0, -220.0, -130.0, -1188.0, -45.0, -162.0, -190.0, -650.0, 89.0, -70.0, -150.0, -132.0, -149.0, -430.0, 0.0, -1106.0, -208.0, -118.0, 52.0, -262.0, -40.0, -581.0, -260.0, -460.0, -735.0, -174.0, -405.0, -50.0, -57.0, 55.0, -240.0, 8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-580.0, -460.0, -210.0, -540.0, -229.0, -420.0, -1028.0, -202.0, 8.0, -86.0, -95.0, -415.0, -760.0, 0.0, -760.0, -207.0, -280.0, -279.0, -379.0, 0.0, -20.0, -820.0, -165.0, -210.0, -10.0, -260.0, -320.0, 0.0, -678.0, -170.0, -304.0, 4.0, -258.0, -360.0, -780.0, -48.0, -179.0, -50.0, -176.0, -351.0, -432.0, -160.0, -707.0, -40.0, -319.0, -460.0, -1053.0, -70.0, 0.0, 0.0, -520.0, -160.0, 16.0, 0.0, -249.0, -420.0, -180.0, -341.0, -280.0, -280.0, -520.0, -250.0, -210.0, 25.0, -120.0, -200.0, -130.0, -1240.0, -118.0, -66.0, -356.0, -100.0, 0.0, -90.0, -93.0, -129.0, -548.0, -190.0, -840.0, -30.0, -440.0, -130.0, -20.0, -128.0, -56.0, 9.0, 0.0, -160.0, -140.0, -160.0, -395.0, -160.0, -51.0, -254.0, 93.0, -280.0, -474.0, -530.0, -640.0, -10.0, -100.0, -380.0, -310.0, -20.0, -956.0, -1001.0, 26.0, -60.0, -40.0, -272.0, 0.0, -40.0, -516.0, -480.0, -1370.0, -410.0, -20.0, -518.0, -165.0, -23.0, -162.0, -108.0, -18.0, 0.0, -240.0, -218.0, -130.0, 71.0, -980.0, -176.0, -50.0, 40.0, 0.0, 0.0, -718.0, -270.0, 13.0, 0.0, -274.0, -136.0, -260.0, 0.0, -780.0, -883.0, 75.0, -250.0, -180.0, -252.0, 0.0, -380.0, -930.0, -520.0, 0.0, 89.0, -10.0, -240.0, 0.0, -300.0, -167.0, -80.0, -119.0, -110.0, -390.0, -430.0, 0.0, 0.0, -1780.0, -236.0, -212.0, -226.0, -118.0, -120.0, 20.0, 17.0, -537.0, 0.0, 25.0, -130.0, -420.0, -791.0, -520.0, 0.0, -650.0, -340.0, -961.0, -349.0, -206.0, -168.0, -508.0, -207.0, -50.0, -100.0, -112.0, -160.0, 6.0, -36.0, -180.0, -300.0, -60.0, 38.0], "policy_predator_policy_reward": [270.0, 380.0, 215.0, 320.0, 265.0, 200.0, 220.0, 415.0, 45.0, 0.0, 160.0, 105.0, 190.0, 235.0, 365.0, 120.0, 160.0, 95.0, 0.0, 190.0, 205.0, 330.0, 35.0, 135.0, 0.0, 130.0, 115.0, 105.0, 105.0, 425.0, 65.0, 110.0, 10.0, 265.0, 175.0, 320.0, 135.0, 0.0, 230.0, 35.0, 225.0, 190.0, 260.0, 160.0, 250.0, 185.0, 495.0, 110.0, 0.0, 0.0, 0.0, 335.0, 15.0, 0.0, 0.0, 210.0, 200.0, 0.0, 65.0, 145.0, 275.0, 75.0, 70.0, 35.0, 90.0, 140.0, 0.0, 635.0, 10.0, 50.0, 40.0, 180.0, 0.0, 45.0, 30.0, 105.0, 265.0, 275.0, 210.0, 260.0, 185.0, 200.0, 75.0, 0.0, 30.0, 25.0, 90.0, 0.0, 10.0, 80.0, 140.0, 160.0, 85.0, 45.0, 140.0, 0.0, 265.0, 275.0, 295.0, 320.0, 135.0, 105.0, 120.0, 35.0, 545.0, 10.0, 25.0, 30.0, 0.0, 155.0, 20.0, 0.0, 245.0, 270.0, 680.0, 65.0, 260.0, 10.0, 45.0, 80.0, 80.0, 115.0, 0.0, 10.0, 145.0, 60.0, 65.0, 45.0, 465.0, 120.0, 0.0, 25.0, 0.0, 0.0, 140.0, 465.0, 0.0, 0.0, 55.0, 135.0, 130.0, 0.0, 475.0, 0.0, 45.0, 85.0, 245.0, 25.0, 155.0, 35.0, 450.0, 350.0, 0.0, 0.0, 70.0, 110.0, 70.0, 80.0, 20.0, 95.0, 70.0, 10.0, 270.0, 120.0, 0.0, 0.0, 0.0, 910.0, 105.0, 125.0, 0.0, 120.0, 0.0, 15.0, 245.0, 30.0, 55.0, 10.0, 325.0, 305.0, 0.0, 260.0, 365.0, 165.0, 505.0, 70.0, 75.0, 125.0, 125.0, 185.0, 65.0, 35.0, 60.0, 155.0, 30.0, 55.0, 160.0, 80.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6093338891944925, "mean_inference_ms": 1.404406702081426, "mean_action_processing_ms": 0.24016395093692125, "mean_env_wait_ms": 0.18075167886364177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004027366638183594, "StateBufferConnector_ms": 0.0035262107849121094, "ViewRequirementAgentConnector_ms": 0.10509991645812988}, "num_episodes": 18, "episode_return_max": 89.0, "episode_return_min": -1402.0, "episode_return_mean": -249.67, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.77075170296295, "num_env_steps_trained_throughput_per_sec": 80.77075170296295, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 49359.714, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49359.578, "sample_time_ms": 1122.449, "learn_time_ms": 48218.481, "learn_throughput": 82.956, "synch_weights_time_ms": 15.097}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-41-26", "timestamp": 1723502486, "time_this_iter_s": 49.55105400085449, "time_total_s": 3920.4109139442444, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aae06f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3920.4109139442444, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 26.21830985915493, "ram_util_percent": 82.62676056338029}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2943094601706853, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.635304209731874, "policy_loss": -0.005318798463072175, "vf_loss": 2.6395486148576888, "vf_explained_var": 0.003490271391691985, "kl": 0.007162633978189385, "entropy": 0.7344936449060995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.839438637854561, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.718817617401244, "policy_loss": -0.012268724741916807, "vf_loss": 2.729285077317051, "vf_explained_var": -0.02173872094936472, "kl": 0.009006283120708116, "entropy": 1.232359155082198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 89.0, "episode_reward_min": -1402.0, "episode_reward_mean": -238.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1780.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 93.0, "predator_policy": 910.0}, "policy_reward_mean": {"prey_policy": -246.865, "predator_policy": 127.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.0, -262.0, -177.0, -327.0, -344.0, -518.0, 0.0, -345.0, 31.0, -459.0, -321.0, -350.0, -420.0, -80.0, -90.0, -735.0, -124.0, -236.0, -45.0, -87.0, -198.0, -400.0, -185.0, -73.0, 8.0, -70.0, -210.0, -255.0, -175.0, -47.0, -464.0, -35.0, -240.0, -175.0, -1402.0, 21.0, -157.0, -20.0, -481.0, -1035.0, -268.0, -63.0, -75.0, -8.0, -253.0, 51.0, -571.0, 15.0, 0.0, -383.0, 13.0, -220.0, -130.0, -1188.0, -45.0, -162.0, -190.0, -650.0, 89.0, -70.0, -150.0, -132.0, -149.0, -430.0, 0.0, -1106.0, -208.0, -118.0, 52.0, -262.0, -40.0, -581.0, -260.0, -460.0, -735.0, -174.0, -405.0, -50.0, -57.0, 55.0, -240.0, 8.0, -250.0, -150.0, -126.0, -50.0, 32.0, -886.0, -21.0, -41.0, -42.0, -139.0, -217.0, -565.0, -668.0, -110.0, -80.0, -103.0, -186.0, -155.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-179.0, -50.0, -176.0, -351.0, -432.0, -160.0, -707.0, -40.0, -319.0, -460.0, -1053.0, -70.0, 0.0, 0.0, -520.0, -160.0, 16.0, 0.0, -249.0, -420.0, -180.0, -341.0, -280.0, -280.0, -520.0, -250.0, -210.0, 25.0, -120.0, -200.0, -130.0, -1240.0, -118.0, -66.0, -356.0, -100.0, 0.0, -90.0, -93.0, -129.0, -548.0, -190.0, -840.0, -30.0, -440.0, -130.0, -20.0, -128.0, -56.0, 9.0, 0.0, -160.0, -140.0, -160.0, -395.0, -160.0, -51.0, -254.0, 93.0, -280.0, -474.0, -530.0, -640.0, -10.0, -100.0, -380.0, -310.0, -20.0, -956.0, -1001.0, 26.0, -60.0, -40.0, -272.0, 0.0, -40.0, -516.0, -480.0, -1370.0, -410.0, -20.0, -518.0, -165.0, -23.0, -162.0, -108.0, -18.0, 0.0, -240.0, -218.0, -130.0, 71.0, -980.0, -176.0, -50.0, 40.0, 0.0, 0.0, -718.0, -270.0, 13.0, 0.0, -274.0, -136.0, -260.0, 0.0, -780.0, -883.0, 75.0, -250.0, -180.0, -252.0, 0.0, -380.0, -930.0, -520.0, 0.0, 89.0, -10.0, -240.0, 0.0, -300.0, -167.0, -80.0, -119.0, -110.0, -390.0, -430.0, 0.0, 0.0, -1780.0, -236.0, -212.0, -226.0, -118.0, -120.0, 20.0, 17.0, -537.0, 0.0, 25.0, -130.0, -420.0, -791.0, -520.0, 0.0, -650.0, -340.0, -961.0, -349.0, -206.0, -168.0, -508.0, -207.0, -50.0, -100.0, -112.0, -160.0, 6.0, -36.0, -180.0, -300.0, -60.0, 38.0, -330.0, -250.0, -150.0, -150.0, -116.0, -150.0, -135.0, 0.0, 0.0, 32.0, -1460.0, -156.0, -70.0, 14.0, -330.0, 4.0, -72.0, -20.0, -279.0, 0.0, -102.0, -390.0, -1258.0, 33.0, -260.0, -1308.0, 0.0, -230.0, -80.0, -80.0, -170.0, -78.0, -389.0, -82.0, -326.0, 6.0], "policy_predator_policy_reward": [135.0, 0.0, 230.0, 35.0, 225.0, 190.0, 260.0, 160.0, 250.0, 185.0, 495.0, 110.0, 0.0, 0.0, 0.0, 335.0, 15.0, 0.0, 0.0, 210.0, 200.0, 0.0, 65.0, 145.0, 275.0, 75.0, 70.0, 35.0, 90.0, 140.0, 0.0, 635.0, 10.0, 50.0, 40.0, 180.0, 0.0, 45.0, 30.0, 105.0, 265.0, 275.0, 210.0, 260.0, 185.0, 200.0, 75.0, 0.0, 30.0, 25.0, 90.0, 0.0, 10.0, 80.0, 140.0, 160.0, 85.0, 45.0, 140.0, 0.0, 265.0, 275.0, 295.0, 320.0, 135.0, 105.0, 120.0, 35.0, 545.0, 10.0, 25.0, 30.0, 0.0, 155.0, 20.0, 0.0, 245.0, 270.0, 680.0, 65.0, 260.0, 10.0, 45.0, 80.0, 80.0, 115.0, 0.0, 10.0, 145.0, 60.0, 65.0, 45.0, 465.0, 120.0, 0.0, 25.0, 0.0, 0.0, 140.0, 465.0, 0.0, 0.0, 55.0, 135.0, 130.0, 0.0, 475.0, 0.0, 45.0, 85.0, 245.0, 25.0, 155.0, 35.0, 450.0, 350.0, 0.0, 0.0, 70.0, 110.0, 70.0, 80.0, 20.0, 95.0, 70.0, 10.0, 270.0, 120.0, 0.0, 0.0, 0.0, 910.0, 105.0, 125.0, 0.0, 120.0, 0.0, 15.0, 245.0, 30.0, 55.0, 10.0, 325.0, 305.0, 0.0, 260.0, 365.0, 165.0, 505.0, 70.0, 75.0, 125.0, 125.0, 185.0, 65.0, 35.0, 60.0, 155.0, 30.0, 55.0, 160.0, 80.0, 0.0, 30.0, 190.0, 140.0, 0.0, 150.0, 60.0, 80.0, 20.0, 65.0, 0.0, 0.0, 0.0, 730.0, 35.0, 0.0, 165.0, 120.0, 35.0, 15.0, 140.0, 0.0, 80.0, 195.0, 205.0, 455.0, 720.0, 180.0, 115.0, 5.0, 0.0, 80.0, 60.0, 85.0, 180.0, 105.0, 95.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6091974267418944, "mean_inference_ms": 1.4037842569168155, "mean_action_processing_ms": 0.24017062934432318, "mean_env_wait_ms": 0.18073051753260164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004164218902587891, "StateBufferConnector_ms": 0.0035496950149536133, "ViewRequirementAgentConnector_ms": 0.1046304702758789}, "num_episodes": 18, "episode_return_max": 89.0, "episode_return_min": -1402.0, "episode_return_mean": -238.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.5320424358296, "num_env_steps_trained_throughput_per_sec": 81.5320424358296, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 49308.73, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49308.589, "sample_time_ms": 1134.938, "learn_time_ms": 48154.983, "learn_throughput": 83.065, "synch_weights_time_ms": 14.957}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-42-15", "timestamp": 1723502535, "time_this_iter_s": 49.11138677597046, "time_total_s": 3969.522300720215, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88bdc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3969.522300720215, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 24.75142857142857, "ram_util_percent": 81.57857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8009483222765896, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.496121644973755, "policy_loss": -0.006870694674314961, "vf_loss": 3.5017667089189803, "vf_explained_var": 0.002822354703983933, "kl": 0.008170955713676608, "entropy": 0.7734765039234565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9032899908918552, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1789362416696294, "policy_loss": -0.009670554868699539, "vf_loss": 3.18722944505631, "vf_explained_var": -0.023448464510932802, "kl": 0.006886754751814632, "entropy": 1.2651924234218699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 89.0, "episode_reward_min": -1402.0, "episode_reward_mean": -234.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1780.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 93.0, "predator_policy": 910.0}, "policy_reward_mean": {"prey_policy": -246.085, "predator_policy": 128.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.0, -73.0, 8.0, -70.0, -210.0, -255.0, -175.0, -47.0, -464.0, -35.0, -240.0, -175.0, -1402.0, 21.0, -157.0, -20.0, -481.0, -1035.0, -268.0, -63.0, -75.0, -8.0, -253.0, 51.0, -571.0, 15.0, 0.0, -383.0, 13.0, -220.0, -130.0, -1188.0, -45.0, -162.0, -190.0, -650.0, 89.0, -70.0, -150.0, -132.0, -149.0, -430.0, 0.0, -1106.0, -208.0, -118.0, 52.0, -262.0, -40.0, -581.0, -260.0, -460.0, -735.0, -174.0, -405.0, -50.0, -57.0, 55.0, -240.0, 8.0, -250.0, -150.0, -126.0, -50.0, 32.0, -886.0, -21.0, -41.0, -42.0, -139.0, -217.0, -565.0, -668.0, -110.0, -80.0, -103.0, -186.0, -155.0, -160.0, -984.0, -240.0, -165.0, -135.0, -455.0, -195.0, -160.0, -503.0, -65.0, -185.0, -170.0, -521.0, -105.0, -259.0, -105.0, -197.0, -67.0, -279.0, 4.0, -36.0, -168.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-440.0, -130.0, -20.0, -128.0, -56.0, 9.0, 0.0, -160.0, -140.0, -160.0, -395.0, -160.0, -51.0, -254.0, 93.0, -280.0, -474.0, -530.0, -640.0, -10.0, -100.0, -380.0, -310.0, -20.0, -956.0, -1001.0, 26.0, -60.0, -40.0, -272.0, 0.0, -40.0, -516.0, -480.0, -1370.0, -410.0, -20.0, -518.0, -165.0, -23.0, -162.0, -108.0, -18.0, 0.0, -240.0, -218.0, -130.0, 71.0, -980.0, -176.0, -50.0, 40.0, 0.0, 0.0, -718.0, -270.0, 13.0, 0.0, -274.0, -136.0, -260.0, 0.0, -780.0, -883.0, 75.0, -250.0, -180.0, -252.0, 0.0, -380.0, -930.0, -520.0, 0.0, 89.0, -10.0, -240.0, 0.0, -300.0, -167.0, -80.0, -119.0, -110.0, -390.0, -430.0, 0.0, 0.0, -1780.0, -236.0, -212.0, -226.0, -118.0, -120.0, 20.0, 17.0, -537.0, 0.0, 25.0, -130.0, -420.0, -791.0, -520.0, 0.0, -650.0, -340.0, -961.0, -349.0, -206.0, -168.0, -508.0, -207.0, -50.0, -100.0, -112.0, -160.0, 6.0, -36.0, -180.0, -300.0, -60.0, 38.0, -330.0, -250.0, -150.0, -150.0, -116.0, -150.0, -135.0, 0.0, 0.0, 32.0, -1460.0, -156.0, -70.0, 14.0, -330.0, 4.0, -72.0, -20.0, -279.0, 0.0, -102.0, -390.0, -1258.0, 33.0, -260.0, -1308.0, 0.0, -230.0, -80.0, -80.0, -170.0, -78.0, -389.0, -82.0, -326.0, 6.0, -320.0, 0.0, -400.0, -1239.0, -560.0, -60.0, -123.0, -347.0, -280.0, 0.0, 0.0, -910.0, -215.0, -215.0, -20.0, -330.0, -508.0, -620.0, -30.0, -70.0, -190.0, -180.0, -340.0, 0.0, -280.0, -821.0, -90.0, -120.0, -170.0, -379.0, -230.0, -130.0, -172.0, -330.0, -700.0, -17.0, 0.0, -604.0, 4.0, 0.0, -40.0, -36.0, -50.0, -338.0], "policy_predator_policy_reward": [185.0, 200.0, 75.0, 0.0, 30.0, 25.0, 90.0, 0.0, 10.0, 80.0, 140.0, 160.0, 85.0, 45.0, 140.0, 0.0, 265.0, 275.0, 295.0, 320.0, 135.0, 105.0, 120.0, 35.0, 545.0, 10.0, 25.0, 30.0, 0.0, 155.0, 20.0, 0.0, 245.0, 270.0, 680.0, 65.0, 260.0, 10.0, 45.0, 80.0, 80.0, 115.0, 0.0, 10.0, 145.0, 60.0, 65.0, 45.0, 465.0, 120.0, 0.0, 25.0, 0.0, 0.0, 140.0, 465.0, 0.0, 0.0, 55.0, 135.0, 130.0, 0.0, 475.0, 0.0, 45.0, 85.0, 245.0, 25.0, 155.0, 35.0, 450.0, 350.0, 0.0, 0.0, 70.0, 110.0, 70.0, 80.0, 20.0, 95.0, 70.0, 10.0, 270.0, 120.0, 0.0, 0.0, 0.0, 910.0, 105.0, 125.0, 0.0, 120.0, 0.0, 15.0, 245.0, 30.0, 55.0, 10.0, 325.0, 305.0, 0.0, 260.0, 365.0, 165.0, 505.0, 70.0, 75.0, 125.0, 125.0, 185.0, 65.0, 35.0, 60.0, 155.0, 30.0, 55.0, 160.0, 80.0, 0.0, 30.0, 190.0, 140.0, 0.0, 150.0, 60.0, 80.0, 20.0, 65.0, 0.0, 0.0, 0.0, 730.0, 35.0, 0.0, 165.0, 120.0, 35.0, 15.0, 140.0, 0.0, 80.0, 195.0, 205.0, 455.0, 720.0, 180.0, 115.0, 5.0, 0.0, 80.0, 60.0, 85.0, 180.0, 105.0, 95.0, 70.0, 160.0, 0.0, 50.0, 605.0, 105.0, 275.0, 90.0, 215.0, 55.0, 90.0, 120.0, 335.0, 0.0, 235.0, 105.0, 85.0, 245.0, 380.0, 35.0, 0.0, 155.0, 30.0, 105.0, 65.0, 335.0, 245.0, 40.0, 65.0, 130.0, 160.0, 130.0, 125.0, 170.0, 135.0, 305.0, 345.0, 325.0, 0.0, 0.0, 0.0, 40.0, 0.0, 90.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6088608227677479, "mean_inference_ms": 1.4025105696924358, "mean_action_processing_ms": 0.24011761613237576, "mean_env_wait_ms": 0.18061200374079128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004225969314575195, "StateBufferConnector_ms": 0.0035959482192993164, "ViewRequirementAgentConnector_ms": 0.10516488552093506}, "num_episodes": 22, "episode_return_max": 89.0, "episode_return_min": -1402.0, "episode_return_mean": -234.52, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.16496473220693, "num_env_steps_trained_throughput_per_sec": 82.16496473220693, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 49203.8, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49203.658, "sample_time_ms": 1125.371, "learn_time_ms": 48058.042, "learn_throughput": 83.233, "synch_weights_time_ms": 16.677}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-43-04", "timestamp": 1723502584, "time_this_iter_s": 48.72283911705017, "time_total_s": 4018.245139837265, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aae1d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4018.245139837265, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 23.659420289855074, "ram_util_percent": 80.8376811594203}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2238333808839637, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.025616411431126, "policy_loss": -0.004066038490691907, "vf_loss": 3.028887748402893, "vf_explained_var": 0.001855706663989516, "kl": 0.005298011411708695, "entropy": 0.7491554039811331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9178894442067576, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0781597704483716, "policy_loss": -0.008305976706034647, "vf_loss": 3.0851830343720774, "vf_explained_var": -0.003734288486854109, "kl": 0.0064135913594810905, "entropy": 1.2530181651392942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 89.0, "episode_reward_min": -1500.0, "episode_reward_mean": -239.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1780.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 89.0, "predator_policy": 925.0}, "policy_reward_mean": {"prey_policy": -248.59, "predator_policy": 128.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.0, -571.0, 15.0, 0.0, -383.0, 13.0, -220.0, -130.0, -1188.0, -45.0, -162.0, -190.0, -650.0, 89.0, -70.0, -150.0, -132.0, -149.0, -430.0, 0.0, -1106.0, -208.0, -118.0, 52.0, -262.0, -40.0, -581.0, -260.0, -460.0, -735.0, -174.0, -405.0, -50.0, -57.0, 55.0, -240.0, 8.0, -250.0, -150.0, -126.0, -50.0, 32.0, -886.0, -21.0, -41.0, -42.0, -139.0, -217.0, -565.0, -668.0, -110.0, -80.0, -103.0, -186.0, -155.0, -160.0, -984.0, -240.0, -165.0, -135.0, -455.0, -195.0, -160.0, -503.0, -65.0, -185.0, -170.0, -521.0, -105.0, -259.0, -105.0, -197.0, -67.0, -279.0, 4.0, -36.0, -168.0, 0.0, -344.0, -85.0, 0.0, -350.0, -1500.0, -59.0, -14.0, -149.0, -819.0, -39.0, -191.0, -32.0, -100.0, -34.0, -930.0, -95.0, -35.0, -521.0, -530.0, -136.0, -190.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-130.0, 71.0, -980.0, -176.0, -50.0, 40.0, 0.0, 0.0, -718.0, -270.0, 13.0, 0.0, -274.0, -136.0, -260.0, 0.0, -780.0, -883.0, 75.0, -250.0, -180.0, -252.0, 0.0, -380.0, -930.0, -520.0, 0.0, 89.0, -10.0, -240.0, 0.0, -300.0, -167.0, -80.0, -119.0, -110.0, -390.0, -430.0, 0.0, 0.0, -1780.0, -236.0, -212.0, -226.0, -118.0, -120.0, 20.0, 17.0, -537.0, 0.0, 25.0, -130.0, -420.0, -791.0, -520.0, 0.0, -650.0, -340.0, -961.0, -349.0, -206.0, -168.0, -508.0, -207.0, -50.0, -100.0, -112.0, -160.0, 6.0, -36.0, -180.0, -300.0, -60.0, 38.0, -330.0, -250.0, -150.0, -150.0, -116.0, -150.0, -135.0, 0.0, 0.0, 32.0, -1460.0, -156.0, -70.0, 14.0, -330.0, 4.0, -72.0, -20.0, -279.0, 0.0, -102.0, -390.0, -1258.0, 33.0, -260.0, -1308.0, 0.0, -230.0, -80.0, -80.0, -170.0, -78.0, -389.0, -82.0, -326.0, 6.0, -320.0, 0.0, -400.0, -1239.0, -560.0, -60.0, -123.0, -347.0, -280.0, 0.0, 0.0, -910.0, -215.0, -215.0, -20.0, -330.0, -508.0, -620.0, -30.0, -70.0, -190.0, -180.0, -340.0, 0.0, -280.0, -821.0, -90.0, -120.0, -170.0, -379.0, -230.0, -130.0, -172.0, -330.0, -700.0, -17.0, 0.0, -604.0, 4.0, 0.0, -40.0, -36.0, -50.0, -338.0, 0.0, 0.0, -570.0, -149.0, -170.0, 0.0, 0.0, 0.0, -690.0, -40.0, -1030.0, -1040.0, -130.0, 6.0, -9.0, -140.0, -180.0, -89.0, -830.0, -759.0, -209.0, 0.0, -380.0, -6.0, -62.0, -10.0, -90.0, -110.0, -69.0, 0.0, -110.0, -1780.0, -190.0, 0.0, 0.0, -70.0, -46.0, -1010.0, -330.0, -570.0, -530.0, -36.0, -210.0, -190.0, 0.0, 0.0], "policy_predator_policy_reward": [65.0, 45.0, 465.0, 120.0, 0.0, 25.0, 0.0, 0.0, 140.0, 465.0, 0.0, 0.0, 55.0, 135.0, 130.0, 0.0, 475.0, 0.0, 45.0, 85.0, 245.0, 25.0, 155.0, 35.0, 450.0, 350.0, 0.0, 0.0, 70.0, 110.0, 70.0, 80.0, 20.0, 95.0, 70.0, 10.0, 270.0, 120.0, 0.0, 0.0, 0.0, 910.0, 105.0, 125.0, 0.0, 120.0, 0.0, 15.0, 245.0, 30.0, 55.0, 10.0, 325.0, 305.0, 0.0, 260.0, 365.0, 165.0, 505.0, 70.0, 75.0, 125.0, 125.0, 185.0, 65.0, 35.0, 60.0, 155.0, 30.0, 55.0, 160.0, 80.0, 0.0, 30.0, 190.0, 140.0, 0.0, 150.0, 60.0, 80.0, 20.0, 65.0, 0.0, 0.0, 0.0, 730.0, 35.0, 0.0, 165.0, 120.0, 35.0, 15.0, 140.0, 0.0, 80.0, 195.0, 205.0, 455.0, 720.0, 180.0, 115.0, 5.0, 0.0, 80.0, 60.0, 85.0, 180.0, 105.0, 95.0, 70.0, 160.0, 0.0, 50.0, 605.0, 105.0, 275.0, 90.0, 215.0, 55.0, 90.0, 120.0, 335.0, 0.0, 235.0, 105.0, 85.0, 245.0, 380.0, 35.0, 0.0, 155.0, 30.0, 105.0, 65.0, 335.0, 245.0, 40.0, 65.0, 130.0, 160.0, 130.0, 125.0, 170.0, 135.0, 305.0, 345.0, 325.0, 0.0, 0.0, 0.0, 40.0, 0.0, 90.0, 130.0, 0.0, 0.0, 180.0, 195.0, 85.0, 0.0, 0.0, 0.0, 25.0, 355.0, 450.0, 120.0, 0.0, 65.0, 70.0, 65.0, 115.0, 5.0, 355.0, 415.0, 90.0, 80.0, 50.0, 145.0, 40.0, 0.0, 0.0, 100.0, 30.0, 5.0, 925.0, 35.0, 75.0, 20.0, 35.0, 0.0, 400.0, 135.0, 145.0, 225.0, 190.0, 240.0, 115.0, 95.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6090537069808765, "mean_inference_ms": 1.4019610588744227, "mean_action_processing_ms": 0.24003418615246006, "mean_env_wait_ms": 0.1806559249802003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004251837730407715, "StateBufferConnector_ms": 0.0036455392837524414, "ViewRequirementAgentConnector_ms": 0.10419678688049316}, "num_episodes": 23, "episode_return_max": 89.0, "episode_return_min": -1500.0, "episode_return_mean": -239.43, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.97530054906021, "num_env_steps_trained_throughput_per_sec": 80.97530054906021, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 49243.037, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49242.886, "sample_time_ms": 1122.037, "learn_time_ms": 48101.371, "learn_throughput": 83.158, "synch_weights_time_ms": 16.686}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-43-54", "timestamp": 1723502634, "time_this_iter_s": 49.43983483314514, "time_total_s": 4067.68497467041, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aadfe280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4067.68497467041, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 25.575714285714287, "ram_util_percent": 81.89000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1016613926048633, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.615575164020377, "policy_loss": -0.004489010777915754, "vf_loss": 2.6192312180680575, "vf_explained_var": 0.0003759541524150384, "kl": 0.005553058920500202, "entropy": 0.7727662314182867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2022347844624646, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.522293058337358, "policy_loss": -0.009863551933978679, "vf_loss": 2.5306030834793414, "vf_explained_var": -0.0030417380194184642, "kl": 0.007767631922487689, "entropy": 1.2578793082287703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 55.0, "episode_reward_min": -1500.0, "episode_reward_mean": -232.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1900.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.0, "predator_policy": 925.0}, "policy_reward_mean": {"prey_policy": -242.89, "predator_policy": 126.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-430.0, 0.0, -1106.0, -208.0, -118.0, 52.0, -262.0, -40.0, -581.0, -260.0, -460.0, -735.0, -174.0, -405.0, -50.0, -57.0, 55.0, -240.0, 8.0, -250.0, -150.0, -126.0, -50.0, 32.0, -886.0, -21.0, -41.0, -42.0, -139.0, -217.0, -565.0, -668.0, -110.0, -80.0, -103.0, -186.0, -155.0, -160.0, -984.0, -240.0, -165.0, -135.0, -455.0, -195.0, -160.0, -503.0, -65.0, -185.0, -170.0, -521.0, -105.0, -259.0, -105.0, -197.0, -67.0, -279.0, 4.0, -36.0, -168.0, 0.0, -344.0, -85.0, 0.0, -350.0, -1500.0, -59.0, -14.0, -149.0, -819.0, -39.0, -191.0, -32.0, -100.0, -34.0, -930.0, -95.0, -35.0, -521.0, -530.0, -136.0, -190.0, 0.0, -194.0, -281.0, -67.0, -148.0, -100.0, -35.0, -60.0, -218.0, -170.0, -60.0, -65.0, -1040.0, 0.0, -55.0, -93.0, -306.0, -195.0, -60.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-390.0, -430.0, 0.0, 0.0, -1780.0, -236.0, -212.0, -226.0, -118.0, -120.0, 20.0, 17.0, -537.0, 0.0, 25.0, -130.0, -420.0, -791.0, -520.0, 0.0, -650.0, -340.0, -961.0, -349.0, -206.0, -168.0, -508.0, -207.0, -50.0, -100.0, -112.0, -160.0, 6.0, -36.0, -180.0, -300.0, -60.0, 38.0, -330.0, -250.0, -150.0, -150.0, -116.0, -150.0, -135.0, 0.0, 0.0, 32.0, -1460.0, -156.0, -70.0, 14.0, -330.0, 4.0, -72.0, -20.0, -279.0, 0.0, -102.0, -390.0, -1258.0, 33.0, -260.0, -1308.0, 0.0, -230.0, -80.0, -80.0, -170.0, -78.0, -389.0, -82.0, -326.0, 6.0, -320.0, 0.0, -400.0, -1239.0, -560.0, -60.0, -123.0, -347.0, -280.0, 0.0, 0.0, -910.0, -215.0, -215.0, -20.0, -330.0, -508.0, -620.0, -30.0, -70.0, -190.0, -180.0, -340.0, 0.0, -280.0, -821.0, -90.0, -120.0, -170.0, -379.0, -230.0, -130.0, -172.0, -330.0, -700.0, -17.0, 0.0, -604.0, 4.0, 0.0, -40.0, -36.0, -50.0, -338.0, 0.0, 0.0, -570.0, -149.0, -170.0, 0.0, 0.0, 0.0, -690.0, -40.0, -1030.0, -1040.0, -130.0, 6.0, -9.0, -140.0, -180.0, -89.0, -830.0, -759.0, -209.0, 0.0, -380.0, -6.0, -62.0, -10.0, -90.0, -110.0, -69.0, 0.0, -110.0, -1780.0, -190.0, 0.0, 0.0, -70.0, -46.0, -1010.0, -330.0, -570.0, -530.0, -36.0, -210.0, -190.0, 0.0, 0.0, 0.0, -419.0, -480.0, -186.0, -147.0, -20.0, -360.0, -248.0, -200.0, 0.0, 0.0, -105.0, -80.0, -40.0, 2.0, -440.0, -120.0, -110.0, -10.0, -100.0, -90.0, -160.0, -1900.0, -110.0, 0.0, 0.0, -110.0, 0.0, 0.0, -188.0, -450.0, -116.0, -120.0, -270.0, -140.0, -50.0], "policy_predator_policy_reward": [270.0, 120.0, 0.0, 0.0, 0.0, 910.0, 105.0, 125.0, 0.0, 120.0, 0.0, 15.0, 245.0, 30.0, 55.0, 10.0, 325.0, 305.0, 0.0, 260.0, 365.0, 165.0, 505.0, 70.0, 75.0, 125.0, 125.0, 185.0, 65.0, 35.0, 60.0, 155.0, 30.0, 55.0, 160.0, 80.0, 0.0, 30.0, 190.0, 140.0, 0.0, 150.0, 60.0, 80.0, 20.0, 65.0, 0.0, 0.0, 0.0, 730.0, 35.0, 0.0, 165.0, 120.0, 35.0, 15.0, 140.0, 0.0, 80.0, 195.0, 205.0, 455.0, 720.0, 180.0, 115.0, 5.0, 0.0, 80.0, 60.0, 85.0, 180.0, 105.0, 95.0, 70.0, 160.0, 0.0, 50.0, 605.0, 105.0, 275.0, 90.0, 215.0, 55.0, 90.0, 120.0, 335.0, 0.0, 235.0, 105.0, 85.0, 245.0, 380.0, 35.0, 0.0, 155.0, 30.0, 105.0, 65.0, 335.0, 245.0, 40.0, 65.0, 130.0, 160.0, 130.0, 125.0, 170.0, 135.0, 305.0, 345.0, 325.0, 0.0, 0.0, 0.0, 40.0, 0.0, 90.0, 130.0, 0.0, 0.0, 180.0, 195.0, 85.0, 0.0, 0.0, 0.0, 25.0, 355.0, 450.0, 120.0, 0.0, 65.0, 70.0, 65.0, 115.0, 5.0, 355.0, 415.0, 90.0, 80.0, 50.0, 145.0, 40.0, 0.0, 0.0, 100.0, 30.0, 5.0, 925.0, 35.0, 75.0, 20.0, 35.0, 0.0, 400.0, 135.0, 145.0, 225.0, 190.0, 240.0, 115.0, 95.0, 0.0, 0.0, 130.0, 95.0, 320.0, 65.0, 25.0, 75.0, 155.0, 305.0, 25.0, 75.0, 45.0, 25.0, 50.0, 10.0, 220.0, 0.0, 60.0, 0.0, 40.0, 10.0, 70.0, 115.0, 920.0, 50.0, 0.0, 0.0, 15.0, 40.0, 95.0, 0.0, 215.0, 45.0, 60.0, 135.0, 55.0, 75.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6085312774431986, "mean_inference_ms": 1.4012584181186072, "mean_action_processing_ms": 0.24014983399149925, "mean_env_wait_ms": 0.18062560554159726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751039505004883, "StateBufferConnector_ms": 0.0034903287887573242, "ViewRequirementAgentConnector_ms": 0.10016214847564697}, "num_episodes": 18, "episode_return_max": 55.0, "episode_return_min": -1500.0, "episode_return_mean": -232.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.50880045266737, "num_env_steps_trained_throughput_per_sec": 77.50880045266737, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 49549.814, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49549.662, "sample_time_ms": 1128.115, "learn_time_ms": 48401.984, "learn_throughput": 82.641, "synch_weights_time_ms": 16.661}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-44-45", "timestamp": 1723502685, "time_this_iter_s": 51.64820718765259, "time_total_s": 4119.333181858063, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8838e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4119.333181858063, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 31.795890410958897, "ram_util_percent": 82.58630136986302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7894610698891695, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8757807725951787, "policy_loss": -0.005137297525390903, "vf_loss": 2.8799200515898447, "vf_explained_var": -7.993500068704919e-05, "kl": 0.006653491198409938, "entropy": 0.7324419880670214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9537988995433484, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1178217729878805, "policy_loss": -0.016597530059762812, "vf_loss": 2.132469851062411, "vf_explained_var": -0.00310529558746903, "kl": 0.009747220017585868, "entropy": 1.27585046985162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 32.0, "episode_reward_min": -1500.0, "episode_reward_mean": -209.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1900.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.0, "predator_policy": 925.0}, "policy_reward_mean": {"prey_policy": -223.615, "predator_policy": 118.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.0, -250.0, -150.0, -126.0, -50.0, 32.0, -886.0, -21.0, -41.0, -42.0, -139.0, -217.0, -565.0, -668.0, -110.0, -80.0, -103.0, -186.0, -155.0, -160.0, -984.0, -240.0, -165.0, -135.0, -455.0, -195.0, -160.0, -503.0, -65.0, -185.0, -170.0, -521.0, -105.0, -259.0, -105.0, -197.0, -67.0, -279.0, 4.0, -36.0, -168.0, 0.0, -344.0, -85.0, 0.0, -350.0, -1500.0, -59.0, -14.0, -149.0, -819.0, -39.0, -191.0, -32.0, -100.0, -34.0, -930.0, -95.0, -35.0, -521.0, -530.0, -136.0, -190.0, 0.0, -194.0, -281.0, -67.0, -148.0, -100.0, -35.0, -60.0, -218.0, -170.0, -60.0, -65.0, -1040.0, 0.0, -55.0, -93.0, -306.0, -195.0, -60.0, -200.0, -140.0, -407.0, -80.0, -30.0, -139.0, -96.0, -438.0, -35.0, -250.0, -427.0, -164.0, 0.0, -10.0, -70.0, -43.0, -145.0, -65.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-60.0, 38.0, -330.0, -250.0, -150.0, -150.0, -116.0, -150.0, -135.0, 0.0, 0.0, 32.0, -1460.0, -156.0, -70.0, 14.0, -330.0, 4.0, -72.0, -20.0, -279.0, 0.0, -102.0, -390.0, -1258.0, 33.0, -260.0, -1308.0, 0.0, -230.0, -80.0, -80.0, -170.0, -78.0, -389.0, -82.0, -326.0, 6.0, -320.0, 0.0, -400.0, -1239.0, -560.0, -60.0, -123.0, -347.0, -280.0, 0.0, 0.0, -910.0, -215.0, -215.0, -20.0, -330.0, -508.0, -620.0, -30.0, -70.0, -190.0, -180.0, -340.0, 0.0, -280.0, -821.0, -90.0, -120.0, -170.0, -379.0, -230.0, -130.0, -172.0, -330.0, -700.0, -17.0, 0.0, -604.0, 4.0, 0.0, -40.0, -36.0, -50.0, -338.0, 0.0, 0.0, -570.0, -149.0, -170.0, 0.0, 0.0, 0.0, -690.0, -40.0, -1030.0, -1040.0, -130.0, 6.0, -9.0, -140.0, -180.0, -89.0, -830.0, -759.0, -209.0, 0.0, -380.0, -6.0, -62.0, -10.0, -90.0, -110.0, -69.0, 0.0, -110.0, -1780.0, -190.0, 0.0, 0.0, -70.0, -46.0, -1010.0, -330.0, -570.0, -530.0, -36.0, -210.0, -190.0, 0.0, 0.0, 0.0, -419.0, -480.0, -186.0, -147.0, -20.0, -360.0, -248.0, -200.0, 0.0, 0.0, -105.0, -80.0, -40.0, 2.0, -440.0, -120.0, -110.0, -10.0, -100.0, -90.0, -160.0, -1900.0, -110.0, 0.0, 0.0, -110.0, 0.0, 0.0, -188.0, -450.0, -116.0, -120.0, -270.0, -140.0, -50.0, -140.0, -310.0, -370.0, 0.0, -755.0, -247.0, -160.0, 0.0, 0.0, -60.0, -394.0, 0.0, -66.0, -90.0, -1050.0, 2.0, -60.0, -10.0, -340.0, -380.0, -60.0, -747.0, -346.0, -28.0, 0.0, 0.0, 0.0, -20.0, 0.0, -140.0, 7.0, -100.0, -250.0, -40.0, -50.0, -110.0], "policy_predator_policy_reward": [0.0, 30.0, 190.0, 140.0, 0.0, 150.0, 60.0, 80.0, 20.0, 65.0, 0.0, 0.0, 0.0, 730.0, 35.0, 0.0, 165.0, 120.0, 35.0, 15.0, 140.0, 0.0, 80.0, 195.0, 205.0, 455.0, 720.0, 180.0, 115.0, 5.0, 0.0, 80.0, 60.0, 85.0, 180.0, 105.0, 95.0, 70.0, 160.0, 0.0, 50.0, 605.0, 105.0, 275.0, 90.0, 215.0, 55.0, 90.0, 120.0, 335.0, 0.0, 235.0, 105.0, 85.0, 245.0, 380.0, 35.0, 0.0, 155.0, 30.0, 105.0, 65.0, 335.0, 245.0, 40.0, 65.0, 130.0, 160.0, 130.0, 125.0, 170.0, 135.0, 305.0, 345.0, 325.0, 0.0, 0.0, 0.0, 40.0, 0.0, 90.0, 130.0, 0.0, 0.0, 180.0, 195.0, 85.0, 0.0, 0.0, 0.0, 25.0, 355.0, 450.0, 120.0, 0.0, 65.0, 70.0, 65.0, 115.0, 5.0, 355.0, 415.0, 90.0, 80.0, 50.0, 145.0, 40.0, 0.0, 0.0, 100.0, 30.0, 5.0, 925.0, 35.0, 75.0, 20.0, 35.0, 0.0, 400.0, 135.0, 145.0, 225.0, 190.0, 240.0, 115.0, 95.0, 0.0, 0.0, 130.0, 95.0, 320.0, 65.0, 25.0, 75.0, 155.0, 305.0, 25.0, 75.0, 45.0, 25.0, 50.0, 10.0, 220.0, 0.0, 60.0, 0.0, 40.0, 10.0, 70.0, 115.0, 920.0, 50.0, 0.0, 0.0, 15.0, 40.0, 95.0, 0.0, 215.0, 45.0, 60.0, 135.0, 55.0, 75.0, 165.0, 85.0, 80.0, 150.0, 140.0, 455.0, 0.0, 80.0, 20.0, 10.0, 100.0, 155.0, 45.0, 15.0, 185.0, 425.0, 30.0, 5.0, 195.0, 275.0, 25.0, 355.0, 155.0, 55.0, 0.0, 0.0, 0.0, 10.0, 0.0, 70.0, 0.0, 50.0, 125.0, 20.0, 55.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6082819566050239, "mean_inference_ms": 1.4004065691981298, "mean_action_processing_ms": 0.24012001380589332, "mean_env_wait_ms": 0.18055306860760992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037370920181274414, "StateBufferConnector_ms": 0.003178834915161133, "ViewRequirementAgentConnector_ms": 0.09864473342895508}, "num_episodes": 18, "episode_return_max": 32.0, "episode_return_min": -1500.0, "episode_return_mean": -209.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.98489697064208, "num_env_steps_trained_throughput_per_sec": 81.98489697064208, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 49321.405, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49321.253, "sample_time_ms": 1131.78, "learn_time_ms": 48168.771, "learn_throughput": 83.041, "synch_weights_time_ms": 17.509}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-45-34", "timestamp": 1723502734, "time_this_iter_s": 48.83083534240723, "time_total_s": 4168.16401720047, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8821430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4168.16401720047, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 23.685714285714287, "ram_util_percent": 82.74571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8643423434445467, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.031869062292513, "policy_loss": -0.007440926118694719, "vf_loss": 3.0382671531546053, "vf_explained_var": -0.00016791479928152903, "kl": 0.006952196633478923, "entropy": 0.7387501443504656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.581108188282245, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2805546628735054, "policy_loss": -0.014254188835103479, "vf_loss": 2.2932442991821853, "vf_explained_var": -0.00202901353911748, "kl": 0.007822773213818161, "entropy": 1.2594693431147823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 4.0, "episode_reward_min": -1500.0, "episode_reward_mean": -201.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1900.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 7.0, "predator_policy": 925.0}, "policy_reward_mean": {"prey_policy": -219.92, "predator_policy": 118.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.0, -135.0, -455.0, -195.0, -160.0, -503.0, -65.0, -185.0, -170.0, -521.0, -105.0, -259.0, -105.0, -197.0, -67.0, -279.0, 4.0, -36.0, -168.0, 0.0, -344.0, -85.0, 0.0, -350.0, -1500.0, -59.0, -14.0, -149.0, -819.0, -39.0, -191.0, -32.0, -100.0, -34.0, -930.0, -95.0, -35.0, -521.0, -530.0, -136.0, -190.0, 0.0, -194.0, -281.0, -67.0, -148.0, -100.0, -35.0, -60.0, -218.0, -170.0, -60.0, -65.0, -1040.0, 0.0, -55.0, -93.0, -306.0, -195.0, -60.0, -200.0, -140.0, -407.0, -80.0, -30.0, -139.0, -96.0, -438.0, -35.0, -250.0, -427.0, -164.0, 0.0, -10.0, -70.0, -43.0, -145.0, -65.0, -300.0, -30.0, -140.0, 2.0, -48.0, -99.0, -173.0, -42.0, -70.0, -165.0, -330.0, -84.0, -485.0, -400.0, -273.0, -180.0, -155.0, -92.0, -40.0, -85.0, -955.0, -250.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-123.0, -347.0, -280.0, 0.0, 0.0, -910.0, -215.0, -215.0, -20.0, -330.0, -508.0, -620.0, -30.0, -70.0, -190.0, -180.0, -340.0, 0.0, -280.0, -821.0, -90.0, -120.0, -170.0, -379.0, -230.0, -130.0, -172.0, -330.0, -700.0, -17.0, 0.0, -604.0, 4.0, 0.0, -40.0, -36.0, -50.0, -338.0, 0.0, 0.0, -570.0, -149.0, -170.0, 0.0, 0.0, 0.0, -690.0, -40.0, -1030.0, -1040.0, -130.0, 6.0, -9.0, -140.0, -180.0, -89.0, -830.0, -759.0, -209.0, 0.0, -380.0, -6.0, -62.0, -10.0, -90.0, -110.0, -69.0, 0.0, -110.0, -1780.0, -190.0, 0.0, 0.0, -70.0, -46.0, -1010.0, -330.0, -570.0, -530.0, -36.0, -210.0, -190.0, 0.0, 0.0, 0.0, -419.0, -480.0, -186.0, -147.0, -20.0, -360.0, -248.0, -200.0, 0.0, 0.0, -105.0, -80.0, -40.0, 2.0, -440.0, -120.0, -110.0, -10.0, -100.0, -90.0, -160.0, -1900.0, -110.0, 0.0, 0.0, -110.0, 0.0, 0.0, -188.0, -450.0, -116.0, -120.0, -270.0, -140.0, -50.0, -140.0, -310.0, -370.0, 0.0, -755.0, -247.0, -160.0, 0.0, 0.0, -60.0, -394.0, 0.0, -66.0, -90.0, -1050.0, 2.0, -60.0, -10.0, -340.0, -380.0, -60.0, -747.0, -346.0, -28.0, 0.0, 0.0, 0.0, -20.0, 0.0, -140.0, 7.0, -100.0, -250.0, -40.0, -50.0, -110.0, -600.0, 0.0, 0.0, -60.0, -20.0, -260.0, 2.0, 0.0, -209.0, -99.0, -564.0, 0.0, -130.0, -228.0, 0.0, -87.0, -170.0, 0.0, 0.0, -550.0, 0.0, -690.0, -179.0, -140.0, -1020.0, -390.0, -480.0, -190.0, -328.0, -230.0, 0.0, -360.0, -10.0, -445.0, -187.0, 0.0, 0.0, -80.0, -10.0, -280.0, -1130.0, -570.0, -500.0, 0.0], "policy_predator_policy_reward": [90.0, 215.0, 55.0, 90.0, 120.0, 335.0, 0.0, 235.0, 105.0, 85.0, 245.0, 380.0, 35.0, 0.0, 155.0, 30.0, 105.0, 65.0, 335.0, 245.0, 40.0, 65.0, 130.0, 160.0, 130.0, 125.0, 170.0, 135.0, 305.0, 345.0, 325.0, 0.0, 0.0, 0.0, 40.0, 0.0, 90.0, 130.0, 0.0, 0.0, 180.0, 195.0, 85.0, 0.0, 0.0, 0.0, 25.0, 355.0, 450.0, 120.0, 0.0, 65.0, 70.0, 65.0, 115.0, 5.0, 355.0, 415.0, 90.0, 80.0, 50.0, 145.0, 40.0, 0.0, 0.0, 100.0, 30.0, 5.0, 925.0, 35.0, 75.0, 20.0, 35.0, 0.0, 400.0, 135.0, 145.0, 225.0, 190.0, 240.0, 115.0, 95.0, 0.0, 0.0, 130.0, 95.0, 320.0, 65.0, 25.0, 75.0, 155.0, 305.0, 25.0, 75.0, 45.0, 25.0, 50.0, 10.0, 220.0, 0.0, 60.0, 0.0, 40.0, 10.0, 70.0, 115.0, 920.0, 50.0, 0.0, 0.0, 15.0, 40.0, 95.0, 0.0, 215.0, 45.0, 60.0, 135.0, 55.0, 75.0, 165.0, 85.0, 80.0, 150.0, 140.0, 455.0, 0.0, 80.0, 20.0, 10.0, 100.0, 155.0, 45.0, 15.0, 185.0, 425.0, 30.0, 5.0, 195.0, 275.0, 25.0, 355.0, 155.0, 55.0, 0.0, 0.0, 0.0, 10.0, 0.0, 70.0, 0.0, 50.0, 125.0, 20.0, 55.0, 40.0, 45.0, 255.0, 0.0, 30.0, 130.0, 10.0, 0.0, 0.0, 120.0, 140.0, 215.0, 250.0, 5.0, 180.0, 25.0, 20.0, 20.0, 80.0, 180.0, 205.0, 70.0, 290.0, 160.0, 75.0, 515.0, 410.0, 190.0, 80.0, 215.0, 70.0, 180.0, 0.0, 170.0, 130.0, 0.0, 95.0, 40.0, 0.0, 90.0, 115.0, 475.0, 270.0, 70.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6083915450514064, "mean_inference_ms": 1.3992151070838401, "mean_action_processing_ms": 0.24010030616372524, "mean_env_wait_ms": 0.18042671106018765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543853759765625, "StateBufferConnector_ms": 0.0031287670135498047, "ViewRequirementAgentConnector_ms": 0.09720087051391602}, "num_episodes": 22, "episode_return_max": 4.0, "episode_return_min": -1500.0, "episode_return_mean": -201.99, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.64020901807588, "num_env_steps_trained_throughput_per_sec": 82.64020901807588, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 49149.799, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49149.658, "sample_time_ms": 1149.599, "learn_time_ms": 47979.482, "learn_throughput": 83.369, "synch_weights_time_ms": 17.277}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-46-23", "timestamp": 1723502783, "time_this_iter_s": 48.434622049331665, "time_total_s": 4216.598639249802, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8838f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4216.598639249802, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 22.313043478260873, "ram_util_percent": 82.32028985507246}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5976036281970443, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1148566342220105, "policy_loss": -0.006517351533177866, "vf_loss": 2.120624198106231, "vf_explained_var": -4.4992739561373593e-05, "kl": 0.0049986162244253654, "entropy": 0.6869213247425342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.356361292767777, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3384625557553833, "policy_loss": -0.012672362532515927, "vf_loss": 2.349391487792686, "vf_explained_var": -0.0033474821577627193, "kl": 0.00871714531943531, "entropy": 1.2432808001205404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 6.0, "episode_reward_min": -1500.0, "episode_reward_mean": -189.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1900.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 7.0, "predator_policy": 925.0}, "policy_reward_mean": {"prey_policy": -204.65, "predator_policy": 109.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.0, 0.0, -344.0, -85.0, 0.0, -350.0, -1500.0, -59.0, -14.0, -149.0, -819.0, -39.0, -191.0, -32.0, -100.0, -34.0, -930.0, -95.0, -35.0, -521.0, -530.0, -136.0, -190.0, 0.0, -194.0, -281.0, -67.0, -148.0, -100.0, -35.0, -60.0, -218.0, -170.0, -60.0, -65.0, -1040.0, 0.0, -55.0, -93.0, -306.0, -195.0, -60.0, -200.0, -140.0, -407.0, -80.0, -30.0, -139.0, -96.0, -438.0, -35.0, -250.0, -427.0, -164.0, 0.0, -10.0, -70.0, -43.0, -145.0, -65.0, -300.0, -30.0, -140.0, 2.0, -48.0, -99.0, -173.0, -42.0, -70.0, -165.0, -330.0, -84.0, -485.0, -400.0, -273.0, -180.0, -155.0, -92.0, -40.0, -85.0, -955.0, -250.0, -365.0, -64.0, -55.0, -226.0, -273.0, -104.0, -88.0, -150.0, -155.0, -185.0, -65.0, 1.0, -60.0, 6.0, -6.0, -110.0, -335.0, -160.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-50.0, -338.0, 0.0, 0.0, -570.0, -149.0, -170.0, 0.0, 0.0, 0.0, -690.0, -40.0, -1030.0, -1040.0, -130.0, 6.0, -9.0, -140.0, -180.0, -89.0, -830.0, -759.0, -209.0, 0.0, -380.0, -6.0, -62.0, -10.0, -90.0, -110.0, -69.0, 0.0, -110.0, -1780.0, -190.0, 0.0, 0.0, -70.0, -46.0, -1010.0, -330.0, -570.0, -530.0, -36.0, -210.0, -190.0, 0.0, 0.0, 0.0, -419.0, -480.0, -186.0, -147.0, -20.0, -360.0, -248.0, -200.0, 0.0, 0.0, -105.0, -80.0, -40.0, 2.0, -440.0, -120.0, -110.0, -10.0, -100.0, -90.0, -160.0, -1900.0, -110.0, 0.0, 0.0, -110.0, 0.0, 0.0, -188.0, -450.0, -116.0, -120.0, -270.0, -140.0, -50.0, -140.0, -310.0, -370.0, 0.0, -755.0, -247.0, -160.0, 0.0, 0.0, -60.0, -394.0, 0.0, -66.0, -90.0, -1050.0, 2.0, -60.0, -10.0, -340.0, -380.0, -60.0, -747.0, -346.0, -28.0, 0.0, 0.0, 0.0, -20.0, 0.0, -140.0, 7.0, -100.0, -250.0, -40.0, -50.0, -110.0, -600.0, 0.0, 0.0, -60.0, -20.0, -260.0, 2.0, 0.0, -209.0, -99.0, -564.0, 0.0, -130.0, -228.0, 0.0, -87.0, -170.0, 0.0, 0.0, -550.0, 0.0, -690.0, -179.0, -140.0, -1020.0, -390.0, -480.0, -190.0, -328.0, -230.0, 0.0, -360.0, -10.0, -445.0, -187.0, 0.0, 0.0, -80.0, -10.0, -280.0, -1130.0, -570.0, -500.0, 0.0, -730.0, 0.0, -145.0, 6.0, -110.0, 0.0, -239.0, -217.0, -178.0, -570.0, -170.0, -54.0, -193.0, 0.0, -221.0, -144.0, 0.0, -530.0, -370.0, 0.0, 0.0, -140.0, 0.0, 1.0, 0.0, -120.0, -24.0, 5.0, 0.0, -16.0, -220.0, -70.0, -620.0, -50.0, -320.0, 0.0], "policy_predator_policy_reward": [90.0, 130.0, 0.0, 0.0, 180.0, 195.0, 85.0, 0.0, 0.0, 0.0, 25.0, 355.0, 450.0, 120.0, 0.0, 65.0, 70.0, 65.0, 115.0, 5.0, 355.0, 415.0, 90.0, 80.0, 50.0, 145.0, 40.0, 0.0, 0.0, 100.0, 30.0, 5.0, 925.0, 35.0, 75.0, 20.0, 35.0, 0.0, 400.0, 135.0, 145.0, 225.0, 190.0, 240.0, 115.0, 95.0, 0.0, 0.0, 130.0, 95.0, 320.0, 65.0, 25.0, 75.0, 155.0, 305.0, 25.0, 75.0, 45.0, 25.0, 50.0, 10.0, 220.0, 0.0, 60.0, 0.0, 40.0, 10.0, 70.0, 115.0, 920.0, 50.0, 0.0, 0.0, 15.0, 40.0, 95.0, 0.0, 215.0, 45.0, 60.0, 135.0, 55.0, 75.0, 165.0, 85.0, 80.0, 150.0, 140.0, 455.0, 0.0, 80.0, 20.0, 10.0, 100.0, 155.0, 45.0, 15.0, 185.0, 425.0, 30.0, 5.0, 195.0, 275.0, 25.0, 355.0, 155.0, 55.0, 0.0, 0.0, 0.0, 10.0, 0.0, 70.0, 0.0, 50.0, 125.0, 20.0, 55.0, 40.0, 45.0, 255.0, 0.0, 30.0, 130.0, 10.0, 0.0, 0.0, 120.0, 140.0, 215.0, 250.0, 5.0, 180.0, 25.0, 20.0, 20.0, 80.0, 180.0, 205.0, 70.0, 290.0, 160.0, 75.0, 515.0, 410.0, 190.0, 80.0, 215.0, 70.0, 180.0, 0.0, 170.0, 130.0, 0.0, 95.0, 40.0, 0.0, 90.0, 115.0, 475.0, 270.0, 70.0, 180.0, 140.0, 225.0, 0.0, 75.0, 55.0, 0.0, 95.0, 135.0, 325.0, 150.0, 10.0, 110.0, 65.0, 40.0, 85.0, 130.0, 160.0, 215.0, 185.0, 0.0, 40.0, 35.0, 0.0, 0.0, 0.0, 60.0, 20.0, 5.0, 0.0, 10.0, 60.0, 120.0, 25.0, 310.0, 160.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6083022257345242, "mean_inference_ms": 1.3978867272246998, "mean_action_processing_ms": 0.23983696029437915, "mean_env_wait_ms": 0.1803713429165752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035381317138671875, "StateBufferConnector_ms": 0.0031163692474365234, "ViewRequirementAgentConnector_ms": 0.09348618984222412}, "num_episodes": 18, "episode_return_max": 6.0, "episode_return_min": -1500.0, "episode_return_mean": -189.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.08124917510679, "num_env_steps_trained_throughput_per_sec": 82.08124917510679, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 49157.217, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49157.07, "sample_time_ms": 1139.828, "learn_time_ms": 47996.441, "learn_throughput": 83.34, "synch_weights_time_ms": 17.382}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-47-12", "timestamp": 1723502832, "time_this_iter_s": 48.79656195640564, "time_total_s": 4265.395201206207, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a883a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4265.395201206207, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 23.188405797101453, "ram_util_percent": 82.40434782608696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6374850372236873, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.626014545071062, "policy_loss": -0.006494864464427034, "vf_loss": 1.6319396136299011, "vf_explained_var": 0.0005384155366786573, "kl": 0.007597269423098544, "entropy": 0.6740776434777275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9074365078299134, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.890618674559568, "policy_loss": -0.010157684191184306, "vf_loss": 1.8996518063482153, "vf_explained_var": -0.00825485902488547, "kl": 0.005622766117604046, "entropy": 1.2917106393153075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 6.0, "episode_reward_min": -1040.0, "episode_reward_mean": -152.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1900.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -171.805, "predator_policy": 95.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -194.0, -281.0, -67.0, -148.0, -100.0, -35.0, -60.0, -218.0, -170.0, -60.0, -65.0, -1040.0, 0.0, -55.0, -93.0, -306.0, -195.0, -60.0, -200.0, -140.0, -407.0, -80.0, -30.0, -139.0, -96.0, -438.0, -35.0, -250.0, -427.0, -164.0, 0.0, -10.0, -70.0, -43.0, -145.0, -65.0, -300.0, -30.0, -140.0, 2.0, -48.0, -99.0, -173.0, -42.0, -70.0, -165.0, -330.0, -84.0, -485.0, -400.0, -273.0, -180.0, -155.0, -92.0, -40.0, -85.0, -955.0, -250.0, -365.0, -64.0, -55.0, -226.0, -273.0, -104.0, -88.0, -150.0, -155.0, -185.0, -65.0, 1.0, -60.0, 6.0, -6.0, -110.0, -335.0, -160.0, -3.0, -220.0, -60.0, -29.0, -130.0, -30.0, -31.0, -175.0, 0.0, -73.0, -55.0, -30.0, -34.0, -224.0, -30.0, -470.0, -156.0, -178.0, -70.0, -45.0, -380.0, -54.0, -140.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -419.0, -480.0, -186.0, -147.0, -20.0, -360.0, -248.0, -200.0, 0.0, 0.0, -105.0, -80.0, -40.0, 2.0, -440.0, -120.0, -110.0, -10.0, -100.0, -90.0, -160.0, -1900.0, -110.0, 0.0, 0.0, -110.0, 0.0, 0.0, -188.0, -450.0, -116.0, -120.0, -270.0, -140.0, -50.0, -140.0, -310.0, -370.0, 0.0, -755.0, -247.0, -160.0, 0.0, 0.0, -60.0, -394.0, 0.0, -66.0, -90.0, -1050.0, 2.0, -60.0, -10.0, -340.0, -380.0, -60.0, -747.0, -346.0, -28.0, 0.0, 0.0, 0.0, -20.0, 0.0, -140.0, 7.0, -100.0, -250.0, -40.0, -50.0, -110.0, -600.0, 0.0, 0.0, -60.0, -20.0, -260.0, 2.0, 0.0, -209.0, -99.0, -564.0, 0.0, -130.0, -228.0, 0.0, -87.0, -170.0, 0.0, 0.0, -550.0, 0.0, -690.0, -179.0, -140.0, -1020.0, -390.0, -480.0, -190.0, -328.0, -230.0, 0.0, -360.0, -10.0, -445.0, -187.0, 0.0, 0.0, -80.0, -10.0, -280.0, -1130.0, -570.0, -500.0, 0.0, -730.0, 0.0, -145.0, 6.0, -110.0, 0.0, -239.0, -217.0, -178.0, -570.0, -170.0, -54.0, -193.0, 0.0, -221.0, -144.0, 0.0, -530.0, -370.0, 0.0, 0.0, -140.0, 0.0, 1.0, 0.0, -120.0, -24.0, 5.0, 0.0, -16.0, -220.0, -70.0, -620.0, -50.0, -320.0, 0.0, -23.0, 0.0, -280.0, -160.0, 0.0, -120.0, 15.0, -159.0, 0.0, -260.0, -10.0, -40.0, -106.0, 0.0, -40.0, -290.0, 0.0, 0.0, -153.0, 0.0, 0.0, -110.0, -60.0, 0.0, 1.0, -70.0, -289.0, -145.0, -158.0, 3.0, -190.0, -830.0, -120.0, -266.0, -128.0, -210.0, -10.0, -120.0, -50.0, -40.0, -150.0, -620.0, -179.0, 0.0, -280.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 130.0, 95.0, 320.0, 65.0, 25.0, 75.0, 155.0, 305.0, 25.0, 75.0, 45.0, 25.0, 50.0, 10.0, 220.0, 0.0, 60.0, 0.0, 40.0, 10.0, 70.0, 115.0, 920.0, 50.0, 0.0, 0.0, 15.0, 40.0, 95.0, 0.0, 215.0, 45.0, 60.0, 135.0, 55.0, 75.0, 165.0, 85.0, 80.0, 150.0, 140.0, 455.0, 0.0, 80.0, 20.0, 10.0, 100.0, 155.0, 45.0, 15.0, 185.0, 425.0, 30.0, 5.0, 195.0, 275.0, 25.0, 355.0, 155.0, 55.0, 0.0, 0.0, 0.0, 10.0, 0.0, 70.0, 0.0, 50.0, 125.0, 20.0, 55.0, 40.0, 45.0, 255.0, 0.0, 30.0, 130.0, 10.0, 0.0, 0.0, 120.0, 140.0, 215.0, 250.0, 5.0, 180.0, 25.0, 20.0, 20.0, 80.0, 180.0, 205.0, 70.0, 290.0, 160.0, 75.0, 515.0, 410.0, 190.0, 80.0, 215.0, 70.0, 180.0, 0.0, 170.0, 130.0, 0.0, 95.0, 40.0, 0.0, 90.0, 115.0, 475.0, 270.0, 70.0, 180.0, 140.0, 225.0, 0.0, 75.0, 55.0, 0.0, 95.0, 135.0, 325.0, 150.0, 10.0, 110.0, 65.0, 40.0, 85.0, 130.0, 160.0, 215.0, 185.0, 0.0, 40.0, 35.0, 0.0, 0.0, 0.0, 60.0, 20.0, 5.0, 0.0, 10.0, 60.0, 120.0, 25.0, 310.0, 160.0, 0.0, 20.0, 0.0, 150.0, 70.0, 0.0, 60.0, 35.0, 80.0, 115.0, 15.0, 20.0, 0.0, 65.0, 10.0, 35.0, 120.0, 0.0, 0.0, 80.0, 0.0, 55.0, 0.0, 25.0, 5.0, 0.0, 35.0, 75.0, 135.0, 50.0, 75.0, 510.0, 40.0, 125.0, 105.0, 150.0, 10.0, 0.0, 60.0, 45.0, 0.0, 335.0, 55.0, 50.0, 75.0, 65.0, 75.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6082701363148256, "mean_inference_ms": 1.3964254042231188, "mean_action_processing_ms": 0.23961875189311663, "mean_env_wait_ms": 0.1801998199973995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004573822021484375, "StateBufferConnector_ms": 0.003178119659423828, "ViewRequirementAgentConnector_ms": 0.10180437564849854}, "num_episodes": 23, "episode_return_max": 6.0, "episode_return_min": -1040.0, "episode_return_mean": -152.91, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.87257770418448, "num_env_steps_trained_throughput_per_sec": 80.87257770418448, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 49262.382, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49262.234, "sample_time_ms": 1144.971, "learn_time_ms": 48095.575, "learn_throughput": 83.168, "synch_weights_time_ms": 18.343}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-48-01", "timestamp": 1723502881, "time_this_iter_s": 49.50487804412842, "time_total_s": 4314.900079250336, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab8a5dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4314.900079250336, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 24.268571428571427, "ram_util_percent": 83.01714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2990868630705688, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.074254011508649, "policy_loss": -0.006690412141362984, "vf_loss": 1.0804615454698996, "vf_explained_var": 0.00032065340450831823, "kl": 0.006438376567839569, "entropy": 0.7930204965450146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.022071327513488, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2491317010903484, "policy_loss": -0.015974616643938202, "vf_loss": 1.2640977310755896, "vf_explained_var": -0.02314397065097062, "kl": 0.005042923348824228, "entropy": 1.2799085219070394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 6.0, "episode_reward_min": -955.0, "episode_reward_mean": -132.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1130.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 515.0}, "policy_reward_mean": {"prey_policy": -151.995, "predator_policy": 85.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.0, -200.0, -140.0, -407.0, -80.0, -30.0, -139.0, -96.0, -438.0, -35.0, -250.0, -427.0, -164.0, 0.0, -10.0, -70.0, -43.0, -145.0, -65.0, -300.0, -30.0, -140.0, 2.0, -48.0, -99.0, -173.0, -42.0, -70.0, -165.0, -330.0, -84.0, -485.0, -400.0, -273.0, -180.0, -155.0, -92.0, -40.0, -85.0, -955.0, -250.0, -365.0, -64.0, -55.0, -226.0, -273.0, -104.0, -88.0, -150.0, -155.0, -185.0, -65.0, 1.0, -60.0, 6.0, -6.0, -110.0, -335.0, -160.0, -3.0, -220.0, -60.0, -29.0, -130.0, -30.0, -31.0, -175.0, 0.0, -73.0, -55.0, -30.0, -34.0, -224.0, -30.0, -470.0, -156.0, -178.0, -70.0, -45.0, -380.0, -54.0, -140.0, 0.0, -78.0, 0.0, -15.0, -89.0, -15.0, -24.0, -270.0, -51.0, 0.0, -185.0, -15.0, -54.0, -4.0, -68.0, -76.0, -35.0, -91.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-140.0, -50.0, -140.0, -310.0, -370.0, 0.0, -755.0, -247.0, -160.0, 0.0, 0.0, -60.0, -394.0, 0.0, -66.0, -90.0, -1050.0, 2.0, -60.0, -10.0, -340.0, -380.0, -60.0, -747.0, -346.0, -28.0, 0.0, 0.0, 0.0, -20.0, 0.0, -140.0, 7.0, -100.0, -250.0, -40.0, -50.0, -110.0, -600.0, 0.0, 0.0, -60.0, -20.0, -260.0, 2.0, 0.0, -209.0, -99.0, -564.0, 0.0, -130.0, -228.0, 0.0, -87.0, -170.0, 0.0, 0.0, -550.0, 0.0, -690.0, -179.0, -140.0, -1020.0, -390.0, -480.0, -190.0, -328.0, -230.0, 0.0, -360.0, -10.0, -445.0, -187.0, 0.0, 0.0, -80.0, -10.0, -280.0, -1130.0, -570.0, -500.0, 0.0, -730.0, 0.0, -145.0, 6.0, -110.0, 0.0, -239.0, -217.0, -178.0, -570.0, -170.0, -54.0, -193.0, 0.0, -221.0, -144.0, 0.0, -530.0, -370.0, 0.0, 0.0, -140.0, 0.0, 1.0, 0.0, -120.0, -24.0, 5.0, 0.0, -16.0, -220.0, -70.0, -620.0, -50.0, -320.0, 0.0, -23.0, 0.0, -280.0, -160.0, 0.0, -120.0, 15.0, -159.0, 0.0, -260.0, -10.0, -40.0, -106.0, 0.0, -40.0, -290.0, 0.0, 0.0, -153.0, 0.0, 0.0, -110.0, -60.0, 0.0, 1.0, -70.0, -289.0, -145.0, -158.0, 3.0, -190.0, -830.0, -120.0, -266.0, -128.0, -210.0, -10.0, -120.0, -50.0, -40.0, -150.0, -620.0, -179.0, 0.0, -280.0, 0.0, 0.0, 0.0, -158.0, 0.0, 0.0, 0.0, -30.0, 0.0, -154.0, -20.0, -255.0, 0.0, -49.0, 0.0, -540.0, -70.0, -96.0, -10.0, 0.0, 0.0, 0.0, -440.0, -45.0, 0.0, -109.0, 0.0, 0.0, -19.0, -60.0, -93.0, -100.0, -66.0, -100.0, 0.0, -181.0, -20.0], "policy_predator_policy_reward": [55.0, 75.0, 165.0, 85.0, 80.0, 150.0, 140.0, 455.0, 0.0, 80.0, 20.0, 10.0, 100.0, 155.0, 45.0, 15.0, 185.0, 425.0, 30.0, 5.0, 195.0, 275.0, 25.0, 355.0, 155.0, 55.0, 0.0, 0.0, 0.0, 10.0, 0.0, 70.0, 0.0, 50.0, 125.0, 20.0, 55.0, 40.0, 45.0, 255.0, 0.0, 30.0, 130.0, 10.0, 0.0, 0.0, 120.0, 140.0, 215.0, 250.0, 5.0, 180.0, 25.0, 20.0, 20.0, 80.0, 180.0, 205.0, 70.0, 290.0, 160.0, 75.0, 515.0, 410.0, 190.0, 80.0, 215.0, 70.0, 180.0, 0.0, 170.0, 130.0, 0.0, 95.0, 40.0, 0.0, 90.0, 115.0, 475.0, 270.0, 70.0, 180.0, 140.0, 225.0, 0.0, 75.0, 55.0, 0.0, 95.0, 135.0, 325.0, 150.0, 10.0, 110.0, 65.0, 40.0, 85.0, 130.0, 160.0, 215.0, 185.0, 0.0, 40.0, 35.0, 0.0, 0.0, 0.0, 60.0, 20.0, 5.0, 0.0, 10.0, 60.0, 120.0, 25.0, 310.0, 160.0, 0.0, 20.0, 0.0, 150.0, 70.0, 0.0, 60.0, 35.0, 80.0, 115.0, 15.0, 20.0, 0.0, 65.0, 10.0, 35.0, 120.0, 0.0, 0.0, 80.0, 0.0, 55.0, 0.0, 25.0, 5.0, 0.0, 35.0, 75.0, 135.0, 50.0, 75.0, 510.0, 40.0, 125.0, 105.0, 150.0, 10.0, 0.0, 60.0, 45.0, 0.0, 335.0, 55.0, 50.0, 75.0, 65.0, 75.0, 0.0, 0.0, 50.0, 30.0, 0.0, 0.0, 0.0, 15.0, 0.0, 85.0, 115.0, 125.0, 25.0, 0.0, 70.0, 270.0, 55.0, 0.0, 0.0, 0.0, 210.0, 45.0, 0.0, 30.0, 55.0, 0.0, 0.0, 15.0, 85.0, 0.0, 0.0, 90.0, 15.0, 50.0, 110.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6093647564756896, "mean_inference_ms": 1.3988126061486696, "mean_action_processing_ms": 0.23981618978561126, "mean_env_wait_ms": 0.1804870422431388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005406737327575684, "StateBufferConnector_ms": 0.00476682186126709, "ViewRequirementAgentConnector_ms": 0.11845016479492188}, "num_episodes": 18, "episode_return_max": 6.0, "episode_return_min": -955.0, "episode_return_mean": -132.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.29425402155574, "num_env_steps_trained_throughput_per_sec": 79.29425402155574, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 49410.063, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49409.911, "sample_time_ms": 1242.836, "learn_time_ms": 48145.552, "learn_throughput": 83.081, "synch_weights_time_ms": 18.183}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-48-52", "timestamp": 1723502932, "time_this_iter_s": 50.48521709442139, "time_total_s": 4365.385296344757, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a883aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4365.385296344757, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 26.90277777777778, "ram_util_percent": 81.9263888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.840869967221583, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3292374394558095, "policy_loss": -0.00602672579304054, "vf_loss": 1.334654655626842, "vf_explained_var": -0.0011134675886265186, "kl": 0.008126751244368107, "entropy": 0.6352872963304873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8614353632327743, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8269973846024306, "policy_loss": -0.012553788919898647, "vf_loss": 1.8380280517396472, "vf_explained_var": -0.0035520887879467514, "kl": 0.0076156004312985985, "entropy": 1.2657977487675096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 46.0, "episode_reward_min": -955.0, "episode_reward_mean": -114.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1130.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 52.0, "predator_policy": 515.0}, "policy_reward_mean": {"prey_policy": -133.585, "predator_policy": 76.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.0, -300.0, -30.0, -140.0, 2.0, -48.0, -99.0, -173.0, -42.0, -70.0, -165.0, -330.0, -84.0, -485.0, -400.0, -273.0, -180.0, -155.0, -92.0, -40.0, -85.0, -955.0, -250.0, -365.0, -64.0, -55.0, -226.0, -273.0, -104.0, -88.0, -150.0, -155.0, -185.0, -65.0, 1.0, -60.0, 6.0, -6.0, -110.0, -335.0, -160.0, -3.0, -220.0, -60.0, -29.0, -130.0, -30.0, -31.0, -175.0, 0.0, -73.0, -55.0, -30.0, -34.0, -224.0, -30.0, -470.0, -156.0, -178.0, -70.0, -45.0, -380.0, -54.0, -140.0, 0.0, -78.0, 0.0, -15.0, -89.0, -15.0, -24.0, -270.0, -51.0, 0.0, -185.0, -15.0, -54.0, -4.0, -68.0, -76.0, -35.0, -91.0, 0.0, -95.0, 22.0, -138.0, -59.0, -55.0, -25.0, -75.0, -140.0, -100.0, -95.0, 8.0, -130.0, 23.0, 46.0, 22.0, -138.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-50.0, -110.0, -600.0, 0.0, 0.0, -60.0, -20.0, -260.0, 2.0, 0.0, -209.0, -99.0, -564.0, 0.0, -130.0, -228.0, 0.0, -87.0, -170.0, 0.0, 0.0, -550.0, 0.0, -690.0, -179.0, -140.0, -1020.0, -390.0, -480.0, -190.0, -328.0, -230.0, 0.0, -360.0, -10.0, -445.0, -187.0, 0.0, 0.0, -80.0, -10.0, -280.0, -1130.0, -570.0, -500.0, 0.0, -730.0, 0.0, -145.0, 6.0, -110.0, 0.0, -239.0, -217.0, -178.0, -570.0, -170.0, -54.0, -193.0, 0.0, -221.0, -144.0, 0.0, -530.0, -370.0, 0.0, 0.0, -140.0, 0.0, 1.0, 0.0, -120.0, -24.0, 5.0, 0.0, -16.0, -220.0, -70.0, -620.0, -50.0, -320.0, 0.0, -23.0, 0.0, -280.0, -160.0, 0.0, -120.0, 15.0, -159.0, 0.0, -260.0, -10.0, -40.0, -106.0, 0.0, -40.0, -290.0, 0.0, 0.0, -153.0, 0.0, 0.0, -110.0, -60.0, 0.0, 1.0, -70.0, -289.0, -145.0, -158.0, 3.0, -190.0, -830.0, -120.0, -266.0, -128.0, -210.0, -10.0, -120.0, -50.0, -40.0, -150.0, -620.0, -179.0, 0.0, -280.0, 0.0, 0.0, 0.0, -158.0, 0.0, 0.0, 0.0, -30.0, 0.0, -154.0, -20.0, -255.0, 0.0, -49.0, 0.0, -540.0, -70.0, -96.0, -10.0, 0.0, 0.0, 0.0, -440.0, -45.0, 0.0, -109.0, 0.0, 0.0, -19.0, -60.0, -93.0, -100.0, -66.0, -100.0, 0.0, -181.0, -20.0, 0.0, 0.0, -40.0, -150.0, 22.0, 0.0, -640.0, -23.0, -169.0, 0.0, 0.0, -110.0, 0.0, -50.0, 0.0, -320.0, -150.0, -70.0, -160.0, -40.0, -220.0, 0.0, 0.0, -2.0, -150.0, -60.0, 28.0, -60.0, 46.0, 0.0, 27.0, -10.0, -50.0, -218.0, 52.0, -145.0], "policy_predator_policy_reward": [55.0, 40.0, 45.0, 255.0, 0.0, 30.0, 130.0, 10.0, 0.0, 0.0, 120.0, 140.0, 215.0, 250.0, 5.0, 180.0, 25.0, 20.0, 20.0, 80.0, 180.0, 205.0, 70.0, 290.0, 160.0, 75.0, 515.0, 410.0, 190.0, 80.0, 215.0, 70.0, 180.0, 0.0, 170.0, 130.0, 0.0, 95.0, 40.0, 0.0, 90.0, 115.0, 475.0, 270.0, 70.0, 180.0, 140.0, 225.0, 0.0, 75.0, 55.0, 0.0, 95.0, 135.0, 325.0, 150.0, 10.0, 110.0, 65.0, 40.0, 85.0, 130.0, 160.0, 215.0, 185.0, 0.0, 40.0, 35.0, 0.0, 0.0, 0.0, 60.0, 20.0, 5.0, 0.0, 10.0, 60.0, 120.0, 25.0, 310.0, 160.0, 0.0, 20.0, 0.0, 150.0, 70.0, 0.0, 60.0, 35.0, 80.0, 115.0, 15.0, 20.0, 0.0, 65.0, 10.0, 35.0, 120.0, 0.0, 0.0, 80.0, 0.0, 55.0, 0.0, 25.0, 5.0, 0.0, 35.0, 75.0, 135.0, 50.0, 75.0, 510.0, 40.0, 125.0, 105.0, 150.0, 10.0, 0.0, 60.0, 45.0, 0.0, 335.0, 55.0, 50.0, 75.0, 65.0, 75.0, 0.0, 0.0, 50.0, 30.0, 0.0, 0.0, 0.0, 15.0, 0.0, 85.0, 115.0, 125.0, 25.0, 0.0, 70.0, 270.0, 55.0, 0.0, 0.0, 0.0, 210.0, 45.0, 0.0, 30.0, 55.0, 0.0, 0.0, 15.0, 85.0, 0.0, 0.0, 90.0, 15.0, 50.0, 110.0, 0.0, 0.0, 0.0, 20.0, 75.0, 0.0, 0.0, 200.0, 325.0, 15.0, 95.0, 55.0, 0.0, 25.0, 0.0, 85.0, 160.0, 0.0, 80.0, 80.0, 20.0, 15.0, 110.0, 0.0, 10.0, 0.0, 80.0, 0.0, 55.0, 0.0, 0.0, 0.0, 5.0, 50.0, 80.0, 65.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6103546669513032, "mean_inference_ms": 1.400867060456318, "mean_action_processing_ms": 0.24000394655176735, "mean_env_wait_ms": 0.18076202319689016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006049156188964844, "StateBufferConnector_ms": 0.004821419715881348, "ViewRequirementAgentConnector_ms": 0.11831045150756836}, "num_episodes": 18, "episode_return_max": 46.0, "episode_return_min": -955.0, "episode_return_mean": -114.67, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.89575959086575, "num_env_steps_trained_throughput_per_sec": 82.89575959086575, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 49283.112, "restore_workers_time_ms": 0.013, "training_step_time_ms": 49283.04, "sample_time_ms": 1225.888, "learn_time_ms": 48035.831, "learn_throughput": 83.271, "synch_weights_time_ms": 18.187}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-49-40", "timestamp": 1723502980, "time_this_iter_s": 48.33069610595703, "time_total_s": 4413.715992450714, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a8838820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4413.715992450714, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 23.137681159420286, "ram_util_percent": 81.08260869565216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4750974996853128, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4724007640566146, "policy_loss": -0.009390951826350477, "vf_loss": 1.481113781610494, "vf_explained_var": 0.0016289909049947426, "kl": 0.009039106979176379, "entropy": 0.5969073485445093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.32924990240859, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8674948494585732, "policy_loss": -0.017311655499888633, "vf_loss": 1.883136906857213, "vf_explained_var": -0.01602252138354791, "kl": 0.0083479762512665, "entropy": 1.30228104767976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 46.0, "episode_reward_min": -470.0, "episode_reward_mean": -90.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -830.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 52.0, "predator_policy": 510.0}, "policy_reward_mean": {"prey_policy": -103.505, "predator_policy": 58.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-250.0, -365.0, -64.0, -55.0, -226.0, -273.0, -104.0, -88.0, -150.0, -155.0, -185.0, -65.0, 1.0, -60.0, 6.0, -6.0, -110.0, -335.0, -160.0, -3.0, -220.0, -60.0, -29.0, -130.0, -30.0, -31.0, -175.0, 0.0, -73.0, -55.0, -30.0, -34.0, -224.0, -30.0, -470.0, -156.0, -178.0, -70.0, -45.0, -380.0, -54.0, -140.0, 0.0, -78.0, 0.0, -15.0, -89.0, -15.0, -24.0, -270.0, -51.0, 0.0, -185.0, -15.0, -54.0, -4.0, -68.0, -76.0, -35.0, -91.0, 0.0, -95.0, 22.0, -138.0, -59.0, -55.0, -25.0, -75.0, -140.0, -100.0, -95.0, 8.0, -130.0, 23.0, 46.0, 22.0, -138.0, 2.0, 0.0, 0.0, -198.0, 25.0, -45.0, -175.0, -15.0, -66.0, -20.0, -65.0, -234.0, -150.0, -135.0, -110.0, -65.0, 8.0, -155.0, -20.0, 0.0, -153.0, -50.0, -150.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-500.0, 0.0, -730.0, 0.0, -145.0, 6.0, -110.0, 0.0, -239.0, -217.0, -178.0, -570.0, -170.0, -54.0, -193.0, 0.0, -221.0, -144.0, 0.0, -530.0, -370.0, 0.0, 0.0, -140.0, 0.0, 1.0, 0.0, -120.0, -24.0, 5.0, 0.0, -16.0, -220.0, -70.0, -620.0, -50.0, -320.0, 0.0, -23.0, 0.0, -280.0, -160.0, 0.0, -120.0, 15.0, -159.0, 0.0, -260.0, -10.0, -40.0, -106.0, 0.0, -40.0, -290.0, 0.0, 0.0, -153.0, 0.0, 0.0, -110.0, -60.0, 0.0, 1.0, -70.0, -289.0, -145.0, -158.0, 3.0, -190.0, -830.0, -120.0, -266.0, -128.0, -210.0, -10.0, -120.0, -50.0, -40.0, -150.0, -620.0, -179.0, 0.0, -280.0, 0.0, 0.0, 0.0, -158.0, 0.0, 0.0, 0.0, -30.0, 0.0, -154.0, -20.0, -255.0, 0.0, -49.0, 0.0, -540.0, -70.0, -96.0, -10.0, 0.0, 0.0, 0.0, -440.0, -45.0, 0.0, -109.0, 0.0, 0.0, -19.0, -60.0, -93.0, -100.0, -66.0, -100.0, 0.0, -181.0, -20.0, 0.0, 0.0, -40.0, -150.0, 22.0, 0.0, -640.0, -23.0, -169.0, 0.0, 0.0, -110.0, 0.0, -50.0, 0.0, -320.0, -150.0, -70.0, -160.0, -40.0, -220.0, 0.0, 0.0, -2.0, -150.0, -60.0, 28.0, -60.0, 46.0, 0.0, 27.0, -10.0, -50.0, -218.0, 52.0, -145.0, 0.0, 0.0, 0.0, 0.0, -30.0, -393.0, 35.0, -30.0, 0.0, -90.0, -20.0, -330.0, 0.0, -30.0, -151.0, 0.0, -40.0, 0.0, -100.0, -30.0, -567.0, 43.0, -160.0, -70.0, -50.0, -170.0, -190.0, -30.0, 0.0, -130.0, -17.0, 0.0, -340.0, -130.0, -13.0, -82.0, 0.0, 0.0, -3.0, -300.0, 0.0, -100.0, -300.0, -20.0], "policy_predator_policy_reward": [70.0, 180.0, 140.0, 225.0, 0.0, 75.0, 55.0, 0.0, 95.0, 135.0, 325.0, 150.0, 10.0, 110.0, 65.0, 40.0, 85.0, 130.0, 160.0, 215.0, 185.0, 0.0, 40.0, 35.0, 0.0, 0.0, 0.0, 60.0, 20.0, 5.0, 0.0, 10.0, 60.0, 120.0, 25.0, 310.0, 160.0, 0.0, 20.0, 0.0, 150.0, 70.0, 0.0, 60.0, 35.0, 80.0, 115.0, 15.0, 20.0, 0.0, 65.0, 10.0, 35.0, 120.0, 0.0, 0.0, 80.0, 0.0, 55.0, 0.0, 25.0, 5.0, 0.0, 35.0, 75.0, 135.0, 50.0, 75.0, 510.0, 40.0, 125.0, 105.0, 150.0, 10.0, 0.0, 60.0, 45.0, 0.0, 335.0, 55.0, 50.0, 75.0, 65.0, 75.0, 0.0, 0.0, 50.0, 30.0, 0.0, 0.0, 0.0, 15.0, 0.0, 85.0, 115.0, 125.0, 25.0, 0.0, 70.0, 270.0, 55.0, 0.0, 0.0, 0.0, 210.0, 45.0, 0.0, 30.0, 55.0, 0.0, 0.0, 15.0, 85.0, 0.0, 0.0, 90.0, 15.0, 50.0, 110.0, 0.0, 0.0, 0.0, 20.0, 75.0, 0.0, 0.0, 200.0, 325.0, 15.0, 95.0, 55.0, 0.0, 25.0, 0.0, 85.0, 160.0, 0.0, 80.0, 80.0, 20.0, 15.0, 110.0, 0.0, 10.0, 0.0, 80.0, 0.0, 55.0, 0.0, 0.0, 0.0, 5.0, 50.0, 80.0, 65.0, 30.0, 0.0, 0.0, 0.0, 0.0, 210.0, 15.0, 15.0, 5.0, 0.0, 45.0, 175.0, 0.0, 15.0, 0.0, 0.0, 85.0, 20.0, 0.0, 15.0, 50.0, 165.0, 125.0, 70.0, 10.0, 0.0, 85.0, 15.0, 95.0, 65.0, 0.0, 0.0, 25.0, 180.0, 135.0, 75.0, 0.0, 0.0, 0.0, 150.0, 0.0, 50.0, 0.0, 10.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6110268375194989, "mean_inference_ms": 1.4031569288986914, "mean_action_processing_ms": 0.24023834003268998, "mean_env_wait_ms": 0.18106299119070005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068607330322265625, "StateBufferConnector_ms": 0.0049741268157958984, "ViewRequirementAgentConnector_ms": 0.12303292751312256}, "num_episodes": 22, "episode_return_max": 46.0, "episode_return_min": -470.0, "episode_return_mean": -90.31, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.49857120664424, "num_env_steps_trained_throughput_per_sec": 81.49857120664424, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 49285.127, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49285.059, "sample_time_ms": 1205.876, "learn_time_ms": 48057.727, "learn_throughput": 83.233, "synch_weights_time_ms": 18.159}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-50-29", "timestamp": 1723503029, "time_this_iter_s": 49.108619928359985, "time_total_s": 4462.824612379074, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab87df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4462.824612379074, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 24.178571428571427, "ram_util_percent": 81.31571428571431}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4313822035593962, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3441347921651507, "policy_loss": -0.005985917014971612, "vf_loss": 1.3497253058133303, "vf_explained_var": 0.002717866405608162, "kl": 0.0052720118687215375, "entropy": 0.6486556276127144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4316677033901213, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7240259893356809, "policy_loss": -0.012836871807532454, "vf_loss": 1.735590195403528, "vf_explained_var": 3.1611212977656615e-05, "kl": 0.006363317416270085, "entropy": 1.273225402453589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 89.0, "episode_reward_min": -470.0, "episode_reward_mean": -74.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -830.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 89.0, "predator_policy": 510.0}, "policy_reward_mean": {"prey_policy": -87.175, "predator_policy": 50.025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.0, -30.0, -31.0, -175.0, 0.0, -73.0, -55.0, -30.0, -34.0, -224.0, -30.0, -470.0, -156.0, -178.0, -70.0, -45.0, -380.0, -54.0, -140.0, 0.0, -78.0, 0.0, -15.0, -89.0, -15.0, -24.0, -270.0, -51.0, 0.0, -185.0, -15.0, -54.0, -4.0, -68.0, -76.0, -35.0, -91.0, 0.0, -95.0, 22.0, -138.0, -59.0, -55.0, -25.0, -75.0, -140.0, -100.0, -95.0, 8.0, -130.0, 23.0, 46.0, 22.0, -138.0, 2.0, 0.0, 0.0, -198.0, 25.0, -45.0, -175.0, -15.0, -66.0, -20.0, -65.0, -234.0, -150.0, -135.0, -110.0, -65.0, 8.0, -155.0, -20.0, 0.0, -153.0, -50.0, -150.0, -230.0, 0.0, 18.0, -64.0, 39.0, 0.0, -5.0, -70.0, -40.0, -100.0, 89.0, 26.0, -10.0, -44.0, 13.0, -151.0, -257.0, -5.0, -59.0, -20.0, -250.0, -160.0, -75.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -260.0, -10.0, -40.0, -106.0, 0.0, -40.0, -290.0, 0.0, 0.0, -153.0, 0.0, 0.0, -110.0, -60.0, 0.0, 1.0, -70.0, -289.0, -145.0, -158.0, 3.0, -190.0, -830.0, -120.0, -266.0, -128.0, -210.0, -10.0, -120.0, -50.0, -40.0, -150.0, -620.0, -179.0, 0.0, -280.0, 0.0, 0.0, 0.0, -158.0, 0.0, 0.0, 0.0, -30.0, 0.0, -154.0, -20.0, -255.0, 0.0, -49.0, 0.0, -540.0, -70.0, -96.0, -10.0, 0.0, 0.0, 0.0, -440.0, -45.0, 0.0, -109.0, 0.0, 0.0, -19.0, -60.0, -93.0, -100.0, -66.0, -100.0, 0.0, -181.0, -20.0, 0.0, 0.0, -40.0, -150.0, 22.0, 0.0, -640.0, -23.0, -169.0, 0.0, 0.0, -110.0, 0.0, -50.0, 0.0, -320.0, -150.0, -70.0, -160.0, -40.0, -220.0, 0.0, 0.0, -2.0, -150.0, -60.0, 28.0, -60.0, 46.0, 0.0, 27.0, -10.0, -50.0, -218.0, 52.0, -145.0, 0.0, 0.0, 0.0, 0.0, -30.0, -393.0, 35.0, -30.0, 0.0, -90.0, -20.0, -330.0, 0.0, -30.0, -151.0, 0.0, -40.0, 0.0, -100.0, -30.0, -567.0, 43.0, -160.0, -70.0, -50.0, -170.0, -190.0, -30.0, 0.0, -130.0, -17.0, 0.0, -340.0, -130.0, -13.0, -82.0, 0.0, 0.0, -3.0, -300.0, 0.0, -100.0, -300.0, -20.0, -180.0, -250.0, 0.0, 0.0, 18.0, 0.0, -109.0, -20.0, 39.0, 0.0, 0.0, 0.0, -10.0, 0.0, -80.0, -30.0, 0.0, -80.0, 0.0, -200.0, 89.0, 0.0, -190.0, 61.0, -20.0, 0.0, -50.0, -49.0, 13.0, 0.0, -84.0, -452.0, -220.0, -327.0, -10.0, 0.0, -64.0, -60.0, 0.0, -50.0, -465.0, -110.0, -360.0, 0.0, -150.0, 0.0], "policy_predator_policy_reward": [115.0, 15.0, 20.0, 0.0, 65.0, 10.0, 35.0, 120.0, 0.0, 0.0, 80.0, 0.0, 55.0, 0.0, 25.0, 5.0, 0.0, 35.0, 75.0, 135.0, 50.0, 75.0, 510.0, 40.0, 125.0, 105.0, 150.0, 10.0, 0.0, 60.0, 45.0, 0.0, 335.0, 55.0, 50.0, 75.0, 65.0, 75.0, 0.0, 0.0, 50.0, 30.0, 0.0, 0.0, 0.0, 15.0, 0.0, 85.0, 115.0, 125.0, 25.0, 0.0, 70.0, 270.0, 55.0, 0.0, 0.0, 0.0, 210.0, 45.0, 0.0, 30.0, 55.0, 0.0, 0.0, 15.0, 85.0, 0.0, 0.0, 90.0, 15.0, 50.0, 110.0, 0.0, 0.0, 0.0, 20.0, 75.0, 0.0, 0.0, 200.0, 325.0, 15.0, 95.0, 55.0, 0.0, 25.0, 0.0, 85.0, 160.0, 0.0, 80.0, 80.0, 20.0, 15.0, 110.0, 0.0, 10.0, 0.0, 80.0, 0.0, 55.0, 0.0, 0.0, 0.0, 5.0, 50.0, 80.0, 65.0, 30.0, 0.0, 0.0, 0.0, 0.0, 210.0, 15.0, 15.0, 5.0, 0.0, 45.0, 175.0, 0.0, 15.0, 0.0, 0.0, 85.0, 20.0, 0.0, 15.0, 50.0, 165.0, 125.0, 70.0, 10.0, 0.0, 85.0, 15.0, 95.0, 65.0, 0.0, 0.0, 25.0, 180.0, 135.0, 75.0, 0.0, 0.0, 0.0, 150.0, 0.0, 50.0, 0.0, 10.0, 160.0, 140.0, 60.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 40.0, 0.0, 40.0, 0.0, 0.0, 100.0, 0.0, 0.0, 115.0, 40.0, 10.0, 0.0, 25.0, 30.0, 0.0, 0.0, 195.0, 190.0, 50.0, 240.0, 5.0, 0.0, 10.0, 55.0, 5.0, 25.0, 270.0, 55.0, 145.0, 55.0, 75.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6122488745778614, "mean_inference_ms": 1.4055584942989368, "mean_action_processing_ms": 0.24036482292217648, "mean_env_wait_ms": 0.18136509903089398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006944537162780762, "StateBufferConnector_ms": 0.004905104637145996, "ViewRequirementAgentConnector_ms": 0.12362420558929443}, "num_episodes": 23, "episode_return_max": 89.0, "episode_return_min": -470.0, "episode_return_mean": -74.3, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.74158433934879, "num_env_steps_trained_throughput_per_sec": 82.74158433934879, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 49251.201, "restore_workers_time_ms": 0.013, "training_step_time_ms": 49251.132, "sample_time_ms": 1206.909, "learn_time_ms": 48024.675, "learn_throughput": 83.291, "synch_weights_time_ms": 16.299}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-51-18", "timestamp": 1723503078, "time_this_iter_s": 48.38859796524048, "time_total_s": 4511.213210344315, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a883af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4511.213210344315, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 22.930882352941175, "ram_util_percent": 81.01617647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5835078844317683, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2085494104831938, "policy_loss": -0.005286577327925928, "vf_loss": 1.2132294728169366, "vf_explained_var": 0.004632675206219708, "kl": 0.008086889231520806, "entropy": 0.6802212390004012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0119954900451438, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5258086800259887, "policy_loss": -0.012755927300602985, "vf_loss": 1.537186889894425, "vf_explained_var": -0.024215545572301066, "kl": 0.00688857818053553, "entropy": 1.3204907072284233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 89.0, "episode_reward_min": -314.0, "episode_reward_mean": -73.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -640.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 89.0, "predator_policy": 325.0}, "policy_reward_mean": {"prey_policy": -85.1, "predator_policy": 48.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-140.0, 0.0, -78.0, 0.0, -15.0, -89.0, -15.0, -24.0, -270.0, -51.0, 0.0, -185.0, -15.0, -54.0, -4.0, -68.0, -76.0, -35.0, -91.0, 0.0, -95.0, 22.0, -138.0, -59.0, -55.0, -25.0, -75.0, -140.0, -100.0, -95.0, 8.0, -130.0, 23.0, 46.0, 22.0, -138.0, 2.0, 0.0, 0.0, -198.0, 25.0, -45.0, -175.0, -15.0, -66.0, -20.0, -65.0, -234.0, -150.0, -135.0, -110.0, -65.0, 8.0, -155.0, -20.0, 0.0, -153.0, -50.0, -150.0, -230.0, 0.0, 18.0, -64.0, 39.0, 0.0, -5.0, -70.0, -40.0, -100.0, 89.0, 26.0, -10.0, -44.0, 13.0, -151.0, -257.0, -5.0, -59.0, -20.0, -250.0, -160.0, -75.0, -134.0, 2.0, -150.0, -314.0, -50.0, 0.0, -5.0, -207.0, -80.0, -237.0, -145.0, -35.0, -225.0, -205.0, 6.0, -250.0, -6.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-280.0, 0.0, 0.0, 0.0, -158.0, 0.0, 0.0, 0.0, -30.0, 0.0, -154.0, -20.0, -255.0, 0.0, -49.0, 0.0, -540.0, -70.0, -96.0, -10.0, 0.0, 0.0, 0.0, -440.0, -45.0, 0.0, -109.0, 0.0, 0.0, -19.0, -60.0, -93.0, -100.0, -66.0, -100.0, 0.0, -181.0, -20.0, 0.0, 0.0, -40.0, -150.0, 22.0, 0.0, -640.0, -23.0, -169.0, 0.0, 0.0, -110.0, 0.0, -50.0, 0.0, -320.0, -150.0, -70.0, -160.0, -40.0, -220.0, 0.0, 0.0, -2.0, -150.0, -60.0, 28.0, -60.0, 46.0, 0.0, 27.0, -10.0, -50.0, -218.0, 52.0, -145.0, 0.0, 0.0, 0.0, 0.0, -30.0, -393.0, 35.0, -30.0, 0.0, -90.0, -20.0, -330.0, 0.0, -30.0, -151.0, 0.0, -40.0, 0.0, -100.0, -30.0, -567.0, 43.0, -160.0, -70.0, -50.0, -170.0, -190.0, -30.0, 0.0, -130.0, -17.0, 0.0, -340.0, -130.0, -13.0, -82.0, 0.0, 0.0, -3.0, -300.0, 0.0, -100.0, -300.0, -20.0, -180.0, -250.0, 0.0, 0.0, 18.0, 0.0, -109.0, -20.0, 39.0, 0.0, 0.0, 0.0, -10.0, 0.0, -80.0, -30.0, 0.0, -80.0, 0.0, -200.0, 89.0, 0.0, -190.0, 61.0, -20.0, 0.0, -50.0, -49.0, 13.0, 0.0, -84.0, -452.0, -220.0, -327.0, -10.0, 0.0, -64.0, -60.0, 0.0, -50.0, -465.0, -110.0, -360.0, 0.0, -150.0, 0.0, -540.0, 11.0, 2.0, 0.0, 0.0, -460.0, -250.0, -189.0, -35.0, -110.0, 0.0, 0.0, 0.0, -10.0, -162.0, -145.0, -160.0, 0.0, -242.0, -270.0, -120.0, -140.0, -30.0, -20.0, -90.0, -360.0, -110.0, -320.0, 21.0, -30.0, -170.0, -190.0, 0.0, -106.0, 0.0, 0.0], "policy_predator_policy_reward": [65.0, 75.0, 0.0, 0.0, 50.0, 30.0, 0.0, 0.0, 0.0, 15.0, 0.0, 85.0, 115.0, 125.0, 25.0, 0.0, 70.0, 270.0, 55.0, 0.0, 0.0, 0.0, 210.0, 45.0, 0.0, 30.0, 55.0, 0.0, 0.0, 15.0, 85.0, 0.0, 0.0, 90.0, 15.0, 50.0, 110.0, 0.0, 0.0, 0.0, 20.0, 75.0, 0.0, 0.0, 200.0, 325.0, 15.0, 95.0, 55.0, 0.0, 25.0, 0.0, 85.0, 160.0, 0.0, 80.0, 80.0, 20.0, 15.0, 110.0, 0.0, 10.0, 0.0, 80.0, 0.0, 55.0, 0.0, 0.0, 0.0, 5.0, 50.0, 80.0, 65.0, 30.0, 0.0, 0.0, 0.0, 0.0, 210.0, 15.0, 15.0, 5.0, 0.0, 45.0, 175.0, 0.0, 15.0, 0.0, 0.0, 85.0, 20.0, 0.0, 15.0, 50.0, 165.0, 125.0, 70.0, 10.0, 0.0, 85.0, 15.0, 95.0, 65.0, 0.0, 0.0, 25.0, 180.0, 135.0, 75.0, 0.0, 0.0, 0.0, 150.0, 0.0, 50.0, 0.0, 10.0, 160.0, 140.0, 60.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 40.0, 0.0, 40.0, 0.0, 0.0, 100.0, 0.0, 0.0, 115.0, 40.0, 10.0, 0.0, 25.0, 30.0, 0.0, 0.0, 195.0, 190.0, 50.0, 240.0, 5.0, 0.0, 10.0, 55.0, 5.0, 25.0, 270.0, 55.0, 145.0, 55.0, 75.0, 0.0, 205.0, 190.0, 0.0, 0.0, 160.0, 150.0, 95.0, 30.0, 45.0, 50.0, 0.0, 0.0, 5.0, 0.0, 100.0, 0.0, 80.0, 0.0, 105.0, 170.0, 70.0, 45.0, 15.0, 0.0, 225.0, 0.0, 140.0, 85.0, 15.0, 0.0, 0.0, 110.0, 30.0, 70.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6124187710146665, "mean_inference_ms": 1.4072242820842416, "mean_action_processing_ms": 0.24070524581835165, "mean_env_wait_ms": 0.18157143959472705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006014347076416016, "StateBufferConnector_ms": 0.004824161529541016, "ViewRequirementAgentConnector_ms": 0.11426639556884766}, "num_episodes": 18, "episode_return_max": 89.0, "episode_return_min": -314.0, "episode_return_mean": -73.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.85265780408183, "num_env_steps_trained_throughput_per_sec": 81.85265780408183, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 49198.253, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49198.192, "sample_time_ms": 1196.643, "learn_time_ms": 47982.17, "learn_throughput": 83.364, "synch_weights_time_ms": 15.933}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-52-06", "timestamp": 1723503126, "time_this_iter_s": 48.907301902770996, "time_total_s": 4560.120512247086, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab87dca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4560.120512247086, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 25.65428571428571, "ram_util_percent": 82.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5201345995778128, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2423344866308585, "policy_loss": -0.008760863287551771, "vf_loss": 1.2503402513801736, "vf_explained_var": 0.0002528593969092798, "kl": 0.010067966892302379, "entropy": 0.6404187532329054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.603977984994177, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0143727195956718, "policy_loss": -0.01679562554896745, "vf_loss": 2.0294053796422546, "vf_explained_var": -0.013306967732767579, "kl": 0.008814819154107315, "entropy": 1.3215448399069447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 89.0, "episode_reward_min": -376.0, "episode_reward_mean": -75.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -640.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 89.0, "predator_policy": 325.0}, "policy_reward_mean": {"prey_policy": -86.535, "predator_policy": 48.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-91.0, 0.0, -95.0, 22.0, -138.0, -59.0, -55.0, -25.0, -75.0, -140.0, -100.0, -95.0, 8.0, -130.0, 23.0, 46.0, 22.0, -138.0, 2.0, 0.0, 0.0, -198.0, 25.0, -45.0, -175.0, -15.0, -66.0, -20.0, -65.0, -234.0, -150.0, -135.0, -110.0, -65.0, 8.0, -155.0, -20.0, 0.0, -153.0, -50.0, -150.0, -230.0, 0.0, 18.0, -64.0, 39.0, 0.0, -5.0, -70.0, -40.0, -100.0, 89.0, 26.0, -10.0, -44.0, 13.0, -151.0, -257.0, -5.0, -59.0, -20.0, -250.0, -160.0, -75.0, -134.0, 2.0, -150.0, -314.0, -50.0, 0.0, -5.0, -207.0, -80.0, -237.0, -145.0, -35.0, -225.0, -205.0, 6.0, -250.0, -6.0, 0.0, -23.0, -10.0, -30.0, -120.0, -55.0, -50.0, -231.0, 44.0, -205.0, -38.0, -33.0, -46.0, -60.0, 23.0, -126.0, -376.0, -5.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-181.0, -20.0, 0.0, 0.0, -40.0, -150.0, 22.0, 0.0, -640.0, -23.0, -169.0, 0.0, 0.0, -110.0, 0.0, -50.0, 0.0, -320.0, -150.0, -70.0, -160.0, -40.0, -220.0, 0.0, 0.0, -2.0, -150.0, -60.0, 28.0, -60.0, 46.0, 0.0, 27.0, -10.0, -50.0, -218.0, 52.0, -145.0, 0.0, 0.0, 0.0, 0.0, -30.0, -393.0, 35.0, -30.0, 0.0, -90.0, -20.0, -330.0, 0.0, -30.0, -151.0, 0.0, -40.0, 0.0, -100.0, -30.0, -567.0, 43.0, -160.0, -70.0, -50.0, -170.0, -190.0, -30.0, 0.0, -130.0, -17.0, 0.0, -340.0, -130.0, -13.0, -82.0, 0.0, 0.0, -3.0, -300.0, 0.0, -100.0, -300.0, -20.0, -180.0, -250.0, 0.0, 0.0, 18.0, 0.0, -109.0, -20.0, 39.0, 0.0, 0.0, 0.0, -10.0, 0.0, -80.0, -30.0, 0.0, -80.0, 0.0, -200.0, 89.0, 0.0, -190.0, 61.0, -20.0, 0.0, -50.0, -49.0, 13.0, 0.0, -84.0, -452.0, -220.0, -327.0, -10.0, 0.0, -64.0, -60.0, 0.0, -50.0, -465.0, -110.0, -360.0, 0.0, -150.0, 0.0, -540.0, 11.0, 2.0, 0.0, 0.0, -460.0, -250.0, -189.0, -35.0, -110.0, 0.0, 0.0, 0.0, -10.0, -162.0, -145.0, -160.0, 0.0, -242.0, -270.0, -120.0, -140.0, -30.0, -20.0, -90.0, -360.0, -110.0, -320.0, 21.0, -30.0, -170.0, -190.0, 0.0, -106.0, 0.0, 0.0, 17.0, -140.0, -20.0, 0.0, -20.0, -20.0, -10.0, -230.0, 0.0, -110.0, -80.0, -10.0, -175.0, -226.0, -11.0, -30.0, -220.0, -190.0, -100.0, 2.0, -80.0, -43.0, -156.0, -40.0, -120.0, 0.0, 48.0, -130.0, -115.0, -126.0, -385.0, -251.0, 0.0, -10.0, 0.0, 0.0], "policy_predator_policy_reward": [110.0, 0.0, 0.0, 0.0, 20.0, 75.0, 0.0, 0.0, 200.0, 325.0, 15.0, 95.0, 55.0, 0.0, 25.0, 0.0, 85.0, 160.0, 0.0, 80.0, 80.0, 20.0, 15.0, 110.0, 0.0, 10.0, 0.0, 80.0, 0.0, 55.0, 0.0, 0.0, 0.0, 5.0, 50.0, 80.0, 65.0, 30.0, 0.0, 0.0, 0.0, 0.0, 210.0, 15.0, 15.0, 5.0, 0.0, 45.0, 175.0, 0.0, 15.0, 0.0, 0.0, 85.0, 20.0, 0.0, 15.0, 50.0, 165.0, 125.0, 70.0, 10.0, 0.0, 85.0, 15.0, 95.0, 65.0, 0.0, 0.0, 25.0, 180.0, 135.0, 75.0, 0.0, 0.0, 0.0, 150.0, 0.0, 50.0, 0.0, 10.0, 160.0, 140.0, 60.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 40.0, 0.0, 40.0, 0.0, 0.0, 100.0, 0.0, 0.0, 115.0, 40.0, 10.0, 0.0, 25.0, 30.0, 0.0, 0.0, 195.0, 190.0, 50.0, 240.0, 5.0, 0.0, 10.0, 55.0, 5.0, 25.0, 270.0, 55.0, 145.0, 55.0, 75.0, 0.0, 205.0, 190.0, 0.0, 0.0, 160.0, 150.0, 95.0, 30.0, 45.0, 50.0, 0.0, 0.0, 5.0, 0.0, 100.0, 0.0, 80.0, 0.0, 105.0, 170.0, 70.0, 45.0, 15.0, 0.0, 225.0, 0.0, 140.0, 85.0, 15.0, 0.0, 0.0, 110.0, 30.0, 70.0, 0.0, 0.0, 70.0, 30.0, 0.0, 10.0, 0.0, 10.0, 120.0, 0.0, 55.0, 0.0, 0.0, 40.0, 135.0, 35.0, 50.0, 35.0, 205.0, 0.0, 30.0, 30.0, 40.0, 50.0, 10.0, 140.0, 5.0, 55.0, 35.0, 70.0, 70.0, 45.0, 115.0, 145.0, 0.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6118173768707137, "mean_inference_ms": 1.4055564725679586, "mean_action_processing_ms": 0.24055057293734683, "mean_env_wait_ms": 0.1813833613345102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005107522010803223, "StateBufferConnector_ms": 0.003176569938659668, "ViewRequirementAgentConnector_ms": 0.09500503540039062}, "num_episodes": 18, "episode_return_max": 89.0, "episode_return_min": -376.0, "episode_return_mean": -75.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.43286012165457, "num_env_steps_trained_throughput_per_sec": 81.43286012165457, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 48949.57, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48949.51, "sample_time_ms": 1189.502, "learn_time_ms": 47740.481, "learn_throughput": 83.786, "synch_weights_time_ms": 16.1}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-52-56", "timestamp": 1723503176, "time_this_iter_s": 49.16317796707153, "time_total_s": 4609.283690214157, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab8b7af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4609.283690214157, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 26.680000000000003, "ram_util_percent": 82.17142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.230354973358452, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1607463250715266, "policy_loss": -0.004778308892947814, "vf_loss": 2.165113968760879, "vf_explained_var": 0.00067766718763523, "kl": 0.005475547592054099, "entropy": 0.494200873674539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.488698904381858, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.760172748061084, "policy_loss": -0.015460134450612324, "vf_loss": 2.774115141800472, "vf_explained_var": 0.0036499442877592865, "kl": 0.007588680543965192, "entropy": 1.3109110363576777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 99.0, "episode_reward_min": -376.0, "episode_reward_mean": -73.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -567.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 146.0, "predator_policy": 270.0}, "policy_reward_mean": {"prey_policy": -87.385, "predator_policy": 50.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, -45.0, -175.0, -15.0, -66.0, -20.0, -65.0, -234.0, -150.0, -135.0, -110.0, -65.0, 8.0, -155.0, -20.0, 0.0, -153.0, -50.0, -150.0, -230.0, 0.0, 18.0, -64.0, 39.0, 0.0, -5.0, -70.0, -40.0, -100.0, 89.0, 26.0, -10.0, -44.0, 13.0, -151.0, -257.0, -5.0, -59.0, -20.0, -250.0, -160.0, -75.0, -134.0, 2.0, -150.0, -314.0, -50.0, 0.0, -5.0, -207.0, -80.0, -237.0, -145.0, -35.0, -225.0, -205.0, 6.0, -250.0, -6.0, 0.0, -23.0, -10.0, -30.0, -120.0, -55.0, -50.0, -231.0, 44.0, -205.0, -38.0, -33.0, -46.0, -60.0, 23.0, -126.0, -376.0, -5.0, 0.0, 15.0, 33.0, 0.0, -55.0, -20.0, -192.0, 5.0, 99.0, -146.0, -241.0, 86.0, -24.0, -62.0, -215.0, -52.0, -94.0, -55.0, -138.0, 60.0, 64.0, -39.0, -110.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [35.0, -30.0, 0.0, -90.0, -20.0, -330.0, 0.0, -30.0, -151.0, 0.0, -40.0, 0.0, -100.0, -30.0, -567.0, 43.0, -160.0, -70.0, -50.0, -170.0, -190.0, -30.0, 0.0, -130.0, -17.0, 0.0, -340.0, -130.0, -13.0, -82.0, 0.0, 0.0, -3.0, -300.0, 0.0, -100.0, -300.0, -20.0, -180.0, -250.0, 0.0, 0.0, 18.0, 0.0, -109.0, -20.0, 39.0, 0.0, 0.0, 0.0, -10.0, 0.0, -80.0, -30.0, 0.0, -80.0, 0.0, -200.0, 89.0, 0.0, -190.0, 61.0, -20.0, 0.0, -50.0, -49.0, 13.0, 0.0, -84.0, -452.0, -220.0, -327.0, -10.0, 0.0, -64.0, -60.0, 0.0, -50.0, -465.0, -110.0, -360.0, 0.0, -150.0, 0.0, -540.0, 11.0, 2.0, 0.0, 0.0, -460.0, -250.0, -189.0, -35.0, -110.0, 0.0, 0.0, 0.0, -10.0, -162.0, -145.0, -160.0, 0.0, -242.0, -270.0, -120.0, -140.0, -30.0, -20.0, -90.0, -360.0, -110.0, -320.0, 21.0, -30.0, -170.0, -190.0, 0.0, -106.0, 0.0, 0.0, 17.0, -140.0, -20.0, 0.0, -20.0, -20.0, -10.0, -230.0, 0.0, -110.0, -80.0, -10.0, -175.0, -226.0, -11.0, -30.0, -220.0, -190.0, -100.0, 2.0, -80.0, -43.0, -156.0, -40.0, -120.0, 0.0, 48.0, -130.0, -115.0, -126.0, -385.0, -251.0, 0.0, -10.0, 0.0, 0.0, 53.0, -113.0, -40.0, 53.0, 0.0, 0.0, -140.0, 0.0, -20.0, -50.0, 0.0, -402.0, 0.0, -35.0, -74.0, 18.0, -328.0, -68.0, -248.0, -233.0, -127.0, 78.0, -79.0, 0.0, 58.0, -240.0, -420.0, -10.0, -141.0, 4.0, 146.0, -520.0, -20.0, -70.0, -60.0, -168.0, 5.0, 0.0, -80.0, 104.0, -115.0, -14.0, -100.0, -60.0], "policy_predator_policy_reward": [15.0, 5.0, 0.0, 45.0, 175.0, 0.0, 15.0, 0.0, 0.0, 85.0, 20.0, 0.0, 15.0, 50.0, 165.0, 125.0, 70.0, 10.0, 0.0, 85.0, 15.0, 95.0, 65.0, 0.0, 0.0, 25.0, 180.0, 135.0, 75.0, 0.0, 0.0, 0.0, 150.0, 0.0, 50.0, 0.0, 10.0, 160.0, 140.0, 60.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 40.0, 0.0, 40.0, 0.0, 0.0, 100.0, 0.0, 0.0, 115.0, 40.0, 10.0, 0.0, 25.0, 30.0, 0.0, 0.0, 195.0, 190.0, 50.0, 240.0, 5.0, 0.0, 10.0, 55.0, 5.0, 25.0, 270.0, 55.0, 145.0, 55.0, 75.0, 0.0, 205.0, 190.0, 0.0, 0.0, 160.0, 150.0, 95.0, 30.0, 45.0, 50.0, 0.0, 0.0, 5.0, 0.0, 100.0, 0.0, 80.0, 0.0, 105.0, 170.0, 70.0, 45.0, 15.0, 0.0, 225.0, 0.0, 140.0, 85.0, 15.0, 0.0, 0.0, 110.0, 30.0, 70.0, 0.0, 0.0, 70.0, 30.0, 0.0, 10.0, 0.0, 10.0, 120.0, 0.0, 55.0, 0.0, 0.0, 40.0, 135.0, 35.0, 50.0, 35.0, 205.0, 0.0, 30.0, 30.0, 40.0, 50.0, 10.0, 140.0, 5.0, 55.0, 35.0, 70.0, 70.0, 45.0, 115.0, 145.0, 0.0, 5.0, 0.0, 0.0, 40.0, 35.0, 0.0, 20.0, 0.0, 0.0, 15.0, 70.0, 25.0, 25.0, 95.0, 115.0, 40.0, 0.0, 70.0, 85.0, 50.0, 200.0, 80.0, 160.0, 0.0, 135.0, 45.0, 10.0, 0.0, 120.0, 5.0, 210.0, 0.0, 85.0, 235.0, 45.0, 35.0, 0.0, 0.0, 90.0, 55.0, 0.0, 25.0, 15.0, 0.0, 90.0, 50.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6113219905183435, "mean_inference_ms": 1.4037402294168362, "mean_action_processing_ms": 0.2404960235248251, "mean_env_wait_ms": 0.1811025147285178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004266977310180664, "StateBufferConnector_ms": 0.0030940771102905273, "ViewRequirementAgentConnector_ms": 0.09414565563201904}, "num_episodes": 22, "episode_return_max": 99.0, "episode_return_min": -376.0, "episode_return_mean": -73.87, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.37164411887454, "num_env_steps_trained_throughput_per_sec": 81.37164411887454, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 48986.34, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48986.28, "sample_time_ms": 1188.039, "learn_time_ms": 47779.765, "learn_throughput": 83.717, "synch_weights_time_ms": 14.955}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-53-45", "timestamp": 1723503225, "time_this_iter_s": 49.19183683395386, "time_total_s": 4658.475527048111, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88164c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4658.475527048111, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 23.56142857142857, "ram_util_percent": 82.36285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6966444297284675, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2326895686053727, "policy_loss": -0.004066613883952852, "vf_loss": 2.236237595257936, "vf_explained_var": -0.00010892969590646249, "kl": 0.006914479379159703, "entropy": 0.5535086695479338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7783353041719505, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.687680416321628, "policy_loss": -0.01362317041592505, "vf_loss": 2.6996775457467983, "vf_explained_var": 0.0029784368774878286, "kl": 0.008130213704974836, "entropy": 1.2888790570869648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 99.0, "episode_reward_min": -524.0, "episode_reward_mean": -84.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -793.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 146.0, "predator_policy": 335.0}, "policy_reward_mean": {"prey_policy": -99.595, "predator_policy": 57.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-150.0, -230.0, 0.0, 18.0, -64.0, 39.0, 0.0, -5.0, -70.0, -40.0, -100.0, 89.0, 26.0, -10.0, -44.0, 13.0, -151.0, -257.0, -5.0, -59.0, -20.0, -250.0, -160.0, -75.0, -134.0, 2.0, -150.0, -314.0, -50.0, 0.0, -5.0, -207.0, -80.0, -237.0, -145.0, -35.0, -225.0, -205.0, 6.0, -250.0, -6.0, 0.0, -23.0, -10.0, -30.0, -120.0, -55.0, -50.0, -231.0, 44.0, -205.0, -38.0, -33.0, -46.0, -60.0, 23.0, -126.0, -376.0, -5.0, 0.0, 15.0, 33.0, 0.0, -55.0, -20.0, -192.0, 5.0, 99.0, -146.0, -241.0, 86.0, -24.0, -62.0, -215.0, -52.0, -94.0, -55.0, -138.0, 60.0, 64.0, -39.0, -110.0, -118.0, -27.0, -280.0, -524.0, -50.0, 66.0, 0.0, -20.0, -8.0, -70.0, -157.0, -38.0, -116.0, -95.0, 18.0, -282.0, -398.0, -393.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-300.0, -20.0, -180.0, -250.0, 0.0, 0.0, 18.0, 0.0, -109.0, -20.0, 39.0, 0.0, 0.0, 0.0, -10.0, 0.0, -80.0, -30.0, 0.0, -80.0, 0.0, -200.0, 89.0, 0.0, -190.0, 61.0, -20.0, 0.0, -50.0, -49.0, 13.0, 0.0, -84.0, -452.0, -220.0, -327.0, -10.0, 0.0, -64.0, -60.0, 0.0, -50.0, -465.0, -110.0, -360.0, 0.0, -150.0, 0.0, -540.0, 11.0, 2.0, 0.0, 0.0, -460.0, -250.0, -189.0, -35.0, -110.0, 0.0, 0.0, 0.0, -10.0, -162.0, -145.0, -160.0, 0.0, -242.0, -270.0, -120.0, -140.0, -30.0, -20.0, -90.0, -360.0, -110.0, -320.0, 21.0, -30.0, -170.0, -190.0, 0.0, -106.0, 0.0, 0.0, 17.0, -140.0, -20.0, 0.0, -20.0, -20.0, -10.0, -230.0, 0.0, -110.0, -80.0, -10.0, -175.0, -226.0, -11.0, -30.0, -220.0, -190.0, -100.0, 2.0, -80.0, -43.0, -156.0, -40.0, -120.0, 0.0, 48.0, -130.0, -115.0, -126.0, -385.0, -251.0, 0.0, -10.0, 0.0, 0.0, 53.0, -113.0, -40.0, 53.0, 0.0, 0.0, -140.0, 0.0, -20.0, -50.0, 0.0, -402.0, 0.0, -35.0, -74.0, 18.0, -328.0, -68.0, -248.0, -233.0, -127.0, 78.0, -79.0, 0.0, 58.0, -240.0, -420.0, -10.0, -141.0, 4.0, 146.0, -520.0, -20.0, -70.0, -60.0, -168.0, 5.0, 0.0, -80.0, 104.0, -115.0, -14.0, -100.0, -60.0, -110.0, -168.0, -107.0, -70.0, -464.0, -116.0, -369.0, -340.0, 0.0, -100.0, 58.0, 8.0, 0.0, 0.0, -10.0, -30.0, -28.0, 0.0, -140.0, 0.0, -120.0, -277.0, -78.0, 0.0, -546.0, 0.0, 0.0, -270.0, 0.0, 3.0, -582.0, -50.0, -120.0, -708.0, -10.0, -793.0], "policy_predator_policy_reward": [10.0, 160.0, 140.0, 60.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 40.0, 0.0, 40.0, 0.0, 0.0, 100.0, 0.0, 0.0, 115.0, 40.0, 10.0, 0.0, 25.0, 30.0, 0.0, 0.0, 195.0, 190.0, 50.0, 240.0, 5.0, 0.0, 10.0, 55.0, 5.0, 25.0, 270.0, 55.0, 145.0, 55.0, 75.0, 0.0, 205.0, 190.0, 0.0, 0.0, 160.0, 150.0, 95.0, 30.0, 45.0, 50.0, 0.0, 0.0, 5.0, 0.0, 100.0, 0.0, 80.0, 0.0, 105.0, 170.0, 70.0, 45.0, 15.0, 0.0, 225.0, 0.0, 140.0, 85.0, 15.0, 0.0, 0.0, 110.0, 30.0, 70.0, 0.0, 0.0, 70.0, 30.0, 0.0, 10.0, 0.0, 10.0, 120.0, 0.0, 55.0, 0.0, 0.0, 40.0, 135.0, 35.0, 50.0, 35.0, 205.0, 0.0, 30.0, 30.0, 40.0, 50.0, 10.0, 140.0, 5.0, 55.0, 35.0, 70.0, 70.0, 45.0, 115.0, 145.0, 0.0, 5.0, 0.0, 0.0, 40.0, 35.0, 0.0, 20.0, 0.0, 0.0, 15.0, 70.0, 25.0, 25.0, 95.0, 115.0, 40.0, 0.0, 70.0, 85.0, 50.0, 200.0, 80.0, 160.0, 0.0, 135.0, 45.0, 10.0, 0.0, 120.0, 5.0, 210.0, 0.0, 85.0, 235.0, 45.0, 35.0, 0.0, 0.0, 90.0, 55.0, 0.0, 25.0, 15.0, 0.0, 90.0, 50.0, 0.0, 110.0, 50.0, 85.0, 65.0, 240.0, 60.0, 185.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 45.0, 25.0, 230.0, 10.0, 40.0, 0.0, 230.0, 200.0, 50.0, 125.0, 0.0, 15.0, 30.0, 320.0, 95.0, 335.0, 95.0, 315.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6106024187877511, "mean_inference_ms": 1.4019366728637441, "mean_action_processing_ms": 0.24016385038547214, "mean_env_wait_ms": 0.1809975397780253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003619074821472168, "StateBufferConnector_ms": 0.0030205249786376953, "ViewRequirementAgentConnector_ms": 0.09136486053466797}, "num_episodes": 18, "episode_return_max": 99.0, "episode_return_min": -524.0, "episode_return_mean": -84.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.827701419188, "num_env_steps_trained_throughput_per_sec": 82.827701419188, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 48975.383, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48975.323, "sample_time_ms": 1166.223, "learn_time_ms": 47790.963, "learn_throughput": 83.698, "synch_weights_time_ms": 14.768}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-54-33", "timestamp": 1723503273, "time_this_iter_s": 48.323399782180786, "time_total_s": 4706.798926830292, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aae37310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4706.798926830292, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 22.522058823529417, "ram_util_percent": 81.91470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4695236884569995, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.668811826920383, "policy_loss": -0.002407939155788097, "vf_loss": 1.6707910799475574, "vf_explained_var": 0.0026371614958243393, "kl": 0.005715740720721578, "entropy": 0.4605701446848572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1749429103558655, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.604685511475518, "policy_loss": -0.009318349730450088, "vf_loss": 2.6129823924372437, "vf_explained_var": 0.016017593498583192, "kl": 0.005107344078450873, "entropy": 1.3102093250663192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 189.0, "episode_reward_min": -524.0, "episode_reward_mean": -73.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -871.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 445.0}, "policy_reward_mean": {"prey_policy": -94.805, "predator_policy": 58.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.0, -134.0, 2.0, -150.0, -314.0, -50.0, 0.0, -5.0, -207.0, -80.0, -237.0, -145.0, -35.0, -225.0, -205.0, 6.0, -250.0, -6.0, 0.0, -23.0, -10.0, -30.0, -120.0, -55.0, -50.0, -231.0, 44.0, -205.0, -38.0, -33.0, -46.0, -60.0, 23.0, -126.0, -376.0, -5.0, 0.0, 15.0, 33.0, 0.0, -55.0, -20.0, -192.0, 5.0, 99.0, -146.0, -241.0, 86.0, -24.0, -62.0, -215.0, -52.0, -94.0, -55.0, -138.0, 60.0, 64.0, -39.0, -110.0, -118.0, -27.0, -280.0, -524.0, -50.0, 66.0, 0.0, -20.0, -8.0, -70.0, -157.0, -38.0, -116.0, -95.0, 18.0, -282.0, -398.0, -393.0, -78.0, 0.0, -35.0, 54.0, -70.0, 76.0, 1.0, -2.0, 189.0, 13.0, -5.0, 29.0, -205.0, 101.0, 111.0, 18.0, -166.0, -331.0, -50.0, 33.0, -88.0, 23.0, 65.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-150.0, 0.0, -540.0, 11.0, 2.0, 0.0, 0.0, -460.0, -250.0, -189.0, -35.0, -110.0, 0.0, 0.0, 0.0, -10.0, -162.0, -145.0, -160.0, 0.0, -242.0, -270.0, -120.0, -140.0, -30.0, -20.0, -90.0, -360.0, -110.0, -320.0, 21.0, -30.0, -170.0, -190.0, 0.0, -106.0, 0.0, 0.0, 17.0, -140.0, -20.0, 0.0, -20.0, -20.0, -10.0, -230.0, 0.0, -110.0, -80.0, -10.0, -175.0, -226.0, -11.0, -30.0, -220.0, -190.0, -100.0, 2.0, -80.0, -43.0, -156.0, -40.0, -120.0, 0.0, 48.0, -130.0, -115.0, -126.0, -385.0, -251.0, 0.0, -10.0, 0.0, 0.0, 53.0, -113.0, -40.0, 53.0, 0.0, 0.0, -140.0, 0.0, -20.0, -50.0, 0.0, -402.0, 0.0, -35.0, -74.0, 18.0, -328.0, -68.0, -248.0, -233.0, -127.0, 78.0, -79.0, 0.0, 58.0, -240.0, -420.0, -10.0, -141.0, 4.0, 146.0, -520.0, -20.0, -70.0, -60.0, -168.0, 5.0, 0.0, -80.0, 104.0, -115.0, -14.0, -100.0, -60.0, -110.0, -168.0, -107.0, -70.0, -464.0, -116.0, -369.0, -340.0, 0.0, -100.0, 58.0, 8.0, 0.0, 0.0, -10.0, -30.0, -28.0, 0.0, -140.0, 0.0, -120.0, -277.0, -78.0, 0.0, -546.0, 0.0, 0.0, -270.0, 0.0, 3.0, -582.0, -50.0, -120.0, -708.0, -10.0, -793.0, 0.0, -178.0, 0.0, 0.0, -30.0, -20.0, -71.0, 0.0, -70.0, -40.0, 86.0, -30.0, -84.0, -20.0, 3.0, -10.0, 0.0, 189.0, 43.0, -70.0, -40.0, 0.0, 0.0, 29.0, -200.0, -160.0, -202.0, 153.0, -110.0, 156.0, -10.0, 23.0, -351.0, -50.0, -320.0, -871.0, -70.0, -30.0, 0.0, -22.0, -310.0, 22.0, 0.0, 23.0, -14.0, 44.0], "policy_predator_policy_reward": [75.0, 0.0, 205.0, 190.0, 0.0, 0.0, 160.0, 150.0, 95.0, 30.0, 45.0, 50.0, 0.0, 0.0, 5.0, 0.0, 100.0, 0.0, 80.0, 0.0, 105.0, 170.0, 70.0, 45.0, 15.0, 0.0, 225.0, 0.0, 140.0, 85.0, 15.0, 0.0, 0.0, 110.0, 30.0, 70.0, 0.0, 0.0, 70.0, 30.0, 0.0, 10.0, 0.0, 10.0, 120.0, 0.0, 55.0, 0.0, 0.0, 40.0, 135.0, 35.0, 50.0, 35.0, 205.0, 0.0, 30.0, 30.0, 40.0, 50.0, 10.0, 140.0, 5.0, 55.0, 35.0, 70.0, 70.0, 45.0, 115.0, 145.0, 0.0, 5.0, 0.0, 0.0, 40.0, 35.0, 0.0, 20.0, 0.0, 0.0, 15.0, 70.0, 25.0, 25.0, 95.0, 115.0, 40.0, 0.0, 70.0, 85.0, 50.0, 200.0, 80.0, 160.0, 0.0, 135.0, 45.0, 10.0, 0.0, 120.0, 5.0, 210.0, 0.0, 85.0, 235.0, 45.0, 35.0, 0.0, 0.0, 90.0, 55.0, 0.0, 25.0, 15.0, 0.0, 90.0, 50.0, 0.0, 110.0, 50.0, 85.0, 65.0, 240.0, 60.0, 185.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 45.0, 25.0, 230.0, 10.0, 40.0, 0.0, 230.0, 200.0, 50.0, 125.0, 0.0, 15.0, 30.0, 320.0, 95.0, 335.0, 95.0, 315.0, 45.0, 55.0, 0.0, 0.0, 15.0, 0.0, 85.0, 40.0, 35.0, 5.0, 20.0, 0.0, 35.0, 70.0, 5.0, 0.0, 0.0, 0.0, 5.0, 35.0, 20.0, 15.0, 0.0, 0.0, 105.0, 50.0, 145.0, 5.0, 25.0, 40.0, 5.0, 0.0, 30.0, 205.0, 445.0, 415.0, 15.0, 35.0, 40.0, 15.0, 150.0, 50.0, 0.0, 0.0, 35.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6098710532372353, "mean_inference_ms": 1.4000643573156881, "mean_action_processing_ms": 0.23991826361010102, "mean_env_wait_ms": 0.1807641011764098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003296971321105957, "StateBufferConnector_ms": 0.003068685531616211, "ViewRequirementAgentConnector_ms": 0.09125757217407227}, "num_episodes": 23, "episode_return_max": 189.0, "episode_return_min": -524.0, "episode_return_mean": -73.41, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.16915064767885, "num_env_steps_trained_throughput_per_sec": 74.16915064767885, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 49495.238, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49495.183, "sample_time_ms": 1163.202, "learn_time_ms": 48313.48, "learn_throughput": 82.793, "synch_weights_time_ms": 15.114}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-55-27", "timestamp": 1723503327, "time_this_iter_s": 53.978981018066406, "time_total_s": 4760.777907848358, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88004c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4760.777907848358, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 32.8922077922078, "ram_util_percent": 82.4818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6945402104230154, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1067611627477816, "policy_loss": -0.006932221125890181, "vf_loss": 2.1130596484772113, "vf_explained_var": 0.0013845323570190913, "kl": 0.008449841504407857, "entropy": 0.5478238450314002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.725467869324028, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.727216771418455, "policy_loss": -0.02041239139584519, "vf_loss": 3.7455097241376443, "vf_explained_var": 0.026035172283334077, "kl": 0.010597215995000528, "entropy": 1.2963783080615694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 226.0, "episode_reward_min": -925.0, "episode_reward_mean": -57.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -89.775, "predator_policy": 61.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -23.0, -10.0, -30.0, -120.0, -55.0, -50.0, -231.0, 44.0, -205.0, -38.0, -33.0, -46.0, -60.0, 23.0, -126.0, -376.0, -5.0, 0.0, 15.0, 33.0, 0.0, -55.0, -20.0, -192.0, 5.0, 99.0, -146.0, -241.0, 86.0, -24.0, -62.0, -215.0, -52.0, -94.0, -55.0, -138.0, 60.0, 64.0, -39.0, -110.0, -118.0, -27.0, -280.0, -524.0, -50.0, 66.0, 0.0, -20.0, -8.0, -70.0, -157.0, -38.0, -116.0, -95.0, 18.0, -282.0, -398.0, -393.0, -78.0, 0.0, -35.0, 54.0, -70.0, 76.0, 1.0, -2.0, 189.0, 13.0, -5.0, 29.0, -205.0, 101.0, 111.0, 18.0, -166.0, -331.0, -50.0, 33.0, -88.0, 23.0, 65.0, -1.0, 131.0, -15.0, -18.0, -925.0, 226.0, -30.0, 28.0, 65.0, -70.0, 14.0, 177.0, -134.0, 166.0, -220.0, -89.0, 169.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 17.0, -140.0, -20.0, 0.0, -20.0, -20.0, -10.0, -230.0, 0.0, -110.0, -80.0, -10.0, -175.0, -226.0, -11.0, -30.0, -220.0, -190.0, -100.0, 2.0, -80.0, -43.0, -156.0, -40.0, -120.0, 0.0, 48.0, -130.0, -115.0, -126.0, -385.0, -251.0, 0.0, -10.0, 0.0, 0.0, 53.0, -113.0, -40.0, 53.0, 0.0, 0.0, -140.0, 0.0, -20.0, -50.0, 0.0, -402.0, 0.0, -35.0, -74.0, 18.0, -328.0, -68.0, -248.0, -233.0, -127.0, 78.0, -79.0, 0.0, 58.0, -240.0, -420.0, -10.0, -141.0, 4.0, 146.0, -520.0, -20.0, -70.0, -60.0, -168.0, 5.0, 0.0, -80.0, 104.0, -115.0, -14.0, -100.0, -60.0, -110.0, -168.0, -107.0, -70.0, -464.0, -116.0, -369.0, -340.0, 0.0, -100.0, 58.0, 8.0, 0.0, 0.0, -10.0, -30.0, -28.0, 0.0, -140.0, 0.0, -120.0, -277.0, -78.0, 0.0, -546.0, 0.0, 0.0, -270.0, 0.0, 3.0, -582.0, -50.0, -120.0, -708.0, -10.0, -793.0, 0.0, -178.0, 0.0, 0.0, -30.0, -20.0, -71.0, 0.0, -70.0, -40.0, 86.0, -30.0, -84.0, -20.0, 3.0, -10.0, 0.0, 189.0, 43.0, -70.0, -40.0, 0.0, 0.0, 29.0, -200.0, -160.0, -202.0, 153.0, -110.0, 156.0, -10.0, 23.0, -351.0, -50.0, -320.0, -871.0, -70.0, -30.0, 0.0, -22.0, -310.0, 22.0, 0.0, 23.0, -14.0, 44.0, -96.0, 0.0, 46.0, 40.0, 0.0, -100.0, -178.0, 0.0, 0.0, -2000.0, 87.0, 129.0, 0.0, -60.0, -52.0, -70.0, 40.0, -30.0, -28.0, -532.0, -2.0, -59.0, 128.0, 49.0, 1.0, -270.0, -14.0, 170.0, -350.0, -90.0, -254.0, 0.0, 0.0, 124.0, 2.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 70.0, 30.0, 0.0, 10.0, 0.0, 10.0, 120.0, 0.0, 55.0, 0.0, 0.0, 40.0, 135.0, 35.0, 50.0, 35.0, 205.0, 0.0, 30.0, 30.0, 40.0, 50.0, 10.0, 140.0, 5.0, 55.0, 35.0, 70.0, 70.0, 45.0, 115.0, 145.0, 0.0, 5.0, 0.0, 0.0, 40.0, 35.0, 0.0, 20.0, 0.0, 0.0, 15.0, 70.0, 25.0, 25.0, 95.0, 115.0, 40.0, 0.0, 70.0, 85.0, 50.0, 200.0, 80.0, 160.0, 0.0, 135.0, 45.0, 10.0, 0.0, 120.0, 5.0, 210.0, 0.0, 85.0, 235.0, 45.0, 35.0, 0.0, 0.0, 90.0, 55.0, 0.0, 25.0, 15.0, 0.0, 90.0, 50.0, 0.0, 110.0, 50.0, 85.0, 65.0, 240.0, 60.0, 185.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 45.0, 25.0, 230.0, 10.0, 40.0, 0.0, 230.0, 200.0, 50.0, 125.0, 0.0, 15.0, 30.0, 320.0, 95.0, 335.0, 95.0, 315.0, 45.0, 55.0, 0.0, 0.0, 15.0, 0.0, 85.0, 40.0, 35.0, 5.0, 20.0, 0.0, 35.0, 70.0, 5.0, 0.0, 0.0, 0.0, 5.0, 35.0, 20.0, 15.0, 0.0, 0.0, 105.0, 50.0, 145.0, 5.0, 25.0, 40.0, 5.0, 0.0, 30.0, 205.0, 445.0, 415.0, 15.0, 35.0, 40.0, 15.0, 150.0, 50.0, 0.0, 0.0, 35.0, 0.0, 0.0, 95.0, 20.0, 25.0, 50.0, 35.0, 85.0, 75.0, 1000.0, 75.0, 10.0, 0.0, 0.0, 30.0, 70.0, 80.0, 40.0, 15.0, 240.0, 250.0, 45.0, 30.0, 0.0, 0.0, 0.0, 135.0, 0.0, 10.0, 175.0, 45.0, 120.0, 45.0, 25.0, 20.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6096906379139666, "mean_inference_ms": 1.3990498289271287, "mean_action_processing_ms": 0.23980095973407597, "mean_env_wait_ms": 0.1806801968590178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036885738372802734, "StateBufferConnector_ms": 0.0030742883682250977, "ViewRequirementAgentConnector_ms": 0.09309816360473633}, "num_episodes": 18, "episode_return_max": 226.0, "episode_return_min": -925.0, "episode_return_mean": -57.55, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.1209475007911, "num_env_steps_trained_throughput_per_sec": 80.1209475007911, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 49541.639, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49541.582, "sample_time_ms": 1180.27, "learn_time_ms": 48343.591, "learn_throughput": 82.741, "synch_weights_time_ms": 14.253}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-56-17", "timestamp": 1723503377, "time_this_iter_s": 49.96419906616211, "time_total_s": 4810.74210691452, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88385e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4810.74210691452, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 25.91830985915493, "ram_util_percent": 81.97042253521127}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8237793239020796, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1547548033573007, "policy_loss": -0.0056248372602991014, "vf_loss": 2.1597726749995396, "vf_explained_var": -0.0016031310356483257, "kl": 0.008092791180986457, "entropy": 0.5299403875120102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.440468671239873, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7392654489587853, "policy_loss": -0.011647067697492068, "vf_loss": 3.749373385389015, "vf_explained_var": 0.03417145471093516, "kl": 0.007695640612186091, "entropy": 1.2961106241064728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 278.0, "episode_reward_min": -925.0, "episode_reward_mean": -47.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -89.0, "predator_policy": 65.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.0, -20.0, -192.0, 5.0, 99.0, -146.0, -241.0, 86.0, -24.0, -62.0, -215.0, -52.0, -94.0, -55.0, -138.0, 60.0, 64.0, -39.0, -110.0, -118.0, -27.0, -280.0, -524.0, -50.0, 66.0, 0.0, -20.0, -8.0, -70.0, -157.0, -38.0, -116.0, -95.0, 18.0, -282.0, -398.0, -393.0, -78.0, 0.0, -35.0, 54.0, -70.0, 76.0, 1.0, -2.0, 189.0, 13.0, -5.0, 29.0, -205.0, 101.0, 111.0, 18.0, -166.0, -331.0, -50.0, 33.0, -88.0, 23.0, 65.0, -1.0, 131.0, -15.0, -18.0, -925.0, 226.0, -30.0, 28.0, 65.0, -70.0, 14.0, 177.0, -134.0, 166.0, -220.0, -89.0, 169.0, 2.0, 0.0, -11.0, -95.0, 270.0, 72.0, 278.0, 4.0, 170.0, 28.0, 1.0, 0.0, -43.0, 37.0, 5.0, -304.0, -15.0, -10.0, -33.0, -582.0, -20.0, 0.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-140.0, 0.0, -20.0, -50.0, 0.0, -402.0, 0.0, -35.0, -74.0, 18.0, -328.0, -68.0, -248.0, -233.0, -127.0, 78.0, -79.0, 0.0, 58.0, -240.0, -420.0, -10.0, -141.0, 4.0, 146.0, -520.0, -20.0, -70.0, -60.0, -168.0, 5.0, 0.0, -80.0, 104.0, -115.0, -14.0, -100.0, -60.0, -110.0, -168.0, -107.0, -70.0, -464.0, -116.0, -369.0, -340.0, 0.0, -100.0, 58.0, 8.0, 0.0, 0.0, -10.0, -30.0, -28.0, 0.0, -140.0, 0.0, -120.0, -277.0, -78.0, 0.0, -546.0, 0.0, 0.0, -270.0, 0.0, 3.0, -582.0, -50.0, -120.0, -708.0, -10.0, -793.0, 0.0, -178.0, 0.0, 0.0, -30.0, -20.0, -71.0, 0.0, -70.0, -40.0, 86.0, -30.0, -84.0, -20.0, 3.0, -10.0, 0.0, 189.0, 43.0, -70.0, -40.0, 0.0, 0.0, 29.0, -200.0, -160.0, -202.0, 153.0, -110.0, 156.0, -10.0, 23.0, -351.0, -50.0, -320.0, -871.0, -70.0, -30.0, 0.0, -22.0, -310.0, 22.0, 0.0, 23.0, -14.0, 44.0, -96.0, 0.0, 46.0, 40.0, 0.0, -100.0, -178.0, 0.0, 0.0, -2000.0, 87.0, 129.0, 0.0, -60.0, -52.0, -70.0, 40.0, -30.0, -28.0, -532.0, -2.0, -59.0, 128.0, 49.0, 1.0, -270.0, -14.0, 170.0, -350.0, -90.0, -254.0, 0.0, 0.0, 124.0, 2.0, 0.0, 0.0, 0.0, -80.0, -86.0, 0.0, -190.0, 128.0, -13.0, -80.0, 57.0, 165.0, 103.0, -153.0, -138.0, 169.0, 1.0, 0.0, -217.0, 1.0, 0.0, 0.0, 0.0, -430.0, 167.0, -38.0, 0.0, 0.0, -155.0, -870.0, 131.0, 0.0, -30.0, -20.0, 0.0, 167.0, -400.0, -637.0, -360.0, -15.0, -40.0, 0.0, 0.0, -10.0, 0.0], "policy_predator_policy_reward": [15.0, 70.0, 25.0, 25.0, 95.0, 115.0, 40.0, 0.0, 70.0, 85.0, 50.0, 200.0, 80.0, 160.0, 0.0, 135.0, 45.0, 10.0, 0.0, 120.0, 5.0, 210.0, 0.0, 85.0, 235.0, 45.0, 35.0, 0.0, 0.0, 90.0, 55.0, 0.0, 25.0, 15.0, 0.0, 90.0, 50.0, 0.0, 110.0, 50.0, 85.0, 65.0, 240.0, 60.0, 185.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 45.0, 25.0, 230.0, 10.0, 40.0, 0.0, 230.0, 200.0, 50.0, 125.0, 0.0, 15.0, 30.0, 320.0, 95.0, 335.0, 95.0, 315.0, 45.0, 55.0, 0.0, 0.0, 15.0, 0.0, 85.0, 40.0, 35.0, 5.0, 20.0, 0.0, 35.0, 70.0, 5.0, 0.0, 0.0, 0.0, 5.0, 35.0, 20.0, 15.0, 0.0, 0.0, 105.0, 50.0, 145.0, 5.0, 25.0, 40.0, 5.0, 0.0, 30.0, 205.0, 445.0, 415.0, 15.0, 35.0, 40.0, 15.0, 150.0, 50.0, 0.0, 0.0, 35.0, 0.0, 0.0, 95.0, 20.0, 25.0, 50.0, 35.0, 85.0, 75.0, 1000.0, 75.0, 10.0, 0.0, 0.0, 30.0, 70.0, 80.0, 40.0, 15.0, 240.0, 250.0, 45.0, 30.0, 0.0, 0.0, 0.0, 135.0, 0.0, 10.0, 175.0, 45.0, 120.0, 45.0, 25.0, 20.0, 0.0, 0.0, 0.0, 0.0, 95.0, 60.0, 15.0, 80.0, 60.0, 95.0, 40.0, 55.0, 0.0, 10.0, 20.0, 275.0, 0.0, 0.0, 160.0, 85.0, 0.0, 0.0, 0.0, 0.0, 0.0, 220.0, 0.0, 75.0, 100.0, 60.0, 5.0, 430.0, 0.0, 15.0, 10.0, 0.0, 200.0, 0.0, 110.0, 305.0, 30.0, 5.0, 0.0, 0.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.609911015276487, "mean_inference_ms": 1.3985051131099606, "mean_action_processing_ms": 0.2398729986786917, "mean_env_wait_ms": 0.18057444796570965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038962364196777344, "StateBufferConnector_ms": 0.003108978271484375, "ViewRequirementAgentConnector_ms": 0.09425652027130127}, "num_episodes": 22, "episode_return_max": 278.0, "episode_return_min": -925.0, "episode_return_mean": -47.15, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.27401248102211, "num_env_steps_trained_throughput_per_sec": 81.27401248102211, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 49418.76, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49418.708, "sample_time_ms": 1088.531, "learn_time_ms": 48312.911, "learn_throughput": 82.794, "synch_weights_time_ms": 13.934}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-57-07", "timestamp": 1723503427, "time_this_iter_s": 49.273666858673096, "time_total_s": 4860.015773773193, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab87d820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4860.015773773193, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 24.224285714285713, "ram_util_percent": 80.81857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9999493554313348, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.699495642557346, "policy_loss": -0.005589693033496145, "vf_loss": 1.7044975839594685, "vf_explained_var": -0.0011947745368594215, "kl": 0.007836672584990741, "entropy": 0.4666190160172326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.021779914980843, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.231392993056585, "policy_loss": -0.014818375113065399, "vf_loss": 3.2446820805312466, "vf_explained_var": -0.005523677383150373, "kl": 0.007646462898271562, "entropy": 1.2358419935539287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 278.0, "episode_reward_min": -925.0, "episode_reward_mean": -47.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -86.105, "predator_policy": 62.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.0, -118.0, -27.0, -280.0, -524.0, -50.0, 66.0, 0.0, -20.0, -8.0, -70.0, -157.0, -38.0, -116.0, -95.0, 18.0, -282.0, -398.0, -393.0, -78.0, 0.0, -35.0, 54.0, -70.0, 76.0, 1.0, -2.0, 189.0, 13.0, -5.0, 29.0, -205.0, 101.0, 111.0, 18.0, -166.0, -331.0, -50.0, 33.0, -88.0, 23.0, 65.0, -1.0, 131.0, -15.0, -18.0, -925.0, 226.0, -30.0, 28.0, 65.0, -70.0, 14.0, 177.0, -134.0, 166.0, -220.0, -89.0, 169.0, 2.0, 0.0, -11.0, -95.0, 270.0, 72.0, 278.0, 4.0, 170.0, 28.0, 1.0, 0.0, -43.0, 37.0, 5.0, -304.0, -15.0, -10.0, -33.0, -582.0, -20.0, 0.0, -5.0, -66.0, 57.0, -54.0, -320.0, -2.0, 167.0, -270.0, -145.0, 0.0, 33.0, -10.0, -20.0, -30.0, -81.0, -56.0, -20.0, -5.0, -183.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-100.0, -60.0, -110.0, -168.0, -107.0, -70.0, -464.0, -116.0, -369.0, -340.0, 0.0, -100.0, 58.0, 8.0, 0.0, 0.0, -10.0, -30.0, -28.0, 0.0, -140.0, 0.0, -120.0, -277.0, -78.0, 0.0, -546.0, 0.0, 0.0, -270.0, 0.0, 3.0, -582.0, -50.0, -120.0, -708.0, -10.0, -793.0, 0.0, -178.0, 0.0, 0.0, -30.0, -20.0, -71.0, 0.0, -70.0, -40.0, 86.0, -30.0, -84.0, -20.0, 3.0, -10.0, 0.0, 189.0, 43.0, -70.0, -40.0, 0.0, 0.0, 29.0, -200.0, -160.0, -202.0, 153.0, -110.0, 156.0, -10.0, 23.0, -351.0, -50.0, -320.0, -871.0, -70.0, -30.0, 0.0, -22.0, -310.0, 22.0, 0.0, 23.0, -14.0, 44.0, -96.0, 0.0, 46.0, 40.0, 0.0, -100.0, -178.0, 0.0, 0.0, -2000.0, 87.0, 129.0, 0.0, -60.0, -52.0, -70.0, 40.0, -30.0, -28.0, -532.0, -2.0, -59.0, 128.0, 49.0, 1.0, -270.0, -14.0, 170.0, -350.0, -90.0, -254.0, 0.0, 0.0, 124.0, 2.0, 0.0, 0.0, 0.0, -80.0, -86.0, 0.0, -190.0, 128.0, -13.0, -80.0, 57.0, 165.0, 103.0, -153.0, -138.0, 169.0, 1.0, 0.0, -217.0, 1.0, 0.0, 0.0, 0.0, -430.0, 167.0, -38.0, 0.0, 0.0, -155.0, -870.0, 131.0, 0.0, -30.0, -20.0, 0.0, 167.0, -400.0, -637.0, -360.0, -15.0, -40.0, 0.0, 0.0, -10.0, 0.0, -10.0, -186.0, 0.0, -33.0, -70.0, -124.0, -280.0, -250.0, 3.0, -10.0, 3.0, 159.0, -120.0, -360.0, -140.0, -200.0, 0.0, 0.0, 183.0, -310.0, 0.0, -40.0, 0.0, -90.0, 0.0, -60.0, -166.0, 0.0, -206.0, 5.0, 0.0, -40.0, -20.0, 0.0, -159.0, -149.0], "policy_predator_policy_reward": [50.0, 0.0, 110.0, 50.0, 85.0, 65.0, 240.0, 60.0, 185.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 45.0, 25.0, 230.0, 10.0, 40.0, 0.0, 230.0, 200.0, 50.0, 125.0, 0.0, 15.0, 30.0, 320.0, 95.0, 335.0, 95.0, 315.0, 45.0, 55.0, 0.0, 0.0, 15.0, 0.0, 85.0, 40.0, 35.0, 5.0, 20.0, 0.0, 35.0, 70.0, 5.0, 0.0, 0.0, 0.0, 5.0, 35.0, 20.0, 15.0, 0.0, 0.0, 105.0, 50.0, 145.0, 5.0, 25.0, 40.0, 5.0, 0.0, 30.0, 205.0, 445.0, 415.0, 15.0, 35.0, 40.0, 15.0, 150.0, 50.0, 0.0, 0.0, 35.0, 0.0, 0.0, 95.0, 20.0, 25.0, 50.0, 35.0, 85.0, 75.0, 1000.0, 75.0, 10.0, 0.0, 0.0, 30.0, 70.0, 80.0, 40.0, 15.0, 240.0, 250.0, 45.0, 30.0, 0.0, 0.0, 0.0, 135.0, 0.0, 10.0, 175.0, 45.0, 120.0, 45.0, 25.0, 20.0, 0.0, 0.0, 0.0, 0.0, 95.0, 60.0, 15.0, 80.0, 60.0, 95.0, 40.0, 55.0, 0.0, 10.0, 20.0, 275.0, 0.0, 0.0, 160.0, 85.0, 0.0, 0.0, 0.0, 0.0, 0.0, 220.0, 0.0, 75.0, 100.0, 60.0, 5.0, 430.0, 0.0, 15.0, 10.0, 0.0, 200.0, 0.0, 110.0, 305.0, 30.0, 5.0, 0.0, 0.0, 5.0, 0.0, 95.0, 35.0, 90.0, 0.0, 0.0, 140.0, 0.0, 210.0, 5.0, 0.0, 0.0, 5.0, 30.0, 180.0, 195.0, 0.0, 0.0, 0.0, 150.0, 10.0, 15.0, 15.0, 45.0, 25.0, 0.0, 30.0, 85.0, 0.0, 50.0, 95.0, 20.0, 0.0, 5.0, 10.0, 30.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6098130074688354, "mean_inference_ms": 1.3976336936597034, "mean_action_processing_ms": 0.2396348220021973, "mean_env_wait_ms": 0.1806103704559775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003934621810913086, "StateBufferConnector_ms": 0.003092646598815918, "ViewRequirementAgentConnector_ms": 0.09361553192138672}, "num_episodes": 18, "episode_return_max": 278.0, "episode_return_min": -925.0, "episode_return_mean": -47.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.49528343072413, "num_env_steps_trained_throughput_per_sec": 81.49528343072413, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 49501.682, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49501.628, "sample_time_ms": 1091.052, "learn_time_ms": 48391.585, "learn_throughput": 82.659, "synch_weights_time_ms": 14.969}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-57-56", "timestamp": 1723503476, "time_this_iter_s": 49.13082218170166, "time_total_s": 4909.146595954895, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aad48dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4909.146595954895, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 23.26857142857143, "ram_util_percent": 80.47714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1112877832991734, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1940741701731605, "policy_loss": -0.004413061048441305, "vf_loss": 2.197908559394261, "vf_explained_var": -0.0016383254969561541, "kl": 0.00771561651039944, "entropy": 0.5480785125304782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.805203828956715, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3399053340866454, "policy_loss": -0.013024021946287975, "vf_loss": 3.3514767564163006, "vf_explained_var": 0.14582441691999082, "kl": 0.007262978142074136, "entropy": 1.2483754861291754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 278.0, "episode_reward_min": -925.0, "episode_reward_mean": -17.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -66.87, "predator_policy": 57.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0, 76.0, 1.0, -2.0, 189.0, 13.0, -5.0, 29.0, -205.0, 101.0, 111.0, 18.0, -166.0, -331.0, -50.0, 33.0, -88.0, 23.0, 65.0, -1.0, 131.0, -15.0, -18.0, -925.0, 226.0, -30.0, 28.0, 65.0, -70.0, 14.0, 177.0, -134.0, 166.0, -220.0, -89.0, 169.0, 2.0, 0.0, -11.0, -95.0, 270.0, 72.0, 278.0, 4.0, 170.0, 28.0, 1.0, 0.0, -43.0, 37.0, 5.0, -304.0, -15.0, -10.0, -33.0, -582.0, -20.0, 0.0, -5.0, -66.0, 57.0, -54.0, -320.0, -2.0, 167.0, -270.0, -145.0, 0.0, 33.0, -10.0, -20.0, -30.0, -81.0, -56.0, -20.0, -5.0, -183.0, 33.0, 31.0, 135.0, 90.0, -155.0, -122.0, -80.0, 29.0, 0.0, -8.0, -145.0, -20.0, 1.0, 144.0, -5.0, 118.0, 0.0, 5.0, -70.0, -20.0, 107.0, -19.0, 192.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-70.0, -40.0, 86.0, -30.0, -84.0, -20.0, 3.0, -10.0, 0.0, 189.0, 43.0, -70.0, -40.0, 0.0, 0.0, 29.0, -200.0, -160.0, -202.0, 153.0, -110.0, 156.0, -10.0, 23.0, -351.0, -50.0, -320.0, -871.0, -70.0, -30.0, 0.0, -22.0, -310.0, 22.0, 0.0, 23.0, -14.0, 44.0, -96.0, 0.0, 46.0, 40.0, 0.0, -100.0, -178.0, 0.0, 0.0, -2000.0, 87.0, 129.0, 0.0, -60.0, -52.0, -70.0, 40.0, -30.0, -28.0, -532.0, -2.0, -59.0, 128.0, 49.0, 1.0, -270.0, -14.0, 170.0, -350.0, -90.0, -254.0, 0.0, 0.0, 124.0, 2.0, 0.0, 0.0, 0.0, -80.0, -86.0, 0.0, -190.0, 128.0, -13.0, -80.0, 57.0, 165.0, 103.0, -153.0, -138.0, 169.0, 1.0, 0.0, -217.0, 1.0, 0.0, 0.0, 0.0, -430.0, 167.0, -38.0, 0.0, 0.0, -155.0, -870.0, 131.0, 0.0, -30.0, -20.0, 0.0, 167.0, -400.0, -637.0, -360.0, -15.0, -40.0, 0.0, 0.0, -10.0, 0.0, -10.0, -186.0, 0.0, -33.0, -70.0, -124.0, -280.0, -250.0, 3.0, -10.0, 3.0, 159.0, -120.0, -360.0, -140.0, -200.0, 0.0, 0.0, 183.0, -310.0, 0.0, -40.0, 0.0, -90.0, 0.0, -60.0, -166.0, 0.0, -206.0, 5.0, 0.0, -40.0, -20.0, 0.0, -159.0, -149.0, -26.0, -41.0, -23.0, -41.0, -130.0, 45.0, -100.0, 140.0, -480.0, 65.0, -347.0, -50.0, -150.0, -40.0, 0.0, 9.0, 0.0, -20.0, 0.0, -118.0, -290.0, 0.0, -40.0, 0.0, -27.0, -62.0, 102.0, 2.0, -10.0, 0.0, 6.0, -23.0, 0.0, 0.0, -406.0, -14.0, -160.0, -10.0, -10.0, -20.0, -40.0, 7.0, -39.0, 0.0, 0.0, 192.0], "policy_predator_policy_reward": [35.0, 5.0, 20.0, 0.0, 35.0, 70.0, 5.0, 0.0, 0.0, 0.0, 5.0, 35.0, 20.0, 15.0, 0.0, 0.0, 105.0, 50.0, 145.0, 5.0, 25.0, 40.0, 5.0, 0.0, 30.0, 205.0, 445.0, 415.0, 15.0, 35.0, 40.0, 15.0, 150.0, 50.0, 0.0, 0.0, 35.0, 0.0, 0.0, 95.0, 20.0, 25.0, 50.0, 35.0, 85.0, 75.0, 1000.0, 75.0, 10.0, 0.0, 0.0, 30.0, 70.0, 80.0, 40.0, 15.0, 240.0, 250.0, 45.0, 30.0, 0.0, 0.0, 0.0, 135.0, 0.0, 10.0, 175.0, 45.0, 120.0, 45.0, 25.0, 20.0, 0.0, 0.0, 0.0, 0.0, 95.0, 60.0, 15.0, 80.0, 60.0, 95.0, 40.0, 55.0, 0.0, 10.0, 20.0, 275.0, 0.0, 0.0, 160.0, 85.0, 0.0, 0.0, 0.0, 0.0, 0.0, 220.0, 0.0, 75.0, 100.0, 60.0, 5.0, 430.0, 0.0, 15.0, 10.0, 0.0, 200.0, 0.0, 110.0, 305.0, 30.0, 5.0, 0.0, 0.0, 5.0, 0.0, 95.0, 35.0, 90.0, 0.0, 0.0, 140.0, 0.0, 210.0, 5.0, 0.0, 0.0, 5.0, 30.0, 180.0, 195.0, 0.0, 0.0, 0.0, 150.0, 10.0, 15.0, 15.0, 45.0, 25.0, 0.0, 30.0, 85.0, 0.0, 50.0, 95.0, 20.0, 0.0, 5.0, 10.0, 30.0, 95.0, 35.0, 65.0, 30.0, 65.0, 190.0, 30.0, 50.0, 0.0, 20.0, 240.0, 120.0, 155.0, 35.0, 75.0, 0.0, 20.0, 20.0, 0.0, 60.0, 50.0, 145.0, 0.0, 0.0, 20.0, 35.0, 55.0, 0.0, 40.0, 0.0, 5.0, 80.0, 55.0, 0.0, 0.0, 130.0, 295.0, 35.0, 65.0, 0.0, 10.0, 65.0, 75.0, 20.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6107226700096536, "mean_inference_ms": 1.3982995521753399, "mean_action_processing_ms": 0.2395858223321199, "mean_env_wait_ms": 0.18072239422295985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004058837890625, "StateBufferConnector_ms": 0.003184080123901367, "ViewRequirementAgentConnector_ms": 0.0971980094909668}, "num_episodes": 23, "episode_return_max": 278.0, "episode_return_min": -925.0, "episode_return_mean": -17.99, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.86728938008514, "num_env_steps_trained_throughput_per_sec": 79.86728938008514, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 49601.929, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49601.872, "sample_time_ms": 1128.139, "learn_time_ms": 48454.918, "learn_throughput": 82.551, "synch_weights_time_ms": 15.046}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-58-46", "timestamp": 1723503526, "time_this_iter_s": 50.11769199371338, "time_total_s": 4959.264287948608, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab87dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4959.264287948608, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 25.43802816901408, "ram_util_percent": 81.82535211267604}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.004197801862444, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.008704249821012, "policy_loss": -0.005029333052939918, "vf_loss": 4.013121912845228, "vf_explained_var": 0.0007467510208250984, "kl": 0.00815551660201353, "entropy": 0.6073670188428233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.040741087709154, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.211732061577853, "policy_loss": -0.009130975284869905, "vf_loss": 6.219576731939164, "vf_explained_var": -0.08773839445341201, "kl": 0.0064314997115633024, "entropy": 1.2164250019996885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 278.0, "episode_reward_min": -925.0, "episode_reward_mean": -9.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -63.335, "predator_policy": 58.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, -1.0, 131.0, -15.0, -18.0, -925.0, 226.0, -30.0, 28.0, 65.0, -70.0, 14.0, 177.0, -134.0, 166.0, -220.0, -89.0, 169.0, 2.0, 0.0, -11.0, -95.0, 270.0, 72.0, 278.0, 4.0, 170.0, 28.0, 1.0, 0.0, -43.0, 37.0, 5.0, -304.0, -15.0, -10.0, -33.0, -582.0, -20.0, 0.0, -5.0, -66.0, 57.0, -54.0, -320.0, -2.0, 167.0, -270.0, -145.0, 0.0, 33.0, -10.0, -20.0, -30.0, -81.0, -56.0, -20.0, -5.0, -183.0, 33.0, 31.0, 135.0, 90.0, -155.0, -122.0, -80.0, 29.0, 0.0, -8.0, -145.0, -20.0, 1.0, 144.0, -5.0, 118.0, 0.0, 5.0, -70.0, -20.0, 107.0, -19.0, 192.0, 115.0, -227.0, 45.0, 178.0, -25.0, -7.0, 98.0, 85.0, 90.0, 87.0, 64.0, -23.0, 29.0, -6.0, 135.0, 0.0, -100.0, 16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 44.0, -96.0, 0.0, 46.0, 40.0, 0.0, -100.0, -178.0, 0.0, 0.0, -2000.0, 87.0, 129.0, 0.0, -60.0, -52.0, -70.0, 40.0, -30.0, -28.0, -532.0, -2.0, -59.0, 128.0, 49.0, 1.0, -270.0, -14.0, 170.0, -350.0, -90.0, -254.0, 0.0, 0.0, 124.0, 2.0, 0.0, 0.0, 0.0, -80.0, -86.0, 0.0, -190.0, 128.0, -13.0, -80.0, 57.0, 165.0, 103.0, -153.0, -138.0, 169.0, 1.0, 0.0, -217.0, 1.0, 0.0, 0.0, 0.0, -430.0, 167.0, -38.0, 0.0, 0.0, -155.0, -870.0, 131.0, 0.0, -30.0, -20.0, 0.0, 167.0, -400.0, -637.0, -360.0, -15.0, -40.0, 0.0, 0.0, -10.0, 0.0, -10.0, -186.0, 0.0, -33.0, -70.0, -124.0, -280.0, -250.0, 3.0, -10.0, 3.0, 159.0, -120.0, -360.0, -140.0, -200.0, 0.0, 0.0, 183.0, -310.0, 0.0, -40.0, 0.0, -90.0, 0.0, -60.0, -166.0, 0.0, -206.0, 5.0, 0.0, -40.0, -20.0, 0.0, -159.0, -149.0, -26.0, -41.0, -23.0, -41.0, -130.0, 45.0, -100.0, 140.0, -480.0, 65.0, -347.0, -50.0, -150.0, -40.0, 0.0, 9.0, 0.0, -20.0, 0.0, -118.0, -290.0, 0.0, -40.0, 0.0, -27.0, -62.0, 102.0, 2.0, -10.0, 0.0, 6.0, -23.0, 0.0, 0.0, -406.0, -14.0, -160.0, -10.0, -10.0, -20.0, -40.0, 7.0, -39.0, 0.0, 0.0, 192.0, 0.0, 70.0, -285.0, -207.0, -20.0, -30.0, 91.0, -3.0, -110.0, 0.0, -202.0, 0.0, -100.0, 113.0, -37.0, 32.0, 0.0, 0.0, -15.0, -118.0, 134.0, -200.0, -70.0, -108.0, -86.0, 0.0, -80.0, -96.0, 30.0, 30.0, 0.0, 0.0, -60.0, -190.0, -6.0, -113.0], "policy_predator_policy_reward": [35.0, 0.0, 0.0, 95.0, 20.0, 25.0, 50.0, 35.0, 85.0, 75.0, 1000.0, 75.0, 10.0, 0.0, 0.0, 30.0, 70.0, 80.0, 40.0, 15.0, 240.0, 250.0, 45.0, 30.0, 0.0, 0.0, 0.0, 135.0, 0.0, 10.0, 175.0, 45.0, 120.0, 45.0, 25.0, 20.0, 0.0, 0.0, 0.0, 0.0, 95.0, 60.0, 15.0, 80.0, 60.0, 95.0, 40.0, 55.0, 0.0, 10.0, 20.0, 275.0, 0.0, 0.0, 160.0, 85.0, 0.0, 0.0, 0.0, 0.0, 0.0, 220.0, 0.0, 75.0, 100.0, 60.0, 5.0, 430.0, 0.0, 15.0, 10.0, 0.0, 200.0, 0.0, 110.0, 305.0, 30.0, 5.0, 0.0, 0.0, 5.0, 0.0, 95.0, 35.0, 90.0, 0.0, 0.0, 140.0, 0.0, 210.0, 5.0, 0.0, 0.0, 5.0, 30.0, 180.0, 195.0, 0.0, 0.0, 0.0, 150.0, 10.0, 15.0, 15.0, 45.0, 25.0, 0.0, 30.0, 85.0, 0.0, 50.0, 95.0, 20.0, 0.0, 5.0, 10.0, 30.0, 95.0, 35.0, 65.0, 30.0, 65.0, 190.0, 30.0, 50.0, 0.0, 20.0, 240.0, 120.0, 155.0, 35.0, 75.0, 0.0, 20.0, 20.0, 0.0, 60.0, 50.0, 145.0, 0.0, 0.0, 20.0, 35.0, 55.0, 0.0, 40.0, 0.0, 5.0, 80.0, 55.0, 0.0, 0.0, 130.0, 295.0, 35.0, 65.0, 0.0, 10.0, 65.0, 75.0, 20.0, 0.0, 0.0, 0.0, 20.0, 25.0, 150.0, 115.0, 65.0, 30.0, 40.0, 50.0, 30.0, 55.0, 70.0, 125.0, 20.0, 65.0, 0.0, 90.0, 90.0, 0.0, 110.0, 110.0, 100.0, 30.0, 60.0, 95.0, 110.0, 5.0, 130.0, 40.0, 15.0, 60.0, 0.0, 0.0, 30.0, 120.0, 55.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6106128671475111, "mean_inference_ms": 1.3988594215720034, "mean_action_processing_ms": 0.2398408960404285, "mean_env_wait_ms": 0.18087486980546758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004138946533203125, "StateBufferConnector_ms": 0.00311124324798584, "ViewRequirementAgentConnector_ms": 0.09623360633850098}, "num_episodes": 18, "episode_return_max": 278.0, "episode_return_min": -925.0, "episode_return_mean": -9.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.62885958574248, "num_env_steps_trained_throughput_per_sec": 79.62885958574248, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 49790.905, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49790.849, "sample_time_ms": 1131.454, "learn_time_ms": 48639.884, "learn_throughput": 82.237, "synch_weights_time_ms": 15.598}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "d8dc0_00000", "date": "2024-08-12_18-59-36", "timestamp": 1723503576, "time_this_iter_s": 50.28557205200195, "time_total_s": 5009.54986000061, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aae37e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5009.54986000061, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 28.55833333333333, "ram_util_percent": 81.18333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1854685877996776, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.1748499919497775, "policy_loss": -0.006247513638267283, "vf_loss": 4.1805327922578845, "vf_explained_var": 0.0017923269637678035, "kl": 0.007529627917105858, "entropy": 0.5217748362393606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9699025824271814, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.126440052002195, "policy_loss": -0.011602449160138214, "vf_loss": 6.136442598463997, "vf_explained_var": -0.06628225316446294, "kl": 0.00799948709670615, "entropy": 1.1755335573796872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 278.0, "episode_reward_min": -863.0, "episode_reward_mean": -28.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -870.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0, "predator_policy": 430.0}, "policy_reward_mean": {"prey_policy": -81.025, "predator_policy": 66.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, -11.0, -95.0, 270.0, 72.0, 278.0, 4.0, 170.0, 28.0, 1.0, 0.0, -43.0, 37.0, 5.0, -304.0, -15.0, -10.0, -33.0, -582.0, -20.0, 0.0, -5.0, -66.0, 57.0, -54.0, -320.0, -2.0, 167.0, -270.0, -145.0, 0.0, 33.0, -10.0, -20.0, -30.0, -81.0, -56.0, -20.0, -5.0, -183.0, 33.0, 31.0, 135.0, 90.0, -155.0, -122.0, -80.0, 29.0, 0.0, -8.0, -145.0, -20.0, 1.0, 144.0, -5.0, 118.0, 0.0, 5.0, -70.0, -20.0, 107.0, -19.0, 192.0, 115.0, -227.0, 45.0, 178.0, -25.0, -7.0, 98.0, 85.0, 90.0, 87.0, 64.0, -23.0, 29.0, -6.0, 135.0, 0.0, -100.0, 16.0, -863.0, -275.0, -76.0, 102.0, 167.0, 38.0, -109.0, -46.0, -640.0, -24.0, 150.0, -194.0, -103.0, 115.0, 149.0, -295.0, -10.0, -445.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, 0.0, 0.0, 0.0, -80.0, -86.0, 0.0, -190.0, 128.0, -13.0, -80.0, 57.0, 165.0, 103.0, -153.0, -138.0, 169.0, 1.0, 0.0, -217.0, 1.0, 0.0, 0.0, 0.0, -430.0, 167.0, -38.0, 0.0, 0.0, -155.0, -870.0, 131.0, 0.0, -30.0, -20.0, 0.0, 167.0, -400.0, -637.0, -360.0, -15.0, -40.0, 0.0, 0.0, -10.0, 0.0, -10.0, -186.0, 0.0, -33.0, -70.0, -124.0, -280.0, -250.0, 3.0, -10.0, 3.0, 159.0, -120.0, -360.0, -140.0, -200.0, 0.0, 0.0, 183.0, -310.0, 0.0, -40.0, 0.0, -90.0, 0.0, -60.0, -166.0, 0.0, -206.0, 5.0, 0.0, -40.0, -20.0, 0.0, -159.0, -149.0, -26.0, -41.0, -23.0, -41.0, -130.0, 45.0, -100.0, 140.0, -480.0, 65.0, -347.0, -50.0, -150.0, -40.0, 0.0, 9.0, 0.0, -20.0, 0.0, -118.0, -290.0, 0.0, -40.0, 0.0, -27.0, -62.0, 102.0, 2.0, -10.0, 0.0, 6.0, -23.0, 0.0, 0.0, -406.0, -14.0, -160.0, -10.0, -10.0, -20.0, -40.0, 7.0, -39.0, 0.0, 0.0, 192.0, 0.0, 70.0, -285.0, -207.0, -20.0, -30.0, 91.0, -3.0, -110.0, 0.0, -202.0, 0.0, -100.0, 113.0, -37.0, 32.0, 0.0, 0.0, -15.0, -118.0, 134.0, -200.0, -70.0, -108.0, -86.0, 0.0, -80.0, -96.0, 30.0, 30.0, 0.0, 0.0, -60.0, -190.0, -6.0, -113.0, -698.0, -600.0, -201.0, -519.0, -50.0, -206.0, -10.0, 47.0, -39.0, 31.0, 0.0, -22.0, -409.0, -10.0, -171.0, 0.0, -670.0, -395.0, 3.0, -297.0, -79.0, 189.0, -433.0, -136.0, -78.0, -300.0, -50.0, 140.0, 169.0, -60.0, -755.0, 0.0, -340.0, 0.0, -110.0, -820.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 95.0, 60.0, 15.0, 80.0, 60.0, 95.0, 40.0, 55.0, 0.0, 10.0, 20.0, 275.0, 0.0, 0.0, 160.0, 85.0, 0.0, 0.0, 0.0, 0.0, 0.0, 220.0, 0.0, 75.0, 100.0, 60.0, 5.0, 430.0, 0.0, 15.0, 10.0, 0.0, 200.0, 0.0, 110.0, 305.0, 30.0, 5.0, 0.0, 0.0, 5.0, 0.0, 95.0, 35.0, 90.0, 0.0, 0.0, 140.0, 0.0, 210.0, 5.0, 0.0, 0.0, 5.0, 30.0, 180.0, 195.0, 0.0, 0.0, 0.0, 150.0, 10.0, 15.0, 15.0, 45.0, 25.0, 0.0, 30.0, 85.0, 0.0, 50.0, 95.0, 20.0, 0.0, 5.0, 10.0, 30.0, 95.0, 35.0, 65.0, 30.0, 65.0, 190.0, 30.0, 50.0, 0.0, 20.0, 240.0, 120.0, 155.0, 35.0, 75.0, 0.0, 20.0, 20.0, 0.0, 60.0, 50.0, 145.0, 0.0, 0.0, 20.0, 35.0, 55.0, 0.0, 40.0, 0.0, 5.0, 80.0, 55.0, 0.0, 0.0, 130.0, 295.0, 35.0, 65.0, 0.0, 10.0, 65.0, 75.0, 20.0, 0.0, 0.0, 0.0, 20.0, 25.0, 150.0, 115.0, 65.0, 30.0, 40.0, 50.0, 30.0, 55.0, 70.0, 125.0, 20.0, 65.0, 0.0, 90.0, 90.0, 0.0, 110.0, 110.0, 100.0, 30.0, 60.0, 95.0, 110.0, 5.0, 130.0, 40.0, 15.0, 60.0, 0.0, 0.0, 30.0, 120.0, 55.0, 80.0, 145.0, 290.0, 210.0, 235.0, 125.0, 55.0, 5.0, 60.0, 75.0, 100.0, 0.0, 60.0, 45.0, 265.0, 90.0, 35.0, 140.0, 285.0, 130.0, 140.0, 10.0, 30.0, 175.0, 200.0, 125.0, 150.0, 0.0, 25.0, 30.0, 10.0, 85.0, 375.0, 150.0, 180.0, 345.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6110692982429162, "mean_inference_ms": 1.3997274230670376, "mean_action_processing_ms": 0.2399733214344156, "mean_env_wait_ms": 0.1810116985101471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041234493255615234, "StateBufferConnector_ms": 0.00316774845123291, "ViewRequirementAgentConnector_ms": 0.09975087642669678}, "num_episodes": 18, "episode_return_max": 278.0, "episode_return_min": -863.0, "episode_return_mean": -28.2, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.42242193406099, "num_env_steps_trained_throughput_per_sec": 81.42242193406099, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 49816.727, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49816.672, "sample_time_ms": 1158.994, "learn_time_ms": 48638.165, "learn_throughput": 82.24, "synch_weights_time_ms": 15.78}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-00-25", "timestamp": 1723503625, "time_this_iter_s": 49.18974995613098, "time_total_s": 5058.739609956741, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aad3f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5058.739609956741, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 24.43714285714286, "ram_util_percent": 82.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0880283972573657, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.231905834384696, "policy_loss": -0.004033001110686984, "vf_loss": 4.235430114609855, "vf_explained_var": 0.0016350941052512516, "kl": 0.006782970623710126, "entropy": 0.6089712830447646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4178122458634554, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.223384654837311, "policy_loss": -0.010326302243598673, "vf_loss": 5.232234100185374, "vf_explained_var": -0.04264555841526657, "kl": 0.007384312670817413, "entropy": 1.203085276689479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 327.0, "episode_reward_min": -863.0, "episode_reward_mean": -35.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -890.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 445.0}, "policy_reward_mean": {"prey_policy": -93.69, "predator_policy": 75.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, -66.0, 57.0, -54.0, -320.0, -2.0, 167.0, -270.0, -145.0, 0.0, 33.0, -10.0, -20.0, -30.0, -81.0, -56.0, -20.0, -5.0, -183.0, 33.0, 31.0, 135.0, 90.0, -155.0, -122.0, -80.0, 29.0, 0.0, -8.0, -145.0, -20.0, 1.0, 144.0, -5.0, 118.0, 0.0, 5.0, -70.0, -20.0, 107.0, -19.0, 192.0, 115.0, -227.0, 45.0, 178.0, -25.0, -7.0, 98.0, 85.0, 90.0, 87.0, 64.0, -23.0, 29.0, -6.0, 135.0, 0.0, -100.0, 16.0, -863.0, -275.0, -76.0, 102.0, 167.0, 38.0, -109.0, -46.0, -640.0, -24.0, 150.0, -194.0, -103.0, 115.0, 149.0, -295.0, -10.0, -445.0, 327.0, 0.0, -55.0, -31.0, 29.0, -30.0, 156.0, -481.0, -3.0, 164.0, 1.0, -455.0, 72.0, -122.0, -186.0, 48.0, -46.0, 41.0, -41.0, -268.0, -31.0, -58.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, 0.0, -10.0, -186.0, 0.0, -33.0, -70.0, -124.0, -280.0, -250.0, 3.0, -10.0, 3.0, 159.0, -120.0, -360.0, -140.0, -200.0, 0.0, 0.0, 183.0, -310.0, 0.0, -40.0, 0.0, -90.0, 0.0, -60.0, -166.0, 0.0, -206.0, 5.0, 0.0, -40.0, -20.0, 0.0, -159.0, -149.0, -26.0, -41.0, -23.0, -41.0, -130.0, 45.0, -100.0, 140.0, -480.0, 65.0, -347.0, -50.0, -150.0, -40.0, 0.0, 9.0, 0.0, -20.0, 0.0, -118.0, -290.0, 0.0, -40.0, 0.0, -27.0, -62.0, 102.0, 2.0, -10.0, 0.0, 6.0, -23.0, 0.0, 0.0, -406.0, -14.0, -160.0, -10.0, -10.0, -20.0, -40.0, 7.0, -39.0, 0.0, 0.0, 192.0, 0.0, 70.0, -285.0, -207.0, -20.0, -30.0, 91.0, -3.0, -110.0, 0.0, -202.0, 0.0, -100.0, 113.0, -37.0, 32.0, 0.0, 0.0, -15.0, -118.0, 134.0, -200.0, -70.0, -108.0, -86.0, 0.0, -80.0, -96.0, 30.0, 30.0, 0.0, 0.0, -60.0, -190.0, -6.0, -113.0, -698.0, -600.0, -201.0, -519.0, -50.0, -206.0, -10.0, 47.0, -39.0, 31.0, 0.0, -22.0, -409.0, -10.0, -171.0, 0.0, -670.0, -395.0, 3.0, -297.0, -79.0, 189.0, -433.0, -136.0, -78.0, -300.0, -50.0, 140.0, 169.0, -60.0, -755.0, 0.0, -340.0, 0.0, -110.0, -820.0, 182.0, 100.0, -90.0, -120.0, -30.0, -80.0, -125.0, -201.0, -54.0, -82.0, 0.0, -60.0, 32.0, 14.0, -570.0, -311.0, -48.0, 0.0, 194.0, -200.0, 0.0, -254.0, -890.0, -20.0, -30.0, -83.0, 2.0, -474.0, -169.0, -247.0, -22.0, -80.0, -60.0, -146.0, -9.0, -130.0, 0.0, -286.0, -420.0, -198.0, -90.0, -156.0, -134.0, -49.0], "policy_predator_policy_reward": [5.0, 0.0, 95.0, 35.0, 90.0, 0.0, 0.0, 140.0, 0.0, 210.0, 5.0, 0.0, 0.0, 5.0, 30.0, 180.0, 195.0, 0.0, 0.0, 0.0, 150.0, 10.0, 15.0, 15.0, 45.0, 25.0, 0.0, 30.0, 85.0, 0.0, 50.0, 95.0, 20.0, 0.0, 5.0, 10.0, 30.0, 95.0, 35.0, 65.0, 30.0, 65.0, 190.0, 30.0, 50.0, 0.0, 20.0, 240.0, 120.0, 155.0, 35.0, 75.0, 0.0, 20.0, 20.0, 0.0, 60.0, 50.0, 145.0, 0.0, 0.0, 20.0, 35.0, 55.0, 0.0, 40.0, 0.0, 5.0, 80.0, 55.0, 0.0, 0.0, 130.0, 295.0, 35.0, 65.0, 0.0, 10.0, 65.0, 75.0, 20.0, 0.0, 0.0, 0.0, 20.0, 25.0, 150.0, 115.0, 65.0, 30.0, 40.0, 50.0, 30.0, 55.0, 70.0, 125.0, 20.0, 65.0, 0.0, 90.0, 90.0, 0.0, 110.0, 110.0, 100.0, 30.0, 60.0, 95.0, 110.0, 5.0, 130.0, 40.0, 15.0, 60.0, 0.0, 0.0, 30.0, 120.0, 55.0, 80.0, 145.0, 290.0, 210.0, 235.0, 125.0, 55.0, 5.0, 60.0, 75.0, 100.0, 0.0, 60.0, 45.0, 265.0, 90.0, 35.0, 140.0, 285.0, 130.0, 140.0, 10.0, 30.0, 175.0, 200.0, 125.0, 150.0, 0.0, 25.0, 30.0, 10.0, 85.0, 375.0, 150.0, 180.0, 345.0, 140.0, 10.0, 35.0, 145.0, 65.0, 40.0, 15.0, 120.0, 175.0, 110.0, 55.0, 30.0, 0.0, 110.0, 0.0, 175.0, 225.0, 35.0, 10.0, 95.0, 75.0, 95.0, 160.0, 10.0, 445.0, 70.0, 115.0, 265.0, 85.0, 80.0, 150.0, 20.0, 130.0, 5.0, 155.0, 95.0, 85.0, 100.0, 145.0, 135.0, 215.0, 60.0, 155.0, 60.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6114252373465671, "mean_inference_ms": 1.4005679774043045, "mean_action_processing_ms": 0.24011296509076552, "mean_env_wait_ms": 0.1811364190260894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003917694091796875, "StateBufferConnector_ms": 0.0033981800079345703, "ViewRequirementAgentConnector_ms": 0.09986519813537598}, "num_episodes": 22, "episode_return_max": 327.0, "episode_return_min": -863.0, "episode_return_mean": -35.43, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.34240497871751, "num_env_steps_trained_throughput_per_sec": 81.34240497871751, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 49822.189, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49822.134, "sample_time_ms": 1163.912, "learn_time_ms": 48638.908, "learn_throughput": 82.239, "synch_weights_time_ms": 15.697}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-01-15", "timestamp": 1723503675, "time_this_iter_s": 49.21212601661682, "time_total_s": 5107.951735973358, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab8a5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5107.951735973358, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 24.134285714285717, "ram_util_percent": 82.19142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.89097043947568, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.873285458958338, "policy_loss": -0.006532029088379608, "vf_loss": 4.879302459166794, "vf_explained_var": 0.000523866232110079, "kl": 0.00686706180096399, "entropy": 0.5600839580335314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.244138253870465, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.498072505375696, "policy_loss": -0.010949124789565171, "vf_loss": 6.507746306172123, "vf_explained_var": -0.05832002456226046, "kl": 0.006376497506579313, "entropy": 1.1747636959666297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 368.0, "episode_reward_min": -932.0, "episode_reward_mean": -51.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 445.0}, "policy_reward_mean": {"prey_policy": -116.905, "predator_policy": 91.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.0, 33.0, 31.0, 135.0, 90.0, -155.0, -122.0, -80.0, 29.0, 0.0, -8.0, -145.0, -20.0, 1.0, 144.0, -5.0, 118.0, 0.0, 5.0, -70.0, -20.0, 107.0, -19.0, 192.0, 115.0, -227.0, 45.0, 178.0, -25.0, -7.0, 98.0, 85.0, 90.0, 87.0, 64.0, -23.0, 29.0, -6.0, 135.0, 0.0, -100.0, 16.0, -863.0, -275.0, -76.0, 102.0, 167.0, 38.0, -109.0, -46.0, -640.0, -24.0, 150.0, -194.0, -103.0, 115.0, 149.0, -295.0, -10.0, -445.0, 327.0, 0.0, -55.0, -31.0, 29.0, -30.0, 156.0, -481.0, -3.0, 164.0, 1.0, -455.0, 72.0, -122.0, -186.0, 48.0, -46.0, 41.0, -41.0, -268.0, -31.0, -58.0, 46.0, -252.0, -106.0, 2.0, -100.0, -932.0, 282.0, 368.0, -70.0, -64.0, 58.0, -801.0, -180.0, -385.0, 17.0, -321.0, -5.0, 38.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-159.0, -149.0, -26.0, -41.0, -23.0, -41.0, -130.0, 45.0, -100.0, 140.0, -480.0, 65.0, -347.0, -50.0, -150.0, -40.0, 0.0, 9.0, 0.0, -20.0, 0.0, -118.0, -290.0, 0.0, -40.0, 0.0, -27.0, -62.0, 102.0, 2.0, -10.0, 0.0, 6.0, -23.0, 0.0, 0.0, -406.0, -14.0, -160.0, -10.0, -10.0, -20.0, -40.0, 7.0, -39.0, 0.0, 0.0, 192.0, 0.0, 70.0, -285.0, -207.0, -20.0, -30.0, 91.0, -3.0, -110.0, 0.0, -202.0, 0.0, -100.0, 113.0, -37.0, 32.0, 0.0, 0.0, -15.0, -118.0, 134.0, -200.0, -70.0, -108.0, -86.0, 0.0, -80.0, -96.0, 30.0, 30.0, 0.0, 0.0, -60.0, -190.0, -6.0, -113.0, -698.0, -600.0, -201.0, -519.0, -50.0, -206.0, -10.0, 47.0, -39.0, 31.0, 0.0, -22.0, -409.0, -10.0, -171.0, 0.0, -670.0, -395.0, 3.0, -297.0, -79.0, 189.0, -433.0, -136.0, -78.0, -300.0, -50.0, 140.0, 169.0, -60.0, -755.0, 0.0, -340.0, 0.0, -110.0, -820.0, 182.0, 100.0, -90.0, -120.0, -30.0, -80.0, -125.0, -201.0, -54.0, -82.0, 0.0, -60.0, 32.0, 14.0, -570.0, -311.0, -48.0, 0.0, 194.0, -200.0, 0.0, -254.0, -890.0, -20.0, -30.0, -83.0, 2.0, -474.0, -169.0, -247.0, -22.0, -80.0, -60.0, -146.0, -9.0, -130.0, 0.0, -286.0, -420.0, -198.0, -90.0, -156.0, -134.0, -49.0, -69.0, -20.0, -407.0, -240.0, -109.0, -187.0, -91.0, -262.0, -155.0, -120.0, -700.0, -967.0, 83.0, 164.0, 181.0, 177.0, -105.0, -120.0, -119.0, -20.0, -92.0, 60.0, -659.0, -692.0, -20.0, -520.0, -415.0, -320.0, 0.0, -278.0, -203.0, -438.0, 0.0, -10.0, -210.0, -132.0], "policy_predator_policy_reward": [30.0, 95.0, 35.0, 65.0, 30.0, 65.0, 190.0, 30.0, 50.0, 0.0, 20.0, 240.0, 120.0, 155.0, 35.0, 75.0, 0.0, 20.0, 20.0, 0.0, 60.0, 50.0, 145.0, 0.0, 0.0, 20.0, 35.0, 55.0, 0.0, 40.0, 0.0, 5.0, 80.0, 55.0, 0.0, 0.0, 130.0, 295.0, 35.0, 65.0, 0.0, 10.0, 65.0, 75.0, 20.0, 0.0, 0.0, 0.0, 20.0, 25.0, 150.0, 115.0, 65.0, 30.0, 40.0, 50.0, 30.0, 55.0, 70.0, 125.0, 20.0, 65.0, 0.0, 90.0, 90.0, 0.0, 110.0, 110.0, 100.0, 30.0, 60.0, 95.0, 110.0, 5.0, 130.0, 40.0, 15.0, 60.0, 0.0, 0.0, 30.0, 120.0, 55.0, 80.0, 145.0, 290.0, 210.0, 235.0, 125.0, 55.0, 5.0, 60.0, 75.0, 100.0, 0.0, 60.0, 45.0, 265.0, 90.0, 35.0, 140.0, 285.0, 130.0, 140.0, 10.0, 30.0, 175.0, 200.0, 125.0, 150.0, 0.0, 25.0, 30.0, 10.0, 85.0, 375.0, 150.0, 180.0, 345.0, 140.0, 10.0, 35.0, 145.0, 65.0, 40.0, 15.0, 120.0, 175.0, 110.0, 55.0, 30.0, 0.0, 110.0, 0.0, 175.0, 225.0, 35.0, 10.0, 95.0, 75.0, 95.0, 160.0, 10.0, 445.0, 70.0, 115.0, 265.0, 85.0, 80.0, 150.0, 20.0, 130.0, 5.0, 155.0, 95.0, 85.0, 100.0, 145.0, 135.0, 215.0, 60.0, 155.0, 60.0, 65.0, 95.0, 40.0, 135.0, 260.0, 95.0, 95.0, 125.0, 230.0, 0.0, 175.0, 390.0, 345.0, 35.0, 0.0, 10.0, 0.0, 0.0, 155.0, 65.0, 10.0, 0.0, 90.0, 175.0, 375.0, 220.0, 140.0, 235.0, 115.0, 130.0, 165.0, 110.0, 210.0, 5.0, 0.0, 200.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6116976787140982, "mean_inference_ms": 1.4012222108225023, "mean_action_processing_ms": 0.24021585232457227, "mean_env_wait_ms": 0.18121642119352618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039010047912597656, "StateBufferConnector_ms": 0.003380417823791504, "ViewRequirementAgentConnector_ms": 0.09991896152496338}, "num_episodes": 18, "episode_return_max": 368.0, "episode_return_min": -932.0, "episode_return_mean": -51.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.64009208097458, "num_env_steps_trained_throughput_per_sec": 81.64009208097458, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 49806.025, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49805.962, "sample_time_ms": 1158.423, "learn_time_ms": 48627.294, "learn_throughput": 82.258, "synch_weights_time_ms": 16.807}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-02-04", "timestamp": 1723503724, "time_this_iter_s": 49.02379393577576, "time_total_s": 5156.975529909134, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aad481f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5156.975529909134, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 24.801449275362323, "ram_util_percent": 82.71304347826086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7181351597346957, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.963711334031726, "policy_loss": -0.00486899421959327, "vf_loss": 4.968033853788224, "vf_explained_var": 0.0017063287200120392, "kl": 0.007286271318532883, "entropy": 0.5430328804822195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.497858386632626, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.358205392877892, "policy_loss": -0.01322645479665389, "vf_loss": 6.369714894875017, "vf_explained_var": -0.046401791881631925, "kl": 0.0085847286662815, "entropy": 1.20396567274023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 368.0, "episode_reward_min": -1524.0, "episode_reward_mean": -91.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1320.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 875.0}, "policy_reward_mean": {"prey_policy": -151.915, "predator_policy": 106.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.0, 115.0, -227.0, 45.0, 178.0, -25.0, -7.0, 98.0, 85.0, 90.0, 87.0, 64.0, -23.0, 29.0, -6.0, 135.0, 0.0, -100.0, 16.0, -863.0, -275.0, -76.0, 102.0, 167.0, 38.0, -109.0, -46.0, -640.0, -24.0, 150.0, -194.0, -103.0, 115.0, 149.0, -295.0, -10.0, -445.0, 327.0, 0.0, -55.0, -31.0, 29.0, -30.0, 156.0, -481.0, -3.0, 164.0, 1.0, -455.0, 72.0, -122.0, -186.0, 48.0, -46.0, 41.0, -41.0, -268.0, -31.0, -58.0, 46.0, -252.0, -106.0, 2.0, -100.0, -932.0, 282.0, 368.0, -70.0, -64.0, 58.0, -801.0, -180.0, -385.0, 17.0, -321.0, -5.0, 38.0, 185.0, -225.0, -10.0, -404.0, 59.0, -250.0, 8.0, 26.0, 69.0, 42.0, 5.0, -851.0, -774.0, -297.0, -43.0, -20.0, 15.0, -25.0, -135.0, 37.0, -21.0, 7.0, -1524.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 192.0, 0.0, 70.0, -285.0, -207.0, -20.0, -30.0, 91.0, -3.0, -110.0, 0.0, -202.0, 0.0, -100.0, 113.0, -37.0, 32.0, 0.0, 0.0, -15.0, -118.0, 134.0, -200.0, -70.0, -108.0, -86.0, 0.0, -80.0, -96.0, 30.0, 30.0, 0.0, 0.0, -60.0, -190.0, -6.0, -113.0, -698.0, -600.0, -201.0, -519.0, -50.0, -206.0, -10.0, 47.0, -39.0, 31.0, 0.0, -22.0, -409.0, -10.0, -171.0, 0.0, -670.0, -395.0, 3.0, -297.0, -79.0, 189.0, -433.0, -136.0, -78.0, -300.0, -50.0, 140.0, 169.0, -60.0, -755.0, 0.0, -340.0, 0.0, -110.0, -820.0, 182.0, 100.0, -90.0, -120.0, -30.0, -80.0, -125.0, -201.0, -54.0, -82.0, 0.0, -60.0, 32.0, 14.0, -570.0, -311.0, -48.0, 0.0, 194.0, -200.0, 0.0, -254.0, -890.0, -20.0, -30.0, -83.0, 2.0, -474.0, -169.0, -247.0, -22.0, -80.0, -60.0, -146.0, -9.0, -130.0, 0.0, -286.0, -420.0, -198.0, -90.0, -156.0, -134.0, -49.0, -69.0, -20.0, -407.0, -240.0, -109.0, -187.0, -91.0, -262.0, -155.0, -120.0, -700.0, -967.0, 83.0, 164.0, 181.0, 177.0, -105.0, -120.0, -119.0, -20.0, -92.0, 60.0, -659.0, -692.0, -20.0, -520.0, -415.0, -320.0, 0.0, -278.0, -203.0, -438.0, 0.0, -10.0, -210.0, -132.0, 178.0, 2.0, -292.0, -273.0, 0.0, -20.0, -395.0, -339.0, -70.0, 94.0, -5.0, -640.0, -137.0, -20.0, -55.0, -39.0, -1.0, 0.0, 0.0, -83.0, -140.0, 0.0, -1320.0, -266.0, -670.0, -639.0, -300.0, -282.0, -30.0, -343.0, -40.0, -170.0, -120.0, 70.0, 0.0, -50.0, -280.0, 0.0, -109.0, -14.0, -141.0, -50.0, -51.0, -172.0, -1181.0, -1258.0], "policy_predator_policy_reward": [0.0, 0.0, 20.0, 25.0, 150.0, 115.0, 65.0, 30.0, 40.0, 50.0, 30.0, 55.0, 70.0, 125.0, 20.0, 65.0, 0.0, 90.0, 90.0, 0.0, 110.0, 110.0, 100.0, 30.0, 60.0, 95.0, 110.0, 5.0, 130.0, 40.0, 15.0, 60.0, 0.0, 0.0, 30.0, 120.0, 55.0, 80.0, 145.0, 290.0, 210.0, 235.0, 125.0, 55.0, 5.0, 60.0, 75.0, 100.0, 0.0, 60.0, 45.0, 265.0, 90.0, 35.0, 140.0, 285.0, 130.0, 140.0, 10.0, 30.0, 175.0, 200.0, 125.0, 150.0, 0.0, 25.0, 30.0, 10.0, 85.0, 375.0, 150.0, 180.0, 345.0, 140.0, 10.0, 35.0, 145.0, 65.0, 40.0, 15.0, 120.0, 175.0, 110.0, 55.0, 30.0, 0.0, 110.0, 0.0, 175.0, 225.0, 35.0, 10.0, 95.0, 75.0, 95.0, 160.0, 10.0, 445.0, 70.0, 115.0, 265.0, 85.0, 80.0, 150.0, 20.0, 130.0, 5.0, 155.0, 95.0, 85.0, 100.0, 145.0, 135.0, 215.0, 60.0, 155.0, 60.0, 65.0, 95.0, 40.0, 135.0, 260.0, 95.0, 95.0, 125.0, 230.0, 0.0, 175.0, 390.0, 345.0, 35.0, 0.0, 10.0, 0.0, 0.0, 155.0, 65.0, 10.0, 0.0, 90.0, 175.0, 375.0, 220.0, 140.0, 235.0, 115.0, 130.0, 165.0, 110.0, 210.0, 5.0, 0.0, 200.0, 180.0, 5.0, 0.0, 175.0, 165.0, 10.0, 0.0, 300.0, 30.0, 15.0, 20.0, 320.0, 75.0, 35.0, 130.0, 0.0, 120.0, 65.0, 5.0, 0.0, 125.0, 0.0, 145.0, 60.0, 675.0, 320.0, 215.0, 145.0, 140.0, 170.0, 160.0, 85.0, 105.0, 10.0, 55.0, 0.0, 25.0, 15.0, 130.0, 0.0, 160.0, 100.0, 70.0, 115.0, 115.0, 40.0, 875.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6116367166392772, "mean_inference_ms": 1.400492637486315, "mean_action_processing_ms": 0.2401750874606366, "mean_env_wait_ms": 0.18117701273977105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735780715942383, "StateBufferConnector_ms": 0.003250718116760254, "ViewRequirementAgentConnector_ms": 0.09547662734985352}, "num_episodes": 23, "episode_return_max": 368.0, "episode_return_min": -1524.0, "episode_return_mean": -91.13, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.38963068668397, "num_env_steps_trained_throughput_per_sec": 80.38963068668397, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 49952.489, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49952.418, "sample_time_ms": 1152.411, "learn_time_ms": 48778.456, "learn_throughput": 82.003, "synch_weights_time_ms": 17.212}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-02-54", "timestamp": 1723503774, "time_this_iter_s": 49.78924107551575, "time_total_s": 5206.76477098465, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aae2fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5206.76477098465, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 25.22112676056338, "ram_util_percent": 82.67042253521127}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6052940059275853, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3197949602490375, "policy_loss": -0.0031875518909483046, "vf_loss": 4.322583719914553, "vf_explained_var": -0.00026976592326290394, "kl": 0.00531726014561988, "entropy": 0.5939749122927429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7188770943217806, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.403155481121527, "policy_loss": -0.010013453245271371, "vf_loss": 4.4119495270744205, "vf_explained_var": -0.032364747101667694, "kl": 0.006096995171768445, "entropy": 1.2505927900788645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 368.0, "episode_reward_min": -2475.0, "episode_reward_mean": -157.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1950.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -204.375, "predator_policy": 125.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -863.0, -275.0, -76.0, 102.0, 167.0, 38.0, -109.0, -46.0, -640.0, -24.0, 150.0, -194.0, -103.0, 115.0, 149.0, -295.0, -10.0, -445.0, 327.0, 0.0, -55.0, -31.0, 29.0, -30.0, 156.0, -481.0, -3.0, 164.0, 1.0, -455.0, 72.0, -122.0, -186.0, 48.0, -46.0, 41.0, -41.0, -268.0, -31.0, -58.0, 46.0, -252.0, -106.0, 2.0, -100.0, -932.0, 282.0, 368.0, -70.0, -64.0, 58.0, -801.0, -180.0, -385.0, 17.0, -321.0, -5.0, 38.0, 185.0, -225.0, -10.0, -404.0, 59.0, -250.0, 8.0, 26.0, 69.0, 42.0, 5.0, -851.0, -774.0, -297.0, -43.0, -20.0, 15.0, -25.0, -135.0, 37.0, -21.0, 7.0, -1524.0, -276.0, -20.0, -429.0, -2475.0, -519.0, -274.0, -237.0, -35.0, -270.0, -12.0, -15.0, -49.0, -707.0, 18.0, -58.0, 0.0, -514.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -113.0, -698.0, -600.0, -201.0, -519.0, -50.0, -206.0, -10.0, 47.0, -39.0, 31.0, 0.0, -22.0, -409.0, -10.0, -171.0, 0.0, -670.0, -395.0, 3.0, -297.0, -79.0, 189.0, -433.0, -136.0, -78.0, -300.0, -50.0, 140.0, 169.0, -60.0, -755.0, 0.0, -340.0, 0.0, -110.0, -820.0, 182.0, 100.0, -90.0, -120.0, -30.0, -80.0, -125.0, -201.0, -54.0, -82.0, 0.0, -60.0, 32.0, 14.0, -570.0, -311.0, -48.0, 0.0, 194.0, -200.0, 0.0, -254.0, -890.0, -20.0, -30.0, -83.0, 2.0, -474.0, -169.0, -247.0, -22.0, -80.0, -60.0, -146.0, -9.0, -130.0, 0.0, -286.0, -420.0, -198.0, -90.0, -156.0, -134.0, -49.0, -69.0, -20.0, -407.0, -240.0, -109.0, -187.0, -91.0, -262.0, -155.0, -120.0, -700.0, -967.0, 83.0, 164.0, 181.0, 177.0, -105.0, -120.0, -119.0, -20.0, -92.0, 60.0, -659.0, -692.0, -20.0, -520.0, -415.0, -320.0, 0.0, -278.0, -203.0, -438.0, 0.0, -10.0, -210.0, -132.0, 178.0, 2.0, -292.0, -273.0, 0.0, -20.0, -395.0, -339.0, -70.0, 94.0, -5.0, -640.0, -137.0, -20.0, -55.0, -39.0, -1.0, 0.0, 0.0, -83.0, -140.0, 0.0, -1320.0, -266.0, -670.0, -639.0, -300.0, -282.0, -30.0, -343.0, -40.0, -170.0, -120.0, 70.0, 0.0, -50.0, -280.0, 0.0, -109.0, -14.0, -141.0, -50.0, -51.0, -172.0, -1181.0, -1258.0, -206.0, -310.0, 0.0, -40.0, -210.0, -664.0, -1890.0, -1950.0, 196.0, -1430.0, -280.0, -199.0, -199.0, -273.0, 0.0, -190.0, -390.0, -250.0, 0.0, -227.0, 0.0, -30.0, 56.0, -320.0, -600.0, -907.0, 0.0, -197.0, -288.0, 0.0, 0.0, 0.0, -50.0, -969.0, 0.0, 0.0], "policy_predator_policy_reward": [55.0, 80.0, 145.0, 290.0, 210.0, 235.0, 125.0, 55.0, 5.0, 60.0, 75.0, 100.0, 0.0, 60.0, 45.0, 265.0, 90.0, 35.0, 140.0, 285.0, 130.0, 140.0, 10.0, 30.0, 175.0, 200.0, 125.0, 150.0, 0.0, 25.0, 30.0, 10.0, 85.0, 375.0, 150.0, 180.0, 345.0, 140.0, 10.0, 35.0, 145.0, 65.0, 40.0, 15.0, 120.0, 175.0, 110.0, 55.0, 30.0, 0.0, 110.0, 0.0, 175.0, 225.0, 35.0, 10.0, 95.0, 75.0, 95.0, 160.0, 10.0, 445.0, 70.0, 115.0, 265.0, 85.0, 80.0, 150.0, 20.0, 130.0, 5.0, 155.0, 95.0, 85.0, 100.0, 145.0, 135.0, 215.0, 60.0, 155.0, 60.0, 65.0, 95.0, 40.0, 135.0, 260.0, 95.0, 95.0, 125.0, 230.0, 0.0, 175.0, 390.0, 345.0, 35.0, 0.0, 10.0, 0.0, 0.0, 155.0, 65.0, 10.0, 0.0, 90.0, 175.0, 375.0, 220.0, 140.0, 235.0, 115.0, 130.0, 165.0, 110.0, 210.0, 5.0, 0.0, 200.0, 180.0, 5.0, 0.0, 175.0, 165.0, 10.0, 0.0, 300.0, 30.0, 15.0, 20.0, 320.0, 75.0, 35.0, 130.0, 0.0, 120.0, 65.0, 5.0, 0.0, 125.0, 0.0, 145.0, 60.0, 675.0, 320.0, 215.0, 145.0, 140.0, 170.0, 160.0, 85.0, 105.0, 10.0, 55.0, 0.0, 25.0, 15.0, 130.0, 0.0, 160.0, 100.0, 70.0, 115.0, 115.0, 40.0, 875.0, 240.0, 0.0, 20.0, 0.0, 215.0, 230.0, 370.0, 995.0, 715.0, 0.0, 195.0, 10.0, 235.0, 0.0, 125.0, 30.0, 210.0, 160.0, 90.0, 125.0, 15.0, 0.0, 160.0, 55.0, 500.0, 300.0, 75.0, 140.0, 50.0, 180.0, 0.0, 0.0, 430.0, 75.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6116266017226966, "mean_inference_ms": 1.3999123972121437, "mean_action_processing_ms": 0.2401180375874857, "mean_env_wait_ms": 0.18113952168911923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003637552261352539, "StateBufferConnector_ms": 0.003234386444091797, "ViewRequirementAgentConnector_ms": 0.09578871726989746}, "num_episodes": 18, "episode_return_max": 368.0, "episode_return_min": -2475.0, "episode_return_mean": -157.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.54010156129472, "num_env_steps_trained_throughput_per_sec": 81.54010156129472, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 49464.975, "restore_workers_time_ms": 0.018, "training_step_time_ms": 49464.898, "sample_time_ms": 1158.526, "learn_time_ms": 48284.579, "learn_throughput": 82.842, "synch_weights_time_ms": 17.131}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-03-43", "timestamp": 1723503823, "time_this_iter_s": 49.103538274765015, "time_total_s": 5255.868309259415, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aad48ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5255.868309259415, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 23.974285714285713, "ram_util_percent": 82.94142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0459794477810935, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2938042427496934, "policy_loss": -0.006846959579972521, "vf_loss": 3.3000554560353517, "vf_explained_var": -0.0011075983917902387, "kl": 0.00794334442750704, "entropy": 0.5533072311253775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.31021029100847, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8312590162590068, "policy_loss": -0.011691727765550018, "vf_loss": 3.8410312730799276, "vf_explained_var": -0.17502953208312785, "kl": 0.009597282154568083, "entropy": 1.279810640673158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 368.0, "episode_reward_min": -2475.0, "episode_reward_mean": -157.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1950.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -199.1, "predator_policy": 120.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.0, 29.0, -30.0, 156.0, -481.0, -3.0, 164.0, 1.0, -455.0, 72.0, -122.0, -186.0, 48.0, -46.0, 41.0, -41.0, -268.0, -31.0, -58.0, 46.0, -252.0, -106.0, 2.0, -100.0, -932.0, 282.0, 368.0, -70.0, -64.0, 58.0, -801.0, -180.0, -385.0, 17.0, -321.0, -5.0, 38.0, 185.0, -225.0, -10.0, -404.0, 59.0, -250.0, 8.0, 26.0, 69.0, 42.0, 5.0, -851.0, -774.0, -297.0, -43.0, -20.0, 15.0, -25.0, -135.0, 37.0, -21.0, 7.0, -1524.0, -276.0, -20.0, -429.0, -2475.0, -519.0, -274.0, -237.0, -35.0, -270.0, -12.0, -15.0, -49.0, -707.0, 18.0, -58.0, 0.0, -514.0, 0.0, -5.0, -78.0, -455.0, -185.0, 82.0, -136.0, -17.0, -52.0, -9.0, 0.0, 56.0, -63.0, -120.0, -269.0, -78.0, -20.0, -194.0, -334.0, -10.0, -78.0, -176.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-125.0, -201.0, -54.0, -82.0, 0.0, -60.0, 32.0, 14.0, -570.0, -311.0, -48.0, 0.0, 194.0, -200.0, 0.0, -254.0, -890.0, -20.0, -30.0, -83.0, 2.0, -474.0, -169.0, -247.0, -22.0, -80.0, -60.0, -146.0, -9.0, -130.0, 0.0, -286.0, -420.0, -198.0, -90.0, -156.0, -134.0, -49.0, -69.0, -20.0, -407.0, -240.0, -109.0, -187.0, -91.0, -262.0, -155.0, -120.0, -700.0, -967.0, 83.0, 164.0, 181.0, 177.0, -105.0, -120.0, -119.0, -20.0, -92.0, 60.0, -659.0, -692.0, -20.0, -520.0, -415.0, -320.0, 0.0, -278.0, -203.0, -438.0, 0.0, -10.0, -210.0, -132.0, 178.0, 2.0, -292.0, -273.0, 0.0, -20.0, -395.0, -339.0, -70.0, 94.0, -5.0, -640.0, -137.0, -20.0, -55.0, -39.0, -1.0, 0.0, 0.0, -83.0, -140.0, 0.0, -1320.0, -266.0, -670.0, -639.0, -300.0, -282.0, -30.0, -343.0, -40.0, -170.0, -120.0, 70.0, 0.0, -50.0, -280.0, 0.0, -109.0, -14.0, -141.0, -50.0, -51.0, -172.0, -1181.0, -1258.0, -206.0, -310.0, 0.0, -40.0, -210.0, -664.0, -1890.0, -1950.0, 196.0, -1430.0, -280.0, -199.0, -199.0, -273.0, 0.0, -190.0, -390.0, -250.0, 0.0, -227.0, 0.0, -30.0, 56.0, -320.0, -600.0, -907.0, 0.0, -197.0, -288.0, 0.0, 0.0, 0.0, -50.0, -969.0, 0.0, 0.0, -45.0, 0.0, 0.0, -538.0, 0.0, -910.0, -200.0, -170.0, 17.0, -20.0, -93.0, -228.0, -8.0, -29.0, -50.0, -97.0, -150.0, 11.0, 0.0, 0.0, 162.0, -306.0, -225.0, -78.0, -160.0, -40.0, -15.0, -604.0, 0.0, -308.0, 0.0, -40.0, -89.0, -435.0, -172.0, -497.0, -20.0, 0.0, -203.0, 0.0, -391.0, -50.0, 0.0, 0.0], "policy_predator_policy_reward": [120.0, 175.0, 110.0, 55.0, 30.0, 0.0, 110.0, 0.0, 175.0, 225.0, 35.0, 10.0, 95.0, 75.0, 95.0, 160.0, 10.0, 445.0, 70.0, 115.0, 265.0, 85.0, 80.0, 150.0, 20.0, 130.0, 5.0, 155.0, 95.0, 85.0, 100.0, 145.0, 135.0, 215.0, 60.0, 155.0, 60.0, 65.0, 95.0, 40.0, 135.0, 260.0, 95.0, 95.0, 125.0, 230.0, 0.0, 175.0, 390.0, 345.0, 35.0, 0.0, 10.0, 0.0, 0.0, 155.0, 65.0, 10.0, 0.0, 90.0, 175.0, 375.0, 220.0, 140.0, 235.0, 115.0, 130.0, 165.0, 110.0, 210.0, 5.0, 0.0, 200.0, 180.0, 5.0, 0.0, 175.0, 165.0, 10.0, 0.0, 300.0, 30.0, 15.0, 20.0, 320.0, 75.0, 35.0, 130.0, 0.0, 120.0, 65.0, 5.0, 0.0, 125.0, 0.0, 145.0, 60.0, 675.0, 320.0, 215.0, 145.0, 140.0, 170.0, 160.0, 85.0, 105.0, 10.0, 55.0, 0.0, 25.0, 15.0, 130.0, 0.0, 160.0, 100.0, 70.0, 115.0, 115.0, 40.0, 875.0, 240.0, 0.0, 20.0, 0.0, 215.0, 230.0, 370.0, 995.0, 715.0, 0.0, 195.0, 10.0, 235.0, 0.0, 125.0, 30.0, 210.0, 160.0, 90.0, 125.0, 15.0, 0.0, 160.0, 55.0, 500.0, 300.0, 75.0, 140.0, 50.0, 180.0, 0.0, 0.0, 430.0, 75.0, 0.0, 0.0, 15.0, 25.0, 275.0, 185.0, 450.0, 5.0, 185.0, 0.0, 0.0, 85.0, 75.0, 110.0, 20.0, 0.0, 50.0, 45.0, 55.0, 75.0, 0.0, 0.0, 165.0, 35.0, 190.0, 50.0, 80.0, 0.0, 345.0, 5.0, 155.0, 75.0, 20.0, 0.0, 275.0, 55.0, 110.0, 225.0, 10.0, 0.0, 35.0, 90.0, 110.0, 155.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6111933807071409, "mean_inference_ms": 1.3985619360711512, "mean_action_processing_ms": 0.24005794601709718, "mean_env_wait_ms": 0.18089395155805532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003228306770324707, "StateBufferConnector_ms": 0.002955317497253418, "ViewRequirementAgentConnector_ms": 0.09008049964904785}, "num_episodes": 22, "episode_return_max": 368.0, "episode_return_min": -2475.0, "episode_return_mean": -157.85, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.53258440605536, "num_env_steps_trained_throughput_per_sec": 82.53258440605536, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 49319.092, "restore_workers_time_ms": 0.018, "training_step_time_ms": 49319.016, "sample_time_ms": 1135.986, "learn_time_ms": 48160.87, "learn_throughput": 83.055, "synch_weights_time_ms": 17.505}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-04-31", "timestamp": 1723503871, "time_this_iter_s": 48.513920068740845, "time_total_s": 5304.3822293281555, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aae37af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5304.3822293281555, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 22.20882352941177, "ram_util_percent": 82.75588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1161290348837616, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4330837069365083, "policy_loss": -0.005020822811792925, "vf_loss": 3.4376354360075854, "vf_explained_var": 0.0010645090272186925, "kl": 0.0062545573522954, "entropy": 0.5450102390120269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9771180606077587, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9363636854464414, "policy_loss": -0.01531319487063835, "vf_loss": 3.949924922115588, "vf_explained_var": -0.0856669685197255, "kl": 0.008759749192699243, "entropy": 1.267087407717629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 368.0, "episode_reward_min": -2475.0, "episode_reward_mean": -176.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1950.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -206.305, "predator_policy": 117.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.0, 46.0, -252.0, -106.0, 2.0, -100.0, -932.0, 282.0, 368.0, -70.0, -64.0, 58.0, -801.0, -180.0, -385.0, 17.0, -321.0, -5.0, 38.0, 185.0, -225.0, -10.0, -404.0, 59.0, -250.0, 8.0, 26.0, 69.0, 42.0, 5.0, -851.0, -774.0, -297.0, -43.0, -20.0, 15.0, -25.0, -135.0, 37.0, -21.0, 7.0, -1524.0, -276.0, -20.0, -429.0, -2475.0, -519.0, -274.0, -237.0, -35.0, -270.0, -12.0, -15.0, -49.0, -707.0, 18.0, -58.0, 0.0, -514.0, 0.0, -5.0, -78.0, -455.0, -185.0, 82.0, -136.0, -17.0, -52.0, -9.0, 0.0, 56.0, -63.0, -120.0, -269.0, -78.0, -20.0, -194.0, -334.0, -10.0, -78.0, -176.0, 0.0, 20.0, -807.0, -289.0, -30.0, 24.0, -191.0, -19.0, -246.0, -257.0, -37.0, -34.0, -27.0, 0.0, -535.0, -256.0, -320.0, -85.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-134.0, -49.0, -69.0, -20.0, -407.0, -240.0, -109.0, -187.0, -91.0, -262.0, -155.0, -120.0, -700.0, -967.0, 83.0, 164.0, 181.0, 177.0, -105.0, -120.0, -119.0, -20.0, -92.0, 60.0, -659.0, -692.0, -20.0, -520.0, -415.0, -320.0, 0.0, -278.0, -203.0, -438.0, 0.0, -10.0, -210.0, -132.0, 178.0, 2.0, -292.0, -273.0, 0.0, -20.0, -395.0, -339.0, -70.0, 94.0, -5.0, -640.0, -137.0, -20.0, -55.0, -39.0, -1.0, 0.0, 0.0, -83.0, -140.0, 0.0, -1320.0, -266.0, -670.0, -639.0, -300.0, -282.0, -30.0, -343.0, -40.0, -170.0, -120.0, 70.0, 0.0, -50.0, -280.0, 0.0, -109.0, -14.0, -141.0, -50.0, -51.0, -172.0, -1181.0, -1258.0, -206.0, -310.0, 0.0, -40.0, -210.0, -664.0, -1890.0, -1950.0, 196.0, -1430.0, -280.0, -199.0, -199.0, -273.0, 0.0, -190.0, -390.0, -250.0, 0.0, -227.0, 0.0, -30.0, 56.0, -320.0, -600.0, -907.0, 0.0, -197.0, -288.0, 0.0, 0.0, 0.0, -50.0, -969.0, 0.0, 0.0, -45.0, 0.0, 0.0, -538.0, 0.0, -910.0, -200.0, -170.0, 17.0, -20.0, -93.0, -228.0, -8.0, -29.0, -50.0, -97.0, -150.0, 11.0, 0.0, 0.0, 162.0, -306.0, -225.0, -78.0, -160.0, -40.0, -15.0, -604.0, 0.0, -308.0, 0.0, -40.0, -89.0, -435.0, -172.0, -497.0, -20.0, 0.0, -203.0, 0.0, -391.0, -50.0, 0.0, 0.0, 14.0, -24.0, -440.0, -827.0, -399.0, -110.0, -60.0, 0.0, 19.0, 0.0, -351.0, -40.0, -136.0, 2.0, -610.0, 59.0, -592.0, -30.0, -166.0, -21.0, -20.0, -129.0, 0.0, -117.0, 0.0, 0.0, -390.0, -530.0, -390.0, -271.0, -775.0, 0.0, 0.0, -280.0, 0.0, 0.0], "policy_predator_policy_reward": [60.0, 65.0, 95.0, 40.0, 135.0, 260.0, 95.0, 95.0, 125.0, 230.0, 0.0, 175.0, 390.0, 345.0, 35.0, 0.0, 10.0, 0.0, 0.0, 155.0, 65.0, 10.0, 0.0, 90.0, 175.0, 375.0, 220.0, 140.0, 235.0, 115.0, 130.0, 165.0, 110.0, 210.0, 5.0, 0.0, 200.0, 180.0, 5.0, 0.0, 175.0, 165.0, 10.0, 0.0, 300.0, 30.0, 15.0, 20.0, 320.0, 75.0, 35.0, 130.0, 0.0, 120.0, 65.0, 5.0, 0.0, 125.0, 0.0, 145.0, 60.0, 675.0, 320.0, 215.0, 145.0, 140.0, 170.0, 160.0, 85.0, 105.0, 10.0, 55.0, 0.0, 25.0, 15.0, 130.0, 0.0, 160.0, 100.0, 70.0, 115.0, 115.0, 40.0, 875.0, 240.0, 0.0, 20.0, 0.0, 215.0, 230.0, 370.0, 995.0, 715.0, 0.0, 195.0, 10.0, 235.0, 0.0, 125.0, 30.0, 210.0, 160.0, 90.0, 125.0, 15.0, 0.0, 160.0, 55.0, 500.0, 300.0, 75.0, 140.0, 50.0, 180.0, 0.0, 0.0, 430.0, 75.0, 0.0, 0.0, 15.0, 25.0, 275.0, 185.0, 450.0, 5.0, 185.0, 0.0, 0.0, 85.0, 75.0, 110.0, 20.0, 0.0, 50.0, 45.0, 55.0, 75.0, 0.0, 0.0, 165.0, 35.0, 190.0, 50.0, 80.0, 0.0, 345.0, 5.0, 155.0, 75.0, 20.0, 0.0, 275.0, 55.0, 110.0, 225.0, 10.0, 0.0, 35.0, 90.0, 110.0, 155.0, 0.0, 0.0, 30.0, 0.0, 5.0, 455.0, 105.0, 115.0, 0.0, 30.0, 5.0, 0.0, 155.0, 45.0, 45.0, 70.0, 0.0, 305.0, 300.0, 65.0, 120.0, 30.0, 110.0, 5.0, 0.0, 90.0, 0.0, 0.0, 365.0, 20.0, 195.0, 210.0, 220.0, 235.0, 70.0, 125.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6105920628448628, "mean_inference_ms": 1.396924606039928, "mean_action_processing_ms": 0.23975670186369905, "mean_env_wait_ms": 0.18079155066986816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032558441162109375, "StateBufferConnector_ms": 0.004016876220703125, "ViewRequirementAgentConnector_ms": 0.0880584716796875}, "num_episodes": 18, "episode_return_max": 368.0, "episode_return_min": -2475.0, "episode_return_mean": -176.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.22808027057037, "num_env_steps_trained_throughput_per_sec": 82.22808027057037, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 49261.988, "restore_workers_time_ms": 0.018, "training_step_time_ms": 49261.912, "sample_time_ms": 1131.195, "learn_time_ms": 48108.172, "learn_throughput": 83.146, "synch_weights_time_ms": 17.228}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-05-20", "timestamp": 1723503920, "time_this_iter_s": 48.674241065979004, "time_total_s": 5353.0564703941345, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab8fd8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5353.0564703941345, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 23.043478260869566, "ram_util_percent": 82.42028985507247}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3491297715240056, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7513672041514563, "policy_loss": -0.004732390178155607, "vf_loss": 2.755697281272323, "vf_explained_var": 0.005914930029520913, "kl": 0.005364085762717513, "entropy": 0.5435982176866481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.515107448359646, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0677877212327624, "policy_loss": -0.013217673961703896, "vf_loss": 3.0796110411169666, "vf_explained_var": -0.02390702382597343, "kl": 0.006971778139552658, "entropy": 1.2671782386366022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 82.0, "episode_reward_min": -2475.0, "episode_reward_mean": -182.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -204.14, "predator_policy": 112.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.0, -250.0, 8.0, 26.0, 69.0, 42.0, 5.0, -851.0, -774.0, -297.0, -43.0, -20.0, 15.0, -25.0, -135.0, 37.0, -21.0, 7.0, -1524.0, -276.0, -20.0, -429.0, -2475.0, -519.0, -274.0, -237.0, -35.0, -270.0, -12.0, -15.0, -49.0, -707.0, 18.0, -58.0, 0.0, -514.0, 0.0, -5.0, -78.0, -455.0, -185.0, 82.0, -136.0, -17.0, -52.0, -9.0, 0.0, 56.0, -63.0, -120.0, -269.0, -78.0, -20.0, -194.0, -334.0, -10.0, -78.0, -176.0, 0.0, 20.0, -807.0, -289.0, -30.0, 24.0, -191.0, -19.0, -246.0, -257.0, -37.0, -34.0, -27.0, 0.0, -535.0, -256.0, -320.0, -85.0, 0.0, -82.0, -155.0, -5.0, -531.0, -344.0, 0.0, -79.0, -167.0, -294.0, -57.0, -10.0, -118.0, -100.0, 0.0, -494.0, -50.0, -762.0, -25.0, 64.0, -224.0, -146.0, 40.0, 45.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-70.0, 94.0, -5.0, -640.0, -137.0, -20.0, -55.0, -39.0, -1.0, 0.0, 0.0, -83.0, -140.0, 0.0, -1320.0, -266.0, -670.0, -639.0, -300.0, -282.0, -30.0, -343.0, -40.0, -170.0, -120.0, 70.0, 0.0, -50.0, -280.0, 0.0, -109.0, -14.0, -141.0, -50.0, -51.0, -172.0, -1181.0, -1258.0, -206.0, -310.0, 0.0, -40.0, -210.0, -664.0, -1890.0, -1950.0, 196.0, -1430.0, -280.0, -199.0, -199.0, -273.0, 0.0, -190.0, -390.0, -250.0, 0.0, -227.0, 0.0, -30.0, 56.0, -320.0, -600.0, -907.0, 0.0, -197.0, -288.0, 0.0, 0.0, 0.0, -50.0, -969.0, 0.0, 0.0, -45.0, 0.0, 0.0, -538.0, 0.0, -910.0, -200.0, -170.0, 17.0, -20.0, -93.0, -228.0, -8.0, -29.0, -50.0, -97.0, -150.0, 11.0, 0.0, 0.0, 162.0, -306.0, -225.0, -78.0, -160.0, -40.0, -15.0, -604.0, 0.0, -308.0, 0.0, -40.0, -89.0, -435.0, -172.0, -497.0, -20.0, 0.0, -203.0, 0.0, -391.0, -50.0, 0.0, 0.0, 14.0, -24.0, -440.0, -827.0, -399.0, -110.0, -60.0, 0.0, 19.0, 0.0, -351.0, -40.0, -136.0, 2.0, -610.0, 59.0, -592.0, -30.0, -166.0, -21.0, -20.0, -129.0, 0.0, -117.0, 0.0, 0.0, -390.0, -530.0, -390.0, -271.0, -775.0, 0.0, 0.0, -280.0, 0.0, 0.0, 0.0, -177.0, -90.0, -180.0, 0.0, -10.0, -120.0, -866.0, -349.0, -195.0, 0.0, 0.0, -194.0, 0.0, -352.0, -30.0, -190.0, -429.0, 8.0, -130.0, 0.0, -30.0, -88.0, -275.0, -10.0, -190.0, 0.0, 0.0, -790.0, -239.0, -10.0, -80.0, -2000.0, -17.0, 0.0, -195.0, -60.0, 79.0, -119.0, -330.0, -89.0, -147.0, 0.0, 15.0, 75.0, -100.0], "policy_predator_policy_reward": [15.0, 20.0, 320.0, 75.0, 35.0, 130.0, 0.0, 120.0, 65.0, 5.0, 0.0, 125.0, 0.0, 145.0, 60.0, 675.0, 320.0, 215.0, 145.0, 140.0, 170.0, 160.0, 85.0, 105.0, 10.0, 55.0, 0.0, 25.0, 15.0, 130.0, 0.0, 160.0, 100.0, 70.0, 115.0, 115.0, 40.0, 875.0, 240.0, 0.0, 20.0, 0.0, 215.0, 230.0, 370.0, 995.0, 715.0, 0.0, 195.0, 10.0, 235.0, 0.0, 125.0, 30.0, 210.0, 160.0, 90.0, 125.0, 15.0, 0.0, 160.0, 55.0, 500.0, 300.0, 75.0, 140.0, 50.0, 180.0, 0.0, 0.0, 430.0, 75.0, 0.0, 0.0, 15.0, 25.0, 275.0, 185.0, 450.0, 5.0, 185.0, 0.0, 0.0, 85.0, 75.0, 110.0, 20.0, 0.0, 50.0, 45.0, 55.0, 75.0, 0.0, 0.0, 165.0, 35.0, 190.0, 50.0, 80.0, 0.0, 345.0, 5.0, 155.0, 75.0, 20.0, 0.0, 275.0, 55.0, 110.0, 225.0, 10.0, 0.0, 35.0, 90.0, 110.0, 155.0, 0.0, 0.0, 30.0, 0.0, 5.0, 455.0, 105.0, 115.0, 0.0, 30.0, 5.0, 0.0, 155.0, 45.0, 45.0, 70.0, 0.0, 305.0, 300.0, 65.0, 120.0, 30.0, 110.0, 5.0, 0.0, 90.0, 0.0, 0.0, 365.0, 20.0, 195.0, 210.0, 220.0, 235.0, 70.0, 125.0, 0.0, 0.0, 85.0, 10.0, 5.0, 110.0, 5.0, 0.0, 345.0, 110.0, 25.0, 175.0, 0.0, 0.0, 0.0, 115.0, 195.0, 20.0, 230.0, 95.0, 65.0, 0.0, 15.0, 5.0, 130.0, 115.0, 95.0, 5.0, 0.0, 0.0, 140.0, 395.0, 25.0, 15.0, 255.0, 1000.0, 50.0, 120.0, 10.0, 35.0, 225.0, 0.0, 85.0, 5.0, 0.0, 25.0, 20.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6104461290286738, "mean_inference_ms": 1.3953341923449014, "mean_action_processing_ms": 0.23942366949097868, "mean_env_wait_ms": 0.18062789180026617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038121938705444336, "StateBufferConnector_ms": 0.0041152238845825195, "ViewRequirementAgentConnector_ms": 0.08916306495666504}, "num_episodes": 23, "episode_return_max": 82.0, "episode_return_min": -2475.0, "episode_return_mean": -182.68, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.85273359798515, "num_env_steps_trained_throughput_per_sec": 79.85273359798515, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 49362.95, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49362.875, "sample_time_ms": 1133.761, "learn_time_ms": 48208.636, "learn_throughput": 82.973, "synch_weights_time_ms": 15.836}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-06-10", "timestamp": 1723503970, "time_this_iter_s": 50.13154602050781, "time_total_s": 5403.188016414642, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a88385e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5403.188016414642, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 24.929577464788736, "ram_util_percent": 82.95211267605633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8731272571301334, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.200590020260483, "policy_loss": -0.004372055562479156, "vf_loss": 4.20451568926453, "vf_explained_var": 0.003223602954672758, "kl": 0.005951612991548544, "entropy": 0.49132533045042126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6089783395408954, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.195837175152289, "policy_loss": -0.013356933540975054, "vf_loss": 4.207537029029201, "vf_explained_var": -0.04452679642924556, "kl": 0.008285415707856127, "entropy": 1.252088004192978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 82.0, "episode_reward_min": -2475.0, "episode_reward_mean": -205.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -217.43, "predator_policy": 114.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1524.0, -276.0, -20.0, -429.0, -2475.0, -519.0, -274.0, -237.0, -35.0, -270.0, -12.0, -15.0, -49.0, -707.0, 18.0, -58.0, 0.0, -514.0, 0.0, -5.0, -78.0, -455.0, -185.0, 82.0, -136.0, -17.0, -52.0, -9.0, 0.0, 56.0, -63.0, -120.0, -269.0, -78.0, -20.0, -194.0, -334.0, -10.0, -78.0, -176.0, 0.0, 20.0, -807.0, -289.0, -30.0, 24.0, -191.0, -19.0, -246.0, -257.0, -37.0, -34.0, -27.0, 0.0, -535.0, -256.0, -320.0, -85.0, 0.0, -82.0, -155.0, -5.0, -531.0, -344.0, 0.0, -79.0, -167.0, -294.0, -57.0, -10.0, -118.0, -100.0, 0.0, -494.0, -50.0, -762.0, -25.0, 64.0, -224.0, -146.0, 40.0, 45.0, -68.0, -70.0, -121.0, -174.0, -555.0, 4.0, -287.0, -180.0, -140.0, -240.0, -160.0, -40.0, -919.0, -223.0, -5.0, -1025.0, -153.0, -70.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1181.0, -1258.0, -206.0, -310.0, 0.0, -40.0, -210.0, -664.0, -1890.0, -1950.0, 196.0, -1430.0, -280.0, -199.0, -199.0, -273.0, 0.0, -190.0, -390.0, -250.0, 0.0, -227.0, 0.0, -30.0, 56.0, -320.0, -600.0, -907.0, 0.0, -197.0, -288.0, 0.0, 0.0, 0.0, -50.0, -969.0, 0.0, 0.0, -45.0, 0.0, 0.0, -538.0, 0.0, -910.0, -200.0, -170.0, 17.0, -20.0, -93.0, -228.0, -8.0, -29.0, -50.0, -97.0, -150.0, 11.0, 0.0, 0.0, 162.0, -306.0, -225.0, -78.0, -160.0, -40.0, -15.0, -604.0, 0.0, -308.0, 0.0, -40.0, -89.0, -435.0, -172.0, -497.0, -20.0, 0.0, -203.0, 0.0, -391.0, -50.0, 0.0, 0.0, 14.0, -24.0, -440.0, -827.0, -399.0, -110.0, -60.0, 0.0, 19.0, 0.0, -351.0, -40.0, -136.0, 2.0, -610.0, 59.0, -592.0, -30.0, -166.0, -21.0, -20.0, -129.0, 0.0, -117.0, 0.0, 0.0, -390.0, -530.0, -390.0, -271.0, -775.0, 0.0, 0.0, -280.0, 0.0, 0.0, 0.0, -177.0, -90.0, -180.0, 0.0, -10.0, -120.0, -866.0, -349.0, -195.0, 0.0, 0.0, -194.0, 0.0, -352.0, -30.0, -190.0, -429.0, 8.0, -130.0, 0.0, -30.0, -88.0, -275.0, -10.0, -190.0, 0.0, 0.0, -790.0, -239.0, -10.0, -80.0, -2000.0, -17.0, 0.0, -195.0, -60.0, 79.0, -119.0, -330.0, -89.0, -147.0, 0.0, 15.0, 75.0, -100.0, -200.0, 32.0, -180.0, -40.0, -6.0, -250.0, 0.0, -389.0, -560.0, -340.0, 0.0, -26.0, 0.0, -592.0, -150.0, -130.0, -210.0, -70.0, -150.0, -350.0, -240.0, -80.0, -70.0, -10.0, -866.0, -698.0, 0.0, -603.0, 0.0, -10.0, -2000.0, -50.0, -30.0, -303.0, 0.0, -160.0], "policy_predator_policy_reward": [40.0, 875.0, 240.0, 0.0, 20.0, 0.0, 215.0, 230.0, 370.0, 995.0, 715.0, 0.0, 195.0, 10.0, 235.0, 0.0, 125.0, 30.0, 210.0, 160.0, 90.0, 125.0, 15.0, 0.0, 160.0, 55.0, 500.0, 300.0, 75.0, 140.0, 50.0, 180.0, 0.0, 0.0, 430.0, 75.0, 0.0, 0.0, 15.0, 25.0, 275.0, 185.0, 450.0, 5.0, 185.0, 0.0, 0.0, 85.0, 75.0, 110.0, 20.0, 0.0, 50.0, 45.0, 55.0, 75.0, 0.0, 0.0, 165.0, 35.0, 190.0, 50.0, 80.0, 0.0, 345.0, 5.0, 155.0, 75.0, 20.0, 0.0, 275.0, 55.0, 110.0, 225.0, 10.0, 0.0, 35.0, 90.0, 110.0, 155.0, 0.0, 0.0, 30.0, 0.0, 5.0, 455.0, 105.0, 115.0, 0.0, 30.0, 5.0, 0.0, 155.0, 45.0, 45.0, 70.0, 0.0, 305.0, 300.0, 65.0, 120.0, 30.0, 110.0, 5.0, 0.0, 90.0, 0.0, 0.0, 365.0, 20.0, 195.0, 210.0, 220.0, 235.0, 70.0, 125.0, 0.0, 0.0, 85.0, 10.0, 5.0, 110.0, 5.0, 0.0, 345.0, 110.0, 25.0, 175.0, 0.0, 0.0, 0.0, 115.0, 195.0, 20.0, 230.0, 95.0, 65.0, 0.0, 15.0, 5.0, 130.0, 115.0, 95.0, 5.0, 0.0, 0.0, 140.0, 395.0, 25.0, 15.0, 255.0, 1000.0, 50.0, 120.0, 10.0, 35.0, 225.0, 0.0, 85.0, 5.0, 0.0, 25.0, 20.0, 50.0, 90.0, 10.0, 110.0, 40.0, 130.0, 5.0, 70.0, 145.0, 345.0, 0.0, 30.0, 0.0, 295.0, 10.0, 90.0, 10.0, 20.0, 120.0, 20.0, 240.0, 0.0, 160.0, 5.0, 35.0, 400.0, 245.0, 125.0, 255.0, 0.0, 5.0, 1000.0, 25.0, 15.0, 165.0, 80.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6095432108081983, "mean_inference_ms": 1.3941595983590105, "mean_action_processing_ms": 0.23944979938924527, "mean_env_wait_ms": 0.18052805894738783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004313945770263672, "StateBufferConnector_ms": 0.004149436950683594, "ViewRequirementAgentConnector_ms": 0.09017884731292725}, "num_episodes": 18, "episode_return_max": 82.0, "episode_return_min": -2475.0, "episode_return_mean": -205.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.95626284506949, "num_env_steps_trained_throughput_per_sec": 81.95626284506949, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 49235.299, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49235.202, "sample_time_ms": 1095.325, "learn_time_ms": 48118.403, "learn_throughput": 83.128, "synch_weights_time_ms": 16.769}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-06-59", "timestamp": 1723504019, "time_this_iter_s": 48.84514617919922, "time_total_s": 5452.033162593842, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aad481f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5452.033162593842, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 23.914492753623186, "ram_util_percent": 83.19130434782609}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9369760273625611, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4828299087506753, "policy_loss": -0.00599821186254895, "vf_loss": 1.4883686481960237, "vf_explained_var": 0.0076426302945172345, "kl": 0.00612629585439247, "entropy": 0.4849983936106717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7712041387482294, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9143395325178822, "policy_loss": -0.020526504195566293, "vf_loss": 1.9328192056171478, "vf_explained_var": -0.03735173723054311, "kl": 0.01023416029358472, "entropy": 1.248830087285824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 82.0, "episode_reward_min": -1025.0, "episode_reward_mean": -175.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 162.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -192.04, "predator_policy": 104.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -5.0, -78.0, -455.0, -185.0, 82.0, -136.0, -17.0, -52.0, -9.0, 0.0, 56.0, -63.0, -120.0, -269.0, -78.0, -20.0, -194.0, -334.0, -10.0, -78.0, -176.0, 0.0, 20.0, -807.0, -289.0, -30.0, 24.0, -191.0, -19.0, -246.0, -257.0, -37.0, -34.0, -27.0, 0.0, -535.0, -256.0, -320.0, -85.0, 0.0, -82.0, -155.0, -5.0, -531.0, -344.0, 0.0, -79.0, -167.0, -294.0, -57.0, -10.0, -118.0, -100.0, 0.0, -494.0, -50.0, -762.0, -25.0, 64.0, -224.0, -146.0, 40.0, 45.0, -68.0, -70.0, -121.0, -174.0, -555.0, 4.0, -287.0, -180.0, -140.0, -240.0, -160.0, -40.0, -919.0, -223.0, -5.0, -1025.0, -153.0, -70.0, -288.0, -36.0, -540.0, -63.0, -179.0, -55.0, -315.0, -145.0, -150.0, 48.0, -164.0, -12.0, -320.0, 0.0, -592.0, -487.0, -140.0, -930.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -45.0, 0.0, 0.0, -538.0, 0.0, -910.0, -200.0, -170.0, 17.0, -20.0, -93.0, -228.0, -8.0, -29.0, -50.0, -97.0, -150.0, 11.0, 0.0, 0.0, 162.0, -306.0, -225.0, -78.0, -160.0, -40.0, -15.0, -604.0, 0.0, -308.0, 0.0, -40.0, -89.0, -435.0, -172.0, -497.0, -20.0, 0.0, -203.0, 0.0, -391.0, -50.0, 0.0, 0.0, 14.0, -24.0, -440.0, -827.0, -399.0, -110.0, -60.0, 0.0, 19.0, 0.0, -351.0, -40.0, -136.0, 2.0, -610.0, 59.0, -592.0, -30.0, -166.0, -21.0, -20.0, -129.0, 0.0, -117.0, 0.0, 0.0, -390.0, -530.0, -390.0, -271.0, -775.0, 0.0, 0.0, -280.0, 0.0, 0.0, 0.0, -177.0, -90.0, -180.0, 0.0, -10.0, -120.0, -866.0, -349.0, -195.0, 0.0, 0.0, -194.0, 0.0, -352.0, -30.0, -190.0, -429.0, 8.0, -130.0, 0.0, -30.0, -88.0, -275.0, -10.0, -190.0, 0.0, 0.0, -790.0, -239.0, -10.0, -80.0, -2000.0, -17.0, 0.0, -195.0, -60.0, 79.0, -119.0, -330.0, -89.0, -147.0, 0.0, 15.0, 75.0, -100.0, -200.0, 32.0, -180.0, -40.0, -6.0, -250.0, 0.0, -389.0, -560.0, -340.0, 0.0, -26.0, 0.0, -592.0, -150.0, -130.0, -210.0, -70.0, -150.0, -350.0, -240.0, -80.0, -70.0, -10.0, -866.0, -698.0, 0.0, -603.0, 0.0, -10.0, -2000.0, -50.0, -30.0, -303.0, 0.0, -160.0, -63.0, -475.0, 68.0, -244.0, -610.0, -410.0, -128.0, 0.0, -434.0, -20.0, -110.0, 0.0, -675.0, 0.0, -160.0, -130.0, -10.0, -1160.0, 0.0, 48.0, -190.0, -179.0, 32.0, -179.0, -640.0, 0.0, 0.0, 0.0, -487.0, -435.0, -528.0, -279.0, -100.0, -90.0, -680.0, -910.0], "policy_predator_policy_reward": [0.0, 0.0, 15.0, 25.0, 275.0, 185.0, 450.0, 5.0, 185.0, 0.0, 0.0, 85.0, 75.0, 110.0, 20.0, 0.0, 50.0, 45.0, 55.0, 75.0, 0.0, 0.0, 165.0, 35.0, 190.0, 50.0, 80.0, 0.0, 345.0, 5.0, 155.0, 75.0, 20.0, 0.0, 275.0, 55.0, 110.0, 225.0, 10.0, 0.0, 35.0, 90.0, 110.0, 155.0, 0.0, 0.0, 30.0, 0.0, 5.0, 455.0, 105.0, 115.0, 0.0, 30.0, 5.0, 0.0, 155.0, 45.0, 45.0, 70.0, 0.0, 305.0, 300.0, 65.0, 120.0, 30.0, 110.0, 5.0, 0.0, 90.0, 0.0, 0.0, 365.0, 20.0, 195.0, 210.0, 220.0, 235.0, 70.0, 125.0, 0.0, 0.0, 85.0, 10.0, 5.0, 110.0, 5.0, 0.0, 345.0, 110.0, 25.0, 175.0, 0.0, 0.0, 0.0, 115.0, 195.0, 20.0, 230.0, 95.0, 65.0, 0.0, 15.0, 5.0, 130.0, 115.0, 95.0, 5.0, 0.0, 0.0, 140.0, 395.0, 25.0, 15.0, 255.0, 1000.0, 50.0, 120.0, 10.0, 35.0, 225.0, 0.0, 85.0, 5.0, 0.0, 25.0, 20.0, 50.0, 90.0, 10.0, 110.0, 40.0, 130.0, 5.0, 70.0, 145.0, 345.0, 0.0, 30.0, 0.0, 295.0, 10.0, 90.0, 10.0, 20.0, 120.0, 20.0, 240.0, 0.0, 160.0, 5.0, 35.0, 400.0, 245.0, 125.0, 255.0, 0.0, 5.0, 1000.0, 25.0, 15.0, 165.0, 80.0, 10.0, 120.0, 130.0, 140.0, 0.0, 175.0, 305.0, 65.0, 0.0, 10.0, 265.0, 0.0, 55.0, 325.0, 35.0, 85.0, 60.0, 570.0, 450.0, 0.0, 0.0, 95.0, 110.0, 90.0, 45.0, 0.0, 320.0, 0.0, 0.0, 0.0, 330.0, 235.0, 85.0, 50.0, 0.0, 490.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6090579459347093, "mean_inference_ms": 1.3929816680853175, "mean_action_processing_ms": 0.23932117451589885, "mean_env_wait_ms": 0.18041290036930438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004938364028930664, "StateBufferConnector_ms": 0.004645824432373047, "ViewRequirementAgentConnector_ms": 0.09225058555603027}, "num_episodes": 18, "episode_return_max": 82.0, "episode_return_min": -1025.0, "episode_return_mean": -175.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.06139001195292, "num_env_steps_trained_throughput_per_sec": 82.06139001195292, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 49086.395, "restore_workers_time_ms": 0.017, "training_step_time_ms": 49086.296, "sample_time_ms": 1096.457, "learn_time_ms": 47968.743, "learn_throughput": 83.388, "synch_weights_time_ms": 16.394}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-07-48", "timestamp": 1723504068, "time_this_iter_s": 48.7908239364624, "time_total_s": 5500.823986530304, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab8b7dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5500.823986530304, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 23.42608695652174, "ram_util_percent": 82.91739130434783}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2878506057161503, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7048233245415663, "policy_loss": -0.002693559793341491, "vf_loss": 1.7071718119754993, "vf_explained_var": 0.003834013995670137, "kl": 0.004600949999274225, "entropy": 0.46126832444831806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1279407349370776, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.649769987615328, "policy_loss": -0.013030257850895247, "vf_loss": 1.661187971899749, "vf_explained_var": -0.007243856425007815, "kl": 0.008061348292841356, "entropy": 1.2692381440016327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 64.0, "episode_reward_min": -1025.0, "episode_reward_mean": -190.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 79.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -200.465, "predator_policy": 105.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 20.0, -807.0, -289.0, -30.0, 24.0, -191.0, -19.0, -246.0, -257.0, -37.0, -34.0, -27.0, 0.0, -535.0, -256.0, -320.0, -85.0, 0.0, -82.0, -155.0, -5.0, -531.0, -344.0, 0.0, -79.0, -167.0, -294.0, -57.0, -10.0, -118.0, -100.0, 0.0, -494.0, -50.0, -762.0, -25.0, 64.0, -224.0, -146.0, 40.0, 45.0, -68.0, -70.0, -121.0, -174.0, -555.0, 4.0, -287.0, -180.0, -140.0, -240.0, -160.0, -40.0, -919.0, -223.0, -5.0, -1025.0, -153.0, -70.0, -288.0, -36.0, -540.0, -63.0, -179.0, -55.0, -315.0, -145.0, -150.0, 48.0, -164.0, -12.0, -320.0, 0.0, -592.0, -487.0, -140.0, -930.0, -466.0, -86.0, -175.0, -194.0, -79.0, -170.0, -84.0, -30.0, -98.0, -55.0, -67.0, -5.0, -63.0, -1000.0, -17.0, -120.0, -348.0, -15.0, -151.0, -388.0, 0.0, -65.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 14.0, -24.0, -440.0, -827.0, -399.0, -110.0, -60.0, 0.0, 19.0, 0.0, -351.0, -40.0, -136.0, 2.0, -610.0, 59.0, -592.0, -30.0, -166.0, -21.0, -20.0, -129.0, 0.0, -117.0, 0.0, 0.0, -390.0, -530.0, -390.0, -271.0, -775.0, 0.0, 0.0, -280.0, 0.0, 0.0, 0.0, -177.0, -90.0, -180.0, 0.0, -10.0, -120.0, -866.0, -349.0, -195.0, 0.0, 0.0, -194.0, 0.0, -352.0, -30.0, -190.0, -429.0, 8.0, -130.0, 0.0, -30.0, -88.0, -275.0, -10.0, -190.0, 0.0, 0.0, -790.0, -239.0, -10.0, -80.0, -2000.0, -17.0, 0.0, -195.0, -60.0, 79.0, -119.0, -330.0, -89.0, -147.0, 0.0, 15.0, 75.0, -100.0, -200.0, 32.0, -180.0, -40.0, -6.0, -250.0, 0.0, -389.0, -560.0, -340.0, 0.0, -26.0, 0.0, -592.0, -150.0, -130.0, -210.0, -70.0, -150.0, -350.0, -240.0, -80.0, -70.0, -10.0, -866.0, -698.0, 0.0, -603.0, 0.0, -10.0, -2000.0, -50.0, -30.0, -303.0, 0.0, -160.0, -63.0, -475.0, 68.0, -244.0, -610.0, -410.0, -128.0, 0.0, -434.0, -20.0, -110.0, 0.0, -675.0, 0.0, -160.0, -130.0, -10.0, -1160.0, 0.0, 48.0, -190.0, -179.0, 32.0, -179.0, -640.0, 0.0, 0.0, 0.0, -487.0, -435.0, -528.0, -279.0, -100.0, -90.0, -680.0, -910.0, -296.0, -370.0, 0.0, -176.0, -480.0, 0.0, -170.0, -149.0, -230.0, 1.0, -40.0, -270.0, 16.0, -200.0, -60.0, 0.0, -91.0, -122.0, 0.0, -110.0, -93.0, -54.0, -10.0, 0.0, -40.0, -178.0, -2000.0, 0.0, -37.0, 0.0, -890.0, 0.0, -340.0, -178.0, -10.0, -20.0, -231.0, -90.0, -350.0, -268.0, 0.0, 0.0, -10.0, -120.0], "policy_predator_policy_reward": [0.0, 0.0, 30.0, 0.0, 5.0, 455.0, 105.0, 115.0, 0.0, 30.0, 5.0, 0.0, 155.0, 45.0, 45.0, 70.0, 0.0, 305.0, 300.0, 65.0, 120.0, 30.0, 110.0, 5.0, 0.0, 90.0, 0.0, 0.0, 365.0, 20.0, 195.0, 210.0, 220.0, 235.0, 70.0, 125.0, 0.0, 0.0, 85.0, 10.0, 5.0, 110.0, 5.0, 0.0, 345.0, 110.0, 25.0, 175.0, 0.0, 0.0, 0.0, 115.0, 195.0, 20.0, 230.0, 95.0, 65.0, 0.0, 15.0, 5.0, 130.0, 115.0, 95.0, 5.0, 0.0, 0.0, 140.0, 395.0, 25.0, 15.0, 255.0, 1000.0, 50.0, 120.0, 10.0, 35.0, 225.0, 0.0, 85.0, 5.0, 0.0, 25.0, 20.0, 50.0, 90.0, 10.0, 110.0, 40.0, 130.0, 5.0, 70.0, 145.0, 345.0, 0.0, 30.0, 0.0, 295.0, 10.0, 90.0, 10.0, 20.0, 120.0, 20.0, 240.0, 0.0, 160.0, 5.0, 35.0, 400.0, 245.0, 125.0, 255.0, 0.0, 5.0, 1000.0, 25.0, 15.0, 165.0, 80.0, 10.0, 120.0, 130.0, 140.0, 0.0, 175.0, 305.0, 65.0, 0.0, 10.0, 265.0, 0.0, 55.0, 325.0, 35.0, 85.0, 60.0, 570.0, 450.0, 0.0, 0.0, 95.0, 110.0, 90.0, 45.0, 0.0, 320.0, 0.0, 0.0, 0.0, 330.0, 235.0, 85.0, 50.0, 0.0, 490.0, 170.0, 200.0, 0.0, 0.0, 90.0, 65.0, 240.0, 40.0, 85.0, 50.0, 100.0, 75.0, 65.0, 0.0, 100.0, 0.0, 30.0, 50.0, 65.0, 55.0, 0.0, 75.0, 5.0, 0.0, 5.0, 45.0, 110.0, 0.0, 1000.0, 20.0, 0.0, 325.0, 445.0, 170.0, 0.0, 15.0, 0.0, 170.0, 0.0, 120.0, 110.0, 0.0, 0.0, 5.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6084440413077313, "mean_inference_ms": 1.3914907344233223, "mean_action_processing_ms": 0.23917001539710128, "mean_env_wait_ms": 0.18030735652906152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056809186935424805, "StateBufferConnector_ms": 0.004660129547119141, "ViewRequirementAgentConnector_ms": 0.09303498268127441}, "num_episodes": 22, "episode_return_max": 64.0, "episode_return_min": -1025.0, "episode_return_mean": -190.53, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.15420688173577, "num_env_steps_trained_throughput_per_sec": 82.15420688173577, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 49042.636, "restore_workers_time_ms": 0.017, "training_step_time_ms": 49042.535, "sample_time_ms": 1064.316, "learn_time_ms": 47957.34, "learn_throughput": 83.407, "synch_weights_time_ms": 16.351}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-08-37", "timestamp": 1723504117, "time_this_iter_s": 48.72652506828308, "time_total_s": 5549.550511598587, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab8fd790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5549.550511598587, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 22.428985507246377, "ram_util_percent": 83.16811594202898}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0261540155562145, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0449022496818867, "policy_loss": -0.0050263826195741925, "vf_loss": 2.049682159493209, "vf_explained_var": 0.007549808391187557, "kl": 0.006572626683234815, "entropy": 0.45196706067632747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7241277395102084, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6957755324071044, "policy_loss": -0.012659095529782236, "vf_loss": 2.706723707189005, "vf_explained_var": -0.010100148342273853, "kl": 0.008554615700171526, "entropy": 1.189184975939453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 64.0, "episode_reward_min": -1025.0, "episode_reward_mean": -184.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 79.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -192.345, "predator_policy": 99.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -82.0, -155.0, -5.0, -531.0, -344.0, 0.0, -79.0, -167.0, -294.0, -57.0, -10.0, -118.0, -100.0, 0.0, -494.0, -50.0, -762.0, -25.0, 64.0, -224.0, -146.0, 40.0, 45.0, -68.0, -70.0, -121.0, -174.0, -555.0, 4.0, -287.0, -180.0, -140.0, -240.0, -160.0, -40.0, -919.0, -223.0, -5.0, -1025.0, -153.0, -70.0, -288.0, -36.0, -540.0, -63.0, -179.0, -55.0, -315.0, -145.0, -150.0, 48.0, -164.0, -12.0, -320.0, 0.0, -592.0, -487.0, -140.0, -930.0, -466.0, -86.0, -175.0, -194.0, -79.0, -170.0, -84.0, -30.0, -98.0, -55.0, -67.0, -5.0, -63.0, -1000.0, -17.0, -120.0, -348.0, -15.0, -151.0, -388.0, 0.0, -65.0, 0.0, 32.0, -198.0, -120.0, -210.0, -53.0, -72.0, -372.0, -579.0, 41.0, 0.0, -5.0, -45.0, -612.0, 0.0, 48.0, -45.0, -345.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -177.0, -90.0, -180.0, 0.0, -10.0, -120.0, -866.0, -349.0, -195.0, 0.0, 0.0, -194.0, 0.0, -352.0, -30.0, -190.0, -429.0, 8.0, -130.0, 0.0, -30.0, -88.0, -275.0, -10.0, -190.0, 0.0, 0.0, -790.0, -239.0, -10.0, -80.0, -2000.0, -17.0, 0.0, -195.0, -60.0, 79.0, -119.0, -330.0, -89.0, -147.0, 0.0, 15.0, 75.0, -100.0, -200.0, 32.0, -180.0, -40.0, -6.0, -250.0, 0.0, -389.0, -560.0, -340.0, 0.0, -26.0, 0.0, -592.0, -150.0, -130.0, -210.0, -70.0, -150.0, -350.0, -240.0, -80.0, -70.0, -10.0, -866.0, -698.0, 0.0, -603.0, 0.0, -10.0, -2000.0, -50.0, -30.0, -303.0, 0.0, -160.0, -63.0, -475.0, 68.0, -244.0, -610.0, -410.0, -128.0, 0.0, -434.0, -20.0, -110.0, 0.0, -675.0, 0.0, -160.0, -130.0, -10.0, -1160.0, 0.0, 48.0, -190.0, -179.0, 32.0, -179.0, -640.0, 0.0, 0.0, 0.0, -487.0, -435.0, -528.0, -279.0, -100.0, -90.0, -680.0, -910.0, -296.0, -370.0, 0.0, -176.0, -480.0, 0.0, -170.0, -149.0, -230.0, 1.0, -40.0, -270.0, 16.0, -200.0, -60.0, 0.0, -91.0, -122.0, 0.0, -110.0, -93.0, -54.0, -10.0, 0.0, -40.0, -178.0, -2000.0, 0.0, -37.0, 0.0, -890.0, 0.0, -340.0, -178.0, -10.0, -20.0, -231.0, -90.0, -350.0, -268.0, 0.0, 0.0, -10.0, -120.0, 0.0, 0.0, -15.0, 17.0, -220.0, -88.0, -240.0, 0.0, 0.0, -420.0, -45.0, -123.0, 28.0, -220.0, -780.0, 18.0, -290.0, -909.0, 13.0, 28.0, 0.0, 0.0, -20.0, 0.0, -60.0, -30.0, -607.0, -410.0, 0.0, 0.0, 53.0, -10.0, 0.0, -90.0, -330.0, -240.0], "policy_predator_policy_reward": [0.0, 0.0, 85.0, 10.0, 5.0, 110.0, 5.0, 0.0, 345.0, 110.0, 25.0, 175.0, 0.0, 0.0, 0.0, 115.0, 195.0, 20.0, 230.0, 95.0, 65.0, 0.0, 15.0, 5.0, 130.0, 115.0, 95.0, 5.0, 0.0, 0.0, 140.0, 395.0, 25.0, 15.0, 255.0, 1000.0, 50.0, 120.0, 10.0, 35.0, 225.0, 0.0, 85.0, 5.0, 0.0, 25.0, 20.0, 50.0, 90.0, 10.0, 110.0, 40.0, 130.0, 5.0, 70.0, 145.0, 345.0, 0.0, 30.0, 0.0, 295.0, 10.0, 90.0, 10.0, 20.0, 120.0, 20.0, 240.0, 0.0, 160.0, 5.0, 35.0, 400.0, 245.0, 125.0, 255.0, 0.0, 5.0, 1000.0, 25.0, 15.0, 165.0, 80.0, 10.0, 120.0, 130.0, 140.0, 0.0, 175.0, 305.0, 65.0, 0.0, 10.0, 265.0, 0.0, 55.0, 325.0, 35.0, 85.0, 60.0, 570.0, 450.0, 0.0, 0.0, 95.0, 110.0, 90.0, 45.0, 0.0, 320.0, 0.0, 0.0, 0.0, 330.0, 235.0, 85.0, 50.0, 0.0, 490.0, 170.0, 200.0, 0.0, 0.0, 90.0, 65.0, 240.0, 40.0, 85.0, 50.0, 100.0, 75.0, 65.0, 0.0, 100.0, 0.0, 30.0, 50.0, 65.0, 55.0, 0.0, 75.0, 5.0, 0.0, 5.0, 45.0, 110.0, 0.0, 1000.0, 20.0, 0.0, 325.0, 445.0, 170.0, 0.0, 15.0, 0.0, 170.0, 0.0, 120.0, 110.0, 0.0, 0.0, 5.0, 60.0, 0.0, 0.0, 0.0, 30.0, 0.0, 110.0, 120.0, 0.0, 210.0, 0.0, 70.0, 45.0, 10.0, 110.0, 5.0, 385.0, 215.0, 405.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 45.0, 5.0, 400.0, 0.0, 0.0, 0.0, 5.0, 45.0, 0.0, 220.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6079467895865708, "mean_inference_ms": 1.390415142505295, "mean_action_processing_ms": 0.2390788017701389, "mean_env_wait_ms": 0.18022853853232465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005980491638183594, "StateBufferConnector_ms": 0.003509998321533203, "ViewRequirementAgentConnector_ms": 0.09452593326568604}, "num_episodes": 18, "episode_return_max": 64.0, "episode_return_min": -1025.0, "episode_return_mean": -184.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.02564085489828, "num_env_steps_trained_throughput_per_sec": 82.02564085489828, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 49001.676, "restore_workers_time_ms": 0.017, "training_step_time_ms": 49001.574, "sample_time_ms": 1066.294, "learn_time_ms": 47913.711, "learn_throughput": 83.483, "synch_weights_time_ms": 16.689}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-09-25", "timestamp": 1723504165, "time_this_iter_s": 48.81083011627197, "time_total_s": 5598.361341714859, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab8addc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5598.361341714859, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 23.22173913043478, "ram_util_percent": 83.09275362318843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.420540682727067, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.106231522497046, "policy_loss": -0.0028201430282067683, "vf_loss": 3.108761695200804, "vf_explained_var": 0.0025481632146885785, "kl": 0.007732428929654741, "entropy": 0.41729981410440314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.276288411194685, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.14998563427143, "policy_loss": -0.014447071522390519, "vf_loss": 3.1622208233863587, "vf_explained_var": -0.013815881083251307, "kl": 0.011059402911752536, "entropy": 1.1900282745638853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 48.0, "episode_reward_min": -1415.0, "episode_reward_mean": -199.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 75.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -201.665, "predator_policy": 102.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, -68.0, -70.0, -121.0, -174.0, -555.0, 4.0, -287.0, -180.0, -140.0, -240.0, -160.0, -40.0, -919.0, -223.0, -5.0, -1025.0, -153.0, -70.0, -288.0, -36.0, -540.0, -63.0, -179.0, -55.0, -315.0, -145.0, -150.0, 48.0, -164.0, -12.0, -320.0, 0.0, -592.0, -487.0, -140.0, -930.0, -466.0, -86.0, -175.0, -194.0, -79.0, -170.0, -84.0, -30.0, -98.0, -55.0, -67.0, -5.0, -63.0, -1000.0, -17.0, -120.0, -348.0, -15.0, -151.0, -388.0, 0.0, -65.0, 0.0, 32.0, -198.0, -120.0, -210.0, -53.0, -72.0, -372.0, -579.0, 41.0, 0.0, -5.0, -45.0, -612.0, 0.0, 48.0, -45.0, -345.0, -90.0, -54.0, -317.0, -144.0, -15.0, -811.0, -30.0, -113.0, -65.0, -243.0, -63.0, 1.0, -1415.0, -23.0, -60.0, -194.0, -10.0, -240.0, -165.0, -40.0, -254.0, -68.0, -545.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [75.0, -100.0, -200.0, 32.0, -180.0, -40.0, -6.0, -250.0, 0.0, -389.0, -560.0, -340.0, 0.0, -26.0, 0.0, -592.0, -150.0, -130.0, -210.0, -70.0, -150.0, -350.0, -240.0, -80.0, -70.0, -10.0, -866.0, -698.0, 0.0, -603.0, 0.0, -10.0, -2000.0, -50.0, -30.0, -303.0, 0.0, -160.0, -63.0, -475.0, 68.0, -244.0, -610.0, -410.0, -128.0, 0.0, -434.0, -20.0, -110.0, 0.0, -675.0, 0.0, -160.0, -130.0, -10.0, -1160.0, 0.0, 48.0, -190.0, -179.0, 32.0, -179.0, -640.0, 0.0, 0.0, 0.0, -487.0, -435.0, -528.0, -279.0, -100.0, -90.0, -680.0, -910.0, -296.0, -370.0, 0.0, -176.0, -480.0, 0.0, -170.0, -149.0, -230.0, 1.0, -40.0, -270.0, 16.0, -200.0, -60.0, 0.0, -91.0, -122.0, 0.0, -110.0, -93.0, -54.0, -10.0, 0.0, -40.0, -178.0, -2000.0, 0.0, -37.0, 0.0, -890.0, 0.0, -340.0, -178.0, -10.0, -20.0, -231.0, -90.0, -350.0, -268.0, 0.0, 0.0, -10.0, -120.0, 0.0, 0.0, -15.0, 17.0, -220.0, -88.0, -240.0, 0.0, 0.0, -420.0, -45.0, -123.0, 28.0, -220.0, -780.0, 18.0, -290.0, -909.0, 13.0, 28.0, 0.0, 0.0, -20.0, 0.0, -60.0, -30.0, -607.0, -410.0, 0.0, 0.0, 53.0, -10.0, 0.0, -90.0, -330.0, -240.0, -70.0, -100.0, -169.0, -30.0, -157.0, -460.0, 0.0, -314.0, -30.0, 0.0, -1550.0, -101.0, -60.0, 0.0, -120.0, -108.0, -117.0, -53.0, -810.0, 32.0, -200.0, 37.0, 1.0, 0.0, -1000.0, -1160.0, 0.0, -148.0, -120.0, 0.0, -389.0, 0.0, 0.0, -20.0, -380.0, -100.0, 0.0, -330.0, -30.0, -30.0, -300.0, -104.0, -163.0, 0.0, -980.0, -110.0], "policy_predator_policy_reward": [20.0, 50.0, 90.0, 10.0, 110.0, 40.0, 130.0, 5.0, 70.0, 145.0, 345.0, 0.0, 30.0, 0.0, 295.0, 10.0, 90.0, 10.0, 20.0, 120.0, 20.0, 240.0, 0.0, 160.0, 5.0, 35.0, 400.0, 245.0, 125.0, 255.0, 0.0, 5.0, 1000.0, 25.0, 15.0, 165.0, 80.0, 10.0, 120.0, 130.0, 140.0, 0.0, 175.0, 305.0, 65.0, 0.0, 10.0, 265.0, 0.0, 55.0, 325.0, 35.0, 85.0, 60.0, 570.0, 450.0, 0.0, 0.0, 95.0, 110.0, 90.0, 45.0, 0.0, 320.0, 0.0, 0.0, 0.0, 330.0, 235.0, 85.0, 50.0, 0.0, 490.0, 170.0, 200.0, 0.0, 0.0, 90.0, 65.0, 240.0, 40.0, 85.0, 50.0, 100.0, 75.0, 65.0, 0.0, 100.0, 0.0, 30.0, 50.0, 65.0, 55.0, 0.0, 75.0, 5.0, 0.0, 5.0, 45.0, 110.0, 0.0, 1000.0, 20.0, 0.0, 325.0, 445.0, 170.0, 0.0, 15.0, 0.0, 170.0, 0.0, 120.0, 110.0, 0.0, 0.0, 5.0, 60.0, 0.0, 0.0, 0.0, 30.0, 0.0, 110.0, 120.0, 0.0, 210.0, 0.0, 70.0, 45.0, 10.0, 110.0, 5.0, 385.0, 215.0, 405.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 45.0, 5.0, 400.0, 0.0, 0.0, 0.0, 5.0, 45.0, 0.0, 220.0, 5.0, 25.0, 55.0, 90.0, 55.0, 230.0, 70.0, 105.0, 65.0, 15.0, 0.0, 65.0, 775.0, 0.0, 30.0, 90.0, 25.0, 0.0, 105.0, 170.0, 365.0, 0.0, 100.0, 0.0, 0.0, 0.0, 745.0, 30.0, 95.0, 60.0, 0.0, 0.0, 195.0, 0.0, 10.0, 230.0, 10.0, 25.0, 140.0, 20.0, 0.0, 150.0, 0.0, 60.0, 35.0, 480.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6073681711046812, "mean_inference_ms": 1.3890415653002952, "mean_action_processing_ms": 0.2389631175017786, "mean_env_wait_ms": 0.18007270919396617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005524039268493652, "StateBufferConnector_ms": 0.003554105758666992, "ViewRequirementAgentConnector_ms": 0.09615564346313477}, "num_episodes": 23, "episode_return_max": 48.0, "episode_return_min": -1415.0, "episode_return_mean": -199.18, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.86983192024316, "num_env_steps_trained_throughput_per_sec": 82.86983192024316, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 48928.969, "restore_workers_time_ms": 0.017, "training_step_time_ms": 48928.867, "sample_time_ms": 1071.675, "learn_time_ms": 47836.868, "learn_throughput": 83.618, "synch_weights_time_ms": 15.621}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-10-14", "timestamp": 1723504214, "time_this_iter_s": 48.29828500747681, "time_total_s": 5646.659626722336, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aae2fc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5646.659626722336, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 22.28235294117647, "ram_util_percent": 82.91029411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.931028074294171, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9846477136094733, "policy_loss": -0.002179362857714295, "vf_loss": 1.9866184696318612, "vf_explained_var": 0.002162787775513987, "kl": 0.005562908290429814, "entropy": 0.45618677104591693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1599273318651493, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8765319097609747, "policy_loss": -0.012571144174715434, "vf_loss": 1.8872168344164653, "vf_explained_var": -0.002416238015290921, "kl": 0.009431114589534727, "entropy": 1.1787113623013572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 48.0, "episode_reward_min": -2980.0, "episode_reward_mean": -224.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 68.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -220.435, "predator_policy": 107.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0, -288.0, -36.0, -540.0, -63.0, -179.0, -55.0, -315.0, -145.0, -150.0, 48.0, -164.0, -12.0, -320.0, 0.0, -592.0, -487.0, -140.0, -930.0, -466.0, -86.0, -175.0, -194.0, -79.0, -170.0, -84.0, -30.0, -98.0, -55.0, -67.0, -5.0, -63.0, -1000.0, -17.0, -120.0, -348.0, -15.0, -151.0, -388.0, 0.0, -65.0, 0.0, 32.0, -198.0, -120.0, -210.0, -53.0, -72.0, -372.0, -579.0, 41.0, 0.0, -5.0, -45.0, -612.0, 0.0, 48.0, -45.0, -345.0, -90.0, -54.0, -317.0, -144.0, -15.0, -811.0, -30.0, -113.0, -65.0, -243.0, -63.0, 1.0, -1415.0, -23.0, -60.0, -194.0, -10.0, -240.0, -165.0, -40.0, -254.0, -68.0, -545.0, -122.0, -345.0, -455.0, -55.0, -55.0, -110.0, -405.0, -2980.0, -500.0, -740.0, -20.0, -28.0, -10.0, -60.0, -174.0, -8.0, -815.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -160.0, -63.0, -475.0, 68.0, -244.0, -610.0, -410.0, -128.0, 0.0, -434.0, -20.0, -110.0, 0.0, -675.0, 0.0, -160.0, -130.0, -10.0, -1160.0, 0.0, 48.0, -190.0, -179.0, 32.0, -179.0, -640.0, 0.0, 0.0, 0.0, -487.0, -435.0, -528.0, -279.0, -100.0, -90.0, -680.0, -910.0, -296.0, -370.0, 0.0, -176.0, -480.0, 0.0, -170.0, -149.0, -230.0, 1.0, -40.0, -270.0, 16.0, -200.0, -60.0, 0.0, -91.0, -122.0, 0.0, -110.0, -93.0, -54.0, -10.0, 0.0, -40.0, -178.0, -2000.0, 0.0, -37.0, 0.0, -890.0, 0.0, -340.0, -178.0, -10.0, -20.0, -231.0, -90.0, -350.0, -268.0, 0.0, 0.0, -10.0, -120.0, 0.0, 0.0, -15.0, 17.0, -220.0, -88.0, -240.0, 0.0, 0.0, -420.0, -45.0, -123.0, 28.0, -220.0, -780.0, 18.0, -290.0, -909.0, 13.0, 28.0, 0.0, 0.0, -20.0, 0.0, -60.0, -30.0, -607.0, -410.0, 0.0, 0.0, 53.0, -10.0, 0.0, -90.0, -330.0, -240.0, -70.0, -100.0, -169.0, -30.0, -157.0, -460.0, 0.0, -314.0, -30.0, 0.0, -1550.0, -101.0, -60.0, 0.0, -120.0, -108.0, -117.0, -53.0, -810.0, 32.0, -200.0, 37.0, 1.0, 0.0, -1000.0, -1160.0, 0.0, -148.0, -120.0, 0.0, -389.0, 0.0, 0.0, -20.0, -380.0, -100.0, 0.0, -330.0, -30.0, -30.0, -300.0, -104.0, -163.0, 0.0, -980.0, -110.0, -10.0, -282.0, 0.0, -690.0, -420.0, -360.0, 0.0, -180.0, 0.0, -110.0, -240.0, 0.0, -160.0, -650.0, -2000.0, -1980.0, -90.0, -840.0, -50.0, -2000.0, 0.0, -40.0, 0.0, -98.0, 0.0, -25.0, -120.0, 0.0, -125.0, -159.0, -20.0, 2.0, 0.0, -1680.0, -23.0, 0.0], "policy_predator_policy_reward": [80.0, 10.0, 120.0, 130.0, 140.0, 0.0, 175.0, 305.0, 65.0, 0.0, 10.0, 265.0, 0.0, 55.0, 325.0, 35.0, 85.0, 60.0, 570.0, 450.0, 0.0, 0.0, 95.0, 110.0, 90.0, 45.0, 0.0, 320.0, 0.0, 0.0, 0.0, 330.0, 235.0, 85.0, 50.0, 0.0, 490.0, 170.0, 200.0, 0.0, 0.0, 90.0, 65.0, 240.0, 40.0, 85.0, 50.0, 100.0, 75.0, 65.0, 0.0, 100.0, 0.0, 30.0, 50.0, 65.0, 55.0, 0.0, 75.0, 5.0, 0.0, 5.0, 45.0, 110.0, 0.0, 1000.0, 20.0, 0.0, 325.0, 445.0, 170.0, 0.0, 15.0, 0.0, 170.0, 0.0, 120.0, 110.0, 0.0, 0.0, 5.0, 60.0, 0.0, 0.0, 0.0, 30.0, 0.0, 110.0, 120.0, 0.0, 210.0, 0.0, 70.0, 45.0, 10.0, 110.0, 5.0, 385.0, 215.0, 405.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 45.0, 5.0, 400.0, 0.0, 0.0, 0.0, 5.0, 45.0, 0.0, 220.0, 5.0, 25.0, 55.0, 90.0, 55.0, 230.0, 70.0, 105.0, 65.0, 15.0, 0.0, 65.0, 775.0, 0.0, 30.0, 90.0, 25.0, 0.0, 105.0, 170.0, 365.0, 0.0, 100.0, 0.0, 0.0, 0.0, 745.0, 30.0, 95.0, 60.0, 0.0, 0.0, 195.0, 0.0, 10.0, 230.0, 10.0, 25.0, 140.0, 20.0, 0.0, 150.0, 0.0, 60.0, 35.0, 480.0, 65.0, 150.0, 20.0, 0.0, 345.0, 285.0, 40.0, 80.0, 45.0, 55.0, 0.0, 65.0, 65.0, 80.0, 325.0, 0.0, 1000.0, 430.0, 0.0, 310.0, 1000.0, 0.0, 20.0, 25.0, 45.0, 0.0, 15.0, 60.0, 0.0, 15.0, 95.0, 0.0, 10.0, 25.0, 840.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069824146488824, "mean_inference_ms": 1.3880379474508886, "mean_action_processing_ms": 0.2388875216115936, "mean_env_wait_ms": 0.1799601742466954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005052804946899414, "StateBufferConnector_ms": 0.00354921817779541, "ViewRequirementAgentConnector_ms": 0.09626924991607666}, "num_episodes": 18, "episode_return_max": 48.0, "episode_return_min": -2980.0, "episode_return_mean": -224.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.03859664569686, "num_env_steps_trained_throughput_per_sec": 82.03859664569686, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 48828.957, "restore_workers_time_ms": 0.017, "training_step_time_ms": 48828.863, "sample_time_ms": 1079.895, "learn_time_ms": 47729.887, "learn_throughput": 83.805, "synch_weights_time_ms": 15.343}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-11-03", "timestamp": 1723504263, "time_this_iter_s": 48.82125401496887, "time_total_s": 5695.480880737305, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aad48e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5695.480880737305, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 22.82463768115942, "ram_util_percent": 82.9753623188406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3151829051750679, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.035442889808978, "policy_loss": -0.006041859955250941, "vf_loss": 2.041036944950699, "vf_explained_var": 0.001569157081937033, "kl": 0.011941441933275936, "entropy": 0.46191564594942425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.173637740542649, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1943229177641492, "policy_loss": -0.013658436055162123, "vf_loss": 2.206439063788722, "vf_explained_var": -0.014510920091911598, "kl": 0.007711411098500422, "entropy": 1.1614704093605122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 48.0, "episode_reward_min": -2980.0, "episode_reward_mean": -203.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 53.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -201.04, "predator_policy": 99.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-194.0, -79.0, -170.0, -84.0, -30.0, -98.0, -55.0, -67.0, -5.0, -63.0, -1000.0, -17.0, -120.0, -348.0, -15.0, -151.0, -388.0, 0.0, -65.0, 0.0, 32.0, -198.0, -120.0, -210.0, -53.0, -72.0, -372.0, -579.0, 41.0, 0.0, -5.0, -45.0, -612.0, 0.0, 48.0, -45.0, -345.0, -90.0, -54.0, -317.0, -144.0, -15.0, -811.0, -30.0, -113.0, -65.0, -243.0, -63.0, 1.0, -1415.0, -23.0, -60.0, -194.0, -10.0, -240.0, -165.0, -40.0, -254.0, -68.0, -545.0, -122.0, -345.0, -455.0, -55.0, -55.0, -110.0, -405.0, -2980.0, -500.0, -740.0, -20.0, -28.0, -10.0, -60.0, -174.0, -8.0, -815.0, -3.0, -150.0, -345.0, -315.0, -11.0, 0.0, -385.0, -68.0, -58.0, -85.0, 0.0, -10.0, 0.0, -76.0, -360.0, -75.0, 0.0, 8.0, -163.0, -76.0, -249.0, -320.0, -293.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-170.0, -149.0, -230.0, 1.0, -40.0, -270.0, 16.0, -200.0, -60.0, 0.0, -91.0, -122.0, 0.0, -110.0, -93.0, -54.0, -10.0, 0.0, -40.0, -178.0, -2000.0, 0.0, -37.0, 0.0, -890.0, 0.0, -340.0, -178.0, -10.0, -20.0, -231.0, -90.0, -350.0, -268.0, 0.0, 0.0, -10.0, -120.0, 0.0, 0.0, -15.0, 17.0, -220.0, -88.0, -240.0, 0.0, 0.0, -420.0, -45.0, -123.0, 28.0, -220.0, -780.0, 18.0, -290.0, -909.0, 13.0, 28.0, 0.0, 0.0, -20.0, 0.0, -60.0, -30.0, -607.0, -410.0, 0.0, 0.0, 53.0, -10.0, 0.0, -90.0, -330.0, -240.0, -70.0, -100.0, -169.0, -30.0, -157.0, -460.0, 0.0, -314.0, -30.0, 0.0, -1550.0, -101.0, -60.0, 0.0, -120.0, -108.0, -117.0, -53.0, -810.0, 32.0, -200.0, 37.0, 1.0, 0.0, -1000.0, -1160.0, 0.0, -148.0, -120.0, 0.0, -389.0, 0.0, 0.0, -20.0, -380.0, -100.0, 0.0, -330.0, -30.0, -30.0, -300.0, -104.0, -163.0, 0.0, -980.0, -110.0, -10.0, -282.0, 0.0, -690.0, -420.0, -360.0, 0.0, -180.0, 0.0, -110.0, -240.0, 0.0, -160.0, -650.0, -2000.0, -1980.0, -90.0, -840.0, -50.0, -2000.0, 0.0, -40.0, 0.0, -98.0, 0.0, -25.0, -120.0, 0.0, -125.0, -159.0, -20.0, 2.0, 0.0, -1680.0, -23.0, 0.0, -200.0, -105.0, 25.0, -760.0, -190.0, -440.0, 0.0, -26.0, 0.0, 0.0, -220.0, -570.0, -49.0, -79.0, -148.0, -90.0, -150.0, -20.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -306.0, -540.0, -115.0, 0.0, -150.0, 0.0, 0.0, 3.0, 0.0, -190.0, -158.0, 0.0, -266.0, -499.0, 0.0, -830.0, -100.0, -490.0, -98.0], "policy_predator_policy_reward": [40.0, 85.0, 50.0, 100.0, 75.0, 65.0, 0.0, 100.0, 0.0, 30.0, 50.0, 65.0, 55.0, 0.0, 75.0, 5.0, 0.0, 5.0, 45.0, 110.0, 0.0, 1000.0, 20.0, 0.0, 325.0, 445.0, 170.0, 0.0, 15.0, 0.0, 170.0, 0.0, 120.0, 110.0, 0.0, 0.0, 5.0, 60.0, 0.0, 0.0, 0.0, 30.0, 0.0, 110.0, 120.0, 0.0, 210.0, 0.0, 70.0, 45.0, 10.0, 110.0, 5.0, 385.0, 215.0, 405.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 45.0, 5.0, 400.0, 0.0, 0.0, 0.0, 5.0, 45.0, 0.0, 220.0, 5.0, 25.0, 55.0, 90.0, 55.0, 230.0, 70.0, 105.0, 65.0, 15.0, 0.0, 65.0, 775.0, 0.0, 30.0, 90.0, 25.0, 0.0, 105.0, 170.0, 365.0, 0.0, 100.0, 0.0, 0.0, 0.0, 745.0, 30.0, 95.0, 60.0, 0.0, 0.0, 195.0, 0.0, 10.0, 230.0, 10.0, 25.0, 140.0, 20.0, 0.0, 150.0, 0.0, 60.0, 35.0, 480.0, 65.0, 150.0, 20.0, 0.0, 345.0, 285.0, 40.0, 80.0, 45.0, 55.0, 0.0, 65.0, 65.0, 80.0, 325.0, 0.0, 1000.0, 430.0, 0.0, 310.0, 1000.0, 0.0, 20.0, 25.0, 45.0, 0.0, 15.0, 60.0, 0.0, 15.0, 95.0, 0.0, 10.0, 25.0, 840.0, 20.0, 0.0, 55.0, 100.0, 380.0, 10.0, 270.0, 45.0, 5.0, 10.0, 0.0, 0.0, 120.0, 285.0, 60.0, 0.0, 90.0, 90.0, 85.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 90.0, 140.0, 220.0, 75.0, 75.0, 0.0, 0.0, 0.0, 0.0, 5.0, 95.0, 90.0, 60.0, 130.0, 0.0, 250.0, 315.0, 295.0, 50.0, 245.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6066392685102169, "mean_inference_ms": 1.3869195347624927, "mean_action_processing_ms": 0.23890082559285986, "mean_env_wait_ms": 0.17975881693341605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004332184791564941, "StateBufferConnector_ms": 0.0030670166015625, "ViewRequirementAgentConnector_ms": 0.09501099586486816}, "num_episodes": 22, "episode_return_max": 48.0, "episode_return_min": -2980.0, "episode_return_mean": -203.58, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.78663746298456, "num_env_steps_trained_throughput_per_sec": 81.78663746298456, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 48814.167, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48814.079, "sample_time_ms": 1073.518, "learn_time_ms": 47722.489, "learn_throughput": 83.818, "synch_weights_time_ms": 14.765}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-11-52", "timestamp": 1723504312, "time_this_iter_s": 48.937071800231934, "time_total_s": 5744.417952537537, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aad5b430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5744.417952537537, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 24.03285714285714, "ram_util_percent": 82.89857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2517527904775407, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3686996280200896, "policy_loss": -0.003869343121417813, "vf_loss": 2.372416555124616, "vf_explained_var": 0.0037542071922746284, "kl": 0.004064657747840322, "entropy": 0.3927705658333642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3375238081134815, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2027792320680364, "policy_loss": -0.012980169555044207, "vf_loss": 2.2142125919697775, "vf_explained_var": -0.05610993633825312, "kl": 0.007734038796912673, "entropy": 1.1195661049671275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 48.0, "episode_reward_min": -2980.0, "episode_reward_mean": -197.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 53.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -194.345, "predator_policy": 95.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.0, 0.0, 32.0, -198.0, -120.0, -210.0, -53.0, -72.0, -372.0, -579.0, 41.0, 0.0, -5.0, -45.0, -612.0, 0.0, 48.0, -45.0, -345.0, -90.0, -54.0, -317.0, -144.0, -15.0, -811.0, -30.0, -113.0, -65.0, -243.0, -63.0, 1.0, -1415.0, -23.0, -60.0, -194.0, -10.0, -240.0, -165.0, -40.0, -254.0, -68.0, -545.0, -122.0, -345.0, -455.0, -55.0, -55.0, -110.0, -405.0, -2980.0, -500.0, -740.0, -20.0, -28.0, -10.0, -60.0, -174.0, -8.0, -815.0, -3.0, -150.0, -345.0, -315.0, -11.0, 0.0, -385.0, -68.0, -58.0, -85.0, 0.0, -10.0, 0.0, -76.0, -360.0, -75.0, 0.0, 8.0, -163.0, -76.0, -249.0, -320.0, -293.0, 0.0, -260.0, -78.0, -75.0, -20.0, -58.0, -113.0, -275.0, 0.0, -180.0, -330.0, -40.0, -178.0, -35.0, -89.0, -24.0, -515.0, -50.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, -120.0, 0.0, 0.0, -15.0, 17.0, -220.0, -88.0, -240.0, 0.0, 0.0, -420.0, -45.0, -123.0, 28.0, -220.0, -780.0, 18.0, -290.0, -909.0, 13.0, 28.0, 0.0, 0.0, -20.0, 0.0, -60.0, -30.0, -607.0, -410.0, 0.0, 0.0, 53.0, -10.0, 0.0, -90.0, -330.0, -240.0, -70.0, -100.0, -169.0, -30.0, -157.0, -460.0, 0.0, -314.0, -30.0, 0.0, -1550.0, -101.0, -60.0, 0.0, -120.0, -108.0, -117.0, -53.0, -810.0, 32.0, -200.0, 37.0, 1.0, 0.0, -1000.0, -1160.0, 0.0, -148.0, -120.0, 0.0, -389.0, 0.0, 0.0, -20.0, -380.0, -100.0, 0.0, -330.0, -30.0, -30.0, -300.0, -104.0, -163.0, 0.0, -980.0, -110.0, -10.0, -282.0, 0.0, -690.0, -420.0, -360.0, 0.0, -180.0, 0.0, -110.0, -240.0, 0.0, -160.0, -650.0, -2000.0, -1980.0, -90.0, -840.0, -50.0, -2000.0, 0.0, -40.0, 0.0, -98.0, 0.0, -25.0, -120.0, 0.0, -125.0, -159.0, -20.0, 2.0, 0.0, -1680.0, -23.0, 0.0, -200.0, -105.0, 25.0, -760.0, -190.0, -440.0, 0.0, -26.0, 0.0, 0.0, -220.0, -570.0, -49.0, -79.0, -148.0, -90.0, -150.0, -20.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -306.0, -540.0, -115.0, 0.0, -150.0, 0.0, 0.0, 3.0, 0.0, -190.0, -158.0, 0.0, -266.0, -499.0, 0.0, -830.0, -100.0, -490.0, -98.0, 0.0, 0.0, -180.0, -210.0, -180.0, 7.0, 0.0, -200.0, 0.0, -430.0, -123.0, 0.0, -130.0, -108.0, -380.0, -170.0, 0.0, 0.0, -130.0, -130.0, -30.0, -630.0, -165.0, 0.0, -167.0, -126.0, 0.0, -90.0, -20.0, -169.0, -78.0, 14.0, -90.0, -870.0, -80.0, -10.0], "policy_predator_policy_reward": [5.0, 60.0, 0.0, 0.0, 0.0, 30.0, 0.0, 110.0, 120.0, 0.0, 210.0, 0.0, 70.0, 45.0, 10.0, 110.0, 5.0, 385.0, 215.0, 405.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 45.0, 5.0, 400.0, 0.0, 0.0, 0.0, 5.0, 45.0, 0.0, 220.0, 5.0, 25.0, 55.0, 90.0, 55.0, 230.0, 70.0, 105.0, 65.0, 15.0, 0.0, 65.0, 775.0, 0.0, 30.0, 90.0, 25.0, 0.0, 105.0, 170.0, 365.0, 0.0, 100.0, 0.0, 0.0, 0.0, 745.0, 30.0, 95.0, 60.0, 0.0, 0.0, 195.0, 0.0, 10.0, 230.0, 10.0, 25.0, 140.0, 20.0, 0.0, 150.0, 0.0, 60.0, 35.0, 480.0, 65.0, 150.0, 20.0, 0.0, 345.0, 285.0, 40.0, 80.0, 45.0, 55.0, 0.0, 65.0, 65.0, 80.0, 325.0, 0.0, 1000.0, 430.0, 0.0, 310.0, 1000.0, 0.0, 20.0, 25.0, 45.0, 0.0, 15.0, 60.0, 0.0, 15.0, 95.0, 0.0, 10.0, 25.0, 840.0, 20.0, 0.0, 55.0, 100.0, 380.0, 10.0, 270.0, 45.0, 5.0, 10.0, 0.0, 0.0, 120.0, 285.0, 60.0, 0.0, 90.0, 90.0, 85.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 90.0, 140.0, 220.0, 75.0, 75.0, 0.0, 0.0, 0.0, 0.0, 5.0, 95.0, 90.0, 60.0, 130.0, 0.0, 250.0, 315.0, 295.0, 50.0, 245.0, 0.0, 0.0, 45.0, 85.0, 0.0, 95.0, 30.0, 95.0, 205.0, 205.0, 65.0, 0.0, 65.0, 60.0, 75.0, 200.0, 0.0, 0.0, 80.0, 0.0, 15.0, 315.0, 65.0, 60.0, 115.0, 0.0, 45.0, 10.0, 0.0, 100.0, 35.0, 5.0, 445.0, 0.0, 10.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6061504481002636, "mean_inference_ms": 1.3856902235995705, "mean_action_processing_ms": 0.2386921919418452, "mean_env_wait_ms": 0.17969826887201112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003723740577697754, "StateBufferConnector_ms": 0.003051280975341797, "ViewRequirementAgentConnector_ms": 0.09428465366363525}, "num_episodes": 18, "episode_return_max": 48.0, "episode_return_min": -2980.0, "episode_return_mean": -197.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.59287117222556, "num_env_steps_trained_throughput_per_sec": 79.59287117222556, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 48993.173, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48993.08, "sample_time_ms": 1074.123, "learn_time_ms": 47901.007, "learn_throughput": 83.506, "synch_weights_time_ms": 14.585}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-12-42", "timestamp": 1723504362, "time_this_iter_s": 50.28866004943848, "time_total_s": 5794.706612586975, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aad480d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5794.706612586975, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 25.832394366197178, "ram_util_percent": 82.72676056338027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1432326605237981, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0709266779283997, "policy_loss": -0.0031603625468003054, "vf_loss": 2.0739257755733673, "vf_explained_var": 0.0007751942311645185, "kl": 0.008600944569751731, "entropy": 0.5149385911131662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3563374563184363, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3522662744320257, "policy_loss": -0.01065719394584891, "vf_loss": 2.361761649891182, "vf_explained_var": -0.0051230778454472775, "kl": 0.00580906463289927, "entropy": 1.0510077760333107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 16.0, "episode_reward_min": -2980.0, "episode_reward_mean": -199.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 37.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -197.14, "predator_policy": 97.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, -811.0, -30.0, -113.0, -65.0, -243.0, -63.0, 1.0, -1415.0, -23.0, -60.0, -194.0, -10.0, -240.0, -165.0, -40.0, -254.0, -68.0, -545.0, -122.0, -345.0, -455.0, -55.0, -55.0, -110.0, -405.0, -2980.0, -500.0, -740.0, -20.0, -28.0, -10.0, -60.0, -174.0, -8.0, -815.0, -3.0, -150.0, -345.0, -315.0, -11.0, 0.0, -385.0, -68.0, -58.0, -85.0, 0.0, -10.0, 0.0, -76.0, -360.0, -75.0, 0.0, 8.0, -163.0, -76.0, -249.0, -320.0, -293.0, 0.0, -260.0, -78.0, -75.0, -20.0, -58.0, -113.0, -275.0, 0.0, -180.0, -330.0, -40.0, -178.0, -35.0, -89.0, -24.0, -515.0, -50.0, 0.0, -69.0, 11.0, -534.0, -130.0, -115.0, -30.0, -40.0, -64.0, -21.0, -56.0, -35.0, -1442.0, -325.0, 16.0, -65.0, -26.0, -13.0, -5.0, -156.0, 0.0, 0.0, -280.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.0, 0.0, -1550.0, -101.0, -60.0, 0.0, -120.0, -108.0, -117.0, -53.0, -810.0, 32.0, -200.0, 37.0, 1.0, 0.0, -1000.0, -1160.0, 0.0, -148.0, -120.0, 0.0, -389.0, 0.0, 0.0, -20.0, -380.0, -100.0, 0.0, -330.0, -30.0, -30.0, -300.0, -104.0, -163.0, 0.0, -980.0, -110.0, -10.0, -282.0, 0.0, -690.0, -420.0, -360.0, 0.0, -180.0, 0.0, -110.0, -240.0, 0.0, -160.0, -650.0, -2000.0, -1980.0, -90.0, -840.0, -50.0, -2000.0, 0.0, -40.0, 0.0, -98.0, 0.0, -25.0, -120.0, 0.0, -125.0, -159.0, -20.0, 2.0, 0.0, -1680.0, -23.0, 0.0, -200.0, -105.0, 25.0, -760.0, -190.0, -440.0, 0.0, -26.0, 0.0, 0.0, -220.0, -570.0, -49.0, -79.0, -148.0, -90.0, -150.0, -20.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -306.0, -540.0, -115.0, 0.0, -150.0, 0.0, 0.0, 3.0, 0.0, -190.0, -158.0, 0.0, -266.0, -499.0, 0.0, -830.0, -100.0, -490.0, -98.0, 0.0, 0.0, -180.0, -210.0, -180.0, 7.0, 0.0, -200.0, 0.0, -430.0, -123.0, 0.0, -130.0, -108.0, -380.0, -170.0, 0.0, 0.0, -130.0, -130.0, -30.0, -630.0, -165.0, 0.0, -167.0, -126.0, 0.0, -90.0, -20.0, -169.0, -78.0, 14.0, -90.0, -870.0, -80.0, -10.0, 5.0, -10.0, -60.0, -134.0, 0.0, -4.0, -174.0, -1430.0, -20.0, -240.0, -50.0, -140.0, -110.0, -10.0, -60.0, -20.0, -101.0, -38.0, 0.0, -46.0, 2.0, -188.0, 0.0, -70.0, -952.0, -1020.0, -225.0, -430.0, 11.0, 5.0, -130.0, 0.0, -119.0, 28.0, 27.0, -370.0, -10.0, 0.0, -36.0, -280.0, 0.0, 0.0, 0.0, 0.0, -490.0, -90.0], "policy_predator_policy_reward": [15.0, 0.0, 65.0, 775.0, 0.0, 30.0, 90.0, 25.0, 0.0, 105.0, 170.0, 365.0, 0.0, 100.0, 0.0, 0.0, 0.0, 745.0, 30.0, 95.0, 60.0, 0.0, 0.0, 195.0, 0.0, 10.0, 230.0, 10.0, 25.0, 140.0, 20.0, 0.0, 150.0, 0.0, 60.0, 35.0, 480.0, 65.0, 150.0, 20.0, 0.0, 345.0, 285.0, 40.0, 80.0, 45.0, 55.0, 0.0, 65.0, 65.0, 80.0, 325.0, 0.0, 1000.0, 430.0, 0.0, 310.0, 1000.0, 0.0, 20.0, 25.0, 45.0, 0.0, 15.0, 60.0, 0.0, 15.0, 95.0, 0.0, 10.0, 25.0, 840.0, 20.0, 0.0, 55.0, 100.0, 380.0, 10.0, 270.0, 45.0, 5.0, 10.0, 0.0, 0.0, 120.0, 285.0, 60.0, 0.0, 90.0, 90.0, 85.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 90.0, 140.0, 220.0, 75.0, 75.0, 0.0, 0.0, 0.0, 0.0, 5.0, 95.0, 90.0, 60.0, 130.0, 0.0, 250.0, 315.0, 295.0, 50.0, 245.0, 0.0, 0.0, 45.0, 85.0, 0.0, 95.0, 30.0, 95.0, 205.0, 205.0, 65.0, 0.0, 65.0, 60.0, 75.0, 200.0, 0.0, 0.0, 80.0, 0.0, 15.0, 315.0, 65.0, 60.0, 115.0, 0.0, 45.0, 10.0, 0.0, 100.0, 35.0, 5.0, 445.0, 0.0, 10.0, 30.0, 5.0, 0.0, 70.0, 55.0, 5.0, 10.0, 355.0, 715.0, 130.0, 0.0, 20.0, 55.0, 50.0, 40.0, 30.0, 10.0, 0.0, 75.0, 25.0, 0.0, 35.0, 95.0, 0.0, 35.0, 20.0, 510.0, 215.0, 115.0, 0.0, 0.0, 0.0, 65.0, 65.0, 0.0, 180.0, 150.0, 5.0, 0.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 55.0, 245.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6061989483260771, "mean_inference_ms": 1.3846199405001565, "mean_action_processing_ms": 0.23843350402204527, "mean_env_wait_ms": 0.17954877154363508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039598941802978516, "StateBufferConnector_ms": 0.0032411813735961914, "ViewRequirementAgentConnector_ms": 0.09897935390472412}, "num_episodes": 23, "episode_return_max": 16.0, "episode_return_min": -2980.0, "episode_return_mean": -199.68, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.97502773871307, "num_env_steps_trained_throughput_per_sec": 81.97502773871307, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 49008.189, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49008.096, "sample_time_ms": 1088.14, "learn_time_ms": 47902.402, "learn_throughput": 83.503, "synch_weights_time_ms": 14.51}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "d8dc0_00000", "date": "2024-08-12_19-13-31", "timestamp": 1723504411, "time_this_iter_s": 48.85185503959656, "time_total_s": 5843.558467626572, "pid": 96967, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ab8fd8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5843.558467626572, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 23.888405797101445, "ram_util_percent": 82.12898550724637}}
