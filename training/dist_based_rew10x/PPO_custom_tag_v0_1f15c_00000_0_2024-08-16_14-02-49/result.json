{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.681665605700836, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.399604060157897, "policy_loss": -0.006061463292426967, "vf_loss": 7.4043853509993784, "vf_explained_var": 0.0004211152672136902, "kl": 0.006400846240158278, "entropy": 1.6030585917846236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.860496643091005, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.697507573183252, "policy_loss": -0.00389137658076213, "vf_loss": 7.700574201755423, "vf_explained_var": -0.0006694969046052801, "kl": 0.0041236766030047275, "entropy": 1.6053038418608367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 245.13988888966955, "episode_reward_min": -58.3382051360548, "episode_reward_mean": 93.71304977081022, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -718.0026496441976, "predator_policy": 28.665142642240497}, "policy_reward_max": {"prey_policy": 50.45608346351276, "predator_policy": 718.4926496441976}, "policy_reward_mean": {"prey_policy": -219.344135392058, "predator_policy": 266.20066027746293}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.01596810581974, 245.13988888966955, 48.8999999999999, 42.26498793210075, 64.39815280233516, 160.25630919856, 72.33740718964721, -58.3382051360548, 91.26935732433819, 81.69193091144719, 34.589999999999804, 126.82000000000079, 103.73077544054276, 164.89227923665467, 36.42000000000006, 118.99649505526634, 155.93637418219623, 74.51317474206039], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.889999999999986, -221.1205982280901, -592.2404926398783, -75.99145634673468, -718.0026496441976, -325.73425847527096, -45.42603236368234, -288.56624171820437, -9.384516076097185, -55.29147345787109, -398.42468290674555, -59.31375651793434, -298.83271461738366, 18.830000000000254, -516.4076425188676, -573.569059144404, -87.57520124612857, 22.37299736842012, -250.12623763831303, -320.3226332546506, -131.7258097513188, -234.30771239278022, -78.02376330684932, -42.30098045599001, -274.5775742920618, 27.74000000000017, -227.23903385341418, -372.86238024156916, -553.594180354726, -269.60078535743423, -208.8701985957096, -128.24937751457736, 2.0000000000000013, 50.45608346351276, 23.7800000000001, -696.7765120351366], "policy_predator_policy_reward": [144.16153591100874, 187.08503042289905, 422.2039713073229, 491.1678665689596, 718.4926496441976, 374.1442584752706, 64.72102029578312, 311.5362417182047, 100.40899969406368, 28.665142642240497, 202.88233297975663, 415.11241564348245, 301.1819265929933, 51.158195214037036, 610.6382647950129, 421.0002317322039, 53.56082633510378, 102.91073486694265, 228.7007647191023, 423.44003708530795, 133.21580975131928, 267.4077123927792, 81.65376330684998, 165.49098045599, 132.32505384509432, 218.24329588750848, 212.56021433649943, 552.4334789951381, 588.744180354726, 270.8707853574331, 249.1489956682878, 206.96707549726452, 47.17191544639211, 56.30837527229157, 486.67828820218574, 260.831398575011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4719382937044205, "mean_inference_ms": 6.084384576808345, "mean_action_processing_ms": 0.9162527249657766, "mean_env_wait_ms": 0.7723913611703043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014796521928575303, "StateBufferConnector_ms": 0.025614102681477863, "ViewRequirementAgentConnector_ms": 0.4631201426188151}, "num_episodes": 18, "episode_return_max": 245.13988888966955, "episode_return_min": -58.3382051360548, "episode_return_mean": 93.71304977081022, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.40157630414066, "num_env_steps_trained_throughput_per_sec": 224.40157630414066, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 17825.197, "restore_workers_time_ms": 0.026, "training_step_time_ms": 17825.115, "sample_time_ms": 4710.272, "learn_time_ms": 13101.274, "learn_throughput": 305.314, "synch_weights_time_ms": 12.655}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "1f15c_00000", "date": "2024-08-16_14-03-28", "timestamp": 1723797208, "time_this_iter_s": 17.827987909317017, "time_total_s": 17.827987909317017, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f7b0f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.827987909317017, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.71923076923077, "ram_util_percent": 68.63461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8283596114822166, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.345379381835776, "policy_loss": -0.009943180651497588, "vf_loss": 6.353127347098456, "vf_explained_var": 0.0007154803742807378, "kl": 0.01097615391874447, "entropy": 1.5851190493851113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.005370081590597, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.233357375261014, "policy_loss": -0.0066189693077590575, "vf_loss": 7.239131268243941, "vf_explained_var": 0.007383581097163851, "kl": 0.008450816769767831, "entropy": 1.5913540804827655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 375.240152465279, "episode_reward_min": -58.3382051360548, "episode_reward_mean": 125.42833221905441, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -729.7278933269423, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 106.14216791105252, "predator_policy": 718.4926496441976}, "policy_reward_mean": {"prey_policy": -202.58033637849974, "predator_policy": 265.2945024880268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.01596810581974, 245.13988888966955, 48.8999999999999, 42.26498793210075, 64.39815280233516, 160.25630919856, 72.33740718964721, -58.3382051360548, 91.26935732433819, 81.69193091144719, 34.589999999999804, 126.82000000000079, 103.73077544054276, 164.89227923665467, 36.42000000000006, 118.99649505526634, 155.93637418219623, 74.51317474206039, 125.8100000000003, 150.77755015814694, 235.08438518780875, 211.1204549478512, 19.313296478135502, 160.29999999999993, 62.14999999999997, 268.1268124598878, 100.4300000000001, 214.23782079153347, 136.63999999999993, 261.0008176024099, 88.62000000000101, 167.8410123152625, 144.35999999999973, 375.240152465279, 81.27704387464847, 26.25571773041105], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.889999999999986, -221.1205982280901, -592.2404926398783, -75.99145634673468, -718.0026496441976, -325.73425847527096, -45.42603236368234, -288.56624171820437, -9.384516076097185, -55.29147345787109, -398.42468290674555, -59.31375651793434, -298.83271461738366, 18.830000000000254, -516.4076425188676, -573.569059144404, -87.57520124612857, 22.37299736842012, -250.12623763831303, -320.3226332546506, -131.7258097513188, -234.30771239278022, -78.02376330684932, -42.30098045599001, -274.5775742920618, 27.74000000000017, -227.23903385341418, -372.86238024156916, -553.594180354726, -269.60078535743423, -208.8701985957096, -128.24937751457736, 2.0000000000000013, 50.45608346351276, 23.7800000000001, -696.7765120351366, -175.88686539242843, -517.5086177018968, -66.28323608712391, -71.9547856684458, -287.4744205729812, 65.36000000000055, -95.27368807438538, 30.710000000000264, -233.08781351521938, -441.22885830427435, -279.69923633734163, -40.2181944603569, -195.21986707846898, -301.70043506563246, -719.8910929971715, 37.63999999999971, -115.60164417844402, -350.0070723455467, 40.60999999999968, -729.7278933269423, 106.14216791105252, 26.750000000000274, -556.9504777260724, -19.062430353295234, -28.173907678262495, -29.671809572914388, -68.41907043052933, -283.1773774567748, -419.46156068937245, 77.9140711852952, -536.3698771762329, 2.0000000000000013, -248.7119924843601, 39.13349684415077, -29.02102421966911, -275.8718321842484], "policy_predator_policy_reward": [144.16153591100874, 187.08503042289905, 422.2039713073229, 491.1678665689596, 718.4926496441976, 374.1442584752706, 64.72102029578312, 311.5362417182047, 100.40899969406368, 28.665142642240497, 202.88233297975663, 415.11241564348245, 301.1819265929933, 51.158195214037036, 610.6382647950129, 421.0002317322039, 53.56082633510378, 102.91073486694265, 228.7007647191023, 423.44003708530795, 133.21580975131928, 267.4077123927792, 81.65376330684998, 165.49098045599, 132.32505384509432, 218.24329588750848, 212.56021433649943, 552.4334789951381, 588.744180354726, 270.8707853574331, 249.1489956682878, 206.96707549726452, 47.17191544639211, 56.30837527229157, 486.67828820218574, 260.831398575011, 246.48686539242834, 572.7186177018966, 60.98492105488214, 228.03065085883412, 254.01530442888966, 203.1835013319016, 66.66752518882522, 209.01661783341146, 95.53560905730107, 598.094359240328, 280.9292363373416, 199.28819446035683, 247.15986707846812, 311.91043506563136, 573.1203638303407, 377.2575416267197, 477.1321819027128, 88.90653462127793, 684.4448752036382, 218.91083891483885, 0.0, 3.7478320889476002, 222.24810248571404, 614.7656231960638, 116.42180957291454, 30.043907678262773, 508.46177798866313, 10.975682213903427, 2.1113670469560266, 483.79612245712144, 466.38661353365916, 443.2234161078541, 71.66793427490836, 219.18760523994743, 225.46062156227555, 105.68795257205184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278319601977807, "mean_inference_ms": 5.952201385411865, "mean_action_processing_ms": 0.9296550441052259, "mean_env_wait_ms": 0.7622811113797648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015392899513244629, "StateBufferConnector_ms": 0.016743275854322646, "ViewRequirementAgentConnector_ms": 0.43566955460442436}, "num_episodes": 18, "episode_return_max": 375.240152465279, "episode_return_min": -58.3382051360548, "episode_return_mean": 125.42833221905441, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.37153913263137, "num_env_steps_trained_throughput_per_sec": 252.37153913263137, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 16837.426, "restore_workers_time_ms": 0.021, "training_step_time_ms": 16837.363, "sample_time_ms": 4546.635, "learn_time_ms": 12277.976, "learn_throughput": 325.787, "synch_weights_time_ms": 11.914}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "1f15c_00000", "date": "2024-08-16_14-03-47", "timestamp": 1723797227, "time_this_iter_s": 15.852543830871582, "time_total_s": 33.6805317401886, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f7fa3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.6805317401886, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.988888888888887, "ram_util_percent": 69.87777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0869242338591782, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.212236947609634, "policy_loss": -0.004190400581333845, "vf_loss": 5.214989347937246, "vf_explained_var": 0.002729368146765169, "kl": 0.00719001433732879, "entropy": 1.5814929483428835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0991233774436213, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.939805135020503, "policy_loss": -0.009475292040838332, "vf_loss": 7.948128942207054, "vf_explained_var": 0.024758812800917046, "kl": 0.01151477825803795, "entropy": 1.566746888085017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 375.240152465279, "episode_reward_min": -67.29765566358499, "episode_reward_mean": 116.91550630099155, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -729.7278933269423, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 149.2955775648082, "predator_policy": 718.4926496441976}, "policy_reward_mean": {"prey_policy": -192.3668676331432, "predator_policy": 250.82462078363878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.01596810581974, 245.13988888966955, 48.8999999999999, 42.26498793210075, 64.39815280233516, 160.25630919856, 72.33740718964721, -58.3382051360548, 91.26935732433819, 81.69193091144719, 34.589999999999804, 126.82000000000079, 103.73077544054276, 164.89227923665467, 36.42000000000006, 118.99649505526634, 155.93637418219623, 74.51317474206039, 125.8100000000003, 150.77755015814694, 235.08438518780875, 211.1204549478512, 19.313296478135502, 160.29999999999993, 62.14999999999997, 268.1268124598878, 100.4300000000001, 214.23782079153347, 136.63999999999993, 261.0008176024099, 88.62000000000101, 167.8410123152625, 144.35999999999973, 375.240152465279, 81.27704387464847, 26.25571773041105, -53.8821653709671, 165.68062910223242, 72.26000000000012, 161.4897911675657, 193.08872485069756, 250.2899999999998, 154.20505975663346, 192.6899999999995, 16.438159745302784, 37.24999999999999, 5.929999999999939, 58.52380945501188, 29.660000000000416, 174.80888631438413, 146.9739382241151, 44.05627669844669, -67.29765566358499, 215.8519260877467], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.889999999999986, -221.1205982280901, -592.2404926398783, -75.99145634673468, -718.0026496441976, -325.73425847527096, -45.42603236368234, -288.56624171820437, -9.384516076097185, -55.29147345787109, -398.42468290674555, -59.31375651793434, -298.83271461738366, 18.830000000000254, -516.4076425188676, -573.569059144404, -87.57520124612857, 22.37299736842012, -250.12623763831303, -320.3226332546506, -131.7258097513188, -234.30771239278022, -78.02376330684932, -42.30098045599001, -274.5775742920618, 27.74000000000017, -227.23903385341418, -372.86238024156916, -553.594180354726, -269.60078535743423, -208.8701985957096, -128.24937751457736, 2.0000000000000013, 50.45608346351276, 23.7800000000001, -696.7765120351366, -175.88686539242843, -517.5086177018968, -66.28323608712391, -71.9547856684458, -287.4744205729812, 65.36000000000055, -95.27368807438538, 30.710000000000264, -233.08781351521938, -441.22885830427435, -279.69923633734163, -40.2181944603569, -195.21986707846898, -301.70043506563246, -719.8910929971715, 37.63999999999971, -115.60164417844402, -350.0070723455467, 40.60999999999968, -729.7278933269423, 106.14216791105252, 26.750000000000274, -556.9504777260724, -19.062430353295234, -28.173907678262495, -29.671809572914388, -68.41907043052933, -283.1773774567748, -419.46156068937245, 77.9140711852952, -536.3698771762329, 2.0000000000000013, -248.7119924843601, 39.13349684415077, -29.02102421966911, -275.8718321842484, -453.0137657957607, -220.13099562585626, 140.24237044757, -385.4847524735488, -270.16683201467595, -327.1328896516476, 30.71, -713.6813435042426, -94.55768117688606, -241.01550387242185, 149.2955775648082, 52.07413456400835, -352.4712460454161, -310.47609768705735, 44.829365985822655, 23.77937970960075, -1.587529707048596, -223.1656174915792, -88.57912874145296, -39.05929057383554, -195.98482852554193, -84.07880802984658, -168.9258312895003, -344.0024235680181, -99.21672765276541, -334.4999417904819, 2.0000000000000013, -155.01488373126213, -260.70763544394566, 69.32, -270.8039259677224, -278.7328291941744, -281.2822866085928, -207.72835916696962, -407.52715806903717, 106.94000000000017], "policy_predator_policy_reward": [144.16153591100874, 187.08503042289905, 422.2039713073229, 491.1678665689596, 718.4926496441976, 374.1442584752706, 64.72102029578312, 311.5362417182047, 100.40899969406368, 28.665142642240497, 202.88233297975663, 415.11241564348245, 301.1819265929933, 51.158195214037036, 610.6382647950129, 421.0002317322039, 53.56082633510378, 102.91073486694265, 228.7007647191023, 423.44003708530795, 133.21580975131928, 267.4077123927792, 81.65376330684998, 165.49098045599, 132.32505384509432, 218.24329588750848, 212.56021433649943, 552.4334789951381, 588.744180354726, 270.8707853574331, 249.1489956682878, 206.96707549726452, 47.17191544639211, 56.30837527229157, 486.67828820218574, 260.831398575011, 246.48686539242834, 572.7186177018966, 60.98492105488214, 228.03065085883412, 254.01530442888966, 203.1835013319016, 66.66752518882522, 209.01661783341146, 95.53560905730107, 598.094359240328, 280.9292363373416, 199.28819446035683, 247.15986707846812, 311.91043506563136, 573.1203638303407, 377.2575416267197, 477.1321819027128, 88.90653462127793, 684.4448752036382, 218.91083891483885, 0.0, 3.7478320889476002, 222.24810248571404, 614.7656231960638, 116.42180957291454, 30.043907678262773, 508.46177798866313, 10.975682213903427, 2.1113670469560266, 483.79612245712144, 466.38661353365916, 443.2234161078541, 71.66793427490836, 219.18760523994743, 225.46062156227555, 105.68795257205184, 562.2633394669932, 56.99925658365541, 9.776987723421676, 401.1460234047895, 340.3968320146759, 329.16288965164745, 491.49805821507795, 352.96307645673085, 430.8994591288141, 97.76245077119182, 16.17586543599158, 32.74442243519179, 427.62161114325596, 389.53079234585044, 102.4006340141773, 21.680620290399293, 160.08422729559874, 81.10707964833244, 102.47471499400703, 62.41370432128184, 87.70880802984742, 198.28482852554077, 220.4718901567184, 350.9801741558106, 127.65672765276615, 335.7199417904808, 85.91705638565394, 241.90671365999233, 153.53338139525005, 184.82819227280947, 278.6091171123913, 314.983914747951, 85.40996081412725, 336.30302929784705, 336.4357107022496, 180.0033734545345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2161072084726148, "mean_inference_ms": 5.426758546353718, "mean_action_processing_ms": 0.8582905334504939, "mean_env_wait_ms": 0.698810438738848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01237105440210413, "StateBufferConnector_ms": 0.0129225077452483, "ViewRequirementAgentConnector_ms": 0.3303611720049823}, "num_episodes": 18, "episode_return_max": 375.240152465279, "episode_return_min": -67.29765566358499, "episode_return_mean": 116.91550630099155, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.87849764003045, "num_env_steps_trained_throughput_per_sec": 421.87849764003045, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14385.421, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14385.367, "sample_time_ms": 3433.32, "learn_time_ms": 10939.301, "learn_throughput": 365.654, "synch_weights_time_ms": 11.939}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "1f15c_00000", "date": "2024-08-16_14-03-57", "timestamp": 1723797237, "time_this_iter_s": 9.484511852264404, "time_total_s": 43.165043592453, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f800940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43.165043592453, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.576923076923073, "ram_util_percent": 70.73076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2699697140663389, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.449172998357702, "policy_loss": -0.009976734309186223, "vf_loss": 4.4567784131519375, "vf_explained_var": 0.0040320641149288764, "kl": 0.011856593026472358, "entropy": 1.5807126280491945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5915949025797465, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.852382352112462, "policy_loss": -0.0071335279114209315, "vf_loss": 7.858622130641231, "vf_explained_var": 0.04543978515125456, "kl": 0.008937450288825996, "entropy": 1.5575496811715384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 375.240152465279, "episode_reward_min": -67.29765566358499, "episode_reward_mean": 137.73977055867493, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -729.7278933269423, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.2, "predator_policy": 718.4926496441976}, "policy_reward_mean": {"prey_policy": -155.6861466135381, "predator_policy": 224.55603189287547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.01596810581974, 245.13988888966955, 48.8999999999999, 42.26498793210075, 64.39815280233516, 160.25630919856, 72.33740718964721, -58.3382051360548, 91.26935732433819, 81.69193091144719, 34.589999999999804, 126.82000000000079, 103.73077544054276, 164.89227923665467, 36.42000000000006, 118.99649505526634, 155.93637418219623, 74.51317474206039, 125.8100000000003, 150.77755015814694, 235.08438518780875, 211.1204549478512, 19.313296478135502, 160.29999999999993, 62.14999999999997, 268.1268124598878, 100.4300000000001, 214.23782079153347, 136.63999999999993, 261.0008176024099, 88.62000000000101, 167.8410123152625, 144.35999999999973, 375.240152465279, 81.27704387464847, 26.25571773041105, -53.8821653709671, 165.68062910223242, 72.26000000000012, 161.4897911675657, 193.08872485069756, 250.2899999999998, 154.20505975663346, 192.6899999999995, 16.438159745302784, 37.24999999999999, 5.929999999999939, 58.52380945501188, 29.660000000000416, 174.80888631438413, 146.9739382241151, 44.05627669844669, -67.29765566358499, 215.8519260877467, 238.01898676648676, 240.3438736283289, 368.69064853921225, 229.95038867647608, 241.6389356996188, 108.69000000000027, 142.5300000000001, 163.45000000000016, 202.0400000000003, 136.14818851786367, 342.7326514413532, 147.0200000000002, 35.85984758460833, 182.03346388344215, 93.04000000000092, 221.8699999999999, 189.90794426465942, 319.8612109690009], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.889999999999986, -221.1205982280901, -592.2404926398783, -75.99145634673468, -718.0026496441976, -325.73425847527096, -45.42603236368234, -288.56624171820437, -9.384516076097185, -55.29147345787109, -398.42468290674555, -59.31375651793434, -298.83271461738366, 18.830000000000254, -516.4076425188676, -573.569059144404, -87.57520124612857, 22.37299736842012, -250.12623763831303, -320.3226332546506, -131.7258097513188, -234.30771239278022, -78.02376330684932, -42.30098045599001, -274.5775742920618, 27.74000000000017, -227.23903385341418, -372.86238024156916, -553.594180354726, -269.60078535743423, -208.8701985957096, -128.24937751457736, 2.0000000000000013, 50.45608346351276, 23.7800000000001, -696.7765120351366, -175.88686539242843, -517.5086177018968, -66.28323608712391, -71.9547856684458, -287.4744205729812, 65.36000000000055, -95.27368807438538, 30.710000000000264, -233.08781351521938, -441.22885830427435, -279.69923633734163, -40.2181944603569, -195.21986707846898, -301.70043506563246, -719.8910929971715, 37.63999999999971, -115.60164417844402, -350.0070723455467, 40.60999999999968, -729.7278933269423, 106.14216791105252, 26.750000000000274, -556.9504777260724, -19.062430353295234, -28.173907678262495, -29.671809572914388, -68.41907043052933, -283.1773774567748, -419.46156068937245, 77.9140711852952, -536.3698771762329, 2.0000000000000013, -248.7119924843601, 39.13349684415077, -29.02102421966911, -275.8718321842484, -453.0137657957607, -220.13099562585626, 140.24237044757, -385.4847524735488, -270.16683201467595, -327.1328896516476, 30.71, -713.6813435042426, -94.55768117688606, -241.01550387242185, 149.2955775648082, 52.07413456400835, -352.4712460454161, -310.47609768705735, 44.829365985822655, 23.77937970960075, -1.587529707048596, -223.1656174915792, -88.57912874145296, -39.05929057383554, -195.98482852554193, -84.07880802984658, -168.9258312895003, -344.0024235680181, -99.21672765276541, -334.4999417904819, 2.0000000000000013, -155.01488373126213, -260.70763544394566, 69.32, -270.8039259677224, -278.7328291941744, -281.2822866085928, -207.72835916696962, -407.52715806903717, 106.94000000000017, 56.566196108116586, -31.349849484457046, -49.08858989265433, 24.65736919916274, 180.2, -58.09925382043077, 139.4006512828763, -78.38695296795603, 62.38999999999972, -88.33504123287382, -270.4440969017817, -61.95746230277373, -343.5148812027071, 67.78662926179538, 51.78472449892006, -218.8624036832214, -104.6866258031641, 47.65419674750956, 2.0000000000000013, 3.6763130468468006, 147.52999999999997, -653.3096667714211, -10.137715406284086, -153.9571321454717, -215.21447034365056, -60.81201540862687, -214.75609308657334, -52.23410102398124, 2.0000000000000013, 80.19531538667336, -22.329304812844207, 36.99833265133257, -146.46882139697004, 130.48483973784602, 146.65396500403116, 10.782536792703791], "policy_predator_policy_reward": [144.16153591100874, 187.08503042289905, 422.2039713073229, 491.1678665689596, 718.4926496441976, 374.1442584752706, 64.72102029578312, 311.5362417182047, 100.40899969406368, 28.665142642240497, 202.88233297975663, 415.11241564348245, 301.1819265929933, 51.158195214037036, 610.6382647950129, 421.0002317322039, 53.56082633510378, 102.91073486694265, 228.7007647191023, 423.44003708530795, 133.21580975131928, 267.4077123927792, 81.65376330684998, 165.49098045599, 132.32505384509432, 218.24329588750848, 212.56021433649943, 552.4334789951381, 588.744180354726, 270.8707853574331, 249.1489956682878, 206.96707549726452, 47.17191544639211, 56.30837527229157, 486.67828820218574, 260.831398575011, 246.48686539242834, 572.7186177018966, 60.98492105488214, 228.03065085883412, 254.01530442888966, 203.1835013319016, 66.66752518882522, 209.01661783341146, 95.53560905730107, 598.094359240328, 280.9292363373416, 199.28819446035683, 247.15986707846812, 311.91043506563136, 573.1203638303407, 377.2575416267197, 477.1321819027128, 88.90653462127793, 684.4448752036382, 218.91083891483885, 0.0, 3.7478320889476002, 222.24810248571404, 614.7656231960638, 116.42180957291454, 30.043907678262773, 508.46177798866313, 10.975682213903427, 2.1113670469560266, 483.79612245712144, 466.38661353365916, 443.2234161078541, 71.66793427490836, 219.18760523994743, 225.46062156227555, 105.68795257205184, 562.2633394669932, 56.99925658365541, 9.776987723421676, 401.1460234047895, 340.3968320146759, 329.16288965164745, 491.49805821507795, 352.96307645673085, 430.8994591288141, 97.76245077119182, 16.17586543599158, 32.74442243519179, 427.62161114325596, 389.53079234585044, 102.4006340141773, 21.680620290399293, 160.08422729559874, 81.10707964833244, 102.47471499400703, 62.41370432128184, 87.70880802984742, 198.28482852554077, 220.4718901567184, 350.9801741558106, 127.65672765276615, 335.7199417904808, 85.91705638565394, 241.90671365999233, 153.53338139525005, 184.82819227280947, 278.6091171123913, 314.983914747951, 85.40996081412725, 336.30302929784705, 336.4357107022496, 180.0033734545345, 41.14288667215589, 171.65975347067157, 81.33709843662453, 183.43799588519622, 135.06909720572853, 111.52080515391492, 19.34888514701602, 149.5878052145391, 144.10022045709326, 123.48375647540048, 213.1021805729194, 227.98937863163562, 73.64337073820462, 344.6148812027061, 151.48896960097971, 179.0387095833221, 102.5715621027716, 156.50086695288314, 45.704415767787175, 84.76745970323024, 272.46893170321863, 576.0433865095561, 299.0371321454716, 12.077715406284044, 70.78142930483615, 241.10490403204966, 230.6028762921307, 218.4207817018658, 10.844684613327066, 0.0, 128.1961537741139, 79.00481838739789, 187.83398165912246, 18.057944264659636, 132.50004691101546, 29.924662261250447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0281172796829776, "mean_inference_ms": 4.964949779729215, "mean_action_processing_ms": 0.7906605155288858, "mean_env_wait_ms": 0.6413917642654597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010763274298773872, "StateBufferConnector_ms": 0.010411938031514486, "ViewRequirementAgentConnector_ms": 0.2679096327887641}, "num_episodes": 18, "episode_return_max": 375.240152465279, "episode_return_min": -67.29765566358499, "episode_return_mean": 137.73977055867493, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.25415173723763, "num_env_steps_trained_throughput_per_sec": 435.25415173723763, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13086.576, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13086.527, "sample_time_ms": 2821.873, "learn_time_ms": 10252.193, "learn_throughput": 390.16, "synch_weights_time_ms": 11.619}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "1f15c_00000", "date": "2024-08-16_14-04-06", "timestamp": 1723797246, "time_this_iter_s": 9.192821979522705, "time_total_s": 52.35786557197571, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f874790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.35786557197571, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.49230769230769, "ram_util_percent": 70.77692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1531455950289176, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.017438052697156, "policy_loss": -0.008737415324147573, "vf_loss": 4.02482183938304, "vf_explained_var": 0.005856952875379532, "kl": 0.006768161243375002, "entropy": 1.5613361902337857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7312595474341559, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.805804143380866, "policy_loss": -0.009715728815423236, "vf_loss": 8.81433133523931, "vf_explained_var": 0.03203615489460173, "kl": 0.01188535006902989, "entropy": 1.5525796380623307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 378.6395284657283, "episode_reward_min": -67.29765566358499, "episode_reward_mean": 153.88453322742018, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -729.7278933269423, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.05999999999995, "predator_policy": 739.0928675078676}, "policy_reward_mean": {"prey_policy": -135.26405086756372, "predator_policy": 212.20631748127374}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.01596810581974, 245.13988888966955, 48.8999999999999, 42.26498793210075, 64.39815280233516, 160.25630919856, 72.33740718964721, -58.3382051360548, 91.26935732433819, 81.69193091144719, 34.589999999999804, 126.82000000000079, 103.73077544054276, 164.89227923665467, 36.42000000000006, 118.99649505526634, 155.93637418219623, 74.51317474206039, 125.8100000000003, 150.77755015814694, 235.08438518780875, 211.1204549478512, 19.313296478135502, 160.29999999999993, 62.14999999999997, 268.1268124598878, 100.4300000000001, 214.23782079153347, 136.63999999999993, 261.0008176024099, 88.62000000000101, 167.8410123152625, 144.35999999999973, 375.240152465279, 81.27704387464847, 26.25571773041105, -53.8821653709671, 165.68062910223242, 72.26000000000012, 161.4897911675657, 193.08872485069756, 250.2899999999998, 154.20505975663346, 192.6899999999995, 16.438159745302784, 37.24999999999999, 5.929999999999939, 58.52380945501188, 29.660000000000416, 174.80888631438413, 146.9739382241151, 44.05627669844669, -67.29765566358499, 215.8519260877467, 238.01898676648676, 240.3438736283289, 368.69064853921225, 229.95038867647608, 241.6389356996188, 108.69000000000027, 142.5300000000001, 163.45000000000016, 202.0400000000003, 136.14818851786367, 342.7326514413532, 147.0200000000002, 35.85984758460833, 182.03346388344215, 93.04000000000092, 221.8699999999999, 189.90794426465942, 319.8612109690009, 147.0400000000003, 356.2696204126378, 378.6395284657283, 203.91999999999945, 266.0499999999997, 223.92548955561915, 204.61151501062335, 209.729960506224, 89.13004715947483, 30.527545285052703, 135.90199038982666, 228.77808610797143, 120.9800000000002, 300.9692394816743, 174.19302674703974, 88.3764689006522, 259.4911991768002, 278.6211277537568, 42.69484720167477, 76.84330968441, 366.55149456641806, 219.3848959926022, 165.98, 142.14832274654725, 285.10854853077007, 98.60904561449712, 222.8299999999997], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.889999999999986, -221.1205982280901, -592.2404926398783, -75.99145634673468, -718.0026496441976, -325.73425847527096, -45.42603236368234, -288.56624171820437, -9.384516076097185, -55.29147345787109, -398.42468290674555, -59.31375651793434, -298.83271461738366, 18.830000000000254, -516.4076425188676, -573.569059144404, -87.57520124612857, 22.37299736842012, -250.12623763831303, -320.3226332546506, -131.7258097513188, -234.30771239278022, -78.02376330684932, -42.30098045599001, -274.5775742920618, 27.74000000000017, -227.23903385341418, -372.86238024156916, -553.594180354726, -269.60078535743423, -208.8701985957096, -128.24937751457736, 2.0000000000000013, 50.45608346351276, 23.7800000000001, -696.7765120351366, -175.88686539242843, -517.5086177018968, -66.28323608712391, -71.9547856684458, -287.4744205729812, 65.36000000000055, -95.27368807438538, 30.710000000000264, -233.08781351521938, -441.22885830427435, -279.69923633734163, -40.2181944603569, -195.21986707846898, -301.70043506563246, -719.8910929971715, 37.63999999999971, -115.60164417844402, -350.0070723455467, 40.60999999999968, -729.7278933269423, 106.14216791105252, 26.750000000000274, -556.9504777260724, -19.062430353295234, -28.173907678262495, -29.671809572914388, -68.41907043052933, -283.1773774567748, -419.46156068937245, 77.9140711852952, -536.3698771762329, 2.0000000000000013, -248.7119924843601, 39.13349684415077, -29.02102421966911, -275.8718321842484, -453.0137657957607, -220.13099562585626, 140.24237044757, -385.4847524735488, -270.16683201467595, -327.1328896516476, 30.71, -713.6813435042426, -94.55768117688606, -241.01550387242185, 149.2955775648082, 52.07413456400835, -352.4712460454161, -310.47609768705735, 44.829365985822655, 23.77937970960075, -1.587529707048596, -223.1656174915792, -88.57912874145296, -39.05929057383554, -195.98482852554193, -84.07880802984658, -168.9258312895003, -344.0024235680181, -99.21672765276541, -334.4999417904819, 2.0000000000000013, -155.01488373126213, -260.70763544394566, 69.32, -270.8039259677224, -278.7328291941744, -281.2822866085928, -207.72835916696962, -407.52715806903717, 106.94000000000017, 56.566196108116586, -31.349849484457046, -49.08858989265433, 24.65736919916274, 180.2, -58.09925382043077, 139.4006512828763, -78.38695296795603, 62.38999999999972, -88.33504123287382, -270.4440969017817, -61.95746230277373, -343.5148812027071, 67.78662926179538, 51.78472449892006, -218.8624036832214, -104.6866258031641, 47.65419674750956, 2.0000000000000013, 3.6763130468468006, 147.52999999999997, -653.3096667714211, -10.137715406284086, -153.9571321454717, -215.21447034365056, -60.81201540862687, -214.75609308657334, -52.23410102398124, 2.0000000000000013, 80.19531538667336, -22.329304812844207, 36.99833265133257, -146.46882139697004, 130.48483973784602, 146.65396500403116, 10.782536792703791, -23.981710211877157, 38.91308880108002, 35.47615290412443, 5.134774640461838, 61.756670900844085, 150.5, 23.780000000000253, 169.76231497291099, 110.2050696444085, 75.21076650508309, -51.645788022251075, 81.56062347724713, -383.26076241383043, -45.686724901710875, -579.8437311371317, 100.88197293892743, -95.78007537036157, -242.0469604527441, -282.21763953629664, -532.913167742132, 3.980000000000001, -237.97512847205826, 111.14901121811539, 11.89999999999997, 29.56253582680649, -228.1208735557325, 6.72624508125655, 123.01132738902132, -456.02213128600613, -26.35757538556695, -191.0884645032, -55.21839998620409, 88.47197076400938, 73.3671023749049, -1.8771493062579765, 145.98213735316227, -194.8757431922651, -154.7497186815606, -569.0353113597746, -399.5118309711562, 50.61778008825375, 194.05999999999995, -327.56874754628603, 94.07, 62.514415604910866, -517.8424995847032, -293.51635975166613, -181.52325596282444, 25.77631410405955, -36.58269911432137, -94.66000475367049, 33.64021697954937, -77.11107674598631, 9.526078950311469], "policy_predator_policy_reward": [144.16153591100874, 187.08503042289905, 422.2039713073229, 491.1678665689596, 718.4926496441976, 374.1442584752706, 64.72102029578312, 311.5362417182047, 100.40899969406368, 28.665142642240497, 202.88233297975663, 415.11241564348245, 301.1819265929933, 51.158195214037036, 610.6382647950129, 421.0002317322039, 53.56082633510378, 102.91073486694265, 228.7007647191023, 423.44003708530795, 133.21580975131928, 267.4077123927792, 81.65376330684998, 165.49098045599, 132.32505384509432, 218.24329588750848, 212.56021433649943, 552.4334789951381, 588.744180354726, 270.8707853574331, 249.1489956682878, 206.96707549726452, 47.17191544639211, 56.30837527229157, 486.67828820218574, 260.831398575011, 246.48686539242834, 572.7186177018966, 60.98492105488214, 228.03065085883412, 254.01530442888966, 203.1835013319016, 66.66752518882522, 209.01661783341146, 95.53560905730107, 598.094359240328, 280.9292363373416, 199.28819446035683, 247.15986707846812, 311.91043506563136, 573.1203638303407, 377.2575416267197, 477.1321819027128, 88.90653462127793, 684.4448752036382, 218.91083891483885, 0.0, 3.7478320889476002, 222.24810248571404, 614.7656231960638, 116.42180957291454, 30.043907678262773, 508.46177798866313, 10.975682213903427, 2.1113670469560266, 483.79612245712144, 466.38661353365916, 443.2234161078541, 71.66793427490836, 219.18760523994743, 225.46062156227555, 105.68795257205184, 562.2633394669932, 56.99925658365541, 9.776987723421676, 401.1460234047895, 340.3968320146759, 329.16288965164745, 491.49805821507795, 352.96307645673085, 430.8994591288141, 97.76245077119182, 16.17586543599158, 32.74442243519179, 427.62161114325596, 389.53079234585044, 102.4006340141773, 21.680620290399293, 160.08422729559874, 81.10707964833244, 102.47471499400703, 62.41370432128184, 87.70880802984742, 198.28482852554077, 220.4718901567184, 350.9801741558106, 127.65672765276615, 335.7199417904808, 85.91705638565394, 241.90671365999233, 153.53338139525005, 184.82819227280947, 278.6091171123913, 314.983914747951, 85.40996081412725, 336.30302929784705, 336.4357107022496, 180.0033734545345, 41.14288667215589, 171.65975347067157, 81.33709843662453, 183.43799588519622, 135.06909720572853, 111.52080515391492, 19.34888514701602, 149.5878052145391, 144.10022045709326, 123.48375647540048, 213.1021805729194, 227.98937863163562, 73.64337073820462, 344.6148812027061, 151.48896960097971, 179.0387095833221, 102.5715621027716, 156.50086695288314, 45.704415767787175, 84.76745970323024, 272.46893170321863, 576.0433865095561, 299.0371321454716, 12.077715406284044, 70.78142930483615, 241.10490403204966, 230.6028762921307, 218.4207817018658, 10.844684613327066, 0.0, 128.1961537741139, 79.00481838739789, 187.83398165912246, 18.057944264659636, 132.50004691101546, 29.924662261250447, 64.36171021187688, 67.74691119891985, 151.70477045840863, 163.95392240964284, 60.39586119112416, 105.98699637375998, 10.37768502708889, 0.0, 43.10915689034542, 37.52500696016307, 29.814866078372273, 164.1957880222506, 195.57142140886148, 437.9875809173026, 621.8737311371318, 66.81798756729654, 51.12809693363877, 375.8289860489413, 739.0928675078676, 106.5654850556132, 319.0703874583422, 50.82673140354289, 50.1525163377877, 55.576558552069095, 299.62770930481565, 19.910628424108936, 46.49679692759312, 124.73487008380359, 42.73267783278938, 613.8400555858233, 198.91789446093347, 135.7654389291218, 12.706599633512603, 84.94552640437341, 80.7727033916141, 53.743436315238455, 92.38026547845475, 299.9400435970452, 395.5520487205585, 649.8384032947814, 45.71922590717407, 76.15448857099028, 425.89225213476135, 26.991391404126876, 590.8624995847033, 30.445584395089273, 311.2190608129257, 305.96887764811066, 152.43847597177853, 143.47645756925405, 155.32801236582728, 4.300821022791677, 100.10392104968864, 190.31107674598627]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.820766894478906, "mean_inference_ms": 4.456039811818842, "mean_action_processing_ms": 0.7143154058017486, "mean_env_wait_ms": 0.5775898532784336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009143472921968711, "StateBufferConnector_ms": 0.008337666289974946, "ViewRequirementAgentConnector_ms": 0.216642895130196}, "num_episodes": 27, "episode_return_max": 378.6395284657283, "episode_return_min": -67.29765566358499, "episode_return_mean": 153.88453322742018, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.1815753376657, "num_env_steps_trained_throughput_per_sec": 443.1815753376657, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12274.391, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12274.345, "sample_time_ms": 2444.939, "learn_time_ms": 9816.917, "learn_throughput": 407.46, "synch_weights_time_ms": 11.678}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "1f15c_00000", "date": "2024-08-16_14-04-15", "timestamp": 1723797255, "time_this_iter_s": 9.028427124023438, "time_total_s": 61.386292695999146, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f87dca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.386292695999146, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.23076923076923, "ram_util_percent": 70.60769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.622912115142459, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.136744873359721, "policy_loss": -0.009819962832061623, "vf_loss": 6.1443811489791464, "vf_explained_var": 0.004714147029099641, "kl": 0.010918434993431057, "entropy": 1.553522021492953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.857773800470211, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.193376837331781, "policy_loss": -0.005094874145650359, "vf_loss": 9.197681919481388, "vf_explained_var": 0.02088178698978727, "kl": 0.007898143976499884, "entropy": 1.5466913819313048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 445.7062737314187, "episode_reward_min": -67.29765566358499, "episode_reward_mean": 173.5908874541613, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -729.7278933269423, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.05999999999995, "predator_policy": 739.0928675078676}, "policy_reward_mean": {"prey_policy": -115.60558620986326, "predator_policy": 202.40102993694381}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.51317474206039, 125.8100000000003, 150.77755015814694, 235.08438518780875, 211.1204549478512, 19.313296478135502, 160.29999999999993, 62.14999999999997, 268.1268124598878, 100.4300000000001, 214.23782079153347, 136.63999999999993, 261.0008176024099, 88.62000000000101, 167.8410123152625, 144.35999999999973, 375.240152465279, 81.27704387464847, 26.25571773041105, -53.8821653709671, 165.68062910223242, 72.26000000000012, 161.4897911675657, 193.08872485069756, 250.2899999999998, 154.20505975663346, 192.6899999999995, 16.438159745302784, 37.24999999999999, 5.929999999999939, 58.52380945501188, 29.660000000000416, 174.80888631438413, 146.9739382241151, 44.05627669844669, -67.29765566358499, 215.8519260877467, 238.01898676648676, 240.3438736283289, 368.69064853921225, 229.95038867647608, 241.6389356996188, 108.69000000000027, 142.5300000000001, 163.45000000000016, 202.0400000000003, 136.14818851786367, 342.7326514413532, 147.0200000000002, 35.85984758460833, 182.03346388344215, 93.04000000000092, 221.8699999999999, 189.90794426465942, 319.8612109690009, 147.0400000000003, 356.2696204126378, 378.6395284657283, 203.91999999999945, 266.0499999999997, 223.92548955561915, 204.61151501062335, 209.729960506224, 89.13004715947483, 30.527545285052703, 135.90199038982666, 228.77808610797143, 120.9800000000002, 300.9692394816743, 174.19302674703974, 88.3764689006522, 259.4911991768002, 278.6211277537568, 42.69484720167477, 76.84330968441, 366.55149456641806, 219.3848959926022, 165.98, 142.14832274654725, 285.10854853077007, 98.60904561449712, 222.8299999999997, 233.4347898687724, 339.5503654607452, 445.7062737314187, 218.2214569966929, 220.99882810019767, 188.36960289160672, 310.92012250002296, 261.2575660860556, 270.0699999999998, 217.85999999999984, 230.31291779124922, 157.86633627116964, 101.26483548167941, -62.58907309282246, 114.90000000000042, 131.34707086591368, 257.44762743006424, 99.90295665128991], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [23.7800000000001, -696.7765120351366, -175.88686539242843, -517.5086177018968, -66.28323608712391, -71.9547856684458, -287.4744205729812, 65.36000000000055, -95.27368807438538, 30.710000000000264, -233.08781351521938, -441.22885830427435, -279.69923633734163, -40.2181944603569, -195.21986707846898, -301.70043506563246, -719.8910929971715, 37.63999999999971, -115.60164417844402, -350.0070723455467, 40.60999999999968, -729.7278933269423, 106.14216791105252, 26.750000000000274, -556.9504777260724, -19.062430353295234, -28.173907678262495, -29.671809572914388, -68.41907043052933, -283.1773774567748, -419.46156068937245, 77.9140711852952, -536.3698771762329, 2.0000000000000013, -248.7119924843601, 39.13349684415077, -29.02102421966911, -275.8718321842484, -453.0137657957607, -220.13099562585626, 140.24237044757, -385.4847524735488, -270.16683201467595, -327.1328896516476, 30.71, -713.6813435042426, -94.55768117688606, -241.01550387242185, 149.2955775648082, 52.07413456400835, -352.4712460454161, -310.47609768705735, 44.829365985822655, 23.77937970960075, -1.587529707048596, -223.1656174915792, -88.57912874145296, -39.05929057383554, -195.98482852554193, -84.07880802984658, -168.9258312895003, -344.0024235680181, -99.21672765276541, -334.4999417904819, 2.0000000000000013, -155.01488373126213, -260.70763544394566, 69.32, -270.8039259677224, -278.7328291941744, -281.2822866085928, -207.72835916696962, -407.52715806903717, 106.94000000000017, 56.566196108116586, -31.349849484457046, -49.08858989265433, 24.65736919916274, 180.2, -58.09925382043077, 139.4006512828763, -78.38695296795603, 62.38999999999972, -88.33504123287382, -270.4440969017817, -61.95746230277373, -343.5148812027071, 67.78662926179538, 51.78472449892006, -218.8624036832214, -104.6866258031641, 47.65419674750956, 2.0000000000000013, 3.6763130468468006, 147.52999999999997, -653.3096667714211, -10.137715406284086, -153.9571321454717, -215.21447034365056, -60.81201540862687, -214.75609308657334, -52.23410102398124, 2.0000000000000013, 80.19531538667336, -22.329304812844207, 36.99833265133257, -146.46882139697004, 130.48483973784602, 146.65396500403116, 10.782536792703791, -23.981710211877157, 38.91308880108002, 35.47615290412443, 5.134774640461838, 61.756670900844085, 150.5, 23.780000000000253, 169.76231497291099, 110.2050696444085, 75.21076650508309, -51.645788022251075, 81.56062347724713, -383.26076241383043, -45.686724901710875, -579.8437311371317, 100.88197293892743, -95.78007537036157, -242.0469604527441, -282.21763953629664, -532.913167742132, 3.980000000000001, -237.97512847205826, 111.14901121811539, 11.89999999999997, 29.56253582680649, -228.1208735557325, 6.72624508125655, 123.01132738902132, -456.02213128600613, -26.35757538556695, -191.0884645032, -55.21839998620409, 88.47197076400938, 73.3671023749049, -1.8771493062579765, 145.98213735316227, -194.8757431922651, -154.7497186815606, -569.0353113597746, -399.5118309711562, 50.61778008825375, 194.05999999999995, -327.56874754628603, 94.07, 62.514415604910866, -517.8424995847032, -293.51635975166613, -181.52325596282444, 25.77631410405955, -36.58269911432137, -94.66000475367049, 33.64021697954937, -77.11107674598631, 9.526078950311469, -263.03778007010317, -300.8382502513199, 115.03521129584945, 177.23000000000013, -167.5105024842706, 169.3099999999999, 1.3377683446929391, -146.03962608361266, -101.03814759764522, 123.65708370357667, -328.5669498679954, -12.2362174489936, 189.96647954615608, -73.07659916969759, -163.7249601426217, -101.60055606917956, 178.57001213019663, 26.38464470486403, -5.95418665815394, -187.748783650524, -167.60650253010598, 110.4595773327521, -147.8621828811819, -75.1813509824128, -196.82667052511405, -214.71044655825932, -455.46137979990783, -302.0651435863292, -153.78740557182138, 23.610735216155923, -375.01537708728216, -273.3523025909896, -122.31213948703106, 80.40141859087198, -83.62369109823413, -339.01331094631854], "policy_predator_policy_reward": [486.67828820218574, 260.831398575011, 246.48686539242834, 572.7186177018966, 60.98492105488214, 228.03065085883412, 254.01530442888966, 203.1835013319016, 66.66752518882522, 209.01661783341146, 95.53560905730107, 598.094359240328, 280.9292363373416, 199.28819446035683, 247.15986707846812, 311.91043506563136, 573.1203638303407, 377.2575416267197, 477.1321819027128, 88.90653462127793, 684.4448752036382, 218.91083891483885, 0.0, 3.7478320889476002, 222.24810248571404, 614.7656231960638, 116.42180957291454, 30.043907678262773, 508.46177798866313, 10.975682213903427, 2.1113670469560266, 483.79612245712144, 466.38661353365916, 443.2234161078541, 71.66793427490836, 219.18760523994743, 225.46062156227555, 105.68795257205184, 562.2633394669932, 56.99925658365541, 9.776987723421676, 401.1460234047895, 340.3968320146759, 329.16288965164745, 491.49805821507795, 352.96307645673085, 430.8994591288141, 97.76245077119182, 16.17586543599158, 32.74442243519179, 427.62161114325596, 389.53079234585044, 102.4006340141773, 21.680620290399293, 160.08422729559874, 81.10707964833244, 102.47471499400703, 62.41370432128184, 87.70880802984742, 198.28482852554077, 220.4718901567184, 350.9801741558106, 127.65672765276615, 335.7199417904808, 85.91705638565394, 241.90671365999233, 153.53338139525005, 184.82819227280947, 278.6091171123913, 314.983914747951, 85.40996081412725, 336.30302929784705, 336.4357107022496, 180.0033734545345, 41.14288667215589, 171.65975347067157, 81.33709843662453, 183.43799588519622, 135.06909720572853, 111.52080515391492, 19.34888514701602, 149.5878052145391, 144.10022045709326, 123.48375647540048, 213.1021805729194, 227.98937863163562, 73.64337073820462, 344.6148812027061, 151.48896960097971, 179.0387095833221, 102.5715621027716, 156.50086695288314, 45.704415767787175, 84.76745970323024, 272.46893170321863, 576.0433865095561, 299.0371321454716, 12.077715406284044, 70.78142930483615, 241.10490403204966, 230.6028762921307, 218.4207817018658, 10.844684613327066, 0.0, 128.1961537741139, 79.00481838739789, 187.83398165912246, 18.057944264659636, 132.50004691101546, 29.924662261250447, 64.36171021187688, 67.74691119891985, 151.70477045840863, 163.95392240964284, 60.39586119112416, 105.98699637375998, 10.37768502708889, 0.0, 43.10915689034542, 37.52500696016307, 29.814866078372273, 164.1957880222506, 195.57142140886148, 437.9875809173026, 621.8737311371318, 66.81798756729654, 51.12809693363877, 375.8289860489413, 739.0928675078676, 106.5654850556132, 319.0703874583422, 50.82673140354289, 50.1525163377877, 55.576558552069095, 299.62770930481565, 19.910628424108936, 46.49679692759312, 124.73487008380359, 42.73267783278938, 613.8400555858233, 198.91789446093347, 135.7654389291218, 12.706599633512603, 84.94552640437341, 80.7727033916141, 53.743436315238455, 92.38026547845475, 299.9400435970452, 395.5520487205585, 649.8384032947814, 45.71922590717407, 76.15448857099028, 425.89225213476135, 26.991391404126876, 590.8624995847033, 30.445584395089273, 311.2190608129257, 305.96887764811066, 152.43847597177853, 143.47645756925405, 155.32801236582728, 4.300821022791677, 100.10392104968864, 190.31107674598627, 301.42625234996603, 495.88456784022975, 2.1003654607453734, 45.18478870415053, 216.11049765891144, 227.7962785567782, 244.42318872011688, 118.50012601549577, 3.9717443966209482, 194.40814759764544, 358.6318544621606, 170.5409157464351, 154.4769610075173, 39.55328111604696, 478.25108040750905, 48.33200189034806, 61.43003824940422, 3.6853049155349877, 197.64292921894943, 213.920041089728, 256.68900991859726, 30.770833070005793, 133.43018946485685, 247.4796806699076, 125.14517358422857, 387.6567789808244, 92.49454338629, 602.4429069071244, 155.19740557182016, 89.87926478384428, 466.07474842835956, 313.6400021158258, 243.2558217599856, 56.10252656623788, 290.7780100480784, 231.76194864776366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5885826311185187, "mean_inference_ms": 3.878056842343694, "mean_action_processing_ms": 0.6331997028555384, "mean_env_wait_ms": 0.5061910328778118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007143855094909668, "StateBufferConnector_ms": 0.005287766456604004, "ViewRequirementAgentConnector_ms": 0.1507657766342163}, "num_episodes": 18, "episode_return_max": 445.7062737314187, "episode_return_min": -67.29765566358499, "episode_return_mean": 173.5908874541613, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.96031666009765, "num_env_steps_trained_throughput_per_sec": 416.96031666009765, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 11827.533, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11827.49, "sample_time_ms": 2214.896, "learn_time_ms": 9600.248, "learn_throughput": 416.656, "synch_weights_time_ms": 11.556}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "1f15c_00000", "date": "2024-08-16_14-04-25", "timestamp": 1723797265, "time_this_iter_s": 9.596570253372192, "time_total_s": 70.98286294937134, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8663a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.98286294937134, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.692857142857143, "ram_util_percent": 70.36428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5141718874848078, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.364809117746101, "policy_loss": -0.009694388035620765, "vf_loss": 6.371859636508598, "vf_explained_var": 0.004038799439788496, "kl": 0.01321931532763383, "entropy": 1.531138142896077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.933996671248996, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.459105127576798, "policy_loss": -0.00958552592207318, "vf_loss": 8.467096038848634, "vf_explained_var": 0.0015336772121449626, "kl": 0.0159459962545564, "entropy": 1.527152807371957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 481.7150910597302, "episode_reward_min": -67.29765566358499, "episode_reward_mean": 181.58572719897765, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -713.6813435042426, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.05999999999995, "predator_policy": 739.0928675078676}, "policy_reward_mean": {"prey_policy": -112.20907470601723, "predator_policy": 203.00193830550597}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.25571773041105, -53.8821653709671, 165.68062910223242, 72.26000000000012, 161.4897911675657, 193.08872485069756, 250.2899999999998, 154.20505975663346, 192.6899999999995, 16.438159745302784, 37.24999999999999, 5.929999999999939, 58.52380945501188, 29.660000000000416, 174.80888631438413, 146.9739382241151, 44.05627669844669, -67.29765566358499, 215.8519260877467, 238.01898676648676, 240.3438736283289, 368.69064853921225, 229.95038867647608, 241.6389356996188, 108.69000000000027, 142.5300000000001, 163.45000000000016, 202.0400000000003, 136.14818851786367, 342.7326514413532, 147.0200000000002, 35.85984758460833, 182.03346388344215, 93.04000000000092, 221.8699999999999, 189.90794426465942, 319.8612109690009, 147.0400000000003, 356.2696204126378, 378.6395284657283, 203.91999999999945, 266.0499999999997, 223.92548955561915, 204.61151501062335, 209.729960506224, 89.13004715947483, 30.527545285052703, 135.90199038982666, 228.77808610797143, 120.9800000000002, 300.9692394816743, 174.19302674703974, 88.3764689006522, 259.4911991768002, 278.6211277537568, 42.69484720167477, 76.84330968441, 366.55149456641806, 219.3848959926022, 165.98, 142.14832274654725, 285.10854853077007, 98.60904561449712, 222.8299999999997, 233.4347898687724, 339.5503654607452, 445.7062737314187, 218.2214569966929, 220.99882810019767, 188.36960289160672, 310.92012250002296, 261.2575660860556, 270.0699999999998, 217.85999999999984, 230.31291779124922, 157.86633627116964, 101.26483548167941, -62.58907309282246, 114.90000000000042, 131.34707086591368, 257.44762743006424, 99.90295665128991, 280.6070706102905, 137.57257459904528, 161.36898371726136, 481.7150910597302, 200.55000000000013, 249.5339619373109, 150.60929096255072, 301.73133922477973, 103.08905692108321, 298.99731448377065, 225.20902571271887, 117.71000000000045, 248.71193702495722, 169.63358461402578, 122.98103496693204, 143.88572944469735, 148.57999999999998, 133.84050022550576], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.02102421966911, -275.8718321842484, -453.0137657957607, -220.13099562585626, 140.24237044757, -385.4847524735488, -270.16683201467595, -327.1328896516476, 30.71, -713.6813435042426, -94.55768117688606, -241.01550387242185, 149.2955775648082, 52.07413456400835, -352.4712460454161, -310.47609768705735, 44.829365985822655, 23.77937970960075, -1.587529707048596, -223.1656174915792, -88.57912874145296, -39.05929057383554, -195.98482852554193, -84.07880802984658, -168.9258312895003, -344.0024235680181, -99.21672765276541, -334.4999417904819, 2.0000000000000013, -155.01488373126213, -260.70763544394566, 69.32, -270.8039259677224, -278.7328291941744, -281.2822866085928, -207.72835916696962, -407.52715806903717, 106.94000000000017, 56.566196108116586, -31.349849484457046, -49.08858989265433, 24.65736919916274, 180.2, -58.09925382043077, 139.4006512828763, -78.38695296795603, 62.38999999999972, -88.33504123287382, -270.4440969017817, -61.95746230277373, -343.5148812027071, 67.78662926179538, 51.78472449892006, -218.8624036832214, -104.6866258031641, 47.65419674750956, 2.0000000000000013, 3.6763130468468006, 147.52999999999997, -653.3096667714211, -10.137715406284086, -153.9571321454717, -215.21447034365056, -60.81201540862687, -214.75609308657334, -52.23410102398124, 2.0000000000000013, 80.19531538667336, -22.329304812844207, 36.99833265133257, -146.46882139697004, 130.48483973784602, 146.65396500403116, 10.782536792703791, -23.981710211877157, 38.91308880108002, 35.47615290412443, 5.134774640461838, 61.756670900844085, 150.5, 23.780000000000253, 169.76231497291099, 110.2050696444085, 75.21076650508309, -51.645788022251075, 81.56062347724713, -383.26076241383043, -45.686724901710875, -579.8437311371317, 100.88197293892743, -95.78007537036157, -242.0469604527441, -282.21763953629664, -532.913167742132, 3.980000000000001, -237.97512847205826, 111.14901121811539, 11.89999999999997, 29.56253582680649, -228.1208735557325, 6.72624508125655, 123.01132738902132, -456.02213128600613, -26.35757538556695, -191.0884645032, -55.21839998620409, 88.47197076400938, 73.3671023749049, -1.8771493062579765, 145.98213735316227, -194.8757431922651, -154.7497186815606, -569.0353113597746, -399.5118309711562, 50.61778008825375, 194.05999999999995, -327.56874754628603, 94.07, 62.514415604910866, -517.8424995847032, -293.51635975166613, -181.52325596282444, 25.77631410405955, -36.58269911432137, -94.66000475367049, 33.64021697954937, -77.11107674598631, 9.526078950311469, -263.03778007010317, -300.8382502513199, 115.03521129584945, 177.23000000000013, -167.5105024842706, 169.3099999999999, 1.3377683446929391, -146.03962608361266, -101.03814759764522, 123.65708370357667, -328.5669498679954, -12.2362174489936, 189.96647954615608, -73.07659916969759, -163.7249601426217, -101.60055606917956, 178.57001213019663, 26.38464470486403, -5.95418665815394, -187.748783650524, -167.60650253010598, 110.4595773327521, -147.8621828811819, -75.1813509824128, -196.82667052511405, -214.71044655825932, -455.46137979990783, -302.0651435863292, -153.78740557182138, 23.610735216155923, -375.01537708728216, -273.3523025909896, -122.31213948703106, 80.40141859087198, -83.62369109823413, -339.01331094631854, -77.71764260203082, -67.12472852040929, -483.0589426468806, -56.881052706288116, -238.22634400799188, -180.86745037391452, -672.6937319850135, 0.0830531390051128, -287.8911910463985, -47.967841912102024, -126.4762136840831, -206.22741164834252, -167.30377031692018, 132.68000000000006, -1.4666055582536828, -2.718948757980897, -467.5996739961256, 18.830000000000002, -409.1087230356697, -71.50703163746705, -33.73973788296111, -22.27484555294666, -129.96341479435938, -213.28222580563684, -358.7848621543833, -63.76584278109533, 2.0000000000000013, -398.86221637518713, -587.8282313489387, -478.83405587188486, -39.80838380533867, -188.58113788325252, -22.22947372436964, -100.78012282258771, -367.77340830508683, 39.55551040499073], "policy_predator_policy_reward": [225.46062156227555, 105.68795257205184, 562.2633394669932, 56.99925658365541, 9.776987723421676, 401.1460234047895, 340.3968320146759, 329.16288965164745, 491.49805821507795, 352.96307645673085, 430.8994591288141, 97.76245077119182, 16.17586543599158, 32.74442243519179, 427.62161114325596, 389.53079234585044, 102.4006340141773, 21.680620290399293, 160.08422729559874, 81.10707964833244, 102.47471499400703, 62.41370432128184, 87.70880802984742, 198.28482852554077, 220.4718901567184, 350.9801741558106, 127.65672765276615, 335.7199417904808, 85.91705638565394, 241.90671365999233, 153.53338139525005, 184.82819227280947, 278.6091171123913, 314.983914747951, 85.40996081412725, 336.30302929784705, 336.4357107022496, 180.0033734545345, 41.14288667215589, 171.65975347067157, 81.33709843662453, 183.43799588519622, 135.06909720572853, 111.52080515391492, 19.34888514701602, 149.5878052145391, 144.10022045709326, 123.48375647540048, 213.1021805729194, 227.98937863163562, 73.64337073820462, 344.6148812027061, 151.48896960097971, 179.0387095833221, 102.5715621027716, 156.50086695288314, 45.704415767787175, 84.76745970323024, 272.46893170321863, 576.0433865095561, 299.0371321454716, 12.077715406284044, 70.78142930483615, 241.10490403204966, 230.6028762921307, 218.4207817018658, 10.844684613327066, 0.0, 128.1961537741139, 79.00481838739789, 187.83398165912246, 18.057944264659636, 132.50004691101546, 29.924662261250447, 64.36171021187688, 67.74691119891985, 151.70477045840863, 163.95392240964284, 60.39586119112416, 105.98699637375998, 10.37768502708889, 0.0, 43.10915689034542, 37.52500696016307, 29.814866078372273, 164.1957880222506, 195.57142140886148, 437.9875809173026, 621.8737311371318, 66.81798756729654, 51.12809693363877, 375.8289860489413, 739.0928675078676, 106.5654850556132, 319.0703874583422, 50.82673140354289, 50.1525163377877, 55.576558552069095, 299.62770930481565, 19.910628424108936, 46.49679692759312, 124.73487008380359, 42.73267783278938, 613.8400555858233, 198.91789446093347, 135.7654389291218, 12.706599633512603, 84.94552640437341, 80.7727033916141, 53.743436315238455, 92.38026547845475, 299.9400435970452, 395.5520487205585, 649.8384032947814, 45.71922590717407, 76.15448857099028, 425.89225213476135, 26.991391404126876, 590.8624995847033, 30.445584395089273, 311.2190608129257, 305.96887764811066, 152.43847597177853, 143.47645756925405, 155.32801236582728, 4.300821022791677, 100.10392104968864, 190.31107674598627, 301.42625234996603, 495.88456784022975, 2.1003654607453734, 45.18478870415053, 216.11049765891144, 227.7962785567782, 244.42318872011688, 118.50012601549577, 3.9717443966209482, 194.40814759764544, 358.6318544621606, 170.5409157464351, 154.4769610075173, 39.55328111604696, 478.25108040750905, 48.33200189034806, 61.43003824940422, 3.6853049155349877, 197.64292921894943, 213.920041089728, 256.68900991859726, 30.770833070005793, 133.43018946485685, 247.4796806699076, 125.14517358422857, 387.6567789808244, 92.49454338629, 602.4429069071244, 155.19740557182016, 89.87926478384428, 466.07474842835956, 313.6400021158258, 243.2558217599856, 56.10252656623788, 290.7780100480784, 231.76194864776366, 180.28556676329328, 245.16387496943818, 518.6775966059353, 158.83497334627862, 257.94656290066865, 322.5162151984988, 521.9573179051473, 632.3684520005914, 182.0978419121021, 354.3111910463982, 251.68728118561268, 330.5503060841237, 165.71904257822172, 19.51401870124778, 193.54240722415975, 112.37448631685493, 31.09620914870877, 520.7625217684993, 257.98418525500193, 521.6288839019069, 0.0, 281.2236091486269, 447.7121064667404, 13.243534133254327, 309.21644530175007, 362.0461966586874, 158.53670674543582, 407.95909424377703, 651.688396125307, 537.9549260624482, 109.33791001887957, 262.93734111440864, 69.56947372437031, 202.02012282258784, 108.88789741673628, 353.17050070886586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3471124156337189, "mean_inference_ms": 3.2900351549550226, "mean_action_processing_ms": 0.5412588973233656, "mean_env_wait_ms": 0.4317775588578734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004768729209899902, "StateBufferConnector_ms": 0.003268122673034668, "ViewRequirementAgentConnector_ms": 0.08853769302368164}, "num_episodes": 18, "episode_return_max": 481.7150910597302, "episode_return_min": -67.29765566358499, "episode_return_mean": 181.58572719897765, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.24619725365017, "num_env_steps_trained_throughput_per_sec": 423.24619725365017, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 11487.996, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11487.954, "sample_time_ms": 2047.095, "learn_time_ms": 9428.56, "learn_throughput": 424.243, "synch_weights_time_ms": 11.489}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "1f15c_00000", "date": "2024-08-16_14-04-34", "timestamp": 1723797274, "time_this_iter_s": 9.454591035842896, "time_total_s": 80.43745398521423, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f866ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.43745398521423, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.676923076923078, "ram_util_percent": 71.27692307692305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.503762229662093, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.143254780517053, "policy_loss": -0.007680341819789083, "vf_loss": 4.14891498606041, "vf_explained_var": 0.0007028030340002959, "kl": 0.010100675957701425, "entropy": 1.5237693437823543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.863638666824058, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5388828457978665, "policy_loss": -0.003983348742787721, "vf_loss": 5.54178969998839, "vf_explained_var": -0.04778551525539822, "kl": 0.010765111584370312, "entropy": 1.5200934681312117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 481.7150910597302, "episode_reward_min": -112.53083673818843, "episode_reward_mean": 180.05203653850643, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -672.6937319850135, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.05999999999995, "predator_policy": 739.0928675078676}, "policy_reward_mean": {"prey_policy": -106.16249202965578, "predator_policy": 196.18851029890894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [215.8519260877467, 238.01898676648676, 240.3438736283289, 368.69064853921225, 229.95038867647608, 241.6389356996188, 108.69000000000027, 142.5300000000001, 163.45000000000016, 202.0400000000003, 136.14818851786367, 342.7326514413532, 147.0200000000002, 35.85984758460833, 182.03346388344215, 93.04000000000092, 221.8699999999999, 189.90794426465942, 319.8612109690009, 147.0400000000003, 356.2696204126378, 378.6395284657283, 203.91999999999945, 266.0499999999997, 223.92548955561915, 204.61151501062335, 209.729960506224, 89.13004715947483, 30.527545285052703, 135.90199038982666, 228.77808610797143, 120.9800000000002, 300.9692394816743, 174.19302674703974, 88.3764689006522, 259.4911991768002, 278.6211277537568, 42.69484720167477, 76.84330968441, 366.55149456641806, 219.3848959926022, 165.98, 142.14832274654725, 285.10854853077007, 98.60904561449712, 222.8299999999997, 233.4347898687724, 339.5503654607452, 445.7062737314187, 218.2214569966929, 220.99882810019767, 188.36960289160672, 310.92012250002296, 261.2575660860556, 270.0699999999998, 217.85999999999984, 230.31291779124922, 157.86633627116964, 101.26483548167941, -62.58907309282246, 114.90000000000042, 131.34707086591368, 257.44762743006424, 99.90295665128991, 280.6070706102905, 137.57257459904528, 161.36898371726136, 481.7150910597302, 200.55000000000013, 249.5339619373109, 150.60929096255072, 301.73133922477973, 103.08905692108321, 298.99731448377065, 225.20902571271887, 117.71000000000045, 248.71193702495722, 169.63358461402578, 122.98103496693204, 143.88572944469735, 148.57999999999998, 133.84050022550576, 129.32000000000028, 3.5799999999999645, -85.74359941042299, 16.492464227759722, -112.53083673818843, 98.28347920711317, 210.93343406086962, 63.37999999999998, 208.2299999999994, 37.060000000000066, 54.044841000313106, 14.020611823582147, 189.61859953610056, 45.43000000000023, 243.77106523080712, 55.15688440805432, 261.3899999999988, 22.61516261714018], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-407.52715806903717, 106.94000000000017, 56.566196108116586, -31.349849484457046, -49.08858989265433, 24.65736919916274, 180.2, -58.09925382043077, 139.4006512828763, -78.38695296795603, 62.38999999999972, -88.33504123287382, -270.4440969017817, -61.95746230277373, -343.5148812027071, 67.78662926179538, 51.78472449892006, -218.8624036832214, -104.6866258031641, 47.65419674750956, 2.0000000000000013, 3.6763130468468006, 147.52999999999997, -653.3096667714211, -10.137715406284086, -153.9571321454717, -215.21447034365056, -60.81201540862687, -214.75609308657334, -52.23410102398124, 2.0000000000000013, 80.19531538667336, -22.329304812844207, 36.99833265133257, -146.46882139697004, 130.48483973784602, 146.65396500403116, 10.782536792703791, -23.981710211877157, 38.91308880108002, 35.47615290412443, 5.134774640461838, 61.756670900844085, 150.5, 23.780000000000253, 169.76231497291099, 110.2050696444085, 75.21076650508309, -51.645788022251075, 81.56062347724713, -383.26076241383043, -45.686724901710875, -579.8437311371317, 100.88197293892743, -95.78007537036157, -242.0469604527441, -282.21763953629664, -532.913167742132, 3.980000000000001, -237.97512847205826, 111.14901121811539, 11.89999999999997, 29.56253582680649, -228.1208735557325, 6.72624508125655, 123.01132738902132, -456.02213128600613, -26.35757538556695, -191.0884645032, -55.21839998620409, 88.47197076400938, 73.3671023749049, -1.8771493062579765, 145.98213735316227, -194.8757431922651, -154.7497186815606, -569.0353113597746, -399.5118309711562, 50.61778008825375, 194.05999999999995, -327.56874754628603, 94.07, 62.514415604910866, -517.8424995847032, -293.51635975166613, -181.52325596282444, 25.77631410405955, -36.58269911432137, -94.66000475367049, 33.64021697954937, -77.11107674598631, 9.526078950311469, -263.03778007010317, -300.8382502513199, 115.03521129584945, 177.23000000000013, -167.5105024842706, 169.3099999999999, 1.3377683446929391, -146.03962608361266, -101.03814759764522, 123.65708370357667, -328.5669498679954, -12.2362174489936, 189.96647954615608, -73.07659916969759, -163.7249601426217, -101.60055606917956, 178.57001213019663, 26.38464470486403, -5.95418665815394, -187.748783650524, -167.60650253010598, 110.4595773327521, -147.8621828811819, -75.1813509824128, -196.82667052511405, -214.71044655825932, -455.46137979990783, -302.0651435863292, -153.78740557182138, 23.610735216155923, -375.01537708728216, -273.3523025909896, -122.31213948703106, 80.40141859087198, -83.62369109823413, -339.01331094631854, -77.71764260203082, -67.12472852040929, -483.0589426468806, -56.881052706288116, -238.22634400799188, -180.86745037391452, -672.6937319850135, 0.0830531390051128, -287.8911910463985, -47.967841912102024, -126.4762136840831, -206.22741164834252, -167.30377031692018, 132.68000000000006, -1.4666055582536828, -2.718948757980897, -467.5996739961256, 18.830000000000002, -409.1087230356697, -71.50703163746705, -33.73973788296111, -22.27484555294666, -129.96341479435938, -213.28222580563684, -358.7848621543833, -63.76584278109533, 2.0000000000000013, -398.86221637518713, -587.8282313489387, -478.83405587188486, -39.80838380533867, -188.58113788325252, -22.22947372436964, -100.78012282258771, -367.77340830508683, 39.55551040499073, 73.06922642984384, -531.9109334306095, 2.0000000000000013, -111.6394709622772, -507.4254000265379, -300.88387381037813, 2.0000000000000013, -45.70831074575526, -410.82748338102385, -364.96053242221353, -84.98307497096997, 56.33353960054801, 26.102962127426014, -124.30015874415531, -14.771377534996189, -171.33325467027905, 24.699078959360115, -49.703215022368234, -362.45405610452195, -147.12018972040113, -257.08745354717394, 2.0000000000000013, 2.0000000000000013, -45.90640920059732, -411.94652118799627, -586.4183533397769, -280.24348116563755, -139.71529680095753, 100.78310283670385, -71.38120240950089, -259.72718706386735, -194.08178034793735, 126.74000000000035, 133.11594922473284, -9.950240151723367, -49.19125060702851], "policy_predator_policy_reward": [336.4357107022496, 180.0033734545345, 41.14288667215589, 171.65975347067157, 81.33709843662453, 183.43799588519622, 135.06909720572853, 111.52080515391492, 19.34888514701602, 149.5878052145391, 144.10022045709326, 123.48375647540048, 213.1021805729194, 227.98937863163562, 73.64337073820462, 344.6148812027061, 151.48896960097971, 179.0387095833221, 102.5715621027716, 156.50086695288314, 45.704415767787175, 84.76745970323024, 272.46893170321863, 576.0433865095561, 299.0371321454716, 12.077715406284044, 70.78142930483615, 241.10490403204966, 230.6028762921307, 218.4207817018658, 10.844684613327066, 0.0, 128.1961537741139, 79.00481838739789, 187.83398165912246, 18.057944264659636, 132.50004691101546, 29.924662261250447, 64.36171021187688, 67.74691119891985, 151.70477045840863, 163.95392240964284, 60.39586119112416, 105.98699637375998, 10.37768502708889, 0.0, 43.10915689034542, 37.52500696016307, 29.814866078372273, 164.1957880222506, 195.57142140886148, 437.9875809173026, 621.8737311371318, 66.81798756729654, 51.12809693363877, 375.8289860489413, 739.0928675078676, 106.5654850556132, 319.0703874583422, 50.82673140354289, 50.1525163377877, 55.576558552069095, 299.62770930481565, 19.910628424108936, 46.49679692759312, 124.73487008380359, 42.73267783278938, 613.8400555858233, 198.91789446093347, 135.7654389291218, 12.706599633512603, 84.94552640437341, 80.7727033916141, 53.743436315238455, 92.38026547845475, 299.9400435970452, 395.5520487205585, 649.8384032947814, 45.71922590717407, 76.15448857099028, 425.89225213476135, 26.991391404126876, 590.8624995847033, 30.445584395089273, 311.2190608129257, 305.96887764811066, 152.43847597177853, 143.47645756925405, 155.32801236582728, 4.300821022791677, 100.10392104968864, 190.31107674598627, 301.42625234996603, 495.88456784022975, 2.1003654607453734, 45.18478870415053, 216.11049765891144, 227.7962785567782, 244.42318872011688, 118.50012601549577, 3.9717443966209482, 194.40814759764544, 358.6318544621606, 170.5409157464351, 154.4769610075173, 39.55328111604696, 478.25108040750905, 48.33200189034806, 61.43003824940422, 3.6853049155349877, 197.64292921894943, 213.920041089728, 256.68900991859726, 30.770833070005793, 133.43018946485685, 247.4796806699076, 125.14517358422857, 387.6567789808244, 92.49454338629, 602.4429069071244, 155.19740557182016, 89.87926478384428, 466.07474842835956, 313.6400021158258, 243.2558217599856, 56.10252656623788, 290.7780100480784, 231.76194864776366, 180.28556676329328, 245.16387496943818, 518.6775966059353, 158.83497334627862, 257.94656290066865, 322.5162151984988, 521.9573179051473, 632.3684520005914, 182.0978419121021, 354.3111910463982, 251.68728118561268, 330.5503060841237, 165.71904257822172, 19.51401870124778, 193.54240722415975, 112.37448631685493, 31.09620914870877, 520.7625217684993, 257.98418525500193, 521.6288839019069, 0.0, 281.2236091486269, 447.7121064667404, 13.243534133254327, 309.21644530175007, 362.0461966586874, 158.53670674543582, 407.95909424377703, 651.688396125307, 537.9549260624482, 109.33791001887957, 262.93734111440864, 69.56947372437031, 202.02012282258784, 108.88789741673628, 353.17050070886586, 560.380933430609, 27.780773570156224, 0.0, 113.21947096227801, 420.10418391929187, 302.4614905071996, 12.787778905489803, 47.41299606802482, 616.5285298192015, 46.72864924584625, 39.395661661682375, 87.537352915853, 201.47335781767995, 107.6572728599202, 232.79325467027917, 16.691377534996263, 88.64713044972063, 144.58700561328763, 398.05405610452135, 148.58018972039994, 90.01550192492793, 219.11679262255842, 10.150611823582231, 47.776409200596945, 730.6866305795796, 457.29684348429345, 183.76529680095805, 281.6234811656363, 214.36916480360455, 0.0, 437.0204285647329, 71.94542325512559, 1.5340507752668162, 0.0, 2.0251626171399875, 79.73149075875152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1944141611902543, "mean_inference_ms": 2.9200920624017943, "mean_action_processing_ms": 0.4817773959212552, "mean_env_wait_ms": 0.3841914320883176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004171848297119141, "StateBufferConnector_ms": 0.0027663707733154297, "ViewRequirementAgentConnector_ms": 0.07972562313079834}, "num_episodes": 18, "episode_return_max": 481.7150910597302, "episode_return_min": -112.53083673818843, "episode_return_mean": 180.05203653850643, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.20038790643775, "num_env_steps_trained_throughput_per_sec": 437.20038790643775, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 11195.638, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11195.596, "sample_time_ms": 1912.997, "learn_time_ms": 9270.298, "learn_throughput": 431.486, "synch_weights_time_ms": 11.509}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "1f15c_00000", "date": "2024-08-16_14-04-43", "timestamp": 1723797283, "time_this_iter_s": 9.152087211608887, "time_total_s": 89.58954119682312, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f87da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 89.58954119682312, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.299999999999997, "ram_util_percent": 71.23076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3301433999387045, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.509339216020372, "policy_loss": -0.008591810414424689, "vf_loss": 6.515972177818338, "vf_explained_var": 0.0006088897664710958, "kl": 0.009794307519835805, "entropy": 1.5280841894881436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8422351325315143, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.794013949550648, "policy_loss": -0.008641007139529816, "vf_loss": 5.80130097929132, "vf_explained_var": -0.04304248646453575, "kl": 0.01353961411779896, "entropy": 1.524107278465594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 481.7150910597302, "episode_reward_min": -112.53083673818843, "episode_reward_mean": 146.65280842603752, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -829.7355080142493, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.05999999999995, "predator_policy": 767.6885631394234}, "policy_reward_mean": {"prey_policy": -145.5577637714283, "predator_policy": 218.88416798444698}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.91999999999945, 266.0499999999997, 223.92548955561915, 204.61151501062335, 209.729960506224, 89.13004715947483, 30.527545285052703, 135.90199038982666, 228.77808610797143, 120.9800000000002, 300.9692394816743, 174.19302674703974, 88.3764689006522, 259.4911991768002, 278.6211277537568, 42.69484720167477, 76.84330968441, 366.55149456641806, 219.3848959926022, 165.98, 142.14832274654725, 285.10854853077007, 98.60904561449712, 222.8299999999997, 233.4347898687724, 339.5503654607452, 445.7062737314187, 218.2214569966929, 220.99882810019767, 188.36960289160672, 310.92012250002296, 261.2575660860556, 270.0699999999998, 217.85999999999984, 230.31291779124922, 157.86633627116964, 101.26483548167941, -62.58907309282246, 114.90000000000042, 131.34707086591368, 257.44762743006424, 99.90295665128991, 280.6070706102905, 137.57257459904528, 161.36898371726136, 481.7150910597302, 200.55000000000013, 249.5339619373109, 150.60929096255072, 301.73133922477973, 103.08905692108321, 298.99731448377065, 225.20902571271887, 117.71000000000045, 248.71193702495722, 169.63358461402578, 122.98103496693204, 143.88572944469735, 148.57999999999998, 133.84050022550576, 129.32000000000028, 3.5799999999999645, -85.74359941042299, 16.492464227759722, -112.53083673818843, 98.28347920711317, 210.93343406086962, 63.37999999999998, 208.2299999999994, 37.060000000000066, 54.044841000313106, 14.020611823582147, 189.61859953610056, 45.43000000000023, 243.77106523080712, 55.15688440805432, 261.3899999999988, 22.61516261714018, 28.100000000000012, 6.469999999999949, 12.12716736182963, 105.02644759256377, 105.23514454777263, -53.79157101184357, 85.48291413640739, 53.459999999999496, 116.5081631850941, 194.33003672645646, 34.93596517260668, -96.11444132385247, 185.04699453168075, 64.51999999999964, 33.87084023466064, -79.3794806628776, 34.033098335272484, 177.41580823109723, 114.67282329315474, 4.93821122229973, 117.70136970403348, 117.11491241392105], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [23.780000000000253, 169.76231497291099, 110.2050696444085, 75.21076650508309, -51.645788022251075, 81.56062347724713, -383.26076241383043, -45.686724901710875, -579.8437311371317, 100.88197293892743, -95.78007537036157, -242.0469604527441, -282.21763953629664, -532.913167742132, 3.980000000000001, -237.97512847205826, 111.14901121811539, 11.89999999999997, 29.56253582680649, -228.1208735557325, 6.72624508125655, 123.01132738902132, -456.02213128600613, -26.35757538556695, -191.0884645032, -55.21839998620409, 88.47197076400938, 73.3671023749049, -1.8771493062579765, 145.98213735316227, -194.8757431922651, -154.7497186815606, -569.0353113597746, -399.5118309711562, 50.61778008825375, 194.05999999999995, -327.56874754628603, 94.07, 62.514415604910866, -517.8424995847032, -293.51635975166613, -181.52325596282444, 25.77631410405955, -36.58269911432137, -94.66000475367049, 33.64021697954937, -77.11107674598631, 9.526078950311469, -263.03778007010317, -300.8382502513199, 115.03521129584945, 177.23000000000013, -167.5105024842706, 169.3099999999999, 1.3377683446929391, -146.03962608361266, -101.03814759764522, 123.65708370357667, -328.5669498679954, -12.2362174489936, 189.96647954615608, -73.07659916969759, -163.7249601426217, -101.60055606917956, 178.57001213019663, 26.38464470486403, -5.95418665815394, -187.748783650524, -167.60650253010598, 110.4595773327521, -147.8621828811819, -75.1813509824128, -196.82667052511405, -214.71044655825932, -455.46137979990783, -302.0651435863292, -153.78740557182138, 23.610735216155923, -375.01537708728216, -273.3523025909896, -122.31213948703106, 80.40141859087198, -83.62369109823413, -339.01331094631854, -77.71764260203082, -67.12472852040929, -483.0589426468806, -56.881052706288116, -238.22634400799188, -180.86745037391452, -672.6937319850135, 0.0830531390051128, -287.8911910463985, -47.967841912102024, -126.4762136840831, -206.22741164834252, -167.30377031692018, 132.68000000000006, -1.4666055582536828, -2.718948757980897, -467.5996739961256, 18.830000000000002, -409.1087230356697, -71.50703163746705, -33.73973788296111, -22.27484555294666, -129.96341479435938, -213.28222580563684, -358.7848621543833, -63.76584278109533, 2.0000000000000013, -398.86221637518713, -587.8282313489387, -478.83405587188486, -39.80838380533867, -188.58113788325252, -22.22947372436964, -100.78012282258771, -367.77340830508683, 39.55551040499073, 73.06922642984384, -531.9109334306095, 2.0000000000000013, -111.6394709622772, -507.4254000265379, -300.88387381037813, 2.0000000000000013, -45.70831074575526, -410.82748338102385, -364.96053242221353, -84.98307497096997, 56.33353960054801, 26.102962127426014, -124.30015874415531, -14.771377534996189, -171.33325467027905, 24.699078959360115, -49.703215022368234, -362.45405610452195, -147.12018972040113, -257.08745354717394, 2.0000000000000013, 2.0000000000000013, -45.90640920059732, -411.94652118799627, -586.4183533397769, -280.24348116563755, -139.71529680095753, 100.78310283670385, -71.38120240950089, -259.72718706386735, -194.08178034793735, 126.74000000000035, 133.11594922473284, -9.950240151723367, -49.19125060702851, -90.81129107132283, -115.4033672042816, -20.063245279285105, -166.0983415194958, -206.01029163791938, 2.0000000000000013, -0.2973375901211319, -178.3540014345237, -680.753358977539, -9.860771465639695, -524.88225710741, -570.1184682966644, -147.37295440084824, -313.8430381879237, 2.0000000000000013, 42.910336173998445, -190.78866594088564, -183.17666012852902, 25.55670465595077, -90.45448371890544, -66.60251858066688, -266.84928918031227, -385.6205666473368, -176.3596885135978, -829.7355080142493, -198.63694949252616, -159.97464979434244, -34.2725027754078, -116.8541775541336, -114.31881318940327, -331.6441287006768, -373.0745457646103, -330.0892333036455, -8.18133415576546, -605.3360197330711, -384.39216924154215, -293.1840799445425, -8.490033856279807, -240.33708408423837, -49.59710204912153, -237.70250655369992, -7.516938352795805, -330.46861421118683, -589.9659905344428], "policy_predator_policy_reward": [10.37768502708889, 0.0, 43.10915689034542, 37.52500696016307, 29.814866078372273, 164.1957880222506, 195.57142140886148, 437.9875809173026, 621.8737311371318, 66.81798756729654, 51.12809693363877, 375.8289860489413, 739.0928675078676, 106.5654850556132, 319.0703874583422, 50.82673140354289, 50.1525163377877, 55.576558552069095, 299.62770930481565, 19.910628424108936, 46.49679692759312, 124.73487008380359, 42.73267783278938, 613.8400555858233, 198.91789446093347, 135.7654389291218, 12.706599633512603, 84.94552640437341, 80.7727033916141, 53.743436315238455, 92.38026547845475, 299.9400435970452, 395.5520487205585, 649.8384032947814, 45.71922590717407, 76.15448857099028, 425.89225213476135, 26.991391404126876, 590.8624995847033, 30.445584395089273, 311.2190608129257, 305.96887764811066, 152.43847597177853, 143.47645756925405, 155.32801236582728, 4.300821022791677, 100.10392104968864, 190.31107674598627, 301.42625234996603, 495.88456784022975, 2.1003654607453734, 45.18478870415053, 216.11049765891144, 227.7962785567782, 244.42318872011688, 118.50012601549577, 3.9717443966209482, 194.40814759764544, 358.6318544621606, 170.5409157464351, 154.4769610075173, 39.55328111604696, 478.25108040750905, 48.33200189034806, 61.43003824940422, 3.6853049155349877, 197.64292921894943, 213.920041089728, 256.68900991859726, 30.770833070005793, 133.43018946485685, 247.4796806699076, 125.14517358422857, 387.6567789808244, 92.49454338629, 602.4429069071244, 155.19740557182016, 89.87926478384428, 466.07474842835956, 313.6400021158258, 243.2558217599856, 56.10252656623788, 290.7780100480784, 231.76194864776366, 180.28556676329328, 245.16387496943818, 518.6775966059353, 158.83497334627862, 257.94656290066865, 322.5162151984988, 521.9573179051473, 632.3684520005914, 182.0978419121021, 354.3111910463982, 251.68728118561268, 330.5503060841237, 165.71904257822172, 19.51401870124778, 193.54240722415975, 112.37448631685493, 31.09620914870877, 520.7625217684993, 257.98418525500193, 521.6288839019069, 0.0, 281.2236091486269, 447.7121064667404, 13.243534133254327, 309.21644530175007, 362.0461966586874, 158.53670674543582, 407.95909424377703, 651.688396125307, 537.9549260624482, 109.33791001887957, 262.93734111440864, 69.56947372437031, 202.02012282258784, 108.88789741673628, 353.17050070886586, 560.380933430609, 27.780773570156224, 0.0, 113.21947096227801, 420.10418391929187, 302.4614905071996, 12.787778905489803, 47.41299606802482, 616.5285298192015, 46.72864924584625, 39.395661661682375, 87.537352915853, 201.47335781767995, 107.6572728599202, 232.79325467027917, 16.691377534996263, 88.64713044972063, 144.58700561328763, 398.05405610452135, 148.58018972039994, 90.01550192492793, 219.11679262255842, 10.150611823582231, 47.776409200596945, 730.6866305795796, 457.29684348429345, 183.76529680095805, 281.6234811656363, 214.36916480360455, 0.0, 437.0204285647329, 71.94542325512559, 1.5340507752668162, 0.0, 2.0251626171399875, 79.73149075875152, 140.16039004549702, 94.15426823010776, 24.943245279285396, 167.68834151949434, 23.29401348370884, 192.8434455160395, 99.18056913359779, 184.49721748360992, 204.82913746322174, 591.0201375277284, 358.2227262585863, 682.9864281336435, 113.60748264226456, 433.09142408291456, 0.0, 8.549663826001327, 192.20609801512455, 298.2673912393818, 96.04077177827688, 163.18704401113388, 255.99628613470168, 112.39148679888457, 400.3588447893424, 65.5069690477365, 767.6885631394234, 445.73088889903323, 9.72249726206331, 249.04465530768562, 136.75484916141352, 128.28898181678596, 428.27632755851045, 197.0628662438991, 168.7735658276486, 203.5300999670341, 607.2244680711262, 559.9195291345841, 155.0608358144257, 261.2861012795481, 166.96326698555072, 127.90913037010893, 107.16692778468146, 255.75388682584537, 578.2770425667072, 459.272474592842]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.079728189078573, "mean_inference_ms": 2.638990665130695, "mean_action_processing_ms": 0.433680998642619, "mean_env_wait_ms": 0.34824326807416867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036524534225463867, "StateBufferConnector_ms": 0.002765059471130371, "ViewRequirementAgentConnector_ms": 0.08043384552001953}, "num_episodes": 22, "episode_return_max": 481.7150910597302, "episode_return_min": -112.53083673818843, "episode_return_mean": 146.65280842603752, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.58220072926093, "num_env_steps_trained_throughput_per_sec": 440.58220072926093, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 10960.445, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10960.404, "sample_time_ms": 1808.172, "learn_time_ms": 9139.768, "learn_throughput": 437.648, "synch_weights_time_ms": 11.646}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "1f15c_00000", "date": "2024-08-16_14-04-52", "timestamp": 1723797292, "time_this_iter_s": 9.082331895828247, "time_total_s": 98.67187309265137, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f800a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.67187309265137, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.838461538461537, "ram_util_percent": 71.38461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.260175855796804, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.886236230784623, "policy_loss": -0.007980353202148483, "vf_loss": 4.892283967563084, "vf_explained_var": -8.532767573361674e-05, "kl": 0.009663142416063832, "entropy": 1.5195243182005707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5239292047957265, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.546598835470816, "policy_loss": -0.008519582681988597, "vf_loss": 4.553894747249664, "vf_explained_var": -0.03747208821710455, "kl": 0.012236614588075614, "entropy": 1.4961700989455773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 481.7150910597302, "episode_reward_min": -112.53083673818843, "episode_reward_mean": 113.3310808787836, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -829.7355080142493, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.96647954615608, "predator_policy": 767.6885631394234}, "policy_reward_mean": {"prey_policy": -155.53030671827204, "predator_policy": 212.19584715766368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.8299999999997, 233.4347898687724, 339.5503654607452, 445.7062737314187, 218.2214569966929, 220.99882810019767, 188.36960289160672, 310.92012250002296, 261.2575660860556, 270.0699999999998, 217.85999999999984, 230.31291779124922, 157.86633627116964, 101.26483548167941, -62.58907309282246, 114.90000000000042, 131.34707086591368, 257.44762743006424, 99.90295665128991, 280.6070706102905, 137.57257459904528, 161.36898371726136, 481.7150910597302, 200.55000000000013, 249.5339619373109, 150.60929096255072, 301.73133922477973, 103.08905692108321, 298.99731448377065, 225.20902571271887, 117.71000000000045, 248.71193702495722, 169.63358461402578, 122.98103496693204, 143.88572944469735, 148.57999999999998, 133.84050022550576, 129.32000000000028, 3.5799999999999645, -85.74359941042299, 16.492464227759722, -112.53083673818843, 98.28347920711317, 210.93343406086962, 63.37999999999998, 208.2299999999994, 37.060000000000066, 54.044841000313106, 14.020611823582147, 189.61859953610056, 45.43000000000023, 243.77106523080712, 55.15688440805432, 261.3899999999988, 22.61516261714018, 28.100000000000012, 6.469999999999949, 12.12716736182963, 105.02644759256377, 105.23514454777263, -53.79157101184357, 85.48291413640739, 53.459999999999496, 116.5081631850941, 194.33003672645646, 34.93596517260668, -96.11444132385247, 185.04699453168075, 64.51999999999964, 33.87084023466064, -79.3794806628776, 34.033098335272484, 177.41580823109723, 114.67282329315474, 4.93821122229973, 117.70136970403348, 117.11491241392105, 3.6699999999999635, 55.662288125090285, 13.657817797563112, 10.229999999999931, 53.908778180720354, 84.9702156988312, -15.522778081521555, 38.43010834392663, 27.15666468600306, 67.6257861392871, -54.454044869692794, 37.06170941122194, 110.23387298716437, 21.93835672940952, 139.38604602250822, 3.589999999999963, 45.78074656348006, 44.65496989089144, 117.81215015943502, 46.727901478856666, 48.5284747159821, -40.33627193297932, 19.640613640064185], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-77.11107674598631, 9.526078950311469, -263.03778007010317, -300.8382502513199, 115.03521129584945, 177.23000000000013, -167.5105024842706, 169.3099999999999, 1.3377683446929391, -146.03962608361266, -101.03814759764522, 123.65708370357667, -328.5669498679954, -12.2362174489936, 189.96647954615608, -73.07659916969759, -163.7249601426217, -101.60055606917956, 178.57001213019663, 26.38464470486403, -5.95418665815394, -187.748783650524, -167.60650253010598, 110.4595773327521, -147.8621828811819, -75.1813509824128, -196.82667052511405, -214.71044655825932, -455.46137979990783, -302.0651435863292, -153.78740557182138, 23.610735216155923, -375.01537708728216, -273.3523025909896, -122.31213948703106, 80.40141859087198, -83.62369109823413, -339.01331094631854, -77.71764260203082, -67.12472852040929, -483.0589426468806, -56.881052706288116, -238.22634400799188, -180.86745037391452, -672.6937319850135, 0.0830531390051128, -287.8911910463985, -47.967841912102024, -126.4762136840831, -206.22741164834252, -167.30377031692018, 132.68000000000006, -1.4666055582536828, -2.718948757980897, -467.5996739961256, 18.830000000000002, -409.1087230356697, -71.50703163746705, -33.73973788296111, -22.27484555294666, -129.96341479435938, -213.28222580563684, -358.7848621543833, -63.76584278109533, 2.0000000000000013, -398.86221637518713, -587.8282313489387, -478.83405587188486, -39.80838380533867, -188.58113788325252, -22.22947372436964, -100.78012282258771, -367.77340830508683, 39.55551040499073, 73.06922642984384, -531.9109334306095, 2.0000000000000013, -111.6394709622772, -507.4254000265379, -300.88387381037813, 2.0000000000000013, -45.70831074575526, -410.82748338102385, -364.96053242221353, -84.98307497096997, 56.33353960054801, 26.102962127426014, -124.30015874415531, -14.771377534996189, -171.33325467027905, 24.699078959360115, -49.703215022368234, -362.45405610452195, -147.12018972040113, -257.08745354717394, 2.0000000000000013, 2.0000000000000013, -45.90640920059732, -411.94652118799627, -586.4183533397769, -280.24348116563755, -139.71529680095753, 100.78310283670385, -71.38120240950089, -259.72718706386735, -194.08178034793735, 126.74000000000035, 133.11594922473284, -9.950240151723367, -49.19125060702851, -90.81129107132283, -115.4033672042816, -20.063245279285105, -166.0983415194958, -206.01029163791938, 2.0000000000000013, -0.2973375901211319, -178.3540014345237, -680.753358977539, -9.860771465639695, -524.88225710741, -570.1184682966644, -147.37295440084824, -313.8430381879237, 2.0000000000000013, 42.910336173998445, -190.78866594088564, -183.17666012852902, 25.55670465595077, -90.45448371890544, -66.60251858066688, -266.84928918031227, -385.6205666473368, -176.3596885135978, -829.7355080142493, -198.63694949252616, -159.97464979434244, -34.2725027754078, -116.8541775541336, -114.31881318940327, -331.6441287006768, -373.0745457646103, -330.0892333036455, -8.18133415576546, -605.3360197330711, -384.39216924154215, -293.1840799445425, -8.490033856279807, -240.33708408423837, -49.59710204912153, -237.70250655369992, -7.516938352795805, -330.46861421118683, -589.9659905344428, -37.07666742563903, -50.650653977068735, -123.4164279394197, 6.949999999999959, -134.80470680781903, -394.5622287423269, -207.52755992166823, -48.67979568202076, -14.068330836331205, -0.09315139909679032, -51.474672076733185, 2.0000000000000013, -270.8305186491081, -257.1351139959966, -77.5474601777743, -89.73592910709263, -98.98600232378422, -276.02521390366525, -363.3091342891277, -279.7140135306187, -90.88771958567034, -308.09052945375095, -85.05399077516877, -133.586390482752, 9.919999999999964, -230.47620891659574, -11.397640109998992, -26.27399330304413, -524.6271805142566, 2.0000000000000013, -10.577613166119011, -97.6932821716015, -165.57476333848558, -4.8289975641244, -248.13605490004022, -62.255652942143904, -195.56849314373764, -650.947535583323, -7.719832026444038, -206.75229145825605, -382.7726558126012, -0.02647825013284477, -207.36206966981723, -114.7065452384739, 2.0000000000000013, -40.11602884399984], "policy_predator_policy_reward": [100.10392104968864, 190.31107674598627, 301.42625234996603, 495.88456784022975, 2.1003654607453734, 45.18478870415053, 216.11049765891144, 227.7962785567782, 244.42318872011688, 118.50012601549577, 3.9717443966209482, 194.40814759764544, 358.6318544621606, 170.5409157464351, 154.4769610075173, 39.55328111604696, 478.25108040750905, 48.33200189034806, 61.43003824940422, 3.6853049155349877, 197.64292921894943, 213.920041089728, 256.68900991859726, 30.770833070005793, 133.43018946485685, 247.4796806699076, 125.14517358422857, 387.6567789808244, 92.49454338629, 602.4429069071244, 155.19740557182016, 89.87926478384428, 466.07474842835956, 313.6400021158258, 243.2558217599856, 56.10252656623788, 290.7780100480784, 231.76194864776366, 180.28556676329328, 245.16387496943818, 518.6775966059353, 158.83497334627862, 257.94656290066865, 322.5162151984988, 521.9573179051473, 632.3684520005914, 182.0978419121021, 354.3111910463982, 251.68728118561268, 330.5503060841237, 165.71904257822172, 19.51401870124778, 193.54240722415975, 112.37448631685493, 31.09620914870877, 520.7625217684993, 257.98418525500193, 521.6288839019069, 0.0, 281.2236091486269, 447.7121064667404, 13.243534133254327, 309.21644530175007, 362.0461966586874, 158.53670674543582, 407.95909424377703, 651.688396125307, 537.9549260624482, 109.33791001887957, 262.93734111440864, 69.56947372437031, 202.02012282258784, 108.88789741673628, 353.17050070886586, 560.380933430609, 27.780773570156224, 0.0, 113.21947096227801, 420.10418391929187, 302.4614905071996, 12.787778905489803, 47.41299606802482, 616.5285298192015, 46.72864924584625, 39.395661661682375, 87.537352915853, 201.47335781767995, 107.6572728599202, 232.79325467027917, 16.691377534996263, 88.64713044972063, 144.58700561328763, 398.05405610452135, 148.58018972039994, 90.01550192492793, 219.11679262255842, 10.150611823582231, 47.776409200596945, 730.6866305795796, 457.29684348429345, 183.76529680095805, 281.6234811656363, 214.36916480360455, 0.0, 437.0204285647329, 71.94542325512559, 1.5340507752668162, 0.0, 2.0251626171399875, 79.73149075875152, 140.16039004549702, 94.15426823010776, 24.943245279285396, 167.68834151949434, 23.29401348370884, 192.8434455160395, 99.18056913359779, 184.49721748360992, 204.82913746322174, 591.0201375277284, 358.2227262585863, 682.9864281336435, 113.60748264226456, 433.09142408291456, 0.0, 8.549663826001327, 192.20609801512455, 298.2673912393818, 96.04077177827688, 163.18704401113388, 255.99628613470168, 112.39148679888457, 400.3588447893424, 65.5069690477365, 767.6885631394234, 445.73088889903323, 9.72249726206331, 249.04465530768562, 136.75484916141352, 128.28898181678596, 428.27632755851045, 197.0628662438991, 168.7735658276486, 203.5300999670341, 607.2244680711262, 559.9195291345841, 155.0608358144257, 261.2861012795481, 166.96326698555072, 127.90913037010893, 107.16692778468146, 255.75388682584537, 578.2770425667072, 459.272474592842, 52.43065397706838, 38.966667425638654, 82.484887539841, 89.64382852467041, 245.87039100592818, 297.15436234177866, 50.44979568202042, 215.98755992166716, 32.09786067740689, 35.97239973874187, 3.4966692647294964, 130.9482185108341, 349.63048865158964, 162.81236591199178, 53.45873939048939, 152.25475823830578, 363.5236636618212, 38.64421725163038, 367.228184421137, 343.42074953789574, 318.87707657736104, 25.64712759236771, 88.49452396613282, 167.20756670300958, 228.97655090175365, 101.81353100200334, 37.63710549355824, 21.97288464889408, 461.6975451669037, 200.3156813698611, 12.51761316611897, 99.34328217160234, 147.97630356425623, 68.20820390183341, 249.39605490003913, 105.6506228330355, 564.0045647487221, 400.3236141377727, 84.22690758157874, 176.97311738197746, 158.1714879466869, 273.1561208320292, 258.4211935764301, 23.311149398881692, 19.18209845585987, 38.57454402820323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9890425004809089, "mean_inference_ms": 2.4252552489190276, "mean_action_processing_ms": 0.40156794262693324, "mean_env_wait_ms": 0.3201140194249117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003454446792602539, "StateBufferConnector_ms": 0.0028399229049682617, "ViewRequirementAgentConnector_ms": 0.08107304573059082}, "num_episodes": 23, "episode_return_max": 481.7150910597302, "episode_return_min": -112.53083673818843, "episode_return_mean": 113.3310808787836, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.6368675152587, "num_env_steps_trained_throughput_per_sec": 432.6368675152587, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 10788.964, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10788.924, "sample_time_ms": 1733.038, "learn_time_ms": 9043.512, "learn_throughput": 442.306, "synch_weights_time_ms": 11.536}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "1f15c_00000", "date": "2024-08-16_14-05-02", "timestamp": 1723797302, "time_this_iter_s": 9.248612880706787, "time_total_s": 107.92048597335815, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f866ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.92048597335815, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.892857142857142, "ram_util_percent": 71.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2557648826686163, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.396370326905023, "policy_loss": -0.009100474386658303, "vf_loss": 5.403427802444135, "vf_explained_var": -0.0007647531057791735, "kl": 0.010215045492156157, "entropy": 1.5117101499012537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2007763092637693, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.143510745820545, "policy_loss": -0.012078224768290523, "vf_loss": 5.154150680259422, "vf_explained_var": -0.01709445894710601, "kl": 0.014383157086106968, "entropy": 1.4712420371474413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 481.7150910597302, "episode_reward_min": -249.78286625666345, "episode_reward_mean": 79.68391697695557, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -829.7355080142493, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 133.11594922473284, "predator_policy": 767.6885631394234}, "policy_reward_mean": {"prey_policy": -175.00195246744823, "predator_policy": 214.84391095592585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.90295665128991, 280.6070706102905, 137.57257459904528, 161.36898371726136, 481.7150910597302, 200.55000000000013, 249.5339619373109, 150.60929096255072, 301.73133922477973, 103.08905692108321, 298.99731448377065, 225.20902571271887, 117.71000000000045, 248.71193702495722, 169.63358461402578, 122.98103496693204, 143.88572944469735, 148.57999999999998, 133.84050022550576, 129.32000000000028, 3.5799999999999645, -85.74359941042299, 16.492464227759722, -112.53083673818843, 98.28347920711317, 210.93343406086962, 63.37999999999998, 208.2299999999994, 37.060000000000066, 54.044841000313106, 14.020611823582147, 189.61859953610056, 45.43000000000023, 243.77106523080712, 55.15688440805432, 261.3899999999988, 22.61516261714018, 28.100000000000012, 6.469999999999949, 12.12716736182963, 105.02644759256377, 105.23514454777263, -53.79157101184357, 85.48291413640739, 53.459999999999496, 116.5081631850941, 194.33003672645646, 34.93596517260668, -96.11444132385247, 185.04699453168075, 64.51999999999964, 33.87084023466064, -79.3794806628776, 34.033098335272484, 177.41580823109723, 114.67282329315474, 4.93821122229973, 117.70136970403348, 117.11491241392105, 3.6699999999999635, 55.662288125090285, 13.657817797563112, 10.229999999999931, 53.908778180720354, 84.9702156988312, -15.522778081521555, 38.43010834392663, 27.15666468600306, 67.6257861392871, -54.454044869692794, 37.06170941122194, 110.23387298716437, 21.93835672940952, 139.38604602250822, 3.589999999999963, 45.78074656348006, 44.65496989089144, 117.81215015943502, 46.727901478856666, 48.5284747159821, -40.33627193297932, 19.640613640064185, 20.260000000000424, 142.38374893444822, 14.689999999999953, -89.06666536713627, -10.621141201366727, 88.63227818953443, 79.75000000000054, 51.87318711470996, 36.23834348076492, 3.769999999999962, -249.78286625666345, 26.673502255841615, 193.12418466253717, 126.07932924736545, 11.83999999999994, 28.81970761737043, 17.36872152255596, 3.0199999999999783], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-83.62369109823413, -339.01331094631854, -77.71764260203082, -67.12472852040929, -483.0589426468806, -56.881052706288116, -238.22634400799188, -180.86745037391452, -672.6937319850135, 0.0830531390051128, -287.8911910463985, -47.967841912102024, -126.4762136840831, -206.22741164834252, -167.30377031692018, 132.68000000000006, -1.4666055582536828, -2.718948757980897, -467.5996739961256, 18.830000000000002, -409.1087230356697, -71.50703163746705, -33.73973788296111, -22.27484555294666, -129.96341479435938, -213.28222580563684, -358.7848621543833, -63.76584278109533, 2.0000000000000013, -398.86221637518713, -587.8282313489387, -478.83405587188486, -39.80838380533867, -188.58113788325252, -22.22947372436964, -100.78012282258771, -367.77340830508683, 39.55551040499073, 73.06922642984384, -531.9109334306095, 2.0000000000000013, -111.6394709622772, -507.4254000265379, -300.88387381037813, 2.0000000000000013, -45.70831074575526, -410.82748338102385, -364.96053242221353, -84.98307497096997, 56.33353960054801, 26.102962127426014, -124.30015874415531, -14.771377534996189, -171.33325467027905, 24.699078959360115, -49.703215022368234, -362.45405610452195, -147.12018972040113, -257.08745354717394, 2.0000000000000013, 2.0000000000000013, -45.90640920059732, -411.94652118799627, -586.4183533397769, -280.24348116563755, -139.71529680095753, 100.78310283670385, -71.38120240950089, -259.72718706386735, -194.08178034793735, 126.74000000000035, 133.11594922473284, -9.950240151723367, -49.19125060702851, -90.81129107132283, -115.4033672042816, -20.063245279285105, -166.0983415194958, -206.01029163791938, 2.0000000000000013, -0.2973375901211319, -178.3540014345237, -680.753358977539, -9.860771465639695, -524.88225710741, -570.1184682966644, -147.37295440084824, -313.8430381879237, 2.0000000000000013, 42.910336173998445, -190.78866594088564, -183.17666012852902, 25.55670465595077, -90.45448371890544, -66.60251858066688, -266.84928918031227, -385.6205666473368, -176.3596885135978, -829.7355080142493, -198.63694949252616, -159.97464979434244, -34.2725027754078, -116.8541775541336, -114.31881318940327, -331.6441287006768, -373.0745457646103, -330.0892333036455, -8.18133415576546, -605.3360197330711, -384.39216924154215, -293.1840799445425, -8.490033856279807, -240.33708408423837, -49.59710204912153, -237.70250655369992, -7.516938352795805, -330.46861421118683, -589.9659905344428, -37.07666742563903, -50.650653977068735, -123.4164279394197, 6.949999999999959, -134.80470680781903, -394.5622287423269, -207.52755992166823, -48.67979568202076, -14.068330836331205, -0.09315139909679032, -51.474672076733185, 2.0000000000000013, -270.8305186491081, -257.1351139959966, -77.5474601777743, -89.73592910709263, -98.98600232378422, -276.02521390366525, -363.3091342891277, -279.7140135306187, -90.88771958567034, -308.09052945375095, -85.05399077516877, -133.586390482752, 9.919999999999964, -230.47620891659574, -11.397640109998992, -26.27399330304413, -524.6271805142566, 2.0000000000000013, -10.577613166119011, -97.6932821716015, -165.57476333848558, -4.8289975641244, -248.13605490004022, -62.255652942143904, -195.56849314373764, -650.947535583323, -7.719832026444038, -206.75229145825605, -382.7726558126012, -0.02647825013284477, -207.36206966981723, -114.7065452384739, 2.0000000000000013, -40.11602884399984, -156.68193276679654, 2.0000000000000013, -347.3501686766657, -242.07590908023678, -292.0632416001927, -71.69310107040758, -519.8778373877597, -445.05731466706135, -227.81255114918915, -202.9997241972426, 2.0000000000000013, -287.0803752725458, -4.821962418750375, -27.154908169619755, -103.83343952149085, 22.79000000000028, -25.61277084068176, -112.49088421129493, -82.73288402819169, 2.0000000000000013, -429.13697276856533, -377.7761298328475, -66.48302178075116, 2.0000000000000013, -251.69880423473154, -547.6591732388881, -204.81555971328282, -567.5919428322118, -531.6591761296366, -61.993133483417296, -203.74386732552426, -250.07982483398942, -164.84468788064967, -43.642646778177486, -60.776646523609216, -221.0540854459463], "policy_predator_policy_reward": [290.7780100480784, 231.76194864776366, 180.28556676329328, 245.16387496943818, 518.6775966059353, 158.83497334627862, 257.94656290066865, 322.5162151984988, 521.9573179051473, 632.3684520005914, 182.0978419121021, 354.3111910463982, 251.68728118561268, 330.5503060841237, 165.71904257822172, 19.51401870124778, 193.54240722415975, 112.37448631685493, 31.09620914870877, 520.7625217684993, 257.98418525500193, 521.6288839019069, 0.0, 281.2236091486269, 447.7121064667404, 13.243534133254327, 309.21644530175007, 362.0461966586874, 158.53670674543582, 407.95909424377703, 651.688396125307, 537.9549260624482, 109.33791001887957, 262.93734111440864, 69.56947372437031, 202.02012282258784, 108.88789741673628, 353.17050070886586, 560.380933430609, 27.780773570156224, 0.0, 113.21947096227801, 420.10418391929187, 302.4614905071996, 12.787778905489803, 47.41299606802482, 616.5285298192015, 46.72864924584625, 39.395661661682375, 87.537352915853, 201.47335781767995, 107.6572728599202, 232.79325467027917, 16.691377534996263, 88.64713044972063, 144.58700561328763, 398.05405610452135, 148.58018972039994, 90.01550192492793, 219.11679262255842, 10.150611823582231, 47.776409200596945, 730.6866305795796, 457.29684348429345, 183.76529680095805, 281.6234811656363, 214.36916480360455, 0.0, 437.0204285647329, 71.94542325512559, 1.5340507752668162, 0.0, 2.0251626171399875, 79.73149075875152, 140.16039004549702, 94.15426823010776, 24.943245279285396, 167.68834151949434, 23.29401348370884, 192.8434455160395, 99.18056913359779, 184.49721748360992, 204.82913746322174, 591.0201375277284, 358.2227262585863, 682.9864281336435, 113.60748264226456, 433.09142408291456, 0.0, 8.549663826001327, 192.20609801512455, 298.2673912393818, 96.04077177827688, 163.18704401113388, 255.99628613470168, 112.39148679888457, 400.3588447893424, 65.5069690477365, 767.6885631394234, 445.73088889903323, 9.72249726206331, 249.04465530768562, 136.75484916141352, 128.28898181678596, 428.27632755851045, 197.0628662438991, 168.7735658276486, 203.5300999670341, 607.2244680711262, 559.9195291345841, 155.0608358144257, 261.2861012795481, 166.96326698555072, 127.90913037010893, 107.16692778468146, 255.75388682584537, 578.2770425667072, 459.272474592842, 52.43065397706838, 38.966667425638654, 82.484887539841, 89.64382852467041, 245.87039100592818, 297.15436234177866, 50.44979568202042, 215.98755992166716, 32.09786067740689, 35.97239973874187, 3.4966692647294964, 130.9482185108341, 349.63048865158964, 162.81236591199178, 53.45873939048939, 152.25475823830578, 363.5236636618212, 38.64421725163038, 367.228184421137, 343.42074953789574, 318.87707657736104, 25.64712759236771, 88.49452396613282, 167.20756670300958, 228.97655090175365, 101.81353100200334, 37.63710549355824, 21.97288464889408, 461.6975451669037, 200.3156813698611, 12.51761316611897, 99.34328217160234, 147.97630356425623, 68.20820390183341, 249.39605490003913, 105.6506228330355, 564.0045647487221, 400.3236141377727, 84.22690758157874, 176.97311738197746, 158.1714879466869, 273.1561208320292, 258.4211935764301, 23.311149398881692, 19.18209845585987, 38.57454402820323, 3.9349303213017865, 171.00700244549438, 402.6103932780543, 329.199433413296, 58.80781138370426, 319.63853128689686, 675.2369423509156, 200.63154433676718, 204.04562517690513, 216.1455089681578, 164.99978502979963, 208.71286843227875, 104.94490816961965, 6.781962418750333, 102.49850329755587, 30.418123338646513, 110.75920144792349, 63.58279708481972, 68.7048648643254, 15.798019163866925, 545.6834373286866, 11.44679901606267, 34.829428243629366, 56.32709579296372, 292.0597781100661, 700.422384026091, 494.2616593207936, 404.22517247206514, 72.633133483417, 532.8591761296356, 289.1174224680867, 193.52597730879683, 181.37242562352975, 44.48363055785177, 173.81058204747234, 111.04014992208312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9351302739055802, "mean_inference_ms": 2.296413371858057, "mean_action_processing_ms": 0.3805816072368543, "mean_env_wait_ms": 0.3032421500263897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003450155258178711, "StateBufferConnector_ms": 0.002843141555786133, "ViewRequirementAgentConnector_ms": 0.08224248886108398}, "num_episodes": 18, "episode_return_max": 481.7150910597302, "episode_return_min": -249.78286625666345, "episode_return_mean": 79.68391697695557, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.6993584422789, "num_env_steps_trained_throughput_per_sec": 437.6993584422789, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9920.314, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9920.279, "sample_time_ms": 1359.054, "learn_time_ms": 8548.822, "learn_throughput": 467.901, "synch_weights_time_ms": 11.592}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "1f15c_00000", "date": "2024-08-16_14-05-11", "timestamp": 1723797311, "time_this_iter_s": 9.141618013381958, "time_total_s": 117.06210398674011, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8ba700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 117.06210398674011, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 23.353846153846153, "ram_util_percent": 71.4230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1468550942089193, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9603561339554965, "policy_loss": -0.010652423677990637, "vf_loss": 3.969037267770717, "vf_explained_var": -0.0007426457745688302, "kl": 0.009856504251507173, "entropy": 1.4898117444502614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.433314014852993, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.115632514348106, "policy_loss": -0.005417084390366519, "vf_loss": 4.119556825880021, "vf_explained_var": -0.004917641764595395, "kl": 0.01492769449020027, "entropy": 1.4258119952111017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 261.3899999999988, "episode_reward_min": -249.78286625666345, "episode_reward_mean": 42.941601068978386, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1003.0524124678197, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 133.11594922473284, "predator_policy": 1003.2824124678198}, "policy_reward_mean": {"prey_policy": -179.2118252348185, "predator_policy": 200.6826257693074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.84050022550576, 129.32000000000028, 3.5799999999999645, -85.74359941042299, 16.492464227759722, -112.53083673818843, 98.28347920711317, 210.93343406086962, 63.37999999999998, 208.2299999999994, 37.060000000000066, 54.044841000313106, 14.020611823582147, 189.61859953610056, 45.43000000000023, 243.77106523080712, 55.15688440805432, 261.3899999999988, 22.61516261714018, 28.100000000000012, 6.469999999999949, 12.12716736182963, 105.02644759256377, 105.23514454777263, -53.79157101184357, 85.48291413640739, 53.459999999999496, 116.5081631850941, 194.33003672645646, 34.93596517260668, -96.11444132385247, 185.04699453168075, 64.51999999999964, 33.87084023466064, -79.3794806628776, 34.033098335272484, 177.41580823109723, 114.67282329315474, 4.93821122229973, 117.70136970403348, 117.11491241392105, 3.6699999999999635, 55.662288125090285, 13.657817797563112, 10.229999999999931, 53.908778180720354, 84.9702156988312, -15.522778081521555, 38.43010834392663, 27.15666468600306, 67.6257861392871, -54.454044869692794, 37.06170941122194, 110.23387298716437, 21.93835672940952, 139.38604602250822, 3.589999999999963, 45.78074656348006, 44.65496989089144, 117.81215015943502, 46.727901478856666, 48.5284747159821, -40.33627193297932, 19.640613640064185, 20.260000000000424, 142.38374893444822, 14.689999999999953, -89.06666536713627, -10.621141201366727, 88.63227818953443, 79.75000000000054, 51.87318711470996, 36.23834348076492, 3.769999999999962, -249.78286625666345, 26.673502255841615, 193.12418466253717, 126.07932924736545, 11.83999999999994, 28.81970761737043, 17.36872152255596, 3.0199999999999783, 7.989999999999942, 3.7899999999999614, 33.472862650102506, 26.50000000000034, -9.473754593449394, 3.039999999999976, 16.66534907362336, 2.229999999999973, -63.01722334414506, -240.2713219234741, 25.11363220509329, 11.639999999999946, 28.329643866780785, -0.16287580345629138, 3.379999999999971, 120.79620573541548, -4.8151567337646215, 2.949999999999972], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-367.77340830508683, 39.55551040499073, 73.06922642984384, -531.9109334306095, 2.0000000000000013, -111.6394709622772, -507.4254000265379, -300.88387381037813, 2.0000000000000013, -45.70831074575526, -410.82748338102385, -364.96053242221353, -84.98307497096997, 56.33353960054801, 26.102962127426014, -124.30015874415531, -14.771377534996189, -171.33325467027905, 24.699078959360115, -49.703215022368234, -362.45405610452195, -147.12018972040113, -257.08745354717394, 2.0000000000000013, 2.0000000000000013, -45.90640920059732, -411.94652118799627, -586.4183533397769, -280.24348116563755, -139.71529680095753, 100.78310283670385, -71.38120240950089, -259.72718706386735, -194.08178034793735, 126.74000000000035, 133.11594922473284, -9.950240151723367, -49.19125060702851, -90.81129107132283, -115.4033672042816, -20.063245279285105, -166.0983415194958, -206.01029163791938, 2.0000000000000013, -0.2973375901211319, -178.3540014345237, -680.753358977539, -9.860771465639695, -524.88225710741, -570.1184682966644, -147.37295440084824, -313.8430381879237, 2.0000000000000013, 42.910336173998445, -190.78866594088564, -183.17666012852902, 25.55670465595077, -90.45448371890544, -66.60251858066688, -266.84928918031227, -385.6205666473368, -176.3596885135978, -829.7355080142493, -198.63694949252616, -159.97464979434244, -34.2725027754078, -116.8541775541336, -114.31881318940327, -331.6441287006768, -373.0745457646103, -330.0892333036455, -8.18133415576546, -605.3360197330711, -384.39216924154215, -293.1840799445425, -8.490033856279807, -240.33708408423837, -49.59710204912153, -237.70250655369992, -7.516938352795805, -330.46861421118683, -589.9659905344428, -37.07666742563903, -50.650653977068735, -123.4164279394197, 6.949999999999959, -134.80470680781903, -394.5622287423269, -207.52755992166823, -48.67979568202076, -14.068330836331205, -0.09315139909679032, -51.474672076733185, 2.0000000000000013, -270.8305186491081, -257.1351139959966, -77.5474601777743, -89.73592910709263, -98.98600232378422, -276.02521390366525, -363.3091342891277, -279.7140135306187, -90.88771958567034, -308.09052945375095, -85.05399077516877, -133.586390482752, 9.919999999999964, -230.47620891659574, -11.397640109998992, -26.27399330304413, -524.6271805142566, 2.0000000000000013, -10.577613166119011, -97.6932821716015, -165.57476333848558, -4.8289975641244, -248.13605490004022, -62.255652942143904, -195.56849314373764, -650.947535583323, -7.719832026444038, -206.75229145825605, -382.7726558126012, -0.02647825013284477, -207.36206966981723, -114.7065452384739, 2.0000000000000013, -40.11602884399984, -156.68193276679654, 2.0000000000000013, -347.3501686766657, -242.07590908023678, -292.0632416001927, -71.69310107040758, -519.8778373877597, -445.05731466706135, -227.81255114918915, -202.9997241972426, 2.0000000000000013, -287.0803752725458, -4.821962418750375, -27.154908169619755, -103.83343952149085, 22.79000000000028, -25.61277084068176, -112.49088421129493, -82.73288402819169, 2.0000000000000013, -429.13697276856533, -377.7761298328475, -66.48302178075116, 2.0000000000000013, -251.69880423473154, -547.6591732388881, -204.81555971328282, -567.5919428322118, -531.6591761296366, -61.993133483417296, -203.74386732552426, -250.07982483398942, -164.84468788064967, -43.642646778177486, -60.776646523609216, -221.0540854459463, -162.68865536164995, -158.01322742492786, -46.22285107789831, 2.0000000000000013, -230.97856370945033, -210.8509981122469, -115.99890710428633, -209.21726437479168, -118.72959002342591, -19.107654051918672, -137.86538717807272, -160.34594033423627, -622.1827575779364, -17.064309497888118, -1003.0524124678197, 2.0000000000000013, -187.612565661785, -159.51929683819785, -318.16618079452473, -360.1481094017891, -177.683448937761, -352.1364367469713, -270.28264250605986, -104.09971294905587, -266.7241114177829, 15.85999999999996, -135.1498510479314, -62.08597886217412, -63.64021205409699, -189.3886275881305, -268.173896378253, -116.40518357344986, -226.49425569499715, -296.8297228662637, -160.5651964358122, -407.02640956682586], "policy_predator_policy_reward": [108.88789741673628, 353.17050070886586, 560.380933430609, 27.780773570156224, 0.0, 113.21947096227801, 420.10418391929187, 302.4614905071996, 12.787778905489803, 47.41299606802482, 616.5285298192015, 46.72864924584625, 39.395661661682375, 87.537352915853, 201.47335781767995, 107.6572728599202, 232.79325467027917, 16.691377534996263, 88.64713044972063, 144.58700561328763, 398.05405610452135, 148.58018972039994, 90.01550192492793, 219.11679262255842, 10.150611823582231, 47.776409200596945, 730.6866305795796, 457.29684348429345, 183.76529680095805, 281.6234811656363, 214.36916480360455, 0.0, 437.0204285647329, 71.94542325512559, 1.5340507752668162, 0.0, 2.0251626171399875, 79.73149075875152, 140.16039004549702, 94.15426823010776, 24.943245279285396, 167.68834151949434, 23.29401348370884, 192.8434455160395, 99.18056913359779, 184.49721748360992, 204.82913746322174, 591.0201375277284, 358.2227262585863, 682.9864281336435, 113.60748264226456, 433.09142408291456, 0.0, 8.549663826001327, 192.20609801512455, 298.2673912393818, 96.04077177827688, 163.18704401113388, 255.99628613470168, 112.39148679888457, 400.3588447893424, 65.5069690477365, 767.6885631394234, 445.73088889903323, 9.72249726206331, 249.04465530768562, 136.75484916141352, 128.28898181678596, 428.27632755851045, 197.0628662438991, 168.7735658276486, 203.5300999670341, 607.2244680711262, 559.9195291345841, 155.0608358144257, 261.2861012795481, 166.96326698555072, 127.90913037010893, 107.16692778468146, 255.75388682584537, 578.2770425667072, 459.272474592842, 52.43065397706838, 38.966667425638654, 82.484887539841, 89.64382852467041, 245.87039100592818, 297.15436234177866, 50.44979568202042, 215.98755992166716, 32.09786067740689, 35.97239973874187, 3.4966692647294964, 130.9482185108341, 349.63048865158964, 162.81236591199178, 53.45873939048939, 152.25475823830578, 363.5236636618212, 38.64421725163038, 367.228184421137, 343.42074953789574, 318.87707657736104, 25.64712759236771, 88.49452396613282, 167.20756670300958, 228.97655090175365, 101.81353100200334, 37.63710549355824, 21.97288464889408, 461.6975451669037, 200.3156813698611, 12.51761316611897, 99.34328217160234, 147.97630356425623, 68.20820390183341, 249.39605490003913, 105.6506228330355, 564.0045647487221, 400.3236141377727, 84.22690758157874, 176.97311738197746, 158.1714879466869, 273.1561208320292, 258.4211935764301, 23.311149398881692, 19.18209845585987, 38.57454402820323, 3.9349303213017865, 171.00700244549438, 402.6103932780543, 329.199433413296, 58.80781138370426, 319.63853128689686, 675.2369423509156, 200.63154433676718, 204.04562517690513, 216.1455089681578, 164.99978502979963, 208.71286843227875, 104.94490816961965, 6.781962418750333, 102.49850329755587, 30.418123338646513, 110.75920144792349, 63.58279708481972, 68.7048648643254, 15.798019163866925, 545.6834373286866, 11.44679901606267, 34.829428243629366, 56.32709579296372, 292.0597781100661, 700.422384026091, 494.2616593207936, 404.22517247206514, 72.633133483417, 532.8591761296356, 289.1174224680867, 193.52597730879683, 181.37242562352975, 44.48363055785177, 173.81058204747234, 111.04014992208312, 267.9819328812219, 60.70994990535451, 48.01285107789797, 0.0, 203.61267869813642, 271.68974577366095, 141.27890710428682, 210.4372643747906, 39.10626838495048, 89.25722109694597, 250.6190583230049, 50.63226918930166, 37.12724584278307, 618.7851703066648, 1003.2824124678198, 0.0, 120.68571725042095, 163.42892190541463, 24.862428363280742, 413.1805399095592, 296.0247128530006, 258.90880503682297, 280.27264250605907, 105.74971294905671, 27.421933581459143, 251.77182170310329, 161.99400078549314, 35.07895332115411, 191.048627588129, 65.36021205409759, 254.8460013988496, 250.52928428826885, 125.18522779900893, 393.3235940284856, 509.1364999161211, 61.405106086514984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8920103330306833, "mean_inference_ms": 2.1927965774367304, "mean_action_processing_ms": 0.36374737093040116, "mean_env_wait_ms": 0.28966138010576925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034924745559692383, "StateBufferConnector_ms": 0.0028475522994995117, "ViewRequirementAgentConnector_ms": 0.08283352851867676}, "num_episodes": 18, "episode_return_max": 261.3899999999988, "episode_return_min": -249.78286625666345, "episode_return_mean": 42.941601068978386, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.8533455841765, "num_env_steps_trained_throughput_per_sec": 427.8533455841765, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9270.249, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9270.215, "sample_time_ms": 1016.769, "learn_time_ms": 8240.809, "learn_throughput": 485.389, "synch_weights_time_ms": 11.809}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "1f15c_00000", "date": "2024-08-16_14-05-20", "timestamp": 1723797320, "time_this_iter_s": 9.352360963821411, "time_total_s": 126.41446495056152, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8ad430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.41446495056152, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.892307692307693, "ram_util_percent": 71.1846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1405436259886574, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.618947080077318, "policy_loss": -0.008194977260643133, "vf_loss": 4.6253455131772965, "vf_explained_var": 0.002877481936146973, "kl": 0.008982704854210766, "entropy": 1.5056157977492721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8022621019334388, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.890645944252216, "policy_loss": -0.006179904731769095, "vf_loss": 5.895053455817005, "vf_explained_var": 0.00969861389467956, "kl": 0.017723763073657202, "entropy": 1.4345355946550924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 194.33003672645646, "episode_reward_min": -249.78286625666345, "episode_reward_mean": 30.86839251703846, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1003.0524124678197, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 49.519999999999925, "predator_policy": 1003.2824124678198}, "policy_reward_mean": {"prey_policy": -189.02834693789714, "predator_policy": 204.4625431964161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.61516261714018, 28.100000000000012, 6.469999999999949, 12.12716736182963, 105.02644759256377, 105.23514454777263, -53.79157101184357, 85.48291413640739, 53.459999999999496, 116.5081631850941, 194.33003672645646, 34.93596517260668, -96.11444132385247, 185.04699453168075, 64.51999999999964, 33.87084023466064, -79.3794806628776, 34.033098335272484, 177.41580823109723, 114.67282329315474, 4.93821122229973, 117.70136970403348, 117.11491241392105, 3.6699999999999635, 55.662288125090285, 13.657817797563112, 10.229999999999931, 53.908778180720354, 84.9702156988312, -15.522778081521555, 38.43010834392663, 27.15666468600306, 67.6257861392871, -54.454044869692794, 37.06170941122194, 110.23387298716437, 21.93835672940952, 139.38604602250822, 3.589999999999963, 45.78074656348006, 44.65496989089144, 117.81215015943502, 46.727901478856666, 48.5284747159821, -40.33627193297932, 19.640613640064185, 20.260000000000424, 142.38374893444822, 14.689999999999953, -89.06666536713627, -10.621141201366727, 88.63227818953443, 79.75000000000054, 51.87318711470996, 36.23834348076492, 3.769999999999962, -249.78286625666345, 26.673502255841615, 193.12418466253717, 126.07932924736545, 11.83999999999994, 28.81970761737043, 17.36872152255596, 3.0199999999999783, 7.989999999999942, 3.7899999999999614, 33.472862650102506, 26.50000000000034, -9.473754593449394, 3.039999999999976, 16.66534907362336, 2.229999999999973, -63.01722334414506, -240.2713219234741, 25.11363220509329, 11.639999999999946, 28.329643866780785, -0.16287580345629138, 3.379999999999971, 120.79620573541548, -4.8151567337646215, 2.949999999999972, 26.839405362407316, 12.084423194325069, -113.41983298814864, -0.3344816904574488, 151.8117528357094, -5.409092569585314, 61.87297193099043, 3.1999999999999753, 20.524285358326285, -0.8260679774998212, 56.732766240260275, 66.6099999999995, 55.359999999999694, 51.902459221569345, 29.734492361584458, 41.05720621841233, -152.30506201575744, 53.52136289536379], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.950240151723367, -49.19125060702851, -90.81129107132283, -115.4033672042816, -20.063245279285105, -166.0983415194958, -206.01029163791938, 2.0000000000000013, -0.2973375901211319, -178.3540014345237, -680.753358977539, -9.860771465639695, -524.88225710741, -570.1184682966644, -147.37295440084824, -313.8430381879237, 2.0000000000000013, 42.910336173998445, -190.78866594088564, -183.17666012852902, 25.55670465595077, -90.45448371890544, -66.60251858066688, -266.84928918031227, -385.6205666473368, -176.3596885135978, -829.7355080142493, -198.63694949252616, -159.97464979434244, -34.2725027754078, -116.8541775541336, -114.31881318940327, -331.6441287006768, -373.0745457646103, -330.0892333036455, -8.18133415576546, -605.3360197330711, -384.39216924154215, -293.1840799445425, -8.490033856279807, -240.33708408423837, -49.59710204912153, -237.70250655369992, -7.516938352795805, -330.46861421118683, -589.9659905344428, -37.07666742563903, -50.650653977068735, -123.4164279394197, 6.949999999999959, -134.80470680781903, -394.5622287423269, -207.52755992166823, -48.67979568202076, -14.068330836331205, -0.09315139909679032, -51.474672076733185, 2.0000000000000013, -270.8305186491081, -257.1351139959966, -77.5474601777743, -89.73592910709263, -98.98600232378422, -276.02521390366525, -363.3091342891277, -279.7140135306187, -90.88771958567034, -308.09052945375095, -85.05399077516877, -133.586390482752, 9.919999999999964, -230.47620891659574, -11.397640109998992, -26.27399330304413, -524.6271805142566, 2.0000000000000013, -10.577613166119011, -97.6932821716015, -165.57476333848558, -4.8289975641244, -248.13605490004022, -62.255652942143904, -195.56849314373764, -650.947535583323, -7.719832026444038, -206.75229145825605, -382.7726558126012, -0.02647825013284477, -207.36206966981723, -114.7065452384739, 2.0000000000000013, -40.11602884399984, -156.68193276679654, 2.0000000000000013, -347.3501686766657, -242.07590908023678, -292.0632416001927, -71.69310107040758, -519.8778373877597, -445.05731466706135, -227.81255114918915, -202.9997241972426, 2.0000000000000013, -287.0803752725458, -4.821962418750375, -27.154908169619755, -103.83343952149085, 22.79000000000028, -25.61277084068176, -112.49088421129493, -82.73288402819169, 2.0000000000000013, -429.13697276856533, -377.7761298328475, -66.48302178075116, 2.0000000000000013, -251.69880423473154, -547.6591732388881, -204.81555971328282, -567.5919428322118, -531.6591761296366, -61.993133483417296, -203.74386732552426, -250.07982483398942, -164.84468788064967, -43.642646778177486, -60.776646523609216, -221.0540854459463, -162.68865536164995, -158.01322742492786, -46.22285107789831, 2.0000000000000013, -230.97856370945033, -210.8509981122469, -115.99890710428633, -209.21726437479168, -118.72959002342591, -19.107654051918672, -137.86538717807272, -160.34594033423627, -622.1827575779364, -17.064309497888118, -1003.0524124678197, 2.0000000000000013, -187.612565661785, -159.51929683819785, -318.16618079452473, -360.1481094017891, -177.683448937761, -352.1364367469713, -270.28264250605986, -104.09971294905587, -266.7241114177829, 15.85999999999996, -135.1498510479314, -62.08597886217412, -63.64021205409699, -189.3886275881305, -268.173896378253, -116.40518357344986, -226.49425569499715, -296.8297228662637, -160.5651964358122, -407.02640956682586, -110.16068306814931, 2.0000000000000013, -118.75418439336346, 2.0000000000000013, -648.627239669584, -262.0877384302077, -459.8492459743856, -308.8220663537199, 2.0000000000000013, -309.948506097238, -60.49944823847796, -112.91315470416588, -51.81190902943329, -21.736597303589786, -255.3831833643069, 2.0000000000000013, -86.89721438543896, -125.07708193130271, -18.80203155835983, -169.53105739205128, -80.0926782542829, -56.76535256604607, -896.6171121269666, 32.70381460306924, 2.065515134774204, 21.96804181499505, 49.519999999999925, -718.0318863084019, -170.16735551910736, -66.28225469402857, -561.7983460080941, -192.41851496060937, -172.92648504206846, -521.8433699562162, -759.8690967130848, -13.750973457297677], "policy_predator_policy_reward": [2.0251626171399875, 79.73149075875152, 140.16039004549702, 94.15426823010776, 24.943245279285396, 167.68834151949434, 23.29401348370884, 192.8434455160395, 99.18056913359779, 184.49721748360992, 204.82913746322174, 591.0201375277284, 358.2227262585863, 682.9864281336435, 113.60748264226456, 433.09142408291456, 0.0, 8.549663826001327, 192.20609801512455, 298.2673912393818, 96.04077177827688, 163.18704401113388, 255.99628613470168, 112.39148679888457, 400.3588447893424, 65.5069690477365, 767.6885631394234, 445.73088889903323, 9.72249726206331, 249.04465530768562, 136.75484916141352, 128.28898181678596, 428.27632755851045, 197.0628662438991, 168.7735658276486, 203.5300999670341, 607.2244680711262, 559.9195291345841, 155.0608358144257, 261.2861012795481, 166.96326698555072, 127.90913037010893, 107.16692778468146, 255.75388682584537, 578.2770425667072, 459.272474592842, 52.43065397706838, 38.966667425638654, 82.484887539841, 89.64382852467041, 245.87039100592818, 297.15436234177866, 50.44979568202042, 215.98755992166716, 32.09786067740689, 35.97239973874187, 3.4966692647294964, 130.9482185108341, 349.63048865158964, 162.81236591199178, 53.45873939048939, 152.25475823830578, 363.5236636618212, 38.64421725163038, 367.228184421137, 343.42074953789574, 318.87707657736104, 25.64712759236771, 88.49452396613282, 167.20756670300958, 228.97655090175365, 101.81353100200334, 37.63710549355824, 21.97288464889408, 461.6975451669037, 200.3156813698611, 12.51761316611897, 99.34328217160234, 147.97630356425623, 68.20820390183341, 249.39605490003913, 105.6506228330355, 564.0045647487221, 400.3236141377727, 84.22690758157874, 176.97311738197746, 158.1714879466869, 273.1561208320292, 258.4211935764301, 23.311149398881692, 19.18209845585987, 38.57454402820323, 3.9349303213017865, 171.00700244549438, 402.6103932780543, 329.199433413296, 58.80781138370426, 319.63853128689686, 675.2369423509156, 200.63154433676718, 204.04562517690513, 216.1455089681578, 164.99978502979963, 208.71286843227875, 104.94490816961965, 6.781962418750333, 102.49850329755587, 30.418123338646513, 110.75920144792349, 63.58279708481972, 68.7048648643254, 15.798019163866925, 545.6834373286866, 11.44679901606267, 34.829428243629366, 56.32709579296372, 292.0597781100661, 700.422384026091, 494.2616593207936, 404.22517247206514, 72.633133483417, 532.8591761296356, 289.1174224680867, 193.52597730879683, 181.37242562352975, 44.48363055785177, 173.81058204747234, 111.04014992208312, 267.9819328812219, 60.70994990535451, 48.01285107789797, 0.0, 203.61267869813642, 271.68974577366095, 141.27890710428682, 210.4372643747906, 39.10626838495048, 89.25722109694597, 250.6190583230049, 50.63226918930166, 37.12724584278307, 618.7851703066648, 1003.2824124678198, 0.0, 120.68571725042095, 163.42892190541463, 24.862428363280742, 413.1805399095592, 296.0247128530006, 258.90880503682297, 280.27264250605907, 105.74971294905671, 27.421933581459143, 251.77182170310329, 161.99400078549314, 35.07895332115411, 191.048627588129, 65.36021205409759, 254.8460013988496, 250.52928428826885, 125.18522779900893, 393.3235940284856, 509.1364999161211, 61.405106086514984, 42.49046409311803, 92.50962433743888, 57.04131317439887, 71.7972944132905, 719.2220582140267, 78.07308689761548, 310.24398654487624, 458.09284409277063, 306.10062894176167, 153.6596299911845, 105.68406213458108, 62.3194482384776, 50.8552116453215, 84.56626661869272, 256.58318336430705, 0.0, 125.96340215134667, 106.53517952372269, 16.475963580860082, 171.03105739205046, 97.03535256604623, 96.55544449454435, 897.0371121269667, 33.4861853969307, 18.58195818500497, 12.744484865225793, 718.471886308402, 1.942459221569399, 114.96772941874654, 151.21637315597383, 324.7482609244626, 470.5258062626525, 2.78972288769041, 539.6750700948362, 261.5768228930766, 565.5646101726696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.85738022827256, "mean_inference_ms": 2.1094764200156986, "mean_action_processing_ms": 0.35021932506420195, "mean_env_wait_ms": 0.27880815829575795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034815073013305664, "StateBufferConnector_ms": 0.0028287172317504883, "ViewRequirementAgentConnector_ms": 0.08334565162658691}, "num_episodes": 18, "episode_return_max": 194.33003672645646, "episode_return_min": -249.78286625666345, "episode_return_mean": 30.86839251703846, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.79044465736143, "num_env_steps_trained_throughput_per_sec": 431.79044465736143, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 9248.484, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9248.45, "sample_time_ms": 996.158, "learn_time_ms": 8239.571, "learn_throughput": 485.462, "synch_weights_time_ms": 11.902}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "1f15c_00000", "date": "2024-08-16_14-05-29", "timestamp": 1723797329, "time_this_iter_s": 9.267966270446777, "time_total_s": 135.6824312210083, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8ade50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.6824312210083, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 23.592307692307696, "ram_util_percent": 70.96923076923076}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.944388053104991, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.297523503581052, "policy_loss": -0.011606966282201625, "vf_loss": 6.306210802219532, "vf_explained_var": 0.003289171564515936, "kl": 0.014598355569849628, "entropy": 1.4947760544756732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9386902674165352, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.422487000056676, "policy_loss": -0.0057192916555635675, "vf_loss": 7.427274969141319, "vf_explained_var": 0.020900723196211314, "kl": 0.00931339187591738, "entropy": 1.4067331939778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 465.6870138887404, "episode_reward_min": -641.3864883198153, "episode_reward_mean": 23.599373031743976, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1462.6135258499994, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 108.92000000000034, "predator_policy": 1451.5374503073517}, "policy_reward_mean": {"prey_policy": -227.94154347155853, "predator_policy": 239.74122998743033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.908778180720354, 84.9702156988312, -15.522778081521555, 38.43010834392663, 27.15666468600306, 67.6257861392871, -54.454044869692794, 37.06170941122194, 110.23387298716437, 21.93835672940952, 139.38604602250822, 3.589999999999963, 45.78074656348006, 44.65496989089144, 117.81215015943502, 46.727901478856666, 48.5284747159821, -40.33627193297932, 19.640613640064185, 20.260000000000424, 142.38374893444822, 14.689999999999953, -89.06666536713627, -10.621141201366727, 88.63227818953443, 79.75000000000054, 51.87318711470996, 36.23834348076492, 3.769999999999962, -249.78286625666345, 26.673502255841615, 193.12418466253717, 126.07932924736545, 11.83999999999994, 28.81970761737043, 17.36872152255596, 3.0199999999999783, 7.989999999999942, 3.7899999999999614, 33.472862650102506, 26.50000000000034, -9.473754593449394, 3.039999999999976, 16.66534907362336, 2.229999999999973, -63.01722334414506, -240.2713219234741, 25.11363220509329, 11.639999999999946, 28.329643866780785, -0.16287580345629138, 3.379999999999971, 120.79620573541548, -4.8151567337646215, 2.949999999999972, 26.839405362407316, 12.084423194325069, -113.41983298814864, -0.3344816904574488, 151.8117528357094, -5.409092569585314, 61.87297193099043, 3.1999999999999753, 20.524285358326285, -0.8260679774998212, 56.732766240260275, 66.6099999999995, 55.359999999999694, 51.902459221569345, 29.734492361584458, 41.05720621841233, -152.30506201575744, 53.52136289536379, 77.99249496017418, -232.620058988063, -641.3864883198153, 56.77721410444442, 60.16999999999986, 56.18999999999985, 12.109999999999939, 18.560000000000194, 114.67803886795542, 10.589999999999923, -266.5074262324573, -214.78710694853237, 5.589602895922134, 32.696182860341665, 31.369401021874985, 13.332633960141228, 46.59999999999991, 371.84896929461337, -144.89902763346342, 161.02760704062527, 363.05266301184764, 37.77144762663959, 59.560901054468154, 47.37999999999981, 45.17000000000002, 465.6870138887404, 152.68366123516486], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.068330836331205, -0.09315139909679032, -51.474672076733185, 2.0000000000000013, -270.8305186491081, -257.1351139959966, -77.5474601777743, -89.73592910709263, -98.98600232378422, -276.02521390366525, -363.3091342891277, -279.7140135306187, -90.88771958567034, -308.09052945375095, -85.05399077516877, -133.586390482752, 9.919999999999964, -230.47620891659574, -11.397640109998992, -26.27399330304413, -524.6271805142566, 2.0000000000000013, -10.577613166119011, -97.6932821716015, -165.57476333848558, -4.8289975641244, -248.13605490004022, -62.255652942143904, -195.56849314373764, -650.947535583323, -7.719832026444038, -206.75229145825605, -382.7726558126012, -0.02647825013284477, -207.36206966981723, -114.7065452384739, 2.0000000000000013, -40.11602884399984, -156.68193276679654, 2.0000000000000013, -347.3501686766657, -242.07590908023678, -292.0632416001927, -71.69310107040758, -519.8778373877597, -445.05731466706135, -227.81255114918915, -202.9997241972426, 2.0000000000000013, -287.0803752725458, -4.821962418750375, -27.154908169619755, -103.83343952149085, 22.79000000000028, -25.61277084068176, -112.49088421129493, -82.73288402819169, 2.0000000000000013, -429.13697276856533, -377.7761298328475, -66.48302178075116, 2.0000000000000013, -251.69880423473154, -547.6591732388881, -204.81555971328282, -567.5919428322118, -531.6591761296366, -61.993133483417296, -203.74386732552426, -250.07982483398942, -164.84468788064967, -43.642646778177486, -60.776646523609216, -221.0540854459463, -162.68865536164995, -158.01322742492786, -46.22285107789831, 2.0000000000000013, -230.97856370945033, -210.8509981122469, -115.99890710428633, -209.21726437479168, -118.72959002342591, -19.107654051918672, -137.86538717807272, -160.34594033423627, -622.1827575779364, -17.064309497888118, -1003.0524124678197, 2.0000000000000013, -187.612565661785, -159.51929683819785, -318.16618079452473, -360.1481094017891, -177.683448937761, -352.1364367469713, -270.28264250605986, -104.09971294905587, -266.7241114177829, 15.85999999999996, -135.1498510479314, -62.08597886217412, -63.64021205409699, -189.3886275881305, -268.173896378253, -116.40518357344986, -226.49425569499715, -296.8297228662637, -160.5651964358122, -407.02640956682586, -110.16068306814931, 2.0000000000000013, -118.75418439336346, 2.0000000000000013, -648.627239669584, -262.0877384302077, -459.8492459743856, -308.8220663537199, 2.0000000000000013, -309.948506097238, -60.49944823847796, -112.91315470416588, -51.81190902943329, -21.736597303589786, -255.3831833643069, 2.0000000000000013, -86.89721438543896, -125.07708193130271, -18.80203155835983, -169.53105739205128, -80.0926782542829, -56.76535256604607, -896.6171121269666, 32.70381460306924, 2.065515134774204, 21.96804181499505, 49.519999999999925, -718.0318863084019, -170.16735551910736, -66.28225469402857, -561.7983460080941, -192.41851496060937, -172.92648504206846, -521.8433699562162, -759.8690967130848, -13.750973457297677, -388.57221046976116, -793.7921342043029, -611.69925078483, -597.609715903935, -1130.9669473485508, -1023.0634246050729, -35.3390088750101, -40.9642727963555, -1193.2848433580025, 1.9856104160852823, -33.95157779463218, -956.0000648588409, -215.310190742401, -47.133468888083684, -19.423093837599282, -28.659631645572947, 108.92000000000034, -31.438214029959095, -71.5585015190943, 7.939999999999959, -855.6624834917022, -445.5255742178235, -728.8518032615775, -397.37943382256327, -198.82832902486422, -7.7235282866777855, 22.790000000000177, -196.9707563887544, 2.0000000000000013, -76.20757533947399, -182.74197329446326, -355.56880685951035, -23.360058220456462, -944.9658149152955, -1125.0311040621834, 39.997715579502874, -176.51488648099206, -237.26279345226348, 73.29946499181138, -51.718728119648404, -981.4735978193435, 6.949999999999958, -475.70050489170734, -31.443711435188323, -141.88641029500337, -639.0806064828107, -11.257928076154318, 12.260845567075542, 2.0408503600229047, -104.13857515328381, -1462.6135258499994, -514.4353212904724, -596.0190105906714, -483.6298694755449], "policy_predator_policy_reward": [32.09786067740689, 35.97239973874187, 3.4966692647294964, 130.9482185108341, 349.63048865158964, 162.81236591199178, 53.45873939048939, 152.25475823830578, 363.5236636618212, 38.64421725163038, 367.228184421137, 343.42074953789574, 318.87707657736104, 25.64712759236771, 88.49452396613282, 167.20756670300958, 228.97655090175365, 101.81353100200334, 37.63710549355824, 21.97288464889408, 461.6975451669037, 200.3156813698611, 12.51761316611897, 99.34328217160234, 147.97630356425623, 68.20820390183341, 249.39605490003913, 105.6506228330355, 564.0045647487221, 400.3236141377727, 84.22690758157874, 176.97311738197746, 158.1714879466869, 273.1561208320292, 258.4211935764301, 23.311149398881692, 19.18209845585987, 38.57454402820323, 3.9349303213017865, 171.00700244549438, 402.6103932780543, 329.199433413296, 58.80781138370426, 319.63853128689686, 675.2369423509156, 200.63154433676718, 204.04562517690513, 216.1455089681578, 164.99978502979963, 208.71286843227875, 104.94490816961965, 6.781962418750333, 102.49850329755587, 30.418123338646513, 110.75920144792349, 63.58279708481972, 68.7048648643254, 15.798019163866925, 545.6834373286866, 11.44679901606267, 34.829428243629366, 56.32709579296372, 292.0597781100661, 700.422384026091, 494.2616593207936, 404.22517247206514, 72.633133483417, 532.8591761296356, 289.1174224680867, 193.52597730879683, 181.37242562352975, 44.48363055785177, 173.81058204747234, 111.04014992208312, 267.9819328812219, 60.70994990535451, 48.01285107789797, 0.0, 203.61267869813642, 271.68974577366095, 141.27890710428682, 210.4372643747906, 39.10626838495048, 89.25722109694597, 250.6190583230049, 50.63226918930166, 37.12724584278307, 618.7851703066648, 1003.2824124678198, 0.0, 120.68571725042095, 163.42892190541463, 24.862428363280742, 413.1805399095592, 296.0247128530006, 258.90880503682297, 280.27264250605907, 105.74971294905671, 27.421933581459143, 251.77182170310329, 161.99400078549314, 35.07895332115411, 191.048627588129, 65.36021205409759, 254.8460013988496, 250.52928428826885, 125.18522779900893, 393.3235940284856, 509.1364999161211, 61.405106086514984, 42.49046409311803, 92.50962433743888, 57.04131317439887, 71.7972944132905, 719.2220582140267, 78.07308689761548, 310.24398654487624, 458.09284409277063, 306.10062894176167, 153.6596299911845, 105.68406213458108, 62.3194482384776, 50.8552116453215, 84.56626661869272, 256.58318336430705, 0.0, 125.96340215134667, 106.53517952372269, 16.475963580860082, 171.03105739205046, 97.03535256604623, 96.55544449454435, 897.0371121269667, 33.4861853969307, 18.58195818500497, 12.744484865225793, 718.471886308402, 1.942459221569399, 114.96772941874654, 151.21637315597383, 324.7482609244626, 470.5258062626525, 2.78972288769041, 539.6750700948362, 261.5768228930766, 565.5646101726696, 466.3365908192767, 794.0202488149611, 849.2451045495809, 127.44380315112076, 967.0330043919996, 545.6108792418073, 44.03873804375354, 89.04175773205662, 58.184389583914715, 1193.2848433580025, 956.0300648588409, 90.11157779463224, 225.58019074239985, 48.97346888808397, 36.11309383759953, 30.52963164557324, 3.9080388679547697, 33.28821402995896, 65.86409756569779, 8.344403953397347, 156.1066720154352, 878.5739594616339, 60.30825318001441, 851.1358769555935, 80.378523457622, 131.76293674984143, 198.18075638875342, 8.69618286034151, 78.07757533947495, 27.499401021874387, 415.57156060649373, 136.07185350761904, 69.7400582204564, 945.1858149152953, 542.1379613121932, 914.7443964651007, 264.492802347515, 4.385849952276912, 50.99762876059128, 88.44924140787032, 909.1487471364355, 428.427513694756, 103.66061614423204, 441.2550478093028, 259.66416681821556, 580.8637510140668, 41.81792807615436, 4.559154432924419, 105.79857515328455, 41.46914963997712, 991.1984107218599, 1451.5374503073517, 545.2374677356895, 687.0950735656901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8174872224630332, "mean_inference_ms": 2.0089339741127015, "mean_action_processing_ms": 0.3339159537656701, "mean_env_wait_ms": 0.26736997832900355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034613609313964844, "StateBufferConnector_ms": 0.0028002262115478516, "ViewRequirementAgentConnector_ms": 0.08333194255828857}, "num_episodes": 27, "episode_return_max": 465.6870138887404, "episode_return_min": -641.3864883198153, "episode_return_mean": 23.599373031743976, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.2689479381896, "num_env_steps_trained_throughput_per_sec": 427.2689479381896, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 9265.659, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9265.625, "sample_time_ms": 995.21, "learn_time_ms": 8257.407, "learn_throughput": 484.414, "synch_weights_time_ms": 12.185}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "1f15c_00000", "date": "2024-08-16_14-05-39", "timestamp": 1723797339, "time_this_iter_s": 9.367875814437866, "time_total_s": 145.05030703544617, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8bac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.05030703544617, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.384615384615383, "ram_util_percent": 70.72307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8875633961309201, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.435430232053081, "policy_loss": -0.010965536490683912, "vf_loss": 6.444223620651891, "vf_explained_var": 0.003826351172078854, "kl": 0.010860722404997249, "entropy": 1.4757655133015264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0123072697056665, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8332851288810605, "policy_loss": -0.0022244631551777715, "vf_loss": 7.834822085799363, "vf_explained_var": 0.022362097356685255, "kl": 0.006875023931290811, "entropy": 1.4248960373893618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 1021.3131914604595, "episode_reward_min": -1000.9941318053585, "episode_reward_mean": 12.439954808219948, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1520.2819518205376, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 108.92000000000034, "predator_policy": 1520.2819518205376}, "policy_reward_mean": {"prey_policy": -298.257710036206, "predator_policy": 304.4776874403158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.640613640064185, 20.260000000000424, 142.38374893444822, 14.689999999999953, -89.06666536713627, -10.621141201366727, 88.63227818953443, 79.75000000000054, 51.87318711470996, 36.23834348076492, 3.769999999999962, -249.78286625666345, 26.673502255841615, 193.12418466253717, 126.07932924736545, 11.83999999999994, 28.81970761737043, 17.36872152255596, 3.0199999999999783, 7.989999999999942, 3.7899999999999614, 33.472862650102506, 26.50000000000034, -9.473754593449394, 3.039999999999976, 16.66534907362336, 2.229999999999973, -63.01722334414506, -240.2713219234741, 25.11363220509329, 11.639999999999946, 28.329643866780785, -0.16287580345629138, 3.379999999999971, 120.79620573541548, -4.8151567337646215, 2.949999999999972, 26.839405362407316, 12.084423194325069, -113.41983298814864, -0.3344816904574488, 151.8117528357094, -5.409092569585314, 61.87297193099043, 3.1999999999999753, 20.524285358326285, -0.8260679774998212, 56.732766240260275, 66.6099999999995, 55.359999999999694, 51.902459221569345, 29.734492361584458, 41.05720621841233, -152.30506201575744, 53.52136289536379, 77.99249496017418, -232.620058988063, -641.3864883198153, 56.77721410444442, 60.16999999999986, 56.18999999999985, 12.109999999999939, 18.560000000000194, 114.67803886795542, 10.589999999999923, -266.5074262324573, -214.78710694853237, 5.589602895922134, 32.696182860341665, 31.369401021874985, 13.332633960141228, 46.59999999999991, 371.84896929461337, -144.89902763346342, 161.02760704062527, 363.05266301184764, 37.77144762663959, 59.560901054468154, 47.37999999999981, 45.17000000000002, 465.6870138887404, 152.68366123516486, 95.77000000000095, 2.479999999999981, 37.27999999999996, 1021.3131914604595, -886.8099773893885, 435.29220658715576, 138.4858201954774, 6.429999999999948, 41.459999999999994, 49.90999999999972, 34.700000000000166, 276.2499840567376, -4.006589793855156, 42.736622254763475, -1000.9941318053585, 54.22162365255074, 63.479999999999784, -746.4478854474216], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -40.11602884399984, -156.68193276679654, 2.0000000000000013, -347.3501686766657, -242.07590908023678, -292.0632416001927, -71.69310107040758, -519.8778373877597, -445.05731466706135, -227.81255114918915, -202.9997241972426, 2.0000000000000013, -287.0803752725458, -4.821962418750375, -27.154908169619755, -103.83343952149085, 22.79000000000028, -25.61277084068176, -112.49088421129493, -82.73288402819169, 2.0000000000000013, -429.13697276856533, -377.7761298328475, -66.48302178075116, 2.0000000000000013, -251.69880423473154, -547.6591732388881, -204.81555971328282, -567.5919428322118, -531.6591761296366, -61.993133483417296, -203.74386732552426, -250.07982483398942, -164.84468788064967, -43.642646778177486, -60.776646523609216, -221.0540854459463, -162.68865536164995, -158.01322742492786, -46.22285107789831, 2.0000000000000013, -230.97856370945033, -210.8509981122469, -115.99890710428633, -209.21726437479168, -118.72959002342591, -19.107654051918672, -137.86538717807272, -160.34594033423627, -622.1827575779364, -17.064309497888118, -1003.0524124678197, 2.0000000000000013, -187.612565661785, -159.51929683819785, -318.16618079452473, -360.1481094017891, -177.683448937761, -352.1364367469713, -270.28264250605986, -104.09971294905587, -266.7241114177829, 15.85999999999996, -135.1498510479314, -62.08597886217412, -63.64021205409699, -189.3886275881305, -268.173896378253, -116.40518357344986, -226.49425569499715, -296.8297228662637, -160.5651964358122, -407.02640956682586, -110.16068306814931, 2.0000000000000013, -118.75418439336346, 2.0000000000000013, -648.627239669584, -262.0877384302077, -459.8492459743856, -308.8220663537199, 2.0000000000000013, -309.948506097238, -60.49944823847796, -112.91315470416588, -51.81190902943329, -21.736597303589786, -255.3831833643069, 2.0000000000000013, -86.89721438543896, -125.07708193130271, -18.80203155835983, -169.53105739205128, -80.0926782542829, -56.76535256604607, -896.6171121269666, 32.70381460306924, 2.065515134774204, 21.96804181499505, 49.519999999999925, -718.0318863084019, -170.16735551910736, -66.28225469402857, -561.7983460080941, -192.41851496060937, -172.92648504206846, -521.8433699562162, -759.8690967130848, -13.750973457297677, -388.57221046976116, -793.7921342043029, -611.69925078483, -597.609715903935, -1130.9669473485508, -1023.0634246050729, -35.3390088750101, -40.9642727963555, -1193.2848433580025, 1.9856104160852823, -33.95157779463218, -956.0000648588409, -215.310190742401, -47.133468888083684, -19.423093837599282, -28.659631645572947, 108.92000000000034, -31.438214029959095, -71.5585015190943, 7.939999999999959, -855.6624834917022, -445.5255742178235, -728.8518032615775, -397.37943382256327, -198.82832902486422, -7.7235282866777855, 22.790000000000177, -196.9707563887544, 2.0000000000000013, -76.20757533947399, -182.74197329446326, -355.56880685951035, -23.360058220456462, -944.9658149152955, -1125.0311040621834, 39.997715579502874, -176.51488648099206, -237.26279345226348, 73.29946499181138, -51.718728119648404, -981.4735978193435, 6.949999999999958, -475.70050489170734, -31.443711435188323, -141.88641029500337, -639.0806064828107, -11.257928076154318, 12.260845567075542, 2.0408503600229047, -104.13857515328381, -1462.6135258499994, -514.4353212904724, -596.0190105906714, -483.6298694755449, 2.0000000000000013, 6.967429794924665, -4.419415977112344, -586.8980268480119, -768.1807377309017, -64.44257967042255, 55.45999999999977, -1497.0756052062384, -1042.0540492842633, -1343.6391450728677, 89.12000000000005, -826.7047476776727, 18.83000000000025, -243.8605799500391, -91.09399555282957, -60.3846607753441, -1.484026014611114, -1520.2819518205376, 26.92432189258161, -421.6902897505185, -62.7109575496968, -261.5159657501551, -697.7759096569155, -1035.0179905359591, -1453.2871705872406, -676.8680565132845, -366.1090303433873, 2.0000000000000013, -1150.5857086305805, -1384.28757059428, -715.9153846022231, -155.09981475300538, 40.1772327060878, -1205.605744755098, -1201.385199269952, -996.6534411457991], "policy_predator_policy_reward": [19.18209845585987, 38.57454402820323, 3.9349303213017865, 171.00700244549438, 402.6103932780543, 329.199433413296, 58.80781138370426, 319.63853128689686, 675.2369423509156, 200.63154433676718, 204.04562517690513, 216.1455089681578, 164.99978502979963, 208.71286843227875, 104.94490816961965, 6.781962418750333, 102.49850329755587, 30.418123338646513, 110.75920144792349, 63.58279708481972, 68.7048648643254, 15.798019163866925, 545.6834373286866, 11.44679901606267, 34.829428243629366, 56.32709579296372, 292.0597781100661, 700.422384026091, 494.2616593207936, 404.22517247206514, 72.633133483417, 532.8591761296356, 289.1174224680867, 193.52597730879683, 181.37242562352975, 44.48363055785177, 173.81058204747234, 111.04014992208312, 267.9819328812219, 60.70994990535451, 48.01285107789797, 0.0, 203.61267869813642, 271.68974577366095, 141.27890710428682, 210.4372643747906, 39.10626838495048, 89.25722109694597, 250.6190583230049, 50.63226918930166, 37.12724584278307, 618.7851703066648, 1003.2824124678198, 0.0, 120.68571725042095, 163.42892190541463, 24.862428363280742, 413.1805399095592, 296.0247128530006, 258.90880503682297, 280.27264250605907, 105.74971294905671, 27.421933581459143, 251.77182170310329, 161.99400078549314, 35.07895332115411, 191.048627588129, 65.36021205409759, 254.8460013988496, 250.52928428826885, 125.18522779900893, 393.3235940284856, 509.1364999161211, 61.405106086514984, 42.49046409311803, 92.50962433743888, 57.04131317439887, 71.7972944132905, 719.2220582140267, 78.07308689761548, 310.24398654487624, 458.09284409277063, 306.10062894176167, 153.6596299911845, 105.68406213458108, 62.3194482384776, 50.8552116453215, 84.56626661869272, 256.58318336430705, 0.0, 125.96340215134667, 106.53517952372269, 16.475963580860082, 171.03105739205046, 97.03535256604623, 96.55544449454435, 897.0371121269667, 33.4861853969307, 18.58195818500497, 12.744484865225793, 718.471886308402, 1.942459221569399, 114.96772941874654, 151.21637315597383, 324.7482609244626, 470.5258062626525, 2.78972288769041, 539.6750700948362, 261.5768228930766, 565.5646101726696, 466.3365908192767, 794.0202488149611, 849.2451045495809, 127.44380315112076, 967.0330043919996, 545.6108792418073, 44.03873804375354, 89.04175773205662, 58.184389583914715, 1193.2848433580025, 956.0300648588409, 90.11157779463224, 225.58019074239985, 48.97346888808397, 36.11309383759953, 30.52963164557324, 3.9080388679547697, 33.28821402995896, 65.86409756569779, 8.344403953397347, 156.1066720154352, 878.5739594616339, 60.30825318001441, 851.1358769555935, 80.378523457622, 131.76293674984143, 198.18075638875342, 8.69618286034151, 78.07757533947495, 27.499401021874387, 415.57156060649373, 136.07185350761904, 69.7400582204564, 945.1858149152953, 542.1379613121932, 914.7443964651007, 264.492802347515, 4.385849952276912, 50.99762876059128, 88.44924140787032, 909.1487471364355, 428.427513694756, 103.66061614423204, 441.2550478093028, 259.66416681821556, 580.8637510140668, 41.81792807615436, 4.559154432924419, 105.79857515328455, 41.46914963997712, 991.1984107218599, 1451.5374503073517, 545.2374677356895, 687.0950735656901, 63.26229479993963, 23.540275405135695, 275.3526905006266, 318.44475232449713, 95.76257967042308, 774.1407377309014, 1228.4205790872704, 1234.5082175794303, 1445.8519875010804, 53.03122946666253, 709.2905900916592, 463.58636417316876, 195.2767725649578, 168.23962758056004, 95.7939955528303, 62.11466077534376, 1520.2819518205376, 42.94402601461094, 444.67596785793705, 0.0, 294.46596575015417, 64.46095754969707, 960.4199690928823, 1048.6239151567302, 708.7930324658215, 1417.3556048408477, 179.30776754858346, 227.53788504956742, 1507.3636481412511, 26.51549927825025, 176.2304269471839, 749.0063960605945, 1207.3228994635178, 21.585612585491987, 1403.9517356600747, 47.63901930825521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7930208073677676, "mean_inference_ms": 1.953753981045115, "mean_action_processing_ms": 0.32495607784504743, "mean_env_wait_ms": 0.2586020411964669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003264904022216797, "StateBufferConnector_ms": 0.0026930570602416992, "ViewRequirementAgentConnector_ms": 0.08298921585083008}, "num_episodes": 18, "episode_return_max": 1021.3131914604595, "episode_return_min": -1000.9941318053585, "episode_return_mean": 12.439954808219948, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.3338556494799, "num_env_steps_trained_throughput_per_sec": 423.3338556494799, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 9307.975, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9307.941, "sample_time_ms": 999.839, "learn_time_ms": 8294.99, "learn_throughput": 482.219, "synch_weights_time_ms": 12.229}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "1f15c_00000", "date": "2024-08-16_14-05-48", "timestamp": 1723797348, "time_this_iter_s": 9.452091217041016, "time_total_s": 154.50239825248718, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8bab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 154.50239825248718, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.521428571428576, "ram_util_percent": 70.7642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8493796194987322, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.886967687505893, "policy_loss": -0.010027951608835744, "vf_loss": 7.89452179399117, "vf_explained_var": 0.0012568850365896073, "kl": 0.012369200961123792, "entropy": 1.4473043014763525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5927021823232137, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.429205274329615, "policy_loss": -0.008636836514921573, "vf_loss": 8.43611601572188, "vf_explained_var": 0.014124169898411584, "kl": 0.01726089881914411, "entropy": 1.4331689903975795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 1021.3131914604595, "episode_reward_min": -1000.9941318053585, "episode_reward_mean": 9.955763200522107, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1552.0077287593342, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 108.92000000000034, "predator_policy": 1636.8929036849163}, "policy_reward_mean": {"prey_policy": -390.4372224600575, "predator_policy": 395.4151040603184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0199999999999783, 7.989999999999942, 3.7899999999999614, 33.472862650102506, 26.50000000000034, -9.473754593449394, 3.039999999999976, 16.66534907362336, 2.229999999999973, -63.01722334414506, -240.2713219234741, 25.11363220509329, 11.639999999999946, 28.329643866780785, -0.16287580345629138, 3.379999999999971, 120.79620573541548, -4.8151567337646215, 2.949999999999972, 26.839405362407316, 12.084423194325069, -113.41983298814864, -0.3344816904574488, 151.8117528357094, -5.409092569585314, 61.87297193099043, 3.1999999999999753, 20.524285358326285, -0.8260679774998212, 56.732766240260275, 66.6099999999995, 55.359999999999694, 51.902459221569345, 29.734492361584458, 41.05720621841233, -152.30506201575744, 53.52136289536379, 77.99249496017418, -232.620058988063, -641.3864883198153, 56.77721410444442, 60.16999999999986, 56.18999999999985, 12.109999999999939, 18.560000000000194, 114.67803886795542, 10.589999999999923, -266.5074262324573, -214.78710694853237, 5.589602895922134, 32.696182860341665, 31.369401021874985, 13.332633960141228, 46.59999999999991, 371.84896929461337, -144.89902763346342, 161.02760704062527, 363.05266301184764, 37.77144762663959, 59.560901054468154, 47.37999999999981, 45.17000000000002, 465.6870138887404, 152.68366123516486, 95.77000000000095, 2.479999999999981, 37.27999999999996, 1021.3131914604595, -886.8099773893885, 435.29220658715576, 138.4858201954774, 6.429999999999948, 41.459999999999994, 49.90999999999972, 34.700000000000166, 276.2499840567376, -4.006589793855156, 42.736622254763475, -1000.9941318053585, 54.22162365255074, 63.479999999999784, -746.4478854474216, 102.39529396567815, 569.3410306284263, 19.568023497301535, 338.46238605994336, -26.8014826001315, 15.369999999999973, 144.29854540861373, 53.45999999999998, -579.2139715627293, -479.49024058295305, 13.689999999999921, 106.29276718808214, 202.5355157420733, 651.9164964700756, 159.39503944589922, -374.5841678314956, -285.4136187244069, -367.96783403413457], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-60.776646523609216, -221.0540854459463, -162.68865536164995, -158.01322742492786, -46.22285107789831, 2.0000000000000013, -230.97856370945033, -210.8509981122469, -115.99890710428633, -209.21726437479168, -118.72959002342591, -19.107654051918672, -137.86538717807272, -160.34594033423627, -622.1827575779364, -17.064309497888118, -1003.0524124678197, 2.0000000000000013, -187.612565661785, -159.51929683819785, -318.16618079452473, -360.1481094017891, -177.683448937761, -352.1364367469713, -270.28264250605986, -104.09971294905587, -266.7241114177829, 15.85999999999996, -135.1498510479314, -62.08597886217412, -63.64021205409699, -189.3886275881305, -268.173896378253, -116.40518357344986, -226.49425569499715, -296.8297228662637, -160.5651964358122, -407.02640956682586, -110.16068306814931, 2.0000000000000013, -118.75418439336346, 2.0000000000000013, -648.627239669584, -262.0877384302077, -459.8492459743856, -308.8220663537199, 2.0000000000000013, -309.948506097238, -60.49944823847796, -112.91315470416588, -51.81190902943329, -21.736597303589786, -255.3831833643069, 2.0000000000000013, -86.89721438543896, -125.07708193130271, -18.80203155835983, -169.53105739205128, -80.0926782542829, -56.76535256604607, -896.6171121269666, 32.70381460306924, 2.065515134774204, 21.96804181499505, 49.519999999999925, -718.0318863084019, -170.16735551910736, -66.28225469402857, -561.7983460080941, -192.41851496060937, -172.92648504206846, -521.8433699562162, -759.8690967130848, -13.750973457297677, -388.57221046976116, -793.7921342043029, -611.69925078483, -597.609715903935, -1130.9669473485508, -1023.0634246050729, -35.3390088750101, -40.9642727963555, -1193.2848433580025, 1.9856104160852823, -33.95157779463218, -956.0000648588409, -215.310190742401, -47.133468888083684, -19.423093837599282, -28.659631645572947, 108.92000000000034, -31.438214029959095, -71.5585015190943, 7.939999999999959, -855.6624834917022, -445.5255742178235, -728.8518032615775, -397.37943382256327, -198.82832902486422, -7.7235282866777855, 22.790000000000177, -196.9707563887544, 2.0000000000000013, -76.20757533947399, -182.74197329446326, -355.56880685951035, -23.360058220456462, -944.9658149152955, -1125.0311040621834, 39.997715579502874, -176.51488648099206, -237.26279345226348, 73.29946499181138, -51.718728119648404, -981.4735978193435, 6.949999999999958, -475.70050489170734, -31.443711435188323, -141.88641029500337, -639.0806064828107, -11.257928076154318, 12.260845567075542, 2.0408503600229047, -104.13857515328381, -1462.6135258499994, -514.4353212904724, -596.0190105906714, -483.6298694755449, 2.0000000000000013, 6.967429794924665, -4.419415977112344, -586.8980268480119, -768.1807377309017, -64.44257967042255, 55.45999999999977, -1497.0756052062384, -1042.0540492842633, -1343.6391450728677, 89.12000000000005, -826.7047476776727, 18.83000000000025, -243.8605799500391, -91.09399555282957, -60.3846607753441, -1.484026014611114, -1520.2819518205376, 26.92432189258161, -421.6902897505185, -62.7109575496968, -261.5159657501551, -697.7759096569155, -1035.0179905359591, -1453.2871705872406, -676.8680565132845, -366.1090303433873, 2.0000000000000013, -1150.5857086305805, -1384.28757059428, -715.9153846022231, -155.09981475300538, 40.1772327060878, -1205.605744755098, -1201.385199269952, -996.6534411457991, -74.28296386617859, -1023.384032971096, -901.9163642455609, 73.27999999999999, -271.73338408902816, -107.59817315143087, -173.80753557108673, -413.23909116738395, -199.70836648214612, -232.24450251898836, -340.9474578591153, -1025.9649728076974, -288.3044426232989, 7.376935266830053, -1022.7821749642078, -107.41078980593085, -622.7147601843053, -855.0903216011435, -1239.2905906346987, -1215.913338453498, -114.71212148462926, 11.89999999999996, -662.6074896040184, -400.8570533927749, -1532.929467596624, -1219.757428747658, -1192.1410267725025, -1312.592762590385, -881.8375115223807, -1413.8423677499163, -560.1753528040223, -384.0521470769173, -1371.1593848578932, -1236.2520650018032, -1434.9922238142797, -1552.0077287593342], "policy_predator_policy_reward": [173.81058204747234, 111.04014992208312, 267.9819328812219, 60.70994990535451, 48.01285107789797, 0.0, 203.61267869813642, 271.68974577366095, 141.27890710428682, 210.4372643747906, 39.10626838495048, 89.25722109694597, 250.6190583230049, 50.63226918930166, 37.12724584278307, 618.7851703066648, 1003.2824124678198, 0.0, 120.68571725042095, 163.42892190541463, 24.862428363280742, 413.1805399095592, 296.0247128530006, 258.90880503682297, 280.27264250605907, 105.74971294905671, 27.421933581459143, 251.77182170310329, 161.99400078549314, 35.07895332115411, 191.048627588129, 65.36021205409759, 254.8460013988496, 250.52928428826885, 125.18522779900893, 393.3235940284856, 509.1364999161211, 61.405106086514984, 42.49046409311803, 92.50962433743888, 57.04131317439887, 71.7972944132905, 719.2220582140267, 78.07308689761548, 310.24398654487624, 458.09284409277063, 306.10062894176167, 153.6596299911845, 105.68406213458108, 62.3194482384776, 50.8552116453215, 84.56626661869272, 256.58318336430705, 0.0, 125.96340215134667, 106.53517952372269, 16.475963580860082, 171.03105739205046, 97.03535256604623, 96.55544449454435, 897.0371121269667, 33.4861853969307, 18.58195818500497, 12.744484865225793, 718.471886308402, 1.942459221569399, 114.96772941874654, 151.21637315597383, 324.7482609244626, 470.5258062626525, 2.78972288769041, 539.6750700948362, 261.5768228930766, 565.5646101726696, 466.3365908192767, 794.0202488149611, 849.2451045495809, 127.44380315112076, 967.0330043919996, 545.6108792418073, 44.03873804375354, 89.04175773205662, 58.184389583914715, 1193.2848433580025, 956.0300648588409, 90.11157779463224, 225.58019074239985, 48.97346888808397, 36.11309383759953, 30.52963164557324, 3.9080388679547697, 33.28821402995896, 65.86409756569779, 8.344403953397347, 156.1066720154352, 878.5739594616339, 60.30825318001441, 851.1358769555935, 80.378523457622, 131.76293674984143, 198.18075638875342, 8.69618286034151, 78.07757533947495, 27.499401021874387, 415.57156060649373, 136.07185350761904, 69.7400582204564, 945.1858149152953, 542.1379613121932, 914.7443964651007, 264.492802347515, 4.385849952276912, 50.99762876059128, 88.44924140787032, 909.1487471364355, 428.427513694756, 103.66061614423204, 441.2550478093028, 259.66416681821556, 580.8637510140668, 41.81792807615436, 4.559154432924419, 105.79857515328455, 41.46914963997712, 991.1984107218599, 1451.5374503073517, 545.2374677356895, 687.0950735656901, 63.26229479993963, 23.540275405135695, 275.3526905006266, 318.44475232449713, 95.76257967042308, 774.1407377309014, 1228.4205790872704, 1234.5082175794303, 1445.8519875010804, 53.03122946666253, 709.2905900916592, 463.58636417316876, 195.2767725649578, 168.23962758056004, 95.7939955528303, 62.11466077534376, 1520.2819518205376, 42.94402601461094, 444.67596785793705, 0.0, 294.46596575015417, 64.46095754969707, 960.4199690928823, 1048.6239151567302, 708.7930324658215, 1417.3556048408477, 179.30776754858346, 227.53788504956742, 1507.3636481412511, 26.51549927825025, 176.2304269471839, 749.0063960605945, 1207.3228994635178, 21.585612585491987, 1403.9517356600747, 47.63901930825521, 110.20343879920787, 1089.8588520037447, 617.8805164249296, 780.096878449057, 332.52307146892986, 66.37650926883055, 494.00674551335555, 431.50226728505737, 253.92970655852997, 151.22167984247218, 355.8974578591144, 1026.3849728076975, 179.80511624392685, 245.42093652115582, 1052.9334921543054, 130.71947261583318, 30.555807915552847, 868.0353023071665, 1238.6178726113983, 737.0958158938461, 116.50212148463018, 0.0, 556.3991354762559, 613.3581747086178, 1633.7739291971473, 1321.4484828892087, 1529.3286632115946, 1627.3216226213704, 1031.0710184064292, 1424.0039003117677, 565.3677801277282, 4.275551921715605, 1636.8929036849163, 685.1049274503736, 1050.6298800787952, 1568.4022384606837]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7723694403217138, "mean_inference_ms": 1.9042972200469972, "mean_action_processing_ms": 0.3169075533094457, "mean_env_wait_ms": 0.2522368299727286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033382177352905273, "StateBufferConnector_ms": 0.00276339054107666, "ViewRequirementAgentConnector_ms": 0.08437561988830566}, "num_episodes": 18, "episode_return_max": 1021.3131914604595, "episode_return_min": -1000.9941318053585, "episode_return_mean": 9.955763200522107, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.96161554558427, "num_env_steps_trained_throughput_per_sec": 433.96161554558427, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 9270.392, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9270.358, "sample_time_ms": 989.94, "learn_time_ms": 8267.258, "learn_throughput": 483.836, "synch_weights_time_ms": 12.253}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "1f15c_00000", "date": "2024-08-16_14-05-58", "timestamp": 1723797358, "time_this_iter_s": 9.220503807067871, "time_total_s": 163.72290205955505, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8009d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 163.72290205955505, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 23.246153846153845, "ram_util_percent": 70.4076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8341864140260787, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.329255523883477, "policy_loss": -0.009841579195634319, "vf_loss": 7.337104641697394, "vf_explained_var": 0.0009930077368620212, "kl": 0.009962294620324927, "entropy": 1.4552131090845382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.051224871397649, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.706281578982318, "policy_loss": -0.00787042647491766, "vf_loss": 7.712782811109351, "vf_explained_var": 0.01292733837057043, "kl": 0.013691807486096063, "entropy": 1.421278364254684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 1021.3131914604595, "episode_reward_min": -1000.9941318053585, "episode_reward_mean": 36.71253062501903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1552.0077287593342, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 108.92000000000034, "predator_policy": 1636.8929036849163}, "policy_reward_mean": {"prey_policy": -445.12821072185056, "predator_policy": 463.48447603436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.949999999999972, 26.839405362407316, 12.084423194325069, -113.41983298814864, -0.3344816904574488, 151.8117528357094, -5.409092569585314, 61.87297193099043, 3.1999999999999753, 20.524285358326285, -0.8260679774998212, 56.732766240260275, 66.6099999999995, 55.359999999999694, 51.902459221569345, 29.734492361584458, 41.05720621841233, -152.30506201575744, 53.52136289536379, 77.99249496017418, -232.620058988063, -641.3864883198153, 56.77721410444442, 60.16999999999986, 56.18999999999985, 12.109999999999939, 18.560000000000194, 114.67803886795542, 10.589999999999923, -266.5074262324573, -214.78710694853237, 5.589602895922134, 32.696182860341665, 31.369401021874985, 13.332633960141228, 46.59999999999991, 371.84896929461337, -144.89902763346342, 161.02760704062527, 363.05266301184764, 37.77144762663959, 59.560901054468154, 47.37999999999981, 45.17000000000002, 465.6870138887404, 152.68366123516486, 95.77000000000095, 2.479999999999981, 37.27999999999996, 1021.3131914604595, -886.8099773893885, 435.29220658715576, 138.4858201954774, 6.429999999999948, 41.459999999999994, 49.90999999999972, 34.700000000000166, 276.2499840567376, -4.006589793855156, 42.736622254763475, -1000.9941318053585, 54.22162365255074, 63.479999999999784, -746.4478854474216, 102.39529396567815, 569.3410306284263, 19.568023497301535, 338.46238605994336, -26.8014826001315, 15.369999999999973, 144.29854540861373, 53.45999999999998, -579.2139715627293, -479.49024058295305, 13.689999999999921, 106.29276718808214, 202.5355157420733, 651.9164964700756, 159.39503944589922, -374.5841678314956, -285.4136187244069, -367.96783403413457, 695.6145408579596, 634.9821587024495, 315.2134064834419, 55.4083462370421, 10.389999999999928, -41.26172145518421, 676.2761938362479, 89.1395022772029, 220.98219339852665, 162.54734888494903, 137.26753662752233, 40.72191635916464, -9.69354945975051, 234.48719414034667, 32.93124155784636, 110.77488287885241, -728.5367252996663, 6.659637555468178], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-160.5651964358122, -407.02640956682586, -110.16068306814931, 2.0000000000000013, -118.75418439336346, 2.0000000000000013, -648.627239669584, -262.0877384302077, -459.8492459743856, -308.8220663537199, 2.0000000000000013, -309.948506097238, -60.49944823847796, -112.91315470416588, -51.81190902943329, -21.736597303589786, -255.3831833643069, 2.0000000000000013, -86.89721438543896, -125.07708193130271, -18.80203155835983, -169.53105739205128, -80.0926782542829, -56.76535256604607, -896.6171121269666, 32.70381460306924, 2.065515134774204, 21.96804181499505, 49.519999999999925, -718.0318863084019, -170.16735551910736, -66.28225469402857, -561.7983460080941, -192.41851496060937, -172.92648504206846, -521.8433699562162, -759.8690967130848, -13.750973457297677, -388.57221046976116, -793.7921342043029, -611.69925078483, -597.609715903935, -1130.9669473485508, -1023.0634246050729, -35.3390088750101, -40.9642727963555, -1193.2848433580025, 1.9856104160852823, -33.95157779463218, -956.0000648588409, -215.310190742401, -47.133468888083684, -19.423093837599282, -28.659631645572947, 108.92000000000034, -31.438214029959095, -71.5585015190943, 7.939999999999959, -855.6624834917022, -445.5255742178235, -728.8518032615775, -397.37943382256327, -198.82832902486422, -7.7235282866777855, 22.790000000000177, -196.9707563887544, 2.0000000000000013, -76.20757533947399, -182.74197329446326, -355.56880685951035, -23.360058220456462, -944.9658149152955, -1125.0311040621834, 39.997715579502874, -176.51488648099206, -237.26279345226348, 73.29946499181138, -51.718728119648404, -981.4735978193435, 6.949999999999958, -475.70050489170734, -31.443711435188323, -141.88641029500337, -639.0806064828107, -11.257928076154318, 12.260845567075542, 2.0408503600229047, -104.13857515328381, -1462.6135258499994, -514.4353212904724, -596.0190105906714, -483.6298694755449, 2.0000000000000013, 6.967429794924665, -4.419415977112344, -586.8980268480119, -768.1807377309017, -64.44257967042255, 55.45999999999977, -1497.0756052062384, -1042.0540492842633, -1343.6391450728677, 89.12000000000005, -826.7047476776727, 18.83000000000025, -243.8605799500391, -91.09399555282957, -60.3846607753441, -1.484026014611114, -1520.2819518205376, 26.92432189258161, -421.6902897505185, -62.7109575496968, -261.5159657501551, -697.7759096569155, -1035.0179905359591, -1453.2871705872406, -676.8680565132845, -366.1090303433873, 2.0000000000000013, -1150.5857086305805, -1384.28757059428, -715.9153846022231, -155.09981475300538, 40.1772327060878, -1205.605744755098, -1201.385199269952, -996.6534411457991, -74.28296386617859, -1023.384032971096, -901.9163642455609, 73.27999999999999, -271.73338408902816, -107.59817315143087, -173.80753557108673, -413.23909116738395, -199.70836648214612, -232.24450251898836, -340.9474578591153, -1025.9649728076974, -288.3044426232989, 7.376935266830053, -1022.7821749642078, -107.41078980593085, -622.7147601843053, -855.0903216011435, -1239.2905906346987, -1215.913338453498, -114.71212148462926, 11.89999999999996, -662.6074896040184, -400.8570533927749, -1532.929467596624, -1219.757428747658, -1192.1410267725025, -1312.592762590385, -881.8375115223807, -1413.8423677499163, -560.1753528040223, -384.0521470769173, -1371.1593848578932, -1236.2520650018032, -1434.9922238142797, -1552.0077287593342, -197.552720558812, -1263.6318901256852, -1210.3690957165102, 17.596440240509533, 33.68000000000012, -367.0433869954426, -122.49045525621584, -154.3166396537411, -30.641591315291784, -106.38624075836118, -46.641721455184175, -1016.0135615473974, 11.899999999999975, -1082.7106590198123, -770.4971377839474, -574.2804514151807, -723.5947933930323, -1338.3085578413989, -1221.5799683446749, -462.66276743867604, -217.6550900110865, -260.5022225677468, -270.8090027939619, -235.66877334673975, -1047.4865102243996, -285.85699033378194, -653.5601314838748, -122.13635866388856, -62.646216367996104, -1063.8947059638774, -385.8515871090534, 2.0000000000000013, -866.057874587937, -1267.5058947269192, -161.52104870020878, -442.3295306836117], "policy_predator_policy_reward": [509.1364999161211, 61.405106086514984, 42.49046409311803, 92.50962433743888, 57.04131317439887, 71.7972944132905, 719.2220582140267, 78.07308689761548, 310.24398654487624, 458.09284409277063, 306.10062894176167, 153.6596299911845, 105.68406213458108, 62.3194482384776, 50.8552116453215, 84.56626661869272, 256.58318336430705, 0.0, 125.96340215134667, 106.53517952372269, 16.475963580860082, 171.03105739205046, 97.03535256604623, 96.55544449454435, 897.0371121269667, 33.4861853969307, 18.58195818500497, 12.744484865225793, 718.471886308402, 1.942459221569399, 114.96772941874654, 151.21637315597383, 324.7482609244626, 470.5258062626525, 2.78972288769041, 539.6750700948362, 261.5768228930766, 565.5646101726696, 466.3365908192767, 794.0202488149611, 849.2451045495809, 127.44380315112076, 967.0330043919996, 545.6108792418073, 44.03873804375354, 89.04175773205662, 58.184389583914715, 1193.2848433580025, 956.0300648588409, 90.11157779463224, 225.58019074239985, 48.97346888808397, 36.11309383759953, 30.52963164557324, 3.9080388679547697, 33.28821402995896, 65.86409756569779, 8.344403953397347, 156.1066720154352, 878.5739594616339, 60.30825318001441, 851.1358769555935, 80.378523457622, 131.76293674984143, 198.18075638875342, 8.69618286034151, 78.07757533947495, 27.499401021874387, 415.57156060649373, 136.07185350761904, 69.7400582204564, 945.1858149152953, 542.1379613121932, 914.7443964651007, 264.492802347515, 4.385849952276912, 50.99762876059128, 88.44924140787032, 909.1487471364355, 428.427513694756, 103.66061614423204, 441.2550478093028, 259.66416681821556, 580.8637510140668, 41.81792807615436, 4.559154432924419, 105.79857515328455, 41.46914963997712, 991.1984107218599, 1451.5374503073517, 545.2374677356895, 687.0950735656901, 63.26229479993963, 23.540275405135695, 275.3526905006266, 318.44475232449713, 95.76257967042308, 774.1407377309014, 1228.4205790872704, 1234.5082175794303, 1445.8519875010804, 53.03122946666253, 709.2905900916592, 463.58636417316876, 195.2767725649578, 168.23962758056004, 95.7939955528303, 62.11466077534376, 1520.2819518205376, 42.94402601461094, 444.67596785793705, 0.0, 294.46596575015417, 64.46095754969707, 960.4199690928823, 1048.6239151567302, 708.7930324658215, 1417.3556048408477, 179.30776754858346, 227.53788504956742, 1507.3636481412511, 26.51549927825025, 176.2304269471839, 749.0063960605945, 1207.3228994635178, 21.585612585491987, 1403.9517356600747, 47.63901930825521, 110.20343879920787, 1089.8588520037447, 617.8805164249296, 780.096878449057, 332.52307146892986, 66.37650926883055, 494.00674551335555, 431.50226728505737, 253.92970655852997, 151.22167984247218, 355.8974578591144, 1026.3849728076975, 179.80511624392685, 245.42093652115582, 1052.9334921543054, 130.71947261583318, 30.555807915552847, 868.0353023071665, 1238.6178726113983, 737.0958158938461, 116.50212148463018, 0.0, 556.3991354762559, 613.3581747086178, 1633.7739291971473, 1321.4484828892087, 1529.3286632115946, 1627.3216226213704, 1031.0710184064292, 1424.0039003117677, 565.3677801277282, 4.275551921715605, 1636.8929036849163, 685.1049274503736, 1050.6298800787952, 1568.4022384606837, 938.0576501161767, 1218.7415014262806, 800.7245774774846, 1027.0302367009658, 316.39534992526467, 332.1814435536197, 185.33498589078235, 146.8804552562154, 136.16792050295354, 11.249911570700089, 1021.3935615473971, 0.0, 835.9554319663721, 911.131420889688, 811.2628117334266, 622.6542797429039, 1038.3859951276984, 1244.4995495052574, 685.6702640055732, 1161.1198206627264, 177.0588878520372, 438.3659613543176, 195.2356985354085, 351.9639939644575, 285.1216089486398, 1038.528342149791, 313.97178372248175, 696.2119005656281, 110.15386404824848, 1049.3182998414716, 196.8818833171848, 297.7445866707187, 24.541356298400842, 1380.485687716788, 181.9410487002075, 428.56916823907943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7545592032370502, "mean_inference_ms": 1.8619589910614724, "mean_action_processing_ms": 0.3100455716402978, "mean_env_wait_ms": 0.2468684061090889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003327608108520508, "StateBufferConnector_ms": 0.002756476402282715, "ViewRequirementAgentConnector_ms": 0.08378922939300537}, "num_episodes": 18, "episode_return_max": 1021.3131914604595, "episode_return_min": -1000.9941318053585, "episode_return_mean": 36.71253062501903, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.22694679130973, "num_env_steps_trained_throughput_per_sec": 437.22694679130973, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 9240.172, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9240.137, "sample_time_ms": 984.442, "learn_time_ms": 8242.58, "learn_throughput": 485.285, "synch_weights_time_ms": 12.234}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "1f15c_00000", "date": "2024-08-16_14-06-07", "timestamp": 1723797367, "time_this_iter_s": 9.15163803100586, "time_total_s": 172.8745400905609, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f87daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 172.8745400905609, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.43846153846154, "ram_util_percent": 70.16153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3374330397163119, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.677924562635876, "policy_loss": -0.009293316747677862, "vf_loss": 3.6856621821721394, "vf_explained_var": -0.0002857443201478827, "kl": 0.007778451972893331, "entropy": 1.468326223716534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.288877783376704, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.16658693974611, "policy_loss": -0.00909315904567915, "vf_loss": 4.173950678583175, "vf_explained_var": 0.00622061292330424, "kl": 0.01729430459202123, "entropy": 1.3014358639717103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 1021.3131914604595, "episode_reward_min": -1000.9941318053585, "episode_reward_mean": 64.65965053840195, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1661.1842768912568, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 108.92000000000034, "predator_policy": 1680.0459268506165}, "policy_reward_mean": {"prey_policy": -436.3943588953364, "predator_policy": 468.7241841645373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.77721410444442, 60.16999999999986, 56.18999999999985, 12.109999999999939, 18.560000000000194, 114.67803886795542, 10.589999999999923, -266.5074262324573, -214.78710694853237, 5.589602895922134, 32.696182860341665, 31.369401021874985, 13.332633960141228, 46.59999999999991, 371.84896929461337, -144.89902763346342, 161.02760704062527, 363.05266301184764, 37.77144762663959, 59.560901054468154, 47.37999999999981, 45.17000000000002, 465.6870138887404, 152.68366123516486, 95.77000000000095, 2.479999999999981, 37.27999999999996, 1021.3131914604595, -886.8099773893885, 435.29220658715576, 138.4858201954774, 6.429999999999948, 41.459999999999994, 49.90999999999972, 34.700000000000166, 276.2499840567376, -4.006589793855156, 42.736622254763475, -1000.9941318053585, 54.22162365255074, 63.479999999999784, -746.4478854474216, 102.39529396567815, 569.3410306284263, 19.568023497301535, 338.46238605994336, -26.8014826001315, 15.369999999999973, 144.29854540861373, 53.45999999999998, -579.2139715627293, -479.49024058295305, 13.689999999999921, 106.29276718808214, 202.5355157420733, 651.9164964700756, 159.39503944589922, -374.5841678314956, -285.4136187244069, -367.96783403413457, 695.6145408579596, 634.9821587024495, 315.2134064834419, 55.4083462370421, 10.389999999999928, -41.26172145518421, 676.2761938362479, 89.1395022772029, 220.98219339852665, 162.54734888494903, 137.26753662752233, 40.72191635916464, -9.69354945975051, 234.48719414034667, 32.93124155784636, 110.77488287885241, -728.5367252996663, 6.659637555468178, 619.5518738806984, 38.87951151394541, 224.69414642669062, -79.03514254743696, 23.720000000000486, 119.05621659468423, 245.04005534370498, 0.7217506171700202, 16.48000000000002, 219.71419361513477, 6.171876158339416, 166.6431281094635, 6.279999999999959, 3.209999999999962, 420.878355123731, 74.82564435460094, 53.249999999999986, 3.199999999999968, 20.469428604100152, 92.55112415376617, 80.75236541949296, 3.5499999999999647], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-35.3390088750101, -40.9642727963555, -1193.2848433580025, 1.9856104160852823, -33.95157779463218, -956.0000648588409, -215.310190742401, -47.133468888083684, -19.423093837599282, -28.659631645572947, 108.92000000000034, -31.438214029959095, -71.5585015190943, 7.939999999999959, -855.6624834917022, -445.5255742178235, -728.8518032615775, -397.37943382256327, -198.82832902486422, -7.7235282866777855, 22.790000000000177, -196.9707563887544, 2.0000000000000013, -76.20757533947399, -182.74197329446326, -355.56880685951035, -23.360058220456462, -944.9658149152955, -1125.0311040621834, 39.997715579502874, -176.51488648099206, -237.26279345226348, 73.29946499181138, -51.718728119648404, -981.4735978193435, 6.949999999999958, -475.70050489170734, -31.443711435188323, -141.88641029500337, -639.0806064828107, -11.257928076154318, 12.260845567075542, 2.0408503600229047, -104.13857515328381, -1462.6135258499994, -514.4353212904724, -596.0190105906714, -483.6298694755449, 2.0000000000000013, 6.967429794924665, -4.419415977112344, -586.8980268480119, -768.1807377309017, -64.44257967042255, 55.45999999999977, -1497.0756052062384, -1042.0540492842633, -1343.6391450728677, 89.12000000000005, -826.7047476776727, 18.83000000000025, -243.8605799500391, -91.09399555282957, -60.3846607753441, -1.484026014611114, -1520.2819518205376, 26.92432189258161, -421.6902897505185, -62.7109575496968, -261.5159657501551, -697.7759096569155, -1035.0179905359591, -1453.2871705872406, -676.8680565132845, -366.1090303433873, 2.0000000000000013, -1150.5857086305805, -1384.28757059428, -715.9153846022231, -155.09981475300538, 40.1772327060878, -1205.605744755098, -1201.385199269952, -996.6534411457991, -74.28296386617859, -1023.384032971096, -901.9163642455609, 73.27999999999999, -271.73338408902816, -107.59817315143087, -173.80753557108673, -413.23909116738395, -199.70836648214612, -232.24450251898836, -340.9474578591153, -1025.9649728076974, -288.3044426232989, 7.376935266830053, -1022.7821749642078, -107.41078980593085, -622.7147601843053, -855.0903216011435, -1239.2905906346987, -1215.913338453498, -114.71212148462926, 11.89999999999996, -662.6074896040184, -400.8570533927749, -1532.929467596624, -1219.757428747658, -1192.1410267725025, -1312.592762590385, -881.8375115223807, -1413.8423677499163, -560.1753528040223, -384.0521470769173, -1371.1593848578932, -1236.2520650018032, -1434.9922238142797, -1552.0077287593342, -197.552720558812, -1263.6318901256852, -1210.3690957165102, 17.596440240509533, 33.68000000000012, -367.0433869954426, -122.49045525621584, -154.3166396537411, -30.641591315291784, -106.38624075836118, -46.641721455184175, -1016.0135615473974, 11.899999999999975, -1082.7106590198123, -770.4971377839474, -574.2804514151807, -723.5947933930323, -1338.3085578413989, -1221.5799683446749, -462.66276743867604, -217.6550900110865, -260.5022225677468, -270.8090027939619, -235.66877334673975, -1047.4865102243996, -285.85699033378194, -653.5601314838748, -122.13635866388856, -62.646216367996104, -1063.8947059638774, -385.8515871090534, 2.0000000000000013, -866.057874587937, -1267.5058947269192, -161.52104870020878, -442.3295306836117, -862.055448391068, -104.08201141222479, -380.26146862352033, -5.258695477406531, -331.7636403218241, 13.87999999999997, -1618.5771361791087, -1661.1842768912568, 3.795380589912167, 2.0000000000000013, -207.47533137291066, -206.03213308447283, -77.31592959786741, -754.4707707510822, -212.3766496812487, -56.29401172052455, 13.331857338702184, -149.82035852871087, -12.697586007123787, -308.20882387205796, -18.456699217311083, -82.19566105238182, 16.99736234768128, -576.4662943544591, -139.93933328834612, -711.0054234246022, -363.92750948172227, -44.18209073567298, -650.067824172131, -331.69273754894726, -134.89179764214373, 6.2318302562958205, -1.3585834957171696, -6.494220415761408, -0.22674925515602418, -321.4169202770865, -37.4225084261069, 8.003508857979064, 22.789999999999996, -120.98590634593285, -35.351977452815696, 33.062431457216924, -135.9552926383696, -43.91288967412121], "policy_predator_policy_reward": [44.03873804375354, 89.04175773205662, 58.184389583914715, 1193.2848433580025, 956.0300648588409, 90.11157779463224, 225.58019074239985, 48.97346888808397, 36.11309383759953, 30.52963164557324, 3.9080388679547697, 33.28821402995896, 65.86409756569779, 8.344403953397347, 156.1066720154352, 878.5739594616339, 60.30825318001441, 851.1358769555935, 80.378523457622, 131.76293674984143, 198.18075638875342, 8.69618286034151, 78.07757533947495, 27.499401021874387, 415.57156060649373, 136.07185350761904, 69.7400582204564, 945.1858149152953, 542.1379613121932, 914.7443964651007, 264.492802347515, 4.385849952276912, 50.99762876059128, 88.44924140787032, 909.1487471364355, 428.427513694756, 103.66061614423204, 441.2550478093028, 259.66416681821556, 580.8637510140668, 41.81792807615436, 4.559154432924419, 105.79857515328455, 41.46914963997712, 991.1984107218599, 1451.5374503073517, 545.2374677356895, 687.0950735656901, 63.26229479993963, 23.540275405135695, 275.3526905006266, 318.44475232449713, 95.76257967042308, 774.1407377309014, 1228.4205790872704, 1234.5082175794303, 1445.8519875010804, 53.03122946666253, 709.2905900916592, 463.58636417316876, 195.2767725649578, 168.23962758056004, 95.7939955528303, 62.11466077534376, 1520.2819518205376, 42.94402601461094, 444.67596785793705, 0.0, 294.46596575015417, 64.46095754969707, 960.4199690928823, 1048.6239151567302, 708.7930324658215, 1417.3556048408477, 179.30776754858346, 227.53788504956742, 1507.3636481412511, 26.51549927825025, 176.2304269471839, 749.0063960605945, 1207.3228994635178, 21.585612585491987, 1403.9517356600747, 47.63901930825521, 110.20343879920787, 1089.8588520037447, 617.8805164249296, 780.096878449057, 332.52307146892986, 66.37650926883055, 494.00674551335555, 431.50226728505737, 253.92970655852997, 151.22167984247218, 355.8974578591144, 1026.3849728076975, 179.80511624392685, 245.42093652115582, 1052.9334921543054, 130.71947261583318, 30.555807915552847, 868.0353023071665, 1238.6178726113983, 737.0958158938461, 116.50212148463018, 0.0, 556.3991354762559, 613.3581747086178, 1633.7739291971473, 1321.4484828892087, 1529.3286632115946, 1627.3216226213704, 1031.0710184064292, 1424.0039003117677, 565.3677801277282, 4.275551921715605, 1636.8929036849163, 685.1049274503736, 1050.6298800787952, 1568.4022384606837, 938.0576501161767, 1218.7415014262806, 800.7245774774846, 1027.0302367009658, 316.39534992526467, 332.1814435536197, 185.33498589078235, 146.8804552562154, 136.16792050295354, 11.249911570700089, 1021.3935615473971, 0.0, 835.9554319663721, 911.131420889688, 811.2628117334266, 622.6542797429039, 1038.3859951276984, 1244.4995495052574, 685.6702640055732, 1161.1198206627264, 177.0588878520372, 438.3659613543176, 195.2356985354085, 351.9639939644575, 285.1216089486398, 1038.528342149791, 313.97178372248175, 696.2119005656281, 110.15386404824848, 1049.3182998414716, 196.8818833171848, 297.7445866707187, 24.541356298400842, 1380.485687716788, 181.9410487002075, 428.56916823907943, 818.3613322820285, 767.3280014019639, 349.67668496982617, 74.72299064504591, 315.79482006363645, 226.78296668487945, 1520.680343672312, 1680.0459268506165, 0.0, 17.924619410087804, 160.66547936478867, 371.89820168727556, 693.2455940048018, 383.5811616878532, 6.965762337694477, 262.42664968124774, 73.07172960328009, 79.89677158672721, 272.465836734043, 268.15476676027384, 58.91303469477074, 47.91120173326287, 330.1029480850458, 396.009112031196, 711.695423424602, 145.5293332883454, 365.26750948172105, 46.05209073567261, 688.8141184682833, 713.8247983765248, 156.07448372218212, 47.41112801826547, 18.649518523638992, 42.453285387839685, 2.2167492551560213, 322.62692027708556, 40.40800638163932, 9.480421790588672, 112.87605158236715, 77.8709789173311, 72.75197745281552, 10.289933962275258, 36.40373111516611, 147.01445119732278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7370052553791218, "mean_inference_ms": 1.8184741595087166, "mean_action_processing_ms": 0.30196330279828787, "mean_env_wait_ms": 0.24131461252813655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032677650451660156, "StateBufferConnector_ms": 0.002731800079345703, "ViewRequirementAgentConnector_ms": 0.08214175701141357}, "num_episodes": 22, "episode_return_max": 1021.3131914604595, "episode_return_min": -1000.9941318053585, "episode_return_mean": 64.65965053840195, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.5028678397085, "num_env_steps_trained_throughput_per_sec": 440.5028678397085, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 9233.313, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9233.278, "sample_time_ms": 985.38, "learn_time_ms": 8234.739, "learn_throughput": 485.747, "synch_weights_time_ms": 12.217}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "1f15c_00000", "date": "2024-08-16_14-06-16", "timestamp": 1723797376, "time_this_iter_s": 9.084096908569336, "time_total_s": 181.95863699913025, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f866700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 181.95863699913025, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 23.5, "ram_util_percent": 70.34615384615383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9790022865016624, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9046821640912817, "policy_loss": -0.007605760232126587, "vf_loss": 3.9106259913671586, "vf_explained_var": -0.0002168592952546619, "kl": 0.008309705307620877, "entropy": 1.4577241505895342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9205586124664893, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4105853203743224, "policy_loss": -0.00869904981972896, "vf_loss": 3.4173447692205037, "vf_explained_var": 0.003988456946832163, "kl": 0.01939600631802295, "entropy": 1.2358881090053175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 1021.3131914604595, "episode_reward_min": -1000.9941318053585, "episode_reward_mean": 67.88554945148668, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1661.1842768912568, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 89.12000000000005, "predator_policy": 1680.0459268506165}, "policy_reward_mean": {"prey_policy": -400.93961790917456, "predator_policy": 434.8823926349177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.68366123516486, 95.77000000000095, 2.479999999999981, 37.27999999999996, 1021.3131914604595, -886.8099773893885, 435.29220658715576, 138.4858201954774, 6.429999999999948, 41.459999999999994, 49.90999999999972, 34.700000000000166, 276.2499840567376, -4.006589793855156, 42.736622254763475, -1000.9941318053585, 54.22162365255074, 63.479999999999784, -746.4478854474216, 102.39529396567815, 569.3410306284263, 19.568023497301535, 338.46238605994336, -26.8014826001315, 15.369999999999973, 144.29854540861373, 53.45999999999998, -579.2139715627293, -479.49024058295305, 13.689999999999921, 106.29276718808214, 202.5355157420733, 651.9164964700756, 159.39503944589922, -374.5841678314956, -285.4136187244069, -367.96783403413457, 695.6145408579596, 634.9821587024495, 315.2134064834419, 55.4083462370421, 10.389999999999928, -41.26172145518421, 676.2761938362479, 89.1395022772029, 220.98219339852665, 162.54734888494903, 137.26753662752233, 40.72191635916464, -9.69354945975051, 234.48719414034667, 32.93124155784636, 110.77488287885241, -728.5367252996663, 6.659637555468178, 619.5518738806984, 38.87951151394541, 224.69414642669062, -79.03514254743696, 23.720000000000486, 119.05621659468423, 245.04005534370498, 0.7217506171700202, 16.48000000000002, 219.71419361513477, 6.171876158339416, 166.6431281094635, 6.279999999999959, 3.209999999999962, 420.878355123731, 74.82564435460094, 53.249999999999986, 3.199999999999968, 20.469428604100152, 92.55112415376617, 80.75236541949296, 3.5499999999999647, -1.4018644617177785, 498.9747152062781, 19.190000000000445, 7.6799999999999224, 64.90000000000008, 13.17528759641213, 191.66313649252345, 38.34939960317956, 5.951091540217056, 92.31330419471453, 20.5104960110668, 3.48999999999997, 277.74981930947206, 8.54471118919827, 90.7840434186513, 12.564126974706198, 21.600000000000552, -13.142839786073225, 319.7710070587669, 70.83084764918117, -62.26219784847456, 17.97440225377986, 7.348519719751948], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-596.0190105906714, -483.6298694755449, 2.0000000000000013, 6.967429794924665, -4.419415977112344, -586.8980268480119, -768.1807377309017, -64.44257967042255, 55.45999999999977, -1497.0756052062384, -1042.0540492842633, -1343.6391450728677, 89.12000000000005, -826.7047476776727, 18.83000000000025, -243.8605799500391, -91.09399555282957, -60.3846607753441, -1.484026014611114, -1520.2819518205376, 26.92432189258161, -421.6902897505185, -62.7109575496968, -261.5159657501551, -697.7759096569155, -1035.0179905359591, -1453.2871705872406, -676.8680565132845, -366.1090303433873, 2.0000000000000013, -1150.5857086305805, -1384.28757059428, -715.9153846022231, -155.09981475300538, 40.1772327060878, -1205.605744755098, -1201.385199269952, -996.6534411457991, -74.28296386617859, -1023.384032971096, -901.9163642455609, 73.27999999999999, -271.73338408902816, -107.59817315143087, -173.80753557108673, -413.23909116738395, -199.70836648214612, -232.24450251898836, -340.9474578591153, -1025.9649728076974, -288.3044426232989, 7.376935266830053, -1022.7821749642078, -107.41078980593085, -622.7147601843053, -855.0903216011435, -1239.2905906346987, -1215.913338453498, -114.71212148462926, 11.89999999999996, -662.6074896040184, -400.8570533927749, -1532.929467596624, -1219.757428747658, -1192.1410267725025, -1312.592762590385, -881.8375115223807, -1413.8423677499163, -560.1753528040223, -384.0521470769173, -1371.1593848578932, -1236.2520650018032, -1434.9922238142797, -1552.0077287593342, -197.552720558812, -1263.6318901256852, -1210.3690957165102, 17.596440240509533, 33.68000000000012, -367.0433869954426, -122.49045525621584, -154.3166396537411, -30.641591315291784, -106.38624075836118, -46.641721455184175, -1016.0135615473974, 11.899999999999975, -1082.7106590198123, -770.4971377839474, -574.2804514151807, -723.5947933930323, -1338.3085578413989, -1221.5799683446749, -462.66276743867604, -217.6550900110865, -260.5022225677468, -270.8090027939619, -235.66877334673975, -1047.4865102243996, -285.85699033378194, -653.5601314838748, -122.13635866388856, -62.646216367996104, -1063.8947059638774, -385.8515871090534, 2.0000000000000013, -866.057874587937, -1267.5058947269192, -161.52104870020878, -442.3295306836117, -862.055448391068, -104.08201141222479, -380.26146862352033, -5.258695477406531, -331.7636403218241, 13.87999999999997, -1618.5771361791087, -1661.1842768912568, 3.795380589912167, 2.0000000000000013, -207.47533137291066, -206.03213308447283, -77.31592959786741, -754.4707707510822, -212.3766496812487, -56.29401172052455, 13.331857338702184, -149.82035852871087, -12.697586007123787, -308.20882387205796, -18.456699217311083, -82.19566105238182, 16.99736234768128, -576.4662943544591, -139.93933328834612, -711.0054234246022, -363.92750948172227, -44.18209073567298, -650.067824172131, -331.69273754894726, -134.89179764214373, 6.2318302562958205, -1.3585834957171696, -6.494220415761408, -0.22674925515602418, -321.4169202770865, -37.4225084261069, 8.003508857979064, 22.789999999999996, -120.98590634593285, -35.351977452815696, 33.062431457216924, -135.9552926383696, -43.91288967412121, -217.85980970933971, -43.24468437137466, -1116.24949882632, 8.929999999999959, -63.684382469062484, -81.84536766339498, -56.190905316483516, -9.198114462001291, 44.576064622402455, -115.12589602425258, -85.64555952024932, -17.652210661001508, 16.849999999999987, -371.6425685146679, -112.78576956812853, -175.47820729347, -57.91798016615976, 2.0000000000000013, -72.75163564614721, 21.6909614548087, 2.0000000000000013, -114.48352079684292, -48.698135709133204, -224.0381765509319, -229.44194505315684, -611.4286367387322, -7.145600075229121, 2.0000000000000013, -262.31360167670596, -45.32565208199077, -52.22075373863106, 2.0000000000000013, 5.075892807698283, -44.521062944271414, -149.55938774944542, -193.83067302643653, -632.7176111629961, -38.471994015474664, 9.895260069654862, -106.16287900811454, -174.72565460501337, -238.1809769104501, 11.899999999999979, -17.708265204172964, -10.94507642566712, 2.0000000000000013], "policy_predator_policy_reward": [545.2374677356895, 687.0950735656901, 63.26229479993963, 23.540275405135695, 275.3526905006266, 318.44475232449713, 95.76257967042308, 774.1407377309014, 1228.4205790872704, 1234.5082175794303, 1445.8519875010804, 53.03122946666253, 709.2905900916592, 463.58636417316876, 195.2767725649578, 168.23962758056004, 95.7939955528303, 62.11466077534376, 1520.2819518205376, 42.94402601461094, 444.67596785793705, 0.0, 294.46596575015417, 64.46095754969707, 960.4199690928823, 1048.6239151567302, 708.7930324658215, 1417.3556048408477, 179.30776754858346, 227.53788504956742, 1507.3636481412511, 26.51549927825025, 176.2304269471839, 749.0063960605945, 1207.3228994635178, 21.585612585491987, 1403.9517356600747, 47.63901930825521, 110.20343879920787, 1089.8588520037447, 617.8805164249296, 780.096878449057, 332.52307146892986, 66.37650926883055, 494.00674551335555, 431.50226728505737, 253.92970655852997, 151.22167984247218, 355.8974578591144, 1026.3849728076975, 179.80511624392685, 245.42093652115582, 1052.9334921543054, 130.71947261583318, 30.555807915552847, 868.0353023071665, 1238.6178726113983, 737.0958158938461, 116.50212148463018, 0.0, 556.3991354762559, 613.3581747086178, 1633.7739291971473, 1321.4484828892087, 1529.3286632115946, 1627.3216226213704, 1031.0710184064292, 1424.0039003117677, 565.3677801277282, 4.275551921715605, 1636.8929036849163, 685.1049274503736, 1050.6298800787952, 1568.4022384606837, 938.0576501161767, 1218.7415014262806, 800.7245774774846, 1027.0302367009658, 316.39534992526467, 332.1814435536197, 185.33498589078235, 146.8804552562154, 136.16792050295354, 11.249911570700089, 1021.3935615473971, 0.0, 835.9554319663721, 911.131420889688, 811.2628117334266, 622.6542797429039, 1038.3859951276984, 1244.4995495052574, 685.6702640055732, 1161.1198206627264, 177.0588878520372, 438.3659613543176, 195.2356985354085, 351.9639939644575, 285.1216089486398, 1038.528342149791, 313.97178372248175, 696.2119005656281, 110.15386404824848, 1049.3182998414716, 196.8818833171848, 297.7445866707187, 24.541356298400842, 1380.485687716788, 181.9410487002075, 428.56916823907943, 818.3613322820285, 767.3280014019639, 349.67668496982617, 74.72299064504591, 315.79482006363645, 226.78296668487945, 1520.680343672312, 1680.0459268506165, 0.0, 17.924619410087804, 160.66547936478867, 371.89820168727556, 693.2455940048018, 383.5811616878532, 6.965762337694477, 262.42664968124774, 73.07172960328009, 79.89677158672721, 272.465836734043, 268.15476676027384, 58.91303469477074, 47.91120173326287, 330.1029480850458, 396.009112031196, 711.695423424602, 145.5293332883454, 365.26750948172105, 46.05209073567261, 688.8141184682833, 713.8247983765248, 156.07448372218212, 47.41112801826547, 18.649518523638992, 42.453285387839685, 2.2167492551560213, 322.62692027708556, 40.40800638163932, 9.480421790588672, 112.87605158236715, 77.8709789173311, 72.75197745281552, 10.289933962275258, 36.40373111516611, 147.01445119732278, 223.93155646597359, 35.77107315302155, 1000.2206426646686, 606.0735713679302, 83.48536766339527, 81.23438246906305, 57.96090531648321, 15.10811446200125, 116.74589602425341, 18.70393537759747, 43.48204191108132, 72.99101586658259, 240.8673555918065, 305.5883494153835, 44.2348758182744, 282.37850064650513, 59.7179801661594, 2.151091540217096, 80.35117468132545, 63.022803704726876, 116.02352079684371, 16.97049601106629, 50.52813570913287, 225.6981765509305, 764.4540031445331, 354.16639795682636, 7.3808581380206375, 6.309453126406795, 205.97059301511555, 192.4527041622309, 9.28910535786201, 53.49577535547497, 10.710535331201331, 50.3346348053714, 310.7935344139013, 19.45368657590648, 585.7899987253156, 405.17061351192234, 77.0039315923932, 90.09453499524673, 148.27491258374585, 202.36952108323956, 9.34398185768314, 14.438685600269725, 3.4085197197520305, 12.885076425667078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7190604175638575, "mean_inference_ms": 1.7773955167107982, "mean_action_processing_ms": 0.29617322022947457, "mean_env_wait_ms": 0.23597100131129486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033197402954101562, "StateBufferConnector_ms": 0.002760171890258789, "ViewRequirementAgentConnector_ms": 0.08199417591094971}, "num_episodes": 23, "episode_return_max": 1021.3131914604595, "episode_return_min": -1000.9941318053585, "episode_return_mean": 67.88554945148668, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.31198017420724, "num_env_steps_trained_throughput_per_sec": 418.31198017420724, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 9281.647, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9281.612, "sample_time_ms": 985.86, "learn_time_ms": 8282.641, "learn_throughput": 482.938, "synch_weights_time_ms": 12.209}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "1f15c_00000", "date": "2024-08-16_14-06-25", "timestamp": 1723797385, "time_this_iter_s": 9.565682888031006, "time_total_s": 191.52431988716125, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8cdaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 191.52431988716125, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 25.157142857142855, "ram_util_percent": 70.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1240546887986875, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.816999911599689, "policy_loss": -0.008841995636577763, "vf_loss": 1.8243694545099975, "vf_explained_var": 0.0010020637007617445, "kl": 0.007362265808830822, "entropy": 1.4737302710139562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6868622503898762, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0293438410317455, "policy_loss": -0.006493143689641286, "vf_loss": 2.0347266185535955, "vf_explained_var": -0.00812794361164961, "kl": 0.011103649079883551, "entropy": 1.2628800025061955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 695.6145408579596, "episode_reward_min": -746.4478854474216, "episode_reward_mean": 67.84284103342952, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1661.1842768912568, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 73.27999999999999, "predator_policy": 1680.0459268506165}, "policy_reward_mean": {"prey_policy": -323.46658854065174, "predator_policy": 357.3880090573663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-746.4478854474216, 102.39529396567815, 569.3410306284263, 19.568023497301535, 338.46238605994336, -26.8014826001315, 15.369999999999973, 144.29854540861373, 53.45999999999998, -579.2139715627293, -479.49024058295305, 13.689999999999921, 106.29276718808214, 202.5355157420733, 651.9164964700756, 159.39503944589922, -374.5841678314956, -285.4136187244069, -367.96783403413457, 695.6145408579596, 634.9821587024495, 315.2134064834419, 55.4083462370421, 10.389999999999928, -41.26172145518421, 676.2761938362479, 89.1395022772029, 220.98219339852665, 162.54734888494903, 137.26753662752233, 40.72191635916464, -9.69354945975051, 234.48719414034667, 32.93124155784636, 110.77488287885241, -728.5367252996663, 6.659637555468178, 619.5518738806984, 38.87951151394541, 224.69414642669062, -79.03514254743696, 23.720000000000486, 119.05621659468423, 245.04005534370498, 0.7217506171700202, 16.48000000000002, 219.71419361513477, 6.171876158339416, 166.6431281094635, 6.279999999999959, 3.209999999999962, 420.878355123731, 74.82564435460094, 53.249999999999986, 3.199999999999968, 20.469428604100152, 92.55112415376617, 80.75236541949296, 3.5499999999999647, -1.4018644617177785, 498.9747152062781, 19.190000000000445, 7.6799999999999224, 64.90000000000008, 13.17528759641213, 191.66313649252345, 38.34939960317956, 5.951091540217056, 92.31330419471453, 20.5104960110668, 3.48999999999997, 277.74981930947206, 8.54471118919827, 90.7840434186513, 12.564126974706198, 21.600000000000552, -13.142839786073225, 319.7710070587669, 70.83084764918117, -62.26219784847456, 17.97440225377986, 7.348519719751948, 3.85999999999996, 58.29819823053991, 20.72000000000055, 3.299999999999969, 97.76718636135307, 5.499864069232124, 7.639999999999922, 62.35188585543995, 108.16652837316315, 18.15989974341125, 122.2559556010418, 7.403463726915748, -30.902254241758747, 15.867037838114959, 34.065573076002416, 3.4799999999999676, 50.27121906491849, -31.792989050381745], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1201.385199269952, -996.6534411457991, -74.28296386617859, -1023.384032971096, -901.9163642455609, 73.27999999999999, -271.73338408902816, -107.59817315143087, -173.80753557108673, -413.23909116738395, -199.70836648214612, -232.24450251898836, -340.9474578591153, -1025.9649728076974, -288.3044426232989, 7.376935266830053, -1022.7821749642078, -107.41078980593085, -622.7147601843053, -855.0903216011435, -1239.2905906346987, -1215.913338453498, -114.71212148462926, 11.89999999999996, -662.6074896040184, -400.8570533927749, -1532.929467596624, -1219.757428747658, -1192.1410267725025, -1312.592762590385, -881.8375115223807, -1413.8423677499163, -560.1753528040223, -384.0521470769173, -1371.1593848578932, -1236.2520650018032, -1434.9922238142797, -1552.0077287593342, -197.552720558812, -1263.6318901256852, -1210.3690957165102, 17.596440240509533, 33.68000000000012, -367.0433869954426, -122.49045525621584, -154.3166396537411, -30.641591315291784, -106.38624075836118, -46.641721455184175, -1016.0135615473974, 11.899999999999975, -1082.7106590198123, -770.4971377839474, -574.2804514151807, -723.5947933930323, -1338.3085578413989, -1221.5799683446749, -462.66276743867604, -217.6550900110865, -260.5022225677468, -270.8090027939619, -235.66877334673975, -1047.4865102243996, -285.85699033378194, -653.5601314838748, -122.13635866388856, -62.646216367996104, -1063.8947059638774, -385.8515871090534, 2.0000000000000013, -866.057874587937, -1267.5058947269192, -161.52104870020878, -442.3295306836117, -862.055448391068, -104.08201141222479, -380.26146862352033, -5.258695477406531, -331.7636403218241, 13.87999999999997, -1618.5771361791087, -1661.1842768912568, 3.795380589912167, 2.0000000000000013, -207.47533137291066, -206.03213308447283, -77.31592959786741, -754.4707707510822, -212.3766496812487, -56.29401172052455, 13.331857338702184, -149.82035852871087, -12.697586007123787, -308.20882387205796, -18.456699217311083, -82.19566105238182, 16.99736234768128, -576.4662943544591, -139.93933328834612, -711.0054234246022, -363.92750948172227, -44.18209073567298, -650.067824172131, -331.69273754894726, -134.89179764214373, 6.2318302562958205, -1.3585834957171696, -6.494220415761408, -0.22674925515602418, -321.4169202770865, -37.4225084261069, 8.003508857979064, 22.789999999999996, -120.98590634593285, -35.351977452815696, 33.062431457216924, -135.9552926383696, -43.91288967412121, -217.85980970933971, -43.24468437137466, -1116.24949882632, 8.929999999999959, -63.684382469062484, -81.84536766339498, -56.190905316483516, -9.198114462001291, 44.576064622402455, -115.12589602425258, -85.64555952024932, -17.652210661001508, 16.849999999999987, -371.6425685146679, -112.78576956812853, -175.47820729347, -57.91798016615976, 2.0000000000000013, -72.75163564614721, 21.6909614548087, 2.0000000000000013, -114.48352079684292, -48.698135709133204, -224.0381765509319, -229.44194505315684, -611.4286367387322, -7.145600075229121, 2.0000000000000013, -262.31360167670596, -45.32565208199077, -52.22075373863106, 2.0000000000000013, 5.075892807698283, -44.521062944271414, -149.55938774944542, -193.83067302643653, -632.7176111629961, -38.471994015474664, 9.895260069654862, -106.16287900811454, -174.72565460501337, -238.1809769104501, 11.899999999999979, -17.708265204172964, -10.94507642566712, 2.0000000000000013, -0.977446039455754, -50.76604631946495, -166.38832799121568, 0.2863079210893424, -18.93894828644856, 14.94222353450511, 2.0000000000000013, -426.4200886786748, -471.98073702034367, -61.09684281893112, -46.90646856491757, 2.0000000000000013, -49.59250173644342, -28.273228263701, -23.11654332206896, -143.0346265596036, -62.18523584267977, -451.38165743305063, 2.0000000000000013, -69.64324594794833, 2.0000000000000013, -184.97380032367704, -8.620780857504581, -8.124550918777299, -112.65672443898325, -74.58694315744827, 2.0000000000000013, -50.83054774311263, -43.000090179352675, -4.387899713662337, -28.782539977388993, -91.89238830407999, -20.81194373180265, -92.23668011934744, -44.5744524605043, -169.6003822762756], "policy_predator_policy_reward": [1403.9517356600747, 47.63901930825521, 110.20343879920787, 1089.8588520037447, 617.8805164249296, 780.096878449057, 332.52307146892986, 66.37650926883055, 494.00674551335555, 431.50226728505737, 253.92970655852997, 151.22167984247218, 355.8974578591144, 1026.3849728076975, 179.80511624392685, 245.42093652115582, 1052.9334921543054, 130.71947261583318, 30.555807915552847, 868.0353023071665, 1238.6178726113983, 737.0958158938461, 116.50212148463018, 0.0, 556.3991354762559, 613.3581747086178, 1633.7739291971473, 1321.4484828892087, 1529.3286632115946, 1627.3216226213704, 1031.0710184064292, 1424.0039003117677, 565.3677801277282, 4.275551921715605, 1636.8929036849163, 685.1049274503736, 1050.6298800787952, 1568.4022384606837, 938.0576501161767, 1218.7415014262806, 800.7245774774846, 1027.0302367009658, 316.39534992526467, 332.1814435536197, 185.33498589078235, 146.8804552562154, 136.16792050295354, 11.249911570700089, 1021.3935615473971, 0.0, 835.9554319663721, 911.131420889688, 811.2628117334266, 622.6542797429039, 1038.3859951276984, 1244.4995495052574, 685.6702640055732, 1161.1198206627264, 177.0588878520372, 438.3659613543176, 195.2356985354085, 351.9639939644575, 285.1216089486398, 1038.528342149791, 313.97178372248175, 696.2119005656281, 110.15386404824848, 1049.3182998414716, 196.8818833171848, 297.7445866707187, 24.541356298400842, 1380.485687716788, 181.9410487002075, 428.56916823907943, 818.3613322820285, 767.3280014019639, 349.67668496982617, 74.72299064504591, 315.79482006363645, 226.78296668487945, 1520.680343672312, 1680.0459268506165, 0.0, 17.924619410087804, 160.66547936478867, 371.89820168727556, 693.2455940048018, 383.5811616878532, 6.965762337694477, 262.42664968124774, 73.07172960328009, 79.89677158672721, 272.465836734043, 268.15476676027384, 58.91303469477074, 47.91120173326287, 330.1029480850458, 396.009112031196, 711.695423424602, 145.5293332883454, 365.26750948172105, 46.05209073567261, 688.8141184682833, 713.8247983765248, 156.07448372218212, 47.41112801826547, 18.649518523638992, 42.453285387839685, 2.2167492551560213, 322.62692027708556, 40.40800638163932, 9.480421790588672, 112.87605158236715, 77.8709789173311, 72.75197745281552, 10.289933962275258, 36.40373111516611, 147.01445119732278, 223.93155646597359, 35.77107315302155, 1000.2206426646686, 606.0735713679302, 83.48536766339527, 81.23438246906305, 57.96090531648321, 15.10811446200125, 116.74589602425341, 18.70393537759747, 43.48204191108132, 72.99101586658259, 240.8673555918065, 305.5883494153835, 44.2348758182744, 282.37850064650513, 59.7179801661594, 2.151091540217096, 80.35117468132545, 63.022803704726876, 116.02352079684371, 16.97049601106629, 50.52813570913287, 225.6981765509305, 764.4540031445331, 354.16639795682636, 7.3808581380206375, 6.309453126406795, 205.97059301511555, 192.4527041622309, 9.28910535786201, 53.49577535547497, 10.710535331201331, 50.3346348053714, 310.7935344139013, 19.45368657590648, 585.7899987253156, 405.17061351192234, 77.0039315923932, 90.09453499524673, 148.27491258374585, 202.36952108323956, 9.34398185768314, 14.438685600269725, 3.4085197197520305, 12.885076425667078, 2.9574460394557356, 52.646046319464574, 129.9209198254349, 94.47929847523052, 3.8677764654948525, 20.848948286448856, 0.0, 427.7200886786736, 165.93449629611902, 464.9102699045073, 42.96555012888643, 7.440782505263026, 85.50573000014445, 0.0, 198.39116988167135, 30.111885855440597, 352.6537767127731, 269.0796449361183, 14.326583105136677, 71.47656258622354, 156.7368909091575, 148.49286501555846, 6.385324356397087, 17.763471146800537, 94.34519713149324, 61.996216223181584, 24.503132708740814, 40.19445287248648, 8.806934901628074, 72.6466280673889, 93.5123883040808, 30.642539977389276, 79.83963854583601, 83.48020437023429, 62.42821012316796, 119.95363556322894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7071806200463391, "mean_inference_ms": 1.7501180728857855, "mean_action_processing_ms": 0.29164305212497754, "mean_env_wait_ms": 0.23233276904665368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00335538387298584, "StateBufferConnector_ms": 0.002776622772216797, "ViewRequirementAgentConnector_ms": 0.08164370059967041}, "num_episodes": 18, "episode_return_max": 695.6145408579596, "episode_return_min": -746.4478854474216, "episode_return_mean": 67.84284103342952, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.5519101464528, "num_env_steps_trained_throughput_per_sec": 438.5519101464528, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 9269.177, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9269.142, "sample_time_ms": 987.391, "learn_time_ms": 8268.623, "learn_throughput": 483.756, "synch_weights_time_ms": 12.26}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "1f15c_00000", "date": "2024-08-16_14-06-35", "timestamp": 1723797395, "time_this_iter_s": 9.124002933502197, "time_total_s": 200.64832282066345, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8cd160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 200.64832282066345, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 24.038461538461533, "ram_util_percent": 70.99999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9780565616315005, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7391727890917863, "policy_loss": -0.00914231630943952, "vf_loss": 1.7468452757943875, "vf_explained_var": 0.00031537202300218047, "kl": 0.007349132295183073, "entropy": 1.454444214906642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2629966238188366, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8684444376715907, "policy_loss": -0.008561650290838862, "vf_loss": 1.8759492632573245, "vf_explained_var": -0.0018415488578655101, "kl": 0.010568295711540415, "entropy": 1.3642685747651195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 695.6145408579596, "episode_reward_min": -728.5367252996663, "episode_reward_mean": 70.90307684131815, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1661.1842768912568, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.576064622402455, "predator_policy": 1680.0459268506165}, "policy_reward_mean": {"prey_policy": -211.27903397119707, "predator_policy": 246.73057239185593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-367.96783403413457, 695.6145408579596, 634.9821587024495, 315.2134064834419, 55.4083462370421, 10.389999999999928, -41.26172145518421, 676.2761938362479, 89.1395022772029, 220.98219339852665, 162.54734888494903, 137.26753662752233, 40.72191635916464, -9.69354945975051, 234.48719414034667, 32.93124155784636, 110.77488287885241, -728.5367252996663, 6.659637555468178, 619.5518738806984, 38.87951151394541, 224.69414642669062, -79.03514254743696, 23.720000000000486, 119.05621659468423, 245.04005534370498, 0.7217506171700202, 16.48000000000002, 219.71419361513477, 6.171876158339416, 166.6431281094635, 6.279999999999959, 3.209999999999962, 420.878355123731, 74.82564435460094, 53.249999999999986, 3.199999999999968, 20.469428604100152, 92.55112415376617, 80.75236541949296, 3.5499999999999647, -1.4018644617177785, 498.9747152062781, 19.190000000000445, 7.6799999999999224, 64.90000000000008, 13.17528759641213, 191.66313649252345, 38.34939960317956, 5.951091540217056, 92.31330419471453, 20.5104960110668, 3.48999999999997, 277.74981930947206, 8.54471118919827, 90.7840434186513, 12.564126974706198, 21.600000000000552, -13.142839786073225, 319.7710070587669, 70.83084764918117, -62.26219784847456, 17.97440225377986, 7.348519719751948, 3.85999999999996, 58.29819823053991, 20.72000000000055, 3.299999999999969, 97.76718636135307, 5.499864069232124, 7.639999999999922, 62.35188585543995, 108.16652837316315, 18.15989974341125, 122.2559556010418, 7.403463726915748, -30.902254241758747, 15.867037838114959, 34.065573076002416, 3.4799999999999676, 50.27121906491849, -31.792989050381745, 6.9499999999999265, 20.600000000000296, 11.029704729867529, 11.656247010907206, 3.8399999999999626, 6.9103697513192825, 2.7699999999999823, 7.609999999999934, 42.685955416898324, 3.6799999999999637, 4.985380900141258, 3.919999999999959, 10.134091575275102, 8.040514598335182, 9.035311900357618, 9.671612368050456, 24.66000000000045, 2.618124194664569], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1434.9922238142797, -1552.0077287593342, -197.552720558812, -1263.6318901256852, -1210.3690957165102, 17.596440240509533, 33.68000000000012, -367.0433869954426, -122.49045525621584, -154.3166396537411, -30.641591315291784, -106.38624075836118, -46.641721455184175, -1016.0135615473974, 11.899999999999975, -1082.7106590198123, -770.4971377839474, -574.2804514151807, -723.5947933930323, -1338.3085578413989, -1221.5799683446749, -462.66276743867604, -217.6550900110865, -260.5022225677468, -270.8090027939619, -235.66877334673975, -1047.4865102243996, -285.85699033378194, -653.5601314838748, -122.13635866388856, -62.646216367996104, -1063.8947059638774, -385.8515871090534, 2.0000000000000013, -866.057874587937, -1267.5058947269192, -161.52104870020878, -442.3295306836117, -862.055448391068, -104.08201141222479, -380.26146862352033, -5.258695477406531, -331.7636403218241, 13.87999999999997, -1618.5771361791087, -1661.1842768912568, 3.795380589912167, 2.0000000000000013, -207.47533137291066, -206.03213308447283, -77.31592959786741, -754.4707707510822, -212.3766496812487, -56.29401172052455, 13.331857338702184, -149.82035852871087, -12.697586007123787, -308.20882387205796, -18.456699217311083, -82.19566105238182, 16.99736234768128, -576.4662943544591, -139.93933328834612, -711.0054234246022, -363.92750948172227, -44.18209073567298, -650.067824172131, -331.69273754894726, -134.89179764214373, 6.2318302562958205, -1.3585834957171696, -6.494220415761408, -0.22674925515602418, -321.4169202770865, -37.4225084261069, 8.003508857979064, 22.789999999999996, -120.98590634593285, -35.351977452815696, 33.062431457216924, -135.9552926383696, -43.91288967412121, -217.85980970933971, -43.24468437137466, -1116.24949882632, 8.929999999999959, -63.684382469062484, -81.84536766339498, -56.190905316483516, -9.198114462001291, 44.576064622402455, -115.12589602425258, -85.64555952024932, -17.652210661001508, 16.849999999999987, -371.6425685146679, -112.78576956812853, -175.47820729347, -57.91798016615976, 2.0000000000000013, -72.75163564614721, 21.6909614548087, 2.0000000000000013, -114.48352079684292, -48.698135709133204, -224.0381765509319, -229.44194505315684, -611.4286367387322, -7.145600075229121, 2.0000000000000013, -262.31360167670596, -45.32565208199077, -52.22075373863106, 2.0000000000000013, 5.075892807698283, -44.521062944271414, -149.55938774944542, -193.83067302643653, -632.7176111629961, -38.471994015474664, 9.895260069654862, -106.16287900811454, -174.72565460501337, -238.1809769104501, 11.899999999999979, -17.708265204172964, -10.94507642566712, 2.0000000000000013, -0.977446039455754, -50.76604631946495, -166.38832799121568, 0.2863079210893424, -18.93894828644856, 14.94222353450511, 2.0000000000000013, -426.4200886786748, -471.98073702034367, -61.09684281893112, -46.90646856491757, 2.0000000000000013, -49.59250173644342, -28.273228263701, -23.11654332206896, -143.0346265596036, -62.18523584267977, -451.38165743305063, 2.0000000000000013, -69.64324594794833, 2.0000000000000013, -184.97380032367704, -8.620780857504581, -8.124550918777299, -112.65672443898325, -74.58694315744827, 2.0000000000000013, -50.83054774311263, -43.000090179352675, -4.387899713662337, -28.782539977388993, -91.89238830407999, -20.81194373180265, -92.23668011934744, -44.5744524605043, -169.6003822762756, 4.969999999999963, -1.9867733457318861, -63.49503185400018, -5.528468400900287, -13.892301714319714, 2.0000000000000013, -3.2852035354336646, -49.902049267062395, -23.052524711495078, -8.830784314440056, -67.3748093960106, -93.03691291706835, -23.67144028084954, -548.4782418257785, -16.371367186517116, -77.29630169550099, 2.0000000000000013, -221.9714222755896, -66.78659717606159, -64.36261998715261, -22.472186026308037, -4.251302630092811, 2.0000000000000013, -54.161075814109545, 2.0000000000000013, -39.55563006879966, 2.0000000000000013, -101.60634767536122, 2.0000000000000013, -23.118189198283257, 2.0000000000000013, -9.697581065921307, 12.279612141313894, -14.211477762730182, -84.15475390571441, -395.91845156637703], "policy_predator_policy_reward": [1050.6298800787952, 1568.4022384606837, 938.0576501161767, 1218.7415014262806, 800.7245774774846, 1027.0302367009658, 316.39534992526467, 332.1814435536197, 185.33498589078235, 146.8804552562154, 136.16792050295354, 11.249911570700089, 1021.3935615473971, 0.0, 835.9554319663721, 911.131420889688, 811.2628117334266, 622.6542797429039, 1038.3859951276984, 1244.4995495052574, 685.6702640055732, 1161.1198206627264, 177.0588878520372, 438.3659613543176, 195.2356985354085, 351.9639939644575, 285.1216089486398, 1038.528342149791, 313.97178372248175, 696.2119005656281, 110.15386404824848, 1049.3182998414716, 196.8818833171848, 297.7445866707187, 24.541356298400842, 1380.485687716788, 181.9410487002075, 428.56916823907943, 818.3613322820285, 767.3280014019639, 349.67668496982617, 74.72299064504591, 315.79482006363645, 226.78296668487945, 1520.680343672312, 1680.0459268506165, 0.0, 17.924619410087804, 160.66547936478867, 371.89820168727556, 693.2455940048018, 383.5811616878532, 6.965762337694477, 262.42664968124774, 73.07172960328009, 79.89677158672721, 272.465836734043, 268.15476676027384, 58.91303469477074, 47.91120173326287, 330.1029480850458, 396.009112031196, 711.695423424602, 145.5293332883454, 365.26750948172105, 46.05209073567261, 688.8141184682833, 713.8247983765248, 156.07448372218212, 47.41112801826547, 18.649518523638992, 42.453285387839685, 2.2167492551560213, 322.62692027708556, 40.40800638163932, 9.480421790588672, 112.87605158236715, 77.8709789173311, 72.75197745281552, 10.289933962275258, 36.40373111516611, 147.01445119732278, 223.93155646597359, 35.77107315302155, 1000.2206426646686, 606.0735713679302, 83.48536766339527, 81.23438246906305, 57.96090531648321, 15.10811446200125, 116.74589602425341, 18.70393537759747, 43.48204191108132, 72.99101586658259, 240.8673555918065, 305.5883494153835, 44.2348758182744, 282.37850064650513, 59.7179801661594, 2.151091540217096, 80.35117468132545, 63.022803704726876, 116.02352079684371, 16.97049601106629, 50.52813570913287, 225.6981765509305, 764.4540031445331, 354.16639795682636, 7.3808581380206375, 6.309453126406795, 205.97059301511555, 192.4527041622309, 9.28910535786201, 53.49577535547497, 10.710535331201331, 50.3346348053714, 310.7935344139013, 19.45368657590648, 585.7899987253156, 405.17061351192234, 77.0039315923932, 90.09453499524673, 148.27491258374585, 202.36952108323956, 9.34398185768314, 14.438685600269725, 3.4085197197520305, 12.885076425667078, 2.9574460394557356, 52.646046319464574, 129.9209198254349, 94.47929847523052, 3.8677764654948525, 20.848948286448856, 0.0, 427.7200886786736, 165.93449629611902, 464.9102699045073, 42.96555012888643, 7.440782505263026, 85.50573000014445, 0.0, 198.39116988167135, 30.111885855440597, 352.6537767127731, 269.0796449361183, 14.326583105136677, 71.47656258622354, 156.7368909091575, 148.49286501555846, 6.385324356397087, 17.763471146800537, 94.34519713149324, 61.996216223181584, 24.503132708740814, 40.19445287248648, 8.806934901628074, 72.6466280673889, 93.5123883040808, 30.642539977389276, 79.83963854583601, 83.48020437023429, 62.42821012316796, 119.95363556322894, 3.9667733457318444, 0.0, 63.60306917223008, 26.02043108267094, 12.064495501105608, 10.857510943081678, 32.84942934356483, 31.99407046983812, 10.770784314440014, 24.952524711495375, 69.1048093960114, 98.2172826683879, 549.3282418257778, 25.591440280849834, 82.9763016955018, 18.301367186517407, 241.45435390881437, 21.20302378367285, 68.57659717606248, 66.25261998715358, 7.316683530234089, 24.392186026308337, 0.0, 56.08107581410916, 6.304091575275184, 41.385630068799294, 4.3205145983352615, 103.3263476753621, 5.095311900357702, 25.05818919828356, 11.647581065921266, 5.721612368050539, 10.460387858686069, 16.13147776273015, 247.9355213774338, 234.75580828932257]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.696749889064731, "mean_inference_ms": 1.7259993801596951, "mean_action_processing_ms": 0.28765569438392125, "mean_env_wait_ms": 0.2290487447120525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003292679786682129, "StateBufferConnector_ms": 0.0027097463607788086, "ViewRequirementAgentConnector_ms": 0.07893717288970947}, "num_episodes": 18, "episode_return_max": 695.6145408579596, "episode_return_min": -728.5367252996663, "episode_return_mean": 70.90307684131815, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.8619057051113, "num_env_steps_trained_throughput_per_sec": 426.8619057051113, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 9292.379, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9292.344, "sample_time_ms": 993.743, "learn_time_ms": 8285.546, "learn_throughput": 482.768, "synch_weights_time_ms": 12.177}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "1f15c_00000", "date": "2024-08-16_14-06-44", "timestamp": 1723797404, "time_this_iter_s": 9.374138116836548, "time_total_s": 210.0224609375, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f866700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 210.0224609375, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.307692307692307, "ram_util_percent": 70.95384615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.990461264148591, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.532962787466705, "policy_loss": -0.009241127908949263, "vf_loss": 2.5400886168555608, "vf_explained_var": 0.0009080017685259461, "kl": 0.010576492898446754, "entropy": 1.443804103482968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.288455231117193, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5089574277400972, "policy_loss": -0.006995875432978941, "vf_loss": 2.5151498600288673, "vf_explained_var": -0.004041008942972415, "kl": 0.008034441678685812, "entropy": 1.3108456124073613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 619.5518738806984, "episode_reward_min": -79.03514254743696, "episode_reward_mean": 51.132108577545566, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1661.1842768912568, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.576064622402455, "predator_policy": 1680.0459268506165}, "policy_reward_mean": {"prey_policy": -125.04074247386212, "predator_policy": 150.60679676263476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.659637555468178, 619.5518738806984, 38.87951151394541, 224.69414642669062, -79.03514254743696, 23.720000000000486, 119.05621659468423, 245.04005534370498, 0.7217506171700202, 16.48000000000002, 219.71419361513477, 6.171876158339416, 166.6431281094635, 6.279999999999959, 3.209999999999962, 420.878355123731, 74.82564435460094, 53.249999999999986, 3.199999999999968, 20.469428604100152, 92.55112415376617, 80.75236541949296, 3.5499999999999647, -1.4018644617177785, 498.9747152062781, 19.190000000000445, 7.6799999999999224, 64.90000000000008, 13.17528759641213, 191.66313649252345, 38.34939960317956, 5.951091540217056, 92.31330419471453, 20.5104960110668, 3.48999999999997, 277.74981930947206, 8.54471118919827, 90.7840434186513, 12.564126974706198, 21.600000000000552, -13.142839786073225, 319.7710070587669, 70.83084764918117, -62.26219784847456, 17.97440225377986, 7.348519719751948, 3.85999999999996, 58.29819823053991, 20.72000000000055, 3.299999999999969, 97.76718636135307, 5.499864069232124, 7.639999999999922, 62.35188585543995, 108.16652837316315, 18.15989974341125, 122.2559556010418, 7.403463726915748, -30.902254241758747, 15.867037838114959, 34.065573076002416, 3.4799999999999676, 50.27121906491849, -31.792989050381745, 6.9499999999999265, 20.600000000000296, 11.029704729867529, 11.656247010907206, 3.8399999999999626, 6.9103697513192825, 2.7699999999999823, 7.609999999999934, 42.685955416898324, 3.6799999999999637, 4.985380900141258, 3.919999999999959, 10.134091575275102, 8.040514598335182, 9.035311900357618, 9.671612368050456, 24.66000000000045, 2.618124194664569, 3.649999999999973, 20.824092288696995, 4.419999999999948, 3.549999999999965, 2.5099999999999856, -0.3195928135046715, 3.5599999999999645, 16.70000000000005, 3.479999999999964, 55.59921453023069, 27.600000000000524, 14.111314862121327, 32.16000000000042, 38.03999999999986, 6.4999999999999245, 3.6299999999999653, -22.608159956964318, 78.77293670497659], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-161.52104870020878, -442.3295306836117, -862.055448391068, -104.08201141222479, -380.26146862352033, -5.258695477406531, -331.7636403218241, 13.87999999999997, -1618.5771361791087, -1661.1842768912568, 3.795380589912167, 2.0000000000000013, -207.47533137291066, -206.03213308447283, -77.31592959786741, -754.4707707510822, -212.3766496812487, -56.29401172052455, 13.331857338702184, -149.82035852871087, -12.697586007123787, -308.20882387205796, -18.456699217311083, -82.19566105238182, 16.99736234768128, -576.4662943544591, -139.93933328834612, -711.0054234246022, -363.92750948172227, -44.18209073567298, -650.067824172131, -331.69273754894726, -134.89179764214373, 6.2318302562958205, -1.3585834957171696, -6.494220415761408, -0.22674925515602418, -321.4169202770865, -37.4225084261069, 8.003508857979064, 22.789999999999996, -120.98590634593285, -35.351977452815696, 33.062431457216924, -135.9552926383696, -43.91288967412121, -217.85980970933971, -43.24468437137466, -1116.24949882632, 8.929999999999959, -63.684382469062484, -81.84536766339498, -56.190905316483516, -9.198114462001291, 44.576064622402455, -115.12589602425258, -85.64555952024932, -17.652210661001508, 16.849999999999987, -371.6425685146679, -112.78576956812853, -175.47820729347, -57.91798016615976, 2.0000000000000013, -72.75163564614721, 21.6909614548087, 2.0000000000000013, -114.48352079684292, -48.698135709133204, -224.0381765509319, -229.44194505315684, -611.4286367387322, -7.145600075229121, 2.0000000000000013, -262.31360167670596, -45.32565208199077, -52.22075373863106, 2.0000000000000013, 5.075892807698283, -44.521062944271414, -149.55938774944542, -193.83067302643653, -632.7176111629961, -38.471994015474664, 9.895260069654862, -106.16287900811454, -174.72565460501337, -238.1809769104501, 11.899999999999979, -17.708265204172964, -10.94507642566712, 2.0000000000000013, -0.977446039455754, -50.76604631946495, -166.38832799121568, 0.2863079210893424, -18.93894828644856, 14.94222353450511, 2.0000000000000013, -426.4200886786748, -471.98073702034367, -61.09684281893112, -46.90646856491757, 2.0000000000000013, -49.59250173644342, -28.273228263701, -23.11654332206896, -143.0346265596036, -62.18523584267977, -451.38165743305063, 2.0000000000000013, -69.64324594794833, 2.0000000000000013, -184.97380032367704, -8.620780857504581, -8.124550918777299, -112.65672443898325, -74.58694315744827, 2.0000000000000013, -50.83054774311263, -43.000090179352675, -4.387899713662337, -28.782539977388993, -91.89238830407999, -20.81194373180265, -92.23668011934744, -44.5744524605043, -169.6003822762756, 4.969999999999963, -1.9867733457318861, -63.49503185400018, -5.528468400900287, -13.892301714319714, 2.0000000000000013, -3.2852035354336646, -49.902049267062395, -23.052524711495078, -8.830784314440056, -67.3748093960106, -93.03691291706835, -23.67144028084954, -548.4782418257785, -16.371367186517116, -77.29630169550099, 2.0000000000000013, -221.9714222755896, -66.78659717606159, -64.36261998715261, -22.472186026308037, -4.251302630092811, 2.0000000000000013, -54.161075814109545, 2.0000000000000013, -39.55563006879966, 2.0000000000000013, -101.60634767536122, 2.0000000000000013, -23.118189198283257, 2.0000000000000013, -9.697581065921307, 12.279612141313894, -14.211477762730182, -84.15475390571441, -395.91845156637703, -94.87693040427564, -75.7851658811198, -58.309042978835734, -126.21284528374045, -33.06245899065564, -179.32701213624327, -23.87728646875378, -118.58739948109154, -9.57575502670992, -625.248985847588, -145.22431814601842, -21.640054597337233, -123.19610525567948, -64.41445908637765, -29.110473630059268, 2.8304078190632187, -70.7086548743477, -83.00663835420757, 2.0000000000000013, -152.20036407861167, -48.266816686579645, 21.71367141775717, -80.87439448186569, 2.0000000000000013, -111.60168053991664, -28.47392398122523, -20.71659694596905, -149.15349614065036, -150.71769261696966, -17.5002969241644, -44.376140992873076, -74.31552048091588, -29.295598432059563, -152.55880194941506, 34.55468448323855, -223.4020626925456], "policy_predator_policy_reward": [181.9410487002075, 428.56916823907943, 818.3613322820285, 767.3280014019639, 349.67668496982617, 74.72299064504591, 315.79482006363645, 226.78296668487945, 1520.680343672312, 1680.0459268506165, 0.0, 17.924619410087804, 160.66547936478867, 371.89820168727556, 693.2455940048018, 383.5811616878532, 6.965762337694477, 262.42664968124774, 73.07172960328009, 79.89677158672721, 272.465836734043, 268.15476676027384, 58.91303469477074, 47.91120173326287, 330.1029480850458, 396.009112031196, 711.695423424602, 145.5293332883454, 365.26750948172105, 46.05209073567261, 688.8141184682833, 713.8247983765248, 156.07448372218212, 47.41112801826547, 18.649518523638992, 42.453285387839685, 2.2167492551560213, 322.62692027708556, 40.40800638163932, 9.480421790588672, 112.87605158236715, 77.8709789173311, 72.75197745281552, 10.289933962275258, 36.40373111516611, 147.01445119732278, 223.93155646597359, 35.77107315302155, 1000.2206426646686, 606.0735713679302, 83.48536766339527, 81.23438246906305, 57.96090531648321, 15.10811446200125, 116.74589602425341, 18.70393537759747, 43.48204191108132, 72.99101586658259, 240.8673555918065, 305.5883494153835, 44.2348758182744, 282.37850064650513, 59.7179801661594, 2.151091540217096, 80.35117468132545, 63.022803704726876, 116.02352079684371, 16.97049601106629, 50.52813570913287, 225.6981765509305, 764.4540031445331, 354.16639795682636, 7.3808581380206375, 6.309453126406795, 205.97059301511555, 192.4527041622309, 9.28910535786201, 53.49577535547497, 10.710535331201331, 50.3346348053714, 310.7935344139013, 19.45368657590648, 585.7899987253156, 405.17061351192234, 77.0039315923932, 90.09453499524673, 148.27491258374585, 202.36952108323956, 9.34398185768314, 14.438685600269725, 3.4085197197520305, 12.885076425667078, 2.9574460394557356, 52.646046319464574, 129.9209198254349, 94.47929847523052, 3.8677764654948525, 20.848948286448856, 0.0, 427.7200886786736, 165.93449629611902, 464.9102699045073, 42.96555012888643, 7.440782505263026, 85.50573000014445, 0.0, 198.39116988167135, 30.111885855440597, 352.6537767127731, 269.0796449361183, 14.326583105136677, 71.47656258622354, 156.7368909091575, 148.49286501555846, 6.385324356397087, 17.763471146800537, 94.34519713149324, 61.996216223181584, 24.503132708740814, 40.19445287248648, 8.806934901628074, 72.6466280673889, 93.5123883040808, 30.642539977389276, 79.83963854583601, 83.48020437023429, 62.42821012316796, 119.95363556322894, 3.9667733457318444, 0.0, 63.60306917223008, 26.02043108267094, 12.064495501105608, 10.857510943081678, 32.84942934356483, 31.99407046983812, 10.770784314440014, 24.952524711495375, 69.1048093960114, 98.2172826683879, 549.3282418257778, 25.591440280849834, 82.9763016955018, 18.301367186517407, 241.45435390881437, 21.20302378367285, 68.57659717606248, 66.25261998715358, 7.316683530234089, 24.392186026308337, 0.0, 56.08107581410916, 6.304091575275184, 41.385630068799294, 4.3205145983352615, 103.3263476753621, 5.095311900357702, 25.05818919828356, 11.647581065921266, 5.721612368050539, 10.460387858686069, 16.13147776273015, 247.9355213774338, 234.75580828932257, 96.72693040427659, 77.58516588112072, 100.83620115081762, 104.50977940045553, 101.76552627632766, 115.04394485056982, 25.757286468754074, 120.25739948109239, 625.7989858475877, 11.535755026709879, 19.809454454511766, 146.73532547533782, 139.31095500295933, 51.859609339099336, 30.99047363005956, 11.989592180936764, 84.69663835420842, 72.4986548743486, 17.675230088797786, 188.12434852004435, 50.126816686579275, 4.026328582243088, 10.30131486212141, 82.68439448186662, 56.043923981225475, 116.19168053991746, 57.11659694596888, 150.79349614064887, 28.1765555242874, 146.5414340168455, 30.085905271693058, 92.23575620209618, 4.993748931324219, 154.25249149318455, 195.7628842844963, 71.85743062978524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6874641584484781, "mean_inference_ms": 1.704521385675347, "mean_action_processing_ms": 0.28408824452482884, "mean_env_wait_ms": 0.2260318577838744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032846927642822266, "StateBufferConnector_ms": 0.0026935338973999023, "ViewRequirementAgentConnector_ms": 0.07836377620697021}, "num_episodes": 18, "episode_return_max": 619.5518738806984, "episode_return_min": -79.03514254743696, "episode_return_mean": 51.132108577545566, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.99823816850994, "num_env_steps_trained_throughput_per_sec": 424.99823816850994, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 9298.659, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9298.624, "sample_time_ms": 995.039, "learn_time_ms": 8290.81, "learn_throughput": 482.462, "synch_weights_time_ms": 11.925}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "1f15c_00000", "date": "2024-08-16_14-06-53", "timestamp": 1723797413, "time_this_iter_s": 9.414891958236694, "time_total_s": 219.4373528957367, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8749d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 219.4373528957367, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 27.761538461538464, "ram_util_percent": 71.12307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8337317546524068, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.284876745340054, "policy_loss": -0.010585488252361459, "vf_loss": 4.293635351948007, "vf_explained_var": 0.00031485680549863786, "kl": 0.009134433422900386, "entropy": 1.449063473845285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1764705095972334, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.398160627405479, "policy_loss": -0.00994686634999222, "vf_loss": 4.406939510441331, "vf_explained_var": 0.0007701485560684608, "kl": 0.011679741335721014, "entropy": 1.294408906767608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 702.7686792684216, "episode_reward_min": -571.028128721616, "episode_reward_mean": 34.179712970532165, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1657.9922236078362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.23000000000047, "predator_policy": 1595.0568141756373}, "policy_reward_mean": {"prey_policy": -120.8848460140064, "predator_policy": 137.97470249927238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.90000000000008, 13.17528759641213, 191.66313649252345, 38.34939960317956, 5.951091540217056, 92.31330419471453, 20.5104960110668, 3.48999999999997, 277.74981930947206, 8.54471118919827, 90.7840434186513, 12.564126974706198, 21.600000000000552, -13.142839786073225, 319.7710070587669, 70.83084764918117, -62.26219784847456, 17.97440225377986, 7.348519719751948, 3.85999999999996, 58.29819823053991, 20.72000000000055, 3.299999999999969, 97.76718636135307, 5.499864069232124, 7.639999999999922, 62.35188585543995, 108.16652837316315, 18.15989974341125, 122.2559556010418, 7.403463726915748, -30.902254241758747, 15.867037838114959, 34.065573076002416, 3.4799999999999676, 50.27121906491849, -31.792989050381745, 6.9499999999999265, 20.600000000000296, 11.029704729867529, 11.656247010907206, 3.8399999999999626, 6.9103697513192825, 2.7699999999999823, 7.609999999999934, 42.685955416898324, 3.6799999999999637, 4.985380900141258, 3.919999999999959, 10.134091575275102, 8.040514598335182, 9.035311900357618, 9.671612368050456, 24.66000000000045, 2.618124194664569, 3.649999999999973, 20.824092288696995, 4.419999999999948, 3.549999999999965, 2.5099999999999856, -0.3195928135046715, 3.5599999999999645, 16.70000000000005, 3.479999999999964, 55.59921453023069, 27.600000000000524, 14.111314862121327, 32.16000000000042, 38.03999999999986, 6.4999999999999245, 3.6299999999999653, -22.608159956964318, 78.77293670497659, 38.515040775270165, 5.739999999999921, 2.8299999999999788, 8.875458861432897, 8.239999999999931, 103.98218572709557, 3.9099999999999593, -10.349368836398918, 69.27659153846272, 21.493465062677178, -4.666910349530454, 702.7686792684216, 7.207161241172857, -11.492595529228376, 87.99220351252474, 59.52438624847859, -106.94436700918747, 55.13004873325545, 27.510000000000314, -1.5111708420585312, -571.028128721616, 3.4899999999999674, 3.2999999999999723, 460.8574360659545, 30.571191260807204, 163.12386932724854, 38.12227863199371], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [44.576064622402455, -115.12589602425258, -85.64555952024932, -17.652210661001508, 16.849999999999987, -371.6425685146679, -112.78576956812853, -175.47820729347, -57.91798016615976, 2.0000000000000013, -72.75163564614721, 21.6909614548087, 2.0000000000000013, -114.48352079684292, -48.698135709133204, -224.0381765509319, -229.44194505315684, -611.4286367387322, -7.145600075229121, 2.0000000000000013, -262.31360167670596, -45.32565208199077, -52.22075373863106, 2.0000000000000013, 5.075892807698283, -44.521062944271414, -149.55938774944542, -193.83067302643653, -632.7176111629961, -38.471994015474664, 9.895260069654862, -106.16287900811454, -174.72565460501337, -238.1809769104501, 11.899999999999979, -17.708265204172964, -10.94507642566712, 2.0000000000000013, -0.977446039455754, -50.76604631946495, -166.38832799121568, 0.2863079210893424, -18.93894828644856, 14.94222353450511, 2.0000000000000013, -426.4200886786748, -471.98073702034367, -61.09684281893112, -46.90646856491757, 2.0000000000000013, -49.59250173644342, -28.273228263701, -23.11654332206896, -143.0346265596036, -62.18523584267977, -451.38165743305063, 2.0000000000000013, -69.64324594794833, 2.0000000000000013, -184.97380032367704, -8.620780857504581, -8.124550918777299, -112.65672443898325, -74.58694315744827, 2.0000000000000013, -50.83054774311263, -43.000090179352675, -4.387899713662337, -28.782539977388993, -91.89238830407999, -20.81194373180265, -92.23668011934744, -44.5744524605043, -169.6003822762756, 4.969999999999963, -1.9867733457318861, -63.49503185400018, -5.528468400900287, -13.892301714319714, 2.0000000000000013, -3.2852035354336646, -49.902049267062395, -23.052524711495078, -8.830784314440056, -67.3748093960106, -93.03691291706835, -23.67144028084954, -548.4782418257785, -16.371367186517116, -77.29630169550099, 2.0000000000000013, -221.9714222755896, -66.78659717606159, -64.36261998715261, -22.472186026308037, -4.251302630092811, 2.0000000000000013, -54.161075814109545, 2.0000000000000013, -39.55563006879966, 2.0000000000000013, -101.60634767536122, 2.0000000000000013, -23.118189198283257, 2.0000000000000013, -9.697581065921307, 12.279612141313894, -14.211477762730182, -84.15475390571441, -395.91845156637703, -94.87693040427564, -75.7851658811198, -58.309042978835734, -126.21284528374045, -33.06245899065564, -179.32701213624327, -23.87728646875378, -118.58739948109154, -9.57575502670992, -625.248985847588, -145.22431814601842, -21.640054597337233, -123.19610525567948, -64.41445908637765, -29.110473630059268, 2.8304078190632187, -70.7086548743477, -83.00663835420757, 2.0000000000000013, -152.20036407861167, -48.266816686579645, 21.71367141775717, -80.87439448186569, 2.0000000000000013, -111.60168053991664, -28.47392398122523, -20.71659694596905, -149.15349614065036, -150.71769261696966, -17.5002969241644, -44.376140992873076, -74.31552048091588, -29.295598432059563, -152.55880194941506, 34.55468448323855, -223.4020626925456, -46.62508286526746, 2.0000000000000013, -52.61589798612227, -8.078980187472226, -75.3006475518419, -468.81828383918435, -77.86592392923906, -90.56012778136075, -23.069820456074403, -393.62971761175345, -199.66360223838922, 13.87999999999996, 2.0000000000000013, -21.329911041759395, -93.85895081857541, -88.21282260513674, -302.5372207204874, -35.04804863521169, -18.075323788742658, -48.28078916546442, -26.063678630206137, -145.788277066407, 2.0000000000000013, -1657.9922236078362, -245.80721457290412, -5.956662921076975, -60.0915569833817, -31.32050885405158, -61.6570320728781, 78.23000000000047, 2.98999999999998, -134.83781956934283, -1088.6057749232943, -927.0385982559808, -157.80676203723272, -110.82891690116122, -446.3968147048462, -107.5161609228864, -125.05728158481071, -52.627246316541125, -1107.694094402264, -1151.530753130176, -108.39179965523928, -232.74020579906212, -39.79009994878883, -182.45086651657735, -1245.485931003045, 36.902148326630865, 16.85000000000011, -34.034242486313026, 7.9399999999999595, -239.60241399598485, -254.67881848293518, -73.17561195338939], "policy_predator_policy_reward": [116.74589602425341, 18.70393537759747, 43.48204191108132, 72.99101586658259, 240.8673555918065, 305.5883494153835, 44.2348758182744, 282.37850064650513, 59.7179801661594, 2.151091540217096, 80.35117468132545, 63.022803704726876, 116.02352079684371, 16.97049601106629, 50.52813570913287, 225.6981765509305, 764.4540031445331, 354.16639795682636, 7.3808581380206375, 6.309453126406795, 205.97059301511555, 192.4527041622309, 9.28910535786201, 53.49577535547497, 10.710535331201331, 50.3346348053714, 310.7935344139013, 19.45368657590648, 585.7899987253156, 405.17061351192234, 77.0039315923932, 90.09453499524673, 148.27491258374585, 202.36952108323956, 9.34398185768314, 14.438685600269725, 3.4085197197520305, 12.885076425667078, 2.9574460394557356, 52.646046319464574, 129.9209198254349, 94.47929847523052, 3.8677764654948525, 20.848948286448856, 0.0, 427.7200886786736, 165.93449629611902, 464.9102699045073, 42.96555012888643, 7.440782505263026, 85.50573000014445, 0.0, 198.39116988167135, 30.111885855440597, 352.6537767127731, 269.0796449361183, 14.326583105136677, 71.47656258622354, 156.7368909091575, 148.49286501555846, 6.385324356397087, 17.763471146800537, 94.34519713149324, 61.996216223181584, 24.503132708740814, 40.19445287248648, 8.806934901628074, 72.6466280673889, 93.5123883040808, 30.642539977389276, 79.83963854583601, 83.48020437023429, 62.42821012316796, 119.95363556322894, 3.9667733457318444, 0.0, 63.60306917223008, 26.02043108267094, 12.064495501105608, 10.857510943081678, 32.84942934356483, 31.99407046983812, 10.770784314440014, 24.952524711495375, 69.1048093960114, 98.2172826683879, 549.3282418257778, 25.591440280849834, 82.9763016955018, 18.301367186517407, 241.45435390881437, 21.20302378367285, 68.57659717606248, 66.25261998715358, 7.316683530234089, 24.392186026308337, 0.0, 56.08107581410916, 6.304091575275184, 41.385630068799294, 4.3205145983352615, 103.3263476753621, 5.095311900357702, 25.05818919828356, 11.647581065921266, 5.721612368050539, 10.460387858686069, 16.13147776273015, 247.9355213774338, 234.75580828932257, 96.72693040427659, 77.58516588112072, 100.83620115081762, 104.50977940045553, 101.76552627632766, 115.04394485056982, 25.757286468754074, 120.25739948109239, 625.7989858475877, 11.535755026709879, 19.809454454511766, 146.73532547533782, 139.31095500295933, 51.859609339099336, 30.99047363005956, 11.989592180936764, 84.69663835420842, 72.4986548743486, 17.675230088797786, 188.12434852004435, 50.126816686579275, 4.026328582243088, 10.30131486212141, 82.68439448186662, 56.043923981225475, 116.19168053991746, 57.11659694596888, 150.79349614064887, 28.1765555242874, 146.5414340168455, 30.085905271693058, 92.23575620209618, 4.993748931324219, 154.25249149318455, 195.7628842844963, 71.85743062978524, 43.14007232871445, 40.00005131182354, 12.018980187472184, 54.41589798612191, 77.11064755184283, 469.8382838391834, 88.14292474023851, 89.15858583179572, 29.919820456074692, 395.0197176117522, 138.7294908373938, 151.03629712808785, 23.239911041759694, 0.0, 68.04971593030632, 103.67268865700805, 273.6345620850361, 133.22729880912317, 40.281854877838384, 47.56772313904547, 88.54873337461801, 78.63631197246372, 763.7040887006212, 1595.0568141756373, 157.13864525566797, 101.83239347948538, 27.668128219932594, 52.251342088272025, 7.982203512523767, 63.43703207287775, 64.60623591240739, 126.76596990541333, 1491.5971729231242, 417.10283324696155, 161.73143638372, 162.03429128792936, 472.24681470484575, 109.17616092288725, 136.47111651527757, 39.70224054401613, 1042.6191395141338, 645.5775792966906, 231.99484954869726, 112.62715590560354, 183.90086651657603, 41.640099948788475, 1110.9044809034922, 558.5367378388752, 11.831191260806623, 35.92424248631265, 189.37983558262638, 205.4064477406084, 89.98458355275862, 275.99212551555956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6768560124693596, "mean_inference_ms": 1.6776112853753724, "mean_action_processing_ms": 0.2795742045710318, "mean_env_wait_ms": 0.22309784833422497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00376737117767334, "StateBufferConnector_ms": 0.0029562711715698242, "ViewRequirementAgentConnector_ms": 0.0925900936126709}, "num_episodes": 27, "episode_return_max": 702.7686792684216, "episode_return_min": -571.028128721616, "episode_return_mean": 34.179712970532165, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.0123416050087, "num_env_steps_trained_throughput_per_sec": 423.0123416050087, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 9317.883, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9317.847, "sample_time_ms": 1005.645, "learn_time_ms": 8299.37, "learn_throughput": 481.964, "synch_weights_time_ms": 11.92}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "1f15c_00000", "date": "2024-08-16_14-07-03", "timestamp": 1723797423, "time_this_iter_s": 9.459558963775635, "time_total_s": 228.89691185951233, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8ba820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 228.89691185951233, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.38571428571429, "ram_util_percent": 71.25714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9890472786451774, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7460086925319893, "policy_loss": -0.005870966960444416, "vf_loss": 2.750473218115549, "vf_explained_var": 0.0006431870359592337, "kl": 0.007032181404804244, "entropy": 1.4209427524496008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4177332837745626, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.320719722528306, "policy_loss": -0.005786162035825549, "vf_loss": 3.3257869593050113, "vf_explained_var": 0.0010841111657480713, "kl": 0.00718930825023695, "entropy": 1.3953673217662428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 702.7686792684216, "episode_reward_min": -571.028128721616, "episode_reward_mean": 27.62532629930023, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1657.9922236078362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.23000000000047, "predator_policy": 1595.0568141756373}, "policy_reward_mean": {"prey_policy": -127.76267621909267, "predator_policy": 141.57533936874268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.348519719751948, 3.85999999999996, 58.29819823053991, 20.72000000000055, 3.299999999999969, 97.76718636135307, 5.499864069232124, 7.639999999999922, 62.35188585543995, 108.16652837316315, 18.15989974341125, 122.2559556010418, 7.403463726915748, -30.902254241758747, 15.867037838114959, 34.065573076002416, 3.4799999999999676, 50.27121906491849, -31.792989050381745, 6.9499999999999265, 20.600000000000296, 11.029704729867529, 11.656247010907206, 3.8399999999999626, 6.9103697513192825, 2.7699999999999823, 7.609999999999934, 42.685955416898324, 3.6799999999999637, 4.985380900141258, 3.919999999999959, 10.134091575275102, 8.040514598335182, 9.035311900357618, 9.671612368050456, 24.66000000000045, 2.618124194664569, 3.649999999999973, 20.824092288696995, 4.419999999999948, 3.549999999999965, 2.5099999999999856, -0.3195928135046715, 3.5599999999999645, 16.70000000000005, 3.479999999999964, 55.59921453023069, 27.600000000000524, 14.111314862121327, 32.16000000000042, 38.03999999999986, 6.4999999999999245, 3.6299999999999653, -22.608159956964318, 78.77293670497659, 38.515040775270165, 5.739999999999921, 2.8299999999999788, 8.875458861432897, 8.239999999999931, 103.98218572709557, 3.9099999999999593, -10.349368836398918, 69.27659153846272, 21.493465062677178, -4.666910349530454, 702.7686792684216, 7.207161241172857, -11.492595529228376, 87.99220351252474, 59.52438624847859, -106.94436700918747, 55.13004873325545, 27.510000000000314, -1.5111708420585312, -571.028128721616, 3.4899999999999674, 3.2999999999999723, 460.8574360659545, 30.571191260807204, 163.12386932724854, 38.12227863199371, 85.6998883704094, 1.719999999999966, 83.71238347228442, 28.159420692075162, 49.966065451708275, 4.899999999999939, 1.9399999999999675, -20.21825885761431, 3.6399999999999624, 113.58011161217414, 3.169999999999971, 26.949157631548545, 48.975076553082125, 21.944426156107294, -13.785592625134614, -2.697295951732066, 61.93258602921913, 19.740000000000574], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.94507642566712, 2.0000000000000013, -0.977446039455754, -50.76604631946495, -166.38832799121568, 0.2863079210893424, -18.93894828644856, 14.94222353450511, 2.0000000000000013, -426.4200886786748, -471.98073702034367, -61.09684281893112, -46.90646856491757, 2.0000000000000013, -49.59250173644342, -28.273228263701, -23.11654332206896, -143.0346265596036, -62.18523584267977, -451.38165743305063, 2.0000000000000013, -69.64324594794833, 2.0000000000000013, -184.97380032367704, -8.620780857504581, -8.124550918777299, -112.65672443898325, -74.58694315744827, 2.0000000000000013, -50.83054774311263, -43.000090179352675, -4.387899713662337, -28.782539977388993, -91.89238830407999, -20.81194373180265, -92.23668011934744, -44.5744524605043, -169.6003822762756, 4.969999999999963, -1.9867733457318861, -63.49503185400018, -5.528468400900287, -13.892301714319714, 2.0000000000000013, -3.2852035354336646, -49.902049267062395, -23.052524711495078, -8.830784314440056, -67.3748093960106, -93.03691291706835, -23.67144028084954, -548.4782418257785, -16.371367186517116, -77.29630169550099, 2.0000000000000013, -221.9714222755896, -66.78659717606159, -64.36261998715261, -22.472186026308037, -4.251302630092811, 2.0000000000000013, -54.161075814109545, 2.0000000000000013, -39.55563006879966, 2.0000000000000013, -101.60634767536122, 2.0000000000000013, -23.118189198283257, 2.0000000000000013, -9.697581065921307, 12.279612141313894, -14.211477762730182, -84.15475390571441, -395.91845156637703, -94.87693040427564, -75.7851658811198, -58.309042978835734, -126.21284528374045, -33.06245899065564, -179.32701213624327, -23.87728646875378, -118.58739948109154, -9.57575502670992, -625.248985847588, -145.22431814601842, -21.640054597337233, -123.19610525567948, -64.41445908637765, -29.110473630059268, 2.8304078190632187, -70.7086548743477, -83.00663835420757, 2.0000000000000013, -152.20036407861167, -48.266816686579645, 21.71367141775717, -80.87439448186569, 2.0000000000000013, -111.60168053991664, -28.47392398122523, -20.71659694596905, -149.15349614065036, -150.71769261696966, -17.5002969241644, -44.376140992873076, -74.31552048091588, -29.295598432059563, -152.55880194941506, 34.55468448323855, -223.4020626925456, -46.62508286526746, 2.0000000000000013, -52.61589798612227, -8.078980187472226, -75.3006475518419, -468.81828383918435, -77.86592392923906, -90.56012778136075, -23.069820456074403, -393.62971761175345, -199.66360223838922, 13.87999999999996, 2.0000000000000013, -21.329911041759395, -93.85895081857541, -88.21282260513674, -302.5372207204874, -35.04804863521169, -18.075323788742658, -48.28078916546442, -26.063678630206137, -145.788277066407, 2.0000000000000013, -1657.9922236078362, -245.80721457290412, -5.956662921076975, -60.0915569833817, -31.32050885405158, -61.6570320728781, 78.23000000000047, 2.98999999999998, -134.83781956934283, -1088.6057749232943, -927.0385982559808, -157.80676203723272, -110.82891690116122, -446.3968147048462, -107.5161609228864, -125.05728158481071, -52.627246316541125, -1107.694094402264, -1151.530753130176, -108.39179965523928, -232.74020579906212, -39.79009994878883, -182.45086651657735, -1245.485931003045, 36.902148326630865, 16.85000000000011, -34.034242486313026, 7.9399999999999595, -239.60241399598485, -254.67881848293518, -73.17561195338939, -71.14497173168226, -282.0719144730025, -129.4695885481589, -1302.5921821250136, -205.74043709127056, -38.863564124629995, -54.172965852467314, -75.61772994088675, 28.73000000000026, -246.207640626645, 2.98999999999998, -23.05694736190947, -1300.3531745508478, -171.0690142836274, -119.05353362631041, -140.82436454219973, -6.771628409939613, -123.2710137830425, 22.79000000000028, -112.32205515402626, -142.53765806460603, -165.71898453504767, -142.92136519898705, 12.88999999999996, -102.61454223712221, 2.0000000000000013, 11.89999999999996, -57.827445241086224, -137.30118430681546, -101.3045171367763, -35.40291301327857, -27.463277749994614, 36.65, -255.3164796050001, -22.331123190118614, 17.840000000000288], "policy_predator_policy_reward": [3.4085197197520305, 12.885076425667078, 2.9574460394557356, 52.646046319464574, 129.9209198254349, 94.47929847523052, 3.8677764654948525, 20.848948286448856, 0.0, 427.7200886786736, 165.93449629611902, 464.9102699045073, 42.96555012888643, 7.440782505263026, 85.50573000014445, 0.0, 198.39116988167135, 30.111885855440597, 352.6537767127731, 269.0796449361183, 14.326583105136677, 71.47656258622354, 156.7368909091575, 148.49286501555846, 6.385324356397087, 17.763471146800537, 94.34519713149324, 61.996216223181584, 24.503132708740814, 40.19445287248648, 8.806934901628074, 72.6466280673889, 93.5123883040808, 30.642539977389276, 79.83963854583601, 83.48020437023429, 62.42821012316796, 119.95363556322894, 3.9667733457318444, 0.0, 63.60306917223008, 26.02043108267094, 12.064495501105608, 10.857510943081678, 32.84942934356483, 31.99407046983812, 10.770784314440014, 24.952524711495375, 69.1048093960114, 98.2172826683879, 549.3282418257778, 25.591440280849834, 82.9763016955018, 18.301367186517407, 241.45435390881437, 21.20302378367285, 68.57659717606248, 66.25261998715358, 7.316683530234089, 24.392186026308337, 0.0, 56.08107581410916, 6.304091575275184, 41.385630068799294, 4.3205145983352615, 103.3263476753621, 5.095311900357702, 25.05818919828356, 11.647581065921266, 5.721612368050539, 10.460387858686069, 16.13147776273015, 247.9355213774338, 234.75580828932257, 96.72693040427659, 77.58516588112072, 100.83620115081762, 104.50977940045553, 101.76552627632766, 115.04394485056982, 25.757286468754074, 120.25739948109239, 625.7989858475877, 11.535755026709879, 19.809454454511766, 146.73532547533782, 139.31095500295933, 51.859609339099336, 30.99047363005956, 11.989592180936764, 84.69663835420842, 72.4986548743486, 17.675230088797786, 188.12434852004435, 50.126816686579275, 4.026328582243088, 10.30131486212141, 82.68439448186662, 56.043923981225475, 116.19168053991746, 57.11659694596888, 150.79349614064887, 28.1765555242874, 146.5414340168455, 30.085905271693058, 92.23575620209618, 4.993748931324219, 154.25249149318455, 195.7628842844963, 71.85743062978524, 43.14007232871445, 40.00005131182354, 12.018980187472184, 54.41589798612191, 77.11064755184283, 469.8382838391834, 88.14292474023851, 89.15858583179572, 29.919820456074692, 395.0197176117522, 138.7294908373938, 151.03629712808785, 23.239911041759694, 0.0, 68.04971593030632, 103.67268865700805, 273.6345620850361, 133.22729880912317, 40.281854877838384, 47.56772313904547, 88.54873337461801, 78.63631197246372, 763.7040887006212, 1595.0568141756373, 157.13864525566797, 101.83239347948538, 27.668128219932594, 52.251342088272025, 7.982203512523767, 63.43703207287775, 64.60623591240739, 126.76596990541333, 1491.5971729231242, 417.10283324696155, 161.73143638372, 162.03429128792936, 472.24681470484575, 109.17616092288725, 136.47111651527757, 39.70224054401613, 1042.6191395141338, 645.5775792966906, 231.99484954869726, 112.62715590560354, 183.90086651657603, 41.640099948788475, 1110.9044809034922, 558.5367378388752, 11.831191260806623, 35.92424248631265, 189.37983558262638, 205.4064477406084, 89.98458355275862, 275.99212551555956, 278.76638118866697, 160.1503933864253, 131.18958854815733, 1302.5921821250136, 181.68602431028364, 146.63036037789834, 157.95011648542933, 0.0, 39.167940526363964, 228.27576555198905, 24.966947361909767, 0.0, 1300.533174550848, 172.8290142836258, 143.2856168299014, 96.37402248099427, 8.721628409939575, 124.96101378304337, 109.4073539494768, 93.70481281672402, 232.84314342126197, 78.58349917838973, 12.95181022158507, 144.02871260894838, 99.56254649614802, 50.02707229405798, 63.527666473425924, 4.344204923766674, 89.799189992979, 135.02091882547845, 40.77758505311655, 19.39130975842461, 197.77944474489732, 82.81962088932102, 0.0, 24.23112319011891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6696741536329043, "mean_inference_ms": 1.6630404321426995, "mean_action_processing_ms": 0.2770861683071523, "mean_env_wait_ms": 0.2200556162241683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040978193283081055, "StateBufferConnector_ms": 0.0029022693634033203, "ViewRequirementAgentConnector_ms": 0.09130895137786865}, "num_episodes": 18, "episode_return_max": 702.7686792684216, "episode_return_min": -571.028128721616, "episode_return_mean": 27.62532629930023, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.97333111662914, "num_env_steps_trained_throughput_per_sec": 430.97333111662914, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 9309.836, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9309.8, "sample_time_ms": 1010.357, "learn_time_ms": 8286.832, "learn_throughput": 482.694, "synch_weights_time_ms": 11.706}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "1f15c_00000", "date": "2024-08-16_14-07-12", "timestamp": 1723797432, "time_this_iter_s": 9.2846839427948, "time_total_s": 238.18159580230713, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f866700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 238.18159580230713, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 25.769230769230766, "ram_util_percent": 71.28461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1899435971306744, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6931141126723515, "policy_loss": -0.009215465930620672, "vf_loss": 2.700697528369843, "vf_explained_var": 0.00010625026213428961, "kl": 0.00816025355266154, "entropy": 1.4042200716084274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4972474831594993, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9647726181322938, "policy_loss": -0.009261201932366011, "vf_loss": 2.973002615050664, "vf_explained_var": -0.004477824767430623, "kl": 0.010312074623364816, "entropy": 1.3774842699368794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 702.7686792684216, "episode_reward_min": -571.028128721616, "episode_reward_mean": 29.209291163007155, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1657.9922236078362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.23000000000047, "predator_policy": 1595.0568141756373}, "policy_reward_mean": {"prey_policy": -122.72591116267253, "predator_policy": 137.33055674417602}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.792989050381745, 6.9499999999999265, 20.600000000000296, 11.029704729867529, 11.656247010907206, 3.8399999999999626, 6.9103697513192825, 2.7699999999999823, 7.609999999999934, 42.685955416898324, 3.6799999999999637, 4.985380900141258, 3.919999999999959, 10.134091575275102, 8.040514598335182, 9.035311900357618, 9.671612368050456, 24.66000000000045, 2.618124194664569, 3.649999999999973, 20.824092288696995, 4.419999999999948, 3.549999999999965, 2.5099999999999856, -0.3195928135046715, 3.5599999999999645, 16.70000000000005, 3.479999999999964, 55.59921453023069, 27.600000000000524, 14.111314862121327, 32.16000000000042, 38.03999999999986, 6.4999999999999245, 3.6299999999999653, -22.608159956964318, 78.77293670497659, 38.515040775270165, 5.739999999999921, 2.8299999999999788, 8.875458861432897, 8.239999999999931, 103.98218572709557, 3.9099999999999593, -10.349368836398918, 69.27659153846272, 21.493465062677178, -4.666910349530454, 702.7686792684216, 7.207161241172857, -11.492595529228376, 87.99220351252474, 59.52438624847859, -106.94436700918747, 55.13004873325545, 27.510000000000314, -1.5111708420585312, -571.028128721616, 3.4899999999999674, 3.2999999999999723, 460.8574360659545, 30.571191260807204, 163.12386932724854, 38.12227863199371, 85.6998883704094, 1.719999999999966, 83.71238347228442, 28.159420692075162, 49.966065451708275, 4.899999999999939, 1.9399999999999675, -20.21825885761431, 3.6399999999999624, 113.58011161217414, 3.169999999999971, 26.949157631548545, 48.975076553082125, 21.944426156107294, -13.785592625134614, -2.697295951732066, 61.93258602921913, 19.740000000000574, 77.50483562346886, 69.85479921578236, 11.959900602678912, 3.6299999999999644, 43.81658045141845, 17.120680167159684, 52.78400251976969, 38.72749888043115, 8.74744086743977, 44.55999999999959, 10.026143313394265, -35.98205611875917, 47.47999999999941, 257.3467889043006, 15.07430216039317, 4.939999999999938, 4.539999999999943, 81.81864720134271], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-44.5744524605043, -169.6003822762756, 4.969999999999963, -1.9867733457318861, -63.49503185400018, -5.528468400900287, -13.892301714319714, 2.0000000000000013, -3.2852035354336646, -49.902049267062395, -23.052524711495078, -8.830784314440056, -67.3748093960106, -93.03691291706835, -23.67144028084954, -548.4782418257785, -16.371367186517116, -77.29630169550099, 2.0000000000000013, -221.9714222755896, -66.78659717606159, -64.36261998715261, -22.472186026308037, -4.251302630092811, 2.0000000000000013, -54.161075814109545, 2.0000000000000013, -39.55563006879966, 2.0000000000000013, -101.60634767536122, 2.0000000000000013, -23.118189198283257, 2.0000000000000013, -9.697581065921307, 12.279612141313894, -14.211477762730182, -84.15475390571441, -395.91845156637703, -94.87693040427564, -75.7851658811198, -58.309042978835734, -126.21284528374045, -33.06245899065564, -179.32701213624327, -23.87728646875378, -118.58739948109154, -9.57575502670992, -625.248985847588, -145.22431814601842, -21.640054597337233, -123.19610525567948, -64.41445908637765, -29.110473630059268, 2.8304078190632187, -70.7086548743477, -83.00663835420757, 2.0000000000000013, -152.20036407861167, -48.266816686579645, 21.71367141775717, -80.87439448186569, 2.0000000000000013, -111.60168053991664, -28.47392398122523, -20.71659694596905, -149.15349614065036, -150.71769261696966, -17.5002969241644, -44.376140992873076, -74.31552048091588, -29.295598432059563, -152.55880194941506, 34.55468448323855, -223.4020626925456, -46.62508286526746, 2.0000000000000013, -52.61589798612227, -8.078980187472226, -75.3006475518419, -468.81828383918435, -77.86592392923906, -90.56012778136075, -23.069820456074403, -393.62971761175345, -199.66360223838922, 13.87999999999996, 2.0000000000000013, -21.329911041759395, -93.85895081857541, -88.21282260513674, -302.5372207204874, -35.04804863521169, -18.075323788742658, -48.28078916546442, -26.063678630206137, -145.788277066407, 2.0000000000000013, -1657.9922236078362, -245.80721457290412, -5.956662921076975, -60.0915569833817, -31.32050885405158, -61.6570320728781, 78.23000000000047, 2.98999999999998, -134.83781956934283, -1088.6057749232943, -927.0385982559808, -157.80676203723272, -110.82891690116122, -446.3968147048462, -107.5161609228864, -125.05728158481071, -52.627246316541125, -1107.694094402264, -1151.530753130176, -108.39179965523928, -232.74020579906212, -39.79009994878883, -182.45086651657735, -1245.485931003045, 36.902148326630865, 16.85000000000011, -34.034242486313026, 7.9399999999999595, -239.60241399598485, -254.67881848293518, -73.17561195338939, -71.14497173168226, -282.0719144730025, -129.4695885481589, -1302.5921821250136, -205.74043709127056, -38.863564124629995, -54.172965852467314, -75.61772994088675, 28.73000000000026, -246.207640626645, 2.98999999999998, -23.05694736190947, -1300.3531745508478, -171.0690142836274, -119.05353362631041, -140.82436454219973, -6.771628409939613, -123.2710137830425, 22.79000000000028, -112.32205515402626, -142.53765806460603, -165.71898453504767, -142.92136519898705, 12.88999999999996, -102.61454223712221, 2.0000000000000013, 11.89999999999996, -57.827445241086224, -137.30118430681546, -101.3045171367763, -35.40291301327857, -27.463277749994614, 36.65, -255.3164796050001, -22.331123190118614, 17.840000000000288, 2.0000000000000013, -137.17056938240736, -6.889101272715699, -22.51853913045329, -45.954071429281186, -21.890012050839353, -53.893590737215675, -51.79188877621196, -101.62019837737476, -91.52382400608414, -23.91238176555318, -187.14614512660376, 25.760000000000275, 4.146872974033362, -62.855714771805204, 27.740000000000226, 2.0000000000000013, -34.21955023125705, 2.0000000000000013, 36.469655920104174, -11.503872692047075, 5.959999999999958, -138.2583616997932, -113.16406982744088, 0.4388866909886046, 27.91277541233376, 2.0000000000000013, -285.50215119705206, -78.15230573083677, -53.84663616246514, 1.2122330470336298, -10.449100939490204, -89.35504996170258, -99.51083383658977, -165.60162347427112, -18.88119944113267], "policy_predator_policy_reward": [62.42821012316796, 119.95363556322894, 3.9667733457318444, 0.0, 63.60306917223008, 26.02043108267094, 12.064495501105608, 10.857510943081678, 32.84942934356483, 31.99407046983812, 10.770784314440014, 24.952524711495375, 69.1048093960114, 98.2172826683879, 549.3282418257778, 25.591440280849834, 82.9763016955018, 18.301367186517407, 241.45435390881437, 21.20302378367285, 68.57659717606248, 66.25261998715358, 7.316683530234089, 24.392186026308337, 0.0, 56.08107581410916, 6.304091575275184, 41.385630068799294, 4.3205145983352615, 103.3263476753621, 5.095311900357702, 25.05818919828356, 11.647581065921266, 5.721612368050539, 10.460387858686069, 16.13147776273015, 247.9355213774338, 234.75580828932257, 96.72693040427659, 77.58516588112072, 100.83620115081762, 104.50977940045553, 101.76552627632766, 115.04394485056982, 25.757286468754074, 120.25739948109239, 625.7989858475877, 11.535755026709879, 19.809454454511766, 146.73532547533782, 139.31095500295933, 51.859609339099336, 30.99047363005956, 11.989592180936764, 84.69663835420842, 72.4986548743486, 17.675230088797786, 188.12434852004435, 50.126816686579275, 4.026328582243088, 10.30131486212141, 82.68439448186662, 56.043923981225475, 116.19168053991746, 57.11659694596888, 150.79349614064887, 28.1765555242874, 146.5414340168455, 30.085905271693058, 92.23575620209618, 4.993748931324219, 154.25249149318455, 195.7628842844963, 71.85743062978524, 43.14007232871445, 40.00005131182354, 12.018980187472184, 54.41589798612191, 77.11064755184283, 469.8382838391834, 88.14292474023851, 89.15858583179572, 29.919820456074692, 395.0197176117522, 138.7294908373938, 151.03629712808785, 23.239911041759694, 0.0, 68.04971593030632, 103.67268865700805, 273.6345620850361, 133.22729880912317, 40.281854877838384, 47.56772313904547, 88.54873337461801, 78.63631197246372, 763.7040887006212, 1595.0568141756373, 157.13864525566797, 101.83239347948538, 27.668128219932594, 52.251342088272025, 7.982203512523767, 63.43703207287775, 64.60623591240739, 126.76596990541333, 1491.5971729231242, 417.10283324696155, 161.73143638372, 162.03429128792936, 472.24681470484575, 109.17616092288725, 136.47111651527757, 39.70224054401613, 1042.6191395141338, 645.5775792966906, 231.99484954869726, 112.62715590560354, 183.90086651657603, 41.640099948788475, 1110.9044809034922, 558.5367378388752, 11.831191260806623, 35.92424248631265, 189.37983558262638, 205.4064477406084, 89.98458355275862, 275.99212551555956, 278.76638118866697, 160.1503933864253, 131.18958854815733, 1302.5921821250136, 181.68602431028364, 146.63036037789834, 157.95011648542933, 0.0, 39.167940526363964, 228.27576555198905, 24.966947361909767, 0.0, 1300.533174550848, 172.8290142836258, 143.2856168299014, 96.37402248099427, 8.721628409939575, 124.96101378304337, 109.4073539494768, 93.70481281672402, 232.84314342126197, 78.58349917838973, 12.95181022158507, 144.02871260894838, 99.56254649614802, 50.02707229405798, 63.527666473425924, 4.344204923766674, 89.799189992979, 135.02091882547845, 40.77758505311655, 19.39130975842461, 197.77944474489732, 82.81962088932102, 0.0, 24.23112319011891, 124.87866672144527, 87.79673828442766, 65.00853913045367, 34.25390048849758, 28.521103470798774, 51.28288061200068, 104.68426487142528, 4.631214642001694, 152.70495646961615, 84.25564636526333, 32.4375706020074, 195.74163645730815, 18.5631270259666, 4.314002519770388, 52.32301650147063, 21.520197150766172, 25.704794794662757, 15.262196304033846, 0.0, 6.090344079895617, 2.116143313394348, 13.453872692047034, 162.5412213621008, 52.89915404637406, 17.57722458766647, 1.5511133090113969, 268.2827273201477, 272.5662127812059, 33.442938002285054, 113.6303060514106, 12.409100939490163, 1.7677669529663687, 102.26083383659066, 91.14504996170348, 147.73581838175411, 118.56565173499321]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6633961512473345, "mean_inference_ms": 1.647727999511376, "mean_action_processing_ms": 0.2776748649025901, "mean_env_wait_ms": 0.2178718722138119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004696249961853027, "StateBufferConnector_ms": 0.0029832124710083008, "ViewRequirementAgentConnector_ms": 0.09488999843597412}, "num_episodes": 18, "episode_return_max": 702.7686792684216, "episode_return_min": -571.028128721616, "episode_return_mean": 29.209291163007155, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.45198994092294, "num_env_steps_trained_throughput_per_sec": 431.45198994092294, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 9292.057, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9292.022, "sample_time_ms": 1033.521, "learn_time_ms": 8245.795, "learn_throughput": 485.096, "synch_weights_time_ms": 11.822}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "1f15c_00000", "date": "2024-08-16_14-07-22", "timestamp": 1723797442, "time_this_iter_s": 9.274507761001587, "time_total_s": 247.45610356330872, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8ad3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 247.45610356330872, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 26.984615384615385, "ram_util_percent": 70.42307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.028803961759522, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.110953564492483, "policy_loss": -0.011816527351746878, "vf_loss": 2.1207410211285587, "vf_explained_var": 0.0067449377327369, "kl": 0.010145368808422525, "entropy": 1.37340028708574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.961223670635274, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.325586007007215, "policy_loss": -0.010049947506930463, "vf_loss": 3.3347867892532754, "vf_explained_var": 0.001347671835510819, "kl": 0.00849166751440298, "entropy": 1.3588150452684473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 702.7686792684216, "episode_reward_min": -571.028128721616, "episode_reward_mean": 37.34916848278604, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1657.9922236078362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.23000000000047, "predator_policy": 1595.0568141756373}, "policy_reward_mean": {"prey_policy": -133.75380756153527, "predator_policy": 152.4283918029282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.618124194664569, 3.649999999999973, 20.824092288696995, 4.419999999999948, 3.549999999999965, 2.5099999999999856, -0.3195928135046715, 3.5599999999999645, 16.70000000000005, 3.479999999999964, 55.59921453023069, 27.600000000000524, 14.111314862121327, 32.16000000000042, 38.03999999999986, 6.4999999999999245, 3.6299999999999653, -22.608159956964318, 78.77293670497659, 38.515040775270165, 5.739999999999921, 2.8299999999999788, 8.875458861432897, 8.239999999999931, 103.98218572709557, 3.9099999999999593, -10.349368836398918, 69.27659153846272, 21.493465062677178, -4.666910349530454, 702.7686792684216, 7.207161241172857, -11.492595529228376, 87.99220351252474, 59.52438624847859, -106.94436700918747, 55.13004873325545, 27.510000000000314, -1.5111708420585312, -571.028128721616, 3.4899999999999674, 3.2999999999999723, 460.8574360659545, 30.571191260807204, 163.12386932724854, 38.12227863199371, 85.6998883704094, 1.719999999999966, 83.71238347228442, 28.159420692075162, 49.966065451708275, 4.899999999999939, 1.9399999999999675, -20.21825885761431, 3.6399999999999624, 113.58011161217414, 3.169999999999971, 26.949157631548545, 48.975076553082125, 21.944426156107294, -13.785592625134614, -2.697295951732066, 61.93258602921913, 19.740000000000574, 77.50483562346886, 69.85479921578236, 11.959900602678912, 3.6299999999999644, 43.81658045141845, 17.120680167159684, 52.78400251976969, 38.72749888043115, 8.74744086743977, 44.55999999999959, 10.026143313394265, -35.98205611875917, 47.47999999999941, 257.3467889043006, 15.07430216039317, 4.939999999999938, 4.539999999999943, 81.81864720134271, 109.13022794336608, -32.50888348008282, -1.4533008588991294, 60.03825813414146, 315.3040174651216, -54.10406014727148, 11.818799872055706, 3.819999999999962, 19.19322819864563, 8.25910635608142, 17.109999999999943, -45.08860551278205, 34.540000000000035, 27.122569977094425, 423.2609594897837, 3.769999999999963, 46.86970863964897, 23.291905101756168], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-84.15475390571441, -395.91845156637703, -94.87693040427564, -75.7851658811198, -58.309042978835734, -126.21284528374045, -33.06245899065564, -179.32701213624327, -23.87728646875378, -118.58739948109154, -9.57575502670992, -625.248985847588, -145.22431814601842, -21.640054597337233, -123.19610525567948, -64.41445908637765, -29.110473630059268, 2.8304078190632187, -70.7086548743477, -83.00663835420757, 2.0000000000000013, -152.20036407861167, -48.266816686579645, 21.71367141775717, -80.87439448186569, 2.0000000000000013, -111.60168053991664, -28.47392398122523, -20.71659694596905, -149.15349614065036, -150.71769261696966, -17.5002969241644, -44.376140992873076, -74.31552048091588, -29.295598432059563, -152.55880194941506, 34.55468448323855, -223.4020626925456, -46.62508286526746, 2.0000000000000013, -52.61589798612227, -8.078980187472226, -75.3006475518419, -468.81828383918435, -77.86592392923906, -90.56012778136075, -23.069820456074403, -393.62971761175345, -199.66360223838922, 13.87999999999996, 2.0000000000000013, -21.329911041759395, -93.85895081857541, -88.21282260513674, -302.5372207204874, -35.04804863521169, -18.075323788742658, -48.28078916546442, -26.063678630206137, -145.788277066407, 2.0000000000000013, -1657.9922236078362, -245.80721457290412, -5.956662921076975, -60.0915569833817, -31.32050885405158, -61.6570320728781, 78.23000000000047, 2.98999999999998, -134.83781956934283, -1088.6057749232943, -927.0385982559808, -157.80676203723272, -110.82891690116122, -446.3968147048462, -107.5161609228864, -125.05728158481071, -52.627246316541125, -1107.694094402264, -1151.530753130176, -108.39179965523928, -232.74020579906212, -39.79009994878883, -182.45086651657735, -1245.485931003045, 36.902148326630865, 16.85000000000011, -34.034242486313026, 7.9399999999999595, -239.60241399598485, -254.67881848293518, -73.17561195338939, -71.14497173168226, -282.0719144730025, -129.4695885481589, -1302.5921821250136, -205.74043709127056, -38.863564124629995, -54.172965852467314, -75.61772994088675, 28.73000000000026, -246.207640626645, 2.98999999999998, -23.05694736190947, -1300.3531745508478, -171.0690142836274, -119.05353362631041, -140.82436454219973, -6.771628409939613, -123.2710137830425, 22.79000000000028, -112.32205515402626, -142.53765806460603, -165.71898453504767, -142.92136519898705, 12.88999999999996, -102.61454223712221, 2.0000000000000013, 11.89999999999996, -57.827445241086224, -137.30118430681546, -101.3045171367763, -35.40291301327857, -27.463277749994614, 36.65, -255.3164796050001, -22.331123190118614, 17.840000000000288, 2.0000000000000013, -137.17056938240736, -6.889101272715699, -22.51853913045329, -45.954071429281186, -21.890012050839353, -53.893590737215675, -51.79188877621196, -101.62019837737476, -91.52382400608414, -23.91238176555318, -187.14614512660376, 25.760000000000275, 4.146872974033362, -62.855714771805204, 27.740000000000226, 2.0000000000000013, -34.21955023125705, 2.0000000000000013, 36.469655920104174, -11.503872692047075, 5.959999999999958, -138.2583616997932, -113.16406982744088, 0.4388866909886046, 27.91277541233376, 2.0000000000000013, -285.50215119705206, -78.15230573083677, -53.84663616246514, 1.2122330470336298, -10.449100939490204, -89.35504996170258, -99.51083383658977, -165.60162347427112, -18.88119944113267, -45.1408098497942, -47.63607799587695, -92.06914559970166, -135.18419179568113, -24.009498106751327, -5.343300858899114, -67.21167563120399, 2.0000000000000013, -877.1837518289656, -552.5111048016158, -62.81184710470257, -99.98619251487936, -23.048682188282807, 2.0000000000000013, -11.314636002368328, -29.128773014970598, -62.355388859555184, -143.24687482938185, -46.995396067040076, 2.0000000000000013, -96.86650099534387, -252.43751307551202, -113.13907085189885, -308.4515633101993, -41.59723278689463, 10.44102736226742, 23.33672285279206, -115.37203228813829, -691.2775345977275, 2.0000000000000013, -46.234245582060105, -33.65290204141829, -13.362514219471521, 2.98999999999998, -0.19726870204999547, -13.903167208207625], "policy_predator_policy_reward": [247.9355213774338, 234.75580828932257, 96.72693040427659, 77.58516588112072, 100.83620115081762, 104.50977940045553, 101.76552627632766, 115.04394485056982, 25.757286468754074, 120.25739948109239, 625.7989858475877, 11.535755026709879, 19.809454454511766, 146.73532547533782, 139.31095500295933, 51.859609339099336, 30.99047363005956, 11.989592180936764, 84.69663835420842, 72.4986548743486, 17.675230088797786, 188.12434852004435, 50.126816686579275, 4.026328582243088, 10.30131486212141, 82.68439448186662, 56.043923981225475, 116.19168053991746, 57.11659694596888, 150.79349614064887, 28.1765555242874, 146.5414340168455, 30.085905271693058, 92.23575620209618, 4.993748931324219, 154.25249149318455, 195.7628842844963, 71.85743062978524, 43.14007232871445, 40.00005131182354, 12.018980187472184, 54.41589798612191, 77.11064755184283, 469.8382838391834, 88.14292474023851, 89.15858583179572, 29.919820456074692, 395.0197176117522, 138.7294908373938, 151.03629712808785, 23.239911041759694, 0.0, 68.04971593030632, 103.67268865700805, 273.6345620850361, 133.22729880912317, 40.281854877838384, 47.56772313904547, 88.54873337461801, 78.63631197246372, 763.7040887006212, 1595.0568141756373, 157.13864525566797, 101.83239347948538, 27.668128219932594, 52.251342088272025, 7.982203512523767, 63.43703207287775, 64.60623591240739, 126.76596990541333, 1491.5971729231242, 417.10283324696155, 161.73143638372, 162.03429128792936, 472.24681470484575, 109.17616092288725, 136.47111651527757, 39.70224054401613, 1042.6191395141338, 645.5775792966906, 231.99484954869726, 112.62715590560354, 183.90086651657603, 41.640099948788475, 1110.9044809034922, 558.5367378388752, 11.831191260806623, 35.92424248631265, 189.37983558262638, 205.4064477406084, 89.98458355275862, 275.99212551555956, 278.76638118866697, 160.1503933864253, 131.18958854815733, 1302.5921821250136, 181.68602431028364, 146.63036037789834, 157.95011648542933, 0.0, 39.167940526363964, 228.27576555198905, 24.966947361909767, 0.0, 1300.533174550848, 172.8290142836258, 143.2856168299014, 96.37402248099427, 8.721628409939575, 124.96101378304337, 109.4073539494768, 93.70481281672402, 232.84314342126197, 78.58349917838973, 12.95181022158507, 144.02871260894838, 99.56254649614802, 50.02707229405798, 63.527666473425924, 4.344204923766674, 89.799189992979, 135.02091882547845, 40.77758505311655, 19.39130975842461, 197.77944474489732, 82.81962088932102, 0.0, 24.23112319011891, 124.87866672144527, 87.79673828442766, 65.00853913045367, 34.25390048849758, 28.521103470798774, 51.28288061200068, 104.68426487142528, 4.631214642001694, 152.70495646961615, 84.25564636526333, 32.4375706020074, 195.74163645730815, 18.5631270259666, 4.314002519770388, 52.32301650147063, 21.520197150766172, 25.704794794662757, 15.262196304033846, 0.0, 6.090344079895617, 2.116143313394348, 13.453872692047034, 162.5412213621008, 52.89915404637406, 17.57722458766647, 1.5511133090113969, 268.2827273201477, 272.5662127812059, 33.442938002285054, 113.6303060514106, 12.409100939490163, 1.7677669529663687, 102.26083383659066, 91.14504996170348, 147.73581838175411, 118.56565173499321, 91.41747573222965, 110.48964005680655, 97.4466100131237, 97.29784390217628, 27.899498106751345, 0.0, 57.847228365758596, 67.40270539958856, 869.3002951361626, 875.6985789595399, 104.92621251934516, 3.767766952966369, 27.938682188283103, 4.928799872055789, 22.415629245877536, 21.847779771461642, 117.39688069864381, 107.39861118893654, 17.136364799526113, 36.11813762359508, 259.9875130755106, 106.42650099534464, 13.016724684162206, 363.4853039651541, 16.258972637732544, 49.43723278689426, 117.12203228813918, 2.0358471243020837, 462.27912795849215, 650.2593661290206, 35.51290204141793, 48.144245582059725, 29.69420097505723, 27.548021884062663, 20.88185562079866, 16.510485391214573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.657660298037134, "mean_inference_ms": 1.6335625356552839, "mean_action_processing_ms": 0.2783043611040796, "mean_env_wait_ms": 0.2158393061046356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005184531211853027, "StateBufferConnector_ms": 0.0030193328857421875, "ViewRequirementAgentConnector_ms": 0.09607064723968506}, "num_episodes": 18, "episode_return_max": 702.7686792684216, "episode_return_min": -571.028128721616, "episode_return_mean": 37.34916848278604, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.1342478405785, "num_env_steps_trained_throughput_per_sec": 433.1342478405785, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 9293.818, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9293.782, "sample_time_ms": 1034.646, "learn_time_ms": 8246.427, "learn_throughput": 485.059, "synch_weights_time_ms": 11.85}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "1f15c_00000", "date": "2024-08-16_14-07-31", "timestamp": 1723797451, "time_this_iter_s": 9.238420963287354, "time_total_s": 256.69452452659607, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fe97820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 256.69452452659607, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 24.94615384615384, "ram_util_percent": 70.3076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0111537152497225, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.212655567870569, "policy_loss": -0.012275603737573696, "vf_loss": 3.223253787888421, "vf_explained_var": 0.009987087949873909, "kl": 0.00838697885751018, "entropy": 1.3559051781735092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6965207125774766, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.480630363106097, "policy_loss": -0.0061696239456376705, "vf_loss": 5.485796085236564, "vf_explained_var": 0.041330993049359194, "kl": 0.010038977571439539, "entropy": 1.307524051363506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 702.7686792684216, "episode_reward_min": -571.028128721616, "episode_reward_mean": 40.776153888131105, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1657.9922236078362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 143.95717749016154, "predator_policy": 1595.0568141756373}, "policy_reward_mean": {"prey_policy": -127.45279312358213, "predator_policy": 147.84087006764756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.875458861432897, 8.239999999999931, 103.98218572709557, 3.9099999999999593, -10.349368836398918, 69.27659153846272, 21.493465062677178, -4.666910349530454, 702.7686792684216, 7.207161241172857, -11.492595529228376, 87.99220351252474, 59.52438624847859, -106.94436700918747, 55.13004873325545, 27.510000000000314, -1.5111708420585312, -571.028128721616, 3.4899999999999674, 3.2999999999999723, 460.8574360659545, 30.571191260807204, 163.12386932724854, 38.12227863199371, 85.6998883704094, 1.719999999999966, 83.71238347228442, 28.159420692075162, 49.966065451708275, 4.899999999999939, 1.9399999999999675, -20.21825885761431, 3.6399999999999624, 113.58011161217414, 3.169999999999971, 26.949157631548545, 48.975076553082125, 21.944426156107294, -13.785592625134614, -2.697295951732066, 61.93258602921913, 19.740000000000574, 77.50483562346886, 69.85479921578236, 11.959900602678912, 3.6299999999999644, 43.81658045141845, 17.120680167159684, 52.78400251976969, 38.72749888043115, 8.74744086743977, 44.55999999999959, 10.026143313394265, -35.98205611875917, 47.47999999999941, 257.3467889043006, 15.07430216039317, 4.939999999999938, 4.539999999999943, 81.81864720134271, 109.13022794336608, -32.50888348008282, -1.4533008588991294, 60.03825813414146, 315.3040174651216, -54.10406014727148, 11.818799872055706, 3.819999999999962, 19.19322819864563, 8.25910635608142, 17.109999999999943, -45.08860551278205, 34.540000000000035, 27.122569977094425, 423.2609594897837, 3.769999999999963, 46.86970863964897, 23.291905101756168, 28.063346691437303, 198.20434718472916, 31.590000000000543, 91.43332627673365, 24.110000000000227, 71.23000000000071, 141.52957288041745, -0.9521359549995934, 25.330000000000034, 92.28178874460176, -36.400353372445096, -39.48411933262835, 57.54521615557947, -24.30045967128364, 33.71818843763366, -38.44960980811229, 20.66999999999996, 3.769999999999963, 33.14465646475232, 1.1799999999999922, 24.00177588883928, -53.63402946525873], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-77.86592392923906, -90.56012778136075, -23.069820456074403, -393.62971761175345, -199.66360223838922, 13.87999999999996, 2.0000000000000013, -21.329911041759395, -93.85895081857541, -88.21282260513674, -302.5372207204874, -35.04804863521169, -18.075323788742658, -48.28078916546442, -26.063678630206137, -145.788277066407, 2.0000000000000013, -1657.9922236078362, -245.80721457290412, -5.956662921076975, -60.0915569833817, -31.32050885405158, -61.6570320728781, 78.23000000000047, 2.98999999999998, -134.83781956934283, -1088.6057749232943, -927.0385982559808, -157.80676203723272, -110.82891690116122, -446.3968147048462, -107.5161609228864, -125.05728158481071, -52.627246316541125, -1107.694094402264, -1151.530753130176, -108.39179965523928, -232.74020579906212, -39.79009994878883, -182.45086651657735, -1245.485931003045, 36.902148326630865, 16.85000000000011, -34.034242486313026, 7.9399999999999595, -239.60241399598485, -254.67881848293518, -73.17561195338939, -71.14497173168226, -282.0719144730025, -129.4695885481589, -1302.5921821250136, -205.74043709127056, -38.863564124629995, -54.172965852467314, -75.61772994088675, 28.73000000000026, -246.207640626645, 2.98999999999998, -23.05694736190947, -1300.3531745508478, -171.0690142836274, -119.05353362631041, -140.82436454219973, -6.771628409939613, -123.2710137830425, 22.79000000000028, -112.32205515402626, -142.53765806460603, -165.71898453504767, -142.92136519898705, 12.88999999999996, -102.61454223712221, 2.0000000000000013, 11.89999999999996, -57.827445241086224, -137.30118430681546, -101.3045171367763, -35.40291301327857, -27.463277749994614, 36.65, -255.3164796050001, -22.331123190118614, 17.840000000000288, 2.0000000000000013, -137.17056938240736, -6.889101272715699, -22.51853913045329, -45.954071429281186, -21.890012050839353, -53.893590737215675, -51.79188877621196, -101.62019837737476, -91.52382400608414, -23.91238176555318, -187.14614512660376, 25.760000000000275, 4.146872974033362, -62.855714771805204, 27.740000000000226, 2.0000000000000013, -34.21955023125705, 2.0000000000000013, 36.469655920104174, -11.503872692047075, 5.959999999999958, -138.2583616997932, -113.16406982744088, 0.4388866909886046, 27.91277541233376, 2.0000000000000013, -285.50215119705206, -78.15230573083677, -53.84663616246514, 1.2122330470336298, -10.449100939490204, -89.35504996170258, -99.51083383658977, -165.60162347427112, -18.88119944113267, -45.1408098497942, -47.63607799587695, -92.06914559970166, -135.18419179568113, -24.009498106751327, -5.343300858899114, -67.21167563120399, 2.0000000000000013, -877.1837518289656, -552.5111048016158, -62.81184710470257, -99.98619251487936, -23.048682188282807, 2.0000000000000013, -11.314636002368328, -29.128773014970598, -62.355388859555184, -143.24687482938185, -46.995396067040076, 2.0000000000000013, -96.86650099534387, -252.43751307551202, -113.13907085189885, -308.4515633101993, -41.59723278689463, 10.44102736226742, 23.33672285279206, -115.37203228813829, -691.2775345977275, 2.0000000000000013, -46.234245582060105, -33.65290204141829, -13.362514219471521, 2.98999999999998, -0.19726870204999547, -13.903167208207625, -5.579368836398901, -118.004510173931, 143.95717749016154, 14.625664048962799, 22.55915466761607, -20.087818114483923, -218.0317271503492, -157.51695688988318, -34.33548024291631, -134.5289872098702, -1.233286595475265, 43.00759704200044, 90.1099999999999, -155.10491860883963, -15.544444863229305, -135.12801642745004, -93.40596311803121, -25.59861787562447, 32.913867711539666, 44.15126685840488, -91.08527559137609, -54.39347543913112, -346.4974029831223, -111.6183891518371, -74.20747294868575, 2.0000000000000013, -67.75882536818801, -93.47810823566593, -6.228468126233135, -260.04009851123084, -125.84408270583468, -141.32237851350158, -10.253302800041974, -7.997864995447358, 2.0000000000000013, -53.389227942914104, -14.843815073441593, -106.78984745589469, -224.63610451960253, -20.619354852432075, 2.0000000000000013, -52.58741668646393, -212.3412985084132, -179.11984128084163], "policy_predator_policy_reward": [88.14292474023851, 89.15858583179572, 29.919820456074692, 395.0197176117522, 138.7294908373938, 151.03629712808785, 23.239911041759694, 0.0, 68.04971593030632, 103.67268865700805, 273.6345620850361, 133.22729880912317, 40.281854877838384, 47.56772313904547, 88.54873337461801, 78.63631197246372, 763.7040887006212, 1595.0568141756373, 157.13864525566797, 101.83239347948538, 27.668128219932594, 52.251342088272025, 7.982203512523767, 63.43703207287775, 64.60623591240739, 126.76596990541333, 1491.5971729231242, 417.10283324696155, 161.73143638372, 162.03429128792936, 472.24681470484575, 109.17616092288725, 136.47111651527757, 39.70224054401613, 1042.6191395141338, 645.5775792966906, 231.99484954869726, 112.62715590560354, 183.90086651657603, 41.640099948788475, 1110.9044809034922, 558.5367378388752, 11.831191260806623, 35.92424248631265, 189.37983558262638, 205.4064477406084, 89.98458355275862, 275.99212551555956, 278.76638118866697, 160.1503933864253, 131.18958854815733, 1302.5921821250136, 181.68602431028364, 146.63036037789834, 157.95011648542933, 0.0, 39.167940526363964, 228.27576555198905, 24.966947361909767, 0.0, 1300.533174550848, 172.8290142836258, 143.2856168299014, 96.37402248099427, 8.721628409939575, 124.96101378304337, 109.4073539494768, 93.70481281672402, 232.84314342126197, 78.58349917838973, 12.95181022158507, 144.02871260894838, 99.56254649614802, 50.02707229405798, 63.527666473425924, 4.344204923766674, 89.799189992979, 135.02091882547845, 40.77758505311655, 19.39130975842461, 197.77944474489732, 82.81962088932102, 0.0, 24.23112319011891, 124.87866672144527, 87.79673828442766, 65.00853913045367, 34.25390048849758, 28.521103470798774, 51.28288061200068, 104.68426487142528, 4.631214642001694, 152.70495646961615, 84.25564636526333, 32.4375706020074, 195.74163645730815, 18.5631270259666, 4.314002519770388, 52.32301650147063, 21.520197150766172, 25.704794794662757, 15.262196304033846, 0.0, 6.090344079895617, 2.116143313394348, 13.453872692047034, 162.5412213621008, 52.89915404637406, 17.57722458766647, 1.5511133090113969, 268.2827273201477, 272.5662127812059, 33.442938002285054, 113.6303060514106, 12.409100939490163, 1.7677669529663687, 102.26083383659066, 91.14504996170348, 147.73581838175411, 118.56565173499321, 91.41747573222965, 110.48964005680655, 97.4466100131237, 97.29784390217628, 27.899498106751345, 0.0, 57.847228365758596, 67.40270539958856, 869.3002951361626, 875.6985789595399, 104.92621251934516, 3.767766952966369, 27.938682188283103, 4.928799872055789, 22.415629245877536, 21.847779771461642, 117.39688069864381, 107.39861118893654, 17.136364799526113, 36.11813762359508, 259.9875130755106, 106.42650099534464, 13.016724684162206, 363.4853039651541, 16.258972637732544, 49.43723278689426, 117.12203228813918, 2.0358471243020837, 462.27912795849215, 650.2593661290206, 35.51290204141793, 48.144245582059725, 29.69420097505723, 27.548021884062663, 20.88185562079866, 16.510485391214573, 25.63842911886014, 126.00879658290732, 4.713467565088921, 34.90803808051651, 21.99781811448422, 7.120845332384187, 276.7425381228778, 190.23947219408495, 49.025480242915975, 143.94898720986927, 26.242402957999445, 3.2132865954752403, 108.63555792548618, 97.88893356376927, 3.6258567988462964, 146.0944685368323, 49.19861787562422, 95.1359631180321, 8.222891874089225, 6.9937623005660114, 94.88143952426621, 14.196958133795857, 33.23019448320967, 385.4014783191218, 50.735216155580204, 79.01747294868667, 3.562884613431182, 133.3735893191396, 217.18085537914484, 82.80589969595171, 73.12774358695592, 155.5891078242693, 12.203302800041932, 26.717864995447623, 55.15922794291375, 0.0, 28.983440828116287, 125.79487816597302, 2.4128603818851952, 244.02259899014842, 29.53280233985448, 45.05639023544778, 227.52382069194732, 110.30328963204818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6518882093370842, "mean_inference_ms": 1.61786710490506, "mean_action_processing_ms": 0.27857465431532197, "mean_env_wait_ms": 0.21355844203596866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005648493766784668, "StateBufferConnector_ms": 0.003028273582458496, "ViewRequirementAgentConnector_ms": 0.09647834300994873}, "num_episodes": 22, "episode_return_max": 702.7686792684216, "episode_return_min": -571.028128721616, "episode_return_mean": 40.776153888131105, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.3592717294718, "num_env_steps_trained_throughput_per_sec": 432.3592717294718, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 9304.118, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9304.084, "sample_time_ms": 1034.048, "learn_time_ms": 8257.272, "learn_throughput": 484.422, "synch_weights_time_ms": 11.887}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "1f15c_00000", "date": "2024-08-16_14-07-40", "timestamp": 1723797460, "time_this_iter_s": 9.255051851272583, "time_total_s": 265.94957637786865, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8adb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 265.94957637786865, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.92142857142857, "ram_util_percent": 70.37857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4177231731868924, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.355272389467431, "policy_loss": -0.01024377820643759, "vf_loss": 4.363749565901579, "vf_explained_var": 0.012974551178160168, "kl": 0.008833102198428021, "entropy": 1.3083479921023051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9012718202575805, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.291097335714512, "policy_loss": -0.005065094442082145, "vf_loss": 7.295485433951887, "vf_explained_var": 0.03829442499175904, "kl": 0.006769784895281619, "entropy": 1.2711534350006668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 423.2609594897837, "episode_reward_min": -59.458118826413305, "episode_reward_mean": 38.65109911634029, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1302.5921821250136, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 143.95717749016154, "predator_policy": 1302.5921821250136}, "policy_reward_mean": {"prey_policy": -93.50764389790871, "predator_policy": 112.83319345607877}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.12227863199371, 85.6998883704094, 1.719999999999966, 83.71238347228442, 28.159420692075162, 49.966065451708275, 4.899999999999939, 1.9399999999999675, -20.21825885761431, 3.6399999999999624, 113.58011161217414, 3.169999999999971, 26.949157631548545, 48.975076553082125, 21.944426156107294, -13.785592625134614, -2.697295951732066, 61.93258602921913, 19.740000000000574, 77.50483562346886, 69.85479921578236, 11.959900602678912, 3.6299999999999644, 43.81658045141845, 17.120680167159684, 52.78400251976969, 38.72749888043115, 8.74744086743977, 44.55999999999959, 10.026143313394265, -35.98205611875917, 47.47999999999941, 257.3467889043006, 15.07430216039317, 4.939999999999938, 4.539999999999943, 81.81864720134271, 109.13022794336608, -32.50888348008282, -1.4533008588991294, 60.03825813414146, 315.3040174651216, -54.10406014727148, 11.818799872055706, 3.819999999999962, 19.19322819864563, 8.25910635608142, 17.109999999999943, -45.08860551278205, 34.540000000000035, 27.122569977094425, 423.2609594897837, 3.769999999999963, 46.86970863964897, 23.291905101756168, 28.063346691437303, 198.20434718472916, 31.590000000000543, 91.43332627673365, 24.110000000000227, 71.23000000000071, 141.52957288041745, -0.9521359549995934, 25.330000000000034, 92.28178874460176, -36.400353372445096, -39.48411933262835, 57.54521615557947, -24.30045967128364, 33.71818843763366, -38.44960980811229, 20.66999999999996, 3.769999999999963, 33.14465646475232, 1.1799999999999922, 24.00177588883928, -53.63402946525873, 11.48931729180185, 238.93911851945774, 46.02725251413593, -31.073883314448054, -29.731052192399865, 153.23023739942437, -37.105449578749074, 12.25808509849181, 21.79000000000059, 66.95403943736862, -53.58636042730845, 47.24862199093189, 47.01449995276535, 87.9260303564471, -12.45981411258603, 87.27253025773823, 204.1679134163897, -12.349271744364874, -19.75819344601362, 176.69406292495108, -55.42906769996103, 8.694160562771126, -59.458118826413305], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-254.67881848293518, -73.17561195338939, -71.14497173168226, -282.0719144730025, -129.4695885481589, -1302.5921821250136, -205.74043709127056, -38.863564124629995, -54.172965852467314, -75.61772994088675, 28.73000000000026, -246.207640626645, 2.98999999999998, -23.05694736190947, -1300.3531745508478, -171.0690142836274, -119.05353362631041, -140.82436454219973, -6.771628409939613, -123.2710137830425, 22.79000000000028, -112.32205515402626, -142.53765806460603, -165.71898453504767, -142.92136519898705, 12.88999999999996, -102.61454223712221, 2.0000000000000013, 11.89999999999996, -57.827445241086224, -137.30118430681546, -101.3045171367763, -35.40291301327857, -27.463277749994614, 36.65, -255.3164796050001, -22.331123190118614, 17.840000000000288, 2.0000000000000013, -137.17056938240736, -6.889101272715699, -22.51853913045329, -45.954071429281186, -21.890012050839353, -53.893590737215675, -51.79188877621196, -101.62019837737476, -91.52382400608414, -23.91238176555318, -187.14614512660376, 25.760000000000275, 4.146872974033362, -62.855714771805204, 27.740000000000226, 2.0000000000000013, -34.21955023125705, 2.0000000000000013, 36.469655920104174, -11.503872692047075, 5.959999999999958, -138.2583616997932, -113.16406982744088, 0.4388866909886046, 27.91277541233376, 2.0000000000000013, -285.50215119705206, -78.15230573083677, -53.84663616246514, 1.2122330470336298, -10.449100939490204, -89.35504996170258, -99.51083383658977, -165.60162347427112, -18.88119944113267, -45.1408098497942, -47.63607799587695, -92.06914559970166, -135.18419179568113, -24.009498106751327, -5.343300858899114, -67.21167563120399, 2.0000000000000013, -877.1837518289656, -552.5111048016158, -62.81184710470257, -99.98619251487936, -23.048682188282807, 2.0000000000000013, -11.314636002368328, -29.128773014970598, -62.355388859555184, -143.24687482938185, -46.995396067040076, 2.0000000000000013, -96.86650099534387, -252.43751307551202, -113.13907085189885, -308.4515633101993, -41.59723278689463, 10.44102736226742, 23.33672285279206, -115.37203228813829, -691.2775345977275, 2.0000000000000013, -46.234245582060105, -33.65290204141829, -13.362514219471521, 2.98999999999998, -0.19726870204999547, -13.903167208207625, -5.579368836398901, -118.004510173931, 143.95717749016154, 14.625664048962799, 22.55915466761607, -20.087818114483923, -218.0317271503492, -157.51695688988318, -34.33548024291631, -134.5289872098702, -1.233286595475265, 43.00759704200044, 90.1099999999999, -155.10491860883963, -15.544444863229305, -135.12801642745004, -93.40596311803121, -25.59861787562447, 32.913867711539666, 44.15126685840488, -91.08527559137609, -54.39347543913112, -346.4974029831223, -111.6183891518371, -74.20747294868575, 2.0000000000000013, -67.75882536818801, -93.47810823566593, -6.228468126233135, -260.04009851123084, -125.84408270583468, -141.32237851350158, -10.253302800041974, -7.997864995447358, 2.0000000000000013, -53.389227942914104, -14.843815073441593, -106.78984745589469, -224.63610451960253, -20.619354852432075, 2.0000000000000013, -52.58741668646393, -212.3412985084132, -179.11984128084163, -25.652965806150245, 2.0000000000000013, 2.0000000000000013, -595.392056533155, -55.89803971869743, -100.6878872369902, -78.3741997862138, -58.98497760234261, -309.05562910944406, -93.86215795014661, -278.9777068874253, 70.76036914667894, -65.68384552110892, -131.702628870929, 2.0000000000000013, -31.64567631545139, 7.987947055227514, 8.685843383405143, -161.56990355237215, -26.28597055419712, -204.9227838654356, -151.18258396411133, -125.81693696908354, -108.94150779030805, -350.10544865393337, -264.0362842946672, 55.82250792559902, -33.24576288638598, -121.97274361673429, -103.32185828861674, -105.96996619839264, -3.333300858899122, 133.56947189918702, 10.807669619882413, -62.93524801304968, -64.88906935582575, -128.08719892088726, -42.41320622689656, 76.15886240139073, 70.44429915282267, -205.24286888360962, -149.6112989907675, -7.121067811865484, -188.28335089046024, -95.92653743365852, -78.52750341914354], "policy_predator_policy_reward": [89.98458355275862, 275.99212551555956, 278.76638118866697, 160.1503933864253, 131.18958854815733, 1302.5921821250136, 181.68602431028364, 146.63036037789834, 157.95011648542933, 0.0, 39.167940526363964, 228.27576555198905, 24.966947361909767, 0.0, 1300.533174550848, 172.8290142836258, 143.2856168299014, 96.37402248099427, 8.721628409939575, 124.96101378304337, 109.4073539494768, 93.70481281672402, 232.84314342126197, 78.58349917838973, 12.95181022158507, 144.02871260894838, 99.56254649614802, 50.02707229405798, 63.527666473425924, 4.344204923766674, 89.799189992979, 135.02091882547845, 40.77758505311655, 19.39130975842461, 197.77944474489732, 82.81962088932102, 0.0, 24.23112319011891, 124.87866672144527, 87.79673828442766, 65.00853913045367, 34.25390048849758, 28.521103470798774, 51.28288061200068, 104.68426487142528, 4.631214642001694, 152.70495646961615, 84.25564636526333, 32.4375706020074, 195.74163645730815, 18.5631270259666, 4.314002519770388, 52.32301650147063, 21.520197150766172, 25.704794794662757, 15.262196304033846, 0.0, 6.090344079895617, 2.116143313394348, 13.453872692047034, 162.5412213621008, 52.89915404637406, 17.57722458766647, 1.5511133090113969, 268.2827273201477, 272.5662127812059, 33.442938002285054, 113.6303060514106, 12.409100939490163, 1.7677669529663687, 102.26083383659066, 91.14504996170348, 147.73581838175411, 118.56565173499321, 91.41747573222965, 110.48964005680655, 97.4466100131237, 97.29784390217628, 27.899498106751345, 0.0, 57.847228365758596, 67.40270539958856, 869.3002951361626, 875.6985789595399, 104.92621251934516, 3.767766952966369, 27.938682188283103, 4.928799872055789, 22.415629245877536, 21.847779771461642, 117.39688069864381, 107.39861118893654, 17.136364799526113, 36.11813762359508, 259.9875130755106, 106.42650099534464, 13.016724684162206, 363.4853039651541, 16.258972637732544, 49.43723278689426, 117.12203228813918, 2.0358471243020837, 462.27912795849215, 650.2593661290206, 35.51290204141793, 48.144245582059725, 29.69420097505723, 27.548021884062663, 20.88185562079866, 16.510485391214573, 25.63842911886014, 126.00879658290732, 4.713467565088921, 34.90803808051651, 21.99781811448422, 7.120845332384187, 276.7425381228778, 190.23947219408495, 49.025480242915975, 143.94898720986927, 26.242402957999445, 3.2132865954752403, 108.63555792548618, 97.88893356376927, 3.6258567988462964, 146.0944685368323, 49.19861787562422, 95.1359631180321, 8.222891874089225, 6.9937623005660114, 94.88143952426621, 14.196958133795857, 33.23019448320967, 385.4014783191218, 50.735216155580204, 79.01747294868667, 3.562884613431182, 133.3735893191396, 217.18085537914484, 82.80589969595171, 73.12774358695592, 155.5891078242693, 12.203302800041932, 26.717864995447623, 55.15922794291375, 0.0, 28.983440828116287, 125.79487816597302, 2.4128603818851952, 244.02259899014842, 29.53280233985448, 45.05639023544778, 227.52382069194732, 110.30328963204818, 7.589317291801932, 27.552965806150542, 622.9971337908408, 209.33404126177334, 36.37505829960312, 166.2381211702214, 96.58893537175364, 9.696358702354829, 140.43807174591632, 232.74866312127398, 311.6832140236247, 49.76436111654567, 158.45917881883602, 1.8218459944535104, 33.52146791129179, 8.382293502651253, 1.9220529447724453, 3.1941566165948174, 145.78445941341235, 109.02545413052405, 302.5190074022381, 0.0, 207.48133588057848, 74.52573086974661, 356.5337495401259, 304.62248336123946, 39.08179324283314, 26.267492074401037, 90.51658983981234, 122.31819795295404, 188.819966198392, 7.7558311166372, 29.960752300498328, 29.830019596822495, 28.659018134889156, 86.81602748962136, 5.281920068504015, 145.46029163326685, 24.781137598609458, 5.309763772128047, 86.31999060872354, 213.1051095656916, 17.536672705553933, 186.56190655954163, 81.44629139157172, 33.549630634817404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6447331902368936, "mean_inference_ms": 1.601014403399256, "mean_action_processing_ms": 0.2800909269255613, "mean_env_wait_ms": 0.2112469848609551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005385637283325195, "StateBufferConnector_ms": 0.0028995275497436523, "ViewRequirementAgentConnector_ms": 0.08526289463043213}, "num_episodes": 23, "episode_return_max": 423.2609594897837, "episode_return_min": -59.458118826413305, "episode_return_mean": 38.65109911634029, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.497390315746, "num_env_steps_trained_throughput_per_sec": 433.497390315746, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 9318.793, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9318.758, "sample_time_ms": 1033.628, "learn_time_ms": 8272.474, "learn_throughput": 483.531, "synch_weights_time_ms": 11.841}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "1f15c_00000", "date": "2024-08-16_14-07-49", "timestamp": 1723797469, "time_this_iter_s": 9.230310916900635, "time_total_s": 275.1798872947693, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8ad820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 275.1798872947693, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 25.300000000000004, "ram_util_percent": 70.5923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0928704962686255, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.452427960072876, "policy_loss": -0.013620064778145029, "vf_loss": 4.4634842886495845, "vf_explained_var": 0.03211882079719866, "kl": 0.012818715377574121, "entropy": 1.282583986072944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.263229589834415, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.912178226753517, "policy_loss": -0.00858930829954309, "vf_loss": 6.919660244543086, "vf_explained_var": 0.061188458071814646, "kl": 0.011072885670444002, "entropy": 1.2446734786664366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 423.2609594897837, "episode_reward_min": -108.36053246863437, "episode_reward_mean": 42.596670354699484, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -877.1837518289656, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 143.95717749016154, "predator_policy": 875.6985789595399}, "policy_reward_mean": {"prey_policy": -80.38331844857032, "predator_policy": 101.68165362592}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.740000000000574, 77.50483562346886, 69.85479921578236, 11.959900602678912, 3.6299999999999644, 43.81658045141845, 17.120680167159684, 52.78400251976969, 38.72749888043115, 8.74744086743977, 44.55999999999959, 10.026143313394265, -35.98205611875917, 47.47999999999941, 257.3467889043006, 15.07430216039317, 4.939999999999938, 4.539999999999943, 81.81864720134271, 109.13022794336608, -32.50888348008282, -1.4533008588991294, 60.03825813414146, 315.3040174651216, -54.10406014727148, 11.818799872055706, 3.819999999999962, 19.19322819864563, 8.25910635608142, 17.109999999999943, -45.08860551278205, 34.540000000000035, 27.122569977094425, 423.2609594897837, 3.769999999999963, 46.86970863964897, 23.291905101756168, 28.063346691437303, 198.20434718472916, 31.590000000000543, 91.43332627673365, 24.110000000000227, 71.23000000000071, 141.52957288041745, -0.9521359549995934, 25.330000000000034, 92.28178874460176, -36.400353372445096, -39.48411933262835, 57.54521615557947, -24.30045967128364, 33.71818843763366, -38.44960980811229, 20.66999999999996, 3.769999999999963, 33.14465646475232, 1.1799999999999922, 24.00177588883928, -53.63402946525873, 11.48931729180185, 238.93911851945774, 46.02725251413593, -31.073883314448054, -29.731052192399865, 153.23023739942437, -37.105449578749074, 12.25808509849181, 21.79000000000059, 66.95403943736862, -53.58636042730845, 47.24862199093189, 47.01449995276535, 87.9260303564471, -12.45981411258603, 87.27253025773823, 204.1679134163897, -12.349271744364874, -19.75819344601362, 176.69406292495108, -55.42906769996103, 8.694160562771126, -59.458118826413305, 154.27453037106562, -96.96498046976716, 136.36690660171408, 66.41278944839917, 79.09000000000064, 16.819062569425444, -14.565740039065908, 73.46333091203951, 88.31238402119193, 48.07985896423812, 88.41000000000034, -34.03205240140619, 87.31000000000027, -108.36053246863437, 122.96893292342331, 69.72002601150437, 6.084905070178429, 148.87794948773262], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.331123190118614, 17.840000000000288, 2.0000000000000013, -137.17056938240736, -6.889101272715699, -22.51853913045329, -45.954071429281186, -21.890012050839353, -53.893590737215675, -51.79188877621196, -101.62019837737476, -91.52382400608414, -23.91238176555318, -187.14614512660376, 25.760000000000275, 4.146872974033362, -62.855714771805204, 27.740000000000226, 2.0000000000000013, -34.21955023125705, 2.0000000000000013, 36.469655920104174, -11.503872692047075, 5.959999999999958, -138.2583616997932, -113.16406982744088, 0.4388866909886046, 27.91277541233376, 2.0000000000000013, -285.50215119705206, -78.15230573083677, -53.84663616246514, 1.2122330470336298, -10.449100939490204, -89.35504996170258, -99.51083383658977, -165.60162347427112, -18.88119944113267, -45.1408098497942, -47.63607799587695, -92.06914559970166, -135.18419179568113, -24.009498106751327, -5.343300858899114, -67.21167563120399, 2.0000000000000013, -877.1837518289656, -552.5111048016158, -62.81184710470257, -99.98619251487936, -23.048682188282807, 2.0000000000000013, -11.314636002368328, -29.128773014970598, -62.355388859555184, -143.24687482938185, -46.995396067040076, 2.0000000000000013, -96.86650099534387, -252.43751307551202, -113.13907085189885, -308.4515633101993, -41.59723278689463, 10.44102736226742, 23.33672285279206, -115.37203228813829, -691.2775345977275, 2.0000000000000013, -46.234245582060105, -33.65290204141829, -13.362514219471521, 2.98999999999998, -0.19726870204999547, -13.903167208207625, -5.579368836398901, -118.004510173931, 143.95717749016154, 14.625664048962799, 22.55915466761607, -20.087818114483923, -218.0317271503492, -157.51695688988318, -34.33548024291631, -134.5289872098702, -1.233286595475265, 43.00759704200044, 90.1099999999999, -155.10491860883963, -15.544444863229305, -135.12801642745004, -93.40596311803121, -25.59861787562447, 32.913867711539666, 44.15126685840488, -91.08527559137609, -54.39347543913112, -346.4974029831223, -111.6183891518371, -74.20747294868575, 2.0000000000000013, -67.75882536818801, -93.47810823566593, -6.228468126233135, -260.04009851123084, -125.84408270583468, -141.32237851350158, -10.253302800041974, -7.997864995447358, 2.0000000000000013, -53.389227942914104, -14.843815073441593, -106.78984745589469, -224.63610451960253, -20.619354852432075, 2.0000000000000013, -52.58741668646393, -212.3412985084132, -179.11984128084163, -25.652965806150245, 2.0000000000000013, 2.0000000000000013, -595.392056533155, -55.89803971869743, -100.6878872369902, -78.3741997862138, -58.98497760234261, -309.05562910944406, -93.86215795014661, -278.9777068874253, 70.76036914667894, -65.68384552110892, -131.702628870929, 2.0000000000000013, -31.64567631545139, 7.987947055227514, 8.685843383405143, -161.56990355237215, -26.28597055419712, -204.9227838654356, -151.18258396411133, -125.81693696908354, -108.94150779030805, -350.10544865393337, -264.0362842946672, 55.82250792559902, -33.24576288638598, -121.97274361673429, -103.32185828861674, -105.96996619839264, -3.333300858899122, 133.56947189918702, 10.807669619882413, -62.93524801304968, -64.88906935582575, -128.08719892088726, -42.41320622689656, 76.15886240139073, 70.44429915282267, -205.24286888360962, -149.6112989907675, -7.121067811865484, -188.28335089046024, -95.92653743365852, -78.52750341914354, 2.0000000000000013, 107.39165774457274, -287.8267051534802, -239.83779629854303, 2.0000000000000013, 28.166252547605147, -104.78900652552198, -262.26439498121385, -8.111171539052613, 45.76300721505274, 2.0000000000000013, -79.56028812637061, -118.58493751701178, -33.40320343559645, -231.939688595171, 60.40999999999978, -215.56010988980384, -243.41506345820784, -335.2727872572823, -81.18770048604748, 39.069401029320844, -173.02114290513452, -90.24517901258747, -112.33952369968684, 37.05964311844199, -163.94433878422302, -215.42652546922338, -206.14861182474198, -263.0121020356999, 77.24000000000031, -1.8177669529664058, -83.42505641892099, -60.55546841701173, 2.0000000000000013, -41.87416993836951, 94.41234318385303], "policy_predator_policy_reward": [0.0, 24.23112319011891, 124.87866672144527, 87.79673828442766, 65.00853913045367, 34.25390048849758, 28.521103470798774, 51.28288061200068, 104.68426487142528, 4.631214642001694, 152.70495646961615, 84.25564636526333, 32.4375706020074, 195.74163645730815, 18.5631270259666, 4.314002519770388, 52.32301650147063, 21.520197150766172, 25.704794794662757, 15.262196304033846, 0.0, 6.090344079895617, 2.116143313394348, 13.453872692047034, 162.5412213621008, 52.89915404637406, 17.57722458766647, 1.5511133090113969, 268.2827273201477, 272.5662127812059, 33.442938002285054, 113.6303060514106, 12.409100939490163, 1.7677669529663687, 102.26083383659066, 91.14504996170348, 147.73581838175411, 118.56565173499321, 91.41747573222965, 110.48964005680655, 97.4466100131237, 97.29784390217628, 27.899498106751345, 0.0, 57.847228365758596, 67.40270539958856, 869.3002951361626, 875.6985789595399, 104.92621251934516, 3.767766952966369, 27.938682188283103, 4.928799872055789, 22.415629245877536, 21.847779771461642, 117.39688069864381, 107.39861118893654, 17.136364799526113, 36.11813762359508, 259.9875130755106, 106.42650099534464, 13.016724684162206, 363.4853039651541, 16.258972637732544, 49.43723278689426, 117.12203228813918, 2.0358471243020837, 462.27912795849215, 650.2593661290206, 35.51290204141793, 48.144245582059725, 29.69420097505723, 27.548021884062663, 20.88185562079866, 16.510485391214573, 25.63842911886014, 126.00879658290732, 4.713467565088921, 34.90803808051651, 21.99781811448422, 7.120845332384187, 276.7425381228778, 190.23947219408495, 49.025480242915975, 143.94898720986927, 26.242402957999445, 3.2132865954752403, 108.63555792548618, 97.88893356376927, 3.6258567988462964, 146.0944685368323, 49.19861787562422, 95.1359631180321, 8.222891874089225, 6.9937623005660114, 94.88143952426621, 14.196958133795857, 33.23019448320967, 385.4014783191218, 50.735216155580204, 79.01747294868667, 3.562884613431182, 133.3735893191396, 217.18085537914484, 82.80589969595171, 73.12774358695592, 155.5891078242693, 12.203302800041932, 26.717864995447623, 55.15922794291375, 0.0, 28.983440828116287, 125.79487816597302, 2.4128603818851952, 244.02259899014842, 29.53280233985448, 45.05639023544778, 227.52382069194732, 110.30328963204818, 7.589317291801932, 27.552965806150542, 622.9971337908408, 209.33404126177334, 36.37505829960312, 166.2381211702214, 96.58893537175364, 9.696358702354829, 140.43807174591632, 232.74866312127398, 311.6832140236247, 49.76436111654567, 158.45917881883602, 1.8218459944535104, 33.52146791129179, 8.382293502651253, 1.9220529447724453, 3.1941566165948174, 145.78445941341235, 109.02545413052405, 302.5190074022381, 0.0, 207.48133588057848, 74.52573086974661, 356.5337495401259, 304.62248336123946, 39.08179324283314, 26.267492074401037, 90.51658983981234, 122.31819795295404, 188.819966198392, 7.7558311166372, 29.960752300498328, 29.830019596822495, 28.659018134889156, 86.81602748962136, 5.281920068504015, 145.46029163326685, 24.781137598609458, 5.309763772128047, 86.31999060872354, 213.1051095656916, 17.536672705553933, 186.56190655954163, 81.44629139157172, 33.549630634817404, 11.774530371066236, 33.108342255427445, 236.6844246825426, 194.01509629971153, 50.37974865290835, 55.8209054012, 337.11865146034233, 96.34753949479092, 17.210284791798422, 24.227879532201325, 81.44028812637157, 12.939062569425383, 134.44173577460495, 2.9806651389381815, 1.7233309120393887, 243.26968859516978, 293.9353759434933, 253.35218142570798, 84.71755945028596, 379.8227872572819, 47.94059897067919, 174.421142905134, 72.41874557962664, 96.13390473124261, 167.1843387842231, 47.01035688155787, 227.7601235255959, 85.45448129973498, 125.11152595027609, 183.6295090088465, 112.88221448092747, 42.08063490246498, 2.204905070178512, 62.43546841701136, 40.31654468396057, 56.0232315582894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6396884478548638, "mean_inference_ms": 1.5887484114428088, "mean_action_processing_ms": 0.28075852136624657, "mean_env_wait_ms": 0.2095174980090345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004994750022888184, "StateBufferConnector_ms": 0.002926349639892578, "ViewRequirementAgentConnector_ms": 0.0860680341720581}, "num_episodes": 18, "episode_return_max": 423.2609594897837, "episode_return_min": -108.36053246863437, "episode_return_mean": 42.596670354699484, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.35296518989884, "num_env_steps_trained_throughput_per_sec": 426.35296518989884, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 9300.759, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9300.723, "sample_time_ms": 1043.734, "learn_time_ms": 8244.426, "learn_throughput": 485.176, "synch_weights_time_ms": 11.73}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "1f15c_00000", "date": "2024-08-16_14-07-59", "timestamp": 1723797479, "time_this_iter_s": 9.385542869567871, "time_total_s": 284.56543016433716, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8ba430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 284.56543016433716, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 39.723076923076924, "ram_util_percent": 71.08461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.975388407060709, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.215829741765583, "policy_loss": -0.016240910950693348, "vf_loss": 5.229906480022208, "vf_explained_var": 0.023234370839658867, "kl": 0.01082091460614975, "entropy": 1.2676242672577107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7497229158089904, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8938840020901315, "policy_loss": -0.005695910523670218, "vf_loss": 7.898819954433138, "vf_explained_var": 0.042252758350321856, "kl": 0.007599332204783552, "entropy": 1.2188443175699346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 423.2609594897837, "episode_reward_min": -146.9239032281288, "episode_reward_mean": 34.20879391504597, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -877.1837518289656, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 158.06228888189787, "predator_policy": 875.6985789595399}, "policy_reward_mean": {"prey_policy": -100.01704443651826, "predator_policy": 117.12144139404116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.81864720134271, 109.13022794336608, -32.50888348008282, -1.4533008588991294, 60.03825813414146, 315.3040174651216, -54.10406014727148, 11.818799872055706, 3.819999999999962, 19.19322819864563, 8.25910635608142, 17.109999999999943, -45.08860551278205, 34.540000000000035, 27.122569977094425, 423.2609594897837, 3.769999999999963, 46.86970863964897, 23.291905101756168, 28.063346691437303, 198.20434718472916, 31.590000000000543, 91.43332627673365, 24.110000000000227, 71.23000000000071, 141.52957288041745, -0.9521359549995934, 25.330000000000034, 92.28178874460176, -36.400353372445096, -39.48411933262835, 57.54521615557947, -24.30045967128364, 33.71818843763366, -38.44960980811229, 20.66999999999996, 3.769999999999963, 33.14465646475232, 1.1799999999999922, 24.00177588883928, -53.63402946525873, 11.48931729180185, 238.93911851945774, 46.02725251413593, -31.073883314448054, -29.731052192399865, 153.23023739942437, -37.105449578749074, 12.25808509849181, 21.79000000000059, 66.95403943736862, -53.58636042730845, 47.24862199093189, 47.01449995276535, 87.9260303564471, -12.45981411258603, 87.27253025773823, 204.1679134163897, -12.349271744364874, -19.75819344601362, 176.69406292495108, -55.42906769996103, 8.694160562771126, -59.458118826413305, 154.27453037106562, -96.96498046976716, 136.36690660171408, 66.41278944839917, 79.09000000000064, 16.819062569425444, -14.565740039065908, 73.46333091203951, 88.31238402119193, 48.07985896423812, 88.41000000000034, -34.03205240140619, 87.31000000000027, -108.36053246863437, 122.96893292342331, 69.72002601150437, 6.084905070178429, 148.87794948773262, -110.14780310279589, 168.55999999999983, 148.79658738334945, -78.08367393248149, -110.36413393058531, -65.23174179492925, 83.41000000000014, -48.92666530994192, -89.40646185707422, 131.56300234874325, 186.06836344000288, 48.13187025973235, 56.06894853900204, -47.317248007029946, -57.00461510715105, -71.45163919143333, -144.65761388715194, -146.9239032281288], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-165.60162347427112, -18.88119944113267, -45.1408098497942, -47.63607799587695, -92.06914559970166, -135.18419179568113, -24.009498106751327, -5.343300858899114, -67.21167563120399, 2.0000000000000013, -877.1837518289656, -552.5111048016158, -62.81184710470257, -99.98619251487936, -23.048682188282807, 2.0000000000000013, -11.314636002368328, -29.128773014970598, -62.355388859555184, -143.24687482938185, -46.995396067040076, 2.0000000000000013, -96.86650099534387, -252.43751307551202, -113.13907085189885, -308.4515633101993, -41.59723278689463, 10.44102736226742, 23.33672285279206, -115.37203228813829, -691.2775345977275, 2.0000000000000013, -46.234245582060105, -33.65290204141829, -13.362514219471521, 2.98999999999998, -0.19726870204999547, -13.903167208207625, -5.579368836398901, -118.004510173931, 143.95717749016154, 14.625664048962799, 22.55915466761607, -20.087818114483923, -218.0317271503492, -157.51695688988318, -34.33548024291631, -134.5289872098702, -1.233286595475265, 43.00759704200044, 90.1099999999999, -155.10491860883963, -15.544444863229305, -135.12801642745004, -93.40596311803121, -25.59861787562447, 32.913867711539666, 44.15126685840488, -91.08527559137609, -54.39347543913112, -346.4974029831223, -111.6183891518371, -74.20747294868575, 2.0000000000000013, -67.75882536818801, -93.47810823566593, -6.228468126233135, -260.04009851123084, -125.84408270583468, -141.32237851350158, -10.253302800041974, -7.997864995447358, 2.0000000000000013, -53.389227942914104, -14.843815073441593, -106.78984745589469, -224.63610451960253, -20.619354852432075, 2.0000000000000013, -52.58741668646393, -212.3412985084132, -179.11984128084163, -25.652965806150245, 2.0000000000000013, 2.0000000000000013, -595.392056533155, -55.89803971869743, -100.6878872369902, -78.3741997862138, -58.98497760234261, -309.05562910944406, -93.86215795014661, -278.9777068874253, 70.76036914667894, -65.68384552110892, -131.702628870929, 2.0000000000000013, -31.64567631545139, 7.987947055227514, 8.685843383405143, -161.56990355237215, -26.28597055419712, -204.9227838654356, -151.18258396411133, -125.81693696908354, -108.94150779030805, -350.10544865393337, -264.0362842946672, 55.82250792559902, -33.24576288638598, -121.97274361673429, -103.32185828861674, -105.96996619839264, -3.333300858899122, 133.56947189918702, 10.807669619882413, -62.93524801304968, -64.88906935582575, -128.08719892088726, -42.41320622689656, 76.15886240139073, 70.44429915282267, -205.24286888360962, -149.6112989907675, -7.121067811865484, -188.28335089046024, -95.92653743365852, -78.52750341914354, 2.0000000000000013, 107.39165774457274, -287.8267051534802, -239.83779629854303, 2.0000000000000013, 28.166252547605147, -104.78900652552198, -262.26439498121385, -8.111171539052613, 45.76300721505274, 2.0000000000000013, -79.56028812637061, -118.58493751701178, -33.40320343559645, -231.939688595171, 60.40999999999978, -215.56010988980384, -243.41506345820784, -335.2727872572823, -81.18770048604748, 39.069401029320844, -173.02114290513452, -90.24517901258747, -112.33952369968684, 37.05964311844199, -163.94433878422302, -215.42652546922338, -206.14861182474198, -263.0121020356999, 77.24000000000031, -1.8177669529664058, -83.42505641892099, -60.55546841701173, 2.0000000000000013, -41.87416993836951, 94.41234318385303, -131.70363033652328, -286.55755101043246, 158.06228888189787, -192.9678750299279, 89.12000000000008, -12.949176786888977, -514.1815482078251, -370.9903464324496, -155.26909913923294, -187.59315440194703, -104.20504793717566, -89.3226077068215, 59.45857222413411, -171.39076925372777, -260.7538083530628, -172.505150318486, -220.40169609122347, -132.03170608513608, -136.63553141449043, -691.8659445203883, 41.59999999999968, 59.868387853618316, 2.0000000000000013, -9.159849781622658, 40.563462450405204, 2.0000000000000013, -175.6476885409615, -310.33617406523933, -181.68619607213702, -151.7635596281282, -208.16475768247878, -274.8606833244614, -162.91023107147856, -230.0279404340446, -204.89598356968077, -226.61887005451607], "policy_predator_policy_reward": [147.73581838175411, 118.56565173499321, 91.41747573222965, 110.48964005680655, 97.4466100131237, 97.29784390217628, 27.899498106751345, 0.0, 57.847228365758596, 67.40270539958856, 869.3002951361626, 875.6985789595399, 104.92621251934516, 3.767766952966369, 27.938682188283103, 4.928799872055789, 22.415629245877536, 21.847779771461642, 117.39688069864381, 107.39861118893654, 17.136364799526113, 36.11813762359508, 259.9875130755106, 106.42650099534464, 13.016724684162206, 363.4853039651541, 16.258972637732544, 49.43723278689426, 117.12203228813918, 2.0358471243020837, 462.27912795849215, 650.2593661290206, 35.51290204141793, 48.144245582059725, 29.69420097505723, 27.548021884062663, 20.88185562079866, 16.510485391214573, 25.63842911886014, 126.00879658290732, 4.713467565088921, 34.90803808051651, 21.99781811448422, 7.120845332384187, 276.7425381228778, 190.23947219408495, 49.025480242915975, 143.94898720986927, 26.242402957999445, 3.2132865954752403, 108.63555792548618, 97.88893356376927, 3.6258567988462964, 146.0944685368323, 49.19861787562422, 95.1359631180321, 8.222891874089225, 6.9937623005660114, 94.88143952426621, 14.196958133795857, 33.23019448320967, 385.4014783191218, 50.735216155580204, 79.01747294868667, 3.562884613431182, 133.3735893191396, 217.18085537914484, 82.80589969595171, 73.12774358695592, 155.5891078242693, 12.203302800041932, 26.717864995447623, 55.15922794291375, 0.0, 28.983440828116287, 125.79487816597302, 2.4128603818851952, 244.02259899014842, 29.53280233985448, 45.05639023544778, 227.52382069194732, 110.30328963204818, 7.589317291801932, 27.552965806150542, 622.9971337908408, 209.33404126177334, 36.37505829960312, 166.2381211702214, 96.58893537175364, 9.696358702354829, 140.43807174591632, 232.74866312127398, 311.6832140236247, 49.76436111654567, 158.45917881883602, 1.8218459944535104, 33.52146791129179, 8.382293502651253, 1.9220529447724453, 3.1941566165948174, 145.78445941341235, 109.02545413052405, 302.5190074022381, 0.0, 207.48133588057848, 74.52573086974661, 356.5337495401259, 304.62248336123946, 39.08179324283314, 26.267492074401037, 90.51658983981234, 122.31819795295404, 188.819966198392, 7.7558311166372, 29.960752300498328, 29.830019596822495, 28.659018134889156, 86.81602748962136, 5.281920068504015, 145.46029163326685, 24.781137598609458, 5.309763772128047, 86.31999060872354, 213.1051095656916, 17.536672705553933, 186.56190655954163, 81.44629139157172, 33.549630634817404, 11.774530371066236, 33.108342255427445, 236.6844246825426, 194.01509629971153, 50.37974865290835, 55.8209054012, 337.11865146034233, 96.34753949479092, 17.210284791798422, 24.227879532201325, 81.44028812637157, 12.939062569425383, 134.44173577460495, 2.9806651389381815, 1.7233309120393887, 243.26968859516978, 293.9353759434933, 253.35218142570798, 84.71755945028596, 379.8227872572819, 47.94059897067919, 174.421142905134, 72.41874557962664, 96.13390473124261, 167.1843387842231, 47.01035688155787, 227.7601235255959, 85.45448129973498, 125.11152595027609, 183.6295090088465, 112.88221448092747, 42.08063490246498, 2.204905070178512, 62.43546841701136, 40.31654468396057, 56.0232315582894, 6.649503656640725, 301.46387458751815, 9.227711118102105, 194.23787502992718, 13.790907706241459, 58.83485646399655, 463.2045760479753, 343.8836446598174, 8.210700399422683, 224.2874192111716, 10.970322777837438, 117.32559107123008, 20.671427775865833, 174.67076925372805, 248.301457754178, 136.0308356074282, 26.950418708448368, 236.07652161083698, 737.9591924855769, 222.1052857980445, 57.38209844462352, 27.21787714176157, 16.491870259732952, 38.79984978162261, 4.578948539002363, 8.926537549594643, 143.7122945738664, 294.9543200253038, 126.58716068820928, 149.85797990490468, 260.2285663403292, 151.3452354751767, 6.398698042293537, 241.8818595760775, 4.296536373401679, 280.2944140226659]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6349087817751983, "mean_inference_ms": 1.5769589163032816, "mean_action_processing_ms": 0.27846157937891364, "mean_env_wait_ms": 0.2078856777033088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004380226135253906, "StateBufferConnector_ms": 0.0028454065322875977, "ViewRequirementAgentConnector_ms": 0.08294618129730225}, "num_episodes": 18, "episode_return_max": 423.2609594897837, "episode_return_min": -146.9239032281288, "episode_return_mean": 34.20879391504597, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.6717901134802, "num_env_steps_trained_throughput_per_sec": 432.6717901134802, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 9313.154, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9313.119, "sample_time_ms": 1033.876, "learn_time_ms": 8266.631, "learn_throughput": 483.873, "synch_weights_time_ms": 11.781}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "1f15c_00000", "date": "2024-08-16_14-08-08", "timestamp": 1723797488, "time_this_iter_s": 9.248058080673218, "time_total_s": 293.8134882450104, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f87d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 293.8134882450104, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 40.53846153846154, "ram_util_percent": 71.64615384615382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9626232774327041, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.53123255406738, "policy_loss": -0.014870888617003052, "vf_loss": 6.543472781509319, "vf_explained_var": 0.006585184291557029, "kl": 0.013153266410270835, "entropy": 1.2434656739234924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4634068465264385, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.972391844048071, "policy_loss": -0.0049298372242855965, "vf_loss": 7.976426411684228, "vf_explained_var": 0.02619460912608596, "kl": 0.008952758601855031, "entropy": 1.1704539389837356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 316.63684365173054, "episode_reward_min": -296.7563249594286, "episode_reward_mean": 21.06826758625829, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -887.0908165973467, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 158.06228888189787, "predator_policy": 896.1108165973466}, "policy_reward_mean": {"prey_policy": -120.5635439439816, "predator_policy": 131.09767773711064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.291905101756168, 28.063346691437303, 198.20434718472916, 31.590000000000543, 91.43332627673365, 24.110000000000227, 71.23000000000071, 141.52957288041745, -0.9521359549995934, 25.330000000000034, 92.28178874460176, -36.400353372445096, -39.48411933262835, 57.54521615557947, -24.30045967128364, 33.71818843763366, -38.44960980811229, 20.66999999999996, 3.769999999999963, 33.14465646475232, 1.1799999999999922, 24.00177588883928, -53.63402946525873, 11.48931729180185, 238.93911851945774, 46.02725251413593, -31.073883314448054, -29.731052192399865, 153.23023739942437, -37.105449578749074, 12.25808509849181, 21.79000000000059, 66.95403943736862, -53.58636042730845, 47.24862199093189, 47.01449995276535, 87.9260303564471, -12.45981411258603, 87.27253025773823, 204.1679134163897, -12.349271744364874, -19.75819344601362, 176.69406292495108, -55.42906769996103, 8.694160562771126, -59.458118826413305, 154.27453037106562, -96.96498046976716, 136.36690660171408, 66.41278944839917, 79.09000000000064, 16.819062569425444, -14.565740039065908, 73.46333091203951, 88.31238402119193, 48.07985896423812, 88.41000000000034, -34.03205240140619, 87.31000000000027, -108.36053246863437, 122.96893292342331, 69.72002601150437, 6.084905070178429, 148.87794948773262, -110.14780310279589, 168.55999999999983, 148.79658738334945, -78.08367393248149, -110.36413393058531, -65.23174179492925, 83.41000000000014, -48.92666530994192, -89.40646185707422, 131.56300234874325, 186.06836344000288, 48.13187025973235, 56.06894853900204, -47.317248007029946, -57.00461510715105, -71.45163919143333, -144.65761388715194, -146.9239032281288, 10.136873147044255, 316.63684365173054, -258.1446783379185, -296.7563249594286, 178.52863626548503, 35.5999999999994, 62.6127171155093, -110.81877369183876, -209.9747447498361, 10.099999999999975, -51.392272926303896, 161.5320659341358, 15.661879362821706, 127.3812948093727, -237.27824093112173, 18.590000000000384, 35.32178532948425, -92.88901961965861], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.19726870204999547, -13.903167208207625, -5.579368836398901, -118.004510173931, 143.95717749016154, 14.625664048962799, 22.55915466761607, -20.087818114483923, -218.0317271503492, -157.51695688988318, -34.33548024291631, -134.5289872098702, -1.233286595475265, 43.00759704200044, 90.1099999999999, -155.10491860883963, -15.544444863229305, -135.12801642745004, -93.40596311803121, -25.59861787562447, 32.913867711539666, 44.15126685840488, -91.08527559137609, -54.39347543913112, -346.4974029831223, -111.6183891518371, -74.20747294868575, 2.0000000000000013, -67.75882536818801, -93.47810823566593, -6.228468126233135, -260.04009851123084, -125.84408270583468, -141.32237851350158, -10.253302800041974, -7.997864995447358, 2.0000000000000013, -53.389227942914104, -14.843815073441593, -106.78984745589469, -224.63610451960253, -20.619354852432075, 2.0000000000000013, -52.58741668646393, -212.3412985084132, -179.11984128084163, -25.652965806150245, 2.0000000000000013, 2.0000000000000013, -595.392056533155, -55.89803971869743, -100.6878872369902, -78.3741997862138, -58.98497760234261, -309.05562910944406, -93.86215795014661, -278.9777068874253, 70.76036914667894, -65.68384552110892, -131.702628870929, 2.0000000000000013, -31.64567631545139, 7.987947055227514, 8.685843383405143, -161.56990355237215, -26.28597055419712, -204.9227838654356, -151.18258396411133, -125.81693696908354, -108.94150779030805, -350.10544865393337, -264.0362842946672, 55.82250792559902, -33.24576288638598, -121.97274361673429, -103.32185828861674, -105.96996619839264, -3.333300858899122, 133.56947189918702, 10.807669619882413, -62.93524801304968, -64.88906935582575, -128.08719892088726, -42.41320622689656, 76.15886240139073, 70.44429915282267, -205.24286888360962, -149.6112989907675, -7.121067811865484, -188.28335089046024, -95.92653743365852, -78.52750341914354, 2.0000000000000013, 107.39165774457274, -287.8267051534802, -239.83779629854303, 2.0000000000000013, 28.166252547605147, -104.78900652552198, -262.26439498121385, -8.111171539052613, 45.76300721505274, 2.0000000000000013, -79.56028812637061, -118.58493751701178, -33.40320343559645, -231.939688595171, 60.40999999999978, -215.56010988980384, -243.41506345820784, -335.2727872572823, -81.18770048604748, 39.069401029320844, -173.02114290513452, -90.24517901258747, -112.33952369968684, 37.05964311844199, -163.94433878422302, -215.42652546922338, -206.14861182474198, -263.0121020356999, 77.24000000000031, -1.8177669529664058, -83.42505641892099, -60.55546841701173, 2.0000000000000013, -41.87416993836951, 94.41234318385303, -131.70363033652328, -286.55755101043246, 158.06228888189787, -192.9678750299279, 89.12000000000008, -12.949176786888977, -514.1815482078251, -370.9903464324496, -155.26909913923294, -187.59315440194703, -104.20504793717566, -89.3226077068215, 59.45857222413411, -171.39076925372777, -260.7538083530628, -172.505150318486, -220.40169609122347, -132.03170608513608, -136.63553141449043, -691.8659445203883, 41.59999999999968, 59.868387853618316, 2.0000000000000013, -9.159849781622658, 40.563462450405204, 2.0000000000000013, -175.6476885409615, -310.33617406523933, -181.68619607213702, -151.7635596281282, -208.16475768247878, -274.8606833244614, -162.91023107147856, -230.0279404340446, -204.89598356968077, -226.61887005451607, -165.75200039326978, -94.77321670060623, 58.38106970824408, -588.1670497562286, -374.1346272165921, -463.2802322140022, -472.23466228977895, -527.9383516690641, -2.6941622258844955, 73.28000000000065, -37.422927743679715, 2.0000000000000013, -535.0073730064214, 24.155532564079902, -483.35198845029987, -400.97609282453215, -411.75631005737796, -422.5645767002724, -887.0908165973467, -235.02347575196436, -220.35566939726993, -253.54816045600478, 2.0000000000000013, 63.93531967822037, 4.969999999999958, -53.07063573963346, -384.78623526055344, 115.28477162075276, -528.4073202856697, -564.5656308974525, -21.70997762661314, -11.421551798312583, -28.201101334642015, 16.85000000000011, -286.36973683144805, -192.83624133772614], "policy_predator_policy_reward": [20.88185562079866, 16.510485391214573, 25.63842911886014, 126.00879658290732, 4.713467565088921, 34.90803808051651, 21.99781811448422, 7.120845332384187, 276.7425381228778, 190.23947219408495, 49.025480242915975, 143.94898720986927, 26.242402957999445, 3.2132865954752403, 108.63555792548618, 97.88893356376927, 3.6258567988462964, 146.0944685368323, 49.19861787562422, 95.1359631180321, 8.222891874089225, 6.9937623005660114, 94.88143952426621, 14.196958133795857, 33.23019448320967, 385.4014783191218, 50.735216155580204, 79.01747294868667, 3.562884613431182, 133.3735893191396, 217.18085537914484, 82.80589969595171, 73.12774358695592, 155.5891078242693, 12.203302800041932, 26.717864995447623, 55.15922794291375, 0.0, 28.983440828116287, 125.79487816597302, 2.4128603818851952, 244.02259899014842, 29.53280233985448, 45.05639023544778, 227.52382069194732, 110.30328963204818, 7.589317291801932, 27.552965806150542, 622.9971337908408, 209.33404126177334, 36.37505829960312, 166.2381211702214, 96.58893537175364, 9.696358702354829, 140.43807174591632, 232.74866312127398, 311.6832140236247, 49.76436111654567, 158.45917881883602, 1.8218459944535104, 33.52146791129179, 8.382293502651253, 1.9220529447724453, 3.1941566165948174, 145.78445941341235, 109.02545413052405, 302.5190074022381, 0.0, 207.48133588057848, 74.52573086974661, 356.5337495401259, 304.62248336123946, 39.08179324283314, 26.267492074401037, 90.51658983981234, 122.31819795295404, 188.819966198392, 7.7558311166372, 29.960752300498328, 29.830019596822495, 28.659018134889156, 86.81602748962136, 5.281920068504015, 145.46029163326685, 24.781137598609458, 5.309763772128047, 86.31999060872354, 213.1051095656916, 17.536672705553933, 186.56190655954163, 81.44629139157172, 33.549630634817404, 11.774530371066236, 33.108342255427445, 236.6844246825426, 194.01509629971153, 50.37974865290835, 55.8209054012, 337.11865146034233, 96.34753949479092, 17.210284791798422, 24.227879532201325, 81.44028812637157, 12.939062569425383, 134.44173577460495, 2.9806651389381815, 1.7233309120393887, 243.26968859516978, 293.9353759434933, 253.35218142570798, 84.71755945028596, 379.8227872572819, 47.94059897067919, 174.421142905134, 72.41874557962664, 96.13390473124261, 167.1843387842231, 47.01035688155787, 227.7601235255959, 85.45448129973498, 125.11152595027609, 183.6295090088465, 112.88221448092747, 42.08063490246498, 2.204905070178512, 62.43546841701136, 40.31654468396057, 56.0232315582894, 6.649503656640725, 301.46387458751815, 9.227711118102105, 194.23787502992718, 13.790907706241459, 58.83485646399655, 463.2045760479753, 343.8836446598174, 8.210700399422683, 224.2874192111716, 10.970322777837438, 117.32559107123008, 20.671427775865833, 174.67076925372805, 248.301457754178, 136.0308356074282, 26.950418708448368, 236.07652161083698, 737.9591924855769, 222.1052857980445, 57.38209844462352, 27.21787714176157, 16.491870259732952, 38.79984978162261, 4.578948539002363, 8.926537549594643, 143.7122945738664, 294.9543200253038, 126.58716068820928, 149.85797990490468, 260.2285663403292, 151.3452354751767, 6.398698042293537, 241.8818595760775, 4.296536373401679, 280.2944140226659, 192.996869446881, 77.6652207940393, 229.65009721014408, 616.7727264895711, 485.75946064789093, 93.51072044478393, 277.60976275431534, 425.8069262450992, 45.28233053324877, 62.66046795812271, 71.02292774367942, 0.0, 560.7977328580865, 12.666824699763549, 491.29639709872623, 282.2129104842673, 238.9420842243187, 385.4040577834968, 236.10347575196388, 896.1108165973466, 53.884708445964975, 368.6268484810045, 44.21482628463908, 51.38191997127637, 46.583069456594764, 17.179445645860113, 35.82100842136203, 361.0617500278112, 251.2792272039338, 604.4154830480662, 38.3599776266134, 13.361551798312542, 36.08110133464224, 10.591785329484845, 0.0, 386.31695854951454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6303803097843628, "mean_inference_ms": 1.5659055892073501, "mean_action_processing_ms": 0.27614444366998153, "mean_env_wait_ms": 0.2063802033571727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038652420043945312, "StateBufferConnector_ms": 0.002804994583129883, "ViewRequirementAgentConnector_ms": 0.08177149295806885}, "num_episodes": 18, "episode_return_max": 316.63684365173054, "episode_return_min": -296.7563249594286, "episode_return_mean": 21.06826758625829, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.0532549664643, "num_env_steps_trained_throughput_per_sec": 420.0532549664643, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 9328.344, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9328.307, "sample_time_ms": 1028.346, "learn_time_ms": 8287.477, "learn_throughput": 482.656, "synch_weights_time_ms": 11.663}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "1f15c_00000", "date": "2024-08-16_14-08-18", "timestamp": 1723797498, "time_this_iter_s": 9.526201725006104, "time_total_s": 303.3396899700165, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8cd1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 303.3396899700165, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 39.40000000000001, "ram_util_percent": 73.12857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.842488282508951, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8740643137977235, "policy_loss": -0.013950772709385665, "vf_loss": 6.885193877749973, "vf_explained_var": 0.007475956943300035, "kl": 0.014106023160862393, "entropy": 1.211841244924636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4840565000734631, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.242115811443833, "policy_loss": -0.005338468722427491, "vf_loss": 8.246511208317267, "vf_explained_var": 0.015130946781269456, "kl": 0.00943069528678513, "entropy": 1.1752658664234101, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 316.63684365173054, "episode_reward_min": -759.0463913501806, "episode_reward_mean": -61.59804633940576, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1568.879967266195, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 158.06228888189787, "predator_policy": 1233.6454553700496}, "policy_reward_mean": {"prey_policy": -273.2819430433417, "predator_policy": 242.48291987363874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.731052192399865, 153.23023739942437, -37.105449578749074, 12.25808509849181, 21.79000000000059, 66.95403943736862, -53.58636042730845, 47.24862199093189, 47.01449995276535, 87.9260303564471, -12.45981411258603, 87.27253025773823, 204.1679134163897, -12.349271744364874, -19.75819344601362, 176.69406292495108, -55.42906769996103, 8.694160562771126, -59.458118826413305, 154.27453037106562, -96.96498046976716, 136.36690660171408, 66.41278944839917, 79.09000000000064, 16.819062569425444, -14.565740039065908, 73.46333091203951, 88.31238402119193, 48.07985896423812, 88.41000000000034, -34.03205240140619, 87.31000000000027, -108.36053246863437, 122.96893292342331, 69.72002601150437, 6.084905070178429, 148.87794948773262, -110.14780310279589, 168.55999999999983, 148.79658738334945, -78.08367393248149, -110.36413393058531, -65.23174179492925, 83.41000000000014, -48.92666530994192, -89.40646185707422, 131.56300234874325, 186.06836344000288, 48.13187025973235, 56.06894853900204, -47.317248007029946, -57.00461510715105, -71.45163919143333, -144.65761388715194, -146.9239032281288, 10.136873147044255, 316.63684365173054, -258.1446783379185, -296.7563249594286, 178.52863626548503, 35.5999999999994, 62.6127171155093, -110.81877369183876, -209.9747447498361, 10.099999999999975, -51.392272926303896, 161.5320659341358, 15.661879362821706, 127.3812948093727, -237.27824093112173, 18.590000000000384, 35.32178532948425, -92.88901961965861, -121.5553704662804, 37.47138340595571, -552.2923759962564, -57.19963007526546, 15.102217742826682, 62.73666325122899, 114.67118099727568, -417.46248101493154, -580.9082606329872, -734.811245778864, -77.50385085084957, 64.72032215940514, -145.44118801976623, 7.739999999999987, -759.0463913501806, -234.67293026617307, -443.17278150030523, -275.57247113520805, 57.459999999999646, -494.06910003263346, -694.0317711008868, -336.6995164355025, -328.458603428847, 94.47999999999986, -438.58077512083236, -529.7317128458748, -526.5474828387516], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-309.05562910944406, -93.86215795014661, -278.9777068874253, 70.76036914667894, -65.68384552110892, -131.702628870929, 2.0000000000000013, -31.64567631545139, 7.987947055227514, 8.685843383405143, -161.56990355237215, -26.28597055419712, -204.9227838654356, -151.18258396411133, -125.81693696908354, -108.94150779030805, -350.10544865393337, -264.0362842946672, 55.82250792559902, -33.24576288638598, -121.97274361673429, -103.32185828861674, -105.96996619839264, -3.333300858899122, 133.56947189918702, 10.807669619882413, -62.93524801304968, -64.88906935582575, -128.08719892088726, -42.41320622689656, 76.15886240139073, 70.44429915282267, -205.24286888360962, -149.6112989907675, -7.121067811865484, -188.28335089046024, -95.92653743365852, -78.52750341914354, 2.0000000000000013, 107.39165774457274, -287.8267051534802, -239.83779629854303, 2.0000000000000013, 28.166252547605147, -104.78900652552198, -262.26439498121385, -8.111171539052613, 45.76300721505274, 2.0000000000000013, -79.56028812637061, -118.58493751701178, -33.40320343559645, -231.939688595171, 60.40999999999978, -215.56010988980384, -243.41506345820784, -335.2727872572823, -81.18770048604748, 39.069401029320844, -173.02114290513452, -90.24517901258747, -112.33952369968684, 37.05964311844199, -163.94433878422302, -215.42652546922338, -206.14861182474198, -263.0121020356999, 77.24000000000031, -1.8177669529664058, -83.42505641892099, -60.55546841701173, 2.0000000000000013, -41.87416993836951, 94.41234318385303, -131.70363033652328, -286.55755101043246, 158.06228888189787, -192.9678750299279, 89.12000000000008, -12.949176786888977, -514.1815482078251, -370.9903464324496, -155.26909913923294, -187.59315440194703, -104.20504793717566, -89.3226077068215, 59.45857222413411, -171.39076925372777, -260.7538083530628, -172.505150318486, -220.40169609122347, -132.03170608513608, -136.63553141449043, -691.8659445203883, 41.59999999999968, 59.868387853618316, 2.0000000000000013, -9.159849781622658, 40.563462450405204, 2.0000000000000013, -175.6476885409615, -310.33617406523933, -181.68619607213702, -151.7635596281282, -208.16475768247878, -274.8606833244614, -162.91023107147856, -230.0279404340446, -204.89598356968077, -226.61887005451607, -165.75200039326978, -94.77321670060623, 58.38106970824408, -588.1670497562286, -374.1346272165921, -463.2802322140022, -472.23466228977895, -527.9383516690641, -2.6941622258844955, 73.28000000000065, -37.422927743679715, 2.0000000000000013, -535.0073730064214, 24.155532564079902, -483.35198845029987, -400.97609282453215, -411.75631005737796, -422.5645767002724, -887.0908165973467, -235.02347575196436, -220.35566939726993, -253.54816045600478, 2.0000000000000013, 63.93531967822037, 4.969999999999958, -53.07063573963346, -384.78623526055344, 115.28477162075276, -528.4073202856697, -564.5656308974525, -21.70997762661314, -11.421551798312583, -28.201101334642015, 16.85000000000011, -286.36973683144805, -192.83624133772614, -697.8523086865412, -418.92245720567877, 33.67999999999968, -4.348958579984756, -1131.5644516906252, -918.9718390131953, -331.63056415602006, -442.653882884715, 2.0000000000000013, -16.52390528477357, -590.0671125926033, 51.03106782610381, -173.44846458709299, -118.92698620047332, -1128.5674837964705, -996.4890343236083, -643.163027202272, -635.8992430314903, -1059.8020776701592, -1059.9047268919917, -120.27069902373908, -794.7132580069122, 45.271579894683065, 2.0000000000000013, -610.5652661681407, -383.0924567233987, -188.61731584785704, -909.4599695792002, -896.9103543925776, -843.8547491136295, -706.6445077148496, -788.2423224991843, -855.0594542894387, -789.5326703527926, -946.3109304647285, -681.719548807092, 26.098550370830846, -240.9604151038842, -905.0768927319915, -1007.623769367368, -1331.8552552581214, -1568.879967266195, -429.36095630755057, -361.0266727579164, -1061.9241035967468, -1096.3266459041472, -986.8570209428611, 87.2504824921651, -600.7139306783201, -646.5852310745137, -1304.1062582560323, -1208.1005692945569, -1071.2932687545747, -983.5084989516846], "policy_predator_policy_reward": [140.43807174591632, 232.74866312127398, 311.6832140236247, 49.76436111654567, 158.45917881883602, 1.8218459944535104, 33.52146791129179, 8.382293502651253, 1.9220529447724453, 3.1941566165948174, 145.78445941341235, 109.02545413052405, 302.5190074022381, 0.0, 207.48133588057848, 74.52573086974661, 356.5337495401259, 304.62248336123946, 39.08179324283314, 26.267492074401037, 90.51658983981234, 122.31819795295404, 188.819966198392, 7.7558311166372, 29.960752300498328, 29.830019596822495, 28.659018134889156, 86.81602748962136, 5.281920068504015, 145.46029163326685, 24.781137598609458, 5.309763772128047, 86.31999060872354, 213.1051095656916, 17.536672705553933, 186.56190655954163, 81.44629139157172, 33.549630634817404, 11.774530371066236, 33.108342255427445, 236.6844246825426, 194.01509629971153, 50.37974865290835, 55.8209054012, 337.11865146034233, 96.34753949479092, 17.210284791798422, 24.227879532201325, 81.44028812637157, 12.939062569425383, 134.44173577460495, 2.9806651389381815, 1.7233309120393887, 243.26968859516978, 293.9353759434933, 253.35218142570798, 84.71755945028596, 379.8227872572819, 47.94059897067919, 174.421142905134, 72.41874557962664, 96.13390473124261, 167.1843387842231, 47.01035688155787, 227.7601235255959, 85.45448129973498, 125.11152595027609, 183.6295090088465, 112.88221448092747, 42.08063490246498, 2.204905070178512, 62.43546841701136, 40.31654468396057, 56.0232315582894, 6.649503656640725, 301.46387458751815, 9.227711118102105, 194.23787502992718, 13.790907706241459, 58.83485646399655, 463.2045760479753, 343.8836446598174, 8.210700399422683, 224.2874192111716, 10.970322777837438, 117.32559107123008, 20.671427775865833, 174.67076925372805, 248.301457754178, 136.0308356074282, 26.950418708448368, 236.07652161083698, 737.9591924855769, 222.1052857980445, 57.38209844462352, 27.21787714176157, 16.491870259732952, 38.79984978162261, 4.578948539002363, 8.926537549594643, 143.7122945738664, 294.9543200253038, 126.58716068820928, 149.85797990490468, 260.2285663403292, 151.3452354751767, 6.398698042293537, 241.8818595760775, 4.296536373401679, 280.2944140226659, 192.996869446881, 77.6652207940393, 229.65009721014408, 616.7727264895711, 485.75946064789093, 93.51072044478393, 277.60976275431534, 425.8069262450992, 45.28233053324877, 62.66046795812271, 71.02292774367942, 0.0, 560.7977328580865, 12.666824699763549, 491.29639709872623, 282.2129104842673, 238.9420842243187, 385.4040577834968, 236.10347575196388, 896.1108165973466, 53.884708445964975, 368.6268484810045, 44.21482628463908, 51.38191997127637, 46.583069456594764, 17.179445645860113, 35.82100842136203, 361.0617500278112, 251.2792272039338, 604.4154830480662, 38.3599776266134, 13.361551798312542, 36.08110133464224, 10.591785329484845, 0.0, 386.31695854951454, 715.3933053338005, 279.8260900921394, 6.318958579984714, 1.821383405956338, 678.0753994854089, 820.1685152221556, 391.4611680796519, 325.6236488858169, 21.413905284773865, 8.212217742826764, 55.54824430733648, 546.2244637103918, 58.153231112344116, 348.8934006724972, 1041.201756352926, 666.3922807522216, 667.1842740304287, 30.969735570346575, 1140.1984251692566, 244.69713361403112, 31.578980001067897, 805.901126178734, 8.193719709675404, 9.25502255504642, 415.8193941951048, 432.3971406766682, 190.2073158478572, 915.6099695792001, 30.275832401239906, 951.4428797547871, 534.7907405851868, 725.4231593626737, 874.4665367661999, 326.9528063757267, 624.4278550346743, 728.0301531019381, 242.0304151038835, 30.291449629169367, 875.5457416084345, 543.0858204582918, 1233.6454553700496, 973.0579960533794, 451.2991018335998, 2.3890107963645795, 1014.0429611759013, 815.7491848961466, 987.297020942861, 6.789517507834787, 273.2323164492418, 535.4860701827604, 1233.5525870950567, 748.9225276096579, 1023.3947731453555, 504.8595117221532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6247030445425126, "mean_inference_ms": 1.550356587433878, "mean_action_processing_ms": 0.2729163932080642, "mean_env_wait_ms": 0.2050288652032495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033200979232788086, "StateBufferConnector_ms": 0.002787947654724121, "ViewRequirementAgentConnector_ms": 0.08098149299621582}, "num_episodes": 27, "episode_return_max": 316.63684365173054, "episode_return_min": -759.0463913501806, "episode_return_mean": -61.59804633940576, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.02049809163424, "num_env_steps_trained_throughput_per_sec": 431.02049809163424, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 9315.193, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9315.157, "sample_time_ms": 1030.172, "learn_time_ms": 8272.534, "learn_throughput": 483.528, "synch_weights_time_ms": 11.63}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "1f15c_00000", "date": "2024-08-16_14-08-27", "timestamp": 1723797507, "time_this_iter_s": 9.284233093261719, "time_total_s": 312.6239230632782, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8b15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 312.6239230632782, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 37.7, "ram_util_percent": 74.17692307692306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8086237729068786, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.771629985678134, "policy_loss": -0.013942118142312639, "vf_loss": 8.782475544409778, "vf_explained_var": 0.007484530424945569, "kl": 0.015482789582394723, "entropy": 1.2089254881969835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0841957142586431, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.450944585648793, "policy_loss": -0.007610160352849456, "vf_loss": 9.457583191281273, "vf_explained_var": 0.024836343968356097, "kl": 0.00971575567614837, "entropy": 1.1619125347288828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 643.6287128149484, "episode_reward_min": -921.9495347747817, "episode_reward_mean": -100.513664958521, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1697.319732278328, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 158.06228888189787, "predator_policy": 1748.9724512436394}, "policy_reward_mean": {"prey_policy": -452.58334231274813, "predator_policy": 402.32650983348765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.458118826413305, 154.27453037106562, -96.96498046976716, 136.36690660171408, 66.41278944839917, 79.09000000000064, 16.819062569425444, -14.565740039065908, 73.46333091203951, 88.31238402119193, 48.07985896423812, 88.41000000000034, -34.03205240140619, 87.31000000000027, -108.36053246863437, 122.96893292342331, 69.72002601150437, 6.084905070178429, 148.87794948773262, -110.14780310279589, 168.55999999999983, 148.79658738334945, -78.08367393248149, -110.36413393058531, -65.23174179492925, 83.41000000000014, -48.92666530994192, -89.40646185707422, 131.56300234874325, 186.06836344000288, 48.13187025973235, 56.06894853900204, -47.317248007029946, -57.00461510715105, -71.45163919143333, -144.65761388715194, -146.9239032281288, 10.136873147044255, 316.63684365173054, -258.1446783379185, -296.7563249594286, 178.52863626548503, 35.5999999999994, 62.6127171155093, -110.81877369183876, -209.9747447498361, 10.099999999999975, -51.392272926303896, 161.5320659341358, 15.661879362821706, 127.3812948093727, -237.27824093112173, 18.590000000000384, 35.32178532948425, -92.88901961965861, -121.5553704662804, 37.47138340595571, -552.2923759962564, -57.19963007526546, 15.102217742826682, 62.73666325122899, 114.67118099727568, -417.46248101493154, -580.9082606329872, -734.811245778864, -77.50385085084957, 64.72032215940514, -145.44118801976623, 7.739999999999987, -759.0463913501806, -234.67293026617307, -443.17278150030523, -275.57247113520805, 57.459999999999646, -494.06910003263346, -694.0317711008868, -336.6995164355025, -328.458603428847, 94.47999999999986, -438.58077512083236, -529.7317128458748, -526.5474828387516, -921.9495347747817, 82.99000000000004, 41.61000000000007, 180.35953851691298, -344.6151923813993, 299.41864366311466, -297.1767722745556, -432.47954310881516, -99.36368495186073, -234.7098467710304, -554.8680244237208, -684.0055805644532, 22.539999999999978, 643.6287128149484, -409.3822767709541, -490.8660596448179, -18.46126904421469, 18.59999999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-95.92653743365852, -78.52750341914354, 2.0000000000000013, 107.39165774457274, -287.8267051534802, -239.83779629854303, 2.0000000000000013, 28.166252547605147, -104.78900652552198, -262.26439498121385, -8.111171539052613, 45.76300721505274, 2.0000000000000013, -79.56028812637061, -118.58493751701178, -33.40320343559645, -231.939688595171, 60.40999999999978, -215.56010988980384, -243.41506345820784, -335.2727872572823, -81.18770048604748, 39.069401029320844, -173.02114290513452, -90.24517901258747, -112.33952369968684, 37.05964311844199, -163.94433878422302, -215.42652546922338, -206.14861182474198, -263.0121020356999, 77.24000000000031, -1.8177669529664058, -83.42505641892099, -60.55546841701173, 2.0000000000000013, -41.87416993836951, 94.41234318385303, -131.70363033652328, -286.55755101043246, 158.06228888189787, -192.9678750299279, 89.12000000000008, -12.949176786888977, -514.1815482078251, -370.9903464324496, -155.26909913923294, -187.59315440194703, -104.20504793717566, -89.3226077068215, 59.45857222413411, -171.39076925372777, -260.7538083530628, -172.505150318486, -220.40169609122347, -132.03170608513608, -136.63553141449043, -691.8659445203883, 41.59999999999968, 59.868387853618316, 2.0000000000000013, -9.159849781622658, 40.563462450405204, 2.0000000000000013, -175.6476885409615, -310.33617406523933, -181.68619607213702, -151.7635596281282, -208.16475768247878, -274.8606833244614, -162.91023107147856, -230.0279404340446, -204.89598356968077, -226.61887005451607, -165.75200039326978, -94.77321670060623, 58.38106970824408, -588.1670497562286, -374.1346272165921, -463.2802322140022, -472.23466228977895, -527.9383516690641, -2.6941622258844955, 73.28000000000065, -37.422927743679715, 2.0000000000000013, -535.0073730064214, 24.155532564079902, -483.35198845029987, -400.97609282453215, -411.75631005737796, -422.5645767002724, -887.0908165973467, -235.02347575196436, -220.35566939726993, -253.54816045600478, 2.0000000000000013, 63.93531967822037, 4.969999999999958, -53.07063573963346, -384.78623526055344, 115.28477162075276, -528.4073202856697, -564.5656308974525, -21.70997762661314, -11.421551798312583, -28.201101334642015, 16.85000000000011, -286.36973683144805, -192.83624133772614, -697.8523086865412, -418.92245720567877, 33.67999999999968, -4.348958579984756, -1131.5644516906252, -918.9718390131953, -331.63056415602006, -442.653882884715, 2.0000000000000013, -16.52390528477357, -590.0671125926033, 51.03106782610381, -173.44846458709299, -118.92698620047332, -1128.5674837964705, -996.4890343236083, -643.163027202272, -635.8992430314903, -1059.8020776701592, -1059.9047268919917, -120.27069902373908, -794.7132580069122, 45.271579894683065, 2.0000000000000013, -610.5652661681407, -383.0924567233987, -188.61731584785704, -909.4599695792002, -896.9103543925776, -843.8547491136295, -706.6445077148496, -788.2423224991843, -855.0594542894387, -789.5326703527926, -946.3109304647285, -681.719548807092, 26.098550370830846, -240.9604151038842, -905.0768927319915, -1007.623769367368, -1331.8552552581214, -1568.879967266195, -429.36095630755057, -361.0266727579164, -1061.9241035967468, -1096.3266459041472, -986.8570209428611, 87.2504824921651, -600.7139306783201, -646.5852310745137, -1304.1062582560323, -1208.1005692945569, -1071.2932687545747, -983.5084989516846, -997.1848572450955, -1081.7317559713538, -238.1322031054213, -47.797516112224926, -1138.7277919355306, -569.8029568993659, -1204.4792134433812, -1306.9717978960157, -893.6308742002481, -824.1294146775833, -1481.784626952946, -1241.9286040365625, -770.1450707501314, -341.88453231857403, -1479.052155836201, -1357.6751465798777, -920.1630589985507, -1227.870220845731, -1440.2855909135524, -1409.0248548888603, -1450.4144764257246, -1358.146948619275, -1233.220661798754, -1388.0017066784246, -704.1579546691718, -892.3941362211661, -1126.5687498706739, 117.55651205058777, -1272.4095839041051, -1346.6773061095607, -1658.4441546894432, -1530.380944979409, -1460.5735663137425, -1697.319732278328, -1374.9882315940272, -595.7150028296791], "policy_predator_policy_reward": [81.44629139157172, 33.549630634817404, 11.774530371066236, 33.108342255427445, 236.6844246825426, 194.01509629971153, 50.37974865290835, 55.8209054012, 337.11865146034233, 96.34753949479092, 17.210284791798422, 24.227879532201325, 81.44028812637157, 12.939062569425383, 134.44173577460495, 2.9806651389381815, 1.7233309120393887, 243.26968859516978, 293.9353759434933, 253.35218142570798, 84.71755945028596, 379.8227872572819, 47.94059897067919, 174.421142905134, 72.41874557962664, 96.13390473124261, 167.1843387842231, 47.01035688155787, 227.7601235255959, 85.45448129973498, 125.11152595027609, 183.6295090088465, 112.88221448092747, 42.08063490246498, 2.204905070178512, 62.43546841701136, 40.31654468396057, 56.0232315582894, 6.649503656640725, 301.46387458751815, 9.227711118102105, 194.23787502992718, 13.790907706241459, 58.83485646399655, 463.2045760479753, 343.8836446598174, 8.210700399422683, 224.2874192111716, 10.970322777837438, 117.32559107123008, 20.671427775865833, 174.67076925372805, 248.301457754178, 136.0308356074282, 26.950418708448368, 236.07652161083698, 737.9591924855769, 222.1052857980445, 57.38209844462352, 27.21787714176157, 16.491870259732952, 38.79984978162261, 4.578948539002363, 8.926537549594643, 143.7122945738664, 294.9543200253038, 126.58716068820928, 149.85797990490468, 260.2285663403292, 151.3452354751767, 6.398698042293537, 241.8818595760775, 4.296536373401679, 280.2944140226659, 192.996869446881, 77.6652207940393, 229.65009721014408, 616.7727264895711, 485.75946064789093, 93.51072044478393, 277.60976275431534, 425.8069262450992, 45.28233053324877, 62.66046795812271, 71.02292774367942, 0.0, 560.7977328580865, 12.666824699763549, 491.29639709872623, 282.2129104842673, 238.9420842243187, 385.4040577834968, 236.10347575196388, 896.1108165973466, 53.884708445964975, 368.6268484810045, 44.21482628463908, 51.38191997127637, 46.583069456594764, 17.179445645860113, 35.82100842136203, 361.0617500278112, 251.2792272039338, 604.4154830480662, 38.3599776266134, 13.361551798312542, 36.08110133464224, 10.591785329484845, 0.0, 386.31695854951454, 715.3933053338005, 279.8260900921394, 6.318958579984714, 1.821383405956338, 678.0753994854089, 820.1685152221556, 391.4611680796519, 325.6236488858169, 21.413905284773865, 8.212217742826764, 55.54824430733648, 546.2244637103918, 58.153231112344116, 348.8934006724972, 1041.201756352926, 666.3922807522216, 667.1842740304287, 30.969735570346575, 1140.1984251692566, 244.69713361403112, 31.578980001067897, 805.901126178734, 8.193719709675404, 9.25502255504642, 415.8193941951048, 432.3971406766682, 190.2073158478572, 915.6099695792001, 30.275832401239906, 951.4428797547871, 534.7907405851868, 725.4231593626737, 874.4665367661999, 326.9528063757267, 624.4278550346743, 728.0301531019381, 242.0304151038835, 30.291449629169367, 875.5457416084345, 543.0858204582918, 1233.6454553700496, 973.0579960533794, 451.2991018335998, 2.3890107963645795, 1014.0429611759013, 815.7491848961466, 987.297020942861, 6.789517507834787, 273.2323164492418, 535.4860701827604, 1233.5525870950567, 748.9225276096579, 1023.3947731453555, 504.8595117221532, 1155.4026690603391, 1.564409381328184, 356.58060829402933, 12.339110923616829, 1156.0677919355307, 594.0729568993656, 1435.6404672134884, 1256.1700826428219, 678.564656420108, 694.5804400763245, 1579.4236237911782, 1443.7082508614446, 814.8528307941502, 0.0, 1512.7422816313165, 891.5054776759468, 1252.165330229663, 796.5042646627586, 1086.218011919486, 1528.3825871118977, 1475.2913981095573, 778.4020025117206, 1329.3122415237258, 607.9045463889997, 723.1679546691719, 895.9241362211661, 919.2426998248242, 733.3982508102108, 1319.1771697676152, 890.5274434750974, 1002.3419942810552, 1695.6170457429791, 1748.9724512436394, 1390.4595783042173, 603.2050028296791, 1386.098231594027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6201550858203589, "mean_inference_ms": 1.5415535953681407, "mean_action_processing_ms": 0.27102779080617895, "mean_env_wait_ms": 0.2032389222353647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031794309616088867, "StateBufferConnector_ms": 0.0026998519897460938, "ViewRequirementAgentConnector_ms": 0.07923340797424316}, "num_episodes": 18, "episode_return_max": 643.6287128149484, "episode_return_min": -921.9495347747817, "episode_return_mean": -100.513664958521, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.9811139659315, "num_env_steps_trained_throughput_per_sec": 440.9811139659315, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 9276.663, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9276.627, "sample_time_ms": 1010.521, "learn_time_ms": 8253.88, "learn_throughput": 484.621, "synch_weights_time_ms": 11.466}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "1f15c_00000", "date": "2024-08-16_14-08-36", "timestamp": 1723797516, "time_this_iter_s": 9.073653936386108, "time_total_s": 321.6975769996643, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8b1ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 321.6975769996643, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 37.925, "ram_util_percent": 74.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.89392037748029, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.155458233343861, "policy_loss": -0.008229850517171953, "vf_loss": 7.162013256739057, "vf_explained_var": 0.014293170290649252, "kl": 0.008374079129085549, "entropy": 1.2095511549364322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3937636510089593, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.56862349358816, "policy_loss": -0.005572663161598107, "vf_loss": 8.573500654937098, "vf_explained_var": 0.022864988398930385, "kl": 0.0069550623346540255, "entropy": 1.2020931659552154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 945.4053026851149, "episode_reward_min": -925.5055076395043, "episode_reward_mean": -79.98961847128062, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1697.319732278328, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 158.06228888189787, "predator_policy": 1748.9724512436394}, "policy_reward_mean": {"prey_policy": -560.353888615563, "predator_policy": 520.3590793799227}, "custom_metrics": {}, "hist_stats": {"episode_reward": [148.87794948773262, -110.14780310279589, 168.55999999999983, 148.79658738334945, -78.08367393248149, -110.36413393058531, -65.23174179492925, 83.41000000000014, -48.92666530994192, -89.40646185707422, 131.56300234874325, 186.06836344000288, 48.13187025973235, 56.06894853900204, -47.317248007029946, -57.00461510715105, -71.45163919143333, -144.65761388715194, -146.9239032281288, 10.136873147044255, 316.63684365173054, -258.1446783379185, -296.7563249594286, 178.52863626548503, 35.5999999999994, 62.6127171155093, -110.81877369183876, -209.9747447498361, 10.099999999999975, -51.392272926303896, 161.5320659341358, 15.661879362821706, 127.3812948093727, -237.27824093112173, 18.590000000000384, 35.32178532948425, -92.88901961965861, -121.5553704662804, 37.47138340595571, -552.2923759962564, -57.19963007526546, 15.102217742826682, 62.73666325122899, 114.67118099727568, -417.46248101493154, -580.9082606329872, -734.811245778864, -77.50385085084957, 64.72032215940514, -145.44118801976623, 7.739999999999987, -759.0463913501806, -234.67293026617307, -443.17278150030523, -275.57247113520805, 57.459999999999646, -494.06910003263346, -694.0317711008868, -336.6995164355025, -328.458603428847, 94.47999999999986, -438.58077512083236, -529.7317128458748, -526.5474828387516, -921.9495347747817, 82.99000000000004, 41.61000000000007, 180.35953851691298, -344.6151923813993, 299.41864366311466, -297.1767722745556, -432.47954310881516, -99.36368495186073, -234.7098467710304, -554.8680244237208, -684.0055805644532, 22.539999999999978, 643.6287128149484, -409.3822767709541, -490.8660596448179, -18.46126904421469, 18.59999999999999, 5.429740383537456, 786.3460172444263, 147.51812962892848, 9.59988648966279, 45.259999999999984, -353.2253773858491, 99.08592194537859, 50.07526741944315, 32.04569000625412, 401.8798774527503, 18.806980672262185, 692.9366738274845, 753.6744069003673, -10.535055613346039, 5.697997395021679, 71.83999999999997, 945.4053026851149, -925.5055076395043], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-41.87416993836951, 94.41234318385303, -131.70363033652328, -286.55755101043246, 158.06228888189787, -192.9678750299279, 89.12000000000008, -12.949176786888977, -514.1815482078251, -370.9903464324496, -155.26909913923294, -187.59315440194703, -104.20504793717566, -89.3226077068215, 59.45857222413411, -171.39076925372777, -260.7538083530628, -172.505150318486, -220.40169609122347, -132.03170608513608, -136.63553141449043, -691.8659445203883, 41.59999999999968, 59.868387853618316, 2.0000000000000013, -9.159849781622658, 40.563462450405204, 2.0000000000000013, -175.6476885409615, -310.33617406523933, -181.68619607213702, -151.7635596281282, -208.16475768247878, -274.8606833244614, -162.91023107147856, -230.0279404340446, -204.89598356968077, -226.61887005451607, -165.75200039326978, -94.77321670060623, 58.38106970824408, -588.1670497562286, -374.1346272165921, -463.2802322140022, -472.23466228977895, -527.9383516690641, -2.6941622258844955, 73.28000000000065, -37.422927743679715, 2.0000000000000013, -535.0073730064214, 24.155532564079902, -483.35198845029987, -400.97609282453215, -411.75631005737796, -422.5645767002724, -887.0908165973467, -235.02347575196436, -220.35566939726993, -253.54816045600478, 2.0000000000000013, 63.93531967822037, 4.969999999999958, -53.07063573963346, -384.78623526055344, 115.28477162075276, -528.4073202856697, -564.5656308974525, -21.70997762661314, -11.421551798312583, -28.201101334642015, 16.85000000000011, -286.36973683144805, -192.83624133772614, -697.8523086865412, -418.92245720567877, 33.67999999999968, -4.348958579984756, -1131.5644516906252, -918.9718390131953, -331.63056415602006, -442.653882884715, 2.0000000000000013, -16.52390528477357, -590.0671125926033, 51.03106782610381, -173.44846458709299, -118.92698620047332, -1128.5674837964705, -996.4890343236083, -643.163027202272, -635.8992430314903, -1059.8020776701592, -1059.9047268919917, -120.27069902373908, -794.7132580069122, 45.271579894683065, 2.0000000000000013, -610.5652661681407, -383.0924567233987, -188.61731584785704, -909.4599695792002, -896.9103543925776, -843.8547491136295, -706.6445077148496, -788.2423224991843, -855.0594542894387, -789.5326703527926, -946.3109304647285, -681.719548807092, 26.098550370830846, -240.9604151038842, -905.0768927319915, -1007.623769367368, -1331.8552552581214, -1568.879967266195, -429.36095630755057, -361.0266727579164, -1061.9241035967468, -1096.3266459041472, -986.8570209428611, 87.2504824921651, -600.7139306783201, -646.5852310745137, -1304.1062582560323, -1208.1005692945569, -1071.2932687545747, -983.5084989516846, -997.1848572450955, -1081.7317559713538, -238.1322031054213, -47.797516112224926, -1138.7277919355306, -569.8029568993659, -1204.4792134433812, -1306.9717978960157, -893.6308742002481, -824.1294146775833, -1481.784626952946, -1241.9286040365625, -770.1450707501314, -341.88453231857403, -1479.052155836201, -1357.6751465798777, -920.1630589985507, -1227.870220845731, -1440.2855909135524, -1409.0248548888603, -1450.4144764257246, -1358.146948619275, -1233.220661798754, -1388.0017066784246, -704.1579546691718, -892.3941362211661, -1126.5687498706739, 117.55651205058777, -1272.4095839041051, -1346.6773061095607, -1658.4441546894432, -1530.380944979409, -1460.5735663137425, -1697.319732278328, -1374.9882315940272, -595.7150028296791, -58.23410476477182, 2.0000000000000013, -107.10784369978582, -966.6256731913744, -293.3705293026505, -44.29451931245493, -972.6107253365972, -1013.8850761059939, -793.5119701902852, -232.37496381580877, -731.7581292356426, -498.6984199669473, 3.979999999999958, 58.000531344378984, 5.959999999999962, -28.626451297135436, -1244.1432532677366, -1267.1341425297182, -808.0892498942275, -1287.1386254522247, -1391.7333745628548, -1599.5433779716946, -1356.4588561022035, -519.0567004830723, -37.08562927946604, -1320.6209773311973, -1409.051384301844, -1084.8431116660677, -60.92194281554668, -348.03072833626754, -1215.4217261419333, 67.08780978759194, -237.59007651020994, -1556.6003618136356, -1464.235451534737, -1125.3828734621725], "policy_predator_policy_reward": [40.31654468396057, 56.0232315582894, 6.649503656640725, 301.46387458751815, 9.227711118102105, 194.23787502992718, 13.790907706241459, 58.83485646399655, 463.2045760479753, 343.8836446598174, 8.210700399422683, 224.2874192111716, 10.970322777837438, 117.32559107123008, 20.671427775865833, 174.67076925372805, 248.301457754178, 136.0308356074282, 26.950418708448368, 236.07652161083698, 737.9591924855769, 222.1052857980445, 57.38209844462352, 27.21787714176157, 16.491870259732952, 38.79984978162261, 4.578948539002363, 8.926537549594643, 143.7122945738664, 294.9543200253038, 126.58716068820928, 149.85797990490468, 260.2285663403292, 151.3452354751767, 6.398698042293537, 241.8818595760775, 4.296536373401679, 280.2944140226659, 192.996869446881, 77.6652207940393, 229.65009721014408, 616.7727264895711, 485.75946064789093, 93.51072044478393, 277.60976275431534, 425.8069262450992, 45.28233053324877, 62.66046795812271, 71.02292774367942, 0.0, 560.7977328580865, 12.666824699763549, 491.29639709872623, 282.2129104842673, 238.9420842243187, 385.4040577834968, 236.10347575196388, 896.1108165973466, 53.884708445964975, 368.6268484810045, 44.21482628463908, 51.38191997127637, 46.583069456594764, 17.179445645860113, 35.82100842136203, 361.0617500278112, 251.2792272039338, 604.4154830480662, 38.3599776266134, 13.361551798312542, 36.08110133464224, 10.591785329484845, 0.0, 386.31695854951454, 715.3933053338005, 279.8260900921394, 6.318958579984714, 1.821383405956338, 678.0753994854089, 820.1685152221556, 391.4611680796519, 325.6236488858169, 21.413905284773865, 8.212217742826764, 55.54824430733648, 546.2244637103918, 58.153231112344116, 348.8934006724972, 1041.201756352926, 666.3922807522216, 667.1842740304287, 30.969735570346575, 1140.1984251692566, 244.69713361403112, 31.578980001067897, 805.901126178734, 8.193719709675404, 9.25502255504642, 415.8193941951048, 432.3971406766682, 190.2073158478572, 915.6099695792001, 30.275832401239906, 951.4428797547871, 534.7907405851868, 725.4231593626737, 874.4665367661999, 326.9528063757267, 624.4278550346743, 728.0301531019381, 242.0304151038835, 30.291449629169367, 875.5457416084345, 543.0858204582918, 1233.6454553700496, 973.0579960533794, 451.2991018335998, 2.3890107963645795, 1014.0429611759013, 815.7491848961466, 987.297020942861, 6.789517507834787, 273.2323164492418, 535.4860701827604, 1233.5525870950567, 748.9225276096579, 1023.3947731453555, 504.8595117221532, 1155.4026690603391, 1.564409381328184, 356.58060829402933, 12.339110923616829, 1156.0677919355307, 594.0729568993656, 1435.6404672134884, 1256.1700826428219, 678.564656420108, 694.5804400763245, 1579.4236237911782, 1443.7082508614446, 814.8528307941502, 0.0, 1512.7422816313165, 891.5054776759468, 1252.165330229663, 796.5042646627586, 1086.218011919486, 1528.3825871118977, 1475.2913981095573, 778.4020025117206, 1329.3122415237258, 607.9045463889997, 723.1679546691719, 895.9241362211661, 919.2426998248242, 733.3982508102108, 1319.1771697676152, 890.5274434750974, 1002.3419942810552, 1695.6170457429791, 1748.9724512436394, 1390.4595783042173, 603.2050028296791, 1386.098231594027, 1.6097403835375295, 60.05410476477146, 954.9423009984038, 905.137233137183, 169.06350131191422, 316.1196769321202, 751.473266236238, 1244.6224216960156, 272.90496381580846, 798.241970190285, 833.9240846238259, 43.30708719291553, 11.411101060777156, 25.694289540221792, 61.156451297135675, 11.585267419443769, 1346.0842393118114, 1197.2388464918988, 1370.2255659353546, 1126.8821868638481, 1359.1995976461358, 1650.884135560675, 1159.1794452642725, 1409.272785148489, 829.7325283996214, 1281.6484851114099, 1405.0237489273284, 1078.3356914272376, 11.668888032392374, 402.9817805144431, 1215.9817261419332, 4.192190212408133, 1376.9754475180173, 1362.6202934909427, 1558.430830680569, 105.68198667683652]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6160181567587215, "mean_inference_ms": 1.5315057844123736, "mean_action_processing_ms": 0.2690451572995532, "mean_env_wait_ms": 0.20204548236297737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003190755844116211, "StateBufferConnector_ms": 0.0026944875717163086, "ViewRequirementAgentConnector_ms": 0.07870471477508545}, "num_episodes": 18, "episode_return_max": 945.4053026851149, "episode_return_min": -925.5055076395043, "episode_return_mean": -79.98961847128062, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.2588479815243, "num_env_steps_trained_throughput_per_sec": 440.2588479815243, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 9257.087, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9257.052, "sample_time_ms": 1001.919, "learn_time_ms": 8242.991, "learn_throughput": 485.261, "synch_weights_time_ms": 11.407}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "1f15c_00000", "date": "2024-08-16_14-08-45", "timestamp": 1723797525, "time_this_iter_s": 9.088673114776611, "time_total_s": 330.7862501144409, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8cdb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 330.7862501144409, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 35.93846153846154, "ram_util_percent": 74.12307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7706952760616939, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.905004169827416, "policy_loss": -0.009745250244393313, "vf_loss": 7.912544615558846, "vf_explained_var": 0.013268150917436711, "kl": 0.011024024115145354, "entropy": 1.1866584382990681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6331979083478767, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.127265265631298, "policy_loss": -0.009986074809132824, "vf_loss": 9.135200644296313, "vf_explained_var": 0.038690970562122486, "kl": 0.020507147696875526, "entropy": 1.1911447518086307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 945.4053026851149, "episode_reward_min": -1118.2286440823386, "episode_reward_mean": -73.03915257251946, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1825.5333404172525, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 142.5968032696723, "predator_policy": 1896.5902616957258}, "policy_reward_mean": {"prey_policy": -709.4126416998799, "predator_policy": 672.8930654136203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-146.9239032281288, 10.136873147044255, 316.63684365173054, -258.1446783379185, -296.7563249594286, 178.52863626548503, 35.5999999999994, 62.6127171155093, -110.81877369183876, -209.9747447498361, 10.099999999999975, -51.392272926303896, 161.5320659341358, 15.661879362821706, 127.3812948093727, -237.27824093112173, 18.590000000000384, 35.32178532948425, -92.88901961965861, -121.5553704662804, 37.47138340595571, -552.2923759962564, -57.19963007526546, 15.102217742826682, 62.73666325122899, 114.67118099727568, -417.46248101493154, -580.9082606329872, -734.811245778864, -77.50385085084957, 64.72032215940514, -145.44118801976623, 7.739999999999987, -759.0463913501806, -234.67293026617307, -443.17278150030523, -275.57247113520805, 57.459999999999646, -494.06910003263346, -694.0317711008868, -336.6995164355025, -328.458603428847, 94.47999999999986, -438.58077512083236, -529.7317128458748, -526.5474828387516, -921.9495347747817, 82.99000000000004, 41.61000000000007, 180.35953851691298, -344.6151923813993, 299.41864366311466, -297.1767722745556, -432.47954310881516, -99.36368495186073, -234.7098467710304, -554.8680244237208, -684.0055805644532, 22.539999999999978, 643.6287128149484, -409.3822767709541, -490.8660596448179, -18.46126904421469, 18.59999999999999, 5.429740383537456, 786.3460172444263, 147.51812962892848, 9.59988648966279, 45.259999999999984, -353.2253773858491, 99.08592194537859, 50.07526741944315, 32.04569000625412, 401.8798774527503, 18.806980672262185, 692.9366738274845, 753.6744069003673, -10.535055613346039, 5.697997395021679, 71.83999999999997, 945.4053026851149, -925.5055076395043, -269.3957009544349, 731.2217668441418, -388.32482328214024, 72.89303864295044, 150.42000000000039, 237.5129525225687, -677.4703845238555, 743.7945537584109, 46.163332604019686, 264.2699999999992, 662.6510685934035, 105.38054046325199, 0.42585028759124555, 368.9320190659471, 283.44253974826006, -139.8175985173631, -1118.2286440823386, -229.93879595630494], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-204.89598356968077, -226.61887005451607, -165.75200039326978, -94.77321670060623, 58.38106970824408, -588.1670497562286, -374.1346272165921, -463.2802322140022, -472.23466228977895, -527.9383516690641, -2.6941622258844955, 73.28000000000065, -37.422927743679715, 2.0000000000000013, -535.0073730064214, 24.155532564079902, -483.35198845029987, -400.97609282453215, -411.75631005737796, -422.5645767002724, -887.0908165973467, -235.02347575196436, -220.35566939726993, -253.54816045600478, 2.0000000000000013, 63.93531967822037, 4.969999999999958, -53.07063573963346, -384.78623526055344, 115.28477162075276, -528.4073202856697, -564.5656308974525, -21.70997762661314, -11.421551798312583, -28.201101334642015, 16.85000000000011, -286.36973683144805, -192.83624133772614, -697.8523086865412, -418.92245720567877, 33.67999999999968, -4.348958579984756, -1131.5644516906252, -918.9718390131953, -331.63056415602006, -442.653882884715, 2.0000000000000013, -16.52390528477357, -590.0671125926033, 51.03106782610381, -173.44846458709299, -118.92698620047332, -1128.5674837964705, -996.4890343236083, -643.163027202272, -635.8992430314903, -1059.8020776701592, -1059.9047268919917, -120.27069902373908, -794.7132580069122, 45.271579894683065, 2.0000000000000013, -610.5652661681407, -383.0924567233987, -188.61731584785704, -909.4599695792002, -896.9103543925776, -843.8547491136295, -706.6445077148496, -788.2423224991843, -855.0594542894387, -789.5326703527926, -946.3109304647285, -681.719548807092, 26.098550370830846, -240.9604151038842, -905.0768927319915, -1007.623769367368, -1331.8552552581214, -1568.879967266195, -429.36095630755057, -361.0266727579164, -1061.9241035967468, -1096.3266459041472, -986.8570209428611, 87.2504824921651, -600.7139306783201, -646.5852310745137, -1304.1062582560323, -1208.1005692945569, -1071.2932687545747, -983.5084989516846, -997.1848572450955, -1081.7317559713538, -238.1322031054213, -47.797516112224926, -1138.7277919355306, -569.8029568993659, -1204.4792134433812, -1306.9717978960157, -893.6308742002481, -824.1294146775833, -1481.784626952946, -1241.9286040365625, -770.1450707501314, -341.88453231857403, -1479.052155836201, -1357.6751465798777, -920.1630589985507, -1227.870220845731, -1440.2855909135524, -1409.0248548888603, -1450.4144764257246, -1358.146948619275, -1233.220661798754, -1388.0017066784246, -704.1579546691718, -892.3941362211661, -1126.5687498706739, 117.55651205058777, -1272.4095839041051, -1346.6773061095607, -1658.4441546894432, -1530.380944979409, -1460.5735663137425, -1697.319732278328, -1374.9882315940272, -595.7150028296791, -58.23410476477182, 2.0000000000000013, -107.10784369978582, -966.6256731913744, -293.3705293026505, -44.29451931245493, -972.6107253365972, -1013.8850761059939, -793.5119701902852, -232.37496381580877, -731.7581292356426, -498.6984199669473, 3.979999999999958, 58.000531344378984, 5.959999999999962, -28.626451297135436, -1244.1432532677366, -1267.1341425297182, -808.0892498942275, -1287.1386254522247, -1391.7333745628548, -1599.5433779716946, -1356.4588561022035, -519.0567004830723, -37.08562927946604, -1320.6209773311973, -1409.051384301844, -1084.8431116660677, -60.92194281554668, -348.03072833626754, -1215.4217261419333, 67.08780978759194, -237.59007651020994, -1556.6003618136356, -1464.235451534737, -1125.3828734621725, -1562.8018634916878, -1619.7378017236686, -110.86208933639502, -790.0764668368369, -1203.0043593886342, -1120.136047761322, -1783.3217075429616, -1825.5333404172525, 129.70132854721277, -10.513925380876408, 81.12471716376176, -43.39033370599114, -826.8401276300589, -756.451323331626, -1311.5608585386788, -470.7176637964451, -1583.8775244113242, -1512.1839674062487, 142.5968032696723, 97.50223231650203, -87.57330952607582, -682.8668914457186, -148.17193455608037, -1310.8304050723593, -1627.4790070959052, -1457.505378913204, -1459.0261054343405, -1078.2885590423568, -1497.0996352420154, -654.69314322943, -1493.157276382542, -1593.7989004493656, -1139.388094494779, -1611.069630821917, -1529.4583104179417, -1391.9305543072608], "policy_predator_policy_reward": [4.296536373401679, 280.2944140226659, 192.996869446881, 77.6652207940393, 229.65009721014408, 616.7727264895711, 485.75946064789093, 93.51072044478393, 277.60976275431534, 425.8069262450992, 45.28233053324877, 62.66046795812271, 71.02292774367942, 0.0, 560.7977328580865, 12.666824699763549, 491.29639709872623, 282.2129104842673, 238.9420842243187, 385.4040577834968, 236.10347575196388, 896.1108165973466, 53.884708445964975, 368.6268484810045, 44.21482628463908, 51.38191997127637, 46.583069456594764, 17.179445645860113, 35.82100842136203, 361.0617500278112, 251.2792272039338, 604.4154830480662, 38.3599776266134, 13.361551798312542, 36.08110133464224, 10.591785329484845, 0.0, 386.31695854951454, 715.3933053338005, 279.8260900921394, 6.318958579984714, 1.821383405956338, 678.0753994854089, 820.1685152221556, 391.4611680796519, 325.6236488858169, 21.413905284773865, 8.212217742826764, 55.54824430733648, 546.2244637103918, 58.153231112344116, 348.8934006724972, 1041.201756352926, 666.3922807522216, 667.1842740304287, 30.969735570346575, 1140.1984251692566, 244.69713361403112, 31.578980001067897, 805.901126178734, 8.193719709675404, 9.25502255504642, 415.8193941951048, 432.3971406766682, 190.2073158478572, 915.6099695792001, 30.275832401239906, 951.4428797547871, 534.7907405851868, 725.4231593626737, 874.4665367661999, 326.9528063757267, 624.4278550346743, 728.0301531019381, 242.0304151038835, 30.291449629169367, 875.5457416084345, 543.0858204582918, 1233.6454553700496, 973.0579960533794, 451.2991018335998, 2.3890107963645795, 1014.0429611759013, 815.7491848961466, 987.297020942861, 6.789517507834787, 273.2323164492418, 535.4860701827604, 1233.5525870950567, 748.9225276096579, 1023.3947731453555, 504.8595117221532, 1155.4026690603391, 1.564409381328184, 356.58060829402933, 12.339110923616829, 1156.0677919355307, 594.0729568993656, 1435.6404672134884, 1256.1700826428219, 678.564656420108, 694.5804400763245, 1579.4236237911782, 1443.7082508614446, 814.8528307941502, 0.0, 1512.7422816313165, 891.5054776759468, 1252.165330229663, 796.5042646627586, 1086.218011919486, 1528.3825871118977, 1475.2913981095573, 778.4020025117206, 1329.3122415237258, 607.9045463889997, 723.1679546691719, 895.9241362211661, 919.2426998248242, 733.3982508102108, 1319.1771697676152, 890.5274434750974, 1002.3419942810552, 1695.6170457429791, 1748.9724512436394, 1390.4595783042173, 603.2050028296791, 1386.098231594027, 1.6097403835375295, 60.05410476477146, 954.9423009984038, 905.137233137183, 169.06350131191422, 316.1196769321202, 751.473266236238, 1244.6224216960156, 272.90496381580846, 798.241970190285, 833.9240846238259, 43.30708719291553, 11.411101060777156, 25.694289540221792, 61.156451297135675, 11.585267419443769, 1346.0842393118114, 1197.2388464918988, 1370.2255659353546, 1126.8821868638481, 1359.1995976461358, 1650.884135560675, 1159.1794452642725, 1409.272785148489, 829.7325283996214, 1281.6484851114099, 1405.0237489273284, 1078.3356914272376, 11.668888032392374, 402.9817805144431, 1215.9817261419332, 4.192190212408133, 1376.9754475180173, 1362.6202934909427, 1558.430830680569, 105.68198667683652, 1268.3996774833452, 1644.744286777576, 764.69353007392, 867.4667929434552, 860.2830439208757, 1074.5325399469416, 1896.5902616957258, 1785.1578249074394, 12.473925380876366, 18.758671452787404, 30.476865753583155, 169.30170331121593, 882.3085401957392, 23.51252624209043, 1276.4486646454955, 1249.6244114480398, 1451.7815687059528, 1690.4432557156401, 7.863196730327678, 16.307767683497836, 808.6254098241529, 624.4658597410445, 1311.2704050723592, 253.11247501933272, 1627.3708261523188, 1458.039410144383, 1388.4134582216673, 1517.8332253209776, 1561.80082674439, 873.4344914753152, 1313.50788900511, 1633.630689309435, 1.504096712138675, 1630.7249845222186, 1277.5549821994603, 1413.895086569437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.612006670979078, "mean_inference_ms": 1.5217001033765818, "mean_action_processing_ms": 0.26713574901188236, "mean_env_wait_ms": 0.2009028258115189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031658411026000977, "StateBufferConnector_ms": 0.002686023712158203, "ViewRequirementAgentConnector_ms": 0.07808804512023926}, "num_episodes": 18, "episode_return_max": 945.4053026851149, "episode_return_min": -1118.2286440823386, "episode_return_mean": -73.03915257251946, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.66504871246525, "num_env_steps_trained_throughput_per_sec": 447.66504871246525, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 9223.511, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9223.475, "sample_time_ms": 979.982, "learn_time_ms": 8231.675, "learn_throughput": 485.928, "synch_weights_time_ms": 11.113}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "1f15c_00000", "date": "2024-08-16_14-08-54", "timestamp": 1723797534, "time_this_iter_s": 8.93836498260498, "time_total_s": 339.7246150970459, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f87de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 339.7246150970459, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.330769230769228, "ram_util_percent": 74.74615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4538415399493363, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.23551935089959, "policy_loss": -0.0032634362713901926, "vf_loss": 5.237505206481489, "vf_explained_var": 0.001807370703056376, "kl": 0.006387896900919725, "entropy": 1.179091256699234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9083283771282782, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7059683383457243, "policy_loss": -0.014058914373840683, "vf_loss": 3.717035527077932, "vf_explained_var": 0.013943707785278401, "kl": 0.01994486440665268, "entropy": 1.1880175695848212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 1043.2407317945394, "episode_reward_min": -1118.2286440823386, "episode_reward_mean": -1.6938460422576176, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1825.5333404172525, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 142.5968032696723, "predator_policy": 1896.5902616957258}, "policy_reward_mean": {"prey_policy": -720.8545977358028, "predator_policy": 720.0076747146741}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.19963007526546, 15.102217742826682, 62.73666325122899, 114.67118099727568, -417.46248101493154, -580.9082606329872, -734.811245778864, -77.50385085084957, 64.72032215940514, -145.44118801976623, 7.739999999999987, -759.0463913501806, -234.67293026617307, -443.17278150030523, -275.57247113520805, 57.459999999999646, -494.06910003263346, -694.0317711008868, -336.6995164355025, -328.458603428847, 94.47999999999986, -438.58077512083236, -529.7317128458748, -526.5474828387516, -921.9495347747817, 82.99000000000004, 41.61000000000007, 180.35953851691298, -344.6151923813993, 299.41864366311466, -297.1767722745556, -432.47954310881516, -99.36368495186073, -234.7098467710304, -554.8680244237208, -684.0055805644532, 22.539999999999978, 643.6287128149484, -409.3822767709541, -490.8660596448179, -18.46126904421469, 18.59999999999999, 5.429740383537456, 786.3460172444263, 147.51812962892848, 9.59988648966279, 45.259999999999984, -353.2253773858491, 99.08592194537859, 50.07526741944315, 32.04569000625412, 401.8798774527503, 18.806980672262185, 692.9366738274845, 753.6744069003673, -10.535055613346039, 5.697997395021679, 71.83999999999997, 945.4053026851149, -925.5055076395043, -269.3957009544349, 731.2217668441418, -388.32482328214024, 72.89303864295044, 150.42000000000039, 237.5129525225687, -677.4703845238555, 743.7945537584109, 46.163332604019686, 264.2699999999992, 662.6510685934035, 105.38054046325199, 0.42585028759124555, 368.9320190659471, 283.44253974826006, -139.8175985173631, -1118.2286440823386, -229.93879595630494, 110.97999999999982, 872.5135638368471, 33.54999999999996, 748.4968495361238, 25.550000000000537, 142.48000000000025, 245.87898058331868, 83.72098619356741, 39.01999999999955, 90.54052725554482, 136.4418670398017, -2.471661317749863, 1043.2407317945394, 636.4190866870849, 93.60264187425702, 20.247258184302982, 137.5177210287398, 435.0876402125904, 544.1253867130193, 30.384827896310174, 434.69690067242544, 164.05511895022707], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-331.63056415602006, -442.653882884715, 2.0000000000000013, -16.52390528477357, -590.0671125926033, 51.03106782610381, -173.44846458709299, -118.92698620047332, -1128.5674837964705, -996.4890343236083, -643.163027202272, -635.8992430314903, -1059.8020776701592, -1059.9047268919917, -120.27069902373908, -794.7132580069122, 45.271579894683065, 2.0000000000000013, -610.5652661681407, -383.0924567233987, -188.61731584785704, -909.4599695792002, -896.9103543925776, -843.8547491136295, -706.6445077148496, -788.2423224991843, -855.0594542894387, -789.5326703527926, -946.3109304647285, -681.719548807092, 26.098550370830846, -240.9604151038842, -905.0768927319915, -1007.623769367368, -1331.8552552581214, -1568.879967266195, -429.36095630755057, -361.0266727579164, -1061.9241035967468, -1096.3266459041472, -986.8570209428611, 87.2504824921651, -600.7139306783201, -646.5852310745137, -1304.1062582560323, -1208.1005692945569, -1071.2932687545747, -983.5084989516846, -997.1848572450955, -1081.7317559713538, -238.1322031054213, -47.797516112224926, -1138.7277919355306, -569.8029568993659, -1204.4792134433812, -1306.9717978960157, -893.6308742002481, -824.1294146775833, -1481.784626952946, -1241.9286040365625, -770.1450707501314, -341.88453231857403, -1479.052155836201, -1357.6751465798777, -920.1630589985507, -1227.870220845731, -1440.2855909135524, -1409.0248548888603, -1450.4144764257246, -1358.146948619275, -1233.220661798754, -1388.0017066784246, -704.1579546691718, -892.3941362211661, -1126.5687498706739, 117.55651205058777, -1272.4095839041051, -1346.6773061095607, -1658.4441546894432, -1530.380944979409, -1460.5735663137425, -1697.319732278328, -1374.9882315940272, -595.7150028296791, -58.23410476477182, 2.0000000000000013, -107.10784369978582, -966.6256731913744, -293.3705293026505, -44.29451931245493, -972.6107253365972, -1013.8850761059939, -793.5119701902852, -232.37496381580877, -731.7581292356426, -498.6984199669473, 3.979999999999958, 58.000531344378984, 5.959999999999962, -28.626451297135436, -1244.1432532677366, -1267.1341425297182, -808.0892498942275, -1287.1386254522247, -1391.7333745628548, -1599.5433779716946, -1356.4588561022035, -519.0567004830723, -37.08562927946604, -1320.6209773311973, -1409.051384301844, -1084.8431116660677, -60.92194281554668, -348.03072833626754, -1215.4217261419333, 67.08780978759194, -237.59007651020994, -1556.6003618136356, -1464.235451534737, -1125.3828734621725, -1562.8018634916878, -1619.7378017236686, -110.86208933639502, -790.0764668368369, -1203.0043593886342, -1120.136047761322, -1783.3217075429616, -1825.5333404172525, 129.70132854721277, -10.513925380876408, 81.12471716376176, -43.39033370599114, -826.8401276300589, -756.451323331626, -1311.5608585386788, -470.7176637964451, -1583.8775244113242, -1512.1839674062487, 142.5968032696723, 97.50223231650203, -87.57330952607582, -682.8668914457186, -148.17193455608037, -1310.8304050723593, -1627.4790070959052, -1457.505378913204, -1459.0261054343405, -1078.2885590423568, -1497.0996352420154, -654.69314322943, -1493.157276382542, -1593.7989004493656, -1139.388094494779, -1611.069630821917, -1529.4583104179417, -1391.9305543072608, -1287.5219501064228, 99.75064633497529, -1091.1042584409, 2.0000000000000013, -26.401121427648086, 4.969999999999958, 130.70000000000005, -793.9340796409359, -19.655658410317663, -10.51181396737901, 3.979999999999958, 88.31170484629523, -395.028643518848, -50.94074571725707, -132.37329483173988, -98.46453308866657, -129.44630293405802, -46.54327383484849, -884.8008313197159, 29.682115991805368, -232.2815459282203, 30.71000000000024, -34.88876120252748, -74.43391686442168, -1163.7637413142825, 2.0000000000000013, -701.9178944711035, 21.800000000000175, -1385.4437792643384, -1128.9437203993095, -97.5063089259626, 2.0000000000000013, 23.780000000000264, 63.92601314470464, -534.3811114520547, 30.710000000000267, -978.1301625287515, -925.8073701486437, -100.5008248437802, -13.595905620408418, -1305.4277744457956, -638.8153213083664, 2.0000000000000013, -398.22534133719466], "policy_predator_policy_reward": [391.4611680796519, 325.6236488858169, 21.413905284773865, 8.212217742826764, 55.54824430733648, 546.2244637103918, 58.153231112344116, 348.8934006724972, 1041.201756352926, 666.3922807522216, 667.1842740304287, 30.969735570346575, 1140.1984251692566, 244.69713361403112, 31.578980001067897, 805.901126178734, 8.193719709675404, 9.25502255504642, 415.8193941951048, 432.3971406766682, 190.2073158478572, 915.6099695792001, 30.275832401239906, 951.4428797547871, 534.7907405851868, 725.4231593626737, 874.4665367661999, 326.9528063757267, 624.4278550346743, 728.0301531019381, 242.0304151038835, 30.291449629169367, 875.5457416084345, 543.0858204582918, 1233.6454553700496, 973.0579960533794, 451.2991018335998, 2.3890107963645795, 1014.0429611759013, 815.7491848961466, 987.297020942861, 6.789517507834787, 273.2323164492418, 535.4860701827604, 1233.5525870950567, 748.9225276096579, 1023.3947731453555, 504.8595117221532, 1155.4026690603391, 1.564409381328184, 356.58060829402933, 12.339110923616829, 1156.0677919355307, 594.0729568993656, 1435.6404672134884, 1256.1700826428219, 678.564656420108, 694.5804400763245, 1579.4236237911782, 1443.7082508614446, 814.8528307941502, 0.0, 1512.7422816313165, 891.5054776759468, 1252.165330229663, 796.5042646627586, 1086.218011919486, 1528.3825871118977, 1475.2913981095573, 778.4020025117206, 1329.3122415237258, 607.9045463889997, 723.1679546691719, 895.9241362211661, 919.2426998248242, 733.3982508102108, 1319.1771697676152, 890.5274434750974, 1002.3419942810552, 1695.6170457429791, 1748.9724512436394, 1390.4595783042173, 603.2050028296791, 1386.098231594027, 1.6097403835375295, 60.05410476477146, 954.9423009984038, 905.137233137183, 169.06350131191422, 316.1196769321202, 751.473266236238, 1244.6224216960156, 272.90496381580846, 798.241970190285, 833.9240846238259, 43.30708719291553, 11.411101060777156, 25.694289540221792, 61.156451297135675, 11.585267419443769, 1346.0842393118114, 1197.2388464918988, 1370.2255659353546, 1126.8821868638481, 1359.1995976461358, 1650.884135560675, 1159.1794452642725, 1409.272785148489, 829.7325283996214, 1281.6484851114099, 1405.0237489273284, 1078.3356914272376, 11.668888032392374, 402.9817805144431, 1215.9817261419332, 4.192190212408133, 1376.9754475180173, 1362.6202934909427, 1558.430830680569, 105.68198667683652, 1268.3996774833452, 1644.744286777576, 764.69353007392, 867.4667929434552, 860.2830439208757, 1074.5325399469416, 1896.5902616957258, 1785.1578249074394, 12.473925380876366, 18.758671452787404, 30.476865753583155, 169.30170331121593, 882.3085401957392, 23.51252624209043, 1276.4486646454955, 1249.6244114480398, 1451.7815687059528, 1690.4432557156401, 7.863196730327678, 16.307767683497836, 808.6254098241529, 624.4658597410445, 1311.2704050723592, 253.11247501933272, 1627.3708261523188, 1458.039410144383, 1388.4134582216673, 1517.8332253209776, 1561.80082674439, 873.4344914753152, 1313.50788900511, 1633.630689309435, 1.504096712138675, 1630.7249845222186, 1277.5549821994603, 1413.895086569437, 1291.6019501064227, 7.149353665024701, 1053.5745790202357, 908.0432432575119, 0.0, 54.98112142764833, 662.7613916835004, 748.9695374935599, 55.71747237769689, 0.0, 50.18829515370475, 0.0, 415.13769005640785, 276.7106797630153, 117.17319237484682, 197.38562173912575, 48.45327383484811, 166.55630293405702, 935.4436375813942, 10.215605002060794, 219.32094177960244, 118.69247118842044, 104.50277057817097, 2.3482461710287783, 1075.5293246616543, 1129.4751484471685, 633.806401846343, 682.7305793118463, 1345.7092427098635, 1262.2808988280415, 82.01819263134065, 33.73537447892521, 24.051186991599067, 25.760520892435817, 465.45897260817844, 473.2997790564681, 1243.1595870785943, 1204.90333231182, 102.30082484378111, 42.18073351671799, 1371.2915112162561, 1007.6484852103308, 312.8569120551532, 247.42354823226995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6078600538343051, "mean_inference_ms": 1.510991667048404, "mean_action_processing_ms": 0.26454102716732886, "mean_env_wait_ms": 0.19962621999431662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003169417381286621, "StateBufferConnector_ms": 0.0027276277542114258, "ViewRequirementAgentConnector_ms": 0.07893025875091553}, "num_episodes": 22, "episode_return_max": 1043.2407317945394, "episode_return_min": -1118.2286440823386, "episode_return_mean": -1.6938460422576176, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.22945135137763, "num_env_steps_trained_throughput_per_sec": 441.22945135137763, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 9206.567, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9206.531, "sample_time_ms": 988.2, "learn_time_ms": 8206.505, "learn_throughput": 487.418, "synch_weights_time_ms": 11.129}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "1f15c_00000", "date": "2024-08-16_14-09-03", "timestamp": 1723797543, "time_this_iter_s": 9.069247245788574, "time_total_s": 348.7938623428345, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f87dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 348.7938623428345, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 32.63076923076923, "ram_util_percent": 74.58461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3891179470158128, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7199702814773277, "policy_loss": -0.007988339738930187, "vf_loss": 2.7265067033036043, "vf_explained_var": 0.00019792715708414713, "kl": 0.007259588856711737, "entropy": 1.150764333697223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9064317048384398, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9280620783094378, "policy_loss": -0.00688264081032858, "vf_loss": 2.933348531319351, "vf_explained_var": 0.041784848170305686, "kl": 0.010641198991116032, "entropy": 1.1568269484257572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 1043.2407317945394, "episode_reward_min": -1118.2286440823386, "episode_reward_mean": 81.91433796884245, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1825.5333404172525, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 142.5968032696723, "predator_policy": 1896.5902616957258}, "policy_reward_mean": {"prey_policy": -605.0683755421936, "predator_policy": 646.025544526615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-526.5474828387516, -921.9495347747817, 82.99000000000004, 41.61000000000007, 180.35953851691298, -344.6151923813993, 299.41864366311466, -297.1767722745556, -432.47954310881516, -99.36368495186073, -234.7098467710304, -554.8680244237208, -684.0055805644532, 22.539999999999978, 643.6287128149484, -409.3822767709541, -490.8660596448179, -18.46126904421469, 18.59999999999999, 5.429740383537456, 786.3460172444263, 147.51812962892848, 9.59988648966279, 45.259999999999984, -353.2253773858491, 99.08592194537859, 50.07526741944315, 32.04569000625412, 401.8798774527503, 18.806980672262185, 692.9366738274845, 753.6744069003673, -10.535055613346039, 5.697997395021679, 71.83999999999997, 945.4053026851149, -925.5055076395043, -269.3957009544349, 731.2217668441418, -388.32482328214024, 72.89303864295044, 150.42000000000039, 237.5129525225687, -677.4703845238555, 743.7945537584109, 46.163332604019686, 264.2699999999992, 662.6510685934035, 105.38054046325199, 0.42585028759124555, 368.9320190659471, 283.44253974826006, -139.8175985173631, -1118.2286440823386, -229.93879595630494, 110.97999999999982, 872.5135638368471, 33.54999999999996, 748.4968495361238, 25.550000000000537, 142.48000000000025, 245.87898058331868, 83.72098619356741, 39.01999999999955, 90.54052725554482, 136.4418670398017, -2.471661317749863, 1043.2407317945394, 636.4190866870849, 93.60264187425702, 20.247258184302982, 137.5177210287398, 435.0876402125904, 544.1253867130193, 30.384827896310174, 434.69690067242544, 164.05511895022707, 183.5453571567608, 130.50999999999908, 33.889999999999745, 78.99364502389616, 98.49187579880937, 115.04822514925998, -17.524065350286303, 238.3565103614374, 14.072782666208063, 3.8499999999999615, 37.61999999999967, 5.176673941237091, 132.10117550221395, 34.579999999999735, 655.9086395669231, 47.61657871986598, 40.3635491550913, 23.45965026870513, 121.81679794384394, 128.22014565379254, 3.6199999999999606, 31.180000000000465, 89.46853411387708], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1071.2932687545747, -983.5084989516846, -997.1848572450955, -1081.7317559713538, -238.1322031054213, -47.797516112224926, -1138.7277919355306, -569.8029568993659, -1204.4792134433812, -1306.9717978960157, -893.6308742002481, -824.1294146775833, -1481.784626952946, -1241.9286040365625, -770.1450707501314, -341.88453231857403, -1479.052155836201, -1357.6751465798777, -920.1630589985507, -1227.870220845731, -1440.2855909135524, -1409.0248548888603, -1450.4144764257246, -1358.146948619275, -1233.220661798754, -1388.0017066784246, -704.1579546691718, -892.3941362211661, -1126.5687498706739, 117.55651205058777, -1272.4095839041051, -1346.6773061095607, -1658.4441546894432, -1530.380944979409, -1460.5735663137425, -1697.319732278328, -1374.9882315940272, -595.7150028296791, -58.23410476477182, 2.0000000000000013, -107.10784369978582, -966.6256731913744, -293.3705293026505, -44.29451931245493, -972.6107253365972, -1013.8850761059939, -793.5119701902852, -232.37496381580877, -731.7581292356426, -498.6984199669473, 3.979999999999958, 58.000531344378984, 5.959999999999962, -28.626451297135436, -1244.1432532677366, -1267.1341425297182, -808.0892498942275, -1287.1386254522247, -1391.7333745628548, -1599.5433779716946, -1356.4588561022035, -519.0567004830723, -37.08562927946604, -1320.6209773311973, -1409.051384301844, -1084.8431116660677, -60.92194281554668, -348.03072833626754, -1215.4217261419333, 67.08780978759194, -237.59007651020994, -1556.6003618136356, -1464.235451534737, -1125.3828734621725, -1562.8018634916878, -1619.7378017236686, -110.86208933639502, -790.0764668368369, -1203.0043593886342, -1120.136047761322, -1783.3217075429616, -1825.5333404172525, 129.70132854721277, -10.513925380876408, 81.12471716376176, -43.39033370599114, -826.8401276300589, -756.451323331626, -1311.5608585386788, -470.7176637964451, -1583.8775244113242, -1512.1839674062487, 142.5968032696723, 97.50223231650203, -87.57330952607582, -682.8668914457186, -148.17193455608037, -1310.8304050723593, -1627.4790070959052, -1457.505378913204, -1459.0261054343405, -1078.2885590423568, -1497.0996352420154, -654.69314322943, -1493.157276382542, -1593.7989004493656, -1139.388094494779, -1611.069630821917, -1529.4583104179417, -1391.9305543072608, -1287.5219501064228, 99.75064633497529, -1091.1042584409, 2.0000000000000013, -26.401121427648086, 4.969999999999958, 130.70000000000005, -793.9340796409359, -19.655658410317663, -10.51181396737901, 3.979999999999958, 88.31170484629523, -395.028643518848, -50.94074571725707, -132.37329483173988, -98.46453308866657, -129.44630293405802, -46.54327383484849, -884.8008313197159, 29.682115991805368, -232.2815459282203, 30.71000000000024, -34.88876120252748, -74.43391686442168, -1163.7637413142825, 2.0000000000000013, -701.9178944711035, 21.800000000000175, -1385.4437792643384, -1128.9437203993095, -97.5063089259626, 2.0000000000000013, 23.780000000000264, 63.92601314470464, -534.3811114520547, 30.710000000000267, -978.1301625287515, -925.8073701486437, -100.5008248437802, -13.595905620408418, -1305.4277744457956, -638.8153213083664, 2.0000000000000013, -398.22534133719466, 88.51537456759516, 4.969999999999958, -38.738468079461065, 121.79000000000033, -246.1988349236605, -7.989149676102199, 2.0000000000000013, -142.75203776212405, -29.180647337345707, 85.16000000000035, -6.562046556831364, -55.50336604509237, -94.82841835853827, -84.04613340925714, 27.740000000000272, -321.6319714794854, 2.0000000000000013, -73.66859917041518, -26.18963609903174, -29.14185148909578, -193.28526881840796, -160.56182873021334, -946.271337734391, -246.8110690617489, -12.065990350698588, -416.41572910525775, -31.887548904558294, -505.74945554598753, -965.9271443641587, -263.22780354004317, -26.74610941381875, -50.84451865712458, -42.54468749446696, -4.391283855197022, -15.022397019604359, -54.36347327349794, -148.63109840742112, 21.80000000000028, -299.02417074476256, -478.8800404626584, -200.41940917936486, -8.144559970920135, -137.95185618740692, -55.65677594406853, -76.04476230031271, 52.75252404512666], "policy_predator_policy_reward": [1023.3947731453555, 504.8595117221532, 1155.4026690603391, 1.564409381328184, 356.58060829402933, 12.339110923616829, 1156.0677919355307, 594.0729568993656, 1435.6404672134884, 1256.1700826428219, 678.564656420108, 694.5804400763245, 1579.4236237911782, 1443.7082508614446, 814.8528307941502, 0.0, 1512.7422816313165, 891.5054776759468, 1252.165330229663, 796.5042646627586, 1086.218011919486, 1528.3825871118977, 1475.2913981095573, 778.4020025117206, 1329.3122415237258, 607.9045463889997, 723.1679546691719, 895.9241362211661, 919.2426998248242, 733.3982508102108, 1319.1771697676152, 890.5274434750974, 1002.3419942810552, 1695.6170457429791, 1748.9724512436394, 1390.4595783042173, 603.2050028296791, 1386.098231594027, 1.6097403835375295, 60.05410476477146, 954.9423009984038, 905.137233137183, 169.06350131191422, 316.1196769321202, 751.473266236238, 1244.6224216960156, 272.90496381580846, 798.241970190285, 833.9240846238259, 43.30708719291553, 11.411101060777156, 25.694289540221792, 61.156451297135675, 11.585267419443769, 1346.0842393118114, 1197.2388464918988, 1370.2255659353546, 1126.8821868638481, 1359.1995976461358, 1650.884135560675, 1159.1794452642725, 1409.272785148489, 829.7325283996214, 1281.6484851114099, 1405.0237489273284, 1078.3356914272376, 11.668888032392374, 402.9817805144431, 1215.9817261419332, 4.192190212408133, 1376.9754475180173, 1362.6202934909427, 1558.430830680569, 105.68198667683652, 1268.3996774833452, 1644.744286777576, 764.69353007392, 867.4667929434552, 860.2830439208757, 1074.5325399469416, 1896.5902616957258, 1785.1578249074394, 12.473925380876366, 18.758671452787404, 30.476865753583155, 169.30170331121593, 882.3085401957392, 23.51252624209043, 1276.4486646454955, 1249.6244114480398, 1451.7815687059528, 1690.4432557156401, 7.863196730327678, 16.307767683497836, 808.6254098241529, 624.4658597410445, 1311.2704050723592, 253.11247501933272, 1627.3708261523188, 1458.039410144383, 1388.4134582216673, 1517.8332253209776, 1561.80082674439, 873.4344914753152, 1313.50788900511, 1633.630689309435, 1.504096712138675, 1630.7249845222186, 1277.5549821994603, 1413.895086569437, 1291.6019501064227, 7.149353665024701, 1053.5745790202357, 908.0432432575119, 0.0, 54.98112142764833, 662.7613916835004, 748.9695374935599, 55.71747237769689, 0.0, 50.18829515370475, 0.0, 415.13769005640785, 276.7106797630153, 117.17319237484682, 197.38562173912575, 48.45327383484811, 166.55630293405702, 935.4436375813942, 10.215605002060794, 219.32094177960244, 118.69247118842044, 104.50277057817097, 2.3482461710287783, 1075.5293246616543, 1129.4751484471685, 633.806401846343, 682.7305793118463, 1345.7092427098635, 1262.2808988280415, 82.01819263134065, 33.73537447892521, 24.051186991599067, 25.760520892435817, 465.45897260817844, 473.2997790564681, 1243.1595870785943, 1204.90333231182, 102.30082484378111, 42.18073351671799, 1371.2915112162561, 1007.6484852103308, 312.8569120551532, 247.42354823226995, 37.77445557585274, 52.28552701331302, 0.0, 47.458468079460715, 218.12461810098947, 69.9533664987721, 79.385415401789, 140.3602673842277, 31.11064733734601, 11.40187579880857, 81.22895399470397, 95.88468375647926, 72.32232497247178, 89.0281614450385, 220.14989230561784, 312.098589535306, 30.324186635579817, 55.417195201044315, 30.413954151597988, 28.767533436530137, 233.4917990128516, 157.9752985357674, 233.9635834568882, 964.2954972804887, 144.41223222644504, 416.1706627317261, 538.449455545987, 33.76754890455796, 1042.76414206369, 842.2994454074343, 74.58356957099619, 50.62363721981367, 30.096094579010053, 57.20342592574552, 53.498746941175035, 39.34677362063172, 60.54749445618589, 188.1004018950776, 437.8089892815651, 468.31536757964557, 188.2454063329858, 23.93856281729797, 85.09677594406824, 139.69185618740545, 20.066010068748742, 92.69476230031356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6033134659059448, "mean_inference_ms": 1.5000567247733787, "mean_action_processing_ms": 0.26295541055206134, "mean_env_wait_ms": 0.19840990991780275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035284757614135742, "StateBufferConnector_ms": 0.002777576446533203, "ViewRequirementAgentConnector_ms": 0.08024024963378906}, "num_episodes": 23, "episode_return_max": 1043.2407317945394, "episode_return_min": -1118.2286440823386, "episode_return_mean": 81.91433796884245, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.0300248789854, "num_env_steps_trained_throughput_per_sec": 442.0300248789854, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 9186.327, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9186.291, "sample_time_ms": 983.74, "learn_time_ms": 8190.874, "learn_throughput": 488.348, "synch_weights_time_ms": 11.001}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "1f15c_00000", "date": "2024-08-16_14-09-12", "timestamp": 1723797552, "time_this_iter_s": 9.052987098693848, "time_total_s": 357.8468494415283, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8baa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 357.8468494415283, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 32.00769230769232, "ram_util_percent": 74.52307692307691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0254853231881662, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.71608245164629, "policy_loss": -0.008198481762939424, "vf_loss": 1.7233370219904278, "vf_explained_var": -0.00029715860962237, "kl": 0.004719537067622604, "entropy": 1.148021325169417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3284118904007807, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.323797334092004, "policy_loss": -0.01148682491750353, "vf_loss": 2.3334958208931815, "vf_explained_var": 0.06117992051064022, "kl": 0.011922279640243855, "entropy": 1.15465772492545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 1043.2407317945394, "episode_reward_min": -1118.2286440823386, "episode_reward_mean": 137.52483371275864, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1825.5333404172525, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 142.5968032696723, "predator_policy": 1896.5902616957258}, "policy_reward_mean": {"prey_policy": -420.9492656431455, "predator_policy": 489.7116824995249}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.59999999999999, 5.429740383537456, 786.3460172444263, 147.51812962892848, 9.59988648966279, 45.259999999999984, -353.2253773858491, 99.08592194537859, 50.07526741944315, 32.04569000625412, 401.8798774527503, 18.806980672262185, 692.9366738274845, 753.6744069003673, -10.535055613346039, 5.697997395021679, 71.83999999999997, 945.4053026851149, -925.5055076395043, -269.3957009544349, 731.2217668441418, -388.32482328214024, 72.89303864295044, 150.42000000000039, 237.5129525225687, -677.4703845238555, 743.7945537584109, 46.163332604019686, 264.2699999999992, 662.6510685934035, 105.38054046325199, 0.42585028759124555, 368.9320190659471, 283.44253974826006, -139.8175985173631, -1118.2286440823386, -229.93879595630494, 110.97999999999982, 872.5135638368471, 33.54999999999996, 748.4968495361238, 25.550000000000537, 142.48000000000025, 245.87898058331868, 83.72098619356741, 39.01999999999955, 90.54052725554482, 136.4418670398017, -2.471661317749863, 1043.2407317945394, 636.4190866870849, 93.60264187425702, 20.247258184302982, 137.5177210287398, 435.0876402125904, 544.1253867130193, 30.384827896310174, 434.69690067242544, 164.05511895022707, 183.5453571567608, 130.50999999999908, 33.889999999999745, 78.99364502389616, 98.49187579880937, 115.04822514925998, -17.524065350286303, 238.3565103614374, 14.072782666208063, 3.8499999999999615, 37.61999999999967, 5.176673941237091, 132.10117550221395, 34.579999999999735, 655.9086395669231, 47.61657871986598, 40.3635491550913, 23.45965026870513, 121.81679794384394, 128.22014565379254, 3.6199999999999606, 31.180000000000465, 89.46853411387708, 204.69806074951626, 111.20752272898126, 87.22748455558182, 159.11143723107588, 450.7744254591595, 3.5999999999999615, 30.60019449576565, 41.464656786190496, 84.37676002293708, 9.869999999999923, 89.08000000000001, 20.02319432070267, 114.61755848862748, 21.960024124210882, 93.66003786494636, 30.150000000000464, 160.7018416416375, 104.04800336790956], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1374.9882315940272, -595.7150028296791, -58.23410476477182, 2.0000000000000013, -107.10784369978582, -966.6256731913744, -293.3705293026505, -44.29451931245493, -972.6107253365972, -1013.8850761059939, -793.5119701902852, -232.37496381580877, -731.7581292356426, -498.6984199669473, 3.979999999999958, 58.000531344378984, 5.959999999999962, -28.626451297135436, -1244.1432532677366, -1267.1341425297182, -808.0892498942275, -1287.1386254522247, -1391.7333745628548, -1599.5433779716946, -1356.4588561022035, -519.0567004830723, -37.08562927946604, -1320.6209773311973, -1409.051384301844, -1084.8431116660677, -60.92194281554668, -348.03072833626754, -1215.4217261419333, 67.08780978759194, -237.59007651020994, -1556.6003618136356, -1464.235451534737, -1125.3828734621725, -1562.8018634916878, -1619.7378017236686, -110.86208933639502, -790.0764668368369, -1203.0043593886342, -1120.136047761322, -1783.3217075429616, -1825.5333404172525, 129.70132854721277, -10.513925380876408, 81.12471716376176, -43.39033370599114, -826.8401276300589, -756.451323331626, -1311.5608585386788, -470.7176637964451, -1583.8775244113242, -1512.1839674062487, 142.5968032696723, 97.50223231650203, -87.57330952607582, -682.8668914457186, -148.17193455608037, -1310.8304050723593, -1627.4790070959052, -1457.505378913204, -1459.0261054343405, -1078.2885590423568, -1497.0996352420154, -654.69314322943, -1493.157276382542, -1593.7989004493656, -1139.388094494779, -1611.069630821917, -1529.4583104179417, -1391.9305543072608, -1287.5219501064228, 99.75064633497529, -1091.1042584409, 2.0000000000000013, -26.401121427648086, 4.969999999999958, 130.70000000000005, -793.9340796409359, -19.655658410317663, -10.51181396737901, 3.979999999999958, 88.31170484629523, -395.028643518848, -50.94074571725707, -132.37329483173988, -98.46453308866657, -129.44630293405802, -46.54327383484849, -884.8008313197159, 29.682115991805368, -232.2815459282203, 30.71000000000024, -34.88876120252748, -74.43391686442168, -1163.7637413142825, 2.0000000000000013, -701.9178944711035, 21.800000000000175, -1385.4437792643384, -1128.9437203993095, -97.5063089259626, 2.0000000000000013, 23.780000000000264, 63.92601314470464, -534.3811114520547, 30.710000000000267, -978.1301625287515, -925.8073701486437, -100.5008248437802, -13.595905620408418, -1305.4277744457956, -638.8153213083664, 2.0000000000000013, -398.22534133719466, 88.51537456759516, 4.969999999999958, -38.738468079461065, 121.79000000000033, -246.1988349236605, -7.989149676102199, 2.0000000000000013, -142.75203776212405, -29.180647337345707, 85.16000000000035, -6.562046556831364, -55.50336604509237, -94.82841835853827, -84.04613340925714, 27.740000000000272, -321.6319714794854, 2.0000000000000013, -73.66859917041518, -26.18963609903174, -29.14185148909578, -193.28526881840796, -160.56182873021334, -946.271337734391, -246.8110690617489, -12.065990350698588, -416.41572910525775, -31.887548904558294, -505.74945554598753, -965.9271443641587, -263.22780354004317, -26.74610941381875, -50.84451865712458, -42.54468749446696, -4.391283855197022, -15.022397019604359, -54.36347327349794, -148.63109840742112, 21.80000000000028, -299.02417074476256, -478.8800404626584, -200.41940917936486, -8.144559970920135, -137.95185618740692, -55.65677594406853, -76.04476230031271, 52.75252404512666, -262.1220495311363, -11.238664567280857, 50.908766457074236, 2.0000000000000013, -26.09441217496377, 71.3000000000006, 2.0000000000000013, -285.55599997614553, -507.06836685673915, -59.685538687492524, -65.95088519678634, -71.26092932089014, -24.70019449576473, 2.0000000000000013, 4.969999999999958, 11.584483384684903, 51.648234823941635, -23.2069940853994, -16.619042907056127, 2.0000000000000013, 78.53027179791918, -1.565638442333701, -88.35754845903433, -15.712733567488959, -136.75977315522312, 36.649999999999686, -14.575546602157958, -87.26773759625341, -56.48460084673131, 86.1500000000005, -97.5000106689863, -154.60112077773042, -109.39716296112626, -100.0292470782757, -244.30335889561292, -144.21964162405416], "policy_predator_policy_reward": [603.2050028296791, 1386.098231594027, 1.6097403835375295, 60.05410476477146, 954.9423009984038, 905.137233137183, 169.06350131191422, 316.1196769321202, 751.473266236238, 1244.6224216960156, 272.90496381580846, 798.241970190285, 833.9240846238259, 43.30708719291553, 11.411101060777156, 25.694289540221792, 61.156451297135675, 11.585267419443769, 1346.0842393118114, 1197.2388464918988, 1370.2255659353546, 1126.8821868638481, 1359.1995976461358, 1650.884135560675, 1159.1794452642725, 1409.272785148489, 829.7325283996214, 1281.6484851114099, 1405.0237489273284, 1078.3356914272376, 11.668888032392374, 402.9817805144431, 1215.9817261419332, 4.192190212408133, 1376.9754475180173, 1362.6202934909427, 1558.430830680569, 105.68198667683652, 1268.3996774833452, 1644.744286777576, 764.69353007392, 867.4667929434552, 860.2830439208757, 1074.5325399469416, 1896.5902616957258, 1785.1578249074394, 12.473925380876366, 18.758671452787404, 30.476865753583155, 169.30170331121593, 882.3085401957392, 23.51252624209043, 1276.4486646454955, 1249.6244114480398, 1451.7815687059528, 1690.4432557156401, 7.863196730327678, 16.307767683497836, 808.6254098241529, 624.4658597410445, 1311.2704050723592, 253.11247501933272, 1627.3708261523188, 1458.039410144383, 1388.4134582216673, 1517.8332253209776, 1561.80082674439, 873.4344914753152, 1313.50788900511, 1633.630689309435, 1.504096712138675, 1630.7249845222186, 1277.5549821994603, 1413.895086569437, 1291.6019501064227, 7.149353665024701, 1053.5745790202357, 908.0432432575119, 0.0, 54.98112142764833, 662.7613916835004, 748.9695374935599, 55.71747237769689, 0.0, 50.18829515370475, 0.0, 415.13769005640785, 276.7106797630153, 117.17319237484682, 197.38562173912575, 48.45327383484811, 166.55630293405702, 935.4436375813942, 10.215605002060794, 219.32094177960244, 118.69247118842044, 104.50277057817097, 2.3482461710287783, 1075.5293246616543, 1129.4751484471685, 633.806401846343, 682.7305793118463, 1345.7092427098635, 1262.2808988280415, 82.01819263134065, 33.73537447892521, 24.051186991599067, 25.760520892435817, 465.45897260817844, 473.2997790564681, 1243.1595870785943, 1204.90333231182, 102.30082484378111, 42.18073351671799, 1371.2915112162561, 1007.6484852103308, 312.8569120551532, 247.42354823226995, 37.77445557585274, 52.28552701331302, 0.0, 47.458468079460715, 218.12461810098947, 69.9533664987721, 79.385415401789, 140.3602673842277, 31.11064733734601, 11.40187579880857, 81.22895399470397, 95.88468375647926, 72.32232497247178, 89.0281614450385, 220.14989230561784, 312.098589535306, 30.324186635579817, 55.417195201044315, 30.413954151597988, 28.767533436530137, 233.4917990128516, 157.9752985357674, 233.9635834568882, 964.2954972804887, 144.41223222644504, 416.1706627317261, 538.449455545987, 33.76754890455796, 1042.76414206369, 842.2994454074343, 74.58356957099619, 50.62363721981367, 30.096094579010053, 57.20342592574552, 53.498746941175035, 39.34677362063172, 60.54749445618589, 188.1004018950776, 437.8089892815651, 468.31536757964557, 188.2454063329858, 23.93856281729797, 85.09677594406824, 139.69185618740545, 20.066010068748742, 92.69476230031356, 210.94776304479402, 267.1110118031406, 3.417522728981309, 54.88123354292574, 17.422251895211673, 24.59964483533296, 173.4589144289631, 269.2085227782596, 534.1705044336156, 483.3578265697766, 83.06555370253416, 57.74626081514407, 26.650194495765035, 26.650194495765035, 10.948061738836778, 13.962111662669447, 14.071876954497592, 41.86364232989612, 24.48904290705642, 0.0, 1.602512081444871, 10.512854562969837, 60.4797947319355, 63.61368161529093, 133.5304110991676, 81.19692054468017, 44.95444258404585, 78.8488657385768, 13.113602859730625, 50.8810358519456, 125.92001066898703, 156.33112077772884, 210.08512850866052, 160.04312317238322, 206.01056743536225, 286.5604364522101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.600232241560694, "mean_inference_ms": 1.4918559711831927, "mean_action_processing_ms": 0.26136031500710555, "mean_env_wait_ms": 0.197396885090319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00362551212310791, "StateBufferConnector_ms": 0.002833127975463867, "ViewRequirementAgentConnector_ms": 0.08156239986419678}, "num_episodes": 18, "episode_return_max": 1043.2407317945394, "episode_return_min": -1118.2286440823386, "episode_return_mean": 137.52483371275864, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.8963789172637, "num_env_steps_trained_throughput_per_sec": 445.8963789172637, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 9160.668, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9160.633, "sample_time_ms": 986.422, "learn_time_ms": 8162.452, "learn_throughput": 490.049, "synch_weights_time_ms": 11.084}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "1f15c_00000", "date": "2024-08-16_14-09-21", "timestamp": 1723797561, "time_this_iter_s": 8.973803043365479, "time_total_s": 366.8206524848938, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fe97790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 366.8206524848938, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 32.983333333333334, "ram_util_percent": 74.49166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.961714818884456, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0840257082824354, "policy_loss": -0.0040241988959707434, "vf_loss": 1.0877602215639497, "vf_explained_var": -0.001228021503125549, "kl": 0.00289685961004084, "entropy": 1.1072564020358697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0565704703015624, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5957123824843653, "policy_loss": -0.017083571896834113, "vf_loss": 1.6117418768544676, "vf_explained_var": -0.13150905528396525, "kl": 0.007027180600771611, "entropy": 1.2109423328959752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 1043.2407317945394, "episode_reward_min": -1118.2286440823386, "episode_reward_mean": 109.10044675729516, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1825.5333404172525, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 142.5968032696723, "predator_policy": 1896.5902616957258}, "policy_reward_mean": {"prey_policy": -309.82920841430285, "predator_policy": 364.37943179295047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-925.5055076395043, -269.3957009544349, 731.2217668441418, -388.32482328214024, 72.89303864295044, 150.42000000000039, 237.5129525225687, -677.4703845238555, 743.7945537584109, 46.163332604019686, 264.2699999999992, 662.6510685934035, 105.38054046325199, 0.42585028759124555, 368.9320190659471, 283.44253974826006, -139.8175985173631, -1118.2286440823386, -229.93879595630494, 110.97999999999982, 872.5135638368471, 33.54999999999996, 748.4968495361238, 25.550000000000537, 142.48000000000025, 245.87898058331868, 83.72098619356741, 39.01999999999955, 90.54052725554482, 136.4418670398017, -2.471661317749863, 1043.2407317945394, 636.4190866870849, 93.60264187425702, 20.247258184302982, 137.5177210287398, 435.0876402125904, 544.1253867130193, 30.384827896310174, 434.69690067242544, 164.05511895022707, 183.5453571567608, 130.50999999999908, 33.889999999999745, 78.99364502389616, 98.49187579880937, 115.04822514925998, -17.524065350286303, 238.3565103614374, 14.072782666208063, 3.8499999999999615, 37.61999999999967, 5.176673941237091, 132.10117550221395, 34.579999999999735, 655.9086395669231, 47.61657871986598, 40.3635491550913, 23.45965026870513, 121.81679794384394, 128.22014565379254, 3.6199999999999606, 31.180000000000465, 89.46853411387708, 204.69806074951626, 111.20752272898126, 87.22748455558182, 159.11143723107588, 450.7744254591595, 3.5999999999999615, 30.60019449576565, 41.464656786190496, 84.37676002293708, 9.869999999999923, 89.08000000000001, 20.02319432070267, 114.61755848862748, 21.960024124210882, 93.66003786494636, 30.150000000000464, 160.7018416416375, 104.04800336790956, 31.480000000000327, 16.477908373012262, 78.20421656841478, 32.91000000000006, 3.819999999999961, 65.33000000000001, 28.550000000000527, 25.838506481858225, 70.31000000000124, 345.75378591093295, 44.119999999999514, 5.562741955569037, 9.669999999999932, 14.426343984695059, 12.032255340333084, 3.8999999999999604, 62.31700489026831, 27.300000000000498], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1464.235451534737, -1125.3828734621725, -1562.8018634916878, -1619.7378017236686, -110.86208933639502, -790.0764668368369, -1203.0043593886342, -1120.136047761322, -1783.3217075429616, -1825.5333404172525, 129.70132854721277, -10.513925380876408, 81.12471716376176, -43.39033370599114, -826.8401276300589, -756.451323331626, -1311.5608585386788, -470.7176637964451, -1583.8775244113242, -1512.1839674062487, 142.5968032696723, 97.50223231650203, -87.57330952607582, -682.8668914457186, -148.17193455608037, -1310.8304050723593, -1627.4790070959052, -1457.505378913204, -1459.0261054343405, -1078.2885590423568, -1497.0996352420154, -654.69314322943, -1493.157276382542, -1593.7989004493656, -1139.388094494779, -1611.069630821917, -1529.4583104179417, -1391.9305543072608, -1287.5219501064228, 99.75064633497529, -1091.1042584409, 2.0000000000000013, -26.401121427648086, 4.969999999999958, 130.70000000000005, -793.9340796409359, -19.655658410317663, -10.51181396737901, 3.979999999999958, 88.31170484629523, -395.028643518848, -50.94074571725707, -132.37329483173988, -98.46453308866657, -129.44630293405802, -46.54327383484849, -884.8008313197159, 29.682115991805368, -232.2815459282203, 30.71000000000024, -34.88876120252748, -74.43391686442168, -1163.7637413142825, 2.0000000000000013, -701.9178944711035, 21.800000000000175, -1385.4437792643384, -1128.9437203993095, -97.5063089259626, 2.0000000000000013, 23.780000000000264, 63.92601314470464, -534.3811114520547, 30.710000000000267, -978.1301625287515, -925.8073701486437, -100.5008248437802, -13.595905620408418, -1305.4277744457956, -638.8153213083664, 2.0000000000000013, -398.22534133719466, 88.51537456759516, 4.969999999999958, -38.738468079461065, 121.79000000000033, -246.1988349236605, -7.989149676102199, 2.0000000000000013, -142.75203776212405, -29.180647337345707, 85.16000000000035, -6.562046556831364, -55.50336604509237, -94.82841835853827, -84.04613340925714, 27.740000000000272, -321.6319714794854, 2.0000000000000013, -73.66859917041518, -26.18963609903174, -29.14185148909578, -193.28526881840796, -160.56182873021334, -946.271337734391, -246.8110690617489, -12.065990350698588, -416.41572910525775, -31.887548904558294, -505.74945554598753, -965.9271443641587, -263.22780354004317, -26.74610941381875, -50.84451865712458, -42.54468749446696, -4.391283855197022, -15.022397019604359, -54.36347327349794, -148.63109840742112, 21.80000000000028, -299.02417074476256, -478.8800404626584, -200.41940917936486, -8.144559970920135, -137.95185618740692, -55.65677594406853, -76.04476230031271, 52.75252404512666, -262.1220495311363, -11.238664567280857, 50.908766457074236, 2.0000000000000013, -26.09441217496377, 71.3000000000006, 2.0000000000000013, -285.55599997614553, -507.06836685673915, -59.685538687492524, -65.95088519678634, -71.26092932089014, -24.70019449576473, 2.0000000000000013, 4.969999999999958, 11.584483384684903, 51.648234823941635, -23.2069940853994, -16.619042907056127, 2.0000000000000013, 78.53027179791918, -1.565638442333701, -88.35754845903433, -15.712733567488959, -136.75977315522312, 36.649999999999686, -14.575546602157958, -87.26773759625341, -56.48460084673131, 86.1500000000005, -97.5000106689863, -154.60112077773042, -109.39716296112626, -100.0292470782757, -244.30335889561292, -144.21964162405416, -11.560203140271012, -25.867994937868414, 10.294391552418235, -22.656916730122497, -527.5733869132865, -55.30051629674744, -228.21710847718563, -21.30152608236066, 2.0000000000000013, -49.45506705396426, -6.63945515313001, 61.3999999999998, 18.888332788316035, -46.49514796446045, -11.313325194519814, -3.6463301175280165, 68.33000000000064, -2.5476508094296317, -6.560472094063801, -641.2791214395054, -201.3318308487311, 38.925109435709885, 2.0000000000000013, -40.54247793967292, -53.68697820957437, -13.507055271786378, -24.716766206371656, -23.15544507837151, 2.0988818792274215, -24.732997453494153, -8.85301507442402, -16.11400204568757, -94.78832630572309, -22.56246251787208, -64.69039890269575, -49.06610959937584], "policy_predator_policy_reward": [1558.430830680569, 105.68198667683652, 1268.3996774833452, 1644.744286777576, 764.69353007392, 867.4667929434552, 860.2830439208757, 1074.5325399469416, 1896.5902616957258, 1785.1578249074394, 12.473925380876366, 18.758671452787404, 30.476865753583155, 169.30170331121593, 882.3085401957392, 23.51252624209043, 1276.4486646454955, 1249.6244114480398, 1451.7815687059528, 1690.4432557156401, 7.863196730327678, 16.307767683497836, 808.6254098241529, 624.4658597410445, 1311.2704050723592, 253.11247501933272, 1627.3708261523188, 1458.039410144383, 1388.4134582216673, 1517.8332253209776, 1561.80082674439, 873.4344914753152, 1313.50788900511, 1633.630689309435, 1.504096712138675, 1630.7249845222186, 1277.5549821994603, 1413.895086569437, 1291.6019501064227, 7.149353665024701, 1053.5745790202357, 908.0432432575119, 0.0, 54.98112142764833, 662.7613916835004, 748.9695374935599, 55.71747237769689, 0.0, 50.18829515370475, 0.0, 415.13769005640785, 276.7106797630153, 117.17319237484682, 197.38562173912575, 48.45327383484811, 166.55630293405702, 935.4436375813942, 10.215605002060794, 219.32094177960244, 118.69247118842044, 104.50277057817097, 2.3482461710287783, 1075.5293246616543, 1129.4751484471685, 633.806401846343, 682.7305793118463, 1345.7092427098635, 1262.2808988280415, 82.01819263134065, 33.73537447892521, 24.051186991599067, 25.760520892435817, 465.45897260817844, 473.2997790564681, 1243.1595870785943, 1204.90333231182, 102.30082484378111, 42.18073351671799, 1371.2915112162561, 1007.6484852103308, 312.8569120551532, 247.42354823226995, 37.77445557585274, 52.28552701331302, 0.0, 47.458468079460715, 218.12461810098947, 69.9533664987721, 79.385415401789, 140.3602673842277, 31.11064733734601, 11.40187579880857, 81.22895399470397, 95.88468375647926, 72.32232497247178, 89.0281614450385, 220.14989230561784, 312.098589535306, 30.324186635579817, 55.417195201044315, 30.413954151597988, 28.767533436530137, 233.4917990128516, 157.9752985357674, 233.9635834568882, 964.2954972804887, 144.41223222644504, 416.1706627317261, 538.449455545987, 33.76754890455796, 1042.76414206369, 842.2994454074343, 74.58356957099619, 50.62363721981367, 30.096094579010053, 57.20342592574552, 53.498746941175035, 39.34677362063172, 60.54749445618589, 188.1004018950776, 437.8089892815651, 468.31536757964557, 188.2454063329858, 23.93856281729797, 85.09677594406824, 139.69185618740545, 20.066010068748742, 92.69476230031356, 210.94776304479402, 267.1110118031406, 3.417522728981309, 54.88123354292574, 17.422251895211673, 24.59964483533296, 173.4589144289631, 269.2085227782596, 534.1705044336156, 483.3578265697766, 83.06555370253416, 57.74626081514407, 26.650194495765035, 26.650194495765035, 10.948061738836778, 13.962111662669447, 14.071876954497592, 41.86364232989612, 24.48904290705642, 0.0, 1.602512081444871, 10.512854562969837, 60.4797947319355, 63.61368161529093, 133.5304110991676, 81.19692054468017, 44.95444258404585, 78.8488657385768, 13.113602859730625, 50.8810358519456, 125.92001066898703, 156.33112077772884, 210.08512850866052, 160.04312317238322, 206.01056743536225, 286.5604364522101, 55.397994937868475, 13.51020314027097, 24.566916730122795, 4.273516820593984, 79.78715253667167, 581.2909672417752, 243.38710847718457, 39.04152608236093, 41.75906820136992, 9.515998852593967, 1.6112875424219055, 8.958167610708063, 7.831667211684232, 48.3251479644601, 20.821897802834414, 19.97626399107101, 0.0, 4.5276508094295895, 615.9028211497695, 377.6905582947339, 3.6448905642899136, 202.88183084872983, 3.391524297535921, 40.71369559770573, 15.447055271786336, 61.416978209574026, 11.703243026536546, 50.59531224290232, 2.0633734611057393, 32.602997453494446, 18.054002045687874, 10.813015074423978, 60.596989710645175, 119.07080400321985, 77.28039890269655, 63.7761095993755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5974061495257347, "mean_inference_ms": 1.4844389138319867, "mean_action_processing_ms": 0.2598915170510211, "mean_env_wait_ms": 0.1964351482197128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003641486167907715, "StateBufferConnector_ms": 0.0028547048568725586, "ViewRequirementAgentConnector_ms": 0.0832444429397583}, "num_episodes": 18, "episode_return_max": 1043.2407317945394, "episode_return_min": -1118.2286440823386, "episode_return_mean": 109.10044675729516, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.695510558041, "num_env_steps_trained_throughput_per_sec": 447.695510558041, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 9115.943, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9115.907, "sample_time_ms": 976.244, "learn_time_ms": 8127.922, "learn_throughput": 492.131, "synch_weights_time_ms": 11.089}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "1f15c_00000", "date": "2024-08-16_14-09-30", "timestamp": 1723797570, "time_this_iter_s": 8.937831163406372, "time_total_s": 375.75848364830017, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8e25e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 375.75848364830017, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 35.13076923076923, "ram_util_percent": 74.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.852586271972568, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9177292814803502, "policy_loss": -0.009384185286416184, "vf_loss": 0.9265861572648483, "vf_explained_var": 0.0023813061928622935, "kl": 0.01054619318248698, "entropy": 1.0715834166007068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9908138549044019, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.20532617861474, "policy_loss": -0.007933926420463693, "vf_loss": 1.2121920427001973, "vf_explained_var": -0.0740070401360749, "kl": 0.007120421497633668, "entropy": 1.2548058781043563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 1043.2407317945394, "episode_reward_min": -17.524065350286303, "episode_reward_mean": 109.45780605104729, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1385.4437792643384, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 130.70000000000005, "predator_policy": 1371.2915112162561}, "policy_reward_mean": {"prey_policy": -114.56384728800661, "predator_policy": 169.29275031353015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [748.4968495361238, 25.550000000000537, 142.48000000000025, 245.87898058331868, 83.72098619356741, 39.01999999999955, 90.54052725554482, 136.4418670398017, -2.471661317749863, 1043.2407317945394, 636.4190866870849, 93.60264187425702, 20.247258184302982, 137.5177210287398, 435.0876402125904, 544.1253867130193, 30.384827896310174, 434.69690067242544, 164.05511895022707, 183.5453571567608, 130.50999999999908, 33.889999999999745, 78.99364502389616, 98.49187579880937, 115.04822514925998, -17.524065350286303, 238.3565103614374, 14.072782666208063, 3.8499999999999615, 37.61999999999967, 5.176673941237091, 132.10117550221395, 34.579999999999735, 655.9086395669231, 47.61657871986598, 40.3635491550913, 23.45965026870513, 121.81679794384394, 128.22014565379254, 3.6199999999999606, 31.180000000000465, 89.46853411387708, 204.69806074951626, 111.20752272898126, 87.22748455558182, 159.11143723107588, 450.7744254591595, 3.5999999999999615, 30.60019449576565, 41.464656786190496, 84.37676002293708, 9.869999999999923, 89.08000000000001, 20.02319432070267, 114.61755848862748, 21.960024124210882, 93.66003786494636, 30.150000000000464, 160.7018416416375, 104.04800336790956, 31.480000000000327, 16.477908373012262, 78.20421656841478, 32.91000000000006, 3.819999999999961, 65.33000000000001, 28.550000000000527, 25.838506481858225, 70.31000000000124, 345.75378591093295, 44.119999999999514, 5.562741955569037, 9.669999999999932, 14.426343984695059, 12.032255340333084, 3.8999999999999604, 62.31700489026831, 27.300000000000498, 78.07365273020238, 6.540928725057789, 42.53718315396187, 23.283903821326493, 75.26923217963778, 26.27175212794336, 26.538875031589352, 57.62894770862436, 112.26193009949438, 35.47999999999939, 73.17000000000141, 77.33230673231674, 32.51000000000034, -3.6078325743954487, 12.859999999999923, 37.619999999999365, 60.40058046614671, 8.889999999999919, 84.98000000000118, 63.701259971817315, 28.580000000000513, 10.882980612936487], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [130.70000000000005, -793.9340796409359, -19.655658410317663, -10.51181396737901, 3.979999999999958, 88.31170484629523, -395.028643518848, -50.94074571725707, -132.37329483173988, -98.46453308866657, -129.44630293405802, -46.54327383484849, -884.8008313197159, 29.682115991805368, -232.2815459282203, 30.71000000000024, -34.88876120252748, -74.43391686442168, -1163.7637413142825, 2.0000000000000013, -701.9178944711035, 21.800000000000175, -1385.4437792643384, -1128.9437203993095, -97.5063089259626, 2.0000000000000013, 23.780000000000264, 63.92601314470464, -534.3811114520547, 30.710000000000267, -978.1301625287515, -925.8073701486437, -100.5008248437802, -13.595905620408418, -1305.4277744457956, -638.8153213083664, 2.0000000000000013, -398.22534133719466, 88.51537456759516, 4.969999999999958, -38.738468079461065, 121.79000000000033, -246.1988349236605, -7.989149676102199, 2.0000000000000013, -142.75203776212405, -29.180647337345707, 85.16000000000035, -6.562046556831364, -55.50336604509237, -94.82841835853827, -84.04613340925714, 27.740000000000272, -321.6319714794854, 2.0000000000000013, -73.66859917041518, -26.18963609903174, -29.14185148909578, -193.28526881840796, -160.56182873021334, -946.271337734391, -246.8110690617489, -12.065990350698588, -416.41572910525775, -31.887548904558294, -505.74945554598753, -965.9271443641587, -263.22780354004317, -26.74610941381875, -50.84451865712458, -42.54468749446696, -4.391283855197022, -15.022397019604359, -54.36347327349794, -148.63109840742112, 21.80000000000028, -299.02417074476256, -478.8800404626584, -200.41940917936486, -8.144559970920135, -137.95185618740692, -55.65677594406853, -76.04476230031271, 52.75252404512666, -262.1220495311363, -11.238664567280857, 50.908766457074236, 2.0000000000000013, -26.09441217496377, 71.3000000000006, 2.0000000000000013, -285.55599997614553, -507.06836685673915, -59.685538687492524, -65.95088519678634, -71.26092932089014, -24.70019449576473, 2.0000000000000013, 4.969999999999958, 11.584483384684903, 51.648234823941635, -23.2069940853994, -16.619042907056127, 2.0000000000000013, 78.53027179791918, -1.565638442333701, -88.35754845903433, -15.712733567488959, -136.75977315522312, 36.649999999999686, -14.575546602157958, -87.26773759625341, -56.48460084673131, 86.1500000000005, -97.5000106689863, -154.60112077773042, -109.39716296112626, -100.0292470782757, -244.30335889561292, -144.21964162405416, -11.560203140271012, -25.867994937868414, 10.294391552418235, -22.656916730122497, -527.5733869132865, -55.30051629674744, -228.21710847718563, -21.30152608236066, 2.0000000000000013, -49.45506705396426, -6.63945515313001, 61.3999999999998, 18.888332788316035, -46.49514796446045, -11.313325194519814, -3.6463301175280165, 68.33000000000064, -2.5476508094296317, -6.560472094063801, -641.2791214395054, -201.3318308487311, 38.925109435709885, 2.0000000000000013, -40.54247793967292, -53.68697820957437, -13.507055271786378, -24.716766206371656, -23.15544507837151, 2.0988818792274215, -24.732997453494153, -8.85301507442402, -16.11400204568757, -94.78832630572309, -22.56246251787208, -64.69039890269575, -49.06610959937584, -27.315656550777344, -56.400849314794165, -4.19387277028694, -14.69349182522951, 26.75000000000027, -86.3416777850417, -112.12011153719592, -31.084193387373013, -51.4846291369917, -31.756960801392143, 2.0000000000000013, -29.781737751922147, 11.05646170368296, -12.32008124350733, 2.0000000000000013, -3.397136856079417, 34.77946622735894, 0.3483705579398865, -42.605747159676966, 7.879622575636265, 43.4694533383174, 1.8087564130940135, -1.8266765662206939, -80.81535689188786, -56.35928399691886, 24.123203446681035, -56.36781382265915, -33.87849764787803, 1.9714090608598962, 2.0000000000000013, 0.12448837801062247, 29.96885463097431, -18.592614442312993, 12.742494655928322, -4.912063899147725, -5.394437172980697, -5.8783782786615095, 27.25923714696237, 3.822339878141007, -44.29034303842982, -25.302871116355945, 1.4983016015745834, -26.223697732330038, -47.538518100908085], "policy_predator_policy_reward": [662.7613916835004, 748.9695374935599, 55.71747237769689, 0.0, 50.18829515370475, 0.0, 415.13769005640785, 276.7106797630153, 117.17319237484682, 197.38562173912575, 48.45327383484811, 166.55630293405702, 935.4436375813942, 10.215605002060794, 219.32094177960244, 118.69247118842044, 104.50277057817097, 2.3482461710287783, 1075.5293246616543, 1129.4751484471685, 633.806401846343, 682.7305793118463, 1345.7092427098635, 1262.2808988280415, 82.01819263134065, 33.73537447892521, 24.051186991599067, 25.760520892435817, 465.45897260817844, 473.2997790564681, 1243.1595870785943, 1204.90333231182, 102.30082484378111, 42.18073351671799, 1371.2915112162561, 1007.6484852103308, 312.8569120551532, 247.42354823226995, 37.77445557585274, 52.28552701331302, 0.0, 47.458468079460715, 218.12461810098947, 69.9533664987721, 79.385415401789, 140.3602673842277, 31.11064733734601, 11.40187579880857, 81.22895399470397, 95.88468375647926, 72.32232497247178, 89.0281614450385, 220.14989230561784, 312.098589535306, 30.324186635579817, 55.417195201044315, 30.413954151597988, 28.767533436530137, 233.4917990128516, 157.9752985357674, 233.9635834568882, 964.2954972804887, 144.41223222644504, 416.1706627317261, 538.449455545987, 33.76754890455796, 1042.76414206369, 842.2994454074343, 74.58356957099619, 50.62363721981367, 30.096094579010053, 57.20342592574552, 53.498746941175035, 39.34677362063172, 60.54749445618589, 188.1004018950776, 437.8089892815651, 468.31536757964557, 188.2454063329858, 23.93856281729797, 85.09677594406824, 139.69185618740545, 20.066010068748742, 92.69476230031356, 210.94776304479402, 267.1110118031406, 3.417522728981309, 54.88123354292574, 17.422251895211673, 24.59964483533296, 173.4589144289631, 269.2085227782596, 534.1705044336156, 483.3578265697766, 83.06555370253416, 57.74626081514407, 26.650194495765035, 26.650194495765035, 10.948061738836778, 13.962111662669447, 14.071876954497592, 41.86364232989612, 24.48904290705642, 0.0, 1.602512081444871, 10.512854562969837, 60.4797947319355, 63.61368161529093, 133.5304110991676, 81.19692054468017, 44.95444258404585, 78.8488657385768, 13.113602859730625, 50.8810358519456, 125.92001066898703, 156.33112077772884, 210.08512850866052, 160.04312317238322, 206.01056743536225, 286.5604364522101, 55.397994937868475, 13.51020314027097, 24.566916730122795, 4.273516820593984, 79.78715253667167, 581.2909672417752, 243.38710847718457, 39.04152608236093, 41.75906820136992, 9.515998852593967, 1.6112875424219055, 8.958167610708063, 7.831667211684232, 48.3251479644601, 20.821897802834414, 19.97626399107101, 0.0, 4.5276508094295895, 615.9028211497695, 377.6905582947339, 3.6448905642899136, 202.88183084872983, 3.391524297535921, 40.71369559770573, 15.447055271786336, 61.416978209574026, 11.703243026536546, 50.59531224290232, 2.0633734611057393, 32.602997453494446, 18.054002045687874, 10.813015074423978, 60.596989710645175, 119.07080400321985, 77.28039890269655, 63.7761095993755, 82.8976491222165, 78.89250947355558, 7.824801495344769, 17.603491825229575, 97.61545093644551, 4.513410002559347, 61.564446643675005, 104.92376210222073, 77.84072136425107, 80.67010075376827, 11.501752127942797, 42.551737751922424, 21.736867335761893, 6.06562723565121, 14.10894770862498, 44.91713685607938, 38.733559541553085, 38.400533772640834, 25.740377424363707, 44.465747159676596, 14.971243586905986, 12.920546661682327, 90.4474117353264, 69.52692845509824, 2.6291000187857074, 62.11698053145201, 1.8439877462750884, 84.79449114986605, 0.0, 8.888590939140103, 1.865511621989379, 5.6611453690259435, 9.93584058103334, 56.31485967149893, 7.374437172980655, 11.822063899147684, 0.0, 63.599141131699284, 63.105113832155176, 41.064149299951275, 21.817061441911523, 30.567508072870147, 6.0829806129365664, 78.56221583323801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5944983264164028, "mean_inference_ms": 1.4762288136888926, "mean_action_processing_ms": 0.2578176466329374, "mean_env_wait_ms": 0.19524221747821435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036149024963378906, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.08271288871765137}, "num_episodes": 22, "episode_return_max": 1043.2407317945394, "episode_return_min": -17.524065350286303, "episode_return_mean": 109.45780605104729, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.63082581008734, "num_env_steps_trained_throughput_per_sec": 452.63082581008734, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 9075.177, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9075.142, "sample_time_ms": 978.22, "learn_time_ms": 8085.262, "learn_throughput": 494.727, "synch_weights_time_ms": 10.986}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "1f15c_00000", "date": "2024-08-16_14-09-39", "timestamp": 1723797579, "time_this_iter_s": 8.840219974517822, "time_total_s": 384.598703622818, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8e2e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 384.598703622818, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 30.9076923076923, "ram_util_percent": 74.46923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8799671751560357, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7327705953171644, "policy_loss": -0.010454663333221877, "vf_loss": 0.7427719147668944, "vf_explained_var": 0.013605897168003062, "kl": 0.009066897810798908, "entropy": 1.0636729559255025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.285495209599298, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.456721619370753, "policy_loss": -0.0088190921804641, "vf_loss": 1.464610131045498, "vf_explained_var": 0.15094140496834246, "kl": 0.006203876659088821, "entropy": 1.2836079833999512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 655.9086395669231, "episode_reward_min": -17.524065350286303, "episode_reward_mean": 65.7779148436182, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -965.9271443641587, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 107.37793498814013, "predator_policy": 1042.76414206369}, "policy_reward_mean": {"prey_policy": -59.86373138631569, "predator_policy": 92.75268880812473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.49187579880937, 115.04822514925998, -17.524065350286303, 238.3565103614374, 14.072782666208063, 3.8499999999999615, 37.61999999999967, 5.176673941237091, 132.10117550221395, 34.579999999999735, 655.9086395669231, 47.61657871986598, 40.3635491550913, 23.45965026870513, 121.81679794384394, 128.22014565379254, 3.6199999999999606, 31.180000000000465, 89.46853411387708, 204.69806074951626, 111.20752272898126, 87.22748455558182, 159.11143723107588, 450.7744254591595, 3.5999999999999615, 30.60019449576565, 41.464656786190496, 84.37676002293708, 9.869999999999923, 89.08000000000001, 20.02319432070267, 114.61755848862748, 21.960024124210882, 93.66003786494636, 30.150000000000464, 160.7018416416375, 104.04800336790956, 31.480000000000327, 16.477908373012262, 78.20421656841478, 32.91000000000006, 3.819999999999961, 65.33000000000001, 28.550000000000527, 25.838506481858225, 70.31000000000124, 345.75378591093295, 44.119999999999514, 5.562741955569037, 9.669999999999932, 14.426343984695059, 12.032255340333084, 3.8999999999999604, 62.31700489026831, 27.300000000000498, 78.07365273020238, 6.540928725057789, 42.53718315396187, 23.283903821326493, 75.26923217963778, 26.27175212794336, 26.538875031589352, 57.62894770862436, 112.26193009949438, 35.47999999999939, 73.17000000000141, 77.33230673231674, 32.51000000000034, -3.6078325743954487, 12.859999999999923, 37.619999999999365, 60.40058046614671, 8.889999999999919, 84.98000000000118, 63.701259971817315, 28.580000000000513, 10.882980612936487, 31.675933086978358, 11.70999999999994, 61.43042937035798, 19.851496944260855, 154.44583946276433, 20.430000000000454, 3.789999999999962, 3.5399999999999667, 13.479186646601853, 130.7043178634197, 48.47792132482845, 47.87547882080094, 200.91200708746922, 69.64931819566817, 41.489999999999384, 28.373308058065774, 12.78673754620764, 69.32000000000134, 25.2600000000004, 19.770000000000557, 22.340000000000458, 66.77277033442685, 3.8999999999999604], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.180647337345707, 85.16000000000035, -6.562046556831364, -55.50336604509237, -94.82841835853827, -84.04613340925714, 27.740000000000272, -321.6319714794854, 2.0000000000000013, -73.66859917041518, -26.18963609903174, -29.14185148909578, -193.28526881840796, -160.56182873021334, -946.271337734391, -246.8110690617489, -12.065990350698588, -416.41572910525775, -31.887548904558294, -505.74945554598753, -965.9271443641587, -263.22780354004317, -26.74610941381875, -50.84451865712458, -42.54468749446696, -4.391283855197022, -15.022397019604359, -54.36347327349794, -148.63109840742112, 21.80000000000028, -299.02417074476256, -478.8800404626584, -200.41940917936486, -8.144559970920135, -137.95185618740692, -55.65677594406853, -76.04476230031271, 52.75252404512666, -262.1220495311363, -11.238664567280857, 50.908766457074236, 2.0000000000000013, -26.09441217496377, 71.3000000000006, 2.0000000000000013, -285.55599997614553, -507.06836685673915, -59.685538687492524, -65.95088519678634, -71.26092932089014, -24.70019449576473, 2.0000000000000013, 4.969999999999958, 11.584483384684903, 51.648234823941635, -23.2069940853994, -16.619042907056127, 2.0000000000000013, 78.53027179791918, -1.565638442333701, -88.35754845903433, -15.712733567488959, -136.75977315522312, 36.649999999999686, -14.575546602157958, -87.26773759625341, -56.48460084673131, 86.1500000000005, -97.5000106689863, -154.60112077773042, -109.39716296112626, -100.0292470782757, -244.30335889561292, -144.21964162405416, -11.560203140271012, -25.867994937868414, 10.294391552418235, -22.656916730122497, -527.5733869132865, -55.30051629674744, -228.21710847718563, -21.30152608236066, 2.0000000000000013, -49.45506705396426, -6.63945515313001, 61.3999999999998, 18.888332788316035, -46.49514796446045, -11.313325194519814, -3.6463301175280165, 68.33000000000064, -2.5476508094296317, -6.560472094063801, -641.2791214395054, -201.3318308487311, 38.925109435709885, 2.0000000000000013, -40.54247793967292, -53.68697820957437, -13.507055271786378, -24.716766206371656, -23.15544507837151, 2.0988818792274215, -24.732997453494153, -8.85301507442402, -16.11400204568757, -94.78832630572309, -22.56246251787208, -64.69039890269575, -49.06610959937584, -27.315656550777344, -56.400849314794165, -4.19387277028694, -14.69349182522951, 26.75000000000027, -86.3416777850417, -112.12011153719592, -31.084193387373013, -51.4846291369917, -31.756960801392143, 2.0000000000000013, -29.781737751922147, 11.05646170368296, -12.32008124350733, 2.0000000000000013, -3.397136856079417, 34.77946622735894, 0.3483705579398865, -42.605747159676966, 7.879622575636265, 43.4694533383174, 1.8087564130940135, -1.8266765662206939, -80.81535689188786, -56.35928399691886, 24.123203446681035, -56.36781382265915, -33.87849764787803, 1.9714090608598962, 2.0000000000000013, 0.12448837801062247, 29.96885463097431, -18.592614442312993, 12.742494655928322, -4.912063899147725, -5.394437172980697, -5.8783782786615095, 27.25923714696237, 3.822339878141007, -44.29034303842982, -25.302871116355945, 1.4983016015745834, -26.223697732330038, -47.538518100908085, -46.914253728616686, -9.383439944641498, -30.44666593313318, -20.103590804841588, -81.79530863060839, 25.760000000000275, 9.497549703878377, 2.260277657573513, -82.25226958061522, 2.0000000000000013, -3.6675210496986663, -147.9670274288709, -2.6861664708456017, -99.30943821501238, -52.93900517620794, -97.44124051068289, -14.008011246818846, -155.76866398572085, 8.929999999999959, 91.24166147576126, 10.417889741481316, -38.382105919676874, -106.24457376336285, 25.760000000000275, 107.37793498814013, 16.78944309160756, -6.04000771750699, 25.379998096620504, 27.32796122556073, -20.63960884227992, -30.516539456080157, 16.85000000000012, -15.947873360011766, 2.0000000000000013, 54.46999999999973, 10.453990457409569, -147.09180675030098, -2.644076055270217, -7.737826460475754, 2.7745137671626288, -61.98389944761166, -153.33470478670475, -76.45350313634881, -26.064414507452984, -6.928898879886697, -19.141537287601157], "policy_predator_policy_reward": [31.11064733734601, 11.40187579880857, 81.22895399470397, 95.88468375647926, 72.32232497247178, 89.0281614450385, 220.14989230561784, 312.098589535306, 30.324186635579817, 55.417195201044315, 30.413954151597988, 28.767533436530137, 233.4917990128516, 157.9752985357674, 233.9635834568882, 964.2954972804887, 144.41223222644504, 416.1706627317261, 538.449455545987, 33.76754890455796, 1042.76414206369, 842.2994454074343, 74.58356957099619, 50.62363721981367, 30.096094579010053, 57.20342592574552, 53.498746941175035, 39.34677362063172, 60.54749445618589, 188.1004018950776, 437.8089892815651, 468.31536757964557, 188.2454063329858, 23.93856281729797, 85.09677594406824, 139.69185618740545, 20.066010068748742, 92.69476230031356, 210.94776304479402, 267.1110118031406, 3.417522728981309, 54.88123354292574, 17.422251895211673, 24.59964483533296, 173.4589144289631, 269.2085227782596, 534.1705044336156, 483.3578265697766, 83.06555370253416, 57.74626081514407, 26.650194495765035, 26.650194495765035, 10.948061738836778, 13.962111662669447, 14.071876954497592, 41.86364232989612, 24.48904290705642, 0.0, 1.602512081444871, 10.512854562969837, 60.4797947319355, 63.61368161529093, 133.5304110991676, 81.19692054468017, 44.95444258404585, 78.8488657385768, 13.113602859730625, 50.8810358519456, 125.92001066898703, 156.33112077772884, 210.08512850866052, 160.04312317238322, 206.01056743536225, 286.5604364522101, 55.397994937868475, 13.51020314027097, 24.566916730122795, 4.273516820593984, 79.78715253667167, 581.2909672417752, 243.38710847718457, 39.04152608236093, 41.75906820136992, 9.515998852593967, 1.6112875424219055, 8.958167610708063, 7.831667211684232, 48.3251479644601, 20.821897802834414, 19.97626399107101, 0.0, 4.5276508094295895, 615.9028211497695, 377.6905582947339, 3.6448905642899136, 202.88183084872983, 3.391524297535921, 40.71369559770573, 15.447055271786336, 61.416978209574026, 11.703243026536546, 50.59531224290232, 2.0633734611057393, 32.602997453494446, 18.054002045687874, 10.813015074423978, 60.596989710645175, 119.07080400321985, 77.28039890269655, 63.7761095993755, 82.8976491222165, 78.89250947355558, 7.824801495344769, 17.603491825229575, 97.61545093644551, 4.513410002559347, 61.564446643675005, 104.92376210222073, 77.84072136425107, 80.67010075376827, 11.501752127942797, 42.551737751922424, 21.736867335761893, 6.06562723565121, 14.10894770862498, 44.91713685607938, 38.733559541553085, 38.400533772640834, 25.740377424363707, 44.465747159676596, 14.971243586905986, 12.920546661682327, 90.4474117353264, 69.52692845509824, 2.6291000187857074, 62.11698053145201, 1.8439877462750884, 84.79449114986605, 0.0, 8.888590939140103, 1.865511621989379, 5.6611453690259435, 9.93584058103334, 56.31485967149893, 7.374437172980655, 11.822063899147684, 0.0, 63.599141131699284, 63.105113832155176, 41.064149299951275, 21.817061441911523, 30.567508072870147, 6.0829806129365664, 78.56221583323801, 36.91406309778374, 51.05956366245188, 40.2466659331333, 22.013590804841886, 83.62530863060933, 33.8404293703587, 2.433947240381847, 5.659722342426483, 141.35464755151597, 93.34346149186536, 166.4270274288696, 5.637521049698625, 101.1194382150133, 4.6661664708455595, 53.208834456047846, 100.71141123084354, 121.42401074160927, 61.831851137531366, 28.44833852423899, 2.0843178634202806, 41.30082753208781, 35.141309970936504, 16.186969753325204, 112.17308283083996, 35.40339272634618, 41.341236281376354, 25.079137265285656, 25.230190551267718, 12.242038774439516, 22.55960884228022, 3.663308058065393, 38.376539456080316, 15.175021991222419, 11.559588914997363, 4.396009542590392, 0.0, 170.3718067502998, 4.624076055270175, 15.025486232837356, 9.707826460475712, 63.84389944761129, 173.8147047867034, 39.1802062831774, 130.11048169505102, 8.898898879886655, 21.07153728760146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.591478773791982, "mean_inference_ms": 1.4667491604819383, "mean_action_processing_ms": 0.256544611803689, "mean_env_wait_ms": 0.19455147879143578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036121606826782227, "StateBufferConnector_ms": 0.00281369686126709, "ViewRequirementAgentConnector_ms": 0.08222031593322754}, "num_episodes": 23, "episode_return_max": 655.9086395669231, "episode_return_min": -17.524065350286303, "episode_return_mean": 65.7779148436182, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 451.5066151447476, "num_env_steps_trained_throughput_per_sec": 451.5066151447476, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 9008.84, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9008.804, "sample_time_ms": 973.0, "learn_time_ms": 8024.201, "learn_throughput": 498.492, "synch_weights_time_ms": 10.93}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "1f15c_00000", "date": "2024-08-16_14-09-48", "timestamp": 1723797588, "time_this_iter_s": 8.863030910491943, "time_total_s": 393.46173453330994, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fe97af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 393.46173453330994, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 32.30833333333333, "ram_util_percent": 74.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9073444759325375, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8849454945988126, "policy_loss": -0.006214669737817039, "vf_loss": 0.890882615390278, "vf_explained_var": 0.016077939574680632, "kl": 0.005550942244651198, "entropy": 1.028302577469084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.313224615432598, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1380407865716036, "policy_loss": -0.009810445641374423, "vf_loss": 3.146511937953808, "vf_explained_var": 0.5489770630995433, "kl": 0.008928624602177141, "entropy": 1.3184381362622377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 450.7744254591595, "episode_reward_min": -3.6078325743954487, "episode_reward_mean": 68.70982935950622, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -641.2791214395054, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 112.78486021448941, "predator_policy": 615.9028211497695}, "policy_reward_mean": {"prey_policy": -27.379260907190357, "predator_policy": 61.7341755869434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.46853411387708, 204.69806074951626, 111.20752272898126, 87.22748455558182, 159.11143723107588, 450.7744254591595, 3.5999999999999615, 30.60019449576565, 41.464656786190496, 84.37676002293708, 9.869999999999923, 89.08000000000001, 20.02319432070267, 114.61755848862748, 21.960024124210882, 93.66003786494636, 30.150000000000464, 160.7018416416375, 104.04800336790956, 31.480000000000327, 16.477908373012262, 78.20421656841478, 32.91000000000006, 3.819999999999961, 65.33000000000001, 28.550000000000527, 25.838506481858225, 70.31000000000124, 345.75378591093295, 44.119999999999514, 5.562741955569037, 9.669999999999932, 14.426343984695059, 12.032255340333084, 3.8999999999999604, 62.31700489026831, 27.300000000000498, 78.07365273020238, 6.540928725057789, 42.53718315396187, 23.283903821326493, 75.26923217963778, 26.27175212794336, 26.538875031589352, 57.62894770862436, 112.26193009949438, 35.47999999999939, 73.17000000000141, 77.33230673231674, 32.51000000000034, -3.6078325743954487, 12.859999999999923, 37.619999999999365, 60.40058046614671, 8.889999999999919, 84.98000000000118, 63.701259971817315, 28.580000000000513, 10.882980612936487, 31.675933086978358, 11.70999999999994, 61.43042937035798, 19.851496944260855, 154.44583946276433, 20.430000000000454, 3.789999999999962, 3.5399999999999667, 13.479186646601853, 130.7043178634197, 48.47792132482845, 47.87547882080094, 200.91200708746922, 69.64931819566817, 41.489999999999384, 28.373308058065774, 12.78673754620764, 69.32000000000134, 25.2600000000004, 19.770000000000557, 22.340000000000458, 66.77277033442685, 3.8999999999999604, 27.68998302216474, 86.06521286582432, 156.29000000000002, 194.7717862574503, 155.30000000000007, 171.8215970826902, 52.998853709924276, 64.7208380128444, 12.64015180831142, 86.06226270433659, 99.29748573008784, 33.76487410645057, 140.47999999999976, 257.14493574282875, 186.89999999999935, 104.79000000000049, 137.06943495002278, 39.34257497296698], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-76.04476230031271, 52.75252404512666, -262.1220495311363, -11.238664567280857, 50.908766457074236, 2.0000000000000013, -26.09441217496377, 71.3000000000006, 2.0000000000000013, -285.55599997614553, -507.06836685673915, -59.685538687492524, -65.95088519678634, -71.26092932089014, -24.70019449576473, 2.0000000000000013, 4.969999999999958, 11.584483384684903, 51.648234823941635, -23.2069940853994, -16.619042907056127, 2.0000000000000013, 78.53027179791918, -1.565638442333701, -88.35754845903433, -15.712733567488959, -136.75977315522312, 36.649999999999686, -14.575546602157958, -87.26773759625341, -56.48460084673131, 86.1500000000005, -97.5000106689863, -154.60112077773042, -109.39716296112626, -100.0292470782757, -244.30335889561292, -144.21964162405416, -11.560203140271012, -25.867994937868414, 10.294391552418235, -22.656916730122497, -527.5733869132865, -55.30051629674744, -228.21710847718563, -21.30152608236066, 2.0000000000000013, -49.45506705396426, -6.63945515313001, 61.3999999999998, 18.888332788316035, -46.49514796446045, -11.313325194519814, -3.6463301175280165, 68.33000000000064, -2.5476508094296317, -6.560472094063801, -641.2791214395054, -201.3318308487311, 38.925109435709885, 2.0000000000000013, -40.54247793967292, -53.68697820957437, -13.507055271786378, -24.716766206371656, -23.15544507837151, 2.0988818792274215, -24.732997453494153, -8.85301507442402, -16.11400204568757, -94.78832630572309, -22.56246251787208, -64.69039890269575, -49.06610959937584, -27.315656550777344, -56.400849314794165, -4.19387277028694, -14.69349182522951, 26.75000000000027, -86.3416777850417, -112.12011153719592, -31.084193387373013, -51.4846291369917, -31.756960801392143, 2.0000000000000013, -29.781737751922147, 11.05646170368296, -12.32008124350733, 2.0000000000000013, -3.397136856079417, 34.77946622735894, 0.3483705579398865, -42.605747159676966, 7.879622575636265, 43.4694533383174, 1.8087564130940135, -1.8266765662206939, -80.81535689188786, -56.35928399691886, 24.123203446681035, -56.36781382265915, -33.87849764787803, 1.9714090608598962, 2.0000000000000013, 0.12448837801062247, 29.96885463097431, -18.592614442312993, 12.742494655928322, -4.912063899147725, -5.394437172980697, -5.8783782786615095, 27.25923714696237, 3.822339878141007, -44.29034303842982, -25.302871116355945, 1.4983016015745834, -26.223697732330038, -47.538518100908085, -46.914253728616686, -9.383439944641498, -30.44666593313318, -20.103590804841588, -81.79530863060839, 25.760000000000275, 9.497549703878377, 2.260277657573513, -82.25226958061522, 2.0000000000000013, -3.6675210496986663, -147.9670274288709, -2.6861664708456017, -99.30943821501238, -52.93900517620794, -97.44124051068289, -14.008011246818846, -155.76866398572085, 8.929999999999959, 91.24166147576126, 10.417889741481316, -38.382105919676874, -106.24457376336285, 25.760000000000275, 107.37793498814013, 16.78944309160756, -6.04000771750699, 25.379998096620504, 27.32796122556073, -20.63960884227992, -30.516539456080157, 16.85000000000012, -15.947873360011766, 2.0000000000000013, 54.46999999999973, 10.453990457409569, -147.09180675030098, -2.644076055270217, -7.737826460475754, 2.7745137671626288, -61.98389944761166, -153.33470478670475, -76.45350313634881, -26.064414507452984, -6.928898879886697, -19.141537287601157, -48.5000225322141, -2.623557759494826, 82.19000000000058, -7.388373581069642, 31.192576584089995, -6.453837285642491, 4.969999999999958, 103.4931527847508, 4.763088880761827, 81.67421512914892, 2.0000000000000013, 98.38785098019176, 21.89845901357667, 12.468853709924867, 54.15230969473821, -32.83246055261445, 2.0000000000000013, -16.92109797879433, 21.800000000000225, 50.11719509437815, 22.935134746051684, 53.479999999999706, -15.277159534223527, -215.1711806201261, -5.715574394610025, 112.78486021448941, 53.70366681359636, 47.77891467797611, 105.81939827998362, 13.451724664004113, 32.42850485858694, 5.529076245521666, -63.910400960356675, 92.08999999999988, 23.199956586654174, -71.4974046450816], "policy_predator_policy_reward": [20.066010068748742, 92.69476230031356, 210.94776304479402, 267.1110118031406, 3.417522728981309, 54.88123354292574, 17.422251895211673, 24.59964483533296, 173.4589144289631, 269.2085227782596, 534.1705044336156, 483.3578265697766, 83.06555370253416, 57.74626081514407, 26.650194495765035, 26.650194495765035, 10.948061738836778, 13.962111662669447, 14.071876954497592, 41.86364232989612, 24.48904290705642, 0.0, 1.602512081444871, 10.512854562969837, 60.4797947319355, 63.61368161529093, 133.5304110991676, 81.19692054468017, 44.95444258404585, 78.8488657385768, 13.113602859730625, 50.8810358519456, 125.92001066898703, 156.33112077772884, 210.08512850866052, 160.04312317238322, 206.01056743536225, 286.5604364522101, 55.397994937868475, 13.51020314027097, 24.566916730122795, 4.273516820593984, 79.78715253667167, 581.2909672417752, 243.38710847718457, 39.04152608236093, 41.75906820136992, 9.515998852593967, 1.6112875424219055, 8.958167610708063, 7.831667211684232, 48.3251479644601, 20.821897802834414, 19.97626399107101, 0.0, 4.5276508094295895, 615.9028211497695, 377.6905582947339, 3.6448905642899136, 202.88183084872983, 3.391524297535921, 40.71369559770573, 15.447055271786336, 61.416978209574026, 11.703243026536546, 50.59531224290232, 2.0633734611057393, 32.602997453494446, 18.054002045687874, 10.813015074423978, 60.596989710645175, 119.07080400321985, 77.28039890269655, 63.7761095993755, 82.8976491222165, 78.89250947355558, 7.824801495344769, 17.603491825229575, 97.61545093644551, 4.513410002559347, 61.564446643675005, 104.92376210222073, 77.84072136425107, 80.67010075376827, 11.501752127942797, 42.551737751922424, 21.736867335761893, 6.06562723565121, 14.10894770862498, 44.91713685607938, 38.733559541553085, 38.400533772640834, 25.740377424363707, 44.465747159676596, 14.971243586905986, 12.920546661682327, 90.4474117353264, 69.52692845509824, 2.6291000187857074, 62.11698053145201, 1.8439877462750884, 84.79449114986605, 0.0, 8.888590939140103, 1.865511621989379, 5.6611453690259435, 9.93584058103334, 56.31485967149893, 7.374437172980655, 11.822063899147684, 0.0, 63.599141131699284, 63.105113832155176, 41.064149299951275, 21.817061441911523, 30.567508072870147, 6.0829806129365664, 78.56221583323801, 36.91406309778374, 51.05956366245188, 40.2466659331333, 22.013590804841886, 83.62530863060933, 33.8404293703587, 2.433947240381847, 5.659722342426483, 141.35464755151597, 93.34346149186536, 166.4270274288696, 5.637521049698625, 101.1194382150133, 4.6661664708455595, 53.208834456047846, 100.71141123084354, 121.42401074160927, 61.831851137531366, 28.44833852423899, 2.0843178634202806, 41.30082753208781, 35.141309970936504, 16.186969753325204, 112.17308283083996, 35.40339272634618, 41.341236281376354, 25.079137265285656, 25.230190551267718, 12.242038774439516, 22.55960884228022, 3.663308058065393, 38.376539456080316, 15.175021991222419, 11.559588914997363, 4.396009542590392, 0.0, 170.3718067502998, 4.624076055270175, 15.025486232837356, 9.707826460475712, 63.84389944761129, 173.8147047867034, 39.1802062831774, 130.11048169505102, 8.898898879886655, 21.07153728760146, 47.57013795716976, 31.243425356702918, 9.3583735810696, 1.905212865823098, 8.423837285642449, 123.12742341591016, 27.60178625745064, 58.706847215249184, 64.71578487085111, 4.1469111192381325, 60.862149019808314, 10.571597082690484, 18.63154098642357, 0.0, 10.938311489284738, 32.46267738143531, 19.82109797879462, 7.740151808311503, 7.15856895500135, 6.986498654955367, 5.277485730086301, 17.604865253948557, 232.68118062012474, 31.532033640674435, 25.725139785510702, 7.685574394609983, 57.473912971431666, 98.18844127982568, 29.71060172001641, 37.91827533599586, 5.350923754478297, 61.48149514141288, 55.87007599020303, 53.01975992017636, 47.56805254719842, 40.071970484197784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5886606695395655, "mean_inference_ms": 1.4611727365677079, "mean_action_processing_ms": 0.2553554141654899, "mean_env_wait_ms": 0.1931796508251037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032655000686645508, "StateBufferConnector_ms": 0.0027654170989990234, "ViewRequirementAgentConnector_ms": 0.0812385082244873}, "num_episodes": 18, "episode_return_max": 450.7744254591595, "episode_return_min": -3.6078325743954487, "episode_return_mean": 68.70982935950622, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.19095130039733, "num_env_steps_trained_throughput_per_sec": 449.19095130039733, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 8971.3, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8971.264, "sample_time_ms": 968.006, "learn_time_ms": 7991.506, "learn_throughput": 500.531, "synch_weights_time_ms": 11.077}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "1f15c_00000", "date": "2024-08-16_14-09-57", "timestamp": 1723797597, "time_this_iter_s": 8.908599853515625, "time_total_s": 402.37033438682556, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8add30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 402.37033438682556, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.6, "ram_util_percent": 74.70769230769233}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6998502173121013, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8030295477815406, "policy_loss": -0.007905728295297614, "vf_loss": 0.8105819292011716, "vf_explained_var": 0.011241487062797345, "kl": 0.00706689891492879, "entropy": 1.0635826848486745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.47454193862027, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5885944511524586, "policy_loss": -0.007217169044017003, "vf_loss": 3.5949021651000574, "vf_explained_var": 0.40394938231776, "kl": 0.006063044468581249, "entropy": 1.3230192056408634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 345.75378591093295, "episode_reward_min": -3.6078325743954487, "episode_reward_mean": 63.56660138009917, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -641.2791214395054, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 112.78486021448941, "predator_policy": 615.9028211497695}, "policy_reward_mean": {"prey_policy": -20.248892029324505, "predator_policy": 52.03219271937401}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.04800336790956, 31.480000000000327, 16.477908373012262, 78.20421656841478, 32.91000000000006, 3.819999999999961, 65.33000000000001, 28.550000000000527, 25.838506481858225, 70.31000000000124, 345.75378591093295, 44.119999999999514, 5.562741955569037, 9.669999999999932, 14.426343984695059, 12.032255340333084, 3.8999999999999604, 62.31700489026831, 27.300000000000498, 78.07365273020238, 6.540928725057789, 42.53718315396187, 23.283903821326493, 75.26923217963778, 26.27175212794336, 26.538875031589352, 57.62894770862436, 112.26193009949438, 35.47999999999939, 73.17000000000141, 77.33230673231674, 32.51000000000034, -3.6078325743954487, 12.859999999999923, 37.619999999999365, 60.40058046614671, 8.889999999999919, 84.98000000000118, 63.701259971817315, 28.580000000000513, 10.882980612936487, 31.675933086978358, 11.70999999999994, 61.43042937035798, 19.851496944260855, 154.44583946276433, 20.430000000000454, 3.789999999999962, 3.5399999999999667, 13.479186646601853, 130.7043178634197, 48.47792132482845, 47.87547882080094, 200.91200708746922, 69.64931819566817, 41.489999999999384, 28.373308058065774, 12.78673754620764, 69.32000000000134, 25.2600000000004, 19.770000000000557, 22.340000000000458, 66.77277033442685, 3.8999999999999604, 27.68998302216474, 86.06521286582432, 156.29000000000002, 194.7717862574503, 155.30000000000007, 171.8215970826902, 52.998853709924276, 64.7208380128444, 12.64015180831142, 86.06226270433659, 99.29748573008784, 33.76487410645057, 140.47999999999976, 257.14493574282875, 186.89999999999935, 104.79000000000049, 137.06943495002278, 39.34257497296698, 79.78688735168654, 3.979999999999959, 3.919999999999959, 161.2000000000001, 30.95728879259125, 88.70000000000073, 24.650000000000492, 176.16577862456694, 49.12267242517819, 13.829999999999918, 129.19336031729605, 224.40437057450745, 126.41000000000066, 68.14000000000085, 64.61776978959783, 3.8399999999999617, 7.720806767078093, 31.630000000000496], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-244.30335889561292, -144.21964162405416, -11.560203140271012, -25.867994937868414, 10.294391552418235, -22.656916730122497, -527.5733869132865, -55.30051629674744, -228.21710847718563, -21.30152608236066, 2.0000000000000013, -49.45506705396426, -6.63945515313001, 61.3999999999998, 18.888332788316035, -46.49514796446045, -11.313325194519814, -3.6463301175280165, 68.33000000000064, -2.5476508094296317, -6.560472094063801, -641.2791214395054, -201.3318308487311, 38.925109435709885, 2.0000000000000013, -40.54247793967292, -53.68697820957437, -13.507055271786378, -24.716766206371656, -23.15544507837151, 2.0988818792274215, -24.732997453494153, -8.85301507442402, -16.11400204568757, -94.78832630572309, -22.56246251787208, -64.69039890269575, -49.06610959937584, -27.315656550777344, -56.400849314794165, -4.19387277028694, -14.69349182522951, 26.75000000000027, -86.3416777850417, -112.12011153719592, -31.084193387373013, -51.4846291369917, -31.756960801392143, 2.0000000000000013, -29.781737751922147, 11.05646170368296, -12.32008124350733, 2.0000000000000013, -3.397136856079417, 34.77946622735894, 0.3483705579398865, -42.605747159676966, 7.879622575636265, 43.4694533383174, 1.8087564130940135, -1.8266765662206939, -80.81535689188786, -56.35928399691886, 24.123203446681035, -56.36781382265915, -33.87849764787803, 1.9714090608598962, 2.0000000000000013, 0.12448837801062247, 29.96885463097431, -18.592614442312993, 12.742494655928322, -4.912063899147725, -5.394437172980697, -5.8783782786615095, 27.25923714696237, 3.822339878141007, -44.29034303842982, -25.302871116355945, 1.4983016015745834, -26.223697732330038, -47.538518100908085, -46.914253728616686, -9.383439944641498, -30.44666593313318, -20.103590804841588, -81.79530863060839, 25.760000000000275, 9.497549703878377, 2.260277657573513, -82.25226958061522, 2.0000000000000013, -3.6675210496986663, -147.9670274288709, -2.6861664708456017, -99.30943821501238, -52.93900517620794, -97.44124051068289, -14.008011246818846, -155.76866398572085, 8.929999999999959, 91.24166147576126, 10.417889741481316, -38.382105919676874, -106.24457376336285, 25.760000000000275, 107.37793498814013, 16.78944309160756, -6.04000771750699, 25.379998096620504, 27.32796122556073, -20.63960884227992, -30.516539456080157, 16.85000000000012, -15.947873360011766, 2.0000000000000013, 54.46999999999973, 10.453990457409569, -147.09180675030098, -2.644076055270217, -7.737826460475754, 2.7745137671626288, -61.98389944761166, -153.33470478670475, -76.45350313634881, -26.064414507452984, -6.928898879886697, -19.141537287601157, -48.5000225322141, -2.623557759494826, 82.19000000000058, -7.388373581069642, 31.192576584089995, -6.453837285642491, 4.969999999999958, 103.4931527847508, 4.763088880761827, 81.67421512914892, 2.0000000000000013, 98.38785098019176, 21.89845901357667, 12.468853709924867, 54.15230969473821, -32.83246055261445, 2.0000000000000013, -16.92109797879433, 21.800000000000225, 50.11719509437815, 22.935134746051684, 53.479999999999706, -15.277159534223527, -215.1711806201261, -5.715574394610025, 112.78486021448941, 53.70366681359636, 47.77891467797611, 105.81939827998362, 13.451724664004113, 32.42850485858694, 5.529076245521666, -63.910400960356675, 92.08999999999988, 23.199956586654174, -71.4974046450816, 30.71000000000026, -70.17419033289272, -0.3148145043187667, -0.09478999978460384, -30.35640953546115, -2.5776890150498106, 89.66101343135315, -7.205870176465902, -20.801583015879384, 4.969999999999958, -175.67938762738277, -7.226176181091667, -9.479751454438762, -25.914862991762618, -55.328752025110504, 99.47874616327827, 2.0000000000000013, -88.36151946387616, -29.901216116252908, 2.0000000000000013, -225.8568833171406, 39.61999999999978, 13.403957627483663, 71.05361339811975, 2.0000000000000013, 25.65199432136449, -2.4350216595855745, 2.7470785583221473, 2.0000000000000013, 20.08950264155705, -15.608036161584952, -32.89622138114566, -27.466867657386192, 2.0000000000000013, 2.0000000000000013, 5.063232301740626], "policy_predator_policy_reward": [206.01056743536225, 286.5604364522101, 55.397994937868475, 13.51020314027097, 24.566916730122795, 4.273516820593984, 79.78715253667167, 581.2909672417752, 243.38710847718457, 39.04152608236093, 41.75906820136992, 9.515998852593967, 1.6112875424219055, 8.958167610708063, 7.831667211684232, 48.3251479644601, 20.821897802834414, 19.97626399107101, 0.0, 4.5276508094295895, 615.9028211497695, 377.6905582947339, 3.6448905642899136, 202.88183084872983, 3.391524297535921, 40.71369559770573, 15.447055271786336, 61.416978209574026, 11.703243026536546, 50.59531224290232, 2.0633734611057393, 32.602997453494446, 18.054002045687874, 10.813015074423978, 60.596989710645175, 119.07080400321985, 77.28039890269655, 63.7761095993755, 82.8976491222165, 78.89250947355558, 7.824801495344769, 17.603491825229575, 97.61545093644551, 4.513410002559347, 61.564446643675005, 104.92376210222073, 77.84072136425107, 80.67010075376827, 11.501752127942797, 42.551737751922424, 21.736867335761893, 6.06562723565121, 14.10894770862498, 44.91713685607938, 38.733559541553085, 38.400533772640834, 25.740377424363707, 44.465747159676596, 14.971243586905986, 12.920546661682327, 90.4474117353264, 69.52692845509824, 2.6291000187857074, 62.11698053145201, 1.8439877462750884, 84.79449114986605, 0.0, 8.888590939140103, 1.865511621989379, 5.6611453690259435, 9.93584058103334, 56.31485967149893, 7.374437172980655, 11.822063899147684, 0.0, 63.599141131699284, 63.105113832155176, 41.064149299951275, 21.817061441911523, 30.567508072870147, 6.0829806129365664, 78.56221583323801, 36.91406309778374, 51.05956366245188, 40.2466659331333, 22.013590804841886, 83.62530863060933, 33.8404293703587, 2.433947240381847, 5.659722342426483, 141.35464755151597, 93.34346149186536, 166.4270274288696, 5.637521049698625, 101.1194382150133, 4.6661664708455595, 53.208834456047846, 100.71141123084354, 121.42401074160927, 61.831851137531366, 28.44833852423899, 2.0843178634202806, 41.30082753208781, 35.141309970936504, 16.186969753325204, 112.17308283083996, 35.40339272634618, 41.341236281376354, 25.079137265285656, 25.230190551267718, 12.242038774439516, 22.55960884228022, 3.663308058065393, 38.376539456080316, 15.175021991222419, 11.559588914997363, 4.396009542590392, 0.0, 170.3718067502998, 4.624076055270175, 15.025486232837356, 9.707826460475712, 63.84389944761129, 173.8147047867034, 39.1802062831774, 130.11048169505102, 8.898898879886655, 21.07153728760146, 47.57013795716976, 31.243425356702918, 9.3583735810696, 1.905212865823098, 8.423837285642449, 123.12742341591016, 27.60178625745064, 58.706847215249184, 64.71578487085111, 4.1469111192381325, 60.862149019808314, 10.571597082690484, 18.63154098642357, 0.0, 10.938311489284738, 32.46267738143531, 19.82109797879462, 7.740151808311503, 7.15856895500135, 6.986498654955367, 5.277485730086301, 17.604865253948557, 232.68118062012474, 31.532033640674435, 25.725139785510702, 7.685574394609983, 57.473912971431666, 98.18844127982568, 29.71060172001641, 37.91827533599586, 5.350923754478297, 61.48149514141288, 55.87007599020303, 53.01975992017636, 47.56805254719842, 40.071970484197784, 55.64442087583362, 63.6066568087448, 2.0847899997846038, 2.304814504318762, 32.29640953546136, 4.557689015049768, 9.17587017646586, 69.56898656864685, 44.5215830158795, 2.267288792590847, 262.4193876273821, 9.186176181091625, 27.85486299176292, 32.1897514544387, 42.18484222726212, 89.83094225913824, 66.87987768789557, 68.60431420116043, 0.0, 41.731216116253194, 16.133360317295374, 299.2968833171403, 138.47237231859899, 1.4744272303054158, 0.0, 98.7580056786355, 63.41292144167779, 4.415021659585532, 38.27049735844307, 4.257769789597936, 34.816221381145276, 17.52803616158518, 29.396867657386494, 3.790806767078177, 24.566767698259355, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5860922862454372, "mean_inference_ms": 1.455109995864493, "mean_action_processing_ms": 0.2541457868165001, "mean_env_wait_ms": 0.19229779437221603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003188610076904297, "StateBufferConnector_ms": 0.0027229785919189453, "ViewRequirementAgentConnector_ms": 0.08018910884857178}, "num_episodes": 18, "episode_return_max": 345.75378591093295, "episode_return_min": -3.6078325743954487, "episode_return_mean": 63.56660138009917, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.6178722873135, "num_env_steps_trained_throughput_per_sec": 455.6178722873135, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 8942.16, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8942.124, "sample_time_ms": 971.353, "learn_time_ms": 7959.132, "learn_throughput": 502.567, "synch_weights_time_ms": 10.961}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "1f15c_00000", "date": "2024-08-16_14-10-06", "timestamp": 1723797606, "time_this_iter_s": 8.782571077346802, "time_total_s": 411.15290546417236, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f866e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 411.15290546417236, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 31.524999999999995, "ram_util_percent": 73.95833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49769260187549563, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0146875080765871, "policy_loss": -0.0034459896304363767, "vf_loss": 1.0178653348296407, "vf_explained_var": 0.001546844761207621, "kl": 0.005363279963518604, "entropy": 1.046061619564339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9607057355699085, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.8416590001848006, "policy_loss": -0.006238743826308382, "vf_loss": 4.846511428949063, "vf_explained_var": 0.057181264294518364, "kl": 0.009242030685858408, "entropy": 1.3823074806934943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 361.2, "episode_reward_min": -3.6078325743954487, "episode_reward_mean": 84.26737874221583, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -568.8067170346113, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.11999999999995, "predator_policy": 614.3441461490899}, "policy_reward_mean": {"prey_policy": -2.555703802092596, "predator_policy": 44.68939317320046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.300000000000498, 78.07365273020238, 6.540928725057789, 42.53718315396187, 23.283903821326493, 75.26923217963778, 26.27175212794336, 26.538875031589352, 57.62894770862436, 112.26193009949438, 35.47999999999939, 73.17000000000141, 77.33230673231674, 32.51000000000034, -3.6078325743954487, 12.859999999999923, 37.619999999999365, 60.40058046614671, 8.889999999999919, 84.98000000000118, 63.701259971817315, 28.580000000000513, 10.882980612936487, 31.675933086978358, 11.70999999999994, 61.43042937035798, 19.851496944260855, 154.44583946276433, 20.430000000000454, 3.789999999999962, 3.5399999999999667, 13.479186646601853, 130.7043178634197, 48.47792132482845, 47.87547882080094, 200.91200708746922, 69.64931819566817, 41.489999999999384, 28.373308058065774, 12.78673754620764, 69.32000000000134, 25.2600000000004, 19.770000000000557, 22.340000000000458, 66.77277033442685, 3.8999999999999604, 27.68998302216474, 86.06521286582432, 156.29000000000002, 194.7717862574503, 155.30000000000007, 171.8215970826902, 52.998853709924276, 64.7208380128444, 12.64015180831142, 86.06226270433659, 99.29748573008784, 33.76487410645057, 140.47999999999976, 257.14493574282875, 186.89999999999935, 104.79000000000049, 137.06943495002278, 39.34257497296698, 79.78688735168654, 3.979999999999959, 3.919999999999959, 161.2000000000001, 30.95728879259125, 88.70000000000073, 24.650000000000492, 176.16577862456694, 49.12267242517819, 13.829999999999918, 129.19336031729605, 224.40437057450745, 126.41000000000066, 68.14000000000085, 64.61776978959783, 3.8399999999999617, 7.720806767078093, 31.630000000000496, 338.5399999999997, 162.26999999999987, 166.18000000000012, 25.489756782533, 153.07000000000008, 111.24000000000031, 361.2, 203.90999999999974, 70.87436467013706, 354.4199999999999, 199.82166402786874, 0.7317769401829964, 167.18999999999977, 171.24999999999966, 197.56999999999942, 169.25000000000034, 31.4200000000004, 140.4009406639388], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-64.69039890269575, -49.06610959937584, -27.315656550777344, -56.400849314794165, -4.19387277028694, -14.69349182522951, 26.75000000000027, -86.3416777850417, -112.12011153719592, -31.084193387373013, -51.4846291369917, -31.756960801392143, 2.0000000000000013, -29.781737751922147, 11.05646170368296, -12.32008124350733, 2.0000000000000013, -3.397136856079417, 34.77946622735894, 0.3483705579398865, -42.605747159676966, 7.879622575636265, 43.4694533383174, 1.8087564130940135, -1.8266765662206939, -80.81535689188786, -56.35928399691886, 24.123203446681035, -56.36781382265915, -33.87849764787803, 1.9714090608598962, 2.0000000000000013, 0.12448837801062247, 29.96885463097431, -18.592614442312993, 12.742494655928322, -4.912063899147725, -5.394437172980697, -5.8783782786615095, 27.25923714696237, 3.822339878141007, -44.29034303842982, -25.302871116355945, 1.4983016015745834, -26.223697732330038, -47.538518100908085, -46.914253728616686, -9.383439944641498, -30.44666593313318, -20.103590804841588, -81.79530863060839, 25.760000000000275, 9.497549703878377, 2.260277657573513, -82.25226958061522, 2.0000000000000013, -3.6675210496986663, -147.9670274288709, -2.6861664708456017, -99.30943821501238, -52.93900517620794, -97.44124051068289, -14.008011246818846, -155.76866398572085, 8.929999999999959, 91.24166147576126, 10.417889741481316, -38.382105919676874, -106.24457376336285, 25.760000000000275, 107.37793498814013, 16.78944309160756, -6.04000771750699, 25.379998096620504, 27.32796122556073, -20.63960884227992, -30.516539456080157, 16.85000000000012, -15.947873360011766, 2.0000000000000013, 54.46999999999973, 10.453990457409569, -147.09180675030098, -2.644076055270217, -7.737826460475754, 2.7745137671626288, -61.98389944761166, -153.33470478670475, -76.45350313634881, -26.064414507452984, -6.928898879886697, -19.141537287601157, -48.5000225322141, -2.623557759494826, 82.19000000000058, -7.388373581069642, 31.192576584089995, -6.453837285642491, 4.969999999999958, 103.4931527847508, 4.763088880761827, 81.67421512914892, 2.0000000000000013, 98.38785098019176, 21.89845901357667, 12.468853709924867, 54.15230969473821, -32.83246055261445, 2.0000000000000013, -16.92109797879433, 21.800000000000225, 50.11719509437815, 22.935134746051684, 53.479999999999706, -15.277159534223527, -215.1711806201261, -5.715574394610025, 112.78486021448941, 53.70366681359636, 47.77891467797611, 105.81939827998362, 13.451724664004113, 32.42850485858694, 5.529076245521666, -63.910400960356675, 92.08999999999988, 23.199956586654174, -71.4974046450816, 30.71000000000026, -70.17419033289272, -0.3148145043187667, -0.09478999978460384, -30.35640953546115, -2.5776890150498106, 89.66101343135315, -7.205870176465902, -20.801583015879384, 4.969999999999958, -175.67938762738277, -7.226176181091667, -9.479751454438762, -25.914862991762618, -55.328752025110504, 99.47874616327827, 2.0000000000000013, -88.36151946387616, -29.901216116252908, 2.0000000000000013, -225.8568833171406, 39.61999999999978, 13.403957627483663, 71.05361339811975, 2.0000000000000013, 25.65199432136449, -2.4350216595855745, 2.7470785583221473, 2.0000000000000013, 20.08950264155705, -15.608036161584952, -32.89622138114566, -27.466867657386192, 2.0000000000000013, 2.0000000000000013, 5.063232301740626, 154.45999999999998, 130.0564746727344, 151.69302673364837, -22.978732674518646, 114.17956988150769, -30.394498739270357, -42.624904078221505, 1.2631475375556025, -13.786054970643258, 64.35718040643523, -2.7546331840879734, -157.0709987154607, 187.13000000000005, 120.0421488968322, 156.23967354344117, 25.760000000000215, -568.8067170346113, 2.0000000000000013, 188.11999999999995, 151.59949681555776, 2.0000000000000013, 63.36690643725743, -19.165485849722632, -23.484494911079675, 140.30731851009904, -35.70422053191563, -20.632500155536054, 169.3099999999999, 38.84624486977355, -2.5988700384578802, 2.5217445465348765, 145.55000000000018, -49.91555739802185, 16.741894528783625, 135.65, -1.631377872379441], "policy_predator_policy_reward": [77.28039890269655, 63.7761095993755, 82.8976491222165, 78.89250947355558, 7.824801495344769, 17.603491825229575, 97.61545093644551, 4.513410002559347, 61.564446643675005, 104.92376210222073, 77.84072136425107, 80.67010075376827, 11.501752127942797, 42.551737751922424, 21.736867335761893, 6.06562723565121, 14.10894770862498, 44.91713685607938, 38.733559541553085, 38.400533772640834, 25.740377424363707, 44.465747159676596, 14.971243586905986, 12.920546661682327, 90.4474117353264, 69.52692845509824, 2.6291000187857074, 62.11698053145201, 1.8439877462750884, 84.79449114986605, 0.0, 8.888590939140103, 1.865511621989379, 5.6611453690259435, 9.93584058103334, 56.31485967149893, 7.374437172980655, 11.822063899147684, 0.0, 63.599141131699284, 63.105113832155176, 41.064149299951275, 21.817061441911523, 30.567508072870147, 6.0829806129365664, 78.56221583323801, 36.91406309778374, 51.05956366245188, 40.2466659331333, 22.013590804841886, 83.62530863060933, 33.8404293703587, 2.433947240381847, 5.659722342426483, 141.35464755151597, 93.34346149186536, 166.4270274288696, 5.637521049698625, 101.1194382150133, 4.6661664708455595, 53.208834456047846, 100.71141123084354, 121.42401074160927, 61.831851137531366, 28.44833852423899, 2.0843178634202806, 41.30082753208781, 35.141309970936504, 16.186969753325204, 112.17308283083996, 35.40339272634618, 41.341236281376354, 25.079137265285656, 25.230190551267718, 12.242038774439516, 22.55960884228022, 3.663308058065393, 38.376539456080316, 15.175021991222419, 11.559588914997363, 4.396009542590392, 0.0, 170.3718067502998, 4.624076055270175, 15.025486232837356, 9.707826460475712, 63.84389944761129, 173.8147047867034, 39.1802062831774, 130.11048169505102, 8.898898879886655, 21.07153728760146, 47.57013795716976, 31.243425356702918, 9.3583735810696, 1.905212865823098, 8.423837285642449, 123.12742341591016, 27.60178625745064, 58.706847215249184, 64.71578487085111, 4.1469111192381325, 60.862149019808314, 10.571597082690484, 18.63154098642357, 0.0, 10.938311489284738, 32.46267738143531, 19.82109797879462, 7.740151808311503, 7.15856895500135, 6.986498654955367, 5.277485730086301, 17.604865253948557, 232.68118062012474, 31.532033640674435, 25.725139785510702, 7.685574394609983, 57.473912971431666, 98.18844127982568, 29.71060172001641, 37.91827533599586, 5.350923754478297, 61.48149514141288, 55.87007599020303, 53.01975992017636, 47.56805254719842, 40.071970484197784, 55.64442087583362, 63.6066568087448, 2.0847899997846038, 2.304814504318762, 32.29640953546136, 4.557689015049768, 9.17587017646586, 69.56898656864685, 44.5215830158795, 2.267288792590847, 262.4193876273821, 9.186176181091625, 27.85486299176292, 32.1897514544387, 42.18484222726212, 89.83094225913824, 66.87987768789557, 68.60431420116043, 0.0, 41.731216116253194, 16.133360317295374, 299.2968833171403, 138.47237231859899, 1.4744272303054158, 0.0, 98.7580056786355, 63.41292144167779, 4.415021659585532, 38.27049735844307, 4.257769789597936, 34.816221381145276, 17.52803616158518, 29.396867657386494, 3.790806767078177, 24.566767698259355, 0.0, 0.0, 54.02352532726561, 8.667126349142416, 24.88857959172808, 57.37706821175719, 25.01786064600569, 1.5280599670249344, 65.32345335617308, 86.78281959356477, 15.716054970643217, 266.33099871546045, 4.734633184087931, 54.02785110316779, 0.0, 0.0, 21.910326456558796, 23.336935555658393, 614.3441461490899, 14.70050318444223, 0.0, 101.59557733903212, 32.859180251579595, 25.414494911079977, 17.967262789905952, 28.32819270003016, 34.258709321786064, 0.0, 22.572500155536357, 6.038150970611816, 155.28447419807225, 21.178255453465116, 0.0, 51.67555739802154, 12.918105471216473, 1.7809406639386276, 4.601377872379407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5836389002984261, "mean_inference_ms": 1.4492056506233713, "mean_action_processing_ms": 0.2529790276931323, "mean_env_wait_ms": 0.19144808700905244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031589269638061523, "StateBufferConnector_ms": 0.0026955604553222656, "ViewRequirementAgentConnector_ms": 0.07848751544952393}, "num_episodes": 18, "episode_return_max": 361.2, "episode_return_min": -3.6078325743954487, "episode_return_mean": 84.26737874221583, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.15123195333416, "num_env_steps_trained_throughput_per_sec": 464.15123195333416, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 8895.392, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8895.356, "sample_time_ms": 971.165, "learn_time_ms": 7912.618, "learn_throughput": 505.522, "synch_weights_time_ms": 10.898}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "1f15c_00000", "date": "2024-08-16_14-10-14", "timestamp": 1723797614, "time_this_iter_s": 8.620962858200073, "time_total_s": 419.77386832237244, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8b1ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 419.77386832237244, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 31.02307692307692, "ram_util_percent": 74.51538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7448918757615266, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.33034366293559, "policy_loss": -0.005677143229472219, "vf_loss": 2.3354853434852823, "vf_explained_var": 0.004359966863400091, "kl": 0.010709222097859272, "entropy": 0.8896348016602652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9867348618292935, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.587166741537669, "policy_loss": -0.0054396646617167685, "vf_loss": 5.590847487676712, "vf_explained_var": 0.05712751068135418, "kl": 0.011726149251592655, "entropy": 1.3734812600272042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 626.1795763337553, "episode_reward_min": 0.7317769401829964, "episode_reward_mean": 116.5593381493395, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.9489427731633, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.11999999999995, "predator_policy": 622.0278145223706}, "policy_reward_mean": {"prey_policy": -4.291504162133841, "predator_policy": 62.57117323680359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.882980612936487, 31.675933086978358, 11.70999999999994, 61.43042937035798, 19.851496944260855, 154.44583946276433, 20.430000000000454, 3.789999999999962, 3.5399999999999667, 13.479186646601853, 130.7043178634197, 48.47792132482845, 47.87547882080094, 200.91200708746922, 69.64931819566817, 41.489999999999384, 28.373308058065774, 12.78673754620764, 69.32000000000134, 25.2600000000004, 19.770000000000557, 22.340000000000458, 66.77277033442685, 3.8999999999999604, 27.68998302216474, 86.06521286582432, 156.29000000000002, 194.7717862574503, 155.30000000000007, 171.8215970826902, 52.998853709924276, 64.7208380128444, 12.64015180831142, 86.06226270433659, 99.29748573008784, 33.76487410645057, 140.47999999999976, 257.14493574282875, 186.89999999999935, 104.79000000000049, 137.06943495002278, 39.34257497296698, 79.78688735168654, 3.979999999999959, 3.919999999999959, 161.2000000000001, 30.95728879259125, 88.70000000000073, 24.650000000000492, 176.16577862456694, 49.12267242517819, 13.829999999999918, 129.19336031729605, 224.40437057450745, 126.41000000000066, 68.14000000000085, 64.61776978959783, 3.8399999999999617, 7.720806767078093, 31.630000000000496, 338.5399999999997, 162.26999999999987, 166.18000000000012, 25.489756782533, 153.07000000000008, 111.24000000000031, 361.2, 203.90999999999974, 70.87436467013706, 354.4199999999999, 199.82166402786874, 0.7317769401829964, 167.18999999999977, 171.24999999999966, 197.56999999999942, 169.25000000000034, 31.4200000000004, 140.4009406639388, 44.259999999999856, 70.28000000000128, 3.789999999999963, 136.6521800721241, 164.29999999999984, 184.44540230736584, 184.72797308523516, 174.02500843690882, 148.24000000000035, 27.411160615496573, 342.61024235326653, 195.80999999999966, 5.694644865517118, 265.1873741827639, 115.25000000000026, 157.00447868799142, 330.5196503430741, 483.52391733701154, 202.27999999999994, 17.742043703643446, 336.88500856193644, 626.1795763337553], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.223697732330038, -47.538518100908085, -46.914253728616686, -9.383439944641498, -30.44666593313318, -20.103590804841588, -81.79530863060839, 25.760000000000275, 9.497549703878377, 2.260277657573513, -82.25226958061522, 2.0000000000000013, -3.6675210496986663, -147.9670274288709, -2.6861664708456017, -99.30943821501238, -52.93900517620794, -97.44124051068289, -14.008011246818846, -155.76866398572085, 8.929999999999959, 91.24166147576126, 10.417889741481316, -38.382105919676874, -106.24457376336285, 25.760000000000275, 107.37793498814013, 16.78944309160756, -6.04000771750699, 25.379998096620504, 27.32796122556073, -20.63960884227992, -30.516539456080157, 16.85000000000012, -15.947873360011766, 2.0000000000000013, 54.46999999999973, 10.453990457409569, -147.09180675030098, -2.644076055270217, -7.737826460475754, 2.7745137671626288, -61.98389944761166, -153.33470478670475, -76.45350313634881, -26.064414507452984, -6.928898879886697, -19.141537287601157, -48.5000225322141, -2.623557759494826, 82.19000000000058, -7.388373581069642, 31.192576584089995, -6.453837285642491, 4.969999999999958, 103.4931527847508, 4.763088880761827, 81.67421512914892, 2.0000000000000013, 98.38785098019176, 21.89845901357667, 12.468853709924867, 54.15230969473821, -32.83246055261445, 2.0000000000000013, -16.92109797879433, 21.800000000000225, 50.11719509437815, 22.935134746051684, 53.479999999999706, -15.277159534223527, -215.1711806201261, -5.715574394610025, 112.78486021448941, 53.70366681359636, 47.77891467797611, 105.81939827998362, 13.451724664004113, 32.42850485858694, 5.529076245521666, -63.910400960356675, 92.08999999999988, 23.199956586654174, -71.4974046450816, 30.71000000000026, -70.17419033289272, -0.3148145043187667, -0.09478999978460384, -30.35640953546115, -2.5776890150498106, 89.66101343135315, -7.205870176465902, -20.801583015879384, 4.969999999999958, -175.67938762738277, -7.226176181091667, -9.479751454438762, -25.914862991762618, -55.328752025110504, 99.47874616327827, 2.0000000000000013, -88.36151946387616, -29.901216116252908, 2.0000000000000013, -225.8568833171406, 39.61999999999978, 13.403957627483663, 71.05361339811975, 2.0000000000000013, 25.65199432136449, -2.4350216595855745, 2.7470785583221473, 2.0000000000000013, 20.08950264155705, -15.608036161584952, -32.89622138114566, -27.466867657386192, 2.0000000000000013, 2.0000000000000013, 5.063232301740626, 154.45999999999998, 130.0564746727344, 151.69302673364837, -22.978732674518646, 114.17956988150769, -30.394498739270357, -42.624904078221505, 1.2631475375556025, -13.786054970643258, 64.35718040643523, -2.7546331840879734, -157.0709987154607, 187.13000000000005, 120.0421488968322, 156.23967354344117, 25.760000000000215, -568.8067170346113, 2.0000000000000013, 188.11999999999995, 151.59949681555776, 2.0000000000000013, 63.36690643725743, -19.165485849722632, -23.484494911079675, 140.30731851009904, -35.70422053191563, -20.632500155536054, 169.3099999999999, 38.84624486977355, -2.5988700384578802, 2.5217445465348765, 145.55000000000018, -49.91555739802185, 16.741894528783625, 135.65, -1.631377872379441, -565.3672889542306, -12.52357546834975, 59.393086223126545, 2.0000000000000013, -1.6929739090037101, -52.681350169384636, 97.86244712795231, 2.0000000000000013, 158.48422935938837, -18.671717964027543, -509.03724529664066, 69.02548127611072, 158.42000000000007, -51.602584520954075, -10.649576390113136, 168.3200000000001, -29.23408628522828, 39.59909671153446, -2.8270885008151616, 2.0000000000000013, 151.49000000000007, 132.0768837210777, 178.6664261573306, -96.88704641693094, -29.301546091512996, -57.94464869416488, 70.90623971910608, 115.85000000000036, -2.6161954922519204, -113.67734089350652, 2.0000000000000013, 70.7810827790467, 136.96835344864263, 168.49998059511128, -6.3526840090645, -663.9489427731633, -208.23835693110067, -218.2043449826487, -18.605440578898968, 2.0000000000000013, 145.56951739410306, 135.57032641337, -370.37222054857847, -91.4754999442121], "policy_predator_policy_reward": [6.0829806129365664, 78.56221583323801, 36.91406309778374, 51.05956366245188, 40.2466659331333, 22.013590804841886, 83.62530863060933, 33.8404293703587, 2.433947240381847, 5.659722342426483, 141.35464755151597, 93.34346149186536, 166.4270274288696, 5.637521049698625, 101.1194382150133, 4.6661664708455595, 53.208834456047846, 100.71141123084354, 121.42401074160927, 61.831851137531366, 28.44833852423899, 2.0843178634202806, 41.30082753208781, 35.141309970936504, 16.186969753325204, 112.17308283083996, 35.40339272634618, 41.341236281376354, 25.079137265285656, 25.230190551267718, 12.242038774439516, 22.55960884228022, 3.663308058065393, 38.376539456080316, 15.175021991222419, 11.559588914997363, 4.396009542590392, 0.0, 170.3718067502998, 4.624076055270175, 15.025486232837356, 9.707826460475712, 63.84389944761129, 173.8147047867034, 39.1802062831774, 130.11048169505102, 8.898898879886655, 21.07153728760146, 47.57013795716976, 31.243425356702918, 9.3583735810696, 1.905212865823098, 8.423837285642449, 123.12742341591016, 27.60178625745064, 58.706847215249184, 64.71578487085111, 4.1469111192381325, 60.862149019808314, 10.571597082690484, 18.63154098642357, 0.0, 10.938311489284738, 32.46267738143531, 19.82109797879462, 7.740151808311503, 7.15856895500135, 6.986498654955367, 5.277485730086301, 17.604865253948557, 232.68118062012474, 31.532033640674435, 25.725139785510702, 7.685574394609983, 57.473912971431666, 98.18844127982568, 29.71060172001641, 37.91827533599586, 5.350923754478297, 61.48149514141288, 55.87007599020303, 53.01975992017636, 47.56805254719842, 40.071970484197784, 55.64442087583362, 63.6066568087448, 2.0847899997846038, 2.304814504318762, 32.29640953546136, 4.557689015049768, 9.17587017646586, 69.56898656864685, 44.5215830158795, 2.267288792590847, 262.4193876273821, 9.186176181091625, 27.85486299176292, 32.1897514544387, 42.18484222726212, 89.83094225913824, 66.87987768789557, 68.60431420116043, 0.0, 41.731216116253194, 16.133360317295374, 299.2968833171403, 138.47237231859899, 1.4744272303054158, 0.0, 98.7580056786355, 63.41292144167779, 4.415021659585532, 38.27049735844307, 4.257769789597936, 34.816221381145276, 17.52803616158518, 29.396867657386494, 3.790806767078177, 24.566767698259355, 0.0, 0.0, 54.02352532726561, 8.667126349142416, 24.88857959172808, 57.37706821175719, 25.01786064600569, 1.5280599670249344, 65.32345335617308, 86.78281959356477, 15.716054970643217, 266.33099871546045, 4.734633184087931, 54.02785110316779, 0.0, 0.0, 21.910326456558796, 23.336935555658393, 614.3441461490899, 14.70050318444223, 0.0, 101.59557733903212, 32.859180251579595, 25.414494911079977, 17.967262789905952, 28.32819270003016, 34.258709321786064, 0.0, 22.572500155536357, 6.038150970611816, 155.28447419807225, 21.178255453465116, 0.0, 51.67555739802154, 12.918105471216473, 1.7809406639386276, 4.601377872379407, 14.463575468349708, 607.6872889542308, 0.0, 8.886913776873199, 23.40727821581797, 34.757045862569996, 2.0421800721250203, 34.747552872048004, 3.87577064061157, 20.611717964027847, 2.4293518055256995, 622.0278145223706, 37.97946460649502, 39.931092999694364, 3.745008436908768, 12.609576390113094, 106.69090328846553, 31.184086285228585, 15.940169773762948, 12.298079342548176, 5.12024235326665, 53.92311627892231, 98.69704641693187, 15.333573842669397, 43.87732002585596, 49.063519625339055, 13.02737418276462, 65.4037602808939, 226.94734089350644, 4.596195492251878, 51.141276495141994, 33.082119413802346, 23.361646551357488, 1.6896697479629514, 536.5560755665738, 617.2694685526664, 27.44621055776765, 601.2764913559821, 18.29180808993536, 16.05567619260713, 31.53552817543384, 24.20963657903001, 548.1933567096584, 539.8339401168881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5807544763402297, "mean_inference_ms": 1.442226952382959, "mean_action_processing_ms": 0.2515960982545854, "mean_env_wait_ms": 0.19046627055476012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031795501708984375, "StateBufferConnector_ms": 0.002704620361328125, "ViewRequirementAgentConnector_ms": 0.07900428771972656}, "num_episodes": 22, "episode_return_max": 626.1795763337553, "episode_return_min": 0.7317769401829964, "episode_return_mean": 116.5593381493395, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.60136929807726, "num_env_steps_trained_throughput_per_sec": 450.60136929807726, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 8889.569, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8889.533, "sample_time_ms": 969.854, "learn_time_ms": 7907.917, "learn_throughput": 505.822, "synch_weights_time_ms": 11.091}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "1f15c_00000", "date": "2024-08-16_14-10-23", "timestamp": 1723797623, "time_this_iter_s": 8.880367755889893, "time_total_s": 428.65423607826233, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8add30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 428.65423607826233, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 32.05833333333333, "ram_util_percent": 74.64166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0241460333267847, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.772325444915307, "policy_loss": -0.0038073054910267865, "vf_loss": 2.7754451812890473, "vf_explained_var": 0.008291221863378292, "kl": 0.013751387661948118, "entropy": 0.8129278969827783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.064297426598413, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.659548485720599, "policy_loss": -0.008405863826049777, "vf_loss": 5.66627621978679, "vf_explained_var": 0.0680683899178076, "kl": 0.011187526982374118, "entropy": 1.32791057219581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 707.5546579596114, "episode_reward_min": 0.7317769401829964, "episode_reward_mean": 153.8097485831562, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.9489427731633, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.2996859070633, "predator_policy": 828.9264288798157}, "policy_reward_mean": {"prey_policy": -5.919468222667417, "predator_policy": 82.82434251424554}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8999999999999604, 27.68998302216474, 86.06521286582432, 156.29000000000002, 194.7717862574503, 155.30000000000007, 171.8215970826902, 52.998853709924276, 64.7208380128444, 12.64015180831142, 86.06226270433659, 99.29748573008784, 33.76487410645057, 140.47999999999976, 257.14493574282875, 186.89999999999935, 104.79000000000049, 137.06943495002278, 39.34257497296698, 79.78688735168654, 3.979999999999959, 3.919999999999959, 161.2000000000001, 30.95728879259125, 88.70000000000073, 24.650000000000492, 176.16577862456694, 49.12267242517819, 13.829999999999918, 129.19336031729605, 224.40437057450745, 126.41000000000066, 68.14000000000085, 64.61776978959783, 3.8399999999999617, 7.720806767078093, 31.630000000000496, 338.5399999999997, 162.26999999999987, 166.18000000000012, 25.489756782533, 153.07000000000008, 111.24000000000031, 361.2, 203.90999999999974, 70.87436467013706, 354.4199999999999, 199.82166402786874, 0.7317769401829964, 167.18999999999977, 171.24999999999966, 197.56999999999942, 169.25000000000034, 31.4200000000004, 140.4009406639388, 44.259999999999856, 70.28000000000128, 3.789999999999963, 136.6521800721241, 164.29999999999984, 184.44540230736584, 184.72797308523516, 174.02500843690882, 148.24000000000035, 27.411160615496573, 342.61024235326653, 195.80999999999966, 5.694644865517118, 265.1873741827639, 115.25000000000026, 157.00447868799142, 330.5196503430741, 483.52391733701154, 202.27999999999994, 17.742043703643446, 336.88500856193644, 626.1795763337553, 169.9706698663676, 707.5546579596114, 181.00987777886488, 328.4337946311541, 193.23094302759768, 162.07999999999987, 263.5265112380111, 178.11257964480393, 195.99999999999966, 317.76831433181763, 299.50508543121316, 133.5410350795703, 19.920414187637373, 52.608714294623454, 167.72756676854664, 217.82193788687437, 114.15000000000026, 138.2557945919801, 3.8599999999999604, 182.09999999999974, 179.00999999999982, 196.95999999999964, 436.8608720177862], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.928898879886697, -19.141537287601157, -48.5000225322141, -2.623557759494826, 82.19000000000058, -7.388373581069642, 31.192576584089995, -6.453837285642491, 4.969999999999958, 103.4931527847508, 4.763088880761827, 81.67421512914892, 2.0000000000000013, 98.38785098019176, 21.89845901357667, 12.468853709924867, 54.15230969473821, -32.83246055261445, 2.0000000000000013, -16.92109797879433, 21.800000000000225, 50.11719509437815, 22.935134746051684, 53.479999999999706, -15.277159534223527, -215.1711806201261, -5.715574394610025, 112.78486021448941, 53.70366681359636, 47.77891467797611, 105.81939827998362, 13.451724664004113, 32.42850485858694, 5.529076245521666, -63.910400960356675, 92.08999999999988, 23.199956586654174, -71.4974046450816, 30.71000000000026, -70.17419033289272, -0.3148145043187667, -0.09478999978460384, -30.35640953546115, -2.5776890150498106, 89.66101343135315, -7.205870176465902, -20.801583015879384, 4.969999999999958, -175.67938762738277, -7.226176181091667, -9.479751454438762, -25.914862991762618, -55.328752025110504, 99.47874616327827, 2.0000000000000013, -88.36151946387616, -29.901216116252908, 2.0000000000000013, -225.8568833171406, 39.61999999999978, 13.403957627483663, 71.05361339811975, 2.0000000000000013, 25.65199432136449, -2.4350216595855745, 2.7470785583221473, 2.0000000000000013, 20.08950264155705, -15.608036161584952, -32.89622138114566, -27.466867657386192, 2.0000000000000013, 2.0000000000000013, 5.063232301740626, 154.45999999999998, 130.0564746727344, 151.69302673364837, -22.978732674518646, 114.17956988150769, -30.394498739270357, -42.624904078221505, 1.2631475375556025, -13.786054970643258, 64.35718040643523, -2.7546331840879734, -157.0709987154607, 187.13000000000005, 120.0421488968322, 156.23967354344117, 25.760000000000215, -568.8067170346113, 2.0000000000000013, 188.11999999999995, 151.59949681555776, 2.0000000000000013, 63.36690643725743, -19.165485849722632, -23.484494911079675, 140.30731851009904, -35.70422053191563, -20.632500155536054, 169.3099999999999, 38.84624486977355, -2.5988700384578802, 2.5217445465348765, 145.55000000000018, -49.91555739802185, 16.741894528783625, 135.65, -1.631377872379441, -565.3672889542306, -12.52357546834975, 59.393086223126545, 2.0000000000000013, -1.6929739090037101, -52.681350169384636, 97.86244712795231, 2.0000000000000013, 158.48422935938837, -18.671717964027543, -509.03724529664066, 69.02548127611072, 158.42000000000007, -51.602584520954075, -10.649576390113136, 168.3200000000001, -29.23408628522828, 39.59909671153446, -2.8270885008151616, 2.0000000000000013, 151.49000000000007, 132.0768837210777, 178.6664261573306, -96.88704641693094, -29.301546091512996, -57.94464869416488, 70.90623971910608, 115.85000000000036, -2.6161954922519204, -113.67734089350652, 2.0000000000000013, 70.7810827790467, 136.96835344864263, 168.49998059511128, -6.3526840090645, -663.9489427731633, -208.23835693110067, -218.2043449826487, -18.605440578898968, 2.0000000000000013, 145.56951739410306, 135.57032641337, -370.37222054857847, -91.4754999442121, -15.980753081517847, -30.98830009933753, -85.0073319406036, -576.5825379525465, -637.6889911212144, -19.197526625692454, 129.53066754880612, 184.15999999999997, 185.14999999999992, -91.64785150553573, -34.112243078080226, 107.88105311682719, -126.52289427634116, -147.18991870961497, -25.886376104765414, -327.8575256805999, 180.19710126044816, 2.0000000000000013, 190.2996859070633, 47.36488585428566, -195.16149165438046, 158.61326585470692, -230.30736903877693, 20.96427756957297, -27.42050648205584, -38.66458261982701, -31.531715607806188, 2.0000000000000013, 2.0000000000000013, 21.85848007227022, 69.64685393280877, 11.89999999999996, -196.88646284954473, -18.383202527234882, 25.72870463621348, -35.54619263377409, -29.712955514388813, -11.267281560480571, 169.47364245559268, -27.768565354854285, -0.8743607562601132, 122.67549990779844, 188.8058757318983, -20.45928140940566, -166.42124638186925, -169.00987992593943], "policy_predator_policy_reward": [8.898898879886655, 21.07153728760146, 47.57013795716976, 31.243425356702918, 9.3583735810696, 1.905212865823098, 8.423837285642449, 123.12742341591016, 27.60178625745064, 58.706847215249184, 64.71578487085111, 4.1469111192381325, 60.862149019808314, 10.571597082690484, 18.63154098642357, 0.0, 10.938311489284738, 32.46267738143531, 19.82109797879462, 7.740151808311503, 7.15856895500135, 6.986498654955367, 5.277485730086301, 17.604865253948557, 232.68118062012474, 31.532033640674435, 25.725139785510702, 7.685574394609983, 57.473912971431666, 98.18844127982568, 29.71060172001641, 37.91827533599586, 5.350923754478297, 61.48149514141288, 55.87007599020303, 53.01975992017636, 47.56805254719842, 40.071970484197784, 55.64442087583362, 63.6066568087448, 2.0847899997846038, 2.304814504318762, 32.29640953546136, 4.557689015049768, 9.17587017646586, 69.56898656864685, 44.5215830158795, 2.267288792590847, 262.4193876273821, 9.186176181091625, 27.85486299176292, 32.1897514544387, 42.18484222726212, 89.83094225913824, 66.87987768789557, 68.60431420116043, 0.0, 41.731216116253194, 16.133360317295374, 299.2968833171403, 138.47237231859899, 1.4744272303054158, 0.0, 98.7580056786355, 63.41292144167779, 4.415021659585532, 38.27049735844307, 4.257769789597936, 34.816221381145276, 17.52803616158518, 29.396867657386494, 3.790806767078177, 24.566767698259355, 0.0, 0.0, 54.02352532726561, 8.667126349142416, 24.88857959172808, 57.37706821175719, 25.01786064600569, 1.5280599670249344, 65.32345335617308, 86.78281959356477, 15.716054970643217, 266.33099871546045, 4.734633184087931, 54.02785110316779, 0.0, 0.0, 21.910326456558796, 23.336935555658393, 614.3441461490899, 14.70050318444223, 0.0, 101.59557733903212, 32.859180251579595, 25.414494911079977, 17.967262789905952, 28.32819270003016, 34.258709321786064, 0.0, 22.572500155536357, 6.038150970611816, 155.28447419807225, 21.178255453465116, 0.0, 51.67555739802154, 12.918105471216473, 1.7809406639386276, 4.601377872379407, 14.463575468349708, 607.6872889542308, 0.0, 8.886913776873199, 23.40727821581797, 34.757045862569996, 2.0421800721250203, 34.747552872048004, 3.87577064061157, 20.611717964027847, 2.4293518055256995, 622.0278145223706, 37.97946460649502, 39.931092999694364, 3.745008436908768, 12.609576390113094, 106.69090328846553, 31.184086285228585, 15.940169773762948, 12.298079342548176, 5.12024235326665, 53.92311627892231, 98.69704641693187, 15.333573842669397, 43.87732002585596, 49.063519625339055, 13.02737418276462, 65.4037602808939, 226.94734089350644, 4.596195492251878, 51.141276495141994, 33.082119413802346, 23.361646551357488, 1.6896697479629514, 536.5560755665738, 617.2694685526664, 27.44621055776765, 601.2764913559821, 18.29180808993536, 16.05567619260713, 31.53552817543384, 24.20963657903001, 548.1933567096584, 539.8339401168881, 85.81881423986745, 131.12090880735548, 673.0620987932839, 696.0824290594775, 8.969966645955827, 828.9264288798157, 8.012733702635414, 6.730393379712855, 33.27408015333964, 66.45471437979516, 52.268946883172816, 36.04224307807984, 537.2393242239675, 0.0, 192.90129398596343, 338.9551874442063, 13.802898739551846, 0.0, 33.49862842475515, 46.60511414571415, 11.285085431213368, 324.7682257996736, 342.88412654877385, 0.0, 51.46235275571409, 34.543150533805466, 64.58214938187487, 17.55828052055528, 123.40127530283813, 20.467811393438424, 73.66184244381311, 62.613241510253445, 309.07646284954455, 20.34320252723519, 37.3083082201871, 110.76497436935288, 13.21728156048053, 31.622955514389112, 10.686357544407311, 29.70856535485459, 26.714500092201554, 30.494360756260104, 22.399281409405962, 6.214124268101656, 416.0632720207227, 356.22872630487217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5786139599751418, "mean_inference_ms": 1.4372943284472341, "mean_action_processing_ms": 0.2504641435857695, "mean_env_wait_ms": 0.1897055184466867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004246115684509277, "StateBufferConnector_ms": 0.00294649600982666, "ViewRequirementAgentConnector_ms": 0.08407628536224365}, "num_episodes": 23, "episode_return_max": 707.5546579596114, "episode_return_min": 0.7317769401829964, "episode_return_mean": 153.8097485831562, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.42595315041564, "num_env_steps_trained_throughput_per_sec": 423.42595315041564, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 8927.686, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8927.651, "sample_time_ms": 991.551, "learn_time_ms": 7924.293, "learn_throughput": 504.777, "synch_weights_time_ms": 11.13}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "1f15c_00000", "date": "2024-08-16_14-10-33", "timestamp": 1723797633, "time_this_iter_s": 9.45032811164856, "time_total_s": 438.1045641899109, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f877310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 438.1045641899109, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 35.55384615384616, "ram_util_percent": 74.5076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9002260449544462, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5726753531546189, "policy_loss": -0.006150645907800743, "vf_loss": 0.5785471314396807, "vf_explained_var": 0.03565216278903699, "kl": 0.0055773151051235845, "entropy": 0.8999004883110208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3162851928403136, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.595860301628315, "policy_loss": -0.004199951541210924, "vf_loss": 3.59907025155567, "vf_explained_var": 0.7068829042570931, "kl": 0.00660000208943049, "entropy": 1.3056618605971968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 707.5546579596114, "episode_reward_min": 0.7317769401829964, "episode_reward_mean": 155.53746057495275, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.9489427731633, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.03999999999996, "predator_policy": 828.9264288798157}, "policy_reward_mean": {"prey_policy": -2.880350855654116, "predator_policy": 80.64908114313053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.34257497296698, 79.78688735168654, 3.979999999999959, 3.919999999999959, 161.2000000000001, 30.95728879259125, 88.70000000000073, 24.650000000000492, 176.16577862456694, 49.12267242517819, 13.829999999999918, 129.19336031729605, 224.40437057450745, 126.41000000000066, 68.14000000000085, 64.61776978959783, 3.8399999999999617, 7.720806767078093, 31.630000000000496, 338.5399999999997, 162.26999999999987, 166.18000000000012, 25.489756782533, 153.07000000000008, 111.24000000000031, 361.2, 203.90999999999974, 70.87436467013706, 354.4199999999999, 199.82166402786874, 0.7317769401829964, 167.18999999999977, 171.24999999999966, 197.56999999999942, 169.25000000000034, 31.4200000000004, 140.4009406639388, 44.259999999999856, 70.28000000000128, 3.789999999999963, 136.6521800721241, 164.29999999999984, 184.44540230736584, 184.72797308523516, 174.02500843690882, 148.24000000000035, 27.411160615496573, 342.61024235326653, 195.80999999999966, 5.694644865517118, 265.1873741827639, 115.25000000000026, 157.00447868799142, 330.5196503430741, 483.52391733701154, 202.27999999999994, 17.742043703643446, 336.88500856193644, 626.1795763337553, 169.9706698663676, 707.5546579596114, 181.00987777886488, 328.4337946311541, 193.23094302759768, 162.07999999999987, 263.5265112380111, 178.11257964480393, 195.99999999999966, 317.76831433181763, 299.50508543121316, 133.5410350795703, 19.920414187637373, 52.608714294623454, 167.72756676854664, 217.82193788687437, 114.15000000000026, 138.2557945919801, 3.8599999999999604, 182.09999999999974, 179.00999999999982, 196.95999999999964, 436.8608720177862, 183.15999999999985, 196.78999999999962, 325.3899999999999, 174.08999999999986, 31.327021082556453, 25.740000000000535, 155.25000000000034, 3.919999999999959, 7.941784365506674, 147.5493919073885, 3.8699999999999615, 2.1350121427701225, 3.8899999999999606, 160.66921942736707, 3.889999999999961, 197.92999999999955, 339.5585074111174, 181.3776788358856], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [23.199956586654174, -71.4974046450816, 30.71000000000026, -70.17419033289272, -0.3148145043187667, -0.09478999978460384, -30.35640953546115, -2.5776890150498106, 89.66101343135315, -7.205870176465902, -20.801583015879384, 4.969999999999958, -175.67938762738277, -7.226176181091667, -9.479751454438762, -25.914862991762618, -55.328752025110504, 99.47874616327827, 2.0000000000000013, -88.36151946387616, -29.901216116252908, 2.0000000000000013, -225.8568833171406, 39.61999999999978, 13.403957627483663, 71.05361339811975, 2.0000000000000013, 25.65199432136449, -2.4350216595855745, 2.7470785583221473, 2.0000000000000013, 20.08950264155705, -15.608036161584952, -32.89622138114566, -27.466867657386192, 2.0000000000000013, 2.0000000000000013, 5.063232301740626, 154.45999999999998, 130.0564746727344, 151.69302673364837, -22.978732674518646, 114.17956988150769, -30.394498739270357, -42.624904078221505, 1.2631475375556025, -13.786054970643258, 64.35718040643523, -2.7546331840879734, -157.0709987154607, 187.13000000000005, 120.0421488968322, 156.23967354344117, 25.760000000000215, -568.8067170346113, 2.0000000000000013, 188.11999999999995, 151.59949681555776, 2.0000000000000013, 63.36690643725743, -19.165485849722632, -23.484494911079675, 140.30731851009904, -35.70422053191563, -20.632500155536054, 169.3099999999999, 38.84624486977355, -2.5988700384578802, 2.5217445465348765, 145.55000000000018, -49.91555739802185, 16.741894528783625, 135.65, -1.631377872379441, -565.3672889542306, -12.52357546834975, 59.393086223126545, 2.0000000000000013, -1.6929739090037101, -52.681350169384636, 97.86244712795231, 2.0000000000000013, 158.48422935938837, -18.671717964027543, -509.03724529664066, 69.02548127611072, 158.42000000000007, -51.602584520954075, -10.649576390113136, 168.3200000000001, -29.23408628522828, 39.59909671153446, -2.8270885008151616, 2.0000000000000013, 151.49000000000007, 132.0768837210777, 178.6664261573306, -96.88704641693094, -29.301546091512996, -57.94464869416488, 70.90623971910608, 115.85000000000036, -2.6161954922519204, -113.67734089350652, 2.0000000000000013, 70.7810827790467, 136.96835344864263, 168.49998059511128, -6.3526840090645, -663.9489427731633, -208.23835693110067, -218.2043449826487, -18.605440578898968, 2.0000000000000013, 145.56951739410306, 135.57032641337, -370.37222054857847, -91.4754999442121, -15.980753081517847, -30.98830009933753, -85.0073319406036, -576.5825379525465, -637.6889911212144, -19.197526625692454, 129.53066754880612, 184.15999999999997, 185.14999999999992, -91.64785150553573, -34.112243078080226, 107.88105311682719, -126.52289427634116, -147.18991870961497, -25.886376104765414, -327.8575256805999, 180.19710126044816, 2.0000000000000013, 190.2996859070633, 47.36488585428566, -195.16149165438046, 158.61326585470692, -230.30736903877693, 20.96427756957297, -27.42050648205584, -38.66458261982701, -31.531715607806188, 2.0000000000000013, 2.0000000000000013, 21.85848007227022, 69.64685393280877, 11.89999999999996, -196.88646284954473, -18.383202527234882, 25.72870463621348, -35.54619263377409, -29.712955514388813, -11.267281560480571, 169.47364245559268, -27.768565354854285, -0.8743607562601132, 122.67549990779844, 188.8058757318983, -20.45928140940566, -166.42124638186925, -169.00987992593943, 181.19000000000003, -6.841244211332635, -46.539347712533875, 185.62782470539554, 54.53645949806599, 124.81906614757284, 131.70800842359685, -17.716558209141766, 2.0000000000000013, -34.82060156483794, -8.594938629268675, 23.780000000000264, -11.427650222986816, 82.17793606031955, 2.0000000000000013, -18.853042832877072, -4.3361623245972645, -21.73055202652187, 139.6100000000002, -19.05602805503831, -31.564886890329134, -10.920180697527211, -47.786711936010285, -47.50044079572771, -4.194470228289527, -13.215985676710112, -58.22013269548792, 144.5600000000001, -31.47482726328879, -12.269538934013587, 196.03999999999996, -28.749282689971025, 154.87383697043782, 176.23999999999995, -5.682193801099556, 160.39999999999986], "policy_predator_policy_reward": [47.56805254719842, 40.071970484197784, 55.64442087583362, 63.6066568087448, 2.0847899997846038, 2.304814504318762, 32.29640953546136, 4.557689015049768, 9.17587017646586, 69.56898656864685, 44.5215830158795, 2.267288792590847, 262.4193876273821, 9.186176181091625, 27.85486299176292, 32.1897514544387, 42.18484222726212, 89.83094225913824, 66.87987768789557, 68.60431420116043, 0.0, 41.731216116253194, 16.133360317295374, 299.2968833171403, 138.47237231859899, 1.4744272303054158, 0.0, 98.7580056786355, 63.41292144167779, 4.415021659585532, 38.27049735844307, 4.257769789597936, 34.816221381145276, 17.52803616158518, 29.396867657386494, 3.790806767078177, 24.566767698259355, 0.0, 0.0, 54.02352532726561, 8.667126349142416, 24.88857959172808, 57.37706821175719, 25.01786064600569, 1.5280599670249344, 65.32345335617308, 86.78281959356477, 15.716054970643217, 266.33099871546045, 4.734633184087931, 54.02785110316779, 0.0, 0.0, 21.910326456558796, 23.336935555658393, 614.3441461490899, 14.70050318444223, 0.0, 101.59557733903212, 32.859180251579595, 25.414494911079977, 17.967262789905952, 28.32819270003016, 34.258709321786064, 0.0, 22.572500155536357, 6.038150970611816, 155.28447419807225, 21.178255453465116, 0.0, 51.67555739802154, 12.918105471216473, 1.7809406639386276, 4.601377872379407, 14.463575468349708, 607.6872889542308, 0.0, 8.886913776873199, 23.40727821581797, 34.757045862569996, 2.0421800721250203, 34.747552872048004, 3.87577064061157, 20.611717964027847, 2.4293518055256995, 622.0278145223706, 37.97946460649502, 39.931092999694364, 3.745008436908768, 12.609576390113094, 106.69090328846553, 31.184086285228585, 15.940169773762948, 12.298079342548176, 5.12024235326665, 53.92311627892231, 98.69704641693187, 15.333573842669397, 43.87732002585596, 49.063519625339055, 13.02737418276462, 65.4037602808939, 226.94734089350644, 4.596195492251878, 51.141276495141994, 33.082119413802346, 23.361646551357488, 1.6896697479629514, 536.5560755665738, 617.2694685526664, 27.44621055776765, 601.2764913559821, 18.29180808993536, 16.05567619260713, 31.53552817543384, 24.20963657903001, 548.1933567096584, 539.8339401168881, 85.81881423986745, 131.12090880735548, 673.0620987932839, 696.0824290594775, 8.969966645955827, 828.9264288798157, 8.012733702635414, 6.730393379712855, 33.27408015333964, 66.45471437979516, 52.268946883172816, 36.04224307807984, 537.2393242239675, 0.0, 192.90129398596343, 338.9551874442063, 13.802898739551846, 0.0, 33.49862842475515, 46.60511414571415, 11.285085431213368, 324.7682257996736, 342.88412654877385, 0.0, 51.46235275571409, 34.543150533805466, 64.58214938187487, 17.55828052055528, 123.40127530283813, 20.467811393438424, 73.66184244381311, 62.613241510253445, 309.07646284954455, 20.34320252723519, 37.3083082201871, 110.76497436935288, 13.21728156048053, 31.622955514389112, 10.686357544407311, 29.70856535485459, 26.714500092201554, 30.494360756260104, 22.399281409405962, 6.214124268101656, 416.0632720207227, 356.22872630487217, 0.0, 8.811244211332593, 9.382175294604439, 48.31934771253355, 47.300933852427214, 98.73354050193413, 40.41199157640314, 19.686558209142074, 27.397021082555845, 36.75060156483756, 10.554938629268634, 0.0, 13.387650222986775, 71.11206393968047, 18.890636056338614, 1.8824067765387569, 5.837800858234925, 28.170697858391208, 8.034120384580662, 18.961299577845978, 33.48488689032891, 12.87018069752717, 48.430596761915446, 48.991568112591914, 6.164470228289485, 15.135985676710071, 14.179219427367022, 60.150132695487535, 14.219538934013546, 33.41482726328859, 0.0, 30.63928268997132, 4.1317598706412175, 4.312910570038962, 2.207678835886186, 24.45219380109952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5770880673359521, "mean_inference_ms": 1.433789773613866, "mean_action_processing_ms": 0.2496414758116002, "mean_env_wait_ms": 0.18914502485309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046041011810302734, "StateBufferConnector_ms": 0.0030367374420166016, "ViewRequirementAgentConnector_ms": 0.08388829231262207}, "num_episodes": 18, "episode_return_max": 707.5546579596114, "episode_return_min": 0.7317769401829964, "episode_return_mean": 155.53746057495275, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.1366501849282, "num_env_steps_trained_throughput_per_sec": 441.1366501849282, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 8929.519, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8929.483, "sample_time_ms": 997.548, "learn_time_ms": 7920.065, "learn_throughput": 505.046, "synch_weights_time_ms": 11.168}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "1f15c_00000", "date": "2024-08-16_14-10-42", "timestamp": 1723797642, "time_this_iter_s": 9.07046914100647, "time_total_s": 447.17503333091736, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f877e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 447.17503333091736, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 31.88461538461538, "ram_util_percent": 74.52307692307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5940410058728601, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3549548280617547, "policy_loss": -0.0037058039542494548, "vf_loss": 1.358323726531059, "vf_explained_var": 0.0172847588857015, "kl": 0.006738109869686879, "entropy": 0.8861477770817974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4374040377833857, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.729469658836486, "policy_loss": -0.005120403187290307, "vf_loss": 5.733417783716999, "vf_explained_var": 0.38144607900311706, "kl": 0.007815239707819086, "entropy": 1.3322891356453064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 707.5546579596114, "episode_reward_min": 0.7317769401829964, "episode_reward_mean": 179.9076420506818, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.9489427731633, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.03999999999996, "predator_policy": 828.9264288798157}, "policy_reward_mean": {"prey_policy": 6.2690643589619235, "predator_policy": 83.684756666379}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.630000000000496, 338.5399999999997, 162.26999999999987, 166.18000000000012, 25.489756782533, 153.07000000000008, 111.24000000000031, 361.2, 203.90999999999974, 70.87436467013706, 354.4199999999999, 199.82166402786874, 0.7317769401829964, 167.18999999999977, 171.24999999999966, 197.56999999999942, 169.25000000000034, 31.4200000000004, 140.4009406639388, 44.259999999999856, 70.28000000000128, 3.789999999999963, 136.6521800721241, 164.29999999999984, 184.44540230736584, 184.72797308523516, 174.02500843690882, 148.24000000000035, 27.411160615496573, 342.61024235326653, 195.80999999999966, 5.694644865517118, 265.1873741827639, 115.25000000000026, 157.00447868799142, 330.5196503430741, 483.52391733701154, 202.27999999999994, 17.742043703643446, 336.88500856193644, 626.1795763337553, 169.9706698663676, 707.5546579596114, 181.00987777886488, 328.4337946311541, 193.23094302759768, 162.07999999999987, 263.5265112380111, 178.11257964480393, 195.99999999999966, 317.76831433181763, 299.50508543121316, 133.5410350795703, 19.920414187637373, 52.608714294623454, 167.72756676854664, 217.82193788687437, 114.15000000000026, 138.2557945919801, 3.8599999999999604, 182.09999999999974, 179.00999999999982, 196.95999999999964, 436.8608720177862, 183.15999999999985, 196.78999999999962, 325.3899999999999, 174.08999999999986, 31.327021082556453, 25.740000000000535, 155.25000000000034, 3.919999999999959, 7.941784365506674, 147.5493919073885, 3.8699999999999615, 2.1350121427701225, 3.8899999999999606, 160.66921942736707, 3.889999999999961, 197.92999999999955, 339.5585074111174, 181.3776788358856, 71.75025112876622, 126.69423877425497, 182.3969969121394, 182.0514400135753, 153.22000000000017, 251.23455004948008, 172.397003003635, 182.10999999999984, 362.61811445548, 214.35975144187847, 314.6899999999997, 315.3009352682609, 19.79000000000056, 354.26999999999975, 330.0954107885484, 100.20000000000005, 214.23429928706082, 185.58666606529232], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, 5.063232301740626, 154.45999999999998, 130.0564746727344, 151.69302673364837, -22.978732674518646, 114.17956988150769, -30.394498739270357, -42.624904078221505, 1.2631475375556025, -13.786054970643258, 64.35718040643523, -2.7546331840879734, -157.0709987154607, 187.13000000000005, 120.0421488968322, 156.23967354344117, 25.760000000000215, -568.8067170346113, 2.0000000000000013, 188.11999999999995, 151.59949681555776, 2.0000000000000013, 63.36690643725743, -19.165485849722632, -23.484494911079675, 140.30731851009904, -35.70422053191563, -20.632500155536054, 169.3099999999999, 38.84624486977355, -2.5988700384578802, 2.5217445465348765, 145.55000000000018, -49.91555739802185, 16.741894528783625, 135.65, -1.631377872379441, -565.3672889542306, -12.52357546834975, 59.393086223126545, 2.0000000000000013, -1.6929739090037101, -52.681350169384636, 97.86244712795231, 2.0000000000000013, 158.48422935938837, -18.671717964027543, -509.03724529664066, 69.02548127611072, 158.42000000000007, -51.602584520954075, -10.649576390113136, 168.3200000000001, -29.23408628522828, 39.59909671153446, -2.8270885008151616, 2.0000000000000013, 151.49000000000007, 132.0768837210777, 178.6664261573306, -96.88704641693094, -29.301546091512996, -57.94464869416488, 70.90623971910608, 115.85000000000036, -2.6161954922519204, -113.67734089350652, 2.0000000000000013, 70.7810827790467, 136.96835344864263, 168.49998059511128, -6.3526840090645, -663.9489427731633, -208.23835693110067, -218.2043449826487, -18.605440578898968, 2.0000000000000013, 145.56951739410306, 135.57032641337, -370.37222054857847, -91.4754999442121, -15.980753081517847, -30.98830009933753, -85.0073319406036, -576.5825379525465, -637.6889911212144, -19.197526625692454, 129.53066754880612, 184.15999999999997, 185.14999999999992, -91.64785150553573, -34.112243078080226, 107.88105311682719, -126.52289427634116, -147.18991870961497, -25.886376104765414, -327.8575256805999, 180.19710126044816, 2.0000000000000013, 190.2996859070633, 47.36488585428566, -195.16149165438046, 158.61326585470692, -230.30736903877693, 20.96427756957297, -27.42050648205584, -38.66458261982701, -31.531715607806188, 2.0000000000000013, 2.0000000000000013, 21.85848007227022, 69.64685393280877, 11.89999999999996, -196.88646284954473, -18.383202527234882, 25.72870463621348, -35.54619263377409, -29.712955514388813, -11.267281560480571, 169.47364245559268, -27.768565354854285, -0.8743607562601132, 122.67549990779844, 188.8058757318983, -20.45928140940566, -166.42124638186925, -169.00987992593943, 181.19000000000003, -6.841244211332635, -46.539347712533875, 185.62782470539554, 54.53645949806599, 124.81906614757284, 131.70800842359685, -17.716558209141766, 2.0000000000000013, -34.82060156483794, -8.594938629268675, 23.780000000000264, -11.427650222986816, 82.17793606031955, 2.0000000000000013, -18.853042832877072, -4.3361623245972645, -21.73055202652187, 139.6100000000002, -19.05602805503831, -31.564886890329134, -10.920180697527211, -47.786711936010285, -47.50044079572771, -4.194470228289527, -13.215985676710112, -58.22013269548792, 144.5600000000001, -31.47482726328879, -12.269538934013587, 196.03999999999996, -28.749282689971025, 154.87383697043782, 176.23999999999995, -5.682193801099556, 160.39999999999986, -88.71922526752248, -8.75266154803215, -11.874238774254433, 110.89999999999993, -169.2482361741966, 20.810000000000272, 68.06547677983504, 2.0000000000000013, 126.31341767554389, -47.65544782409595, -176.41218777237813, -285.5813653361591, -12.742109773383275, 168.32, -4.872257432314512, 154.95458060035656, 179.20999999999998, 107.9757526780287, -5.853004454787495, 183.78185770735317, 112.15059060215779, 150.78322146527012, -25.632854367999656, 173.26999999999998, -2.365303542730752, 11.462599450191526, 102.8362886197965, 163.1452781771222, 153.96574402191442, 163.36999999999978, -51.28319026200056, -104.58780355702865, -53.4528752443824, 166.34, -60.82058805665564, 151.48999999999995], "policy_predator_policy_reward": [24.566767698259355, 0.0, 0.0, 54.02352532726561, 8.667126349142416, 24.88857959172808, 57.37706821175719, 25.01786064600569, 1.5280599670249344, 65.32345335617308, 86.78281959356477, 15.716054970643217, 266.33099871546045, 4.734633184087931, 54.02785110316779, 0.0, 0.0, 21.910326456558796, 23.336935555658393, 614.3441461490899, 14.70050318444223, 0.0, 101.59557733903212, 32.859180251579595, 25.414494911079977, 17.967262789905952, 28.32819270003016, 34.258709321786064, 0.0, 22.572500155536357, 6.038150970611816, 155.28447419807225, 21.178255453465116, 0.0, 51.67555739802154, 12.918105471216473, 1.7809406639386276, 4.601377872379407, 14.463575468349708, 607.6872889542308, 0.0, 8.886913776873199, 23.40727821581797, 34.757045862569996, 2.0421800721250203, 34.747552872048004, 3.87577064061157, 20.611717964027847, 2.4293518055256995, 622.0278145223706, 37.97946460649502, 39.931092999694364, 3.745008436908768, 12.609576390113094, 106.69090328846553, 31.184086285228585, 15.940169773762948, 12.298079342548176, 5.12024235326665, 53.92311627892231, 98.69704641693187, 15.333573842669397, 43.87732002585596, 49.063519625339055, 13.02737418276462, 65.4037602808939, 226.94734089350644, 4.596195492251878, 51.141276495141994, 33.082119413802346, 23.361646551357488, 1.6896697479629514, 536.5560755665738, 617.2694685526664, 27.44621055776765, 601.2764913559821, 18.29180808993536, 16.05567619260713, 31.53552817543384, 24.20963657903001, 548.1933567096584, 539.8339401168881, 85.81881423986745, 131.12090880735548, 673.0620987932839, 696.0824290594775, 8.969966645955827, 828.9264288798157, 8.012733702635414, 6.730393379712855, 33.27408015333964, 66.45471437979516, 52.268946883172816, 36.04224307807984, 537.2393242239675, 0.0, 192.90129398596343, 338.9551874442063, 13.802898739551846, 0.0, 33.49862842475515, 46.60511414571415, 11.285085431213368, 324.7682257996736, 342.88412654877385, 0.0, 51.46235275571409, 34.543150533805466, 64.58214938187487, 17.55828052055528, 123.40127530283813, 20.467811393438424, 73.66184244381311, 62.613241510253445, 309.07646284954455, 20.34320252723519, 37.3083082201871, 110.76497436935288, 13.21728156048053, 31.622955514389112, 10.686357544407311, 29.70856535485459, 26.714500092201554, 30.494360756260104, 22.399281409405962, 6.214124268101656, 416.0632720207227, 356.22872630487217, 0.0, 8.811244211332593, 9.382175294604439, 48.31934771253355, 47.300933852427214, 98.73354050193413, 40.41199157640314, 19.686558209142074, 27.397021082555845, 36.75060156483756, 10.554938629268634, 0.0, 13.387650222986775, 71.11206393968047, 18.890636056338614, 1.8824067765387569, 5.837800858234925, 28.170697858391208, 8.034120384580662, 18.961299577845978, 33.48488689032891, 12.87018069752717, 48.430596761915446, 48.991568112591914, 6.164470228289485, 15.135985676710071, 14.179219427367022, 60.150132695487535, 14.219538934013546, 33.41482726328859, 0.0, 30.63928268997132, 4.1317598706412175, 4.312910570038962, 2.207678835886186, 24.45219380109952, 88.43313395558756, 80.78900398873233, 13.834238774254391, 13.834238774254391, 102.74699691214128, 228.08823617419583, 55.008589328882366, 56.97737390485823, 18.16658232445619, 56.395447824095605, 358.27107494473785, 354.95702821327967, 2.343031405793101, 14.476081371225252, 25.175419399643452, 6.852257432314469, 55.65893302475664, 19.773428752694663, 20.131056649580195, 16.299841539733084, 40.209409397842215, 11.546778534729706, 1.8209352682608786, 165.8428543679996, 4.34530354273071, 6.347400549808436, 11.07472182287783, 77.21371138020352, 2.4054107885489038, 10.354255978085746, 53.17319026200018, 202.89780355702894, 87.9528752443821, 13.394299287061308, 40.13147784047449, 54.785776281473176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5756313902514976, "mean_inference_ms": 1.430422665681273, "mean_action_processing_ms": 0.2488730767803102, "mean_env_wait_ms": 0.1886150039188365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005002140998840332, "StateBufferConnector_ms": 0.003042936325073242, "ViewRequirementAgentConnector_ms": 0.08401453495025635}, "num_episodes": 18, "episode_return_max": 707.5546579596114, "episode_return_min": 0.7317769401829964, "episode_return_mean": 179.9076420506818, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.4096552450823, "num_env_steps_trained_throughput_per_sec": 440.4096552450823, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 8940.695, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8940.659, "sample_time_ms": 990.646, "learn_time_ms": 7938.298, "learn_throughput": 503.886, "synch_weights_time_ms": 11.016}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "1f15c_00000", "date": "2024-08-16_14-10-51", "timestamp": 1723797651, "time_this_iter_s": 9.085224151611328, "time_total_s": 456.2602574825287, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f877040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 456.2602574825287, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 32.19230769230769, "ram_util_percent": 74.43076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8674980035219243, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.372787307384153, "policy_loss": -0.003453018520121024, "vf_loss": 1.3758752564352656, "vf_explained_var": 0.019039609066393008, "kl": 0.007301358858995475, "entropy": 1.0069820826331144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.569076315404246, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.864056721187773, "policy_loss": -0.004627454555815175, "vf_loss": 5.867635655024695, "vf_explained_var": 0.2695874150783297, "kl": 0.006990221018854297, "entropy": 1.3321003891172862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 707.5546579596114, "episode_reward_min": 2.1350121427701225, "episode_reward_mean": 193.13009944739562, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.9489427731633, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 828.9264288798157}, "policy_reward_mean": {"prey_policy": 15.60949421269284, "predator_policy": 80.95555551100504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.6521800721241, 164.29999999999984, 184.44540230736584, 184.72797308523516, 174.02500843690882, 148.24000000000035, 27.411160615496573, 342.61024235326653, 195.80999999999966, 5.694644865517118, 265.1873741827639, 115.25000000000026, 157.00447868799142, 330.5196503430741, 483.52391733701154, 202.27999999999994, 17.742043703643446, 336.88500856193644, 626.1795763337553, 169.9706698663676, 707.5546579596114, 181.00987777886488, 328.4337946311541, 193.23094302759768, 162.07999999999987, 263.5265112380111, 178.11257964480393, 195.99999999999966, 317.76831433181763, 299.50508543121316, 133.5410350795703, 19.920414187637373, 52.608714294623454, 167.72756676854664, 217.82193788687437, 114.15000000000026, 138.2557945919801, 3.8599999999999604, 182.09999999999974, 179.00999999999982, 196.95999999999964, 436.8608720177862, 183.15999999999985, 196.78999999999962, 325.3899999999999, 174.08999999999986, 31.327021082556453, 25.740000000000535, 155.25000000000034, 3.919999999999959, 7.941784365506674, 147.5493919073885, 3.8699999999999615, 2.1350121427701225, 3.8899999999999606, 160.66921942736707, 3.889999999999961, 197.92999999999955, 339.5585074111174, 181.3776788358856, 71.75025112876622, 126.69423877425497, 182.3969969121394, 182.0514400135753, 153.22000000000017, 251.23455004948008, 172.397003003635, 182.10999999999984, 362.61811445548, 214.35975144187847, 314.6899999999997, 315.3009352682609, 19.79000000000056, 354.26999999999975, 330.0954107885484, 100.20000000000005, 214.23429928706082, 185.58666606529232, 209.68521106859453, 439.83799012241093, 278.29612319986467, 185.5767216552019, 334.42546317087147, 12.013916192205158, 343.04624726596853, 380.06, 17.061782329072965, 179.0255562531782, 15.849999999999918, 396.5071107781164, 184.58208049843017, 380.82097151222797, 300.01379494167765, 3.9199999999999604, 9.699999999999921, 363.0758287020635, 239.82012066284386, 215.98532440332502, 3.8599999999999577, 3.8699999999999632], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [97.86244712795231, 2.0000000000000013, 158.48422935938837, -18.671717964027543, -509.03724529664066, 69.02548127611072, 158.42000000000007, -51.602584520954075, -10.649576390113136, 168.3200000000001, -29.23408628522828, 39.59909671153446, -2.8270885008151616, 2.0000000000000013, 151.49000000000007, 132.0768837210777, 178.6664261573306, -96.88704641693094, -29.301546091512996, -57.94464869416488, 70.90623971910608, 115.85000000000036, -2.6161954922519204, -113.67734089350652, 2.0000000000000013, 70.7810827790467, 136.96835344864263, 168.49998059511128, -6.3526840090645, -663.9489427731633, -208.23835693110067, -218.2043449826487, -18.605440578898968, 2.0000000000000013, 145.56951739410306, 135.57032641337, -370.37222054857847, -91.4754999442121, -15.980753081517847, -30.98830009933753, -85.0073319406036, -576.5825379525465, -637.6889911212144, -19.197526625692454, 129.53066754880612, 184.15999999999997, 185.14999999999992, -91.64785150553573, -34.112243078080226, 107.88105311682719, -126.52289427634116, -147.18991870961497, -25.886376104765414, -327.8575256805999, 180.19710126044816, 2.0000000000000013, 190.2996859070633, 47.36488585428566, -195.16149165438046, 158.61326585470692, -230.30736903877693, 20.96427756957297, -27.42050648205584, -38.66458261982701, -31.531715607806188, 2.0000000000000013, 2.0000000000000013, 21.85848007227022, 69.64685393280877, 11.89999999999996, -196.88646284954473, -18.383202527234882, 25.72870463621348, -35.54619263377409, -29.712955514388813, -11.267281560480571, 169.47364245559268, -27.768565354854285, -0.8743607562601132, 122.67549990779844, 188.8058757318983, -20.45928140940566, -166.42124638186925, -169.00987992593943, 181.19000000000003, -6.841244211332635, -46.539347712533875, 185.62782470539554, 54.53645949806599, 124.81906614757284, 131.70800842359685, -17.716558209141766, 2.0000000000000013, -34.82060156483794, -8.594938629268675, 23.780000000000264, -11.427650222986816, 82.17793606031955, 2.0000000000000013, -18.853042832877072, -4.3361623245972645, -21.73055202652187, 139.6100000000002, -19.05602805503831, -31.564886890329134, -10.920180697527211, -47.786711936010285, -47.50044079572771, -4.194470228289527, -13.215985676710112, -58.22013269548792, 144.5600000000001, -31.47482726328879, -12.269538934013587, 196.03999999999996, -28.749282689971025, 154.87383697043782, 176.23999999999995, -5.682193801099556, 160.39999999999986, -88.71922526752248, -8.75266154803215, -11.874238774254433, 110.89999999999993, -169.2482361741966, 20.810000000000272, 68.06547677983504, 2.0000000000000013, 126.31341767554389, -47.65544782409595, -176.41218777237813, -285.5813653361591, -12.742109773383275, 168.32, -4.872257432314512, 154.95458060035656, 179.20999999999998, 107.9757526780287, -5.853004454787495, 183.78185770735317, 112.15059060215779, 150.78322146527012, -25.632854367999656, 173.26999999999998, -2.365303542730752, 11.462599450191526, 102.8362886197965, 163.1452781771222, 153.96574402191442, 163.36999999999978, -51.28319026200056, -104.58780355702865, -53.4528752443824, 166.34, -60.82058805665564, 151.48999999999995, -62.335600733016356, 177.22999999999985, 186.13999999999987, -119.30747395262529, 1.4201550093245885, 50.13354820306624, 158.35805450514755, -27.540891004169563, 116.05754063042816, 79.65206239144231, -14.376511492404328, -41.13986299427273, 104.99746032282938, 200.0, 160.4420472238338, 183.01049599618585, 2.0000000000000013, -35.78727728180762, -24.0785748985738, 170.3, 6.877707108593391, 2.0000000000000013, 168.30068159679078, 131.20849099046407, 65.79882799786287, 2.0000000000000013, 166.59778212192208, 132.8421185145522, 117.93957965018147, 92.40377615659702, -2.7699243731697374, -14.085430317992607, -28.32328851213884, -17.732786771761607, 147.94201549898634, 154.00553720805306, -102.63726423928158, 132.66156775069953, 184.37335465951725, -35.66375685894176, -11.36633245497395, -52.230284063675455, -12.445523439962273, -18.949138151393466], "policy_predator_policy_reward": [2.0421800721250203, 34.747552872048004, 3.87577064061157, 20.611717964027847, 2.4293518055256995, 622.0278145223706, 37.97946460649502, 39.931092999694364, 3.745008436908768, 12.609576390113094, 106.69090328846553, 31.184086285228585, 15.940169773762948, 12.298079342548176, 5.12024235326665, 53.92311627892231, 98.69704641693187, 15.333573842669397, 43.87732002585596, 49.063519625339055, 13.02737418276462, 65.4037602808939, 226.94734089350644, 4.596195492251878, 51.141276495141994, 33.082119413802346, 23.361646551357488, 1.6896697479629514, 536.5560755665738, 617.2694685526664, 27.44621055776765, 601.2764913559821, 18.29180808993536, 16.05567619260713, 31.53552817543384, 24.20963657903001, 548.1933567096584, 539.8339401168881, 85.81881423986745, 131.12090880735548, 673.0620987932839, 696.0824290594775, 8.969966645955827, 828.9264288798157, 8.012733702635414, 6.730393379712855, 33.27408015333964, 66.45471437979516, 52.268946883172816, 36.04224307807984, 537.2393242239675, 0.0, 192.90129398596343, 338.9551874442063, 13.802898739551846, 0.0, 33.49862842475515, 46.60511414571415, 11.285085431213368, 324.7682257996736, 342.88412654877385, 0.0, 51.46235275571409, 34.543150533805466, 64.58214938187487, 17.55828052055528, 123.40127530283813, 20.467811393438424, 73.66184244381311, 62.613241510253445, 309.07646284954455, 20.34320252723519, 37.3083082201871, 110.76497436935288, 13.21728156048053, 31.622955514389112, 10.686357544407311, 29.70856535485459, 26.714500092201554, 30.494360756260104, 22.399281409405962, 6.214124268101656, 416.0632720207227, 356.22872630487217, 0.0, 8.811244211332593, 9.382175294604439, 48.31934771253355, 47.300933852427214, 98.73354050193413, 40.41199157640314, 19.686558209142074, 27.397021082555845, 36.75060156483756, 10.554938629268634, 0.0, 13.387650222986775, 71.11206393968047, 18.890636056338614, 1.8824067765387569, 5.837800858234925, 28.170697858391208, 8.034120384580662, 18.961299577845978, 33.48488689032891, 12.87018069752717, 48.430596761915446, 48.991568112591914, 6.164470228289485, 15.135985676710071, 14.179219427367022, 60.150132695487535, 14.219538934013546, 33.41482726328859, 0.0, 30.63928268997132, 4.1317598706412175, 4.312910570038962, 2.207678835886186, 24.45219380109952, 88.43313395558756, 80.78900398873233, 13.834238774254391, 13.834238774254391, 102.74699691214128, 228.08823617419583, 55.008589328882366, 56.97737390485823, 18.16658232445619, 56.395447824095605, 358.27107494473785, 354.95702821327967, 2.343031405793101, 14.476081371225252, 25.175419399643452, 6.852257432314469, 55.65893302475664, 19.773428752694663, 20.131056649580195, 16.299841539733084, 40.209409397842215, 11.546778534729706, 1.8209352682608786, 165.8428543679996, 4.34530354273071, 6.347400549808436, 11.07472182287783, 77.21371138020352, 2.4054107885489038, 10.354255978085746, 53.17319026200018, 202.89780355702894, 87.9528752443821, 13.394299287061308, 40.13147784047449, 54.785776281473176, 61.57475630601058, 33.216055495600855, 115.95029025626914, 257.05517381876723, 69.93479508553693, 156.80762490193692, 28.706823533474967, 26.052734620749423, 58.28153302782889, 80.43432712117209, 28.240201473746772, 39.290089205135175, 4.902714905079328, 33.14607203805998, 24.61795277616621, 11.989504003814137, 13.14178232907286, 37.70727728180724, 26.028574898574107, 6.775556253178362, 5.339983469302095, 1.6323094221044745, 35.8391425883018, 61.15879560255978, 104.88850400810549, 11.894748492462057, 48.43317166096692, 32.94789921478673, 5.905490378581091, 83.76494875631806, 16.025430317992566, 4.749924373169695, 19.66278677176191, 36.09328851213912, 11.470202335578676, 49.65807365944556, 209.79581715142584, 0.0, 31.18320178208988, 36.092524820659854, 13.326332454973908, 54.13028406367508, 14.385523439962231, 20.879138151393768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5741804072804133, "mean_inference_ms": 1.4266511008232003, "mean_action_processing_ms": 0.24759826358728965, "mean_env_wait_ms": 0.18793389782576178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005454421043395996, "StateBufferConnector_ms": 0.0030487775802612305, "ViewRequirementAgentConnector_ms": 0.0838238000869751}, "num_episodes": 22, "episode_return_max": 707.5546579596114, "episode_return_min": 2.1350121427701225, "episode_return_mean": 193.13009944739562, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.2128048298687, "num_env_steps_trained_throughput_per_sec": 435.2128048298687, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 8966.321, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8966.285, "sample_time_ms": 987.836, "learn_time_ms": 7966.854, "learn_throughput": 502.08, "synch_weights_time_ms": 10.876}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "1f15c_00000", "date": "2024-08-16_14-11-00", "timestamp": 1723797660, "time_this_iter_s": 9.193892240524292, "time_total_s": 465.454149723053, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8baca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 465.454149723053, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 32.07692307692308, "ram_util_percent": 74.27692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7351562079771486, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.355300855762744, "policy_loss": -0.005705892731233564, "vf_loss": 3.3603316926451585, "vf_explained_var": 0.03317016716356631, "kl": 0.013501157765259257, "entropy": 0.8134315844566103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3299222488409628, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.878804609006044, "policy_loss": -0.005472655638204838, "vf_loss": 5.8824265394261275, "vf_explained_var": 0.10147533252756431, "kl": 0.01233823749223417, "entropy": 1.329758004410557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 597.3842514563931, "episode_reward_min": -267.3194187120226, "episode_reward_mean": 188.51062135091124, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -830.1034889957577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 952.3294823084608}, "policy_reward_mean": {"prey_policy": 22.30798607480907, "predator_policy": 71.94732460064662}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.23094302759768, 162.07999999999987, 263.5265112380111, 178.11257964480393, 195.99999999999966, 317.76831433181763, 299.50508543121316, 133.5410350795703, 19.920414187637373, 52.608714294623454, 167.72756676854664, 217.82193788687437, 114.15000000000026, 138.2557945919801, 3.8599999999999604, 182.09999999999974, 179.00999999999982, 196.95999999999964, 436.8608720177862, 183.15999999999985, 196.78999999999962, 325.3899999999999, 174.08999999999986, 31.327021082556453, 25.740000000000535, 155.25000000000034, 3.919999999999959, 7.941784365506674, 147.5493919073885, 3.8699999999999615, 2.1350121427701225, 3.8899999999999606, 160.66921942736707, 3.889999999999961, 197.92999999999955, 339.5585074111174, 181.3776788358856, 71.75025112876622, 126.69423877425497, 182.3969969121394, 182.0514400135753, 153.22000000000017, 251.23455004948008, 172.397003003635, 182.10999999999984, 362.61811445548, 214.35975144187847, 314.6899999999997, 315.3009352682609, 19.79000000000056, 354.26999999999975, 330.0954107885484, 100.20000000000005, 214.23429928706082, 185.58666606529232, 209.68521106859453, 439.83799012241093, 278.29612319986467, 185.5767216552019, 334.42546317087147, 12.013916192205158, 343.04624726596853, 380.06, 17.061782329072965, 179.0255562531782, 15.849999999999918, 396.5071107781164, 184.58208049843017, 380.82097151222797, 300.01379494167765, 3.9199999999999604, 9.699999999999921, 363.0758287020635, 239.82012066284386, 215.98532440332502, 3.8599999999999577, 3.8699999999999632, 281.46, 184.3347117367608, 355.27000000000004, 179.86999999999986, 71.3970629027501, 195.0727099787895, 597.3842514563931, 198.90999999999963, 387.93955778777945, 16.49423066336918, 444.62621250190193, 181.6667623807046, 134.05, 374.21257446860074, 190.06999999999982, 196.95999999999964, 392.86067226220615, 360.5469848850873, 133.1038756653969, 213.27616623445203, -267.3194187120226, 177.97999999999985, 23.343497261482295], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [185.14999999999992, -91.64785150553573, -34.112243078080226, 107.88105311682719, -126.52289427634116, -147.18991870961497, -25.886376104765414, -327.8575256805999, 180.19710126044816, 2.0000000000000013, 190.2996859070633, 47.36488585428566, -195.16149165438046, 158.61326585470692, -230.30736903877693, 20.96427756957297, -27.42050648205584, -38.66458261982701, -31.531715607806188, 2.0000000000000013, 2.0000000000000013, 21.85848007227022, 69.64685393280877, 11.89999999999996, -196.88646284954473, -18.383202527234882, 25.72870463621348, -35.54619263377409, -29.712955514388813, -11.267281560480571, 169.47364245559268, -27.768565354854285, -0.8743607562601132, 122.67549990779844, 188.8058757318983, -20.45928140940566, -166.42124638186925, -169.00987992593943, 181.19000000000003, -6.841244211332635, -46.539347712533875, 185.62782470539554, 54.53645949806599, 124.81906614757284, 131.70800842359685, -17.716558209141766, 2.0000000000000013, -34.82060156483794, -8.594938629268675, 23.780000000000264, -11.427650222986816, 82.17793606031955, 2.0000000000000013, -18.853042832877072, -4.3361623245972645, -21.73055202652187, 139.6100000000002, -19.05602805503831, -31.564886890329134, -10.920180697527211, -47.786711936010285, -47.50044079572771, -4.194470228289527, -13.215985676710112, -58.22013269548792, 144.5600000000001, -31.47482726328879, -12.269538934013587, 196.03999999999996, -28.749282689971025, 154.87383697043782, 176.23999999999995, -5.682193801099556, 160.39999999999986, -88.71922526752248, -8.75266154803215, -11.874238774254433, 110.89999999999993, -169.2482361741966, 20.810000000000272, 68.06547677983504, 2.0000000000000013, 126.31341767554389, -47.65544782409595, -176.41218777237813, -285.5813653361591, -12.742109773383275, 168.32, -4.872257432314512, 154.95458060035656, 179.20999999999998, 107.9757526780287, -5.853004454787495, 183.78185770735317, 112.15059060215779, 150.78322146527012, -25.632854367999656, 173.26999999999998, -2.365303542730752, 11.462599450191526, 102.8362886197965, 163.1452781771222, 153.96574402191442, 163.36999999999978, -51.28319026200056, -104.58780355702865, -53.4528752443824, 166.34, -60.82058805665564, 151.48999999999995, -62.335600733016356, 177.22999999999985, 186.13999999999987, -119.30747395262529, 1.4201550093245885, 50.13354820306624, 158.35805450514755, -27.540891004169563, 116.05754063042816, 79.65206239144231, -14.376511492404328, -41.13986299427273, 104.99746032282938, 200.0, 160.4420472238338, 183.01049599618585, 2.0000000000000013, -35.78727728180762, -24.0785748985738, 170.3, 6.877707108593391, 2.0000000000000013, 168.30068159679078, 131.20849099046407, 65.79882799786287, 2.0000000000000013, 166.59778212192208, 132.8421185145522, 117.93957965018147, 92.40377615659702, -2.7699243731697374, -14.085430317992607, -28.32328851213884, -17.732786771761607, 147.94201549898634, 154.00553720805306, -102.63726423928158, 132.66156775069953, 184.37335465951725, -35.66375685894176, -11.36633245497395, -52.230284063675455, -12.445523439962273, -18.949138151393466, -106.10368595214985, 169.8105061403547, 49.973348292482086, -3.3670975062082853, 166.39718739764206, 138.59889321190124, 110.98663227408305, -10.555155530059132, -94.92263635355837, -352.05893268740255, -20.329488120022326, 131.421789770808, -121.85475286602451, 151.0753973376745, -33.26974401135128, 190.23506219781774, 189.17342392526763, 181.4609135719598, -18.9655978030236, -15.281030437814554, 136.24131527816695, -364.556430922398, -35.0121691610886, 174.26, -4.513208219033762, -30.643754663253333, 123.70379893218652, 163.62017118718643, 188.12000000000006, -8.07803867759266, -28.087334461259523, 191.21647061503973, 2.0000000000000013, -400.3966820627599, 129.1553001216791, 173.26999999999998, -161.1543041460782, 2.0000000000000013, -5.509009156429048, 134.77149786326942, -446.33686023302135, -830.1034889957577, 120.38059995484826, -24.753948151624115, -80.41991224825594, -27.211948166100992], "policy_predator_policy_reward": [33.27408015333964, 66.45471437979516, 52.268946883172816, 36.04224307807984, 537.2393242239675, 0.0, 192.90129398596343, 338.9551874442063, 13.802898739551846, 0.0, 33.49862842475515, 46.60511414571415, 11.285085431213368, 324.7682257996736, 342.88412654877385, 0.0, 51.46235275571409, 34.543150533805466, 64.58214938187487, 17.55828052055528, 123.40127530283813, 20.467811393438424, 73.66184244381311, 62.613241510253445, 309.07646284954455, 20.34320252723519, 37.3083082201871, 110.76497436935288, 13.21728156048053, 31.622955514389112, 10.686357544407311, 29.70856535485459, 26.714500092201554, 30.494360756260104, 22.399281409405962, 6.214124268101656, 416.0632720207227, 356.22872630487217, 0.0, 8.811244211332593, 9.382175294604439, 48.31934771253355, 47.300933852427214, 98.73354050193413, 40.41199157640314, 19.686558209142074, 27.397021082555845, 36.75060156483756, 10.554938629268634, 0.0, 13.387650222986775, 71.11206393968047, 18.890636056338614, 1.8824067765387569, 5.837800858234925, 28.170697858391208, 8.034120384580662, 18.961299577845978, 33.48488689032891, 12.87018069752717, 48.430596761915446, 48.991568112591914, 6.164470228289485, 15.135985676710071, 14.179219427367022, 60.150132695487535, 14.219538934013546, 33.41482726328859, 0.0, 30.63928268997132, 4.1317598706412175, 4.312910570038962, 2.207678835886186, 24.45219380109952, 88.43313395558756, 80.78900398873233, 13.834238774254391, 13.834238774254391, 102.74699691214128, 228.08823617419583, 55.008589328882366, 56.97737390485823, 18.16658232445619, 56.395447824095605, 358.27107494473785, 354.95702821327967, 2.343031405793101, 14.476081371225252, 25.175419399643452, 6.852257432314469, 55.65893302475664, 19.773428752694663, 20.131056649580195, 16.299841539733084, 40.209409397842215, 11.546778534729706, 1.8209352682608786, 165.8428543679996, 4.34530354273071, 6.347400549808436, 11.07472182287783, 77.21371138020352, 2.4054107885489038, 10.354255978085746, 53.17319026200018, 202.89780355702894, 87.9528752443821, 13.394299287061308, 40.13147784047449, 54.785776281473176, 61.57475630601058, 33.216055495600855, 115.95029025626914, 257.05517381876723, 69.93479508553693, 156.80762490193692, 28.706823533474967, 26.052734620749423, 58.28153302782889, 80.43432712117209, 28.240201473746772, 39.290089205135175, 4.902714905079328, 33.14607203805998, 24.61795277616621, 11.989504003814137, 13.14178232907286, 37.70727728180724, 26.028574898574107, 6.775556253178362, 5.339983469302095, 1.6323094221044745, 35.8391425883018, 61.15879560255978, 104.88850400810549, 11.894748492462057, 48.43317166096692, 32.94789921478673, 5.905490378581091, 83.76494875631806, 16.025430317992566, 4.749924373169695, 19.66278677176191, 36.09328851213912, 11.470202335578676, 49.65807365944556, 209.79581715142584, 0.0, 31.18320178208988, 36.092524820659854, 13.326332454973908, 54.13028406367508, 14.385523439962231, 20.879138151393768, 0.0, 217.75317981179512, 87.07362798699494, 50.65483296349219, 36.51110678809878, 13.762812602357943, 18.395155530059093, 61.04336772591695, 509.9404235096245, 8.438208434086505, 52.62694568427125, 31.353462643733103, 285.03334252218616, 283.13026446255714, 35.1797440113509, 6.764937802182261, 9.536042975592627, 7.769177314959416, 31.044706279126302, 19.696152625081474, 444.94298345612754, 227.9983446900053, 5.476762380704775, 36.942169161088216, 7.463208219033721, 161.74375466325336, 18.382756057556062, 68.5058482916717, 0.0, 10.028038677592619, 30.017334461259825, 3.81352938496026, 339.57451203437495, 451.68284229059213, 32.62300252249078, 25.498682240917212, 247.50326147046545, 44.75491834100944, 39.376720297563, 44.63695723004912, 952.3294823084608, 56.79144820829604, 26.69394815162442, 55.65940004515172, 81.59096724283428, 49.3843904330056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5726210333921969, "mean_inference_ms": 1.4218100411985646, "mean_action_processing_ms": 0.24704915187626508, "mean_env_wait_ms": 0.1877812640020845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056765079498291016, "StateBufferConnector_ms": 0.003033280372619629, "ViewRequirementAgentConnector_ms": 0.0832512378692627}, "num_episodes": 23, "episode_return_max": 597.3842514563931, "episode_return_min": -267.3194187120226, "episode_return_mean": 188.51062135091124, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.0940481089303, "num_env_steps_trained_throughput_per_sec": 443.0940481089303, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 8985.341, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8985.306, "sample_time_ms": 980.897, "learn_time_ms": 7992.644, "learn_throughput": 500.46, "synch_weights_time_ms": 11.066}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "1f15c_00000", "date": "2024-08-16_14-11-09", "timestamp": 1723797669, "time_this_iter_s": 9.03054690361023, "time_total_s": 474.4846966266632, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8adc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 474.4846966266632, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 31.353846153846156, "ram_util_percent": 74.36923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.031561817299752, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.350633647580626, "policy_loss": -0.0031384842563913296, "vf_loss": 2.353265710230227, "vf_explained_var": 0.05590215628109281, "kl": 0.010128324329863745, "entropy": 0.8575843167998803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.222366567799654, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.0768485470423625, "policy_loss": -0.0063788394116003205, "vf_loss": 5.081797870252498, "vf_explained_var": 0.0008103680042993455, "kl": 0.009530158861197312, "entropy": 1.2540865997788768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 597.3842514563931, "episode_reward_min": -267.3194187120226, "episode_reward_mean": 185.6660648786371, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -830.1034889957577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 952.3294823084608}, "policy_reward_mean": {"prey_policy": 18.52772748796663, "predator_policy": 74.30530495135197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [436.8608720177862, 183.15999999999985, 196.78999999999962, 325.3899999999999, 174.08999999999986, 31.327021082556453, 25.740000000000535, 155.25000000000034, 3.919999999999959, 7.941784365506674, 147.5493919073885, 3.8699999999999615, 2.1350121427701225, 3.8899999999999606, 160.66921942736707, 3.889999999999961, 197.92999999999955, 339.5585074111174, 181.3776788358856, 71.75025112876622, 126.69423877425497, 182.3969969121394, 182.0514400135753, 153.22000000000017, 251.23455004948008, 172.397003003635, 182.10999999999984, 362.61811445548, 214.35975144187847, 314.6899999999997, 315.3009352682609, 19.79000000000056, 354.26999999999975, 330.0954107885484, 100.20000000000005, 214.23429928706082, 185.58666606529232, 209.68521106859453, 439.83799012241093, 278.29612319986467, 185.5767216552019, 334.42546317087147, 12.013916192205158, 343.04624726596853, 380.06, 17.061782329072965, 179.0255562531782, 15.849999999999918, 396.5071107781164, 184.58208049843017, 380.82097151222797, 300.01379494167765, 3.9199999999999604, 9.699999999999921, 363.0758287020635, 239.82012066284386, 215.98532440332502, 3.8599999999999577, 3.8699999999999632, 281.46, 184.3347117367608, 355.27000000000004, 179.86999999999986, 71.3970629027501, 195.0727099787895, 597.3842514563931, 198.90999999999963, 387.93955778777945, 16.49423066336918, 444.62621250190193, 181.6667623807046, 134.05, 374.21257446860074, 190.06999999999982, 196.95999999999964, 392.86067226220615, 360.5469848850873, 133.1038756653969, 213.27616623445203, -267.3194187120226, 177.97999999999985, 23.343497261482295, 257.59405790246785, 158.34326835004535, 185.32739317403954, 3.829999999999961, 171.1499999999998, 192.35733103113293, 174.98999999999984, 359.7357859250786, 192.9299999999997, 3.9099999999999597, 132.08000000000033, 138.8746361248371, 4.906992828391794, 371.21, 9.210890738847914, 197.18529341348045, 172.96530809336133, 5.122291673576843], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-166.42124638186925, -169.00987992593943, 181.19000000000003, -6.841244211332635, -46.539347712533875, 185.62782470539554, 54.53645949806599, 124.81906614757284, 131.70800842359685, -17.716558209141766, 2.0000000000000013, -34.82060156483794, -8.594938629268675, 23.780000000000264, -11.427650222986816, 82.17793606031955, 2.0000000000000013, -18.853042832877072, -4.3361623245972645, -21.73055202652187, 139.6100000000002, -19.05602805503831, -31.564886890329134, -10.920180697527211, -47.786711936010285, -47.50044079572771, -4.194470228289527, -13.215985676710112, -58.22013269548792, 144.5600000000001, -31.47482726328879, -12.269538934013587, 196.03999999999996, -28.749282689971025, 154.87383697043782, 176.23999999999995, -5.682193801099556, 160.39999999999986, -88.71922526752248, -8.75266154803215, -11.874238774254433, 110.89999999999993, -169.2482361741966, 20.810000000000272, 68.06547677983504, 2.0000000000000013, 126.31341767554389, -47.65544782409595, -176.41218777237813, -285.5813653361591, -12.742109773383275, 168.32, -4.872257432314512, 154.95458060035656, 179.20999999999998, 107.9757526780287, -5.853004454787495, 183.78185770735317, 112.15059060215779, 150.78322146527012, -25.632854367999656, 173.26999999999998, -2.365303542730752, 11.462599450191526, 102.8362886197965, 163.1452781771222, 153.96574402191442, 163.36999999999978, -51.28319026200056, -104.58780355702865, -53.4528752443824, 166.34, -60.82058805665564, 151.48999999999995, -62.335600733016356, 177.22999999999985, 186.13999999999987, -119.30747395262529, 1.4201550093245885, 50.13354820306624, 158.35805450514755, -27.540891004169563, 116.05754063042816, 79.65206239144231, -14.376511492404328, -41.13986299427273, 104.99746032282938, 200.0, 160.4420472238338, 183.01049599618585, 2.0000000000000013, -35.78727728180762, -24.0785748985738, 170.3, 6.877707108593391, 2.0000000000000013, 168.30068159679078, 131.20849099046407, 65.79882799786287, 2.0000000000000013, 166.59778212192208, 132.8421185145522, 117.93957965018147, 92.40377615659702, -2.7699243731697374, -14.085430317992607, -28.32328851213884, -17.732786771761607, 147.94201549898634, 154.00553720805306, -102.63726423928158, 132.66156775069953, 184.37335465951725, -35.66375685894176, -11.36633245497395, -52.230284063675455, -12.445523439962273, -18.949138151393466, -106.10368595214985, 169.8105061403547, 49.973348292482086, -3.3670975062082853, 166.39718739764206, 138.59889321190124, 110.98663227408305, -10.555155530059132, -94.92263635355837, -352.05893268740255, -20.329488120022326, 131.421789770808, -121.85475286602451, 151.0753973376745, -33.26974401135128, 190.23506219781774, 189.17342392526763, 181.4609135719598, -18.9655978030236, -15.281030437814554, 136.24131527816695, -364.556430922398, -35.0121691610886, 174.26, -4.513208219033762, -30.643754663253333, 123.70379893218652, 163.62017118718643, 188.12000000000006, -8.07803867759266, -28.087334461259523, 191.21647061503973, 2.0000000000000013, -400.3966820627599, 129.1553001216791, 173.26999999999998, -161.1543041460782, 2.0000000000000013, -5.509009156429048, 134.77149786326942, -446.33686023302135, -830.1034889957577, 120.38059995484826, -24.753948151624115, -80.41991224825594, -27.211948166100992, 36.984401276364196, -669.7076276409917, -113.08691005256654, -84.41914340840688, 2.0000000000000013, 69.41417906019852, -79.14916175249888, -2.8003339600698443, -23.009498148144957, 151.0730178489825, 23.1501461330449, -183.60308222470624, 107.3145173557665, -43.55512729129521, 179.64235251200301, 123.71567716522391, 168.19576581783056, -44.82709970767062, -3.4330769532566165, -29.90796237918473, -33.83327015320699, 0.47074699654122115, -512.2714173189934, -355.9272949483132, -30.01625111056655, -2.314336731114312, 156.40478677073907, 179.21, -0.10885233215973147, -47.933988127417855, 3.4516000321841447, 144.61730362529843, 2.0000000000000013, 145.8492219637819, -45.9951797684475, -54.28727098167493], "policy_predator_policy_reward": [416.0632720207227, 356.22872630487217, 0.0, 8.811244211332593, 9.382175294604439, 48.31934771253355, 47.300933852427214, 98.73354050193413, 40.41199157640314, 19.686558209142074, 27.397021082555845, 36.75060156483756, 10.554938629268634, 0.0, 13.387650222986775, 71.11206393968047, 18.890636056338614, 1.8824067765387569, 5.837800858234925, 28.170697858391208, 8.034120384580662, 18.961299577845978, 33.48488689032891, 12.87018069752717, 48.430596761915446, 48.991568112591914, 6.164470228289485, 15.135985676710071, 14.179219427367022, 60.150132695487535, 14.219538934013546, 33.41482726328859, 0.0, 30.63928268997132, 4.1317598706412175, 4.312910570038962, 2.207678835886186, 24.45219380109952, 88.43313395558756, 80.78900398873233, 13.834238774254391, 13.834238774254391, 102.74699691214128, 228.08823617419583, 55.008589328882366, 56.97737390485823, 18.16658232445619, 56.395447824095605, 358.27107494473785, 354.95702821327967, 2.343031405793101, 14.476081371225252, 25.175419399643452, 6.852257432314469, 55.65893302475664, 19.773428752694663, 20.131056649580195, 16.299841539733084, 40.209409397842215, 11.546778534729706, 1.8209352682608786, 165.8428543679996, 4.34530354273071, 6.347400549808436, 11.07472182287783, 77.21371138020352, 2.4054107885489038, 10.354255978085746, 53.17319026200018, 202.89780355702894, 87.9528752443821, 13.394299287061308, 40.13147784047449, 54.785776281473176, 61.57475630601058, 33.216055495600855, 115.95029025626914, 257.05517381876723, 69.93479508553693, 156.80762490193692, 28.706823533474967, 26.052734620749423, 58.28153302782889, 80.43432712117209, 28.240201473746772, 39.290089205135175, 4.902714905079328, 33.14607203805998, 24.61795277616621, 11.989504003814137, 13.14178232907286, 37.70727728180724, 26.028574898574107, 6.775556253178362, 5.339983469302095, 1.6323094221044745, 35.8391425883018, 61.15879560255978, 104.88850400810549, 11.894748492462057, 48.43317166096692, 32.94789921478673, 5.905490378581091, 83.76494875631806, 16.025430317992566, 4.749924373169695, 19.66278677176191, 36.09328851213912, 11.470202335578676, 49.65807365944556, 209.79581715142584, 0.0, 31.18320178208988, 36.092524820659854, 13.326332454973908, 54.13028406367508, 14.385523439962231, 20.879138151393768, 0.0, 217.75317981179512, 87.07362798699494, 50.65483296349219, 36.51110678809878, 13.762812602357943, 18.395155530059093, 61.04336772591695, 509.9404235096245, 8.438208434086505, 52.62694568427125, 31.353462643733103, 285.03334252218616, 283.13026446255714, 35.1797440113509, 6.764937802182261, 9.536042975592627, 7.769177314959416, 31.044706279126302, 19.696152625081474, 444.94298345612754, 227.9983446900053, 5.476762380704775, 36.942169161088216, 7.463208219033721, 161.74375466325336, 18.382756057556062, 68.5058482916717, 0.0, 10.028038677592619, 30.017334461259825, 3.81352938496026, 339.57451203437495, 451.68284229059213, 32.62300252249078, 25.498682240917212, 247.50326147046545, 44.75491834100944, 39.376720297563, 44.63695723004912, 952.3294823084608, 56.79144820829604, 26.69394815162442, 55.65940004515172, 81.59096724283428, 49.3843904330056, 620.0818205561419, 270.2354637109531, 105.94724093656667, 249.90208087445197, 109.58582093980148, 4.327393174039764, 4.780333960069802, 80.99916175249983, 2.1428774118790774, 40.94360288728373, 350.6348834364316, 2.175383686362557, 65.75548264423348, 45.475127291294825, 32.55364971386275, 23.824106533989173, 22.80423418216944, 46.757099707670235, 3.753970656883597, 33.49706867555801, 113.40775731627815, 52.0347658403876, 656.3500564888147, 350.72329190332897, 5.271329559506125, 31.966251110566855, 0.0, 35.595213229260935, 24.40663473974915, 32.84709645867608, 3.7336933812966207, 45.38269637470156, 9.267548214831809, 15.84853791474796, 58.23444597342759, 47.170296450271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5705809069605925, "mean_inference_ms": 1.4183306801581765, "mean_action_processing_ms": 0.24626000092221872, "mean_env_wait_ms": 0.18677305404322525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004734635353088379, "StateBufferConnector_ms": 0.002912282943725586, "ViewRequirementAgentConnector_ms": 0.0810086727142334}, "num_episodes": 18, "episode_return_max": 597.3842514563931, "episode_return_min": -267.3194187120226, "episode_return_mean": 185.6660648786371, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.2818180263818, "num_env_steps_trained_throughput_per_sec": 437.2818180263818, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 9014.16, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9014.125, "sample_time_ms": 985.147, "learn_time_ms": 8017.024, "learn_throughput": 498.938, "synch_weights_time_ms": 11.254}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "1f15c_00000", "date": "2024-08-16_14-11-18", "timestamp": 1723797678, "time_this_iter_s": 9.150950193405151, "time_total_s": 483.63564682006836, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8e2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 483.63564682006836, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 32.99230769230769, "ram_util_percent": 74.38461538461537}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5156281198301012, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0601521782143406, "policy_loss": -0.012792886658349918, "vf_loss": 2.072402297378217, "vf_explained_var": 0.062334454374969324, "kl": 0.0108552643659872, "entropy": 0.8815622892960039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2522362346371647, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.641141382474748, "policy_loss": -0.0054280614201965, "vf_loss": 5.645227845005257, "vf_explained_var": 0.47216338603584856, "kl": 0.008943981049690942, "entropy": 1.238377627304622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 597.3842514563931, "episode_reward_min": -267.3194187120226, "episode_reward_mean": 196.5955592259694, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -830.1034889957577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 952.3294823084608}, "policy_reward_mean": {"prey_policy": 20.337857620629414, "predator_policy": 77.95992199235533}, "custom_metrics": {}, "hist_stats": {"episode_reward": [181.3776788358856, 71.75025112876622, 126.69423877425497, 182.3969969121394, 182.0514400135753, 153.22000000000017, 251.23455004948008, 172.397003003635, 182.10999999999984, 362.61811445548, 214.35975144187847, 314.6899999999997, 315.3009352682609, 19.79000000000056, 354.26999999999975, 330.0954107885484, 100.20000000000005, 214.23429928706082, 185.58666606529232, 209.68521106859453, 439.83799012241093, 278.29612319986467, 185.5767216552019, 334.42546317087147, 12.013916192205158, 343.04624726596853, 380.06, 17.061782329072965, 179.0255562531782, 15.849999999999918, 396.5071107781164, 184.58208049843017, 380.82097151222797, 300.01379494167765, 3.9199999999999604, 9.699999999999921, 363.0758287020635, 239.82012066284386, 215.98532440332502, 3.8599999999999577, 3.8699999999999632, 281.46, 184.3347117367608, 355.27000000000004, 179.86999999999986, 71.3970629027501, 195.0727099787895, 597.3842514563931, 198.90999999999963, 387.93955778777945, 16.49423066336918, 444.62621250190193, 181.6667623807046, 134.05, 374.21257446860074, 190.06999999999982, 196.95999999999964, 392.86067226220615, 360.5469848850873, 133.1038756653969, 213.27616623445203, -267.3194187120226, 177.97999999999985, 23.343497261482295, 257.59405790246785, 158.34326835004535, 185.32739317403954, 3.829999999999961, 171.1499999999998, 192.35733103113293, 174.98999999999984, 359.7357859250786, 192.9299999999997, 3.9099999999999597, 132.08000000000033, 138.8746361248371, 4.906992828391794, 371.21, 9.210890738847914, 197.18529341348045, 172.96530809336133, 5.122291673576843, 146.9600000000002, 240.29911456296935, 353.8913442422324, 372.0, 368.1354755264189, 330.8361680119401, 6.809999999999919, 185.77759434303533, 114.41861631639904, 13.214374425410252, 327.23698367176866, 119.35000000000065, 6.889999999999917, 203.78842128884224, 173.5974163269358, 14.489174623772097, 177.01655974799536, 338.2], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.682193801099556, 160.39999999999986, -88.71922526752248, -8.75266154803215, -11.874238774254433, 110.89999999999993, -169.2482361741966, 20.810000000000272, 68.06547677983504, 2.0000000000000013, 126.31341767554389, -47.65544782409595, -176.41218777237813, -285.5813653361591, -12.742109773383275, 168.32, -4.872257432314512, 154.95458060035656, 179.20999999999998, 107.9757526780287, -5.853004454787495, 183.78185770735317, 112.15059060215779, 150.78322146527012, -25.632854367999656, 173.26999999999998, -2.365303542730752, 11.462599450191526, 102.8362886197965, 163.1452781771222, 153.96574402191442, 163.36999999999978, -51.28319026200056, -104.58780355702865, -53.4528752443824, 166.34, -60.82058805665564, 151.48999999999995, -62.335600733016356, 177.22999999999985, 186.13999999999987, -119.30747395262529, 1.4201550093245885, 50.13354820306624, 158.35805450514755, -27.540891004169563, 116.05754063042816, 79.65206239144231, -14.376511492404328, -41.13986299427273, 104.99746032282938, 200.0, 160.4420472238338, 183.01049599618585, 2.0000000000000013, -35.78727728180762, -24.0785748985738, 170.3, 6.877707108593391, 2.0000000000000013, 168.30068159679078, 131.20849099046407, 65.79882799786287, 2.0000000000000013, 166.59778212192208, 132.8421185145522, 117.93957965018147, 92.40377615659702, -2.7699243731697374, -14.085430317992607, -28.32328851213884, -17.732786771761607, 147.94201549898634, 154.00553720805306, -102.63726423928158, 132.66156775069953, 184.37335465951725, -35.66375685894176, -11.36633245497395, -52.230284063675455, -12.445523439962273, -18.949138151393466, -106.10368595214985, 169.8105061403547, 49.973348292482086, -3.3670975062082853, 166.39718739764206, 138.59889321190124, 110.98663227408305, -10.555155530059132, -94.92263635355837, -352.05893268740255, -20.329488120022326, 131.421789770808, -121.85475286602451, 151.0753973376745, -33.26974401135128, 190.23506219781774, 189.17342392526763, 181.4609135719598, -18.9655978030236, -15.281030437814554, 136.24131527816695, -364.556430922398, -35.0121691610886, 174.26, -4.513208219033762, -30.643754663253333, 123.70379893218652, 163.62017118718643, 188.12000000000006, -8.07803867759266, -28.087334461259523, 191.21647061503973, 2.0000000000000013, -400.3966820627599, 129.1553001216791, 173.26999999999998, -161.1543041460782, 2.0000000000000013, -5.509009156429048, 134.77149786326942, -446.33686023302135, -830.1034889957577, 120.38059995484826, -24.753948151624115, -80.41991224825594, -27.211948166100992, 36.984401276364196, -669.7076276409917, -113.08691005256654, -84.41914340840688, 2.0000000000000013, 69.41417906019852, -79.14916175249888, -2.8003339600698443, -23.009498148144957, 151.0730178489825, 23.1501461330449, -183.60308222470624, 107.3145173557665, -43.55512729129521, 179.64235251200301, 123.71567716522391, 168.19576581783056, -44.82709970767062, -3.4330769532566165, -29.90796237918473, -33.83327015320699, 0.47074699654122115, -512.2714173189934, -355.9272949483132, -30.01625111056655, -2.314336731114312, 156.40478677073907, 179.21, -0.10885233215973147, -47.933988127417855, 3.4516000321841447, 144.61730362529843, 2.0000000000000013, 145.8492219637819, -45.9951797684475, -54.28727098167493, -12.260450060169934, -41.809764981656464, 50.294508855276476, -203.4821976310982, 155.3552137125653, 148.71422105063303, 130.65754258239087, 156.4755902416748, 182.18, 167.19439770642344, 110.22566382218767, 94.47633982340841, -23.94233474163678, -28.901442536857996, 2.0000000000000013, 49.843939137082145, -170.104774825355, 2.0000000000000013, -27.24700724311837, -4.83881145934266, 75.7676353505741, 90.45709684498088, -8.991976045023073, -42.813148395104534, -9.808645857387749, -2.7214753115752632, 157.816701060791, 2.0000000000000013, -38.57085304731403, 113.43797504084085, 2.0000000000000013, -52.3449496385265, -113.69821594129714, 3.077722862285004, 114.70717335241625, 122.7997747055788], "policy_predator_policy_reward": [2.207678835886186, 24.45219380109952, 88.43313395558756, 80.78900398873233, 13.834238774254391, 13.834238774254391, 102.74699691214128, 228.08823617419583, 55.008589328882366, 56.97737390485823, 18.16658232445619, 56.395447824095605, 358.27107494473785, 354.95702821327967, 2.343031405793101, 14.476081371225252, 25.175419399643452, 6.852257432314469, 55.65893302475664, 19.773428752694663, 20.131056649580195, 16.299841539733084, 40.209409397842215, 11.546778534729706, 1.8209352682608786, 165.8428543679996, 4.34530354273071, 6.347400549808436, 11.07472182287783, 77.21371138020352, 2.4054107885489038, 10.354255978085746, 53.17319026200018, 202.89780355702894, 87.9528752443821, 13.394299287061308, 40.13147784047449, 54.785776281473176, 61.57475630601058, 33.216055495600855, 115.95029025626914, 257.05517381876723, 69.93479508553693, 156.80762490193692, 28.706823533474967, 26.052734620749423, 58.28153302782889, 80.43432712117209, 28.240201473746772, 39.290089205135175, 4.902714905079328, 33.14607203805998, 24.61795277616621, 11.989504003814137, 13.14178232907286, 37.70727728180724, 26.028574898574107, 6.775556253178362, 5.339983469302095, 1.6323094221044745, 35.8391425883018, 61.15879560255978, 104.88850400810549, 11.894748492462057, 48.43317166096692, 32.94789921478673, 5.905490378581091, 83.76494875631806, 16.025430317992566, 4.749924373169695, 19.66278677176191, 36.09328851213912, 11.470202335578676, 49.65807365944556, 209.79581715142584, 0.0, 31.18320178208988, 36.092524820659854, 13.326332454973908, 54.13028406367508, 14.385523439962231, 20.879138151393768, 0.0, 217.75317981179512, 87.07362798699494, 50.65483296349219, 36.51110678809878, 13.762812602357943, 18.395155530059093, 61.04336772591695, 509.9404235096245, 8.438208434086505, 52.62694568427125, 31.353462643733103, 285.03334252218616, 283.13026446255714, 35.1797440113509, 6.764937802182261, 9.536042975592627, 7.769177314959416, 31.044706279126302, 19.696152625081474, 444.94298345612754, 227.9983446900053, 5.476762380704775, 36.942169161088216, 7.463208219033721, 161.74375466325336, 18.382756057556062, 68.5058482916717, 0.0, 10.028038677592619, 30.017334461259825, 3.81352938496026, 339.57451203437495, 451.68284229059213, 32.62300252249078, 25.498682240917212, 247.50326147046545, 44.75491834100944, 39.376720297563, 44.63695723004912, 952.3294823084608, 56.79144820829604, 26.69394815162442, 55.65940004515172, 81.59096724283428, 49.3843904330056, 620.0818205561419, 270.2354637109531, 105.94724093656667, 249.90208087445197, 109.58582093980148, 4.327393174039764, 4.780333960069802, 80.99916175249983, 2.1428774118790774, 40.94360288728373, 350.6348834364316, 2.175383686362557, 65.75548264423348, 45.475127291294825, 32.55364971386275, 23.824106533989173, 22.80423418216944, 46.757099707670235, 3.753970656883597, 33.49706867555801, 113.40775731627815, 52.0347658403876, 656.3500564888147, 350.72329190332897, 5.271329559506125, 31.966251110566855, 0.0, 35.595213229260935, 24.40663473974915, 32.84709645867608, 3.7336933812966207, 45.38269637470156, 9.267548214831809, 15.84853791474796, 58.23444597342759, 47.170296450271, 186.80976498165637, 14.220450060169892, 377.52662037201026, 15.960182966780875, 15.646333335704847, 34.17557614332923, 34.524409758325206, 50.34245741760912, 7.785475526418901, 10.97560229357654, 86.10718033844276, 40.026984027901285, 30.8514425368583, 28.802334741637072, 126.15606086291785, 7.777594343035595, 183.47545475168306, 99.04793639007065, 12.847231190202233, 32.4529619376694, 66.39330533840993, 94.61894613780396, 44.70314839510416, 126.45197604502305, 4.701475311575221, 14.718645857387708, 27.253298939209017, 16.718421288842656, 83.66974208086215, 15.060552252546529, 48.51186376436449, 16.32226049793381, 63.96267981616097, 223.6743730108474, 100.69305194200491, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5688404167661072, "mean_inference_ms": 1.4139681103994035, "mean_action_processing_ms": 0.24544540427377862, "mean_env_wait_ms": 0.18615793359450536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004369497299194336, "StateBufferConnector_ms": 0.0028171539306640625, "ViewRequirementAgentConnector_ms": 0.08052968978881836}, "num_episodes": 18, "episode_return_max": 597.3842514563931, "episode_return_min": -267.3194187120226, "episode_return_mean": 196.5955592259694, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.031905732079, "num_env_steps_trained_throughput_per_sec": 435.031905732079, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 9043.143, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9043.108, "sample_time_ms": 988.05, "learn_time_ms": 8043.236, "learn_throughput": 497.312, "synch_weights_time_ms": 11.126}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "1f15c_00000", "date": "2024-08-16_14-11-27", "timestamp": 1723797687, "time_this_iter_s": 9.197912693023682, "time_total_s": 492.83355951309204, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8720d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 492.83355951309204, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 32.10000000000001, "ram_util_percent": 74.43076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2825573839050122, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.43782783740412, "policy_loss": -0.010083414885959534, "vf_loss": 1.447358339835727, "vf_explained_var": 0.025674217781692585, "kl": 0.01105832573815684, "entropy": 0.8791632277940317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.636890495801098, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.113799329535671, "policy_loss": -0.004388683353595081, "vf_loss": 5.1165620260137725, "vf_explained_var": 0.6085492552272858, "kl": 0.010839919576537035, "entropy": 1.237906627617185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 597.3842514563931, "episode_reward_min": -267.3194187120226, "episode_reward_mean": 191.45943645631232, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -830.1034889957577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 952.3294823084608}, "policy_reward_mean": {"prey_policy": 17.448986025532903, "predator_policy": 78.28073220262335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.58666606529232, 209.68521106859453, 439.83799012241093, 278.29612319986467, 185.5767216552019, 334.42546317087147, 12.013916192205158, 343.04624726596853, 380.06, 17.061782329072965, 179.0255562531782, 15.849999999999918, 396.5071107781164, 184.58208049843017, 380.82097151222797, 300.01379494167765, 3.9199999999999604, 9.699999999999921, 363.0758287020635, 239.82012066284386, 215.98532440332502, 3.8599999999999577, 3.8699999999999632, 281.46, 184.3347117367608, 355.27000000000004, 179.86999999999986, 71.3970629027501, 195.0727099787895, 597.3842514563931, 198.90999999999963, 387.93955778777945, 16.49423066336918, 444.62621250190193, 181.6667623807046, 134.05, 374.21257446860074, 190.06999999999982, 196.95999999999964, 392.86067226220615, 360.5469848850873, 133.1038756653969, 213.27616623445203, -267.3194187120226, 177.97999999999985, 23.343497261482295, 257.59405790246785, 158.34326835004535, 185.32739317403954, 3.829999999999961, 171.1499999999998, 192.35733103113293, 174.98999999999984, 359.7357859250786, 192.9299999999997, 3.9099999999999597, 132.08000000000033, 138.8746361248371, 4.906992828391794, 371.21, 9.210890738847914, 197.18529341348045, 172.96530809336133, 5.122291673576843, 146.9600000000002, 240.29911456296935, 353.8913442422324, 372.0, 368.1354755264189, 330.8361680119401, 6.809999999999919, 185.77759434303533, 114.41861631639904, 13.214374425410252, 327.23698367176866, 119.35000000000065, 6.889999999999917, 203.78842128884224, 173.5974163269358, 14.489174623772097, 177.01655974799536, 338.2, 180.97999999999973, 208.9931137478842, 225.8363521999183, 327.60249825623487, 201.2996605340984, 103.9100000000003, 132.06000000000026, 188.7528501652929, 212.8337868119815, 233.6767796823106, 224.39854373076014, 245.4651167797383, 3.8599999999999626, 4.719999999999942, 312.91109155757704, 3.7499999999999636, 406.0436809227591, -1.9150813952954813], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-60.82058805665564, 151.48999999999995, -62.335600733016356, 177.22999999999985, 186.13999999999987, -119.30747395262529, 1.4201550093245885, 50.13354820306624, 158.35805450514755, -27.540891004169563, 116.05754063042816, 79.65206239144231, -14.376511492404328, -41.13986299427273, 104.99746032282938, 200.0, 160.4420472238338, 183.01049599618585, 2.0000000000000013, -35.78727728180762, -24.0785748985738, 170.3, 6.877707108593391, 2.0000000000000013, 168.30068159679078, 131.20849099046407, 65.79882799786287, 2.0000000000000013, 166.59778212192208, 132.8421185145522, 117.93957965018147, 92.40377615659702, -2.7699243731697374, -14.085430317992607, -28.32328851213884, -17.732786771761607, 147.94201549898634, 154.00553720805306, -102.63726423928158, 132.66156775069953, 184.37335465951725, -35.66375685894176, -11.36633245497395, -52.230284063675455, -12.445523439962273, -18.949138151393466, -106.10368595214985, 169.8105061403547, 49.973348292482086, -3.3670975062082853, 166.39718739764206, 138.59889321190124, 110.98663227408305, -10.555155530059132, -94.92263635355837, -352.05893268740255, -20.329488120022326, 131.421789770808, -121.85475286602451, 151.0753973376745, -33.26974401135128, 190.23506219781774, 189.17342392526763, 181.4609135719598, -18.9655978030236, -15.281030437814554, 136.24131527816695, -364.556430922398, -35.0121691610886, 174.26, -4.513208219033762, -30.643754663253333, 123.70379893218652, 163.62017118718643, 188.12000000000006, -8.07803867759266, -28.087334461259523, 191.21647061503973, 2.0000000000000013, -400.3966820627599, 129.1553001216791, 173.26999999999998, -161.1543041460782, 2.0000000000000013, -5.509009156429048, 134.77149786326942, -446.33686023302135, -830.1034889957577, 120.38059995484826, -24.753948151624115, -80.41991224825594, -27.211948166100992, 36.984401276364196, -669.7076276409917, -113.08691005256654, -84.41914340840688, 2.0000000000000013, 69.41417906019852, -79.14916175249888, -2.8003339600698443, -23.009498148144957, 151.0730178489825, 23.1501461330449, -183.60308222470624, 107.3145173557665, -43.55512729129521, 179.64235251200301, 123.71567716522391, 168.19576581783056, -44.82709970767062, -3.4330769532566165, -29.90796237918473, -33.83327015320699, 0.47074699654122115, -512.2714173189934, -355.9272949483132, -30.01625111056655, -2.314336731114312, 156.40478677073907, 179.21, -0.10885233215973147, -47.933988127417855, 3.4516000321841447, 144.61730362529843, 2.0000000000000013, 145.8492219637819, -45.9951797684475, -54.28727098167493, -12.260450060169934, -41.809764981656464, 50.294508855276476, -203.4821976310982, 155.3552137125653, 148.71422105063303, 130.65754258239087, 156.4755902416748, 182.18, 167.19439770642344, 110.22566382218767, 94.47633982340841, -23.94233474163678, -28.901442536857996, 2.0000000000000013, 49.843939137082145, -170.104774825355, 2.0000000000000013, -27.24700724311837, -4.83881145934266, 75.7676353505741, 90.45709684498088, -8.991976045023073, -42.813148395104534, -9.808645857387749, -2.7214753115752632, 157.816701060791, 2.0000000000000013, -38.57085304731403, 113.43797504084085, 2.0000000000000013, -52.3449496385265, -113.69821594129714, 3.077722862285004, 114.70717335241625, 122.7997747055788, -3.563335230410864, 119.5611109550212, 189.11, -34.13806744309653, 197.1121410943379, -69.24879300276586, 152.05987741840414, 60.21514825092848, 182.18, -17.87912548807897, -128.81622574306573, -30.5156716912637, -6.97008850199056, -19.653854842594185, -20.670693673245776, 170.3, -43.59660089917334, 36.89811599753569, 28.2044488675987, 2.0000000000000013, -24.324662002567464, 2.0000000000000013, -23.02141677162625, 32.45952725546367, -10.348127995394501, -32.41096753983065, -80.56504690022386, -44.89465974907003, 110.3073191569201, 52.17760482567161, -27.9609705877637, -83.91167564944702, 200.0, 52.20819277499503, -8.749215888897806, -27.988753370467585], "policy_predator_policy_reward": [40.13147784047449, 54.785776281473176, 61.57475630601058, 33.216055495600855, 115.95029025626914, 257.05517381876723, 69.93479508553693, 156.80762490193692, 28.706823533474967, 26.052734620749423, 58.28153302782889, 80.43432712117209, 28.240201473746772, 39.290089205135175, 4.902714905079328, 33.14607203805998, 24.61795277616621, 11.989504003814137, 13.14178232907286, 37.70727728180724, 26.028574898574107, 6.775556253178362, 5.339983469302095, 1.6323094221044745, 35.8391425883018, 61.15879560255978, 104.88850400810549, 11.894748492462057, 48.43317166096692, 32.94789921478673, 5.905490378581091, 83.76494875631806, 16.025430317992566, 4.749924373169695, 19.66278677176191, 36.09328851213912, 11.470202335578676, 49.65807365944556, 209.79581715142584, 0.0, 31.18320178208988, 36.092524820659854, 13.326332454973908, 54.13028406367508, 14.385523439962231, 20.879138151393768, 0.0, 217.75317981179512, 87.07362798699494, 50.65483296349219, 36.51110678809878, 13.762812602357943, 18.395155530059093, 61.04336772591695, 509.9404235096245, 8.438208434086505, 52.62694568427125, 31.353462643733103, 285.03334252218616, 283.13026446255714, 35.1797440113509, 6.764937802182261, 9.536042975592627, 7.769177314959416, 31.044706279126302, 19.696152625081474, 444.94298345612754, 227.9983446900053, 5.476762380704775, 36.942169161088216, 7.463208219033721, 161.74375466325336, 18.382756057556062, 68.5058482916717, 0.0, 10.028038677592619, 30.017334461259825, 3.81352938496026, 339.57451203437495, 451.68284229059213, 32.62300252249078, 25.498682240917212, 247.50326147046545, 44.75491834100944, 39.376720297563, 44.63695723004912, 952.3294823084608, 56.79144820829604, 26.69394815162442, 55.65940004515172, 81.59096724283428, 49.3843904330056, 620.0818205561419, 270.2354637109531, 105.94724093656667, 249.90208087445197, 109.58582093980148, 4.327393174039764, 4.780333960069802, 80.99916175249983, 2.1428774118790774, 40.94360288728373, 350.6348834364316, 2.175383686362557, 65.75548264423348, 45.475127291294825, 32.55364971386275, 23.824106533989173, 22.80423418216944, 46.757099707670235, 3.753970656883597, 33.49706867555801, 113.40775731627815, 52.0347658403876, 656.3500564888147, 350.72329190332897, 5.271329559506125, 31.966251110566855, 0.0, 35.595213229260935, 24.40663473974915, 32.84709645867608, 3.7336933812966207, 45.38269637470156, 9.267548214831809, 15.84853791474796, 58.23444597342759, 47.170296450271, 186.80976498165637, 14.220450060169892, 377.52662037201026, 15.960182966780875, 15.646333335704847, 34.17557614332923, 34.524409758325206, 50.34245741760912, 7.785475526418901, 10.97560229357654, 86.10718033844276, 40.026984027901285, 30.8514425368583, 28.802334741637072, 126.15606086291785, 7.777594343035595, 183.47545475168306, 99.04793639007065, 12.847231190202233, 32.4529619376694, 66.39330533840993, 94.61894613780396, 44.70314839510416, 126.45197604502305, 4.701475311575221, 14.718645857387708, 27.253298939209017, 16.718421288842656, 83.66974208086215, 15.060552252546529, 48.51186376436449, 16.32226049793381, 63.96267981616097, 223.6743730108474, 100.69305194200491, 0.0, 41.03263210946989, 23.94959216591973, 34.04379626978482, 19.977384921195952, 51.92421390450665, 46.04879020384121, 0.0, 115.32747258690222, 11.239660534098778, 25.759125488079263, 235.5348727264693, 27.707024707860352, 3.3519808261787687, 155.33196251840633, 19.25483652314387, 19.868707315395298, 208.66433878531063, 10.867932928308589, 134.21188487695227, 69.26044593776032, 90.15988565598762, 156.5633200773405, 229.61528198645294, 6.411724309447771, 34.32096753983027, 12.29812799539446, 83.4050469002248, 46.774659749069656, 58.22149522080082, 92.20467235418499, 29.850970587763996, 85.77167564944797, 71.3248254225543, 82.51066272520985, 4.874134493602366, 29.94875337046789]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5671649639608153, "mean_inference_ms": 1.4098286523380918, "mean_action_processing_ms": 0.24466861613365518, "mean_env_wait_ms": 0.1855740520303673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004034519195556641, "StateBufferConnector_ms": 0.002862095832824707, "ViewRequirementAgentConnector_ms": 0.08198678493499756}, "num_episodes": 18, "episode_return_max": 597.3842514563931, "episode_return_min": -267.3194187120226, "episode_return_mean": 191.45943645631232, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.92078400305917, "num_env_steps_trained_throughput_per_sec": 437.92078400305917, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 9078.622, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9078.587, "sample_time_ms": 990.304, "learn_time_ms": 8076.341, "learn_throughput": 495.274, "synch_weights_time_ms": 11.245}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "1f15c_00000", "date": "2024-08-16_14-11-37", "timestamp": 1723797697, "time_this_iter_s": 9.13762903213501, "time_total_s": 501.97118854522705, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fe979d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 501.97118854522705, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 28.55384615384615, "ram_util_percent": 74.2923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2641499542843098, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.299339898553475, "policy_loss": -0.006036020705855831, "vf_loss": 3.304891022424849, "vf_explained_var": 0.02129776950866457, "kl": 0.009697935680631924, "entropy": 0.8035698133486289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5040543185024666, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.488153555027392, "policy_loss": -0.0043341729878669695, "vf_loss": 5.491636909252752, "vf_explained_var": 0.34923024392001845, "kl": 0.005672035867417817, "entropy": 1.2435551791594772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 597.3842514563931, "episode_reward_min": -267.3194187120226, "episode_reward_mean": 186.1314977203453, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -830.1034889957577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 952.3294823084608}, "policy_reward_mean": {"prey_policy": 10.065441234816394, "predator_policy": 83.00030762535634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8699999999999632, 281.46, 184.3347117367608, 355.27000000000004, 179.86999999999986, 71.3970629027501, 195.0727099787895, 597.3842514563931, 198.90999999999963, 387.93955778777945, 16.49423066336918, 444.62621250190193, 181.6667623807046, 134.05, 374.21257446860074, 190.06999999999982, 196.95999999999964, 392.86067226220615, 360.5469848850873, 133.1038756653969, 213.27616623445203, -267.3194187120226, 177.97999999999985, 23.343497261482295, 257.59405790246785, 158.34326835004535, 185.32739317403954, 3.829999999999961, 171.1499999999998, 192.35733103113293, 174.98999999999984, 359.7357859250786, 192.9299999999997, 3.9099999999999597, 132.08000000000033, 138.8746361248371, 4.906992828391794, 371.21, 9.210890738847914, 197.18529341348045, 172.96530809336133, 5.122291673576843, 146.9600000000002, 240.29911456296935, 353.8913442422324, 372.0, 368.1354755264189, 330.8361680119401, 6.809999999999919, 185.77759434303533, 114.41861631639904, 13.214374425410252, 327.23698367176866, 119.35000000000065, 6.889999999999917, 203.78842128884224, 173.5974163269358, 14.489174623772097, 177.01655974799536, 338.2, 180.97999999999973, 208.9931137478842, 225.8363521999183, 327.60249825623487, 201.2996605340984, 103.9100000000003, 132.06000000000026, 188.7528501652929, 212.8337868119815, 233.6767796823106, 224.39854373076014, 245.4651167797383, 3.8599999999999626, 4.719999999999942, 312.91109155757704, 3.7499999999999636, 406.0436809227591, -1.9150813952954813, 375.11, 244.792475047645, 3.2749087116620412, 3.669999999999966, 245.68697798998977, 178.40793007988952, 158.01000000000002, 124.19000000000041, 406.6465467409114, 351.63411269945396, 162.83911955700376, 215.22579738328835, 407.1451095532766, 164.98999999999984, 199.64791237938528, 3.849999999999962, 191.9499999999997, 178.9599999999998, 137.9300000000002, 176.86999999999983, 197.29880221758606, 17.827342864551735], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.445523439962273, -18.949138151393466, -106.10368595214985, 169.8105061403547, 49.973348292482086, -3.3670975062082853, 166.39718739764206, 138.59889321190124, 110.98663227408305, -10.555155530059132, -94.92263635355837, -352.05893268740255, -20.329488120022326, 131.421789770808, -121.85475286602451, 151.0753973376745, -33.26974401135128, 190.23506219781774, 189.17342392526763, 181.4609135719598, -18.9655978030236, -15.281030437814554, 136.24131527816695, -364.556430922398, -35.0121691610886, 174.26, -4.513208219033762, -30.643754663253333, 123.70379893218652, 163.62017118718643, 188.12000000000006, -8.07803867759266, -28.087334461259523, 191.21647061503973, 2.0000000000000013, -400.3966820627599, 129.1553001216791, 173.26999999999998, -161.1543041460782, 2.0000000000000013, -5.509009156429048, 134.77149786326942, -446.33686023302135, -830.1034889957577, 120.38059995484826, -24.753948151624115, -80.41991224825594, -27.211948166100992, 36.984401276364196, -669.7076276409917, -113.08691005256654, -84.41914340840688, 2.0000000000000013, 69.41417906019852, -79.14916175249888, -2.8003339600698443, -23.009498148144957, 151.0730178489825, 23.1501461330449, -183.60308222470624, 107.3145173557665, -43.55512729129521, 179.64235251200301, 123.71567716522391, 168.19576581783056, -44.82709970767062, -3.4330769532566165, -29.90796237918473, -33.83327015320699, 0.47074699654122115, -512.2714173189934, -355.9272949483132, -30.01625111056655, -2.314336731114312, 156.40478677073907, 179.21, -0.10885233215973147, -47.933988127417855, 3.4516000321841447, 144.61730362529843, 2.0000000000000013, 145.8492219637819, -45.9951797684475, -54.28727098167493, -12.260450060169934, -41.809764981656464, 50.294508855276476, -203.4821976310982, 155.3552137125653, 148.71422105063303, 130.65754258239087, 156.4755902416748, 182.18, 167.19439770642344, 110.22566382218767, 94.47633982340841, -23.94233474163678, -28.901442536857996, 2.0000000000000013, 49.843939137082145, -170.104774825355, 2.0000000000000013, -27.24700724311837, -4.83881145934266, 75.7676353505741, 90.45709684498088, -8.991976045023073, -42.813148395104534, -9.808645857387749, -2.7214753115752632, 157.816701060791, 2.0000000000000013, -38.57085304731403, 113.43797504084085, 2.0000000000000013, -52.3449496385265, -113.69821594129714, 3.077722862285004, 114.70717335241625, 122.7997747055788, -3.563335230410864, 119.5611109550212, 189.11, -34.13806744309653, 197.1121410943379, -69.24879300276586, 152.05987741840414, 60.21514825092848, 182.18, -17.87912548807897, -128.81622574306573, -30.5156716912637, -6.97008850199056, -19.653854842594185, -20.670693673245776, 170.3, -43.59660089917334, 36.89811599753569, 28.2044488675987, 2.0000000000000013, -24.324662002567464, 2.0000000000000013, -23.02141677162625, 32.45952725546367, -10.348127995394501, -32.41096753983065, -80.56504690022386, -44.89465974907003, 110.3073191569201, 52.17760482567161, -27.9609705877637, -83.91167564944702, 200.0, 52.20819277499503, -8.749215888897806, -27.988753370467585, 200.0, 147.7791271897247, -88.28607998199132, 200.0, -23.65951025174222, -31.02893831642197, -29.595246367304355, -94.5602905101594, -27.362129152472626, 63.89089440986075, -129.5547097719783, 72.07497618928096, 0.39069749047568875, 37.57359621238831, -26.43876560928999, -11.373023623471285, 193.07, 105.47325272957983, 80.66479801617673, 171.29, -71.87682512871974, -398.93632881235965, 196.92451906428659, -9.98106452518004, 18.829060383759753, 166.87421109147346, 2.98999999999998, 72.5894295396667, 193.07, -3.5131647610247114, -12.752175082432066, -21.832634837009945, 137.69847478481853, 6.949999999999958, -31.816976480737576, 112.03177716969468, -137.1008786447175, -35.91059065825406, -35.68332411731502, 86.45454061738631, 184.0544469855473, -36.29253910656801, -62.42217967917075, -11.41842906808477], "policy_predator_policy_reward": [14.385523439962231, 20.879138151393768, 0.0, 217.75317981179512, 87.07362798699494, 50.65483296349219, 36.51110678809878, 13.762812602357943, 18.395155530059093, 61.04336772591695, 509.9404235096245, 8.438208434086505, 52.62694568427125, 31.353462643733103, 285.03334252218616, 283.13026446255714, 35.1797440113509, 6.764937802182261, 9.536042975592627, 7.769177314959416, 31.044706279126302, 19.696152625081474, 444.94298345612754, 227.9983446900053, 5.476762380704775, 36.942169161088216, 7.463208219033721, 161.74375466325336, 18.382756057556062, 68.5058482916717, 0.0, 10.028038677592619, 30.017334461259825, 3.81352938496026, 339.57451203437495, 451.68284229059213, 32.62300252249078, 25.498682240917212, 247.50326147046545, 44.75491834100944, 39.376720297563, 44.63695723004912, 952.3294823084608, 56.79144820829604, 26.69394815162442, 55.65940004515172, 81.59096724283428, 49.3843904330056, 620.0818205561419, 270.2354637109531, 105.94724093656667, 249.90208087445197, 109.58582093980148, 4.327393174039764, 4.780333960069802, 80.99916175249983, 2.1428774118790774, 40.94360288728373, 350.6348834364316, 2.175383686362557, 65.75548264423348, 45.475127291294825, 32.55364971386275, 23.824106533989173, 22.80423418216944, 46.757099707670235, 3.753970656883597, 33.49706867555801, 113.40775731627815, 52.0347658403876, 656.3500564888147, 350.72329190332897, 5.271329559506125, 31.966251110566855, 0.0, 35.595213229260935, 24.40663473974915, 32.84709645867608, 3.7336933812966207, 45.38269637470156, 9.267548214831809, 15.84853791474796, 58.23444597342759, 47.170296450271, 186.80976498165637, 14.220450060169892, 377.52662037201026, 15.960182966780875, 15.646333335704847, 34.17557614332923, 34.524409758325206, 50.34245741760912, 7.785475526418901, 10.97560229357654, 86.10718033844276, 40.026984027901285, 30.8514425368583, 28.802334741637072, 126.15606086291785, 7.777594343035595, 183.47545475168306, 99.04793639007065, 12.847231190202233, 32.4529619376694, 66.39330533840993, 94.61894613780396, 44.70314839510416, 126.45197604502305, 4.701475311575221, 14.718645857387708, 27.253298939209017, 16.718421288842656, 83.66974208086215, 15.060552252546529, 48.51186376436449, 16.32226049793381, 63.96267981616097, 223.6743730108474, 100.69305194200491, 0.0, 41.03263210946989, 23.94959216591973, 34.04379626978482, 19.977384921195952, 51.92421390450665, 46.04879020384121, 0.0, 115.32747258690222, 11.239660534098778, 25.759125488079263, 235.5348727264693, 27.707024707860352, 3.3519808261787687, 155.33196251840633, 19.25483652314387, 19.868707315395298, 208.66433878531063, 10.867932928308589, 134.21188487695227, 69.26044593776032, 90.15988565598762, 156.5633200773405, 229.61528198645294, 6.411724309447771, 34.32096753983027, 12.29812799539446, 83.4050469002248, 46.774659749069656, 58.22149522080082, 92.20467235418499, 29.850970587763996, 85.77167564944797, 71.3248254225543, 82.51066272520985, 4.874134493602366, 29.94875337046789, 0.0, 27.330872810275295, 90.16607998199228, 42.91247504764575, 24.679303650160335, 33.2840536296662, 70.42956310482967, 57.39597377263531, 207.58157179014518, 1.5766409424564425, 111.31174914508952, 124.5759145174958, 99.71074528297015, 20.334961014165895, 93.9083338921489, 68.09345534061259, 36.79206208011778, 71.31123193121378, 12.3839050145335, 87.2954096687437, 479.30903854132765, 154.34323495675534, 11.112818192159107, 17.169524652023185, 141.045070141777, 80.3967679362664, 12.329900177158063, 77.08067028317525, 5.453516818712879, 4.637560321697439, 23.752634837010245, 14.682175082432025, 0.0, 47.301525215181464, 33.716976480737266, 65.02822283030535, 37.840590658253674, 273.10087864471745, 37.553324117314645, 88.54545938261369, 40.298092121020325, 9.23880221758639, 38.51558059594578, 53.152371015861036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5652604412609539, "mean_inference_ms": 1.4051804769354659, "mean_action_processing_ms": 0.2437909808645782, "mean_env_wait_ms": 0.18493899792628504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036278963088989258, "StateBufferConnector_ms": 0.0028918981552124023, "ViewRequirementAgentConnector_ms": 0.08271515369415283}, "num_episodes": 22, "episode_return_max": 597.3842514563931, "episode_return_min": -267.3194187120226, "episode_return_mean": 186.1314977203453, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.5069407094146, "num_env_steps_trained_throughput_per_sec": 447.5069407094146, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 9110.674, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9110.64, "sample_time_ms": 996.374, "learn_time_ms": 8102.312, "learn_throughput": 493.686, "synch_weights_time_ms": 11.26}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "1f15c_00000", "date": "2024-08-16_14-11-46", "timestamp": 1723797706, "time_this_iter_s": 8.94173002243042, "time_total_s": 510.91291856765747, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fe97310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 510.91291856765747, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 28.72307692307693, "ram_util_percent": 74.19230769230771}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2423979813144321, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.98493851278194, "policy_loss": -0.01189470915838327, "vf_loss": 5.996226013526715, "vf_explained_var": 0.01753840585234304, "kl": 0.012144345974475392, "entropy": 0.8708021197054121, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.758087776609199, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.993086437699656, "policy_loss": -0.008778826774851907, "vf_loss": 5.999899645204898, "vf_explained_var": -0.4127575295942801, "kl": 0.01310410746879212, "entropy": 1.2378720586892789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 407.1451095532766, "episode_reward_min": -1.9150813952954813, "episode_reward_mean": 184.56910157174377, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -669.7076276409917, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 656.3500564888147}, "policy_reward_mean": {"prey_policy": 5.836522087158011, "predator_policy": 86.44802869871393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.343497261482295, 257.59405790246785, 158.34326835004535, 185.32739317403954, 3.829999999999961, 171.1499999999998, 192.35733103113293, 174.98999999999984, 359.7357859250786, 192.9299999999997, 3.9099999999999597, 132.08000000000033, 138.8746361248371, 4.906992828391794, 371.21, 9.210890738847914, 197.18529341348045, 172.96530809336133, 5.122291673576843, 146.9600000000002, 240.29911456296935, 353.8913442422324, 372.0, 368.1354755264189, 330.8361680119401, 6.809999999999919, 185.77759434303533, 114.41861631639904, 13.214374425410252, 327.23698367176866, 119.35000000000065, 6.889999999999917, 203.78842128884224, 173.5974163269358, 14.489174623772097, 177.01655974799536, 338.2, 180.97999999999973, 208.9931137478842, 225.8363521999183, 327.60249825623487, 201.2996605340984, 103.9100000000003, 132.06000000000026, 188.7528501652929, 212.8337868119815, 233.6767796823106, 224.39854373076014, 245.4651167797383, 3.8599999999999626, 4.719999999999942, 312.91109155757704, 3.7499999999999636, 406.0436809227591, -1.9150813952954813, 375.11, 244.792475047645, 3.2749087116620412, 3.669999999999966, 245.68697798998977, 178.40793007988952, 158.01000000000002, 124.19000000000041, 406.6465467409114, 351.63411269945396, 162.83911955700376, 215.22579738328835, 407.1451095532766, 164.98999999999984, 199.64791237938528, 3.849999999999962, 191.9499999999997, 178.9599999999998, 137.9300000000002, 176.86999999999983, 197.29880221758606, 17.827342864551735, 393.09394179367905, 3.9499999999999593, 228.2718206558805, 192.8074558698167, 218.76999999999947, 200.8867112358152, 195.60120595972444, 212.75452481841296, 339.82435696126805, 108.4256536399489, 355.67537079116806, 215.64415216463726, 3.919999999999959, 199.1577674715602, 351.43900410126537, 217.08545333843242, 190.8661617573665, 190.7454325160523, 120.97000000000035, 211.4354334980055, 376.13, 316.4922927789779, 3.849999999999961], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-80.41991224825594, -27.211948166100992, 36.984401276364196, -669.7076276409917, -113.08691005256654, -84.41914340840688, 2.0000000000000013, 69.41417906019852, -79.14916175249888, -2.8003339600698443, -23.009498148144957, 151.0730178489825, 23.1501461330449, -183.60308222470624, 107.3145173557665, -43.55512729129521, 179.64235251200301, 123.71567716522391, 168.19576581783056, -44.82709970767062, -3.4330769532566165, -29.90796237918473, -33.83327015320699, 0.47074699654122115, -512.2714173189934, -355.9272949483132, -30.01625111056655, -2.314336731114312, 156.40478677073907, 179.21, -0.10885233215973147, -47.933988127417855, 3.4516000321841447, 144.61730362529843, 2.0000000000000013, 145.8492219637819, -45.9951797684475, -54.28727098167493, -12.260450060169934, -41.809764981656464, 50.294508855276476, -203.4821976310982, 155.3552137125653, 148.71422105063303, 130.65754258239087, 156.4755902416748, 182.18, 167.19439770642344, 110.22566382218767, 94.47633982340841, -23.94233474163678, -28.901442536857996, 2.0000000000000013, 49.843939137082145, -170.104774825355, 2.0000000000000013, -27.24700724311837, -4.83881145934266, 75.7676353505741, 90.45709684498088, -8.991976045023073, -42.813148395104534, -9.808645857387749, -2.7214753115752632, 157.816701060791, 2.0000000000000013, -38.57085304731403, 113.43797504084085, 2.0000000000000013, -52.3449496385265, -113.69821594129714, 3.077722862285004, 114.70717335241625, 122.7997747055788, -3.563335230410864, 119.5611109550212, 189.11, -34.13806744309653, 197.1121410943379, -69.24879300276586, 152.05987741840414, 60.21514825092848, 182.18, -17.87912548807897, -128.81622574306573, -30.5156716912637, -6.97008850199056, -19.653854842594185, -20.670693673245776, 170.3, -43.59660089917334, 36.89811599753569, 28.2044488675987, 2.0000000000000013, -24.324662002567464, 2.0000000000000013, -23.02141677162625, 32.45952725546367, -10.348127995394501, -32.41096753983065, -80.56504690022386, -44.89465974907003, 110.3073191569201, 52.17760482567161, -27.9609705877637, -83.91167564944702, 200.0, 52.20819277499503, -8.749215888897806, -27.988753370467585, 200.0, 147.7791271897247, -88.28607998199132, 200.0, -23.65951025174222, -31.02893831642197, -29.595246367304355, -94.5602905101594, -27.362129152472626, 63.89089440986075, -129.5547097719783, 72.07497618928096, 0.39069749047568875, 37.57359621238831, -26.43876560928999, -11.373023623471285, 193.07, 105.47325272957983, 80.66479801617673, 171.29, -71.87682512871974, -398.93632881235965, 196.92451906428659, -9.98106452518004, 18.829060383759753, 166.87421109147346, 2.98999999999998, 72.5894295396667, 193.07, -3.5131647610247114, -12.752175082432066, -21.832634837009945, 137.69847478481853, 6.949999999999958, -31.816976480737576, 112.03177716969468, -137.1008786447175, -35.91059065825406, -35.68332411731502, 86.45454061738631, 184.0544469855473, -36.29253910656801, -62.42217967917075, -11.41842906808477, 58.07394906296604, 87.16619576319812, -5.113958191883508, -5.749895273744117, 120.20170933473321, 10.90999999999996, 2.0000000000000013, -26.958695170264004, 169.4018879623556, 24.770000000000277, -3.6356268182980678, -71.45252751185797, -50.70448326681819, -0.43837963122747525, -352.4475039087543, 33.53510123807918, -43.71483547995937, 78.51387905313733, -264.9869772428765, -35.117016369772365, -111.47119987604322, -6.149748768750825, -22.9143616776723, -64.46963486657808, -14.092380452141397, -4.248728647842679, -7.193723166239861, -75.598130038878, -39.42506536134172, 152.58121033681567, -78.1842441903216, 18.064408958771853, -36.68117173317399, -22.410330316947263, -231.07546692541624, -9.217828558645692, -38.89951996341998, -112.40602487602891, -49.03322448204389, -11.21416428388003, 161.1683077597799, 185.61536701738737, -58.91496494329243, -177.71953712271556, -38.41245371876104, -7.1097468202091445], "policy_predator_policy_reward": [81.59096724283428, 49.3843904330056, 620.0818205561419, 270.2354637109531, 105.94724093656667, 249.90208087445197, 109.58582093980148, 4.327393174039764, 4.780333960069802, 80.99916175249983, 2.1428774118790774, 40.94360288728373, 350.6348834364316, 2.175383686362557, 65.75548264423348, 45.475127291294825, 32.55364971386275, 23.824106533989173, 22.80423418216944, 46.757099707670235, 3.753970656883597, 33.49706867555801, 113.40775731627815, 52.0347658403876, 656.3500564888147, 350.72329190332897, 5.271329559506125, 31.966251110566855, 0.0, 35.595213229260935, 24.40663473974915, 32.84709645867608, 3.7336933812966207, 45.38269637470156, 9.267548214831809, 15.84853791474796, 58.23444597342759, 47.170296450271, 186.80976498165637, 14.220450060169892, 377.52662037201026, 15.960182966780875, 15.646333335704847, 34.17557614332923, 34.524409758325206, 50.34245741760912, 7.785475526418901, 10.97560229357654, 86.10718033844276, 40.026984027901285, 30.8514425368583, 28.802334741637072, 126.15606086291785, 7.777594343035595, 183.47545475168306, 99.04793639007065, 12.847231190202233, 32.4529619376694, 66.39330533840993, 94.61894613780396, 44.70314839510416, 126.45197604502305, 4.701475311575221, 14.718645857387708, 27.253298939209017, 16.718421288842656, 83.66974208086215, 15.060552252546529, 48.51186376436449, 16.32226049793381, 63.96267981616097, 223.6743730108474, 100.69305194200491, 0.0, 41.03263210946989, 23.94959216591973, 34.04379626978482, 19.977384921195952, 51.92421390450665, 46.04879020384121, 0.0, 115.32747258690222, 11.239660534098778, 25.759125488079263, 235.5348727264693, 27.707024707860352, 3.3519808261787687, 155.33196251840633, 19.25483652314387, 19.868707315395298, 208.66433878531063, 10.867932928308589, 134.21188487695227, 69.26044593776032, 90.15988565598762, 156.5633200773405, 229.61528198645294, 6.411724309447771, 34.32096753983027, 12.29812799539446, 83.4050469002248, 46.774659749069656, 58.22149522080082, 92.20467235418499, 29.850970587763996, 85.77167564944797, 71.3248254225543, 82.51066272520985, 4.874134493602366, 29.94875337046789, 0.0, 27.330872810275295, 90.16607998199228, 42.91247504764575, 24.679303650160335, 33.2840536296662, 70.42956310482967, 57.39597377263531, 207.58157179014518, 1.5766409424564425, 111.31174914508952, 124.5759145174958, 99.71074528297015, 20.334961014165895, 93.9083338921489, 68.09345534061259, 36.79206208011778, 71.31123193121378, 12.3839050145335, 87.2954096687437, 479.30903854132765, 154.34323495675534, 11.112818192159107, 17.169524652023185, 141.045070141777, 80.3967679362664, 12.329900177158063, 77.08067028317525, 5.453516818712879, 4.637560321697439, 23.752634837010245, 14.682175082432025, 0.0, 47.301525215181464, 33.716976480737266, 65.02822283030535, 37.840590658253674, 273.10087864471745, 37.553324117314645, 88.54545938261369, 40.298092121020325, 9.23880221758639, 38.51558059594578, 53.152371015861036, 141.8869050751857, 105.96689189232904, 7.083958191883466, 7.7298952737440745, 54.665825746189284, 42.49428557495865, 85.28828010858078, 132.47787093150015, 24.598112037644412, 0.0, 142.33883423164858, 133.6360313343228, 118.3217715096855, 128.42229734808495, 486.6618091026142, 45.00511838647369, 106.2527606936813, 198.77255269440892, 102.14496655075192, 306.38468070184575, 262.15280041026944, 211.1435190256927, 151.05517041536393, 151.97297829352448, 16.03238045214136, 6.228728647842637, 256.7279473437775, 25.221673332900746, 56.73028212446945, 181.55257700132196, 35.400744406941364, 241.80454416304053, 136.16792073329125, 113.7897430741963, 275.2867220613345, 155.75200593877972, 152.63088426918839, 119.6446605702601, 115.19827736243316, 156.48454490149632, 8.404632982612615, 20.941692240220117, 273.62398151813034, 279.5028133268555, 9.079746820209103, 40.29245371876067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5634023010578111, "mean_inference_ms": 1.4008308764263107, "mean_action_processing_ms": 0.24296367582834003, "mean_env_wait_ms": 0.18431005642389028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032805204391479492, "StateBufferConnector_ms": 0.0028810501098632812, "ViewRequirementAgentConnector_ms": 0.08255624771118164}, "num_episodes": 23, "episode_return_max": 407.1451095532766, "episode_return_min": -1.9150813952954813, "episode_return_mean": 184.56910157174377, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.58642218224077, "num_env_steps_trained_throughput_per_sec": 433.58642218224077, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 9145.51, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9145.475, "sample_time_ms": 995.513, "learn_time_ms": 8138.115, "learn_throughput": 491.514, "synch_weights_time_ms": 11.122}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "1f15c_00000", "date": "2024-08-16_14-11-55", "timestamp": 1723797715, "time_this_iter_s": 9.229203939437866, "time_total_s": 520.1421225070953, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8665e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 520.1421225070953, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 31.83076923076923, "ram_util_percent": 74.14615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6895502466373342, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.56967355170578, "policy_loss": -0.008169635978069098, "vf_loss": 4.57702626450352, "vf_explained_var": 0.04418105997105755, "kl": 0.016338436816704972, "entropy": 0.8559053114482335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.967175112420289, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.0218392145066035, "policy_loss": -0.005729837736445011, "vf_loss": 5.026104697727022, "vf_explained_var": 0.0008086101403312078, "kl": 0.009762432238536858, "entropy": 1.2641493755673605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 407.1451095532766, "episode_reward_min": -1.9150813952954813, "episode_reward_mean": 187.78618567033564, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -431.3139753574692, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 486.6618091026142}, "policy_reward_mean": {"prey_policy": 5.857864362963632, "predator_policy": 88.03522847220425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.122291673576843, 146.9600000000002, 240.29911456296935, 353.8913442422324, 372.0, 368.1354755264189, 330.8361680119401, 6.809999999999919, 185.77759434303533, 114.41861631639904, 13.214374425410252, 327.23698367176866, 119.35000000000065, 6.889999999999917, 203.78842128884224, 173.5974163269358, 14.489174623772097, 177.01655974799536, 338.2, 180.97999999999973, 208.9931137478842, 225.8363521999183, 327.60249825623487, 201.2996605340984, 103.9100000000003, 132.06000000000026, 188.7528501652929, 212.8337868119815, 233.6767796823106, 224.39854373076014, 245.4651167797383, 3.8599999999999626, 4.719999999999942, 312.91109155757704, 3.7499999999999636, 406.0436809227591, -1.9150813952954813, 375.11, 244.792475047645, 3.2749087116620412, 3.669999999999966, 245.68697798998977, 178.40793007988952, 158.01000000000002, 124.19000000000041, 406.6465467409114, 351.63411269945396, 162.83911955700376, 215.22579738328835, 407.1451095532766, 164.98999999999984, 199.64791237938528, 3.849999999999962, 191.9499999999997, 178.9599999999998, 137.9300000000002, 176.86999999999983, 197.29880221758606, 17.827342864551735, 393.09394179367905, 3.9499999999999593, 228.2718206558805, 192.8074558698167, 218.76999999999947, 200.8867112358152, 195.60120595972444, 212.75452481841296, 339.82435696126805, 108.4256536399489, 355.67537079116806, 215.64415216463726, 3.919999999999959, 199.1577674715602, 351.43900410126537, 217.08545333843242, 190.8661617573665, 190.7454325160523, 120.97000000000035, 211.4354334980055, 376.13, 316.4922927789779, 3.849999999999961, 132.7879378996763, 195.68765979457714, 388.6797163139952, 8.721070613086813, 180.63647035548888, 33.929999999999666, 104.77294696795235, 192.8195944833593, 376.71016339671166, 257.88572635637104, 187.91999999999973, 11.13582787205011, 237.97167127631496, 236.77024734754767, 7.390632941591619, 146.07000000000008, 355.97319908363335, 15.78999999999992], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-45.9951797684475, -54.28727098167493, -12.260450060169934, -41.809764981656464, 50.294508855276476, -203.4821976310982, 155.3552137125653, 148.71422105063303, 130.65754258239087, 156.4755902416748, 182.18, 167.19439770642344, 110.22566382218767, 94.47633982340841, -23.94233474163678, -28.901442536857996, 2.0000000000000013, 49.843939137082145, -170.104774825355, 2.0000000000000013, -27.24700724311837, -4.83881145934266, 75.7676353505741, 90.45709684498088, -8.991976045023073, -42.813148395104534, -9.808645857387749, -2.7214753115752632, 157.816701060791, 2.0000000000000013, -38.57085304731403, 113.43797504084085, 2.0000000000000013, -52.3449496385265, -113.69821594129714, 3.077722862285004, 114.70717335241625, 122.7997747055788, -3.563335230410864, 119.5611109550212, 189.11, -34.13806744309653, 197.1121410943379, -69.24879300276586, 152.05987741840414, 60.21514825092848, 182.18, -17.87912548807897, -128.81622574306573, -30.5156716912637, -6.97008850199056, -19.653854842594185, -20.670693673245776, 170.3, -43.59660089917334, 36.89811599753569, 28.2044488675987, 2.0000000000000013, -24.324662002567464, 2.0000000000000013, -23.02141677162625, 32.45952725546367, -10.348127995394501, -32.41096753983065, -80.56504690022386, -44.89465974907003, 110.3073191569201, 52.17760482567161, -27.9609705877637, -83.91167564944702, 200.0, 52.20819277499503, -8.749215888897806, -27.988753370467585, 200.0, 147.7791271897247, -88.28607998199132, 200.0, -23.65951025174222, -31.02893831642197, -29.595246367304355, -94.5602905101594, -27.362129152472626, 63.89089440986075, -129.5547097719783, 72.07497618928096, 0.39069749047568875, 37.57359621238831, -26.43876560928999, -11.373023623471285, 193.07, 105.47325272957983, 80.66479801617673, 171.29, -71.87682512871974, -398.93632881235965, 196.92451906428659, -9.98106452518004, 18.829060383759753, 166.87421109147346, 2.98999999999998, 72.5894295396667, 193.07, -3.5131647610247114, -12.752175082432066, -21.832634837009945, 137.69847478481853, 6.949999999999958, -31.816976480737576, 112.03177716969468, -137.1008786447175, -35.91059065825406, -35.68332411731502, 86.45454061738631, 184.0544469855473, -36.29253910656801, -62.42217967917075, -11.41842906808477, 58.07394906296604, 87.16619576319812, -5.113958191883508, -5.749895273744117, 120.20170933473321, 10.90999999999996, 2.0000000000000013, -26.958695170264004, 169.4018879623556, 24.770000000000277, -3.6356268182980678, -71.45252751185797, -50.70448326681819, -0.43837963122747525, -352.4475039087543, 33.53510123807918, -43.71483547995937, 78.51387905313733, -264.9869772428765, -35.117016369772365, -111.47119987604322, -6.149748768750825, -22.9143616776723, -64.46963486657808, -14.092380452141397, -4.248728647842679, -7.193723166239861, -75.598130038878, -39.42506536134172, 152.58121033681567, -78.1842441903216, 18.064408958771853, -36.68117173317399, -22.410330316947263, -231.07546692541624, -9.217828558645692, -38.89951996341998, -112.40602487602891, -49.03322448204389, -11.21416428388003, 161.1683077597799, 185.61536701738737, -58.91496494329243, -177.71953712271556, -38.41245371876104, -7.1097468202091445, -83.28926629345172, -431.3139753574692, 55.50937582313894, -12.55682684338891, 29.564776749091433, 78.30637821196396, -74.74786595140282, -0.2878809596648546, -4.404516106143054, -138.1337276161641, -148.29923734411778, -94.66321436685216, -370.5129542866647, 2.0000000000000013, -53.80803749822488, 70.5588971840542, 163.06479079310668, 145.08044030007585, -102.1765063007779, 114.78977841096601, -40.44210469564344, 158.6077088962846, -16.13231478039295, 2.0000000000000013, 2.0000000000000013, 46.24682552563979, -69.31277439323469, -145.82654581276086, 2.0000000000000013, -3.3075253668226168, 0.4992909738111854, 33.355566179368566, 51.23845080467087, -7.21882991888647, 2.0000000000000013, -30.16229889594788], "policy_predator_policy_reward": [58.23444597342759, 47.170296450271, 186.80976498165637, 14.220450060169892, 377.52662037201026, 15.960182966780875, 15.646333335704847, 34.17557614332923, 34.524409758325206, 50.34245741760912, 7.785475526418901, 10.97560229357654, 86.10718033844276, 40.026984027901285, 30.8514425368583, 28.802334741637072, 126.15606086291785, 7.777594343035595, 183.47545475168306, 99.04793639007065, 12.847231190202233, 32.4529619376694, 66.39330533840993, 94.61894613780396, 44.70314839510416, 126.45197604502305, 4.701475311575221, 14.718645857387708, 27.253298939209017, 16.718421288842656, 83.66974208086215, 15.060552252546529, 48.51186376436449, 16.32226049793381, 63.96267981616097, 223.6743730108474, 100.69305194200491, 0.0, 41.03263210946989, 23.94959216591973, 34.04379626978482, 19.977384921195952, 51.92421390450665, 46.04879020384121, 0.0, 115.32747258690222, 11.239660534098778, 25.759125488079263, 235.5348727264693, 27.707024707860352, 3.3519808261787687, 155.33196251840633, 19.25483652314387, 19.868707315395298, 208.66433878531063, 10.867932928308589, 134.21188487695227, 69.26044593776032, 90.15988565598762, 156.5633200773405, 229.61528198645294, 6.411724309447771, 34.32096753983027, 12.29812799539446, 83.4050469002248, 46.774659749069656, 58.22149522080082, 92.20467235418499, 29.850970587763996, 85.77167564944797, 71.3248254225543, 82.51066272520985, 4.874134493602366, 29.94875337046789, 0.0, 27.330872810275295, 90.16607998199228, 42.91247504764575, 24.679303650160335, 33.2840536296662, 70.42956310482967, 57.39597377263531, 207.58157179014518, 1.5766409424564425, 111.31174914508952, 124.5759145174958, 99.71074528297015, 20.334961014165895, 93.9083338921489, 68.09345534061259, 36.79206208011778, 71.31123193121378, 12.3839050145335, 87.2954096687437, 479.30903854132765, 154.34323495675534, 11.112818192159107, 17.169524652023185, 141.045070141777, 80.3967679362664, 12.329900177158063, 77.08067028317525, 5.453516818712879, 4.637560321697439, 23.752634837010245, 14.682175082432025, 0.0, 47.301525215181464, 33.716976480737266, 65.02822283030535, 37.840590658253674, 273.10087864471745, 37.553324117314645, 88.54545938261369, 40.298092121020325, 9.23880221758639, 38.51558059594578, 53.152371015861036, 141.8869050751857, 105.96689189232904, 7.083958191883466, 7.7298952737440745, 54.665825746189284, 42.49428557495865, 85.28828010858078, 132.47787093150015, 24.598112037644412, 0.0, 142.33883423164858, 133.6360313343228, 118.3217715096855, 128.42229734808495, 486.6618091026142, 45.00511838647369, 106.2527606936813, 198.77255269440892, 102.14496655075192, 306.38468070184575, 262.15280041026944, 211.1435190256927, 151.05517041536393, 151.97297829352448, 16.03238045214136, 6.228728647842637, 256.7279473437775, 25.221673332900746, 56.73028212446945, 181.55257700132196, 35.400744406941364, 241.80454416304053, 136.16792073329125, 113.7897430741963, 275.2867220613345, 155.75200593877972, 152.63088426918839, 119.6446605702601, 115.19827736243316, 156.48454490149632, 8.404632982612615, 20.941692240220117, 273.62398151813034, 279.5028133268555, 9.079746820209103, 40.29245371876067, 475.3607345358415, 172.03044501475586, 61.90564167918156, 90.82946913564592, 148.21302046031857, 132.59554089262127, 75.04542271885187, 8.71139480530364, 129.08121217523876, 194.09350190255736, 150.8494208674554, 126.04303084351452, 109.50441828886312, 363.7814829657535, 112.71032883064755, 63.35840596688243, 17.209555346880368, 51.355376956648804, 3.976183494577653, 241.29627075160522, 27.412291103715393, 42.34210469564306, 18.082314780393254, 7.185827872050194, 72.72206279459, 117.00278295608582, 187.22966340865656, 264.6799041448866, 5.287525366822575, 3.410632941591704, 18.60436385266495, 93.61077899415531, 144.3917242597453, 167.5618539381038, 0.0, 43.95229889594816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5619927242575585, "mean_inference_ms": 1.39744194644988, "mean_action_processing_ms": 0.2423252707412812, "mean_env_wait_ms": 0.18381956398952382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00329744815826416, "StateBufferConnector_ms": 0.0028982162475585938, "ViewRequirementAgentConnector_ms": 0.08238446712493896}, "num_episodes": 18, "episode_return_max": 407.1451095532766, "episode_return_min": -1.9150813952954813, "episode_return_mean": 187.78618567033564, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.84697964685495, "num_env_steps_trained_throughput_per_sec": 435.84697964685495, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 9118.588, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9118.552, "sample_time_ms": 961.928, "learn_time_ms": 8144.708, "learn_throughput": 491.116, "synch_weights_time_ms": 11.196}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "1f15c_00000", "date": "2024-08-16_14-12-04", "timestamp": 1723797724, "time_this_iter_s": 9.18105411529541, "time_total_s": 529.3231766223907, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8cdc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 529.3231766223907, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 30.5, "ram_util_percent": 73.10769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7268727037484053, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.452194577171689, "policy_loss": -0.007738622658881087, "vf_loss": 7.459172364391347, "vf_explained_var": 0.03336036508045499, "kl": 0.015216661763436114, "entropy": 0.7391594654037839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0765871854370865, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.007567292420322, "policy_loss": -0.006592748184545488, "vf_loss": 6.011985640551047, "vf_explained_var": -0.35502073487276753, "kl": 0.014496049639854926, "entropy": 1.2813439532562538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 407.1451095532766, "episode_reward_min": -43.75412350554597, "episode_reward_mean": 186.85218584118985, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -508.7004369696497, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 562.5979633786094}, "policy_reward_mean": {"prey_policy": -6.094991544609948, "predator_policy": 99.52108446520495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [338.2, 180.97999999999973, 208.9931137478842, 225.8363521999183, 327.60249825623487, 201.2996605340984, 103.9100000000003, 132.06000000000026, 188.7528501652929, 212.8337868119815, 233.6767796823106, 224.39854373076014, 245.4651167797383, 3.8599999999999626, 4.719999999999942, 312.91109155757704, 3.7499999999999636, 406.0436809227591, -1.9150813952954813, 375.11, 244.792475047645, 3.2749087116620412, 3.669999999999966, 245.68697798998977, 178.40793007988952, 158.01000000000002, 124.19000000000041, 406.6465467409114, 351.63411269945396, 162.83911955700376, 215.22579738328835, 407.1451095532766, 164.98999999999984, 199.64791237938528, 3.849999999999962, 191.9499999999997, 178.9599999999998, 137.9300000000002, 176.86999999999983, 197.29880221758606, 17.827342864551735, 393.09394179367905, 3.9499999999999593, 228.2718206558805, 192.8074558698167, 218.76999999999947, 200.8867112358152, 195.60120595972444, 212.75452481841296, 339.82435696126805, 108.4256536399489, 355.67537079116806, 215.64415216463726, 3.919999999999959, 199.1577674715602, 351.43900410126537, 217.08545333843242, 190.8661617573665, 190.7454325160523, 120.97000000000035, 211.4354334980055, 376.13, 316.4922927789779, 3.849999999999961, 132.7879378996763, 195.68765979457714, 388.6797163139952, 8.721070613086813, 180.63647035548888, 33.929999999999666, 104.77294696795235, 192.8195944833593, 376.71016339671166, 257.88572635637104, 187.91999999999973, 11.13582787205011, 237.97167127631496, 236.77024734754767, 7.390632941591619, 146.07000000000008, 355.97319908363335, 15.78999999999992, 299.3264530283091, 155.90999999999983, 17.735904069555563, 263.14114274893416, 182.6901138085328, -43.75412350554597, 83.69453279199668, 233.76313267806978, 200.10504821834277, 274.2253572621226, 218.4036502690378, 163.36485244877753, 156.23829553018922, 165.0466704962159, 335.06657197966393, 213.25795039048836, 142.0841631312629, 6.133836500766288], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [114.70717335241625, 122.7997747055788, -3.563335230410864, 119.5611109550212, 189.11, -34.13806744309653, 197.1121410943379, -69.24879300276586, 152.05987741840414, 60.21514825092848, 182.18, -17.87912548807897, -128.81622574306573, -30.5156716912637, -6.97008850199056, -19.653854842594185, -20.670693673245776, 170.3, -43.59660089917334, 36.89811599753569, 28.2044488675987, 2.0000000000000013, -24.324662002567464, 2.0000000000000013, -23.02141677162625, 32.45952725546367, -10.348127995394501, -32.41096753983065, -80.56504690022386, -44.89465974907003, 110.3073191569201, 52.17760482567161, -27.9609705877637, -83.91167564944702, 200.0, 52.20819277499503, -8.749215888897806, -27.988753370467585, 200.0, 147.7791271897247, -88.28607998199132, 200.0, -23.65951025174222, -31.02893831642197, -29.595246367304355, -94.5602905101594, -27.362129152472626, 63.89089440986075, -129.5547097719783, 72.07497618928096, 0.39069749047568875, 37.57359621238831, -26.43876560928999, -11.373023623471285, 193.07, 105.47325272957983, 80.66479801617673, 171.29, -71.87682512871974, -398.93632881235965, 196.92451906428659, -9.98106452518004, 18.829060383759753, 166.87421109147346, 2.98999999999998, 72.5894295396667, 193.07, -3.5131647610247114, -12.752175082432066, -21.832634837009945, 137.69847478481853, 6.949999999999958, -31.816976480737576, 112.03177716969468, -137.1008786447175, -35.91059065825406, -35.68332411731502, 86.45454061738631, 184.0544469855473, -36.29253910656801, -62.42217967917075, -11.41842906808477, 58.07394906296604, 87.16619576319812, -5.113958191883508, -5.749895273744117, 120.20170933473321, 10.90999999999996, 2.0000000000000013, -26.958695170264004, 169.4018879623556, 24.770000000000277, -3.6356268182980678, -71.45252751185797, -50.70448326681819, -0.43837963122747525, -352.4475039087543, 33.53510123807918, -43.71483547995937, 78.51387905313733, -264.9869772428765, -35.117016369772365, -111.47119987604322, -6.149748768750825, -22.9143616776723, -64.46963486657808, -14.092380452141397, -4.248728647842679, -7.193723166239861, -75.598130038878, -39.42506536134172, 152.58121033681567, -78.1842441903216, 18.064408958771853, -36.68117173317399, -22.410330316947263, -231.07546692541624, -9.217828558645692, -38.89951996341998, -112.40602487602891, -49.03322448204389, -11.21416428388003, 161.1683077597799, 185.61536701738737, -58.91496494329243, -177.71953712271556, -38.41245371876104, -7.1097468202091445, -83.28926629345172, -431.3139753574692, 55.50937582313894, -12.55682684338891, 29.564776749091433, 78.30637821196396, -74.74786595140282, -0.2878809596648546, -4.404516106143054, -138.1337276161641, -148.29923734411778, -94.66321436685216, -370.5129542866647, 2.0000000000000013, -53.80803749822488, 70.5588971840542, 163.06479079310668, 145.08044030007585, -102.1765063007779, 114.78977841096601, -40.44210469564344, 158.6077088962846, -16.13231478039295, 2.0000000000000013, 2.0000000000000013, 46.24682552563979, -69.31277439323469, -145.82654581276086, 2.0000000000000013, -3.3075253668226168, 0.4992909738111854, 33.355566179368566, 51.23845080467087, -7.21882991888647, 2.0000000000000013, -30.16229889594788, 101.64675006177937, -119.65808065344652, -25.54829680975673, 50.82682460129334, -8.953694672847774, 2.98999999999998, -38.12758046432121, -118.73533850446762, -32.58269092161117, 142.9019283069701, -508.7004369696497, -235.16809880466542, -234.51347102989035, -177.6897276916747, 26.229327735512985, -14.11586753160954, -49.09096367598861, -17.198246720913705, 41.39507422609758, 64.35207346297487, 114.52070299562594, 2.0000000000000013, -117.25119059538414, 0.07386209146203451, -36.122996103068495, -120.40614407582481, -13.019690717633573, -55.338882000148246, 17.459659429434954, 37.8840711279205, -74.98945812736898, -50.0149293332189, -0.028059780397630463, -113.80707843066679, -4.882456429839731, -14.75202588386414], "policy_predator_policy_reward": [100.69305194200491, 0.0, 41.03263210946989, 23.94959216591973, 34.04379626978482, 19.977384921195952, 51.92421390450665, 46.04879020384121, 0.0, 115.32747258690222, 11.239660534098778, 25.759125488079263, 235.5348727264693, 27.707024707860352, 3.3519808261787687, 155.33196251840633, 19.25483652314387, 19.868707315395298, 208.66433878531063, 10.867932928308589, 134.21188487695227, 69.26044593776032, 90.15988565598762, 156.5633200773405, 229.61528198645294, 6.411724309447771, 34.32096753983027, 12.29812799539446, 83.4050469002248, 46.774659749069656, 58.22149522080082, 92.20467235418499, 29.850970587763996, 85.77167564944797, 71.3248254225543, 82.51066272520985, 4.874134493602366, 29.94875337046789, 0.0, 27.330872810275295, 90.16607998199228, 42.91247504764575, 24.679303650160335, 33.2840536296662, 70.42956310482967, 57.39597377263531, 207.58157179014518, 1.5766409424564425, 111.31174914508952, 124.5759145174958, 99.71074528297015, 20.334961014165895, 93.9083338921489, 68.09345534061259, 36.79206208011778, 71.31123193121378, 12.3839050145335, 87.2954096687437, 479.30903854132765, 154.34323495675534, 11.112818192159107, 17.169524652023185, 141.045070141777, 80.3967679362664, 12.329900177158063, 77.08067028317525, 5.453516818712879, 4.637560321697439, 23.752634837010245, 14.682175082432025, 0.0, 47.301525215181464, 33.716976480737266, 65.02822283030535, 37.840590658253674, 273.10087864471745, 37.553324117314645, 88.54545938261369, 40.298092121020325, 9.23880221758639, 38.51558059594578, 53.152371015861036, 141.8869050751857, 105.96689189232904, 7.083958191883466, 7.7298952737440745, 54.665825746189284, 42.49428557495865, 85.28828010858078, 132.47787093150015, 24.598112037644412, 0.0, 142.33883423164858, 133.6360313343228, 118.3217715096855, 128.42229734808495, 486.6618091026142, 45.00511838647369, 106.2527606936813, 198.77255269440892, 102.14496655075192, 306.38468070184575, 262.15280041026944, 211.1435190256927, 151.05517041536393, 151.97297829352448, 16.03238045214136, 6.228728647842637, 256.7279473437775, 25.221673332900746, 56.73028212446945, 181.55257700132196, 35.400744406941364, 241.80454416304053, 136.16792073329125, 113.7897430741963, 275.2867220613345, 155.75200593877972, 152.63088426918839, 119.6446605702601, 115.19827736243316, 156.48454490149632, 8.404632982612615, 20.941692240220117, 273.62398151813034, 279.5028133268555, 9.079746820209103, 40.29245371876067, 475.3607345358415, 172.03044501475586, 61.90564167918156, 90.82946913564592, 148.21302046031857, 132.59554089262127, 75.04542271885187, 8.71139480530364, 129.08121217523876, 194.09350190255736, 150.8494208674554, 126.04303084351452, 109.50441828886312, 363.7814829657535, 112.71032883064755, 63.35840596688243, 17.209555346880368, 51.355376956648804, 3.976183494577653, 241.29627075160522, 27.412291103715393, 42.34210469564306, 18.082314780393254, 7.185827872050194, 72.72206279459, 117.00278295608582, 187.22966340865656, 264.6799041448866, 5.287525366822575, 3.410632941591704, 18.60436385266495, 93.61077899415531, 144.3917242597453, 167.5618539381038, 0.0, 43.95229889594816, 186.55350731728296, 130.7842763026934, 27.45829680975703, 103.17317539870666, 11.688227659608259, 12.01137108279481, 164.59430167205701, 255.40976004566642, 41.97075590930109, 30.400120513872633, 137.51644889015927, 562.5979633786094, 144.72749141209, 351.17024010147003, 106.33472638581115, 115.31494608835594, 128.40140070644784, 137.99285790879804, 51.56979203204664, 116.90841754100342, 49.07551846258013, 52.807428810832164, 219.48894746261118, 61.053233490088644, 205.79733708420508, 106.97009862487705, 86.98051852955231, 146.4247246844453, 109.30363217295961, 170.41920924934885, 160.53480245119522, 177.7275353998825, 232.2990849374899, 23.620216404837233, 14.586147879046809, 11.182170935423475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5606776030015799, "mean_inference_ms": 1.3942260743472579, "mean_action_processing_ms": 0.24171260247310467, "mean_env_wait_ms": 0.18337000210295484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003336787223815918, "StateBufferConnector_ms": 0.00295412540435791, "ViewRequirementAgentConnector_ms": 0.08319520950317383}, "num_episodes": 18, "episode_return_max": 407.1451095532766, "episode_return_min": -43.75412350554597, "episode_return_mean": 186.85218584118985, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.75597740769246, "num_env_steps_trained_throughput_per_sec": 438.75597740769246, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 9123.508, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9123.472, "sample_time_ms": 960.552, "learn_time_ms": 8150.846, "learn_throughput": 490.747, "synch_weights_time_ms": 11.369}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "1f15c_00000", "date": "2024-08-16_14-12-13", "timestamp": 1723797733, "time_this_iter_s": 9.1197509765625, "time_total_s": 538.4429275989532, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f877d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 538.4429275989532, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 31.66153846153846, "ram_util_percent": 73.26923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1917411200583925, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.936340773294843, "policy_loss": -0.0053165815248297004, "vf_loss": 6.9413712082716525, "vf_explained_var": 0.05017356446811131, "kl": 0.005722950428444333, "entropy": 0.6816851936320149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8783171448442673, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.810520089366449, "policy_loss": -0.004284834901669195, "vf_loss": 5.8139073778081825, "vf_explained_var": -0.3405415228119603, "kl": 0.005983596422199336, "entropy": 1.31089252826398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 407.1451095532766, "episode_reward_min": -271.0490008356444, "episode_reward_mean": 181.9007974218691, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -835.4327559354488, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.92451906428659, "predator_policy": 1039.8577959090837}, "policy_reward_mean": {"prey_policy": -32.67090875045023, "predator_policy": 123.62130746138479}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.669999999999966, 245.68697798998977, 178.40793007988952, 158.01000000000002, 124.19000000000041, 406.6465467409114, 351.63411269945396, 162.83911955700376, 215.22579738328835, 407.1451095532766, 164.98999999999984, 199.64791237938528, 3.849999999999962, 191.9499999999997, 178.9599999999998, 137.9300000000002, 176.86999999999983, 197.29880221758606, 17.827342864551735, 393.09394179367905, 3.9499999999999593, 228.2718206558805, 192.8074558698167, 218.76999999999947, 200.8867112358152, 195.60120595972444, 212.75452481841296, 339.82435696126805, 108.4256536399489, 355.67537079116806, 215.64415216463726, 3.919999999999959, 199.1577674715602, 351.43900410126537, 217.08545333843242, 190.8661617573665, 190.7454325160523, 120.97000000000035, 211.4354334980055, 376.13, 316.4922927789779, 3.849999999999961, 132.7879378996763, 195.68765979457714, 388.6797163139952, 8.721070613086813, 180.63647035548888, 33.929999999999666, 104.77294696795235, 192.8195944833593, 376.71016339671166, 257.88572635637104, 187.91999999999973, 11.13582787205011, 237.97167127631496, 236.77024734754767, 7.390632941591619, 146.07000000000008, 355.97319908363335, 15.78999999999992, 299.3264530283091, 155.90999999999983, 17.735904069555563, 263.14114274893416, 182.6901138085328, -43.75412350554597, 83.69453279199668, 233.76313267806978, 200.10504821834277, 274.2253572621226, 218.4036502690378, 163.36485244877753, 156.23829553018922, 165.0466704962159, 335.06657197966393, 213.25795039048836, 142.0841631312629, 6.133836500766288, 101.00000000000004, 254.31991718345128, 131.96000000000026, 219.65782433685365, 293.0119865924137, 84.41351531013642, 117.58908851507375, 318.55039025164666, 145.26479533276984, 370.5826044042371, 89.12000000000022, 279.67358760221185, 104.9400000000005, 3.9499999999999598, 280.1176977287922, 280.43651807776644, 246.7387851459384, 102.93000000000025, -271.0490008356444, 281.2868097680458, 151.17826211087856, 95.74415329590961], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.595246367304355, -94.5602905101594, -27.362129152472626, 63.89089440986075, -129.5547097719783, 72.07497618928096, 0.39069749047568875, 37.57359621238831, -26.43876560928999, -11.373023623471285, 193.07, 105.47325272957983, 80.66479801617673, 171.29, -71.87682512871974, -398.93632881235965, 196.92451906428659, -9.98106452518004, 18.829060383759753, 166.87421109147346, 2.98999999999998, 72.5894295396667, 193.07, -3.5131647610247114, -12.752175082432066, -21.832634837009945, 137.69847478481853, 6.949999999999958, -31.816976480737576, 112.03177716969468, -137.1008786447175, -35.91059065825406, -35.68332411731502, 86.45454061738631, 184.0544469855473, -36.29253910656801, -62.42217967917075, -11.41842906808477, 58.07394906296604, 87.16619576319812, -5.113958191883508, -5.749895273744117, 120.20170933473321, 10.90999999999996, 2.0000000000000013, -26.958695170264004, 169.4018879623556, 24.770000000000277, -3.6356268182980678, -71.45252751185797, -50.70448326681819, -0.43837963122747525, -352.4475039087543, 33.53510123807918, -43.71483547995937, 78.51387905313733, -264.9869772428765, -35.117016369772365, -111.47119987604322, -6.149748768750825, -22.9143616776723, -64.46963486657808, -14.092380452141397, -4.248728647842679, -7.193723166239861, -75.598130038878, -39.42506536134172, 152.58121033681567, -78.1842441903216, 18.064408958771853, -36.68117173317399, -22.410330316947263, -231.07546692541624, -9.217828558645692, -38.89951996341998, -112.40602487602891, -49.03322448204389, -11.21416428388003, 161.1683077597799, 185.61536701738737, -58.91496494329243, -177.71953712271556, -38.41245371876104, -7.1097468202091445, -83.28926629345172, -431.3139753574692, 55.50937582313894, -12.55682684338891, 29.564776749091433, 78.30637821196396, -74.74786595140282, -0.2878809596648546, -4.404516106143054, -138.1337276161641, -148.29923734411778, -94.66321436685216, -370.5129542866647, 2.0000000000000013, -53.80803749822488, 70.5588971840542, 163.06479079310668, 145.08044030007585, -102.1765063007779, 114.78977841096601, -40.44210469564344, 158.6077088962846, -16.13231478039295, 2.0000000000000013, 2.0000000000000013, 46.24682552563979, -69.31277439323469, -145.82654581276086, 2.0000000000000013, -3.3075253668226168, 0.4992909738111854, 33.355566179368566, 51.23845080467087, -7.21882991888647, 2.0000000000000013, -30.16229889594788, 101.64675006177937, -119.65808065344652, -25.54829680975673, 50.82682460129334, -8.953694672847774, 2.98999999999998, -38.12758046432121, -118.73533850446762, -32.58269092161117, 142.9019283069701, -508.7004369696497, -235.16809880466542, -234.51347102989035, -177.6897276916747, 26.229327735512985, -14.11586753160954, -49.09096367598861, -17.198246720913705, 41.39507422609758, 64.35207346297487, 114.52070299562594, 2.0000000000000013, -117.25119059538414, 0.07386209146203451, -36.122996103068495, -120.40614407582481, -13.019690717633573, -55.338882000148246, 17.459659429434954, 37.8840711279205, -74.98945812736898, -50.0149293332189, -0.028059780397630463, -113.80707843066679, -4.882456429839731, -14.75202588386414, -166.7235726701618, 2.0000000000000013, -34.08001940449997, 124.60664217758286, -92.28921166002164, -26.443545317459964, -182.4192033203838, -37.68665259535092, -45.166799553133245, 40.99301168962957, -250.57106805064672, -9.52715742987653, -411.55523152489366, 44.46088194673793, 60.94336274491846, 169.48376867472177, 36.01275921480712, -40.373983095081044, 25.22662580365482, 4.5632471097453795, 0.07599254021974568, -158.5413825710456, 84.1695137223391, -174.00634949689538, -43.16822951544907, -100.89890385643342, -7.126799095752428, 0.18522702498592886, -345.22647001627035, 2.0000000000000013, -107.92975805256346, -267.4331708592345, -223.10381469264084, 9.073219647848378, -16.62519843764743, -120.59221612389923, -835.4327559354488, -631.5961504268348, -25.282435743200043, -28.982968767252373, 63.12747898807626, -2.111534327939567, -39.61939325873517, -67.71411633110631], "policy_predator_policy_reward": [70.42956310482967, 57.39597377263531, 207.58157179014518, 1.5766409424564425, 111.31174914508952, 124.5759145174958, 99.71074528297015, 20.334961014165895, 93.9083338921489, 68.09345534061259, 36.79206208011778, 71.31123193121378, 12.3839050145335, 87.2954096687437, 479.30903854132765, 154.34323495675534, 11.112818192159107, 17.169524652023185, 141.045070141777, 80.3967679362664, 12.329900177158063, 77.08067028317525, 5.453516818712879, 4.637560321697439, 23.752634837010245, 14.682175082432025, 0.0, 47.301525215181464, 33.716976480737266, 65.02822283030535, 37.840590658253674, 273.10087864471745, 37.553324117314645, 88.54545938261369, 40.298092121020325, 9.23880221758639, 38.51558059594578, 53.152371015861036, 141.8869050751857, 105.96689189232904, 7.083958191883466, 7.7298952737440745, 54.665825746189284, 42.49428557495865, 85.28828010858078, 132.47787093150015, 24.598112037644412, 0.0, 142.33883423164858, 133.6360313343228, 118.3217715096855, 128.42229734808495, 486.6618091026142, 45.00511838647369, 106.2527606936813, 198.77255269440892, 102.14496655075192, 306.38468070184575, 262.15280041026944, 211.1435190256927, 151.05517041536393, 151.97297829352448, 16.03238045214136, 6.228728647842637, 256.7279473437775, 25.221673332900746, 56.73028212446945, 181.55257700132196, 35.400744406941364, 241.80454416304053, 136.16792073329125, 113.7897430741963, 275.2867220613345, 155.75200593877972, 152.63088426918839, 119.6446605702601, 115.19827736243316, 156.48454490149632, 8.404632982612615, 20.941692240220117, 273.62398151813034, 279.5028133268555, 9.079746820209103, 40.29245371876067, 475.3607345358415, 172.03044501475586, 61.90564167918156, 90.82946913564592, 148.21302046031857, 132.59554089262127, 75.04542271885187, 8.71139480530364, 129.08121217523876, 194.09350190255736, 150.8494208674554, 126.04303084351452, 109.50441828886312, 363.7814829657535, 112.71032883064755, 63.35840596688243, 17.209555346880368, 51.355376956648804, 3.976183494577653, 241.29627075160522, 27.412291103715393, 42.34210469564306, 18.082314780393254, 7.185827872050194, 72.72206279459, 117.00278295608582, 187.22966340865656, 264.6799041448866, 5.287525366822575, 3.410632941591704, 18.60436385266495, 93.61077899415531, 144.3917242597453, 167.5618539381038, 0.0, 43.95229889594816, 186.55350731728296, 130.7842763026934, 27.45829680975703, 103.17317539870666, 11.688227659608259, 12.01137108279481, 164.59430167205701, 255.40976004566642, 41.97075590930109, 30.400120513872633, 137.51644889015927, 562.5979633786094, 144.72749141209, 351.17024010147003, 106.33472638581115, 115.31494608835594, 128.40140070644784, 137.99285790879804, 51.56979203204664, 116.90841754100342, 49.07551846258013, 52.807428810832164, 219.48894746261118, 61.053233490088644, 205.79733708420508, 106.97009862487705, 86.98051852955231, 146.4247246844453, 109.30363217295961, 170.41920924934885, 160.53480245119522, 177.7275353998825, 232.2990849374899, 23.620216404837233, 14.586147879046809, 11.182170935423475, 260.1521515987684, 5.5714210713933365, 98.81661690721805, 64.9766775031511, 143.5512717061555, 107.14148527132637, 238.60373286392985, 201.15994738865857, 196.12127290950295, 101.06450154641466, 290.05801374491597, 54.45372704574303, 13.286340747416258, 471.39709734581305, 33.58337423154737, 54.53988460045889, 148.05689646765487, 1.569122745388144, 164.83283519952357, 175.95989629131344, 54.46992433847923, 193.1154656923468, 251.05116314336692, 118.45926023340137, 54.47735924798198, 194.5297741239003, 1.8047729750140726, 9.086799095752387, 253.95387351046622, 369.3902942345974, 369.34917355404747, 286.450273435517, 195.6373219774621, 265.13205821326886, 128.99921256355682, 111.1482019979902, 156.12210961755687, 1039.8577959090837, 145.26948227789916, 190.28273200059903, 16.054106370478227, 74.10821108026357, 60.65687557171689, 142.42078731403325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5592870724346382, "mean_inference_ms": 1.3905392292873, "mean_action_processing_ms": 0.24065374917385363, "mean_env_wait_ms": 0.1827940162801687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033452510833740234, "StateBufferConnector_ms": 0.00292813777923584, "ViewRequirementAgentConnector_ms": 0.08216166496276855}, "num_episodes": 22, "episode_return_max": 407.1451095532766, "episode_return_min": -271.0490008356444, "episode_return_mean": 181.9007974218691, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.0937574488377, "num_env_steps_trained_throughput_per_sec": 444.0937574488377, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 9115.974, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9115.937, "sample_time_ms": 965.226, "learn_time_ms": 8138.479, "learn_throughput": 491.492, "synch_weights_time_ms": 11.517}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "1f15c_00000", "date": "2024-08-16_14-12-22", "timestamp": 1723797742, "time_this_iter_s": 9.011242151260376, "time_total_s": 547.4541697502136, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f872430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 547.4541697502136, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 32.84999999999999, "ram_util_percent": 73.40833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9373703262793325, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.136622337058738, "policy_loss": -0.003984990043481861, "vf_loss": 6.140226022780888, "vf_explained_var": 0.03822502112262464, "kl": 0.007626200804874334, "entropy": 0.6817548601084916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.879099783695564, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.104397510977649, "policy_loss": -0.004452905093600589, "vf_loss": 5.107795432888011, "vf_explained_var": -0.33025310487343523, "kl": 0.007033069351078289, "entropy": 1.275115002147735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 393.09394179367905, "episode_reward_min": -271.0490008356444, "episode_reward_mean": 168.38285789216243, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -835.4327559354488, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.61536701738737, "predator_policy": 1039.8577959090837}, "policy_reward_mean": {"prey_policy": -52.489275221795886, "predator_policy": 136.6807041678771}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.827342864551735, 393.09394179367905, 3.9499999999999593, 228.2718206558805, 192.8074558698167, 218.76999999999947, 200.8867112358152, 195.60120595972444, 212.75452481841296, 339.82435696126805, 108.4256536399489, 355.67537079116806, 215.64415216463726, 3.919999999999959, 199.1577674715602, 351.43900410126537, 217.08545333843242, 190.8661617573665, 190.7454325160523, 120.97000000000035, 211.4354334980055, 376.13, 316.4922927789779, 3.849999999999961, 132.7879378996763, 195.68765979457714, 388.6797163139952, 8.721070613086813, 180.63647035548888, 33.929999999999666, 104.77294696795235, 192.8195944833593, 376.71016339671166, 257.88572635637104, 187.91999999999973, 11.13582787205011, 237.97167127631496, 236.77024734754767, 7.390632941591619, 146.07000000000008, 355.97319908363335, 15.78999999999992, 299.3264530283091, 155.90999999999983, 17.735904069555563, 263.14114274893416, 182.6901138085328, -43.75412350554597, 83.69453279199668, 233.76313267806978, 200.10504821834277, 274.2253572621226, 218.4036502690378, 163.36485244877753, 156.23829553018922, 165.0466704962159, 335.06657197966393, 213.25795039048836, 142.0841631312629, 6.133836500766288, 101.00000000000004, 254.31991718345128, 131.96000000000026, 219.65782433685365, 293.0119865924137, 84.41351531013642, 117.58908851507375, 318.55039025164666, 145.26479533276984, 370.5826044042371, 89.12000000000022, 279.67358760221185, 104.9400000000005, 3.9499999999999598, 280.1176977287922, 280.43651807776644, 246.7387851459384, 102.93000000000025, -271.0490008356444, 281.2868097680458, 151.17826211087856, 95.74415329590961, -30.20891067509904, 214.48301967336465, 294.17009381538946, 9.970112944877915, 156.0603845389317, 3.9099999999999606, 152.15000000000012, 72.98083212891702, 201.56177028522586, 3.92999999999996, 167.93274142160675, 192.42726392774557, 46.30427778340263, 104.4857572297144, -8.769842369776851, 151.67619251991115, 257.944662405909, 162.1499999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-62.42217967917075, -11.41842906808477, 58.07394906296604, 87.16619576319812, -5.113958191883508, -5.749895273744117, 120.20170933473321, 10.90999999999996, 2.0000000000000013, -26.958695170264004, 169.4018879623556, 24.770000000000277, -3.6356268182980678, -71.45252751185797, -50.70448326681819, -0.43837963122747525, -352.4475039087543, 33.53510123807918, -43.71483547995937, 78.51387905313733, -264.9869772428765, -35.117016369772365, -111.47119987604322, -6.149748768750825, -22.9143616776723, -64.46963486657808, -14.092380452141397, -4.248728647842679, -7.193723166239861, -75.598130038878, -39.42506536134172, 152.58121033681567, -78.1842441903216, 18.064408958771853, -36.68117173317399, -22.410330316947263, -231.07546692541624, -9.217828558645692, -38.89951996341998, -112.40602487602891, -49.03322448204389, -11.21416428388003, 161.1683077597799, 185.61536701738737, -58.91496494329243, -177.71953712271556, -38.41245371876104, -7.1097468202091445, -83.28926629345172, -431.3139753574692, 55.50937582313894, -12.55682684338891, 29.564776749091433, 78.30637821196396, -74.74786595140282, -0.2878809596648546, -4.404516106143054, -138.1337276161641, -148.29923734411778, -94.66321436685216, -370.5129542866647, 2.0000000000000013, -53.80803749822488, 70.5588971840542, 163.06479079310668, 145.08044030007585, -102.1765063007779, 114.78977841096601, -40.44210469564344, 158.6077088962846, -16.13231478039295, 2.0000000000000013, 2.0000000000000013, 46.24682552563979, -69.31277439323469, -145.82654581276086, 2.0000000000000013, -3.3075253668226168, 0.4992909738111854, 33.355566179368566, 51.23845080467087, -7.21882991888647, 2.0000000000000013, -30.16229889594788, 101.64675006177937, -119.65808065344652, -25.54829680975673, 50.82682460129334, -8.953694672847774, 2.98999999999998, -38.12758046432121, -118.73533850446762, -32.58269092161117, 142.9019283069701, -508.7004369696497, -235.16809880466542, -234.51347102989035, -177.6897276916747, 26.229327735512985, -14.11586753160954, -49.09096367598861, -17.198246720913705, 41.39507422609758, 64.35207346297487, 114.52070299562594, 2.0000000000000013, -117.25119059538414, 0.07386209146203451, -36.122996103068495, -120.40614407582481, -13.019690717633573, -55.338882000148246, 17.459659429434954, 37.8840711279205, -74.98945812736898, -50.0149293332189, -0.028059780397630463, -113.80707843066679, -4.882456429839731, -14.75202588386414, -166.7235726701618, 2.0000000000000013, -34.08001940449997, 124.60664217758286, -92.28921166002164, -26.443545317459964, -182.4192033203838, -37.68665259535092, -45.166799553133245, 40.99301168962957, -250.57106805064672, -9.52715742987653, -411.55523152489366, 44.46088194673793, 60.94336274491846, 169.48376867472177, 36.01275921480712, -40.373983095081044, 25.22662580365482, 4.5632471097453795, 0.07599254021974568, -158.5413825710456, 84.1695137223391, -174.00634949689538, -43.16822951544907, -100.89890385643342, -7.126799095752428, 0.18522702498592886, -345.22647001627035, 2.0000000000000013, -107.92975805256346, -267.4331708592345, -223.10381469264084, 9.073219647848378, -16.62519843764743, -120.59221612389923, -835.4327559354488, -631.5961504268348, -25.282435743200043, -28.982968767252373, 63.12747898807626, -2.111534327939567, -39.61939325873517, -67.71411633110631, -178.31675803106913, -545.2084660382042, 116.54313598714623, -39.856472534893015, -59.061385922074365, -548.4355414745536, -12.146446673385897, -11.56992194202105, 9.221702489730504, -55.77856552930599, -19.402206325118748, -3.6298657069199427, 46.53344756494097, 2.0000000000000013, -614.4397771934182, 2.0000000000000013, -27.669134278225712, -48.80845140607673, -23.29541037574321, -4.558200734942435, -74.92063532035365, -31.307656560953497, 12.578473096014527, -51.260371329917334, -23.47777335568765, -37.808910380970744, -67.02585137031535, -474.59577804413703, -28.023317928801024, -29.699694442375282, -162.96495337702265, -273.758262776123, -32.836163000908385, 30.927179037889484, 116.40223334607887, -31.70948624201297], "policy_predator_policy_reward": [38.51558059594578, 53.152371015861036, 141.8869050751857, 105.96689189232904, 7.083958191883466, 7.7298952737440745, 54.665825746189284, 42.49428557495865, 85.28828010858078, 132.47787093150015, 24.598112037644412, 0.0, 142.33883423164858, 133.6360313343228, 118.3217715096855, 128.42229734808495, 486.6618091026142, 45.00511838647369, 106.2527606936813, 198.77255269440892, 102.14496655075192, 306.38468070184575, 262.15280041026944, 211.1435190256927, 151.05517041536393, 151.97297829352448, 16.03238045214136, 6.228728647842637, 256.7279473437775, 25.221673332900746, 56.73028212446945, 181.55257700132196, 35.400744406941364, 241.80454416304053, 136.16792073329125, 113.7897430741963, 275.2867220613345, 155.75200593877972, 152.63088426918839, 119.6446605702601, 115.19827736243316, 156.48454490149632, 8.404632982612615, 20.941692240220117, 273.62398151813034, 279.5028133268555, 9.079746820209103, 40.29245371876067, 475.3607345358415, 172.03044501475586, 61.90564167918156, 90.82946913564592, 148.21302046031857, 132.59554089262127, 75.04542271885187, 8.71139480530364, 129.08121217523876, 194.09350190255736, 150.8494208674554, 126.04303084351452, 109.50441828886312, 363.7814829657535, 112.71032883064755, 63.35840596688243, 17.209555346880368, 51.355376956648804, 3.976183494577653, 241.29627075160522, 27.412291103715393, 42.34210469564306, 18.082314780393254, 7.185827872050194, 72.72206279459, 117.00278295608582, 187.22966340865656, 264.6799041448866, 5.287525366822575, 3.410632941591704, 18.60436385266495, 93.61077899415531, 144.3917242597453, 167.5618539381038, 0.0, 43.95229889594816, 186.55350731728296, 130.7842763026934, 27.45829680975703, 103.17317539870666, 11.688227659608259, 12.01137108279481, 164.59430167205701, 255.40976004566642, 41.97075590930109, 30.400120513872633, 137.51644889015927, 562.5979633786094, 144.72749141209, 351.17024010147003, 106.33472638581115, 115.31494608835594, 128.40140070644784, 137.99285790879804, 51.56979203204664, 116.90841754100342, 49.07551846258013, 52.807428810832164, 219.48894746261118, 61.053233490088644, 205.79733708420508, 106.97009862487705, 86.98051852955231, 146.4247246844453, 109.30363217295961, 170.41920924934885, 160.53480245119522, 177.7275353998825, 232.2990849374899, 23.620216404837233, 14.586147879046809, 11.182170935423475, 260.1521515987684, 5.5714210713933365, 98.81661690721805, 64.9766775031511, 143.5512717061555, 107.14148527132637, 238.60373286392985, 201.15994738865857, 196.12127290950295, 101.06450154641466, 290.05801374491597, 54.45372704574303, 13.286340747416258, 471.39709734581305, 33.58337423154737, 54.53988460045889, 148.05689646765487, 1.569122745388144, 164.83283519952357, 175.95989629131344, 54.46992433847923, 193.1154656923468, 251.05116314336692, 118.45926023340137, 54.47735924798198, 194.5297741239003, 1.8047729750140726, 9.086799095752387, 253.95387351046622, 369.3902942345974, 369.34917355404747, 286.450273435517, 195.6373219774621, 265.13205821326886, 128.99921256355682, 111.1482019979902, 156.12210961755687, 1039.8577959090837, 145.26948227789916, 190.28273200059903, 16.054106370478227, 74.10821108026357, 60.65687557171689, 142.42078731403325, 608.0436001265799, 85.27271326759427, 76.21465201097328, 61.58170421013841, 451.10468773399907, 450.5623334780185, 13.767658725593874, 19.918822834690992, 27.25868374246405, 175.35856383604266, 21.34220632511905, 5.599865706919901, 0.0, 103.61655243505902, 143.04926390522786, 542.3713454171071, 167.74521413695294, 110.29414183257587, 25.255410375743516, 6.528200734942393, 161.3367255565126, 112.82430774640108, 100.9927035253162, 130.11645863633197, 37.971670619924346, 69.61929090013727, 418.5340832276404, 227.57330341652622, 8.813705871656941, 40.13946412974318, 48.49667272600589, 539.9027359470512, 173.29599409801003, 86.55765227091786, 43.8177666539211, 33.639486242012694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5580957476701429, "mean_inference_ms": 1.3878225412840572, "mean_action_processing_ms": 0.2404619483458639, "mean_env_wait_ms": 0.18251675457971406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033903121948242188, "StateBufferConnector_ms": 0.0029114484786987305, "ViewRequirementAgentConnector_ms": 0.08167195320129395}, "num_episodes": 18, "episode_return_max": 393.09394179367905, "episode_return_min": -271.0490008356444, "episode_return_mean": 168.38285789216243, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.7710021911779, "num_env_steps_trained_throughput_per_sec": 419.7710021911779, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 9149.783, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9149.747, "sample_time_ms": 970.149, "learn_time_ms": 8167.295, "learn_throughput": 489.758, "synch_weights_time_ms": 11.599}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "1f15c_00000", "date": "2024-08-16_14-12-32", "timestamp": 1723797752, "time_this_iter_s": 9.532073259353638, "time_total_s": 556.9862430095673, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f872dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 556.9862430095673, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 35.1, "ram_util_percent": 74.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9092123310875009, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.2815690449305945, "policy_loss": -0.0056109609761122595, "vf_loss": 6.286786562298971, "vf_explained_var": 0.02750687283813638, "kl": 0.007869079997503026, "entropy": 0.7951082550344013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4335680760719156, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.95653968235803, "policy_loss": -0.0029149568867598654, "vf_loss": 5.95776913077743, "vf_explained_var": -0.17269234635211803, "kl": 0.011236654449875826, "entropy": 1.3005923182245285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 388.6797163139952, "episode_reward_min": -271.0490008356444, "episode_reward_mean": 163.11402236117874, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1100.523681492802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.48376867472177, "predator_policy": 1100.2272732699078}, "policy_reward_mean": {"prey_policy": -56.74291774037136, "predator_policy": 138.29992892096078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.849999999999961, 132.7879378996763, 195.68765979457714, 388.6797163139952, 8.721070613086813, 180.63647035548888, 33.929999999999666, 104.77294696795235, 192.8195944833593, 376.71016339671166, 257.88572635637104, 187.91999999999973, 11.13582787205011, 237.97167127631496, 236.77024734754767, 7.390632941591619, 146.07000000000008, 355.97319908363335, 15.78999999999992, 299.3264530283091, 155.90999999999983, 17.735904069555563, 263.14114274893416, 182.6901138085328, -43.75412350554597, 83.69453279199668, 233.76313267806978, 200.10504821834277, 274.2253572621226, 218.4036502690378, 163.36485244877753, 156.23829553018922, 165.0466704962159, 335.06657197966393, 213.25795039048836, 142.0841631312629, 6.133836500766288, 101.00000000000004, 254.31991718345128, 131.96000000000026, 219.65782433685365, 293.0119865924137, 84.41351531013642, 117.58908851507375, 318.55039025164666, 145.26479533276984, 370.5826044042371, 89.12000000000022, 279.67358760221185, 104.9400000000005, 3.9499999999999598, 280.1176977287922, 280.43651807776644, 246.7387851459384, 102.93000000000025, -271.0490008356444, 281.2868097680458, 151.17826211087856, 95.74415329590961, -30.20891067509904, 214.48301967336465, 294.17009381538946, 9.970112944877915, 156.0603845389317, 3.9099999999999606, 152.15000000000012, 72.98083212891702, 201.56177028522586, 3.92999999999996, 167.93274142160675, 192.42726392774557, 46.30427778340263, 104.4857572297144, -8.769842369776851, 151.67619251991115, 257.944662405909, 162.1499999999999, 40.05760024107073, 11.655951902959664, 187.2756443914612, 222.17235773398153, 48.48019890920782, 135.0200000000002, 238.37595939717005, 253.98894585836626, 194.71455963448997, 256.34571346186203, 209.15597025299672, 216.2306887550176, 197.6230652366652, 361.316919352567, 148.44053689979515, 208.86798884466884, 205.83593855337156, 357.6105051277717, 10.492230577839162, 73.96737434736683, 170.48702828079334, 387.4720952396906, 199.30325611908384], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.41245371876104, -7.1097468202091445, -83.28926629345172, -431.3139753574692, 55.50937582313894, -12.55682684338891, 29.564776749091433, 78.30637821196396, -74.74786595140282, -0.2878809596648546, -4.404516106143054, -138.1337276161641, -148.29923734411778, -94.66321436685216, -370.5129542866647, 2.0000000000000013, -53.80803749822488, 70.5588971840542, 163.06479079310668, 145.08044030007585, -102.1765063007779, 114.78977841096601, -40.44210469564344, 158.6077088962846, -16.13231478039295, 2.0000000000000013, 2.0000000000000013, 46.24682552563979, -69.31277439323469, -145.82654581276086, 2.0000000000000013, -3.3075253668226168, 0.4992909738111854, 33.355566179368566, 51.23845080467087, -7.21882991888647, 2.0000000000000013, -30.16229889594788, 101.64675006177937, -119.65808065344652, -25.54829680975673, 50.82682460129334, -8.953694672847774, 2.98999999999998, -38.12758046432121, -118.73533850446762, -32.58269092161117, 142.9019283069701, -508.7004369696497, -235.16809880466542, -234.51347102989035, -177.6897276916747, 26.229327735512985, -14.11586753160954, -49.09096367598861, -17.198246720913705, 41.39507422609758, 64.35207346297487, 114.52070299562594, 2.0000000000000013, -117.25119059538414, 0.07386209146203451, -36.122996103068495, -120.40614407582481, -13.019690717633573, -55.338882000148246, 17.459659429434954, 37.8840711279205, -74.98945812736898, -50.0149293332189, -0.028059780397630463, -113.80707843066679, -4.882456429839731, -14.75202588386414, -166.7235726701618, 2.0000000000000013, -34.08001940449997, 124.60664217758286, -92.28921166002164, -26.443545317459964, -182.4192033203838, -37.68665259535092, -45.166799553133245, 40.99301168962957, -250.57106805064672, -9.52715742987653, -411.55523152489366, 44.46088194673793, 60.94336274491846, 169.48376867472177, 36.01275921480712, -40.373983095081044, 25.22662580365482, 4.5632471097453795, 0.07599254021974568, -158.5413825710456, 84.1695137223391, -174.00634949689538, -43.16822951544907, -100.89890385643342, -7.126799095752428, 0.18522702498592886, -345.22647001627035, 2.0000000000000013, -107.92975805256346, -267.4331708592345, -223.10381469264084, 9.073219647848378, -16.62519843764743, -120.59221612389923, -835.4327559354488, -631.5961504268348, -25.282435743200043, -28.982968767252373, 63.12747898807626, -2.111534327939567, -39.61939325873517, -67.71411633110631, -178.31675803106913, -545.2084660382042, 116.54313598714623, -39.856472534893015, -59.061385922074365, -548.4355414745536, -12.146446673385897, -11.56992194202105, 9.221702489730504, -55.77856552930599, -19.402206325118748, -3.6298657069199427, 46.53344756494097, 2.0000000000000013, -614.4397771934182, 2.0000000000000013, -27.669134278225712, -48.80845140607673, -23.29541037574321, -4.558200734942435, -74.92063532035365, -31.307656560953497, 12.578473096014527, -51.260371329917334, -23.47777335568765, -37.808910380970744, -67.02585137031535, -474.59577804413703, -28.023317928801024, -29.699694442375282, -162.96495337702265, -273.758262776123, -32.836163000908385, 30.927179037889484, 116.40223334607887, -31.70948624201297, 2.0000000000000013, -76.28857587238956, -8.609717210525751, -1100.523681492802, -8.829194345306723, 106.54079108402087, -314.54559034603324, -52.67142414215603, 2.0000000000000013, -58.23248641190971, -0.30585302745110887, -23.172419245132733, -112.54937223213554, -89.37805204065523, 11.561437448980678, 26.619515645414374, 30.577934008600923, 2.0000000000000013, 83.26886678211889, -21.98172418373945, 78.95584580758236, -50.72562565176667, 29.842361311786544, -40.02216486664315, 114.42342644474198, -28.322687770658337, -30.921733112040123, -131.99143186050986, -16.97570890197317, -7.079497900388375, 153.67761016956788, -66.65071149284933, -13.824424281978109, 18.956571254543398, -16.30670816338506, 76.50913535915942, -8.176310158853855, -44.501663135398054, -207.05751051010535, -282.3689096325111, -42.819293133926784, 105.88871535166025, 153.1274415015816, 4.951535877683041, 7.027645794075005, -7.302807810244891], "policy_predator_policy_reward": [9.079746820209103, 40.29245371876067, 475.3607345358415, 172.03044501475586, 61.90564167918156, 90.82946913564592, 148.21302046031857, 132.59554089262127, 75.04542271885187, 8.71139480530364, 129.08121217523876, 194.09350190255736, 150.8494208674554, 126.04303084351452, 109.50441828886312, 363.7814829657535, 112.71032883064755, 63.35840596688243, 17.209555346880368, 51.355376956648804, 3.976183494577653, 241.29627075160522, 27.412291103715393, 42.34210469564306, 18.082314780393254, 7.185827872050194, 72.72206279459, 117.00278295608582, 187.22966340865656, 264.6799041448866, 5.287525366822575, 3.410632941591704, 18.60436385266495, 93.61077899415531, 144.3917242597453, 167.5618539381038, 0.0, 43.95229889594816, 186.55350731728296, 130.7842763026934, 27.45829680975703, 103.17317539870666, 11.688227659608259, 12.01137108279481, 164.59430167205701, 255.40976004566642, 41.97075590930109, 30.400120513872633, 137.51644889015927, 562.5979633786094, 144.72749141209, 351.17024010147003, 106.33472638581115, 115.31494608835594, 128.40140070644784, 137.99285790879804, 51.56979203204664, 116.90841754100342, 49.07551846258013, 52.807428810832164, 219.48894746261118, 61.053233490088644, 205.79733708420508, 106.97009862487705, 86.98051852955231, 146.4247246844453, 109.30363217295961, 170.41920924934885, 160.53480245119522, 177.7275353998825, 232.2990849374899, 23.620216404837233, 14.586147879046809, 11.182170935423475, 260.1521515987684, 5.5714210713933365, 98.81661690721805, 64.9766775031511, 143.5512717061555, 107.14148527132637, 238.60373286392985, 201.15994738865857, 196.12127290950295, 101.06450154641466, 290.05801374491597, 54.45372704574303, 13.286340747416258, 471.39709734581305, 33.58337423154737, 54.53988460045889, 148.05689646765487, 1.569122745388144, 164.83283519952357, 175.95989629131344, 54.46992433847923, 193.1154656923468, 251.05116314336692, 118.45926023340137, 54.47735924798198, 194.5297741239003, 1.8047729750140726, 9.086799095752387, 253.95387351046622, 369.3902942345974, 369.34917355404747, 286.450273435517, 195.6373219774621, 265.13205821326886, 128.99921256355682, 111.1482019979902, 156.12210961755687, 1039.8577959090837, 145.26948227789916, 190.28273200059903, 16.054106370478227, 74.10821108026357, 60.65687557171689, 142.42078731403325, 608.0436001265799, 85.27271326759427, 76.21465201097328, 61.58170421013841, 451.10468773399907, 450.5623334780185, 13.767658725593874, 19.918822834690992, 27.25868374246405, 175.35856383604266, 21.34220632511905, 5.599865706919901, 0.0, 103.61655243505902, 143.04926390522786, 542.3713454171071, 167.74521413695294, 110.29414183257587, 25.255410375743516, 6.528200734942393, 161.3367255565126, 112.82430774640108, 100.9927035253162, 130.11645863633197, 37.971670619924346, 69.61929090013727, 418.5340832276404, 227.57330341652622, 8.813705871656941, 40.13946412974318, 48.49667272600589, 539.9027359470512, 173.29599409801003, 86.55765227091786, 43.8177666539211, 33.639486242012694, 57.15144202782266, 57.19473408563929, 20.562077336379776, 1100.2272732699078, 50.44347105886461, 39.12057659388283, 285.42359671440664, 303.96577550776385, 51.19008695766353, 53.522598363454364, 106.45713924154354, 52.04113303104025, 166.81928215947983, 273.4841015104811, 86.87974916335477, 128.92824360061647, 71.94213292178534, 90.19449270410415, 20.895219626452985, 174.1633512370296, 108.58673316959992, 72.33901692758134, 104.85280394247268, 121.55768836740143, 62.839946035547236, 48.682380527035036, 237.11854649340273, 287.1115378317141, 116.2236461927733, 56.27209750938331, 57.71380951817805, 64.12728064977375, 111.20029721889146, 89.5034943619151, 146.63810438552272, 150.76997354647492, 36.597617017939065, 26.57258685415168, 361.83558291628776, 201.55821157369542, 48.11543788598827, 59.30216817707138, 131.4656845091982, 97.92743335122793, 79.4293140552458, 120.14910408000834]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567086901413638, "mean_inference_ms": 1.3842779105857133, "mean_action_processing_ms": 0.23976451485595146, "mean_env_wait_ms": 0.18203165428401744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505706787109375, "StateBufferConnector_ms": 0.0030001401901245117, "ViewRequirementAgentConnector_ms": 0.08401572704315186}, "num_episodes": 23, "episode_return_max": 388.6797163139952, "episode_return_min": -271.0490008356444, "episode_return_mean": 163.11402236117874, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.2369817693601, "num_env_steps_trained_throughput_per_sec": 444.2369817693601, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 9147.461, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9147.424, "sample_time_ms": 974.782, "learn_time_ms": 8160.551, "learn_throughput": 490.163, "synch_weights_time_ms": 11.36}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "1f15c_00000", "date": "2024-08-16_14-12-41", "timestamp": 1723797761, "time_this_iter_s": 9.007321834564209, "time_total_s": 565.9935648441315, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f877820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 565.9935648441315, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 32.338461538461544, "ram_util_percent": 74.07692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.897716728436253, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.988440536569666, "policy_loss": -0.005919174800833894, "vf_loss": 6.994012979729466, "vf_explained_var": 0.027757620117651722, "kl": 0.006934729173422177, "entropy": 0.5923082033004711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1604984637921447, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.513418446142206, "policy_loss": -0.0015578975590566793, "vf_loss": 6.513516060258977, "vf_explained_var": -0.3167691210905711, "kl": 0.009735199901276822, "entropy": 1.3307695774804977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 419.02402806525373, "episode_reward_min": -271.0490008356444, "episode_reward_mean": 163.70181643586966, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1100.523681492802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.48376867472177, "predator_policy": 1100.2272732699078}, "policy_reward_mean": {"prey_policy": -70.99118925301043, "predator_policy": 152.8420974709453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.78999999999992, 299.3264530283091, 155.90999999999983, 17.735904069555563, 263.14114274893416, 182.6901138085328, -43.75412350554597, 83.69453279199668, 233.76313267806978, 200.10504821834277, 274.2253572621226, 218.4036502690378, 163.36485244877753, 156.23829553018922, 165.0466704962159, 335.06657197966393, 213.25795039048836, 142.0841631312629, 6.133836500766288, 101.00000000000004, 254.31991718345128, 131.96000000000026, 219.65782433685365, 293.0119865924137, 84.41351531013642, 117.58908851507375, 318.55039025164666, 145.26479533276984, 370.5826044042371, 89.12000000000022, 279.67358760221185, 104.9400000000005, 3.9499999999999598, 280.1176977287922, 280.43651807776644, 246.7387851459384, 102.93000000000025, -271.0490008356444, 281.2868097680458, 151.17826211087856, 95.74415329590961, -30.20891067509904, 214.48301967336465, 294.17009381538946, 9.970112944877915, 156.0603845389317, 3.9099999999999606, 152.15000000000012, 72.98083212891702, 201.56177028522586, 3.92999999999996, 167.93274142160675, 192.42726392774557, 46.30427778340263, 104.4857572297144, -8.769842369776851, 151.67619251991115, 257.944662405909, 162.1499999999999, 40.05760024107073, 11.655951902959664, 187.2756443914612, 222.17235773398153, 48.48019890920782, 135.0200000000002, 238.37595939717005, 253.98894585836626, 194.71455963448997, 256.34571346186203, 209.15597025299672, 216.2306887550176, 197.6230652366652, 361.316919352567, 148.44053689979515, 208.86798884466884, 205.83593855337156, 357.6105051277717, 10.492230577839162, 73.96737434736683, 170.48702828079334, 387.4720952396906, 199.30325611908384, 193.1571482763152, 65.31486935163855, 10.819084715504786, -7.665823742752565, 114.96362540831204, 98.50325934152498, 166.67441930425593, 302.34000000000003, 202.0154028565865, 52.37476541165124, 153.36477310029431, 212.16817640276406, 270.6007376760285, 352.44011869407956, 250.51167889781922, 158.01999999999995, 419.02402806525373, 103.86600841217056], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -30.16229889594788, 101.64675006177937, -119.65808065344652, -25.54829680975673, 50.82682460129334, -8.953694672847774, 2.98999999999998, -38.12758046432121, -118.73533850446762, -32.58269092161117, 142.9019283069701, -508.7004369696497, -235.16809880466542, -234.51347102989035, -177.6897276916747, 26.229327735512985, -14.11586753160954, -49.09096367598861, -17.198246720913705, 41.39507422609758, 64.35207346297487, 114.52070299562594, 2.0000000000000013, -117.25119059538414, 0.07386209146203451, -36.122996103068495, -120.40614407582481, -13.019690717633573, -55.338882000148246, 17.459659429434954, 37.8840711279205, -74.98945812736898, -50.0149293332189, -0.028059780397630463, -113.80707843066679, -4.882456429839731, -14.75202588386414, -166.7235726701618, 2.0000000000000013, -34.08001940449997, 124.60664217758286, -92.28921166002164, -26.443545317459964, -182.4192033203838, -37.68665259535092, -45.166799553133245, 40.99301168962957, -250.57106805064672, -9.52715742987653, -411.55523152489366, 44.46088194673793, 60.94336274491846, 169.48376867472177, 36.01275921480712, -40.373983095081044, 25.22662580365482, 4.5632471097453795, 0.07599254021974568, -158.5413825710456, 84.1695137223391, -174.00634949689538, -43.16822951544907, -100.89890385643342, -7.126799095752428, 0.18522702498592886, -345.22647001627035, 2.0000000000000013, -107.92975805256346, -267.4331708592345, -223.10381469264084, 9.073219647848378, -16.62519843764743, -120.59221612389923, -835.4327559354488, -631.5961504268348, -25.282435743200043, -28.982968767252373, 63.12747898807626, -2.111534327939567, -39.61939325873517, -67.71411633110631, -178.31675803106913, -545.2084660382042, 116.54313598714623, -39.856472534893015, -59.061385922074365, -548.4355414745536, -12.146446673385897, -11.56992194202105, 9.221702489730504, -55.77856552930599, -19.402206325118748, -3.6298657069199427, 46.53344756494097, 2.0000000000000013, -614.4397771934182, 2.0000000000000013, -27.669134278225712, -48.80845140607673, -23.29541037574321, -4.558200734942435, -74.92063532035365, -31.307656560953497, 12.578473096014527, -51.260371329917334, -23.47777335568765, -37.808910380970744, -67.02585137031535, -474.59577804413703, -28.023317928801024, -29.699694442375282, -162.96495337702265, -273.758262776123, -32.836163000908385, 30.927179037889484, 116.40223334607887, -31.70948624201297, 2.0000000000000013, -76.28857587238956, -8.609717210525751, -1100.523681492802, -8.829194345306723, 106.54079108402087, -314.54559034603324, -52.67142414215603, 2.0000000000000013, -58.23248641190971, -0.30585302745110887, -23.172419245132733, -112.54937223213554, -89.37805204065523, 11.561437448980678, 26.619515645414374, 30.577934008600923, 2.0000000000000013, 83.26886678211889, -21.98172418373945, 78.95584580758236, -50.72562565176667, 29.842361311786544, -40.02216486664315, 114.42342644474198, -28.322687770658337, -30.921733112040123, -131.99143186050986, -16.97570890197317, -7.079497900388375, 153.67761016956788, -66.65071149284933, -13.824424281978109, 18.956571254543398, -16.30670816338506, 76.50913535915942, -8.176310158853855, -44.501663135398054, -207.05751051010535, -282.3689096325111, -42.819293133926784, 105.88871535166025, 153.1274415015816, 4.951535877683041, 7.027645794075005, -7.302807810244891, 24.62768091486834, -122.20467425793063, -347.07548622510905, -0.3796259890318632, -38.26649327517127, -56.63337932279077, -240.9892761139702, -423.4578667830241, -131.90623585948373, -367.678868863752, -23.235075244550664, -225.2925770210919, 38.64283488433562, 13.105509128417316, -64.22881866397596, 93.01009096791879, 2.0000000000000013, 162.7580512872097, -409.05379606892564, -412.4026515976487, -30.325418232338222, -32.56329171257577, -339.3970655477633, -193.52943045985697, 2.0000000000000013, -213.57884637959938, -117.05966477295084, 45.07970148930026, 134.93751843364714, -29.09241726001159, -42.78581198111146, 79.74084458399507, -298.2958359894143, 2.0000000000000013, -167.50908417184692, -7.748867002446595], "policy_predator_policy_reward": [0.0, 43.95229889594816, 186.55350731728296, 130.7842763026934, 27.45829680975703, 103.17317539870666, 11.688227659608259, 12.01137108279481, 164.59430167205701, 255.40976004566642, 41.97075590930109, 30.400120513872633, 137.51644889015927, 562.5979633786094, 144.72749141209, 351.17024010147003, 106.33472638581115, 115.31494608835594, 128.40140070644784, 137.99285790879804, 51.56979203204664, 116.90841754100342, 49.07551846258013, 52.807428810832164, 219.48894746261118, 61.053233490088644, 205.79733708420508, 106.97009862487705, 86.98051852955231, 146.4247246844453, 109.30363217295961, 170.41920924934885, 160.53480245119522, 177.7275353998825, 232.2990849374899, 23.620216404837233, 14.586147879046809, 11.182170935423475, 260.1521515987684, 5.5714210713933365, 98.81661690721805, 64.9766775031511, 143.5512717061555, 107.14148527132637, 238.60373286392985, 201.15994738865857, 196.12127290950295, 101.06450154641466, 290.05801374491597, 54.45372704574303, 13.286340747416258, 471.39709734581305, 33.58337423154737, 54.53988460045889, 148.05689646765487, 1.569122745388144, 164.83283519952357, 175.95989629131344, 54.46992433847923, 193.1154656923468, 251.05116314336692, 118.45926023340137, 54.47735924798198, 194.5297741239003, 1.8047729750140726, 9.086799095752387, 253.95387351046622, 369.3902942345974, 369.34917355404747, 286.450273435517, 195.6373219774621, 265.13205821326886, 128.99921256355682, 111.1482019979902, 156.12210961755687, 1039.8577959090837, 145.26948227789916, 190.28273200059903, 16.054106370478227, 74.10821108026357, 60.65687557171689, 142.42078731403325, 608.0436001265799, 85.27271326759427, 76.21465201097328, 61.58170421013841, 451.10468773399907, 450.5623334780185, 13.767658725593874, 19.918822834690992, 27.25868374246405, 175.35856383604266, 21.34220632511905, 5.599865706919901, 0.0, 103.61655243505902, 143.04926390522786, 542.3713454171071, 167.74521413695294, 110.29414183257587, 25.255410375743516, 6.528200734942393, 161.3367255565126, 112.82430774640108, 100.9927035253162, 130.11645863633197, 37.971670619924346, 69.61929090013727, 418.5340832276404, 227.57330341652622, 8.813705871656941, 40.13946412974318, 48.49667272600589, 539.9027359470512, 173.29599409801003, 86.55765227091786, 43.8177666539211, 33.639486242012694, 57.15144202782266, 57.19473408563929, 20.562077336379776, 1100.2272732699078, 50.44347105886461, 39.12057659388283, 285.42359671440664, 303.96577550776385, 51.19008695766353, 53.522598363454364, 106.45713924154354, 52.04113303104025, 166.81928215947983, 273.4841015104811, 86.87974916335477, 128.92824360061647, 71.94213292178534, 90.19449270410415, 20.895219626452985, 174.1633512370296, 108.58673316959992, 72.33901692758134, 104.85280394247268, 121.55768836740143, 62.839946035547236, 48.682380527035036, 237.11854649340273, 287.1115378317141, 116.2236461927733, 56.27209750938331, 57.71380951817805, 64.12728064977375, 111.20029721889146, 89.5034943619151, 146.63810438552272, 150.76997354647492, 36.597617017939065, 26.57258685415168, 361.83558291628776, 201.55821157369542, 48.11543788598827, 59.30216817707138, 131.4656845091982, 97.92743335122793, 79.4293140552458, 120.14910408000834, 49.473843773549575, 241.26029784582792, 106.89164069354767, 305.87834087223195, 66.35337932279043, 39.36557799067577, 180.02337849375172, 476.75794066049, 124.16130834359997, 490.3874217879476, 178.834020480952, 168.1968911262148, 55.77296303245876, 59.15311225904562, 244.745344850935, 28.81338284512212, 23.367576872388348, 13.889774696988809, 599.5696077786056, 274.2616052996197, 45.78599696243798, 170.46748608277008, 242.71051813327674, 502.38415427710765, 254.21623432619995, 227.96334972942884, 208.74397420587545, 215.67610777185482, 72.44969294691742, 72.21688477726725, 100.61256969447021, 20.45239770264581, 334.1421929809978, 381.17767107367087, 198.4437477052321, 80.68021188123139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557719964167489, "mean_inference_ms": 1.382044306778248, "mean_action_processing_ms": 0.23927789956993295, "mean_env_wait_ms": 0.18175425745724652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038625001907348633, "StateBufferConnector_ms": 0.003031611442565918, "ViewRequirementAgentConnector_ms": 0.08762943744659424}, "num_episodes": 18, "episode_return_max": 419.02402806525373, "episode_return_min": -271.0490008356444, "episode_return_mean": 163.70181643586966, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 434.09691784289237, "num_env_steps_trained_throughput_per_sec": 434.09691784289237, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 9154.172, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9154.135, "sample_time_ms": 984.812, "learn_time_ms": 8157.302, "learn_throughput": 490.358, "synch_weights_time_ms": 11.244}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "1f15c_00000", "date": "2024-08-16_14-12-50", "timestamp": 1723797770, "time_this_iter_s": 9.218212127685547, "time_total_s": 575.211776971817, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f877ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 575.211776971817, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 33.02307692307693, "ram_util_percent": 74.1846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.563498864035127, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.099103932405906, "policy_loss": -0.003028001093857542, "vf_loss": 7.1019046533675425, "vf_explained_var": 0.013158634509989824, "kl": 0.004545454263016694, "entropy": 0.607503566224739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.933971065219748, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.072262340121799, "policy_loss": -0.004932457363853852, "vf_loss": 6.07550018981651, "vf_explained_var": -0.3328369235866284, "kl": 0.011297292204517353, "entropy": 1.249368606988715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 419.02402806525373, "episode_reward_min": -271.0490008356444, "episode_reward_mean": 164.68853863722705, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1100.523681492802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.48376867472177, "predator_policy": 1100.2272732699078}, "policy_reward_mean": {"prey_policy": -81.42134710043274, "predator_policy": 163.76561641904635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.133836500766288, 101.00000000000004, 254.31991718345128, 131.96000000000026, 219.65782433685365, 293.0119865924137, 84.41351531013642, 117.58908851507375, 318.55039025164666, 145.26479533276984, 370.5826044042371, 89.12000000000022, 279.67358760221185, 104.9400000000005, 3.9499999999999598, 280.1176977287922, 280.43651807776644, 246.7387851459384, 102.93000000000025, -271.0490008356444, 281.2868097680458, 151.17826211087856, 95.74415329590961, -30.20891067509904, 214.48301967336465, 294.17009381538946, 9.970112944877915, 156.0603845389317, 3.9099999999999606, 152.15000000000012, 72.98083212891702, 201.56177028522586, 3.92999999999996, 167.93274142160675, 192.42726392774557, 46.30427778340263, 104.4857572297144, -8.769842369776851, 151.67619251991115, 257.944662405909, 162.1499999999999, 40.05760024107073, 11.655951902959664, 187.2756443914612, 222.17235773398153, 48.48019890920782, 135.0200000000002, 238.37595939717005, 253.98894585836626, 194.71455963448997, 256.34571346186203, 209.15597025299672, 216.2306887550176, 197.6230652366652, 361.316919352567, 148.44053689979515, 208.86798884466884, 205.83593855337156, 357.6105051277717, 10.492230577839162, 73.96737434736683, 170.48702828079334, 387.4720952396906, 199.30325611908384, 193.1571482763152, 65.31486935163855, 10.819084715504786, -7.665823742752565, 114.96362540831204, 98.50325934152498, 166.67441930425593, 302.34000000000003, 202.0154028565865, 52.37476541165124, 153.36477310029431, 212.16817640276406, 270.6007376760285, 352.44011869407956, 250.51167889781922, 158.01999999999995, 419.02402806525373, 103.86600841217056, 200.22810721796114, 102.79019823399808, 156.93811051666682, 176.4537467530616, 415.17482011596746, 166.45976527763696, 105.93546802409242, 273.77344254963447, 221.2209202191037, 3.759999999999964, 17.146137595879566, 177.32771055561798, 230.44771747765805, 246.83339111259448, 64.12167372634019, 216.2656313432852, 171.01037236799397, 228.8747223942026], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.882456429839731, -14.75202588386414, -166.7235726701618, 2.0000000000000013, -34.08001940449997, 124.60664217758286, -92.28921166002164, -26.443545317459964, -182.4192033203838, -37.68665259535092, -45.166799553133245, 40.99301168962957, -250.57106805064672, -9.52715742987653, -411.55523152489366, 44.46088194673793, 60.94336274491846, 169.48376867472177, 36.01275921480712, -40.373983095081044, 25.22662580365482, 4.5632471097453795, 0.07599254021974568, -158.5413825710456, 84.1695137223391, -174.00634949689538, -43.16822951544907, -100.89890385643342, -7.126799095752428, 0.18522702498592886, -345.22647001627035, 2.0000000000000013, -107.92975805256346, -267.4331708592345, -223.10381469264084, 9.073219647848378, -16.62519843764743, -120.59221612389923, -835.4327559354488, -631.5961504268348, -25.282435743200043, -28.982968767252373, 63.12747898807626, -2.111534327939567, -39.61939325873517, -67.71411633110631, -178.31675803106913, -545.2084660382042, 116.54313598714623, -39.856472534893015, -59.061385922074365, -548.4355414745536, -12.146446673385897, -11.56992194202105, 9.221702489730504, -55.77856552930599, -19.402206325118748, -3.6298657069199427, 46.53344756494097, 2.0000000000000013, -614.4397771934182, 2.0000000000000013, -27.669134278225712, -48.80845140607673, -23.29541037574321, -4.558200734942435, -74.92063532035365, -31.307656560953497, 12.578473096014527, -51.260371329917334, -23.47777335568765, -37.808910380970744, -67.02585137031535, -474.59577804413703, -28.023317928801024, -29.699694442375282, -162.96495337702265, -273.758262776123, -32.836163000908385, 30.927179037889484, 116.40223334607887, -31.70948624201297, 2.0000000000000013, -76.28857587238956, -8.609717210525751, -1100.523681492802, -8.829194345306723, 106.54079108402087, -314.54559034603324, -52.67142414215603, 2.0000000000000013, -58.23248641190971, -0.30585302745110887, -23.172419245132733, -112.54937223213554, -89.37805204065523, 11.561437448980678, 26.619515645414374, 30.577934008600923, 2.0000000000000013, 83.26886678211889, -21.98172418373945, 78.95584580758236, -50.72562565176667, 29.842361311786544, -40.02216486664315, 114.42342644474198, -28.322687770658337, -30.921733112040123, -131.99143186050986, -16.97570890197317, -7.079497900388375, 153.67761016956788, -66.65071149284933, -13.824424281978109, 18.956571254543398, -16.30670816338506, 76.50913535915942, -8.176310158853855, -44.501663135398054, -207.05751051010535, -282.3689096325111, -42.819293133926784, 105.88871535166025, 153.1274415015816, 4.951535877683041, 7.027645794075005, -7.302807810244891, 24.62768091486834, -122.20467425793063, -347.07548622510905, -0.3796259890318632, -38.26649327517127, -56.63337932279077, -240.9892761139702, -423.4578667830241, -131.90623585948373, -367.678868863752, -23.235075244550664, -225.2925770210919, 38.64283488433562, 13.105509128417316, -64.22881866397596, 93.01009096791879, 2.0000000000000013, 162.7580512872097, -409.05379606892564, -412.4026515976487, -30.325418232338222, -32.56329171257577, -339.3970655477633, -193.52943045985697, 2.0000000000000013, -213.57884637959938, -117.05966477295084, 45.07970148930026, 134.93751843364714, -29.09241726001159, -42.78581198111146, 79.74084458399507, -298.2958359894143, 2.0000000000000013, -167.50908417184692, -7.748867002446595, -42.18631292543725, -119.38678380774245, -319.3180090387711, -135.12983469116548, -131.594157722691, 2.0000000000000013, 97.04000000000053, -532.8103752312886, -145.43185021135548, 91.96330691918192, -172.1718935590031, 2.0000000000000013, -341.919508949744, 2.0000000000000013, -119.7172205714829, -0.11660355394427736, -22.014382460666372, -227.68882683209023, -100.52628269797704, -17.855243352631437, -309.1215165282989, -368.3330030406771, 51.70459618146674, -2.6284355467380696, -79.49365657844427, 158.1005766263103, -84.79133297935404, 34.80879893403455, -533.9204610812332, 2.0000000000000013, 78.11944402998061, 4.257421036838689, -83.73781336708853, -183.18201409299766, -71.7046311055233, -52.1885117573591], "policy_predator_policy_reward": [14.586147879046809, 11.182170935423475, 260.1521515987684, 5.5714210713933365, 98.81661690721805, 64.9766775031511, 143.5512717061555, 107.14148527132637, 238.60373286392985, 201.15994738865857, 196.12127290950295, 101.06450154641466, 290.05801374491597, 54.45372704574303, 13.286340747416258, 471.39709734581305, 33.58337423154737, 54.53988460045889, 148.05689646765487, 1.569122745388144, 164.83283519952357, 175.95989629131344, 54.46992433847923, 193.1154656923468, 251.05116314336692, 118.45926023340137, 54.47735924798198, 194.5297741239003, 1.8047729750140726, 9.086799095752387, 253.95387351046622, 369.3902942345974, 369.34917355404747, 286.450273435517, 195.6373219774621, 265.13205821326886, 128.99921256355682, 111.1482019979902, 156.12210961755687, 1039.8577959090837, 145.26948227789916, 190.28273200059903, 16.054106370478227, 74.10821108026357, 60.65687557171689, 142.42078731403325, 608.0436001265799, 85.27271326759427, 76.21465201097328, 61.58170421013841, 451.10468773399907, 450.5623334780185, 13.767658725593874, 19.918822834690992, 27.25868374246405, 175.35856383604266, 21.34220632511905, 5.599865706919901, 0.0, 103.61655243505902, 143.04926390522786, 542.3713454171071, 167.74521413695294, 110.29414183257587, 25.255410375743516, 6.528200734942393, 161.3367255565126, 112.82430774640108, 100.9927035253162, 130.11645863633197, 37.971670619924346, 69.61929090013727, 418.5340832276404, 227.57330341652622, 8.813705871656941, 40.13946412974318, 48.49667272600589, 539.9027359470512, 173.29599409801003, 86.55765227091786, 43.8177666539211, 33.639486242012694, 57.15144202782266, 57.19473408563929, 20.562077336379776, 1100.2272732699078, 50.44347105886461, 39.12057659388283, 285.42359671440664, 303.96577550776385, 51.19008695766353, 53.522598363454364, 106.45713924154354, 52.04113303104025, 166.81928215947983, 273.4841015104811, 86.87974916335477, 128.92824360061647, 71.94213292178534, 90.19449270410415, 20.895219626452985, 174.1633512370296, 108.58673316959992, 72.33901692758134, 104.85280394247268, 121.55768836740143, 62.839946035547236, 48.682380527035036, 237.11854649340273, 287.1115378317141, 116.2236461927733, 56.27209750938331, 57.71380951817805, 64.12728064977375, 111.20029721889146, 89.5034943619151, 146.63810438552272, 150.76997354647492, 36.597617017939065, 26.57258685415168, 361.83558291628776, 201.55821157369542, 48.11543788598827, 59.30216817707138, 131.4656845091982, 97.92743335122793, 79.4293140552458, 120.14910408000834, 49.473843773549575, 241.26029784582792, 106.89164069354767, 305.87834087223195, 66.35337932279043, 39.36557799067577, 180.02337849375172, 476.75794066049, 124.16130834359997, 490.3874217879476, 178.834020480952, 168.1968911262148, 55.77296303245876, 59.15311225904562, 244.745344850935, 28.81338284512212, 23.367576872388348, 13.889774696988809, 599.5696077786056, 274.2616052996197, 45.78599696243798, 170.46748608277008, 242.71051813327674, 502.38415427710765, 254.21623432619995, 227.96334972942884, 208.74397420587545, 215.67610777185482, 72.44969294691742, 72.21688477726725, 100.61256969447021, 20.45239770264581, 334.1421929809978, 381.17767107367087, 198.4437477052321, 80.68021188123139, 169.515384885578, 192.28581906556286, 413.81106784155924, 143.426974122376, 119.43433057020323, 167.0979376691549, 580.5869527969181, 31.637169187432736, 285.1806607730412, 183.46270263509993, 45.154444839342894, 291.47721399729744, 59.013444600450185, 386.8415323733861, 169.98090682558606, 223.6263598494766, 198.56325177123261, 272.3608777406289, 19.78524335263174, 102.35628269797797, 525.2259267156226, 169.37473044923289, 34.38864974902968, 93.86290017185966, 91.07152574772593, 60.769271682067675, 85.26564585148681, 211.5502793064273, 73.80525997724892, 522.2368748303247, 65.43859712716424, 68.45016914930193, 82.06778412671456, 355.8624157013656, 184.36224776295197, 168.4056174941333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548374674065775, "mean_inference_ms": 1.3798372858190293, "mean_action_processing_ms": 0.23879728257283905, "mean_env_wait_ms": 0.18148138246256323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038442611694335938, "StateBufferConnector_ms": 0.0029838085174560547, "ViewRequirementAgentConnector_ms": 0.09093868732452393}, "num_episodes": 18, "episode_return_max": 419.02402806525373, "episode_return_min": -271.0490008356444, "episode_return_mean": 164.68853863722705, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.4359844580956, "num_env_steps_trained_throughput_per_sec": 433.4359844580956, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 9157.558, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9157.521, "sample_time_ms": 982.222, "learn_time_ms": 8163.217, "learn_throughput": 490.003, "synch_weights_time_ms": 11.293}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "1f15c_00000", "date": "2024-08-16_14-12-59", "timestamp": 1723797779, "time_this_iter_s": 9.231876134872437, "time_total_s": 584.4436531066895, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8cdb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 584.4436531066895, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 34.06153846153847, "ram_util_percent": 74.07692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.870393089106474, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.394808198787548, "policy_loss": -0.008117477376649659, "vf_loss": 6.402698737603647, "vf_explained_var": 0.005959725474554395, "kl": 0.00907714112406166, "entropy": 0.6578576492569433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2141198973807077, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.606654089594644, "policy_loss": -0.007431786784547425, "vf_loss": 5.612105120048321, "vf_explained_var": -0.505668595795909, "kl": 0.0132050905406302, "entropy": 1.2224443097593922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 419.02402806525373, "episode_reward_min": -101.25584564002308, "episode_reward_mean": 165.20338191780468, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1100.523681492802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 163.37, "predator_policy": 1100.2272732699078}, "policy_reward_mean": {"prey_policy": -89.95770863678081, "predator_policy": 172.5593995956832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.74415329590961, -30.20891067509904, 214.48301967336465, 294.17009381538946, 9.970112944877915, 156.0603845389317, 3.9099999999999606, 152.15000000000012, 72.98083212891702, 201.56177028522586, 3.92999999999996, 167.93274142160675, 192.42726392774557, 46.30427778340263, 104.4857572297144, -8.769842369776851, 151.67619251991115, 257.944662405909, 162.1499999999999, 40.05760024107073, 11.655951902959664, 187.2756443914612, 222.17235773398153, 48.48019890920782, 135.0200000000002, 238.37595939717005, 253.98894585836626, 194.71455963448997, 256.34571346186203, 209.15597025299672, 216.2306887550176, 197.6230652366652, 361.316919352567, 148.44053689979515, 208.86798884466884, 205.83593855337156, 357.6105051277717, 10.492230577839162, 73.96737434736683, 170.48702828079334, 387.4720952396906, 199.30325611908384, 193.1571482763152, 65.31486935163855, 10.819084715504786, -7.665823742752565, 114.96362540831204, 98.50325934152498, 166.67441930425593, 302.34000000000003, 202.0154028565865, 52.37476541165124, 153.36477310029431, 212.16817640276406, 270.6007376760285, 352.44011869407956, 250.51167889781922, 158.01999999999995, 419.02402806525373, 103.86600841217056, 200.22810721796114, 102.79019823399808, 156.93811051666682, 176.4537467530616, 415.17482011596746, 166.45976527763696, 105.93546802409242, 273.77344254963447, 221.2209202191037, 3.759999999999964, 17.146137595879566, 177.32771055561798, 230.44771747765805, 246.83339111259448, 64.12167372634019, 216.2656313432852, 171.01037236799397, 228.8747223942026, 22.940000000000037, 205.10720272155214, -101.25584564002308, 317.06891079450287, 3.9199999999999595, 360.71023718993297, 19.581790579133035, 220.28632803938146, 212.20189407561693, 340.9730006543717, 141.48287641984325, 79.44413321094386, 202.1066882037249, 255.9508213867639, 311.2875668173624, 368.98612666979915, 63.67518627455125, 100.21000000000052, 164.97431032587656, 77.02000000000004, 158.5297183597704, 118.0900000000004], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-39.61939325873517, -67.71411633110631, -178.31675803106913, -545.2084660382042, 116.54313598714623, -39.856472534893015, -59.061385922074365, -548.4355414745536, -12.146446673385897, -11.56992194202105, 9.221702489730504, -55.77856552930599, -19.402206325118748, -3.6298657069199427, 46.53344756494097, 2.0000000000000013, -614.4397771934182, 2.0000000000000013, -27.669134278225712, -48.80845140607673, -23.29541037574321, -4.558200734942435, -74.92063532035365, -31.307656560953497, 12.578473096014527, -51.260371329917334, -23.47777335568765, -37.808910380970744, -67.02585137031535, -474.59577804413703, -28.023317928801024, -29.699694442375282, -162.96495337702265, -273.758262776123, -32.836163000908385, 30.927179037889484, 116.40223334607887, -31.70948624201297, 2.0000000000000013, -76.28857587238956, -8.609717210525751, -1100.523681492802, -8.829194345306723, 106.54079108402087, -314.54559034603324, -52.67142414215603, 2.0000000000000013, -58.23248641190971, -0.30585302745110887, -23.172419245132733, -112.54937223213554, -89.37805204065523, 11.561437448980678, 26.619515645414374, 30.577934008600923, 2.0000000000000013, 83.26886678211889, -21.98172418373945, 78.95584580758236, -50.72562565176667, 29.842361311786544, -40.02216486664315, 114.42342644474198, -28.322687770658337, -30.921733112040123, -131.99143186050986, -16.97570890197317, -7.079497900388375, 153.67761016956788, -66.65071149284933, -13.824424281978109, 18.956571254543398, -16.30670816338506, 76.50913535915942, -8.176310158853855, -44.501663135398054, -207.05751051010535, -282.3689096325111, -42.819293133926784, 105.88871535166025, 153.1274415015816, 4.951535877683041, 7.027645794075005, -7.302807810244891, 24.62768091486834, -122.20467425793063, -347.07548622510905, -0.3796259890318632, -38.26649327517127, -56.63337932279077, -240.9892761139702, -423.4578667830241, -131.90623585948373, -367.678868863752, -23.235075244550664, -225.2925770210919, 38.64283488433562, 13.105509128417316, -64.22881866397596, 93.01009096791879, 2.0000000000000013, 162.7580512872097, -409.05379606892564, -412.4026515976487, -30.325418232338222, -32.56329171257577, -339.3970655477633, -193.52943045985697, 2.0000000000000013, -213.57884637959938, -117.05966477295084, 45.07970148930026, 134.93751843364714, -29.09241726001159, -42.78581198111146, 79.74084458399507, -298.2958359894143, 2.0000000000000013, -167.50908417184692, -7.748867002446595, -42.18631292543725, -119.38678380774245, -319.3180090387711, -135.12983469116548, -131.594157722691, 2.0000000000000013, 97.04000000000053, -532.8103752312886, -145.43185021135548, 91.96330691918192, -172.1718935590031, 2.0000000000000013, -341.919508949744, 2.0000000000000013, -119.7172205714829, -0.11660355394427736, -22.014382460666372, -227.68882683209023, -100.52628269797704, -17.855243352631437, -309.1215165282989, -368.3330030406771, 51.70459618146674, -2.6284355467380696, -79.49365657844427, 158.1005766263103, -84.79133297935404, 34.80879893403455, -533.9204610812332, 2.0000000000000013, 78.11944402998061, 4.257421036838689, -83.73781336708853, -183.18201409299766, -71.7046311055233, -52.1885117573591, -528.5026847710342, -14.267921859144668, -346.17891776488005, -4.796960082089253, -615.9233155425238, -302.7201495528402, -92.95615460858089, -142.35896443256584, -14.294242210285747, -1.7653996050562828, -145.70196354442294, -146.85775640256713, -67.56179094467058, 2.0000000000000013, -155.09256507103336, -46.168769528252525, -447.37039665398305, 67.41986537326724, -304.0875057001289, 163.37, -33.05241286068644, -323.2150230161503, -142.05799401912037, -8.147143137963083, -7.383349451569373, -78.11289912726708, -81.00165621989848, 4.140330680092966, -128.55016663959015, 66.21614620463535, -126.26387076137195, -185.76071640483678, -57.47955719941875, -483.35841684592515, -114.7762846283522, 0.4735773896517667, -15.366404803240325, -150.5329218196298, 2.0000000000000013, -225.54252284766295, -47.21659127761029, -79.36940984283278, -86.39686905291859, -0.30989225560825506], "policy_predator_policy_reward": [60.65687557171689, 142.42078731403325, 608.0436001265799, 85.27271326759427, 76.21465201097328, 61.58170421013841, 451.10468773399907, 450.5623334780185, 13.767658725593874, 19.918822834690992, 27.25868374246405, 175.35856383604266, 21.34220632511905, 5.599865706919901, 0.0, 103.61655243505902, 143.04926390522786, 542.3713454171071, 167.74521413695294, 110.29414183257587, 25.255410375743516, 6.528200734942393, 161.3367255565126, 112.82430774640108, 100.9927035253162, 130.11645863633197, 37.971670619924346, 69.61929090013727, 418.5340832276404, 227.57330341652622, 8.813705871656941, 40.13946412974318, 48.49667272600589, 539.9027359470512, 173.29599409801003, 86.55765227091786, 43.8177666539211, 33.639486242012694, 57.15144202782266, 57.19473408563929, 20.562077336379776, 1100.2272732699078, 50.44347105886461, 39.12057659388283, 285.42359671440664, 303.96577550776385, 51.19008695766353, 53.522598363454364, 106.45713924154354, 52.04113303104025, 166.81928215947983, 273.4841015104811, 86.87974916335477, 128.92824360061647, 71.94213292178534, 90.19449270410415, 20.895219626452985, 174.1633512370296, 108.58673316959992, 72.33901692758134, 104.85280394247268, 121.55768836740143, 62.839946035547236, 48.682380527035036, 237.11854649340273, 287.1115378317141, 116.2236461927733, 56.27209750938331, 57.71380951817805, 64.12728064977375, 111.20029721889146, 89.5034943619151, 146.63810438552272, 150.76997354647492, 36.597617017939065, 26.57258685415168, 361.83558291628776, 201.55821157369542, 48.11543788598827, 59.30216817707138, 131.4656845091982, 97.92743335122793, 79.4293140552458, 120.14910408000834, 49.473843773549575, 241.26029784582792, 106.89164069354767, 305.87834087223195, 66.35337932279043, 39.36557799067577, 180.02337849375172, 476.75794066049, 124.16130834359997, 490.3874217879476, 178.834020480952, 168.1968911262148, 55.77296303245876, 59.15311225904562, 244.745344850935, 28.81338284512212, 23.367576872388348, 13.889774696988809, 599.5696077786056, 274.2616052996197, 45.78599696243798, 170.46748608277008, 242.71051813327674, 502.38415427710765, 254.21623432619995, 227.96334972942884, 208.74397420587545, 215.67610777185482, 72.44969294691742, 72.21688477726725, 100.61256969447021, 20.45239770264581, 334.1421929809978, 381.17767107367087, 198.4437477052321, 80.68021188123139, 169.515384885578, 192.28581906556286, 413.81106784155924, 143.426974122376, 119.43433057020323, 167.0979376691549, 580.5869527969181, 31.637169187432736, 285.1806607730412, 183.46270263509993, 45.154444839342894, 291.47721399729744, 59.013444600450185, 386.8415323733861, 169.98090682558606, 223.6263598494766, 198.56325177123261, 272.3608777406289, 19.78524335263174, 102.35628269797797, 525.2259267156226, 169.37473044923289, 34.38864974902968, 93.86290017185966, 91.07152574772593, 60.769271682067675, 85.26564585148681, 211.5502793064273, 73.80525997724892, 522.2368748303247, 65.43859712716424, 68.45016914930193, 82.06778412671456, 355.8624157013656, 184.36224776295197, 168.4056174941333, 462.5402308136741, 103.17037581650465, 349.1124799605135, 206.97060060800845, 372.5241065672306, 444.8635128881098, 298.5293251542245, 253.8547046814252, 16.234242210285746, 3.745399605056246, 280.6732223682082, 372.59673476871484, 56.11319140519944, 29.03039011860458, 236.81382585759775, 184.7338367810695, 56.55955149142101, 535.5928738649116, 247.46801127598815, 234.2224950785121, 333.0788222436526, 164.6714900530268, 123.24206718293885, 106.40720318508511, 150.08285499114265, 137.5200817914201, 208.92313593579132, 123.88901099077913, 106.1259407476249, 267.49564650469216, 335.3253149669579, 345.6853988690502, 193.56078762736817, 410.952372692527, 172.94266796641816, 41.57003927228223, 192.7026665900148, 138.17097035873218, 41.80655544673506, 258.7559674009278, 15.30802770307061, 269.8076917771429, 4.824068917918039, 199.97269239060876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536867997010649, "mean_inference_ms": 1.3769916301231069, "mean_action_processing_ms": 0.23821839931596445, "mean_env_wait_ms": 0.1811394760110087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038300752639770508, "StateBufferConnector_ms": 0.0030524730682373047, "ViewRequirementAgentConnector_ms": 0.09083783626556396}, "num_episodes": 22, "episode_return_max": 419.02402806525373, "episode_return_min": -101.25584564002308, "episode_return_mean": 165.20338191780468, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 42.31979450981127, "num_env_steps_trained_throughput_per_sec": 42.31979450981127, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 17695.992, "restore_workers_time_ms": 0.013, "training_step_time_ms": 17695.955, "sample_time_ms": 979.284, "learn_time_ms": 16704.694, "learn_throughput": 239.454, "synch_weights_time_ms": 11.198}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "1f15c_00000", "date": "2024-08-16_14-14-34", "timestamp": 1723797874, "time_this_iter_s": 94.52159404754639, "time_total_s": 678.9652471542358, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fe979d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 678.9652471542358, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 35.52307692307692, "ram_util_percent": 73.75384615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.250193939164833, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.552885444075973, "policy_loss": -0.007419944767317877, "vf_loss": 5.5600530124845955, "vf_explained_var": 0.007269685672073768, "kl": 0.010094734111905096, "entropy": 0.7181984905843382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2060723743741475, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.275961771213188, "policy_loss": -0.002671502513451275, "vf_loss": 5.277761052777527, "vf_explained_var": -0.08696029552076229, "kl": 0.0058147608348062445, "entropy": 1.2476658727756884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 419.02402806525373, "episode_reward_min": -101.25584564002308, "episode_reward_mean": 178.38614512670577, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -615.9233155425238, "predator_policy": 3.745399605056246}, "policy_reward_max": {"prey_policy": 163.37, "predator_policy": 599.5696077786056}, "policy_reward_mean": {"prey_policy": -71.4298584749355, "predator_policy": 160.62293103828847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.48019890920782, 135.0200000000002, 238.37595939717005, 253.98894585836626, 194.71455963448997, 256.34571346186203, 209.15597025299672, 216.2306887550176, 197.6230652366652, 361.316919352567, 148.44053689979515, 208.86798884466884, 205.83593855337156, 357.6105051277717, 10.492230577839162, 73.96737434736683, 170.48702828079334, 387.4720952396906, 199.30325611908384, 193.1571482763152, 65.31486935163855, 10.819084715504786, -7.665823742752565, 114.96362540831204, 98.50325934152498, 166.67441930425593, 302.34000000000003, 202.0154028565865, 52.37476541165124, 153.36477310029431, 212.16817640276406, 270.6007376760285, 352.44011869407956, 250.51167889781922, 158.01999999999995, 419.02402806525373, 103.86600841217056, 200.22810721796114, 102.79019823399808, 156.93811051666682, 176.4537467530616, 415.17482011596746, 166.45976527763696, 105.93546802409242, 273.77344254963447, 221.2209202191037, 3.759999999999964, 17.146137595879566, 177.32771055561798, 230.44771747765805, 246.83339111259448, 64.12167372634019, 216.2656313432852, 171.01037236799397, 228.8747223942026, 22.940000000000037, 205.10720272155214, -101.25584564002308, 317.06891079450287, 3.9199999999999595, 360.71023718993297, 19.581790579133035, 220.28632803938146, 212.20189407561693, 340.9730006543717, 141.48287641984325, 79.44413321094386, 202.1066882037249, 255.9508213867639, 311.2875668173624, 368.98612666979915, 63.67518627455125, 100.21000000000052, 164.97431032587656, 77.02000000000004, 158.5297183597704, 118.0900000000004, 48.3499999999994, 53.93223238109429, 205.6513081506409, 217.85068674164148, 160.72618205063378, 10.631098353159011, 115.9535384875914, 343.21, 8.241653322452388, 122.12363266435518, 193.4951641055136, 199.89734838907964, 233.44639196785928, 3.8899999999999606, 317.95495145771406, 280.28121015689385, 233.189025386659, 141.4315731941776, 275.3799999999999, 372.4097964314587, 192.0124535466823, 190.70180449581457, 107.5803328021925], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -58.23248641190971, -0.30585302745110887, -23.172419245132733, -112.54937223213554, -89.37805204065523, 11.561437448980678, 26.619515645414374, 30.577934008600923, 2.0000000000000013, 83.26886678211889, -21.98172418373945, 78.95584580758236, -50.72562565176667, 29.842361311786544, -40.02216486664315, 114.42342644474198, -28.322687770658337, -30.921733112040123, -131.99143186050986, -16.97570890197317, -7.079497900388375, 153.67761016956788, -66.65071149284933, -13.824424281978109, 18.956571254543398, -16.30670816338506, 76.50913535915942, -8.176310158853855, -44.501663135398054, -207.05751051010535, -282.3689096325111, -42.819293133926784, 105.88871535166025, 153.1274415015816, 4.951535877683041, 7.027645794075005, -7.302807810244891, 24.62768091486834, -122.20467425793063, -347.07548622510905, -0.3796259890318632, -38.26649327517127, -56.63337932279077, -240.9892761139702, -423.4578667830241, -131.90623585948373, -367.678868863752, -23.235075244550664, -225.2925770210919, 38.64283488433562, 13.105509128417316, -64.22881866397596, 93.01009096791879, 2.0000000000000013, 162.7580512872097, -409.05379606892564, -412.4026515976487, -30.325418232338222, -32.56329171257577, -339.3970655477633, -193.52943045985697, 2.0000000000000013, -213.57884637959938, -117.05966477295084, 45.07970148930026, 134.93751843364714, -29.09241726001159, -42.78581198111146, 79.74084458399507, -298.2958359894143, 2.0000000000000013, -167.50908417184692, -7.748867002446595, -42.18631292543725, -119.38678380774245, -319.3180090387711, -135.12983469116548, -131.594157722691, 2.0000000000000013, 97.04000000000053, -532.8103752312886, -145.43185021135548, 91.96330691918192, -172.1718935590031, 2.0000000000000013, -341.919508949744, 2.0000000000000013, -119.7172205714829, -0.11660355394427736, -22.014382460666372, -227.68882683209023, -100.52628269797704, -17.855243352631437, -309.1215165282989, -368.3330030406771, 51.70459618146674, -2.6284355467380696, -79.49365657844427, 158.1005766263103, -84.79133297935404, 34.80879893403455, -533.9204610812332, 2.0000000000000013, 78.11944402998061, 4.257421036838689, -83.73781336708853, -183.18201409299766, -71.7046311055233, -52.1885117573591, -528.5026847710342, -14.267921859144668, -346.17891776488005, -4.796960082089253, -615.9233155425238, -302.7201495528402, -92.95615460858089, -142.35896443256584, -14.294242210285747, -1.7653996050562828, -145.70196354442294, -146.85775640256713, -67.56179094467058, 2.0000000000000013, -155.09256507103336, -46.168769528252525, -447.37039665398305, 67.41986537326724, -304.0875057001289, 163.37, -33.05241286068644, -323.2150230161503, -142.05799401912037, -8.147143137963083, -7.383349451569373, -78.11289912726708, -81.00165621989848, 4.140330680092966, -128.55016663959015, 66.21614620463535, -126.26387076137195, -185.76071640483678, -57.47955719941875, -483.35841684592515, -114.7762846283522, 0.4735773896517667, -15.366404803240325, -150.5329218196298, 2.0000000000000013, -225.54252284766295, -47.21659127761029, -79.36940984283278, -86.39686905291859, -0.30989225560825506, -22.59508654674301, 16.83183588689351, -10.979266244842956, -50.77582358227755, -11.777258492868164, 46.39539996343872, -290.97823222001625, 77.53837746218281, 61.111517563267334, 2.0000000000000013, 2.0000000000000013, -8.965715004285359, -183.79053716059573, -132.02896811596676, 113.78151447350714, 123.13593106094041, 2.0000000000000013, -94.13358690826954, -64.89236022299926, -10.002466551772857, -58.862344591294416, -43.61085335714676, -7.829792119590522, -12.386392922879665, -65.41650491138957, -217.85754321536874, -3.9416696884706273, -15.53068038450578, -16.413470553519478, -31.668576276529272, 85.91859081954377, 118.65889722957138, 13.690140831465294, -47.63142134670006, -73.08871185171955, 2.0000000000000013, 87.90099506789693, -19.09899033882005, -18.91600734790222, -135.91057486372864, 113.92881604147095, 2.0000000000000013, -80.70426278744806, 26.85173388473421, -20.53645310228881, -175.47035589467546], "policy_predator_policy_reward": [51.19008695766353, 53.522598363454364, 106.45713924154354, 52.04113303104025, 166.81928215947983, 273.4841015104811, 86.87974916335477, 128.92824360061647, 71.94213292178534, 90.19449270410415, 20.895219626452985, 174.1633512370296, 108.58673316959992, 72.33901692758134, 104.85280394247268, 121.55768836740143, 62.839946035547236, 48.682380527035036, 237.11854649340273, 287.1115378317141, 116.2236461927733, 56.27209750938331, 57.71380951817805, 64.12728064977375, 111.20029721889146, 89.5034943619151, 146.63810438552272, 150.76997354647492, 36.597617017939065, 26.57258685415168, 361.83558291628776, 201.55821157369542, 48.11543788598827, 59.30216817707138, 131.4656845091982, 97.92743335122793, 79.4293140552458, 120.14910408000834, 49.473843773549575, 241.26029784582792, 106.89164069354767, 305.87834087223195, 66.35337932279043, 39.36557799067577, 180.02337849375172, 476.75794066049, 124.16130834359997, 490.3874217879476, 178.834020480952, 168.1968911262148, 55.77296303245876, 59.15311225904562, 244.745344850935, 28.81338284512212, 23.367576872388348, 13.889774696988809, 599.5696077786056, 274.2616052996197, 45.78599696243798, 170.46748608277008, 242.71051813327674, 502.38415427710765, 254.21623432619995, 227.96334972942884, 208.74397420587545, 215.67610777185482, 72.44969294691742, 72.21688477726725, 100.61256969447021, 20.45239770264581, 334.1421929809978, 381.17767107367087, 198.4437477052321, 80.68021188123139, 169.515384885578, 192.28581906556286, 413.81106784155924, 143.426974122376, 119.43433057020323, 167.0979376691549, 580.5869527969181, 31.637169187432736, 285.1806607730412, 183.46270263509993, 45.154444839342894, 291.47721399729744, 59.013444600450185, 386.8415323733861, 169.98090682558606, 223.6263598494766, 198.56325177123261, 272.3608777406289, 19.78524335263174, 102.35628269797797, 525.2259267156226, 169.37473044923289, 34.38864974902968, 93.86290017185966, 91.07152574772593, 60.769271682067675, 85.26564585148681, 211.5502793064273, 73.80525997724892, 522.2368748303247, 65.43859712716424, 68.45016914930193, 82.06778412671456, 355.8624157013656, 184.36224776295197, 168.4056174941333, 462.5402308136741, 103.17037581650465, 349.1124799605135, 206.97060060800845, 372.5241065672306, 444.8635128881098, 298.5293251542245, 253.8547046814252, 16.234242210285746, 3.745399605056246, 280.6732223682082, 372.59673476871484, 56.11319140519944, 29.03039011860458, 236.81382585759775, 184.7338367810695, 56.55955149142101, 535.5928738649116, 247.46801127598815, 234.2224950785121, 333.0788222436526, 164.6714900530268, 123.24206718293885, 106.40720318508511, 150.08285499114265, 137.5200817914201, 208.92313593579132, 123.88901099077913, 106.1259407476249, 267.49564650469216, 335.3253149669579, 345.6853988690502, 193.56078762736817, 410.952372692527, 172.94266796641816, 41.57003927228223, 192.7026665900148, 138.17097035873218, 41.80655544673506, 258.7559674009278, 15.30802770307061, 269.8076917771429, 4.824068917918039, 199.97269239060876, 29.435086546743296, 24.678164113106604, 63.22784949184308, 52.45947271637203, 83.26780593386769, 87.76536074620303, 402.3477894147195, 28.942752084755607, 53.3928807453348, 44.22178374203164, 10.935715004285317, 6.661098353159095, 356.0845377813784, 75.68850598277527, 55.298485526492854, 50.99406893905956, 8.509631260648874, 91.86560897007405, 20.053881716973873, 176.96457772215277, 165.843994650144, 130.12436740381068, 108.06692663402184, 112.04660679752814, 225.00271730869383, 291.71772278592573, 17.450680384505997, 5.911669688470585, 190.96163321067084, 175.0753650770926, 40.60669505436097, 35.097027053418245, 151.9476966212065, 115.18260928068752, 79.07036165075037, 133.4499233951465, 154.82693214473127, 51.75106312619201, 296.33111712067915, 230.90526152241043, 25.862453546682573, 50.22118395852901, 130.42245798276048, 114.13187541576806, 49.53808951983775, 254.04905227931917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527393052501418, "mean_inference_ms": 1.373330884099359, "mean_action_processing_ms": 0.23760441454844272, "mean_env_wait_ms": 0.18105984736473307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.0029687881469726562, "ViewRequirementAgentConnector_ms": 0.08991718292236328}, "num_episodes": 23, "episode_return_max": 419.02402806525373, "episode_return_min": -101.25584564002308, "episode_return_mean": 178.38614512670577, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.8595280328909, "num_env_steps_trained_throughput_per_sec": 452.8595280328909, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 17685.427, "restore_workers_time_ms": 0.013, "training_step_time_ms": 17685.39, "sample_time_ms": 971.074, "learn_time_ms": 16702.153, "learn_throughput": 239.49, "synch_weights_time_ms": 11.381}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "1f15c_00000", "date": "2024-08-16_14-14-43", "timestamp": 1723797883, "time_this_iter_s": 8.836079835891724, "time_total_s": 687.8013269901276, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f880790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 687.8013269901276, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 34.96666666666666, "ram_util_percent": 73.59166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7143781307355437, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4840047018868585, "policy_loss": -0.0026017008510679403, "vf_loss": 5.486397023175759, "vf_explained_var": 0.03250835411763065, "kl": 0.008374573918444131, "entropy": 0.6206523275564587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3168456868835228, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.273860848517645, "policy_loss": -0.0007269817479595384, "vf_loss": 5.273920477761163, "vf_explained_var": -0.3347560902121206, "kl": 0.0044490340212589565, "entropy": 1.272490118483387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 419.02402806525373, "episode_reward_min": -101.25584564002308, "episode_reward_mean": 163.70083142050785, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -615.9233155425238, "predator_policy": 1.7705791166600031}, "policy_reward_max": {"prey_policy": 163.37, "predator_policy": 724.9128732169678}, "policy_reward_mean": {"prey_policy": -83.45541191677381, "predator_policy": 165.30582762702784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.30325611908384, 193.1571482763152, 65.31486935163855, 10.819084715504786, -7.665823742752565, 114.96362540831204, 98.50325934152498, 166.67441930425593, 302.34000000000003, 202.0154028565865, 52.37476541165124, 153.36477310029431, 212.16817640276406, 270.6007376760285, 352.44011869407956, 250.51167889781922, 158.01999999999995, 419.02402806525373, 103.86600841217056, 200.22810721796114, 102.79019823399808, 156.93811051666682, 176.4537467530616, 415.17482011596746, 166.45976527763696, 105.93546802409242, 273.77344254963447, 221.2209202191037, 3.759999999999964, 17.146137595879566, 177.32771055561798, 230.44771747765805, 246.83339111259448, 64.12167372634019, 216.2656313432852, 171.01037236799397, 228.8747223942026, 22.940000000000037, 205.10720272155214, -101.25584564002308, 317.06891079450287, 3.9199999999999595, 360.71023718993297, 19.581790579133035, 220.28632803938146, 212.20189407561693, 340.9730006543717, 141.48287641984325, 79.44413321094386, 202.1066882037249, 255.9508213867639, 311.2875668173624, 368.98612666979915, 63.67518627455125, 100.21000000000052, 164.97431032587656, 77.02000000000004, 158.5297183597704, 118.0900000000004, 48.3499999999994, 53.93223238109429, 205.6513081506409, 217.85068674164148, 160.72618205063378, 10.631098353159011, 115.9535384875914, 343.21, 8.241653322452388, 122.12363266435518, 193.4951641055136, 199.89734838907964, 233.44639196785928, 3.8899999999999606, 317.95495145771406, 280.28121015689385, 233.189025386659, 141.4315731941776, 275.3799999999999, 372.4097964314587, 192.0124535466823, 190.70180449581457, 107.5803328021925, 135.9354508953398, 134.10872243712748, 172.0599999999999, 3.9399999999999595, 13.819151924959051, 3.95999999999996, 65.26910341566355, 212.39152957634576, 206.60177006593636, 230.81803701297548, -10.02547104257918, 156.4395030116862, 202.24418030733676, 217.91602513794857, 121.47855415409475, 46.731001385261386, 124.25063865671272, 167.9561511710334], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [7.027645794075005, -7.302807810244891, 24.62768091486834, -122.20467425793063, -347.07548622510905, -0.3796259890318632, -38.26649327517127, -56.63337932279077, -240.9892761139702, -423.4578667830241, -131.90623585948373, -367.678868863752, -23.235075244550664, -225.2925770210919, 38.64283488433562, 13.105509128417316, -64.22881866397596, 93.01009096791879, 2.0000000000000013, 162.7580512872097, -409.05379606892564, -412.4026515976487, -30.325418232338222, -32.56329171257577, -339.3970655477633, -193.52943045985697, 2.0000000000000013, -213.57884637959938, -117.05966477295084, 45.07970148930026, 134.93751843364714, -29.09241726001159, -42.78581198111146, 79.74084458399507, -298.2958359894143, 2.0000000000000013, -167.50908417184692, -7.748867002446595, -42.18631292543725, -119.38678380774245, -319.3180090387711, -135.12983469116548, -131.594157722691, 2.0000000000000013, 97.04000000000053, -532.8103752312886, -145.43185021135548, 91.96330691918192, -172.1718935590031, 2.0000000000000013, -341.919508949744, 2.0000000000000013, -119.7172205714829, -0.11660355394427736, -22.014382460666372, -227.68882683209023, -100.52628269797704, -17.855243352631437, -309.1215165282989, -368.3330030406771, 51.70459618146674, -2.6284355467380696, -79.49365657844427, 158.1005766263103, -84.79133297935404, 34.80879893403455, -533.9204610812332, 2.0000000000000013, 78.11944402998061, 4.257421036838689, -83.73781336708853, -183.18201409299766, -71.7046311055233, -52.1885117573591, -528.5026847710342, -14.267921859144668, -346.17891776488005, -4.796960082089253, -615.9233155425238, -302.7201495528402, -92.95615460858089, -142.35896443256584, -14.294242210285747, -1.7653996050562828, -145.70196354442294, -146.85775640256713, -67.56179094467058, 2.0000000000000013, -155.09256507103336, -46.168769528252525, -447.37039665398305, 67.41986537326724, -304.0875057001289, 163.37, -33.05241286068644, -323.2150230161503, -142.05799401912037, -8.147143137963083, -7.383349451569373, -78.11289912726708, -81.00165621989848, 4.140330680092966, -128.55016663959015, 66.21614620463535, -126.26387076137195, -185.76071640483678, -57.47955719941875, -483.35841684592515, -114.7762846283522, 0.4735773896517667, -15.366404803240325, -150.5329218196298, 2.0000000000000013, -225.54252284766295, -47.21659127761029, -79.36940984283278, -86.39686905291859, -0.30989225560825506, -22.59508654674301, 16.83183588689351, -10.979266244842956, -50.77582358227755, -11.777258492868164, 46.39539996343872, -290.97823222001625, 77.53837746218281, 61.111517563267334, 2.0000000000000013, 2.0000000000000013, -8.965715004285359, -183.79053716059573, -132.02896811596676, 113.78151447350714, 123.13593106094041, 2.0000000000000013, -94.13358690826954, -64.89236022299926, -10.002466551772857, -58.862344591294416, -43.61085335714676, -7.829792119590522, -12.386392922879665, -65.41650491138957, -217.85754321536874, -3.9416696884706273, -15.53068038450578, -16.413470553519478, -31.668576276529272, 85.91859081954377, 118.65889722957138, 13.690140831465294, -47.63142134670006, -73.08871185171955, 2.0000000000000013, 87.90099506789693, -19.09899033882005, -18.91600734790222, -135.91057486372864, 113.92881604147095, 2.0000000000000013, -80.70426278744806, 26.85173388473421, -20.53645310228881, -175.47035589467546, 2.0000000000000013, 30.31763953509339, -601.362630882591, -226.05890482655545, 128.3984080610636, -18.179374148482022, 0.21942088333999837, -13.03249003910213, 1.3227083130515571, -0.031608099711825655, -3.3190470606258744, -0.3302081460536057, -199.6138487081709, -7.129399745789719, 2.0000000000000013, 11.873639858979242, 2.0000000000000013, 38.33213002082015, -25.072577476503486, -20.22787099388706, -226.28382608678496, -397.97053129893, -42.5757668994643, -22.123457491558483, 4.832300553307126, -224.02428100670528, -14.235723826306144, 43.86395608173793, -363.9796865638953, -128.1905120112505, -10.957366223669196, -25.73287617889173, -197.38074342646965, -210.57296833808897, -50.27339022332828, -42.615692722832684], "policy_predator_policy_reward": [79.4293140552458, 120.14910408000834, 49.473843773549575, 241.26029784582792, 106.89164069354767, 305.87834087223195, 66.35337932279043, 39.36557799067577, 180.02337849375172, 476.75794066049, 124.16130834359997, 490.3874217879476, 178.834020480952, 168.1968911262148, 55.77296303245876, 59.15311225904562, 244.745344850935, 28.81338284512212, 23.367576872388348, 13.889774696988809, 599.5696077786056, 274.2616052996197, 45.78599696243798, 170.46748608277008, 242.71051813327674, 502.38415427710765, 254.21623432619995, 227.96334972942884, 208.74397420587545, 215.67610777185482, 72.44969294691742, 72.21688477726725, 100.61256969447021, 20.45239770264581, 334.1421929809978, 381.17767107367087, 198.4437477052321, 80.68021188123139, 169.515384885578, 192.28581906556286, 413.81106784155924, 143.426974122376, 119.43433057020323, 167.0979376691549, 580.5869527969181, 31.637169187432736, 285.1806607730412, 183.46270263509993, 45.154444839342894, 291.47721399729744, 59.013444600450185, 386.8415323733861, 169.98090682558606, 223.6263598494766, 198.56325177123261, 272.3608777406289, 19.78524335263174, 102.35628269797797, 525.2259267156226, 169.37473044923289, 34.38864974902968, 93.86290017185966, 91.07152574772593, 60.769271682067675, 85.26564585148681, 211.5502793064273, 73.80525997724892, 522.2368748303247, 65.43859712716424, 68.45016914930193, 82.06778412671456, 355.8624157013656, 184.36224776295197, 168.4056174941333, 462.5402308136741, 103.17037581650465, 349.1124799605135, 206.97060060800845, 372.5241065672306, 444.8635128881098, 298.5293251542245, 253.8547046814252, 16.234242210285746, 3.745399605056246, 280.6732223682082, 372.59673476871484, 56.11319140519944, 29.03039011860458, 236.81382585759775, 184.7338367810695, 56.55955149142101, 535.5928738649116, 247.46801127598815, 234.2224950785121, 333.0788222436526, 164.6714900530268, 123.24206718293885, 106.40720318508511, 150.08285499114265, 137.5200817914201, 208.92313593579132, 123.88901099077913, 106.1259407476249, 267.49564650469216, 335.3253149669579, 345.6853988690502, 193.56078762736817, 410.952372692527, 172.94266796641816, 41.57003927228223, 192.7026665900148, 138.17097035873218, 41.80655544673506, 258.7559674009278, 15.30802770307061, 269.8076917771429, 4.824068917918039, 199.97269239060876, 29.435086546743296, 24.678164113106604, 63.22784949184308, 52.45947271637203, 83.26780593386769, 87.76536074620303, 402.3477894147195, 28.942752084755607, 53.3928807453348, 44.22178374203164, 10.935715004285317, 6.661098353159095, 356.0845377813784, 75.68850598277527, 55.298485526492854, 50.99406893905956, 8.509631260648874, 91.86560897007405, 20.053881716973873, 176.96457772215277, 165.843994650144, 130.12436740381068, 108.06692663402184, 112.04660679752814, 225.00271730869383, 291.71772278592573, 17.450680384505997, 5.911669688470585, 190.96163321067084, 175.0753650770926, 40.60669505436097, 35.097027053418245, 151.9476966212065, 115.18260928068752, 79.07036165075037, 133.4499233951465, 154.82693214473127, 51.75106312619201, 296.33111712067915, 230.90526152241043, 25.862453546682573, 50.22118395852901, 130.42245798276048, 114.13187541576806, 49.53808951983775, 254.04905227931917, 40.125664637939636, 63.49214672230656, 724.9128732169678, 236.61738492930644, 27.853324239273352, 33.98764184814535, 1.7705791166600031, 14.982490039102089, 10.506443611907578, 2.021608099711827, 5.289047060625832, 2.3202081460536004, 30.46912847054688, 241.54322339907654, 101.93488478550395, 96.58300493186346, 55.15719601086268, 111.11244403425414, 142.55125102833864, 133.56723445502823, 520.4584184150085, 93.77046792812747, 144.59200852662133, 76.54671887608717, 92.12408588726011, 329.3120748734749, 106.78935174498534, 81.49844113753237, 127.28503151214431, 486.36372121709644, 48.90937344656942, 34.51187034125384, 302.74312339947414, 229.46122702179684, 195.40755276229785, 65.43768135489611]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5515907687299818, "mean_inference_ms": 1.371528227968382, "mean_action_processing_ms": 0.23712503109973362, "mean_env_wait_ms": 0.18041811114391712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003669142723083496, "StateBufferConnector_ms": 0.002969026565551758, "ViewRequirementAgentConnector_ms": 0.08993494510650635}, "num_episodes": 18, "episode_return_max": 419.02402806525373, "episode_return_min": -101.25584564002308, "episode_return_mean": 163.70083142050785, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.5316458755487, "num_env_steps_trained_throughput_per_sec": 449.5316458755487, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 17652.704, "restore_workers_time_ms": 0.013, "training_step_time_ms": 17652.667, "sample_time_ms": 965.527, "learn_time_ms": 16674.948, "learn_throughput": 239.881, "synch_weights_time_ms": 11.439}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "1f15c_00000", "date": "2024-08-16_14-14-52", "timestamp": 1723797892, "time_this_iter_s": 8.901743173599243, "time_total_s": 696.7030701637268, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f880ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 696.7030701637268, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 31.123076923076926, "ram_util_percent": 73.66153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3031548993297353, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.478875973111108, "policy_loss": -0.005688308843992966, "vf_loss": 5.484316509236734, "vf_explained_var": 0.018716392945990992, "kl": 0.00991138030447632, "entropy": 0.5417532981861205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.30585822538724, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.404974058570055, "policy_loss": -0.0014456325298096374, "vf_loss": 5.405785431306829, "vf_explained_var": -0.28246594336297776, "kl": 0.0084564979647607, "entropy": 1.2624714424370458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 821.0088439341841, "episode_reward_min": -101.25584564002308, "episode_reward_mean": 174.88259095286492, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1193.6670503023872, "predator_policy": 1.7705791166600031}, "policy_reward_max": {"prey_policy": 168.9093706478995, "predator_policy": 1046.294093109694}, "policy_reward_mean": {"prey_policy": -80.7132377963906, "predator_policy": 168.1545332728232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.86600841217056, 200.22810721796114, 102.79019823399808, 156.93811051666682, 176.4537467530616, 415.17482011596746, 166.45976527763696, 105.93546802409242, 273.77344254963447, 221.2209202191037, 3.759999999999964, 17.146137595879566, 177.32771055561798, 230.44771747765805, 246.83339111259448, 64.12167372634019, 216.2656313432852, 171.01037236799397, 228.8747223942026, 22.940000000000037, 205.10720272155214, -101.25584564002308, 317.06891079450287, 3.9199999999999595, 360.71023718993297, 19.581790579133035, 220.28632803938146, 212.20189407561693, 340.9730006543717, 141.48287641984325, 79.44413321094386, 202.1066882037249, 255.9508213867639, 311.2875668173624, 368.98612666979915, 63.67518627455125, 100.21000000000052, 164.97431032587656, 77.02000000000004, 158.5297183597704, 118.0900000000004, 48.3499999999994, 53.93223238109429, 205.6513081506409, 217.85068674164148, 160.72618205063378, 10.631098353159011, 115.9535384875914, 343.21, 8.241653322452388, 122.12363266435518, 193.4951641055136, 199.89734838907964, 233.44639196785928, 3.8899999999999606, 317.95495145771406, 280.28121015689385, 233.189025386659, 141.4315731941776, 275.3799999999999, 372.4097964314587, 192.0124535466823, 190.70180449581457, 107.5803328021925, 135.9354508953398, 134.10872243712748, 172.0599999999999, 3.9399999999999595, 13.819151924959051, 3.95999999999996, 65.26910341566355, 212.39152957634576, 206.60177006593636, 230.81803701297548, -10.02547104257918, 156.4395030116862, 202.24418030733676, 217.91602513794857, 121.47855415409475, 46.731001385261386, 124.25063865671272, 167.9561511710334, 324.9643654126313, 243.7953305266696, 267.07360840192746, 374.9626653118107, 414.75317241940604, 26.423018642436872, 157.67596197695974, 104.5000000000003, 138.324613268131, 303.11255263854423, 247.73167968684544, 821.0088439341841, 345.6038882902556, 163.95000000000005, -12.584046623122155, 146.78821756713202, 92.62622649025506, 171.3953751700042], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-167.50908417184692, -7.748867002446595, -42.18631292543725, -119.38678380774245, -319.3180090387711, -135.12983469116548, -131.594157722691, 2.0000000000000013, 97.04000000000053, -532.8103752312886, -145.43185021135548, 91.96330691918192, -172.1718935590031, 2.0000000000000013, -341.919508949744, 2.0000000000000013, -119.7172205714829, -0.11660355394427736, -22.014382460666372, -227.68882683209023, -100.52628269797704, -17.855243352631437, -309.1215165282989, -368.3330030406771, 51.70459618146674, -2.6284355467380696, -79.49365657844427, 158.1005766263103, -84.79133297935404, 34.80879893403455, -533.9204610812332, 2.0000000000000013, 78.11944402998061, 4.257421036838689, -83.73781336708853, -183.18201409299766, -71.7046311055233, -52.1885117573591, -528.5026847710342, -14.267921859144668, -346.17891776488005, -4.796960082089253, -615.9233155425238, -302.7201495528402, -92.95615460858089, -142.35896443256584, -14.294242210285747, -1.7653996050562828, -145.70196354442294, -146.85775640256713, -67.56179094467058, 2.0000000000000013, -155.09256507103336, -46.168769528252525, -447.37039665398305, 67.41986537326724, -304.0875057001289, 163.37, -33.05241286068644, -323.2150230161503, -142.05799401912037, -8.147143137963083, -7.383349451569373, -78.11289912726708, -81.00165621989848, 4.140330680092966, -128.55016663959015, 66.21614620463535, -126.26387076137195, -185.76071640483678, -57.47955719941875, -483.35841684592515, -114.7762846283522, 0.4735773896517667, -15.366404803240325, -150.5329218196298, 2.0000000000000013, -225.54252284766295, -47.21659127761029, -79.36940984283278, -86.39686905291859, -0.30989225560825506, -22.59508654674301, 16.83183588689351, -10.979266244842956, -50.77582358227755, -11.777258492868164, 46.39539996343872, -290.97823222001625, 77.53837746218281, 61.111517563267334, 2.0000000000000013, 2.0000000000000013, -8.965715004285359, -183.79053716059573, -132.02896811596676, 113.78151447350714, 123.13593106094041, 2.0000000000000013, -94.13358690826954, -64.89236022299926, -10.002466551772857, -58.862344591294416, -43.61085335714676, -7.829792119590522, -12.386392922879665, -65.41650491138957, -217.85754321536874, -3.9416696884706273, -15.53068038450578, -16.413470553519478, -31.668576276529272, 85.91859081954377, 118.65889722957138, 13.690140831465294, -47.63142134670006, -73.08871185171955, 2.0000000000000013, 87.90099506789693, -19.09899033882005, -18.91600734790222, -135.91057486372864, 113.92881604147095, 2.0000000000000013, -80.70426278744806, 26.85173388473421, -20.53645310228881, -175.47035589467546, 2.0000000000000013, 30.31763953509339, -601.362630882591, -226.05890482655545, 128.3984080610636, -18.179374148482022, 0.21942088333999837, -13.03249003910213, 1.3227083130515571, -0.031608099711825655, -3.3190470606258744, -0.3302081460536057, -199.6138487081709, -7.129399745789719, 2.0000000000000013, 11.873639858979242, 2.0000000000000013, 38.33213002082015, -25.072577476503486, -20.22787099388706, -226.28382608678496, -397.97053129893, -42.5757668994643, -22.123457491558483, 4.832300553307126, -224.02428100670528, -14.235723826306144, 43.86395608173793, -363.9796865638953, -128.1905120112505, -10.957366223669196, -25.73287617889173, -197.38074342646965, -210.57296833808897, -50.27339022332828, -42.615692722832684, -410.10999156850806, 2.0000000000000013, 36.17248519835508, -26.815313457040457, -72.98818740246853, 101.7743378113864, 88.07053646063703, -143.64488871185523, 73.90018169063174, -99.35811731716868, -45.05715676680525, 2.0000000000000013, 2.0000000000000013, 57.939411774361375, -1.33449656696505, 8.12860730493846, -32.41987765050617, -47.03381972700152, 73.54205918098685, -147.1889572880172, -142.93765436902984, -36.85947006839489, -1193.6670503023872, -25.956190294486923, 168.9093706478995, 59.25396793004622, 94.32690704791297, -42.4264008504887, -194.0997487730442, -281.7488180966035, -134.55647968473076, -343.50186292142746, -197.54417652238936, -28.424883327255557, -71.1366315843562, -62.57840566813954], "policy_predator_policy_reward": [198.4437477052321, 80.68021188123139, 169.515384885578, 192.28581906556286, 413.81106784155924, 143.426974122376, 119.43433057020323, 167.0979376691549, 580.5869527969181, 31.637169187432736, 285.1806607730412, 183.46270263509993, 45.154444839342894, 291.47721399729744, 59.013444600450185, 386.8415323733861, 169.98090682558606, 223.6263598494766, 198.56325177123261, 272.3608777406289, 19.78524335263174, 102.35628269797797, 525.2259267156226, 169.37473044923289, 34.38864974902968, 93.86290017185966, 91.07152574772593, 60.769271682067675, 85.26564585148681, 211.5502793064273, 73.80525997724892, 522.2368748303247, 65.43859712716424, 68.45016914930193, 82.06778412671456, 355.8624157013656, 184.36224776295197, 168.4056174941333, 462.5402308136741, 103.17037581650465, 349.1124799605135, 206.97060060800845, 372.5241065672306, 444.8635128881098, 298.5293251542245, 253.8547046814252, 16.234242210285746, 3.745399605056246, 280.6732223682082, 372.59673476871484, 56.11319140519944, 29.03039011860458, 236.81382585759775, 184.7338367810695, 56.55955149142101, 535.5928738649116, 247.46801127598815, 234.2224950785121, 333.0788222436526, 164.6714900530268, 123.24206718293885, 106.40720318508511, 150.08285499114265, 137.5200817914201, 208.92313593579132, 123.88901099077913, 106.1259407476249, 267.49564650469216, 335.3253149669579, 345.6853988690502, 193.56078762736817, 410.952372692527, 172.94266796641816, 41.57003927228223, 192.7026665900148, 138.17097035873218, 41.80655544673506, 258.7559674009278, 15.30802770307061, 269.8076917771429, 4.824068917918039, 199.97269239060876, 29.435086546743296, 24.678164113106604, 63.22784949184308, 52.45947271637203, 83.26780593386769, 87.76536074620303, 402.3477894147195, 28.942752084755607, 53.3928807453348, 44.22178374203164, 10.935715004285317, 6.661098353159095, 356.0845377813784, 75.68850598277527, 55.298485526492854, 50.99406893905956, 8.509631260648874, 91.86560897007405, 20.053881716973873, 176.96457772215277, 165.843994650144, 130.12436740381068, 108.06692663402184, 112.04660679752814, 225.00271730869383, 291.71772278592573, 17.450680384505997, 5.911669688470585, 190.96163321067084, 175.0753650770926, 40.60669505436097, 35.097027053418245, 151.9476966212065, 115.18260928068752, 79.07036165075037, 133.4499233951465, 154.82693214473127, 51.75106312619201, 296.33111712067915, 230.90526152241043, 25.862453546682573, 50.22118395852901, 130.42245798276048, 114.13187541576806, 49.53808951983775, 254.04905227931917, 40.125664637939636, 63.49214672230656, 724.9128732169678, 236.61738492930644, 27.853324239273352, 33.98764184814535, 1.7705791166600031, 14.982490039102089, 10.506443611907578, 2.021608099711827, 5.289047060625832, 2.3202081460536004, 30.46912847054688, 241.54322339907654, 101.93488478550395, 96.58300493186346, 55.15719601086268, 111.11244403425414, 142.55125102833864, 133.56723445502823, 520.4584184150085, 93.77046792812747, 144.59200852662133, 76.54671887608717, 92.12408588726011, 329.3120748734749, 106.78935174498534, 81.49844113753237, 127.28503151214431, 486.36372121709644, 48.90937344656942, 34.51187034125384, 302.74312339947414, 229.46122702179684, 195.40755276229785, 65.43768135489611, 269.9741879876014, 463.1001689935393, 103.976818722322, 130.4613400630343, 85.71811897697012, 152.56933901604046, 253.47150192321024, 177.06551563981887, 220.7136167119643, 219.49749133397899, 32.4265540771327, 37.05362133210844, 50.746516684825906, 46.99003351777233, 27.999459520815314, 69.70642974121131, 97.85141237452476, 119.9268982711133, 141.76189061301605, 234.99756013255873, 211.99891743180712, 215.52988669246278, 1046.294093109694, 994.3379914213643, 33.91787984655385, 83.52266986575606, 108.43001891511695, 3.6194748874584186, 203.91568166113103, 259.34883858539433, 435.9191870802606, 188.92737309302942, 173.10290120872725, 145.49238513117263, 30.443123780582894, 274.6672886419169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5505323478523421, "mean_inference_ms": 1.3686935583840987, "mean_action_processing_ms": 0.23659945504537183, "mean_env_wait_ms": 0.18004280158524544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003278374671936035, "StateBufferConnector_ms": 0.0028754472732543945, "ViewRequirementAgentConnector_ms": 0.08799707889556885}, "num_episodes": 18, "episode_return_max": 821.0088439341841, "episode_return_min": -101.25584564002308, "episode_return_mean": 174.88259095286492, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.72104364125477, "num_env_steps_trained_throughput_per_sec": 450.72104364125477, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 17622.418, "restore_workers_time_ms": 0.013, "training_step_time_ms": 17622.382, "sample_time_ms": 966.162, "learn_time_ms": 16644.214, "learn_throughput": 240.324, "synch_weights_time_ms": 11.248}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "1f15c_00000", "date": "2024-08-16_14-15-01", "timestamp": 1723797901, "time_this_iter_s": 8.87799596786499, "time_total_s": 705.5810661315918, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f880f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 705.5810661315918, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 33.91666666666667, "ram_util_percent": 73.57499999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8524419884833079, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.837951040520239, "policy_loss": -0.00494152208711341, "vf_loss": 6.842735288508986, "vf_explained_var": 0.02092881823973681, "kl": 0.006290493731454724, "entropy": 0.5989611905245554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.037015231702694, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.065544468259055, "policy_loss": -0.006285190129179567, "vf_loss": 6.070522827319998, "vf_explained_var": -0.5583346214243975, "kl": 0.017424246231453337, "entropy": 1.2565328415739474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 821.0088439341841, "episode_reward_min": -111.86620458402355, "episode_reward_mean": 169.35848114312034, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1193.6670503023872, "predator_policy": 1.7705791166600031}, "policy_reward_max": {"prey_policy": 168.9093706478995, "predator_policy": 1046.294093109694}, "policy_reward_mean": {"prey_policy": -72.4199431669516, "predator_policy": 157.09918373851187}, "custom_metrics": {}, "hist_stats": {"episode_reward": [317.06891079450287, 3.9199999999999595, 360.71023718993297, 19.581790579133035, 220.28632803938146, 212.20189407561693, 340.9730006543717, 141.48287641984325, 79.44413321094386, 202.1066882037249, 255.9508213867639, 311.2875668173624, 368.98612666979915, 63.67518627455125, 100.21000000000052, 164.97431032587656, 77.02000000000004, 158.5297183597704, 118.0900000000004, 48.3499999999994, 53.93223238109429, 205.6513081506409, 217.85068674164148, 160.72618205063378, 10.631098353159011, 115.9535384875914, 343.21, 8.241653322452388, 122.12363266435518, 193.4951641055136, 199.89734838907964, 233.44639196785928, 3.8899999999999606, 317.95495145771406, 280.28121015689385, 233.189025386659, 141.4315731941776, 275.3799999999999, 372.4097964314587, 192.0124535466823, 190.70180449581457, 107.5803328021925, 135.9354508953398, 134.10872243712748, 172.0599999999999, 3.9399999999999595, 13.819151924959051, 3.95999999999996, 65.26910341566355, 212.39152957634576, 206.60177006593636, 230.81803701297548, -10.02547104257918, 156.4395030116862, 202.24418030733676, 217.91602513794857, 121.47855415409475, 46.731001385261386, 124.25063865671272, 167.9561511710334, 324.9643654126313, 243.7953305266696, 267.07360840192746, 374.9626653118107, 414.75317241940604, 26.423018642436872, 157.67596197695974, 104.5000000000003, 138.324613268131, 303.11255263854423, 247.73167968684544, 821.0088439341841, 345.6038882902556, 163.95000000000005, -12.584046623122155, 146.78821756713202, 92.62622649025506, 171.3953751700042, 20.30265207737182, -111.86620458402355, 91.98000000000026, 14.549999999999926, 116.19328657146607, 173.22201364690517, 24.20857654572772, 173.92989756404526, 340.5108803823764, 33.82355674212322, 146.77160139029962, 201.31116424688204, 251.60082053724273, 17.058058283896855, -34.102813546707274, 185.93297938499137, 189.13999999999965, 330.8947530588658, 225.02109905323826, 239.49495485492085, -2.658566117921761, 225.68960990923284], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-92.95615460858089, -142.35896443256584, -14.294242210285747, -1.7653996050562828, -145.70196354442294, -146.85775640256713, -67.56179094467058, 2.0000000000000013, -155.09256507103336, -46.168769528252525, -447.37039665398305, 67.41986537326724, -304.0875057001289, 163.37, -33.05241286068644, -323.2150230161503, -142.05799401912037, -8.147143137963083, -7.383349451569373, -78.11289912726708, -81.00165621989848, 4.140330680092966, -128.55016663959015, 66.21614620463535, -126.26387076137195, -185.76071640483678, -57.47955719941875, -483.35841684592515, -114.7762846283522, 0.4735773896517667, -15.366404803240325, -150.5329218196298, 2.0000000000000013, -225.54252284766295, -47.21659127761029, -79.36940984283278, -86.39686905291859, -0.30989225560825506, -22.59508654674301, 16.83183588689351, -10.979266244842956, -50.77582358227755, -11.777258492868164, 46.39539996343872, -290.97823222001625, 77.53837746218281, 61.111517563267334, 2.0000000000000013, 2.0000000000000013, -8.965715004285359, -183.79053716059573, -132.02896811596676, 113.78151447350714, 123.13593106094041, 2.0000000000000013, -94.13358690826954, -64.89236022299926, -10.002466551772857, -58.862344591294416, -43.61085335714676, -7.829792119590522, -12.386392922879665, -65.41650491138957, -217.85754321536874, -3.9416696884706273, -15.53068038450578, -16.413470553519478, -31.668576276529272, 85.91859081954377, 118.65889722957138, 13.690140831465294, -47.63142134670006, -73.08871185171955, 2.0000000000000013, 87.90099506789693, -19.09899033882005, -18.91600734790222, -135.91057486372864, 113.92881604147095, 2.0000000000000013, -80.70426278744806, 26.85173388473421, -20.53645310228881, -175.47035589467546, 2.0000000000000013, 30.31763953509339, -601.362630882591, -226.05890482655545, 128.3984080610636, -18.179374148482022, 0.21942088333999837, -13.03249003910213, 1.3227083130515571, -0.031608099711825655, -3.3190470606258744, -0.3302081460536057, -199.6138487081709, -7.129399745789719, 2.0000000000000013, 11.873639858979242, 2.0000000000000013, 38.33213002082015, -25.072577476503486, -20.22787099388706, -226.28382608678496, -397.97053129893, -42.5757668994643, -22.123457491558483, 4.832300553307126, -224.02428100670528, -14.235723826306144, 43.86395608173793, -363.9796865638953, -128.1905120112505, -10.957366223669196, -25.73287617889173, -197.38074342646965, -210.57296833808897, -50.27339022332828, -42.615692722832684, -410.10999156850806, 2.0000000000000013, 36.17248519835508, -26.815313457040457, -72.98818740246853, 101.7743378113864, 88.07053646063703, -143.64488871185523, 73.90018169063174, -99.35811731716868, -45.05715676680525, 2.0000000000000013, 2.0000000000000013, 57.939411774361375, -1.33449656696505, 8.12860730493846, -32.41987765050617, -47.03381972700152, 73.54205918098685, -147.1889572880172, -142.93765436902984, -36.85947006839489, -1193.6670503023872, -25.956190294486923, 168.9093706478995, 59.25396793004622, 94.32690704791297, -42.4264008504887, -194.0997487730442, -281.7488180966035, -134.55647968473076, -343.50186292142746, -197.54417652238936, -28.424883327255557, -71.1366315843562, -62.57840566813954, -776.6917950245886, -14.785898456168834, -281.3814558238036, -456.42337588110985, -156.66169331960225, -4.948719684656627, -60.37331405467958, -51.63580168305712, -398.0541537338649, -123.66702672293492, -8.159227946633179, -100.26423287655084, -28.073301789192083, 19.820000000000285, 2.0000000000000013, -23.46327411396424, 2.0000000000000013, -121.227770936311, 2.0000000000000013, -78.05906785892628, 38.20981953853222, -45.41836615148556, -31.106157234408688, -69.83699184840093, 61.99870215040644, -9.741562951281736, -246.6592083511629, -239.00482949558076, -51.10801182786034, -61.955858208114435, -69.18105691523475, -86.70526617931388, 62.15387828745238, -242.36422410199657, 58.35721269921223, -107.7852068756894, -37.39848449886328, -46.66110389033136, -27.871933831153566, 43.70536267632708, -29.88269388174355, -55.29174931283422, -54.47583365479544, -95.88981905053053], "policy_predator_policy_reward": [298.5293251542245, 253.8547046814252, 16.234242210285746, 3.745399605056246, 280.6732223682082, 372.59673476871484, 56.11319140519944, 29.03039011860458, 236.81382585759775, 184.7338367810695, 56.55955149142101, 535.5928738649116, 247.46801127598815, 234.2224950785121, 333.0788222436526, 164.6714900530268, 123.24206718293885, 106.40720318508511, 150.08285499114265, 137.5200817914201, 208.92313593579132, 123.88901099077913, 106.1259407476249, 267.49564650469216, 335.3253149669579, 345.6853988690502, 193.56078762736817, 410.952372692527, 172.94266796641816, 41.57003927228223, 192.7026665900148, 138.17097035873218, 41.80655544673506, 258.7559674009278, 15.30802770307061, 269.8076917771429, 4.824068917918039, 199.97269239060876, 29.435086546743296, 24.678164113106604, 63.22784949184308, 52.45947271637203, 83.26780593386769, 87.76536074620303, 402.3477894147195, 28.942752084755607, 53.3928807453348, 44.22178374203164, 10.935715004285317, 6.661098353159095, 356.0845377813784, 75.68850598277527, 55.298485526492854, 50.99406893905956, 8.509631260648874, 91.86560897007405, 20.053881716973873, 176.96457772215277, 165.843994650144, 130.12436740381068, 108.06692663402184, 112.04660679752814, 225.00271730869383, 291.71772278592573, 17.450680384505997, 5.911669688470585, 190.96163321067084, 175.0753650770926, 40.60669505436097, 35.097027053418245, 151.9476966212065, 115.18260928068752, 79.07036165075037, 133.4499233951465, 154.82693214473127, 51.75106312619201, 296.33111712067915, 230.90526152241043, 25.862453546682573, 50.22118395852901, 130.42245798276048, 114.13187541576806, 49.53808951983775, 254.04905227931917, 40.125664637939636, 63.49214672230656, 724.9128732169678, 236.61738492930644, 27.853324239273352, 33.98764184814535, 1.7705791166600031, 14.982490039102089, 10.506443611907578, 2.021608099711827, 5.289047060625832, 2.3202081460536004, 30.46912847054688, 241.54322339907654, 101.93488478550395, 96.58300493186346, 55.15719601086268, 111.11244403425414, 142.55125102833864, 133.56723445502823, 520.4584184150085, 93.77046792812747, 144.59200852662133, 76.54671887608717, 92.12408588726011, 329.3120748734749, 106.78935174498534, 81.49844113753237, 127.28503151214431, 486.36372121709644, 48.90937344656942, 34.51187034125384, 302.74312339947414, 229.46122702179684, 195.40755276229785, 65.43768135489611, 269.9741879876014, 463.1001689935393, 103.976818722322, 130.4613400630343, 85.71811897697012, 152.56933901604046, 253.47150192321024, 177.06551563981887, 220.7136167119643, 219.49749133397899, 32.4265540771327, 37.05362133210844, 50.746516684825906, 46.99003351777233, 27.999459520815314, 69.70642974121131, 97.85141237452476, 119.9268982711133, 141.76189061301605, 234.99756013255873, 211.99891743180712, 215.52988669246278, 1046.294093109694, 994.3379914213643, 33.91787984655385, 83.52266986575606, 108.43001891511695, 3.6194748874584186, 203.91568166113103, 259.34883858539433, 435.9191870802606, 188.92737309302942, 173.10290120872725, 145.49238513117263, 30.443123780582894, 274.6672886419169, 57.11651586971046, 754.6638296884191, 477.4063148098736, 148.53231231101597, 3.527667302204648, 250.06274570205406, 92.93473271287131, 33.624383024864684, 233.1166677982299, 404.79779923003576, 139.01100042398076, 142.6344740461104, 2.4385765457271456, 30.023301789192388, 57.51873580156089, 137.87443587644884, 253.06580073478654, 206.67285058390218, 53.67766797704727, 56.20495662400326, 99.73461513987849, 54.24553286337405, 93.16265976753455, 209.0916535621568, 165.52918587678005, 33.814495461338204, 120.20504201837316, 382.5170541122675, 70.82461341191905, 8.136443077348476, 143.77696690580783, 198.0423355737321, 353.37636575638663, 15.973980058157371, 188.73785752316698, 191.58488971217605, 146.95282462058276, 162.12786282185027, 131.2464725250718, 92.41505348467615, 23.07659604053283, 59.43928103612318, 184.15187885321706, 191.90338376134315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5494094366169189, "mean_inference_ms": 1.3654735709848875, "mean_action_processing_ms": 0.2356754773982341, "mean_env_wait_ms": 0.17953180257349602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032738447189331055, "StateBufferConnector_ms": 0.002814173698425293, "ViewRequirementAgentConnector_ms": 0.08347666263580322}, "num_episodes": 22, "episode_return_max": 821.0088439341841, "episode_return_min": -111.86620458402355, "episode_return_mean": 169.35848114312034, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.9867170385833, "num_env_steps_trained_throughput_per_sec": 442.9867170385833, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 17613.711, "restore_workers_time_ms": 0.013, "training_step_time_ms": 17613.675, "sample_time_ms": 972.462, "learn_time_ms": 16629.173, "learn_throughput": 240.541, "synch_weights_time_ms": 11.284}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "1f15c_00000", "date": "2024-08-16_14-15-10", "timestamp": 1723797910, "time_this_iter_s": 9.033422231674194, "time_total_s": 714.614488363266, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8e25e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 714.614488363266, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.515384615384615, "ram_util_percent": 73.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4494866867702474, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.737035668463934, "policy_loss": -0.004292260931445059, "vf_loss": 3.7411175809840045, "vf_explained_var": 0.02238564166442427, "kl": 0.008413746136151777, "entropy": 0.6673374948678193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.303200806921752, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.427056526885462, "policy_loss": -0.0019107349766369062, "vf_loss": 4.428314374615907, "vf_explained_var": -0.41335162258652786, "kl": 0.008705008325493913, "entropy": 1.2338810448293334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 821.0088439341841, "episode_reward_min": -111.86620458402355, "episode_reward_mean": 154.6118988939485, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1193.6670503023872, "predator_policy": 1.7705791166600031}, "policy_reward_max": {"prey_policy": 168.9093706478995, "predator_policy": 1059.2083946001574}, "policy_reward_mean": {"prey_policy": -76.8673696071034, "predator_policy": 154.17331905407772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.0900000000004, 48.3499999999994, 53.93223238109429, 205.6513081506409, 217.85068674164148, 160.72618205063378, 10.631098353159011, 115.9535384875914, 343.21, 8.241653322452388, 122.12363266435518, 193.4951641055136, 199.89734838907964, 233.44639196785928, 3.8899999999999606, 317.95495145771406, 280.28121015689385, 233.189025386659, 141.4315731941776, 275.3799999999999, 372.4097964314587, 192.0124535466823, 190.70180449581457, 107.5803328021925, 135.9354508953398, 134.10872243712748, 172.0599999999999, 3.9399999999999595, 13.819151924959051, 3.95999999999996, 65.26910341566355, 212.39152957634576, 206.60177006593636, 230.81803701297548, -10.02547104257918, 156.4395030116862, 202.24418030733676, 217.91602513794857, 121.47855415409475, 46.731001385261386, 124.25063865671272, 167.9561511710334, 324.9643654126313, 243.7953305266696, 267.07360840192746, 374.9626653118107, 414.75317241940604, 26.423018642436872, 157.67596197695974, 104.5000000000003, 138.324613268131, 303.11255263854423, 247.73167968684544, 821.0088439341841, 345.6038882902556, 163.95000000000005, -12.584046623122155, 146.78821756713202, 92.62622649025506, 171.3953751700042, 20.30265207737182, -111.86620458402355, 91.98000000000026, 14.549999999999926, 116.19328657146607, 173.22201364690517, 24.20857654572772, 173.92989756404526, 340.5108803823764, 33.82355674212322, 146.77160139029962, 201.31116424688204, 251.60082053724273, 17.058058283896855, -34.102813546707274, 185.93297938499137, 189.13999999999965, 330.8947530588658, 225.02109905323826, 239.49495485492085, -2.658566117921761, 225.68960990923284, 6.132317325050886, 154.720657674357, -69.38743398181391, 0.02907646844844753, 240.13253038744944, 19.834325360791702, 14.680264282081259, 3.9399999999999595, 205.87061432036188, 483.3192477117243, 67.879362421096, 173.9699999999999, 130.2361842001706, 163.90551184337397, 138.94274538102982, 117.49000000000026, 93.43373986248706, -21.377779172216282], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-86.39686905291859, -0.30989225560825506, -22.59508654674301, 16.83183588689351, -10.979266244842956, -50.77582358227755, -11.777258492868164, 46.39539996343872, -290.97823222001625, 77.53837746218281, 61.111517563267334, 2.0000000000000013, 2.0000000000000013, -8.965715004285359, -183.79053716059573, -132.02896811596676, 113.78151447350714, 123.13593106094041, 2.0000000000000013, -94.13358690826954, -64.89236022299926, -10.002466551772857, -58.862344591294416, -43.61085335714676, -7.829792119590522, -12.386392922879665, -65.41650491138957, -217.85754321536874, -3.9416696884706273, -15.53068038450578, -16.413470553519478, -31.668576276529272, 85.91859081954377, 118.65889722957138, 13.690140831465294, -47.63142134670006, -73.08871185171955, 2.0000000000000013, 87.90099506789693, -19.09899033882005, -18.91600734790222, -135.91057486372864, 113.92881604147095, 2.0000000000000013, -80.70426278744806, 26.85173388473421, -20.53645310228881, -175.47035589467546, 2.0000000000000013, 30.31763953509339, -601.362630882591, -226.05890482655545, 128.3984080610636, -18.179374148482022, 0.21942088333999837, -13.03249003910213, 1.3227083130515571, -0.031608099711825655, -3.3190470606258744, -0.3302081460536057, -199.6138487081709, -7.129399745789719, 2.0000000000000013, 11.873639858979242, 2.0000000000000013, 38.33213002082015, -25.072577476503486, -20.22787099388706, -226.28382608678496, -397.97053129893, -42.5757668994643, -22.123457491558483, 4.832300553307126, -224.02428100670528, -14.235723826306144, 43.86395608173793, -363.9796865638953, -128.1905120112505, -10.957366223669196, -25.73287617889173, -197.38074342646965, -210.57296833808897, -50.27339022332828, -42.615692722832684, -410.10999156850806, 2.0000000000000013, 36.17248519835508, -26.815313457040457, -72.98818740246853, 101.7743378113864, 88.07053646063703, -143.64488871185523, 73.90018169063174, -99.35811731716868, -45.05715676680525, 2.0000000000000013, 2.0000000000000013, 57.939411774361375, -1.33449656696505, 8.12860730493846, -32.41987765050617, -47.03381972700152, 73.54205918098685, -147.1889572880172, -142.93765436902984, -36.85947006839489, -1193.6670503023872, -25.956190294486923, 168.9093706478995, 59.25396793004622, 94.32690704791297, -42.4264008504887, -194.0997487730442, -281.7488180966035, -134.55647968473076, -343.50186292142746, -197.54417652238936, -28.424883327255557, -71.1366315843562, -62.57840566813954, -776.6917950245886, -14.785898456168834, -281.3814558238036, -456.42337588110985, -156.66169331960225, -4.948719684656627, -60.37331405467958, -51.63580168305712, -398.0541537338649, -123.66702672293492, -8.159227946633179, -100.26423287655084, -28.073301789192083, 19.820000000000285, 2.0000000000000013, -23.46327411396424, 2.0000000000000013, -121.227770936311, 2.0000000000000013, -78.05906785892628, 38.20981953853222, -45.41836615148556, -31.106157234408688, -69.83699184840093, 61.99870215040644, -9.741562951281736, -246.6592083511629, -239.00482949558076, -51.10801182786034, -61.955858208114435, -69.18105691523475, -86.70526617931388, 62.15387828745238, -242.36422410199657, 58.35721269921223, -107.7852068756894, -37.39848449886328, -46.66110389033136, -27.871933831153566, 43.70536267632708, -29.88269388174355, -55.29174931283422, -54.47583365479544, -95.88981905053053, -8.973597576011878, -56.7039450416023, 2.0000000000000013, -286.6271893066726, -415.42446367818906, -466.4871604035794, -19.870113910399233, -12.133747016576999, 24.559818965462583, 29.24446867123972, -26.394580055759466, 2.0000000000000013, -40.651285921152756, -8.030912052410917, -3.3030661099056573, -22.336255711353118, -34.03969424199994, -72.78971332580727, -504.93026792975076, -944.0330249790858, -55.867850059304885, -50.617023415146214, 53.95187770422378, -3.898838383952505, 116.84000000000005, -18.280656227247334, -22.78110873580544, -0.38967892501837254, -188.09576238421266, -285.7210657259944, 22.325209627704837, -4.179296471136855, -358.0157076436035, -67.10973553790231, -469.2841934663011, -239.21965872013027], "policy_predator_policy_reward": [4.824068917918039, 199.97269239060876, 29.435086546743296, 24.678164113106604, 63.22784949184308, 52.45947271637203, 83.26780593386769, 87.76536074620303, 402.3477894147195, 28.942752084755607, 53.3928807453348, 44.22178374203164, 10.935715004285317, 6.661098353159095, 356.0845377813784, 75.68850598277527, 55.298485526492854, 50.99406893905956, 8.509631260648874, 91.86560897007405, 20.053881716973873, 176.96457772215277, 165.843994650144, 130.12436740381068, 108.06692663402184, 112.04660679752814, 225.00271730869383, 291.71772278592573, 17.450680384505997, 5.911669688470585, 190.96163321067084, 175.0753650770926, 40.60669505436097, 35.097027053418245, 151.9476966212065, 115.18260928068752, 79.07036165075037, 133.4499233951465, 154.82693214473127, 51.75106312619201, 296.33111712067915, 230.90526152241043, 25.862453546682573, 50.22118395852901, 130.42245798276048, 114.13187541576806, 49.53808951983775, 254.04905227931917, 40.125664637939636, 63.49214672230656, 724.9128732169678, 236.61738492930644, 27.853324239273352, 33.98764184814535, 1.7705791166600031, 14.982490039102089, 10.506443611907578, 2.021608099711827, 5.289047060625832, 2.3202081460536004, 30.46912847054688, 241.54322339907654, 101.93488478550395, 96.58300493186346, 55.15719601086268, 111.11244403425414, 142.55125102833864, 133.56723445502823, 520.4584184150085, 93.77046792812747, 144.59200852662133, 76.54671887608717, 92.12408588726011, 329.3120748734749, 106.78935174498534, 81.49844113753237, 127.28503151214431, 486.36372121709644, 48.90937344656942, 34.51187034125384, 302.74312339947414, 229.46122702179684, 195.40755276229785, 65.43768135489611, 269.9741879876014, 463.1001689935393, 103.976818722322, 130.4613400630343, 85.71811897697012, 152.56933901604046, 253.47150192321024, 177.06551563981887, 220.7136167119643, 219.49749133397899, 32.4265540771327, 37.05362133210844, 50.746516684825906, 46.99003351777233, 27.999459520815314, 69.70642974121131, 97.85141237452476, 119.9268982711133, 141.76189061301605, 234.99756013255873, 211.99891743180712, 215.52988669246278, 1046.294093109694, 994.3379914213643, 33.91787984655385, 83.52266986575606, 108.43001891511695, 3.6194748874584186, 203.91568166113103, 259.34883858539433, 435.9191870802606, 188.92737309302942, 173.10290120872725, 145.49238513117263, 30.443123780582894, 274.6672886419169, 57.11651586971046, 754.6638296884191, 477.4063148098736, 148.53231231101597, 3.527667302204648, 250.06274570205406, 92.93473271287131, 33.624383024864684, 233.1166677982299, 404.79779923003576, 139.01100042398076, 142.6344740461104, 2.4385765457271456, 30.023301789192388, 57.51873580156089, 137.87443587644884, 253.06580073478654, 206.67285058390218, 53.67766797704727, 56.20495662400326, 99.73461513987849, 54.24553286337405, 93.16265976753455, 209.0916535621568, 165.52918587678005, 33.814495461338204, 120.20504201837316, 382.5170541122675, 70.82461341191905, 8.136443077348476, 143.77696690580783, 198.0423355737321, 353.37636575638663, 15.973980058157371, 188.73785752316698, 191.58488971217605, 146.95282462058276, 162.12786282185027, 131.2464725250718, 92.41505348467615, 23.07659604053283, 59.43928103612318, 184.15187885321706, 191.90338376134315, 58.57394504160193, 13.235914901062806, 225.6719729481861, 213.67587403284423, 666.6575567960402, 145.8666333039142, 12.469019834528781, 19.563917560896193, 54.90025006553539, 131.42799268521173, 23.926218208626814, 20.302687207924052, 21.02291952122988, 42.339542734414735, 24.296255711353425, 5.283066109905615, 134.39261875378835, 178.3074031343808, 873.074146020404, 1059.2083946001574, 66.85530812281974, 107.50892777272492, 80.98460498967418, 42.93235569005451, 11.436184200170427, 20.24065622724764, 95.91878837615573, 91.157511128042, 316.90402644470663, 295.8555470465302, 93.19479037229534, 6.149296471136813, 213.1646794758883, 305.394503568105, 572.9125900863382, 114.21348292787742]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5485314417195459, "mean_inference_ms": 1.3634254572640077, "mean_action_processing_ms": 0.2355533494475037, "mean_env_wait_ms": 0.1793076331144842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003365159034729004, "StateBufferConnector_ms": 0.0027507543563842773, "ViewRequirementAgentConnector_ms": 0.08392190933227539}, "num_episodes": 18, "episode_return_max": 821.0088439341841, "episode_return_min": -111.86620458402355, "episode_return_mean": 154.6118988939485, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 9.040772067015098, "num_env_steps_trained_throughput_per_sec": 9.040772067015098, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 60957.009, "restore_workers_time_ms": 0.012, "training_step_time_ms": 60956.973, "sample_time_ms": 974.897, "learn_time_ms": 59970.075, "learn_throughput": 66.7, "synch_weights_time_ms": 11.244}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "1f15c_00000", "date": "2024-08-16_14-22-32", "timestamp": 1723798352, "time_this_iter_s": 442.4433059692383, "time_total_s": 1157.0577943325043, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f866e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1157.0577943325043, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 27.73846153846154, "ram_util_percent": 73.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.774985202531966, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.348874805465577, "policy_loss": -0.0034436641331200327, "vf_loss": 5.35218851452782, "vf_explained_var": 0.020495226553508213, "kl": 0.005198532576290202, "entropy": 0.44712412298987153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.65004662568607, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4715791982317725, "policy_loss": -0.0019432511557603165, "vf_loss": 5.472811185619818, "vf_explained_var": -0.27015736658106404, "kl": 0.00948352005757553, "entropy": 1.278268298333284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 821.0088439341841, "episode_reward_min": -111.86620458402355, "episode_reward_mean": 148.86391853291516, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1193.6670503023872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 168.9093706478995, "predator_policy": 1059.2083946001574}, "policy_reward_mean": {"prey_policy": -89.06321720166237, "predator_policy": 163.49517646811998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [107.5803328021925, 135.9354508953398, 134.10872243712748, 172.0599999999999, 3.9399999999999595, 13.819151924959051, 3.95999999999996, 65.26910341566355, 212.39152957634576, 206.60177006593636, 230.81803701297548, -10.02547104257918, 156.4395030116862, 202.24418030733676, 217.91602513794857, 121.47855415409475, 46.731001385261386, 124.25063865671272, 167.9561511710334, 324.9643654126313, 243.7953305266696, 267.07360840192746, 374.9626653118107, 414.75317241940604, 26.423018642436872, 157.67596197695974, 104.5000000000003, 138.324613268131, 303.11255263854423, 247.73167968684544, 821.0088439341841, 345.6038882902556, 163.95000000000005, -12.584046623122155, 146.78821756713202, 92.62622649025506, 171.3953751700042, 20.30265207737182, -111.86620458402355, 91.98000000000026, 14.549999999999926, 116.19328657146607, 173.22201364690517, 24.20857654572772, 173.92989756404526, 340.5108803823764, 33.82355674212322, 146.77160139029962, 201.31116424688204, 251.60082053724273, 17.058058283896855, -34.102813546707274, 185.93297938499137, 189.13999999999965, 330.8947530588658, 225.02109905323826, 239.49495485492085, -2.658566117921761, 225.68960990923284, 6.132317325050886, 154.720657674357, -69.38743398181391, 0.02907646844844753, 240.13253038744944, 19.834325360791702, 14.680264282081259, 3.9399999999999595, 205.87061432036188, 483.3192477117243, 67.879362421096, 173.9699999999999, 130.2361842001706, 163.90551184337397, 138.94274538102982, 117.49000000000026, 93.43373986248706, -21.377779172216282, 136.7294452985057, 91.88607534504635, 23.60321885194257, 21.331854026295826, 3.849999999999962, 177.69922527704958, 131.534254819898, 391.48548141062236, 127.63863674492389, 130.9400000000005, 154.06302290200878, 10.068433416988022, 130.80265132313687, 153.64497023910815, 98.29000000000019, 158.3077716321876, 134.29000000000025, 150.39195065245235, 169.72638485205803, 170.56967838068806, 185.75762477240178, 216.56590775415083, 494.875427480617], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.53645310228881, -175.47035589467546, 2.0000000000000013, 30.31763953509339, -601.362630882591, -226.05890482655545, 128.3984080610636, -18.179374148482022, 0.21942088333999837, -13.03249003910213, 1.3227083130515571, -0.031608099711825655, -3.3190470606258744, -0.3302081460536057, -199.6138487081709, -7.129399745789719, 2.0000000000000013, 11.873639858979242, 2.0000000000000013, 38.33213002082015, -25.072577476503486, -20.22787099388706, -226.28382608678496, -397.97053129893, -42.5757668994643, -22.123457491558483, 4.832300553307126, -224.02428100670528, -14.235723826306144, 43.86395608173793, -363.9796865638953, -128.1905120112505, -10.957366223669196, -25.73287617889173, -197.38074342646965, -210.57296833808897, -50.27339022332828, -42.615692722832684, -410.10999156850806, 2.0000000000000013, 36.17248519835508, -26.815313457040457, -72.98818740246853, 101.7743378113864, 88.07053646063703, -143.64488871185523, 73.90018169063174, -99.35811731716868, -45.05715676680525, 2.0000000000000013, 2.0000000000000013, 57.939411774361375, -1.33449656696505, 8.12860730493846, -32.41987765050617, -47.03381972700152, 73.54205918098685, -147.1889572880172, -142.93765436902984, -36.85947006839489, -1193.6670503023872, -25.956190294486923, 168.9093706478995, 59.25396793004622, 94.32690704791297, -42.4264008504887, -194.0997487730442, -281.7488180966035, -134.55647968473076, -343.50186292142746, -197.54417652238936, -28.424883327255557, -71.1366315843562, -62.57840566813954, -776.6917950245886, -14.785898456168834, -281.3814558238036, -456.42337588110985, -156.66169331960225, -4.948719684656627, -60.37331405467958, -51.63580168305712, -398.0541537338649, -123.66702672293492, -8.159227946633179, -100.26423287655084, -28.073301789192083, 19.820000000000285, 2.0000000000000013, -23.46327411396424, 2.0000000000000013, -121.227770936311, 2.0000000000000013, -78.05906785892628, 38.20981953853222, -45.41836615148556, -31.106157234408688, -69.83699184840093, 61.99870215040644, -9.741562951281736, -246.6592083511629, -239.00482949558076, -51.10801182786034, -61.955858208114435, -69.18105691523475, -86.70526617931388, 62.15387828745238, -242.36422410199657, 58.35721269921223, -107.7852068756894, -37.39848449886328, -46.66110389033136, -27.871933831153566, 43.70536267632708, -29.88269388174355, -55.29174931283422, -54.47583365479544, -95.88981905053053, -8.973597576011878, -56.7039450416023, 2.0000000000000013, -286.6271893066726, -415.42446367818906, -466.4871604035794, -19.870113910399233, -12.133747016576999, 24.559818965462583, 29.24446867123972, -26.394580055759466, 2.0000000000000013, -40.651285921152756, -8.030912052410917, -3.3030661099056573, -22.336255711353118, -34.03969424199994, -72.78971332580727, -504.93026792975076, -944.0330249790858, -55.867850059304885, -50.617023415146214, 53.95187770422378, -3.898838383952505, 116.84000000000005, -18.280656227247334, -22.78110873580544, -0.38967892501837254, -188.09576238421266, -285.7210657259944, 22.325209627704837, -4.179296471136855, -358.0157076436035, -67.10973553790231, -469.2841934663011, -239.21965872013027, 2.0000000000000013, 91.95061104367493, -2.864908139475876, -141.15908595215885, -495.79263658372935, -116.68641870199048, -23.656642934344802, -9.939238175712283, -24.470708234952113, -15.420943818833049, -129.3498469779426, 37.63999999999969, 74.51239455509933, -12.724030014457707, 48.93815510402581, -236.21075608623255, 2.0000000000000013, -87.51563810338378, -23.340852265179144, -77.28605694565773, -9.941670533226176, 18.816794855133843, -202.71080736281473, -222.18263483934655, -90.27933402844211, -221.53733644600757, -81.95533409894664, 139.61000000000007, -2.526323990782342, -123.91063480245346, 46.79416704968733, 2.0000000000000013, -31.011121810072286, 2.0000000000000013, -18.17967279475221, 15.858164349777397, -254.7408058390161, -24.204212125205412, -0.19913190345559673, 28.709057441171193, -3.3007672480307253, 53.6528027746254, -60.298997902542695, 10.87574045961798, -493.8336886621151, -698.0472778546139], "policy_predator_policy_reward": [49.53808951983775, 254.04905227931917, 40.125664637939636, 63.49214672230656, 724.9128732169678, 236.61738492930644, 27.853324239273352, 33.98764184814535, 1.7705791166600031, 14.982490039102089, 10.506443611907578, 2.021608099711827, 5.289047060625832, 2.3202081460536004, 30.46912847054688, 241.54322339907654, 101.93488478550395, 96.58300493186346, 55.15719601086268, 111.11244403425414, 142.55125102833864, 133.56723445502823, 520.4584184150085, 93.77046792812747, 144.59200852662133, 76.54671887608717, 92.12408588726011, 329.3120748734749, 106.78935174498534, 81.49844113753237, 127.28503151214431, 486.36372121709644, 48.90937344656942, 34.51187034125384, 302.74312339947414, 229.46122702179684, 195.40755276229785, 65.43768135489611, 269.9741879876014, 463.1001689935393, 103.976818722322, 130.4613400630343, 85.71811897697012, 152.56933901604046, 253.47150192321024, 177.06551563981887, 220.7136167119643, 219.49749133397899, 32.4265540771327, 37.05362133210844, 50.746516684825906, 46.99003351777233, 27.999459520815314, 69.70642974121131, 97.85141237452476, 119.9268982711133, 141.76189061301605, 234.99756013255873, 211.99891743180712, 215.52988669246278, 1046.294093109694, 994.3379914213643, 33.91787984655385, 83.52266986575606, 108.43001891511695, 3.6194748874584186, 203.91568166113103, 259.34883858539433, 435.9191870802606, 188.92737309302942, 173.10290120872725, 145.49238513117263, 30.443123780582894, 274.6672886419169, 57.11651586971046, 754.6638296884191, 477.4063148098736, 148.53231231101597, 3.527667302204648, 250.06274570205406, 92.93473271287131, 33.624383024864684, 233.1166677982299, 404.79779923003576, 139.01100042398076, 142.6344740461104, 2.4385765457271456, 30.023301789192388, 57.51873580156089, 137.87443587644884, 253.06580073478654, 206.67285058390218, 53.67766797704727, 56.20495662400326, 99.73461513987849, 54.24553286337405, 93.16265976753455, 209.0916535621568, 165.52918587678005, 33.814495461338204, 120.20504201837316, 382.5170541122675, 70.82461341191905, 8.136443077348476, 143.77696690580783, 198.0423355737321, 353.37636575638663, 15.973980058157371, 188.73785752316698, 191.58488971217605, 146.95282462058276, 162.12786282185027, 131.2464725250718, 92.41505348467615, 23.07659604053283, 59.43928103612318, 184.15187885321706, 191.90338376134315, 58.57394504160193, 13.235914901062806, 225.6719729481861, 213.67587403284423, 666.6575567960402, 145.8666333039142, 12.469019834528781, 19.563917560896193, 54.90025006553539, 131.42799268521173, 23.926218208626814, 20.302687207924052, 21.02291952122988, 42.339542734414735, 24.296255711353425, 5.283066109905615, 134.39261875378835, 178.3074031343808, 873.074146020404, 1059.2083946001574, 66.85530812281974, 107.50892777272492, 80.98460498967418, 42.93235569005451, 11.436184200170427, 20.24065622724764, 95.91878837615573, 91.157511128042, 316.90402644470663, 295.8555470465302, 93.19479037229534, 6.149296471136813, 213.1646794758883, 305.394503568105, 572.9125900863382, 114.21348292787742, 38.393096973006315, 4.385737281823548, 218.6190859521587, 17.290983484521664, 107.87906191771413, 528.2032122199486, 37.47588111005735, 17.451854026295255, 17.340943818833246, 26.400708234952415, 228.93021258606788, 40.47885966892433, 28.40571453278454, 41.340175746471715, 386.66033452566717, 192.09774786716238, 157.86486791465126, 55.28940693365568, 201.47953463585552, 30.08737457498152, 113.17576488280423, 32.01213369729677, 301.19483750199225, 133.76703811715615, 270.0515864524948, 172.5677353450919, 83.74533409894755, 12.244970239108362, 4.5063239907823, 220.22063480245328, 45.54746799704636, 63.966136585454, 163.30112181007232, 0.0, 94.84709993021985, 57.86635916720755, 103.960507041268, 344.7108957750116, 94.49039717163043, 47.56935567134207, 77.91082564262364, 57.49476360318367, 122.81174286017313, 143.17742233690248, 810.6866246993145, 876.0697692980299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.547552687047124, "mean_inference_ms": 1.3610544364504955, "mean_action_processing_ms": 0.23505370541516282, "mean_env_wait_ms": 0.1789915242527162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949284553527832, "StateBufferConnector_ms": 0.002827882766723633, "ViewRequirementAgentConnector_ms": 0.08542227745056152}, "num_episodes": 23, "episode_return_max": 821.0088439341841, "episode_return_min": -111.86620458402355, "episode_return_mean": 148.86391853291516, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.02653209532747, "num_env_steps_trained_throughput_per_sec": 441.02653209532747, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 60911.083, "restore_workers_time_ms": 0.013, "training_step_time_ms": 60911.047, "sample_time_ms": 978.82, "learn_time_ms": 59920.181, "learn_throughput": 66.755, "synch_weights_time_ms": 11.293}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "1f15c_00000", "date": "2024-08-16_14-22-41", "timestamp": 1723798361, "time_this_iter_s": 9.073205947875977, "time_total_s": 1166.1310002803802, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8e2550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1166.1310002803802, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 38.892307692307696, "ram_util_percent": 73.73846153846152}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2731152169288151, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.671429589690355, "policy_loss": -0.0060668963448652045, "vf_loss": 5.677248367304524, "vf_explained_var": 0.016934065875552948, "kl": 0.00992401795240773, "entropy": 0.5336801075430774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0245815902475326, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.392400438949545, "policy_loss": -0.005038738718611144, "vf_loss": 5.395879856997697, "vf_explained_var": -0.4562679027754163, "kl": 0.020790724958162147, "entropy": 1.2378539055743545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 821.0088439341841, "episode_reward_min": -111.86620458402355, "episode_reward_mean": 158.85491731028466, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1193.6670503023872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 182.1732947894668, "predator_policy": 1059.2083946001574}, "policy_reward_mean": {"prey_policy": -86.30903166641728, "predator_policy": 165.73649032155964}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.9561511710334, 324.9643654126313, 243.7953305266696, 267.07360840192746, 374.9626653118107, 414.75317241940604, 26.423018642436872, 157.67596197695974, 104.5000000000003, 138.324613268131, 303.11255263854423, 247.73167968684544, 821.0088439341841, 345.6038882902556, 163.95000000000005, -12.584046623122155, 146.78821756713202, 92.62622649025506, 171.3953751700042, 20.30265207737182, -111.86620458402355, 91.98000000000026, 14.549999999999926, 116.19328657146607, 173.22201364690517, 24.20857654572772, 173.92989756404526, 340.5108803823764, 33.82355674212322, 146.77160139029962, 201.31116424688204, 251.60082053724273, 17.058058283896855, -34.102813546707274, 185.93297938499137, 189.13999999999965, 330.8947530588658, 225.02109905323826, 239.49495485492085, -2.658566117921761, 225.68960990923284, 6.132317325050886, 154.720657674357, -69.38743398181391, 0.02907646844844753, 240.13253038744944, 19.834325360791702, 14.680264282081259, 3.9399999999999595, 205.87061432036188, 483.3192477117243, 67.879362421096, 173.9699999999999, 130.2361842001706, 163.90551184337397, 138.94274538102982, 117.49000000000026, 93.43373986248706, -21.377779172216282, 136.7294452985057, 91.88607534504635, 23.60321885194257, 21.331854026295826, 3.849999999999962, 177.69922527704958, 131.534254819898, 391.48548141062236, 127.63863674492389, 130.9400000000005, 154.06302290200878, 10.068433416988022, 130.80265132313687, 153.64497023910815, 98.29000000000019, 158.3077716321876, 134.29000000000025, 150.39195065245235, 169.72638485205803, 170.56967838068806, 185.75762477240178, 216.56590775415083, 494.875427480617, 7.400520045771181, 189.9499999999997, 41.18999999999962, 497.30958948363184, 33.55952110720144, 94.631775938498, 60.850732526266015, 577.0701416841022, 79.70233789916468, 226.4407783157397, 123.1375144560956, 154.50592910337392, 123.48379869431284, 38.203591818974495, 274.9242178132414, 378.142133194923, 221.6087042003011, 22.507121196357787], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-50.27339022332828, -42.615692722832684, -410.10999156850806, 2.0000000000000013, 36.17248519835508, -26.815313457040457, -72.98818740246853, 101.7743378113864, 88.07053646063703, -143.64488871185523, 73.90018169063174, -99.35811731716868, -45.05715676680525, 2.0000000000000013, 2.0000000000000013, 57.939411774361375, -1.33449656696505, 8.12860730493846, -32.41987765050617, -47.03381972700152, 73.54205918098685, -147.1889572880172, -142.93765436902984, -36.85947006839489, -1193.6670503023872, -25.956190294486923, 168.9093706478995, 59.25396793004622, 94.32690704791297, -42.4264008504887, -194.0997487730442, -281.7488180966035, -134.55647968473076, -343.50186292142746, -197.54417652238936, -28.424883327255557, -71.1366315843562, -62.57840566813954, -776.6917950245886, -14.785898456168834, -281.3814558238036, -456.42337588110985, -156.66169331960225, -4.948719684656627, -60.37331405467958, -51.63580168305712, -398.0541537338649, -123.66702672293492, -8.159227946633179, -100.26423287655084, -28.073301789192083, 19.820000000000285, 2.0000000000000013, -23.46327411396424, 2.0000000000000013, -121.227770936311, 2.0000000000000013, -78.05906785892628, 38.20981953853222, -45.41836615148556, -31.106157234408688, -69.83699184840093, 61.99870215040644, -9.741562951281736, -246.6592083511629, -239.00482949558076, -51.10801182786034, -61.955858208114435, -69.18105691523475, -86.70526617931388, 62.15387828745238, -242.36422410199657, 58.35721269921223, -107.7852068756894, -37.39848449886328, -46.66110389033136, -27.871933831153566, 43.70536267632708, -29.88269388174355, -55.29174931283422, -54.47583365479544, -95.88981905053053, -8.973597576011878, -56.7039450416023, 2.0000000000000013, -286.6271893066726, -415.42446367818906, -466.4871604035794, -19.870113910399233, -12.133747016576999, 24.559818965462583, 29.24446867123972, -26.394580055759466, 2.0000000000000013, -40.651285921152756, -8.030912052410917, -3.3030661099056573, -22.336255711353118, -34.03969424199994, -72.78971332580727, -504.93026792975076, -944.0330249790858, -55.867850059304885, -50.617023415146214, 53.95187770422378, -3.898838383952505, 116.84000000000005, -18.280656227247334, -22.78110873580544, -0.38967892501837254, -188.09576238421266, -285.7210657259944, 22.325209627704837, -4.179296471136855, -358.0157076436035, -67.10973553790231, -469.2841934663011, -239.21965872013027, 2.0000000000000013, 91.95061104367493, -2.864908139475876, -141.15908595215885, -495.79263658372935, -116.68641870199048, -23.656642934344802, -9.939238175712283, -24.470708234952113, -15.420943818833049, -129.3498469779426, 37.63999999999969, 74.51239455509933, -12.724030014457707, 48.93815510402581, -236.21075608623255, 2.0000000000000013, -87.51563810338378, -23.340852265179144, -77.28605694565773, -9.941670533226176, 18.816794855133843, -202.71080736281473, -222.18263483934655, -90.27933402844211, -221.53733644600757, -81.95533409894664, 139.61000000000007, -2.526323990782342, -123.91063480245346, 46.79416704968733, 2.0000000000000013, -31.011121810072286, 2.0000000000000013, -18.17967279475221, 15.858164349777397, -254.7408058390161, -24.204212125205412, -0.19913190345559673, 28.709057441171193, -3.3007672480307253, 53.6528027746254, -60.298997902542695, 10.87574045961798, -493.8336886621151, -698.0472778546139, 2.0000000000000013, -44.80357982012583, 122.93284329067542, -11.758774115026762, -34.066929716145616, -42.27217608753568, 2.0000000000000013, -567.8212526469124, -23.490602630965164, -6.520211853192773, -144.627585310683, -18.40545896703539, -101.25833978474205, -1.9563271532792255, -106.26288358235993, -162.62846506661927, 2.0000000000000013, -23.420582089658208, -136.1884738224884, -140.38005481363712, -3.746189525522529, -280.74283337336254, -25.304316016966194, -592.0490597685866, -40.22171399048975, -179.59793760951723, -123.58761383444043, 2.0000000000000013, 13.456598554346462, 182.1732947894668, 98.86400453233365, 117.90758538394034, -55.61003439907229, 115.90013561928254, -95.99313504142891, -54.91512927029596], "policy_predator_policy_reward": [195.40755276229785, 65.43768135489611, 269.9741879876014, 463.1001689935393, 103.976818722322, 130.4613400630343, 85.71811897697012, 152.56933901604046, 253.47150192321024, 177.06551563981887, 220.7136167119643, 219.49749133397899, 32.4265540771327, 37.05362133210844, 50.746516684825906, 46.99003351777233, 27.999459520815314, 69.70642974121131, 97.85141237452476, 119.9268982711133, 141.76189061301605, 234.99756013255873, 211.99891743180712, 215.52988669246278, 1046.294093109694, 994.3379914213643, 33.91787984655385, 83.52266986575606, 108.43001891511695, 3.6194748874584186, 203.91568166113103, 259.34883858539433, 435.9191870802606, 188.92737309302942, 173.10290120872725, 145.49238513117263, 30.443123780582894, 274.6672886419169, 57.11651586971046, 754.6638296884191, 477.4063148098736, 148.53231231101597, 3.527667302204648, 250.06274570205406, 92.93473271287131, 33.624383024864684, 233.1166677982299, 404.79779923003576, 139.01100042398076, 142.6344740461104, 2.4385765457271456, 30.023301789192388, 57.51873580156089, 137.87443587644884, 253.06580073478654, 206.67285058390218, 53.67766797704727, 56.20495662400326, 99.73461513987849, 54.24553286337405, 93.16265976753455, 209.0916535621568, 165.52918587678005, 33.814495461338204, 120.20504201837316, 382.5170541122675, 70.82461341191905, 8.136443077348476, 143.77696690580783, 198.0423355737321, 353.37636575638663, 15.973980058157371, 188.73785752316698, 191.58488971217605, 146.95282462058276, 162.12786282185027, 131.2464725250718, 92.41505348467615, 23.07659604053283, 59.43928103612318, 184.15187885321706, 191.90338376134315, 58.57394504160193, 13.235914901062806, 225.6719729481861, 213.67587403284423, 666.6575567960402, 145.8666333039142, 12.469019834528781, 19.563917560896193, 54.90025006553539, 131.42799268521173, 23.926218208626814, 20.302687207924052, 21.02291952122988, 42.339542734414735, 24.296255711353425, 5.283066109905615, 134.39261875378835, 178.3074031343808, 873.074146020404, 1059.2083946001574, 66.85530812281974, 107.50892777272492, 80.98460498967418, 42.93235569005451, 11.436184200170427, 20.24065622724764, 95.91878837615573, 91.157511128042, 316.90402644470663, 295.8555470465302, 93.19479037229534, 6.149296471136813, 213.1646794758883, 305.394503568105, 572.9125900863382, 114.21348292787742, 38.393096973006315, 4.385737281823548, 218.6190859521587, 17.290983484521664, 107.87906191771413, 528.2032122199486, 37.47588111005735, 17.451854026295255, 17.340943818833246, 26.400708234952415, 228.93021258606788, 40.47885966892433, 28.40571453278454, 41.340175746471715, 386.66033452566717, 192.09774786716238, 157.86486791465126, 55.28940693365568, 201.47953463585552, 30.08737457498152, 113.17576488280423, 32.01213369729677, 301.19483750199225, 133.76703811715615, 270.0515864524948, 172.5677353450919, 83.74533409894755, 12.244970239108362, 4.5063239907823, 220.22063480245328, 45.54746799704636, 63.966136585454, 163.30112181007232, 0.0, 94.84709993021985, 57.86635916720755, 103.960507041268, 344.7108957750116, 94.49039717163043, 47.56935567134207, 77.91082564262364, 57.49476360318367, 122.81174286017313, 143.17742233690248, 810.6866246993145, 876.0697692980299, 46.703579820125455, 3.500520045771264, 13.70877411502672, 65.06715670932458, 20.43520154447105, 97.09390425920967, 567.9586583524393, 495.1721837781057, 48.68081448415816, 14.889521107201437, 180.94118133071265, 76.72363888550377, 62.2336172491145, 101.8317822151737, 426.94646899845, 419.01502133463146, 63.972396050656016, 37.15052393816587, 218.20109309539234, 284.80821385647295, 317.8895654074024, 89.73697194757801, 221.14148568820195, 550.7178192007248, 154.35241057257784, 188.9510397217421, 6.0761275370941785, 153.71507811632185, 38.763116582584054, 40.531207886845095, 76.07672346514747, 85.29381981350133, 56.58851198794608, 104.73009099214511, 54.6975907557379, 118.71779475234473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.546891713462556, "mean_inference_ms": 1.359387296065633, "mean_action_processing_ms": 0.2347031258411188, "mean_env_wait_ms": 0.17878461280360347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004495024681091309, "StateBufferConnector_ms": 0.002863287925720215, "ViewRequirementAgentConnector_ms": 0.08612203598022461}, "num_episodes": 18, "episode_return_max": 821.0088439341841, "episode_return_min": -111.86620458402355, "episode_return_mean": 158.85491731028466, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.9216922429606, "num_env_steps_trained_throughput_per_sec": 417.9216922429606, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 60967.78, "restore_workers_time_ms": 0.012, "training_step_time_ms": 60967.745, "sample_time_ms": 981.116, "learn_time_ms": 59974.543, "learn_throughput": 66.695, "synch_weights_time_ms": 11.352}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "1f15c_00000", "date": "2024-08-16_14-22-51", "timestamp": 1723798371, "time_this_iter_s": 9.57452917098999, "time_total_s": 1175.7055294513702, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f877280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1175.7055294513702, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 32.33571428571428, "ram_util_percent": 73.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.309494636393098, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.799480336557621, "policy_loss": -0.004387276990846706, "vf_loss": 5.803427226707418, "vf_explained_var": 0.010199051811581566, "kl": 0.01761531421435483, "entropy": 0.6209437815442918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.228839282699363, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.6871633826109464, "policy_loss": -0.006735012293472965, "vf_loss": 4.692542355022733, "vf_explained_var": -0.6174410442826609, "kl": 0.012053689304829031, "entropy": 1.1524916488657553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 577.0701416841022, "episode_reward_min": -114.52721104311594, "episode_reward_mean": 144.54789487067256, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -944.0330249790858, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 182.1732947894668, "predator_policy": 1059.2083946001574}, "policy_reward_mean": {"prey_policy": -96.80821603014171, "predator_policy": 169.082163465478}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.3953751700042, 20.30265207737182, -111.86620458402355, 91.98000000000026, 14.549999999999926, 116.19328657146607, 173.22201364690517, 24.20857654572772, 173.92989756404526, 340.5108803823764, 33.82355674212322, 146.77160139029962, 201.31116424688204, 251.60082053724273, 17.058058283896855, -34.102813546707274, 185.93297938499137, 189.13999999999965, 330.8947530588658, 225.02109905323826, 239.49495485492085, -2.658566117921761, 225.68960990923284, 6.132317325050886, 154.720657674357, -69.38743398181391, 0.02907646844844753, 240.13253038744944, 19.834325360791702, 14.680264282081259, 3.9399999999999595, 205.87061432036188, 483.3192477117243, 67.879362421096, 173.9699999999999, 130.2361842001706, 163.90551184337397, 138.94274538102982, 117.49000000000026, 93.43373986248706, -21.377779172216282, 136.7294452985057, 91.88607534504635, 23.60321885194257, 21.331854026295826, 3.849999999999962, 177.69922527704958, 131.534254819898, 391.48548141062236, 127.63863674492389, 130.9400000000005, 154.06302290200878, 10.068433416988022, 130.80265132313687, 153.64497023910815, 98.29000000000019, 158.3077716321876, 134.29000000000025, 150.39195065245235, 169.72638485205803, 170.56967838068806, 185.75762477240178, 216.56590775415083, 494.875427480617, 7.400520045771181, 189.9499999999997, 41.18999999999962, 497.30958948363184, 33.55952110720144, 94.631775938498, 60.850732526266015, 577.0701416841022, 79.70233789916468, 226.4407783157397, 123.1375144560956, 154.50592910337392, 123.48379869431284, 38.203591818974495, 274.9242178132414, 378.142133194923, 221.6087042003011, 22.507121196357787, 266.69447281600816, 202.2303015079729, 499.00008432734916, 378.0133515585347, 417.201336431508, 2.0688300194090634, 27.090000000000455, 35.13000000000003, 172.6833625961031, 134.99903709433465, 128.87923754883337, 71.23832010609192, -114.52721104311594, 98.0701802443678, 182.19608642932377, 196.50825852700257, 82.99793738338641, 117.49041960677856], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-71.1366315843562, -62.57840566813954, -776.6917950245886, -14.785898456168834, -281.3814558238036, -456.42337588110985, -156.66169331960225, -4.948719684656627, -60.37331405467958, -51.63580168305712, -398.0541537338649, -123.66702672293492, -8.159227946633179, -100.26423287655084, -28.073301789192083, 19.820000000000285, 2.0000000000000013, -23.46327411396424, 2.0000000000000013, -121.227770936311, 2.0000000000000013, -78.05906785892628, 38.20981953853222, -45.41836615148556, -31.106157234408688, -69.83699184840093, 61.99870215040644, -9.741562951281736, -246.6592083511629, -239.00482949558076, -51.10801182786034, -61.955858208114435, -69.18105691523475, -86.70526617931388, 62.15387828745238, -242.36422410199657, 58.35721269921223, -107.7852068756894, -37.39848449886328, -46.66110389033136, -27.871933831153566, 43.70536267632708, -29.88269388174355, -55.29174931283422, -54.47583365479544, -95.88981905053053, -8.973597576011878, -56.7039450416023, 2.0000000000000013, -286.6271893066726, -415.42446367818906, -466.4871604035794, -19.870113910399233, -12.133747016576999, 24.559818965462583, 29.24446867123972, -26.394580055759466, 2.0000000000000013, -40.651285921152756, -8.030912052410917, -3.3030661099056573, -22.336255711353118, -34.03969424199994, -72.78971332580727, -504.93026792975076, -944.0330249790858, -55.867850059304885, -50.617023415146214, 53.95187770422378, -3.898838383952505, 116.84000000000005, -18.280656227247334, -22.78110873580544, -0.38967892501837254, -188.09576238421266, -285.7210657259944, 22.325209627704837, -4.179296471136855, -358.0157076436035, -67.10973553790231, -469.2841934663011, -239.21965872013027, 2.0000000000000013, 91.95061104367493, -2.864908139475876, -141.15908595215885, -495.79263658372935, -116.68641870199048, -23.656642934344802, -9.939238175712283, -24.470708234952113, -15.420943818833049, -129.3498469779426, 37.63999999999969, 74.51239455509933, -12.724030014457707, 48.93815510402581, -236.21075608623255, 2.0000000000000013, -87.51563810338378, -23.340852265179144, -77.28605694565773, -9.941670533226176, 18.816794855133843, -202.71080736281473, -222.18263483934655, -90.27933402844211, -221.53733644600757, -81.95533409894664, 139.61000000000007, -2.526323990782342, -123.91063480245346, 46.79416704968733, 2.0000000000000013, -31.011121810072286, 2.0000000000000013, -18.17967279475221, 15.858164349777397, -254.7408058390161, -24.204212125205412, -0.19913190345559673, 28.709057441171193, -3.3007672480307253, 53.6528027746254, -60.298997902542695, 10.87574045961798, -493.8336886621151, -698.0472778546139, 2.0000000000000013, -44.80357982012583, 122.93284329067542, -11.758774115026762, -34.066929716145616, -42.27217608753568, 2.0000000000000013, -567.8212526469124, -23.490602630965164, -6.520211853192773, -144.627585310683, -18.40545896703539, -101.25833978474205, -1.9563271532792255, -106.26288358235993, -162.62846506661927, 2.0000000000000013, -23.420582089658208, -136.1884738224884, -140.38005481363712, -3.746189525522529, -280.74283337336254, -25.304316016966194, -592.0490597685866, -40.22171399048975, -179.59793760951723, -123.58761383444043, 2.0000000000000013, 13.456598554346462, 182.1732947894668, 98.86400453233365, 117.90758538394034, -55.61003439907229, 115.90013561928254, -95.99313504142891, -54.91512927029596, 32.348495187080566, -279.5223276454338, 118.41011105048054, -45.182879783966655, -39.981515642438225, -388.18287280474226, 0.02995424539472686, -487.8363972578346, -184.53236383649872, -210.72781745888472, -91.85396744581926, -16.954099733678408, -160.20439813371127, -46.49774948562575, -506.80819285773026, -68.88252625133899, -100.32892488861012, -160.0571120036369, 2.0000000000000013, -57.628612275913795, -62.55010175492621, -11.499452474643748, -89.1921808231734, -43.604882636815, -513.5618940638461, -352.17300914771636, -489.13742482775547, -211.7617548209405, -23.744511531176947, 46.986554593173715, 2.0000000000000013, 67.0438738053505, -288.5968217623251, -179.72076616301854, -243.36606367974446, 12.88999999999996], "policy_predator_policy_reward": [30.443123780582894, 274.6672886419169, 57.11651586971046, 754.6638296884191, 477.4063148098736, 148.53231231101597, 3.527667302204648, 250.06274570205406, 92.93473271287131, 33.624383024864684, 233.1166677982299, 404.79779923003576, 139.01100042398076, 142.6344740461104, 2.4385765457271456, 30.023301789192388, 57.51873580156089, 137.87443587644884, 253.06580073478654, 206.67285058390218, 53.67766797704727, 56.20495662400326, 99.73461513987849, 54.24553286337405, 93.16265976753455, 209.0916535621568, 165.52918587678005, 33.814495461338204, 120.20504201837316, 382.5170541122675, 70.82461341191905, 8.136443077348476, 143.77696690580783, 198.0423355737321, 353.37636575638663, 15.973980058157371, 188.73785752316698, 191.58488971217605, 146.95282462058276, 162.12786282185027, 131.2464725250718, 92.41505348467615, 23.07659604053283, 59.43928103612318, 184.15187885321706, 191.90338376134315, 58.57394504160193, 13.235914901062806, 225.6719729481861, 213.67587403284423, 666.6575567960402, 145.8666333039142, 12.469019834528781, 19.563917560896193, 54.90025006553539, 131.42799268521173, 23.926218208626814, 20.302687207924052, 21.02291952122988, 42.339542734414735, 24.296255711353425, 5.283066109905615, 134.39261875378835, 178.3074031343808, 873.074146020404, 1059.2083946001574, 66.85530812281974, 107.50892777272492, 80.98460498967418, 42.93235569005451, 11.436184200170427, 20.24065622724764, 95.91878837615573, 91.157511128042, 316.90402644470663, 295.8555470465302, 93.19479037229534, 6.149296471136813, 213.1646794758883, 305.394503568105, 572.9125900863382, 114.21348292787742, 38.393096973006315, 4.385737281823548, 218.6190859521587, 17.290983484521664, 107.87906191771413, 528.2032122199486, 37.47588111005735, 17.451854026295255, 17.340943818833246, 26.400708234952415, 228.93021258606788, 40.47885966892433, 28.40571453278454, 41.340175746471715, 386.66033452566717, 192.09774786716238, 157.86486791465126, 55.28940693365568, 201.47953463585552, 30.08737457498152, 113.17576488280423, 32.01213369729677, 301.19483750199225, 133.76703811715615, 270.0515864524948, 172.5677353450919, 83.74533409894755, 12.244970239108362, 4.5063239907823, 220.22063480245328, 45.54746799704636, 63.966136585454, 163.30112181007232, 0.0, 94.84709993021985, 57.86635916720755, 103.960507041268, 344.7108957750116, 94.49039717163043, 47.56935567134207, 77.91082564262364, 57.49476360318367, 122.81174286017313, 143.17742233690248, 810.6866246993145, 876.0697692980299, 46.703579820125455, 3.500520045771264, 13.70877411502672, 65.06715670932458, 20.43520154447105, 97.09390425920967, 567.9586583524393, 495.1721837781057, 48.68081448415816, 14.889521107201437, 180.94118133071265, 76.72363888550377, 62.2336172491145, 101.8317822151737, 426.94646899845, 419.01502133463146, 63.972396050656016, 37.15052393816587, 218.20109309539234, 284.80821385647295, 317.8895654074024, 89.73697194757801, 221.14148568820195, 550.7178192007248, 154.35241057257784, 188.9510397217421, 6.0761275370941785, 153.71507811632185, 38.763116582584054, 40.531207886845095, 76.07672346514747, 85.29381981350133, 56.58851198794608, 104.73009099214511, 54.6975907557379, 118.71779475234473, 267.07385955629763, 246.79444571806448, 73.29395524826397, 55.70911499319523, 411.59157288455117, 515.5728998899787, 463.7035450427276, 402.1162495282476, 347.8406552445901, 464.6208624823011, 89.9870050631852, 20.889892135722782, 21.217288819238288, 212.57485880009727, 149.80338836896885, 461.01733074010116, 234.12346182202833, 198.94593766631985, 17.819037094334142, 172.8086122759138, 151.98607196616612, 50.94271981223729, 89.39604191762515, 114.6393416484539, 544.1456253116047, 207.06206685684245, 634.5587198097118, 164.4106400833513, 66.28183971406685, 92.67220365326068, 38.14295783872531, 89.3214268829271, 103.74026523096495, 447.5752600777642, 221.38167060334516, 126.58481268317766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5464560566020547, "mean_inference_ms": 1.358201441472872, "mean_action_processing_ms": 0.23446637835089568, "mean_env_wait_ms": 0.1785966953647795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004904627799987793, "StateBufferConnector_ms": 0.0028651952743530273, "ViewRequirementAgentConnector_ms": 0.09141707420349121}, "num_episodes": 18, "episode_return_max": 577.0701416841022, "episode_return_min": -114.52721104311594, "episode_return_mean": 144.54789487067256, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 434.8978125131635, "num_env_steps_trained_throughput_per_sec": 434.8978125131635, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 60966.083, "restore_workers_time_ms": 0.012, "training_step_time_ms": 60966.047, "sample_time_ms": 980.798, "learn_time_ms": 59973.12, "learn_throughput": 66.697, "synch_weights_time_ms": 11.421}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "1f15c_00000", "date": "2024-08-16_14-23-00", "timestamp": 1723798380, "time_this_iter_s": 9.201738119125366, "time_total_s": 1184.9072675704956, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f872b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1184.9072675704956, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 38.08461538461539, "ram_util_percent": 74.6923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9032221747296196, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.585796195237094, "policy_loss": -0.00619731438777375, "vf_loss": 6.591819211919471, "vf_explained_var": 0.013392010283848597, "kl": 0.006972124975222376, "entropy": 0.5784977445684413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.02983012278244, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.750262461389814, "policy_loss": -0.008083484259621295, "vf_loss": 4.756604383105324, "vf_explained_var": -0.7619261351842729, "kl": 0.01548052652018707, "entropy": 1.0937736421350448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 577.0701416841022, "episode_reward_min": -114.52721104311594, "episode_reward_mean": 147.4883101129784, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -944.0330249790858, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 182.1732947894668, "predator_policy": 1059.2083946001574}, "policy_reward_mean": {"prey_policy": -100.25307789077314, "predator_policy": 173.99723294726238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [225.68960990923284, 6.132317325050886, 154.720657674357, -69.38743398181391, 0.02907646844844753, 240.13253038744944, 19.834325360791702, 14.680264282081259, 3.9399999999999595, 205.87061432036188, 483.3192477117243, 67.879362421096, 173.9699999999999, 130.2361842001706, 163.90551184337397, 138.94274538102982, 117.49000000000026, 93.43373986248706, -21.377779172216282, 136.7294452985057, 91.88607534504635, 23.60321885194257, 21.331854026295826, 3.849999999999962, 177.69922527704958, 131.534254819898, 391.48548141062236, 127.63863674492389, 130.9400000000005, 154.06302290200878, 10.068433416988022, 130.80265132313687, 153.64497023910815, 98.29000000000019, 158.3077716321876, 134.29000000000025, 150.39195065245235, 169.72638485205803, 170.56967838068806, 185.75762477240178, 216.56590775415083, 494.875427480617, 7.400520045771181, 189.9499999999997, 41.18999999999962, 497.30958948363184, 33.55952110720144, 94.631775938498, 60.850732526266015, 577.0701416841022, 79.70233789916468, 226.4407783157397, 123.1375144560956, 154.50592910337392, 123.48379869431284, 38.203591818974495, 274.9242178132414, 378.142133194923, 221.6087042003011, 22.507121196357787, 266.69447281600816, 202.2303015079729, 499.00008432734916, 378.0133515585347, 417.201336431508, 2.0688300194090634, 27.090000000000455, 35.13000000000003, 172.6833625961031, 134.99903709433465, 128.87923754883337, 71.23832010609192, -114.52721104311594, 98.0701802443678, 182.19608642932377, 196.50825852700257, 82.99793738338641, 117.49041960677856, 275.2967138016112, 3.739999999999966, 278.0808960510386, 483.2055122672986, 99.36906726675335, 204.43102108853844, 117.68747478536677, 119.05339192711762, 106.94367484626777, 12.252908859476875, 269.70983378785763, 158.94825578818674, -6.671278415871772, 101.73543924070171, 152.7516421643157, 31.968822158406063, 26.250000000000334, 11.974528423082468, 220.96684800600553, -83.46148599056525, 196.67432589656264, 311.84801754014035], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.47583365479544, -95.88981905053053, -8.973597576011878, -56.7039450416023, 2.0000000000000013, -286.6271893066726, -415.42446367818906, -466.4871604035794, -19.870113910399233, -12.133747016576999, 24.559818965462583, 29.24446867123972, -26.394580055759466, 2.0000000000000013, -40.651285921152756, -8.030912052410917, -3.3030661099056573, -22.336255711353118, -34.03969424199994, -72.78971332580727, -504.93026792975076, -944.0330249790858, -55.867850059304885, -50.617023415146214, 53.95187770422378, -3.898838383952505, 116.84000000000005, -18.280656227247334, -22.78110873580544, -0.38967892501837254, -188.09576238421266, -285.7210657259944, 22.325209627704837, -4.179296471136855, -358.0157076436035, -67.10973553790231, -469.2841934663011, -239.21965872013027, 2.0000000000000013, 91.95061104367493, -2.864908139475876, -141.15908595215885, -495.79263658372935, -116.68641870199048, -23.656642934344802, -9.939238175712283, -24.470708234952113, -15.420943818833049, -129.3498469779426, 37.63999999999969, 74.51239455509933, -12.724030014457707, 48.93815510402581, -236.21075608623255, 2.0000000000000013, -87.51563810338378, -23.340852265179144, -77.28605694565773, -9.941670533226176, 18.816794855133843, -202.71080736281473, -222.18263483934655, -90.27933402844211, -221.53733644600757, -81.95533409894664, 139.61000000000007, -2.526323990782342, -123.91063480245346, 46.79416704968733, 2.0000000000000013, -31.011121810072286, 2.0000000000000013, -18.17967279475221, 15.858164349777397, -254.7408058390161, -24.204212125205412, -0.19913190345559673, 28.709057441171193, -3.3007672480307253, 53.6528027746254, -60.298997902542695, 10.87574045961798, -493.8336886621151, -698.0472778546139, 2.0000000000000013, -44.80357982012583, 122.93284329067542, -11.758774115026762, -34.066929716145616, -42.27217608753568, 2.0000000000000013, -567.8212526469124, -23.490602630965164, -6.520211853192773, -144.627585310683, -18.40545896703539, -101.25833978474205, -1.9563271532792255, -106.26288358235993, -162.62846506661927, 2.0000000000000013, -23.420582089658208, -136.1884738224884, -140.38005481363712, -3.746189525522529, -280.74283337336254, -25.304316016966194, -592.0490597685866, -40.22171399048975, -179.59793760951723, -123.58761383444043, 2.0000000000000013, 13.456598554346462, 182.1732947894668, 98.86400453233365, 117.90758538394034, -55.61003439907229, 115.90013561928254, -95.99313504142891, -54.91512927029596, 32.348495187080566, -279.5223276454338, 118.41011105048054, -45.182879783966655, -39.981515642438225, -388.18287280474226, 0.02995424539472686, -487.8363972578346, -184.53236383649872, -210.72781745888472, -91.85396744581926, -16.954099733678408, -160.20439813371127, -46.49774948562575, -506.80819285773026, -68.88252625133899, -100.32892488861012, -160.0571120036369, 2.0000000000000013, -57.628612275913795, -62.55010175492621, -11.499452474643748, -89.1921808231734, -43.604882636815, -513.5618940638461, -352.17300914771636, -489.13742482775547, -211.7617548209405, -23.744511531176947, 46.986554593173715, 2.0000000000000013, 67.0438738053505, -288.5968217623251, -179.72076616301854, -243.36606367974446, 12.88999999999996, -45.89999590593425, -34.24835119450762, -42.90979795340162, -68.310216718929, -24.848302799696167, -241.6495949838793, -159.15551226729863, 96.05000000000018, -261.0056736570947, -61.180582277463216, -34.521994442839414, -97.5096173036799, -375.78620185827793, -6.650709923305163, -140.216421139987, -316.05782564975084, 68.37960497371775, 2.0000000000000013, -4.581399370163325, -15.861591812554373, 2.0000000000000013, -369.50025104504715, -129.1603013939312, 2.0000000000000013, -9.132093768765115, -12.924148126449193, -275.00829371929586, -16.518554236302883, -5.41036591277911, -14.368847445549683, -83.53156304601495, -16.39118007532629, -370.74650710737797, 5.201967971899043, -24.458511016004717, 2.0000000000000013, 2.0000000000000013, 81.59943978634814, -470.13838138587533, -681.263699866331, -59.57277501199693, -151.31938986123797, -71.23939057401286, -244.4382193692546], "policy_predator_policy_reward": [184.15187885321706, 191.90338376134315, 58.57394504160193, 13.235914901062806, 225.6719729481861, 213.67587403284423, 666.6575567960402, 145.8666333039142, 12.469019834528781, 19.563917560896193, 54.90025006553539, 131.42799268521173, 23.926218208626814, 20.302687207924052, 21.02291952122988, 42.339542734414735, 24.296255711353425, 5.283066109905615, 134.39261875378835, 178.3074031343808, 873.074146020404, 1059.2083946001574, 66.85530812281974, 107.50892777272492, 80.98460498967418, 42.93235569005451, 11.436184200170427, 20.24065622724764, 95.91878837615573, 91.157511128042, 316.90402644470663, 295.8555470465302, 93.19479037229534, 6.149296471136813, 213.1646794758883, 305.394503568105, 572.9125900863382, 114.21348292787742, 38.393096973006315, 4.385737281823548, 218.6190859521587, 17.290983484521664, 107.87906191771413, 528.2032122199486, 37.47588111005735, 17.451854026295255, 17.340943818833246, 26.400708234952415, 228.93021258606788, 40.47885966892433, 28.40571453278454, 41.340175746471715, 386.66033452566717, 192.09774786716238, 157.86486791465126, 55.28940693365568, 201.47953463585552, 30.08737457498152, 113.17576488280423, 32.01213369729677, 301.19483750199225, 133.76703811715615, 270.0515864524948, 172.5677353450919, 83.74533409894755, 12.244970239108362, 4.5063239907823, 220.22063480245328, 45.54746799704636, 63.966136585454, 163.30112181007232, 0.0, 94.84709993021985, 57.86635916720755, 103.960507041268, 344.7108957750116, 94.49039717163043, 47.56935567134207, 77.91082564262364, 57.49476360318367, 122.81174286017313, 143.17742233690248, 810.6866246993145, 876.0697692980299, 46.703579820125455, 3.500520045771264, 13.70877411502672, 65.06715670932458, 20.43520154447105, 97.09390425920967, 567.9586583524393, 495.1721837781057, 48.68081448415816, 14.889521107201437, 180.94118133071265, 76.72363888550377, 62.2336172491145, 101.8317822151737, 426.94646899845, 419.01502133463146, 63.972396050656016, 37.15052393816587, 218.20109309539234, 284.80821385647295, 317.8895654074024, 89.73697194757801, 221.14148568820195, 550.7178192007248, 154.35241057257784, 188.9510397217421, 6.0761275370941785, 153.71507811632185, 38.763116582584054, 40.531207886845095, 76.07672346514747, 85.29381981350133, 56.58851198794608, 104.73009099214511, 54.6975907557379, 118.71779475234473, 267.07385955629763, 246.79444571806448, 73.29395524826397, 55.70911499319523, 411.59157288455117, 515.5728998899787, 463.7035450427276, 402.1162495282476, 347.8406552445901, 464.6208624823011, 89.9870050631852, 20.889892135722782, 21.217288819238288, 212.57485880009727, 149.80338836896885, 461.01733074010116, 234.12346182202833, 198.94593766631985, 17.819037094334142, 172.8086122759138, 151.98607196616612, 50.94271981223729, 89.39604191762515, 114.6393416484539, 544.1456253116047, 207.06206685684245, 634.5587198097118, 164.4106400833513, 66.28183971406685, 92.67220365326068, 38.14295783872531, 89.3214268829271, 103.74026523096495, 447.5752600777642, 221.38167060334516, 126.58481268317766, 186.40351436002575, 169.04154654202787, 44.78979795340125, 70.17021671892995, 320.865698637263, 223.71309519735232, 273.15551226729866, 273.15551226729866, 295.8175504635659, 125.73777273774489, 144.19526659589863, 192.26736623915937, 424.29652927491196, 75.82785729203697, 351.83121757686786, 223.49642113998704, 27.321685826324547, 9.242384046225386, 22.89953615766038, 9.796363884534491, 252.2231422829876, 384.98694254991733, 194.2381134830255, 91.87044369909269, 1.8021925160862389, 13.582770963256294, 189.15076771061493, 204.11151948568548, 54.70645180836674, 117.82440371427788, 81.9663297512541, 49.925235528493765, 265.2721945639861, 126.52234457149278, 24.613042488464433, 9.819996950623107, 78.63471284746281, 58.73269537219523, 723.8135750624173, 344.1270201992232, 168.68585031282373, 238.8806404569735, 322.6665739073953, 304.85905357601456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5458630562620805, "mean_inference_ms": 1.3565942331069665, "mean_action_processing_ms": 0.23418228477548034, "mean_env_wait_ms": 0.17836507374542301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005379080772399902, "StateBufferConnector_ms": 0.002887725830078125, "ViewRequirementAgentConnector_ms": 0.09140002727508545}, "num_episodes": 22, "episode_return_max": 577.0701416841022, "episode_return_min": -114.52721104311594, "episode_return_mean": 147.4883101129784, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.26570138460767, "num_env_steps_trained_throughput_per_sec": 447.26570138460767, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 60937.548, "restore_workers_time_ms": 0.012, "training_step_time_ms": 60937.512, "sample_time_ms": 983.189, "learn_time_ms": 59942.08, "learn_throughput": 66.731, "synch_weights_time_ms": 11.533}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "1f15c_00000", "date": "2024-08-16_14-23-09", "timestamp": 1723798389, "time_this_iter_s": 8.946777105331421, "time_total_s": 1193.854044675827, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f879a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1193.854044675827, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 25.075, "ram_util_percent": 74.69166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6620581377120245, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.218100584625567, "policy_loss": -0.004920470939761905, "vf_loss": 6.222884438782142, "vf_explained_var": 0.006586180477546006, "kl": 0.005464639582050369, "entropy": 0.5053269564159333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3087238111508586, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.1949067331495735, "policy_loss": -0.006143145168091727, "vf_loss": 5.20003489287442, "vf_explained_var": -0.6157918096219421, "kl": 0.009022061916307673, "entropy": 1.0370023912222928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 577.0701416841022, "episode_reward_min": -114.52721104311594, "episode_reward_mean": 157.71148570829436, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -698.0472778546139, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 182.1732947894668, "predator_policy": 876.0697692980299}, "policy_reward_mean": {"prey_policy": -101.54991947588783, "predator_policy": 180.40566233003506}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.849999999999962, 177.69922527704958, 131.534254819898, 391.48548141062236, 127.63863674492389, 130.9400000000005, 154.06302290200878, 10.068433416988022, 130.80265132313687, 153.64497023910815, 98.29000000000019, 158.3077716321876, 134.29000000000025, 150.39195065245235, 169.72638485205803, 170.56967838068806, 185.75762477240178, 216.56590775415083, 494.875427480617, 7.400520045771181, 189.9499999999997, 41.18999999999962, 497.30958948363184, 33.55952110720144, 94.631775938498, 60.850732526266015, 577.0701416841022, 79.70233789916468, 226.4407783157397, 123.1375144560956, 154.50592910337392, 123.48379869431284, 38.203591818974495, 274.9242178132414, 378.142133194923, 221.6087042003011, 22.507121196357787, 266.69447281600816, 202.2303015079729, 499.00008432734916, 378.0133515585347, 417.201336431508, 2.0688300194090634, 27.090000000000455, 35.13000000000003, 172.6833625961031, 134.99903709433465, 128.87923754883337, 71.23832010609192, -114.52721104311594, 98.0701802443678, 182.19608642932377, 196.50825852700257, 82.99793738338641, 117.49041960677856, 275.2967138016112, 3.739999999999966, 278.0808960510386, 483.2055122672986, 99.36906726675335, 204.43102108853844, 117.68747478536677, 119.05339192711762, 106.94367484626777, 12.252908859476875, 269.70983378785763, 158.94825578818674, -6.671278415871772, 101.73543924070171, 152.7516421643157, 31.968822158406063, 26.250000000000334, 11.974528423082468, 220.96684800600553, -83.46148599056525, 196.67432589656264, 311.84801754014035, 73.13891626961865, 325.02098251693866, 318.5489028262654, 120.10836219929276, 235.99971121263067, 14.565485891118257, 36.51482495562885, 280.29765277454317, 166.3746137321231, 280.72841062836767, 20.189999999999984, 49.16836947993118, 104.02339798458894, 155.33969197511567, 208.74868073588087, -2.750142323495549, 305.59070900977866, 147.71087679848893, 3.91999999999996, 49.75975588477853, 258.6004853763525, 61.2507187720103, 232.45872034704874], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.470708234952113, -15.420943818833049, -129.3498469779426, 37.63999999999969, 74.51239455509933, -12.724030014457707, 48.93815510402581, -236.21075608623255, 2.0000000000000013, -87.51563810338378, -23.340852265179144, -77.28605694565773, -9.941670533226176, 18.816794855133843, -202.71080736281473, -222.18263483934655, -90.27933402844211, -221.53733644600757, -81.95533409894664, 139.61000000000007, -2.526323990782342, -123.91063480245346, 46.79416704968733, 2.0000000000000013, -31.011121810072286, 2.0000000000000013, -18.17967279475221, 15.858164349777397, -254.7408058390161, -24.204212125205412, -0.19913190345559673, 28.709057441171193, -3.3007672480307253, 53.6528027746254, -60.298997902542695, 10.87574045961798, -493.8336886621151, -698.0472778546139, 2.0000000000000013, -44.80357982012583, 122.93284329067542, -11.758774115026762, -34.066929716145616, -42.27217608753568, 2.0000000000000013, -567.8212526469124, -23.490602630965164, -6.520211853192773, -144.627585310683, -18.40545896703539, -101.25833978474205, -1.9563271532792255, -106.26288358235993, -162.62846506661927, 2.0000000000000013, -23.420582089658208, -136.1884738224884, -140.38005481363712, -3.746189525522529, -280.74283337336254, -25.304316016966194, -592.0490597685866, -40.22171399048975, -179.59793760951723, -123.58761383444043, 2.0000000000000013, 13.456598554346462, 182.1732947894668, 98.86400453233365, 117.90758538394034, -55.61003439907229, 115.90013561928254, -95.99313504142891, -54.91512927029596, 32.348495187080566, -279.5223276454338, 118.41011105048054, -45.182879783966655, -39.981515642438225, -388.18287280474226, 0.02995424539472686, -487.8363972578346, -184.53236383649872, -210.72781745888472, -91.85396744581926, -16.954099733678408, -160.20439813371127, -46.49774948562575, -506.80819285773026, -68.88252625133899, -100.32892488861012, -160.0571120036369, 2.0000000000000013, -57.628612275913795, -62.55010175492621, -11.499452474643748, -89.1921808231734, -43.604882636815, -513.5618940638461, -352.17300914771636, -489.13742482775547, -211.7617548209405, -23.744511531176947, 46.986554593173715, 2.0000000000000013, 67.0438738053505, -288.5968217623251, -179.72076616301854, -243.36606367974446, 12.88999999999996, -45.89999590593425, -34.24835119450762, -42.90979795340162, -68.310216718929, -24.848302799696167, -241.6495949838793, -159.15551226729863, 96.05000000000018, -261.0056736570947, -61.180582277463216, -34.521994442839414, -97.5096173036799, -375.78620185827793, -6.650709923305163, -140.216421139987, -316.05782564975084, 68.37960497371775, 2.0000000000000013, -4.581399370163325, -15.861591812554373, 2.0000000000000013, -369.50025104504715, -129.1603013939312, 2.0000000000000013, -9.132093768765115, -12.924148126449193, -275.00829371929586, -16.518554236302883, -5.41036591277911, -14.368847445549683, -83.53156304601495, -16.39118007532629, -370.74650710737797, 5.201967971899043, -24.458511016004717, 2.0000000000000013, 2.0000000000000013, 81.59943978634814, -470.13838138587533, -681.263699866331, -59.57277501199693, -151.31938986123797, -71.23939057401286, -244.4382193692546, -191.22460247213053, -3.603033299007641, -65.73356469900567, -272.0156735904342, -264.9285725130376, -472.3400754243168, -13.877034138464458, -20.953721790820953, -78.72563859285324, -207.00491234713192, 2.0000000000000013, -39.8896420271754, -53.655975258409896, -10.110568233893623, -82.29581375155043, 61.73117346111277, -428.3617703484708, -5.722879851316479, -471.81725399495605, 2.0000000000000013, -529.6127699609632, -79.07387046988492, -141.89131382857843, 2.0000000000000013, -305.10616817543973, 2.0000000000000013, 88.18157299495448, -181.53594292425677, -71.900332320775, -344.3985413834148, -9.851635199258672, -97.17583204969075, -165.5515898435631, -57.75378280567751, -39.69425512370417, -14.099708315183202, -3.9538415647034917, -15.492749408983032, -349.5960250525256, -131.53842252018853, -25.641073431801978, -56.94483244705995, -112.92629953413149, 2.0000000000000013, -175.4831647698604, -109.5803701528311], "policy_predator_policy_reward": [17.340943818833246, 26.400708234952415, 228.93021258606788, 40.47885966892433, 28.40571453278454, 41.340175746471715, 386.66033452566717, 192.09774786716238, 157.86486791465126, 55.28940693365568, 201.47953463585552, 30.08737457498152, 113.17576488280423, 32.01213369729677, 301.19483750199225, 133.76703811715615, 270.0515864524948, 172.5677353450919, 83.74533409894755, 12.244970239108362, 4.5063239907823, 220.22063480245328, 45.54746799704636, 63.966136585454, 163.30112181007232, 0.0, 94.84709993021985, 57.86635916720755, 103.960507041268, 344.7108957750116, 94.49039717163043, 47.56935567134207, 77.91082564262364, 57.49476360318367, 122.81174286017313, 143.17742233690248, 810.6866246993145, 876.0697692980299, 46.703579820125455, 3.500520045771264, 13.70877411502672, 65.06715670932458, 20.43520154447105, 97.09390425920967, 567.9586583524393, 495.1721837781057, 48.68081448415816, 14.889521107201437, 180.94118133071265, 76.72363888550377, 62.2336172491145, 101.8317822151737, 426.94646899845, 419.01502133463146, 63.972396050656016, 37.15052393816587, 218.20109309539234, 284.80821385647295, 317.8895654074024, 89.73697194757801, 221.14148568820195, 550.7178192007248, 154.35241057257784, 188.9510397217421, 6.0761275370941785, 153.71507811632185, 38.763116582584054, 40.531207886845095, 76.07672346514747, 85.29381981350133, 56.58851198794608, 104.73009099214511, 54.6975907557379, 118.71779475234473, 267.07385955629763, 246.79444571806448, 73.29395524826397, 55.70911499319523, 411.59157288455117, 515.5728998899787, 463.7035450427276, 402.1162495282476, 347.8406552445901, 464.6208624823011, 89.9870050631852, 20.889892135722782, 21.217288819238288, 212.57485880009727, 149.80338836896885, 461.01733074010116, 234.12346182202833, 198.94593766631985, 17.819037094334142, 172.8086122759138, 151.98607196616612, 50.94271981223729, 89.39604191762515, 114.6393416484539, 544.1456253116047, 207.06206685684245, 634.5587198097118, 164.4106400833513, 66.28183971406685, 92.67220365326068, 38.14295783872531, 89.3214268829271, 103.74026523096495, 447.5752600777642, 221.38167060334516, 126.58481268317766, 186.40351436002575, 169.04154654202787, 44.78979795340125, 70.17021671892995, 320.865698637263, 223.71309519735232, 273.15551226729866, 273.15551226729866, 295.8175504635659, 125.73777273774489, 144.19526659589863, 192.26736623915937, 424.29652927491196, 75.82785729203697, 351.83121757686786, 223.49642113998704, 27.321685826324547, 9.242384046225386, 22.89953615766038, 9.796363884534491, 252.2231422829876, 384.98694254991733, 194.2381134830255, 91.87044369909269, 1.8021925160862389, 13.582770963256294, 189.15076771061493, 204.11151948568548, 54.70645180836674, 117.82440371427788, 81.9663297512541, 49.925235528493765, 265.2721945639861, 126.52234457149278, 24.613042488464433, 9.819996950623107, 78.63471284746281, 58.73269537219523, 723.8135750624173, 344.1270201992232, 168.68585031282373, 238.8806404569735, 322.6665739073953, 304.85905357601456, 85.47344466992615, 182.49310737083033, 212.9933565750156, 449.77686423136305, 557.7394419531639, 498.07810881045594, 63.667852047786596, 91.27126608079143, 308.0673116418546, 213.66295051076278, 10.67548589111834, 41.77964202717502, 59.05454358471346, 41.22682486321913, 156.88790127983654, 143.97439178514577, 276.81101059144044, 323.64825334046975, 362.538661729994, 388.00700289333054, 263.35310624747996, 365.52353418336867, 114.46000100289787, 74.59968230561095, 138.5017368140627, 268.627829345966, 43.33649008013868, 205.35757182427886, 455.25109684818335, 169.79645759188688, 5.361056483039816, 98.916268442415, 289.3234797004675, 239.57260195855167, 82.75883455419562, 118.74600568318164, 5.92384156470345, 17.442749408983246, 248.32647803410507, 282.56772542338734, 158.55618515637067, 182.63020609884467, 79.424352067672, 92.75266623847128, 188.1896167653893, 329.33263850435077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5454543306072714, "mean_inference_ms": 1.354155530977082, "mean_action_processing_ms": 0.23387116228304286, "mean_env_wait_ms": 0.17838009097758195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005280256271362305, "StateBufferConnector_ms": 0.002868175506591797, "ViewRequirementAgentConnector_ms": 0.09061920642852783}, "num_episodes": 23, "episode_return_max": 577.0701416841022, "episode_return_min": -114.52721104311594, "episode_return_mean": 157.71148570829436, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 10.70945748804436, "num_env_steps_trained_throughput_per_sec": 10.70945748804436, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 88835.871, "restore_workers_time_ms": 0.012, "training_step_time_ms": 88835.835, "sample_time_ms": 987.709, "learn_time_ms": 87835.045, "learn_throughput": 45.54, "synch_weights_time_ms": 12.228}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "1f15c_00000", "date": "2024-08-16_14-29-22", "timestamp": 1723798762, "time_this_iter_s": 373.5189719200134, "time_total_s": 1567.3730165958405, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f879dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1567.3730165958405, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 24.25, "ram_util_percent": 74.70714285714288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0449345080625445, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.831126530965169, "policy_loss": -0.0023614539768517253, "vf_loss": 4.833375558525166, "vf_explained_var": 0.028664032586667904, "kl": 0.004497017799415771, "entropy": 0.499107027574191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4945695256430005, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.601895272921002, "policy_loss": -0.007443054117479179, "vf_loss": 4.607921497027079, "vf_explained_var": -0.42881039396795645, "kl": 0.012594122905469685, "entropy": 1.0044105720583094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 577.0701416841022, "episode_reward_min": -114.52721104311594, "episode_reward_mean": 153.705321688537, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -698.0472778546139, "predator_policy": 1.8021925160862389}, "policy_reward_max": {"prey_policy": 182.1732947894668, "predator_policy": 876.0697692980299}, "policy_reward_mean": {"prey_policy": -110.5297657630129, "predator_policy": 187.38242660728145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [494.875427480617, 7.400520045771181, 189.9499999999997, 41.18999999999962, 497.30958948363184, 33.55952110720144, 94.631775938498, 60.850732526266015, 577.0701416841022, 79.70233789916468, 226.4407783157397, 123.1375144560956, 154.50592910337392, 123.48379869431284, 38.203591818974495, 274.9242178132414, 378.142133194923, 221.6087042003011, 22.507121196357787, 266.69447281600816, 202.2303015079729, 499.00008432734916, 378.0133515585347, 417.201336431508, 2.0688300194090634, 27.090000000000455, 35.13000000000003, 172.6833625961031, 134.99903709433465, 128.87923754883337, 71.23832010609192, -114.52721104311594, 98.0701802443678, 182.19608642932377, 196.50825852700257, 82.99793738338641, 117.49041960677856, 275.2967138016112, 3.739999999999966, 278.0808960510386, 483.2055122672986, 99.36906726675335, 204.43102108853844, 117.68747478536677, 119.05339192711762, 106.94367484626777, 12.252908859476875, 269.70983378785763, 158.94825578818674, -6.671278415871772, 101.73543924070171, 152.7516421643157, 31.968822158406063, 26.250000000000334, 11.974528423082468, 220.96684800600553, -83.46148599056525, 196.67432589656264, 311.84801754014035, 73.13891626961865, 325.02098251693866, 318.5489028262654, 120.10836219929276, 235.99971121263067, 14.565485891118257, 36.51482495562885, 280.29765277454317, 166.3746137321231, 280.72841062836767, 20.189999999999984, 49.16836947993118, 104.02339798458894, 155.33969197511567, 208.74868073588087, -2.750142323495549, 305.59070900977866, 147.71087679848893, 3.91999999999996, 49.75975588477853, 258.6004853763525, 61.2507187720103, 232.45872034704874, 41.82747309284069, 285.6215508363919, 54.7517851192899, 37.530000000000236, 117.34660369355564, 44.37999999999974, 342.477076592068, 125.67492505661336, 190.97943181570753, 36.593244089367865, 170.57917770559004, 7.902814566226832, 44.250000000000156, 500.8768819821057, 179.9434228171524, 78.94505553393067, 4.83999999999994, 30.49014930110391], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-493.8336886621151, -698.0472778546139, 2.0000000000000013, -44.80357982012583, 122.93284329067542, -11.758774115026762, -34.066929716145616, -42.27217608753568, 2.0000000000000013, -567.8212526469124, -23.490602630965164, -6.520211853192773, -144.627585310683, -18.40545896703539, -101.25833978474205, -1.9563271532792255, -106.26288358235993, -162.62846506661927, 2.0000000000000013, -23.420582089658208, -136.1884738224884, -140.38005481363712, -3.746189525522529, -280.74283337336254, -25.304316016966194, -592.0490597685866, -40.22171399048975, -179.59793760951723, -123.58761383444043, 2.0000000000000013, 13.456598554346462, 182.1732947894668, 98.86400453233365, 117.90758538394034, -55.61003439907229, 115.90013561928254, -95.99313504142891, -54.91512927029596, 32.348495187080566, -279.5223276454338, 118.41011105048054, -45.182879783966655, -39.981515642438225, -388.18287280474226, 0.02995424539472686, -487.8363972578346, -184.53236383649872, -210.72781745888472, -91.85396744581926, -16.954099733678408, -160.20439813371127, -46.49774948562575, -506.80819285773026, -68.88252625133899, -100.32892488861012, -160.0571120036369, 2.0000000000000013, -57.628612275913795, -62.55010175492621, -11.499452474643748, -89.1921808231734, -43.604882636815, -513.5618940638461, -352.17300914771636, -489.13742482775547, -211.7617548209405, -23.744511531176947, 46.986554593173715, 2.0000000000000013, 67.0438738053505, -288.5968217623251, -179.72076616301854, -243.36606367974446, 12.88999999999996, -45.89999590593425, -34.24835119450762, -42.90979795340162, -68.310216718929, -24.848302799696167, -241.6495949838793, -159.15551226729863, 96.05000000000018, -261.0056736570947, -61.180582277463216, -34.521994442839414, -97.5096173036799, -375.78620185827793, -6.650709923305163, -140.216421139987, -316.05782564975084, 68.37960497371775, 2.0000000000000013, -4.581399370163325, -15.861591812554373, 2.0000000000000013, -369.50025104504715, -129.1603013939312, 2.0000000000000013, -9.132093768765115, -12.924148126449193, -275.00829371929586, -16.518554236302883, -5.41036591277911, -14.368847445549683, -83.53156304601495, -16.39118007532629, -370.74650710737797, 5.201967971899043, -24.458511016004717, 2.0000000000000013, 2.0000000000000013, 81.59943978634814, -470.13838138587533, -681.263699866331, -59.57277501199693, -151.31938986123797, -71.23939057401286, -244.4382193692546, -191.22460247213053, -3.603033299007641, -65.73356469900567, -272.0156735904342, -264.9285725130376, -472.3400754243168, -13.877034138464458, -20.953721790820953, -78.72563859285324, -207.00491234713192, 2.0000000000000013, -39.8896420271754, -53.655975258409896, -10.110568233893623, -82.29581375155043, 61.73117346111277, -428.3617703484708, -5.722879851316479, -471.81725399495605, 2.0000000000000013, -529.6127699609632, -79.07387046988492, -141.89131382857843, 2.0000000000000013, -305.10616817543973, 2.0000000000000013, 88.18157299495448, -181.53594292425677, -71.900332320775, -344.3985413834148, -9.851635199258672, -97.17583204969075, -165.5515898435631, -57.75378280567751, -39.69425512370417, -14.099708315183202, -3.9538415647034917, -15.492749408983032, -349.5960250525256, -131.53842252018853, -25.641073431801978, -56.94483244705995, -112.92629953413149, 2.0000000000000013, -175.4831647698604, -109.5803701528311, -91.23769658514587, -132.5444583058643, -39.65733311094437, -238.02515458683484, -149.20711193093948, -110.85168173850396, 14.476440906442544, -3.857745055145763, 86.08036936372449, 2.0000000000000013, -86.63310124252534, -248.85244703450934, 17.481133892707977, -80.41547380352276, -41.27140316016605, -22.930175543440804, -147.43324740717472, 24.993285806321452, -38.51171947817674, -16.620414727087322, -12.64453312859148, 53.599089670743695, -46.90059095304004, -6.647240569763598, -30.861423847644424, -287.5105568084533, -211.03271829496526, -563.2996492872435, -92.93430208522912, -32.67966586929169, -462.77440678812945, -28.701734559084652, -8.00847246136172, -34.872140654322216, -89.88715420776232, -109.68616542268279], "policy_predator_policy_reward": [810.6866246993145, 876.0697692980299, 46.703579820125455, 3.500520045771264, 13.70877411502672, 65.06715670932458, 20.43520154447105, 97.09390425920967, 567.9586583524393, 495.1721837781057, 48.68081448415816, 14.889521107201437, 180.94118133071265, 76.72363888550377, 62.2336172491145, 101.8317822151737, 426.94646899845, 419.01502133463146, 63.972396050656016, 37.15052393816587, 218.20109309539234, 284.80821385647295, 317.8895654074024, 89.73697194757801, 221.14148568820195, 550.7178192007248, 154.35241057257784, 188.9510397217421, 6.0761275370941785, 153.71507811632185, 38.763116582584054, 40.531207886845095, 76.07672346514747, 85.29381981350133, 56.58851198794608, 104.73009099214511, 54.6975907557379, 118.71779475234473, 267.07385955629763, 246.79444571806448, 73.29395524826397, 55.70911499319523, 411.59157288455117, 515.5728998899787, 463.7035450427276, 402.1162495282476, 347.8406552445901, 464.6208624823011, 89.9870050631852, 20.889892135722782, 21.217288819238288, 212.57485880009727, 149.80338836896885, 461.01733074010116, 234.12346182202833, 198.94593766631985, 17.819037094334142, 172.8086122759138, 151.98607196616612, 50.94271981223729, 89.39604191762515, 114.6393416484539, 544.1456253116047, 207.06206685684245, 634.5587198097118, 164.4106400833513, 66.28183971406685, 92.67220365326068, 38.14295783872531, 89.3214268829271, 103.74026523096495, 447.5752600777642, 221.38167060334516, 126.58481268317766, 186.40351436002575, 169.04154654202787, 44.78979795340125, 70.17021671892995, 320.865698637263, 223.71309519735232, 273.15551226729866, 273.15551226729866, 295.8175504635659, 125.73777273774489, 144.19526659589863, 192.26736623915937, 424.29652927491196, 75.82785729203697, 351.83121757686786, 223.49642113998704, 27.321685826324547, 9.242384046225386, 22.89953615766038, 9.796363884534491, 252.2231422829876, 384.98694254991733, 194.2381134830255, 91.87044369909269, 1.8021925160862389, 13.582770963256294, 189.15076771061493, 204.11151948568548, 54.70645180836674, 117.82440371427788, 81.9663297512541, 49.925235528493765, 265.2721945639861, 126.52234457149278, 24.613042488464433, 9.819996950623107, 78.63471284746281, 58.73269537219523, 723.8135750624173, 344.1270201992232, 168.68585031282373, 238.8806404569735, 322.6665739073953, 304.85905357601456, 85.47344466992615, 182.49310737083033, 212.9933565750156, 449.77686423136305, 557.7394419531639, 498.07810881045594, 63.667852047786596, 91.27126608079143, 308.0673116418546, 213.66295051076278, 10.67548589111834, 41.77964202717502, 59.05454358471346, 41.22682486321913, 156.88790127983654, 143.97439178514577, 276.81101059144044, 323.64825334046975, 362.538661729994, 388.00700289333054, 263.35310624747996, 365.52353418336867, 114.46000100289787, 74.59968230561095, 138.5017368140627, 268.627829345966, 43.33649008013868, 205.35757182427886, 455.25109684818335, 169.79645759188688, 5.361056483039816, 98.916268442415, 289.3234797004675, 239.57260195855167, 82.75883455419562, 118.74600568318164, 5.92384156470345, 17.442749408983246, 248.32647803410507, 282.56772542338734, 158.55618515637067, 182.63020609884467, 79.424352067672, 92.75266623847128, 188.1896167653893, 329.33263850435077, 125.60795971526639, 140.00166826858455, 253.77213475537883, 309.5319037787918, 155.16733923003835, 159.643239558695, 21.083559093557476, 5.827745055145721, 7.506603693554832, 21.75963063627579, 88.36310124252623, 291.5024470345088, 214.89950643960103, 190.51191006328307, 140.73984041967284, 49.13666334054658, 111.75464957116027, 201.66474384540055, 69.87213420526393, 21.853244089368573, 49.243347027729335, 80.38127413570871, 8.159279667582965, 53.29136642144717, 250.9559364756177, 111.6660441804797, 708.7554873171065, 566.4537622472083, 188.06688166169195, 117.49050910998314, 493.32981416886565, 77.0913827122793, 37.75214065432184, 9.968472461361678, 106.86878889751699, 123.19468003403328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5455895906136203, "mean_inference_ms": 1.355415215542869, "mean_action_processing_ms": 0.2338927220980878, "mean_env_wait_ms": 0.17814238327997436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004954338073730469, "StateBufferConnector_ms": 0.0029605627059936523, "ViewRequirementAgentConnector_ms": 0.10921382904052734}, "num_episodes": 18, "episode_return_max": 577.0701416841022, "episode_return_min": -114.52721104311594, "episode_return_mean": 153.705321688537, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.110095077133, "num_env_steps_trained_throughput_per_sec": 389.110095077133, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 88980.582, "restore_workers_time_ms": 0.012, "training_step_time_ms": 88980.545, "sample_time_ms": 1061.944, "learn_time_ms": 87905.55, "learn_throughput": 45.503, "synch_weights_time_ms": 12.174}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "1f15c_00000", "date": "2024-08-16_14-29-33", "timestamp": 1723798773, "time_this_iter_s": 10.283174276351929, "time_total_s": 1577.6561908721924, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f872430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1577.6561908721924, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 42.24666666666667, "ram_util_percent": 77.96000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6732672806454714, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.793098385876449, "policy_loss": -0.00476931546797493, "vf_loss": 4.797768584004155, "vf_explained_var": 0.02767651809586419, "kl": 0.007929099524395909, "entropy": 0.5416641427726342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9193617340118165, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.28107016830848, "policy_loss": -0.006866010843293259, "vf_loss": 4.286620142850927, "vf_explained_var": -0.3537606110963872, "kl": 0.011697971371140745, "entropy": 0.9304958028452737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 500.8768819821057, "episode_reward_min": -114.52721104311594, "episode_reward_mean": 139.95648931832827, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -681.263699866331, "predator_policy": 1.8021925160862389}, "policy_reward_max": {"prey_policy": 155.17632257666975, "predator_policy": 723.8135750624173}, "policy_reward_mean": {"prey_policy": -102.48008816903075, "predator_policy": 172.45833282819495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.507121196357787, 266.69447281600816, 202.2303015079729, 499.00008432734916, 378.0133515585347, 417.201336431508, 2.0688300194090634, 27.090000000000455, 35.13000000000003, 172.6833625961031, 134.99903709433465, 128.87923754883337, 71.23832010609192, -114.52721104311594, 98.0701802443678, 182.19608642932377, 196.50825852700257, 82.99793738338641, 117.49041960677856, 275.2967138016112, 3.739999999999966, 278.0808960510386, 483.2055122672986, 99.36906726675335, 204.43102108853844, 117.68747478536677, 119.05339192711762, 106.94367484626777, 12.252908859476875, 269.70983378785763, 158.94825578818674, -6.671278415871772, 101.73543924070171, 152.7516421643157, 31.968822158406063, 26.250000000000334, 11.974528423082468, 220.96684800600553, -83.46148599056525, 196.67432589656264, 311.84801754014035, 73.13891626961865, 325.02098251693866, 318.5489028262654, 120.10836219929276, 235.99971121263067, 14.565485891118257, 36.51482495562885, 280.29765277454317, 166.3746137321231, 280.72841062836767, 20.189999999999984, 49.16836947993118, 104.02339798458894, 155.33969197511567, 208.74868073588087, -2.750142323495549, 305.59070900977866, 147.71087679848893, 3.91999999999996, 49.75975588477853, 258.6004853763525, 61.2507187720103, 232.45872034704874, 41.82747309284069, 285.6215508363919, 54.7517851192899, 37.530000000000236, 117.34660369355564, 44.37999999999974, 342.477076592068, 125.67492505661336, 190.97943181570753, 36.593244089367865, 170.57917770559004, 7.902814566226832, 44.250000000000156, 500.8768819821057, 179.9434228171524, 78.94505553393067, 4.83999999999994, 30.49014930110391, 346.8185128700212, 134.79767849353675, -2.6144583328522453, 186.49307958255253, 315.6951659211892, 176.72058998542133, 126.36000000000038, 49.185839579612306, 320.4422224207497, 38.87800548942572, 0.33418994225787974, 62.08999999999963, 168.84739973266397, 72.25999999999996, 37.52858015509805, 4.739999999999942, 128.9349861069931, 74.59168479466742], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-95.99313504142891, -54.91512927029596, 32.348495187080566, -279.5223276454338, 118.41011105048054, -45.182879783966655, -39.981515642438225, -388.18287280474226, 0.02995424539472686, -487.8363972578346, -184.53236383649872, -210.72781745888472, -91.85396744581926, -16.954099733678408, -160.20439813371127, -46.49774948562575, -506.80819285773026, -68.88252625133899, -100.32892488861012, -160.0571120036369, 2.0000000000000013, -57.628612275913795, -62.55010175492621, -11.499452474643748, -89.1921808231734, -43.604882636815, -513.5618940638461, -352.17300914771636, -489.13742482775547, -211.7617548209405, -23.744511531176947, 46.986554593173715, 2.0000000000000013, 67.0438738053505, -288.5968217623251, -179.72076616301854, -243.36606367974446, 12.88999999999996, -45.89999590593425, -34.24835119450762, -42.90979795340162, -68.310216718929, -24.848302799696167, -241.6495949838793, -159.15551226729863, 96.05000000000018, -261.0056736570947, -61.180582277463216, -34.521994442839414, -97.5096173036799, -375.78620185827793, -6.650709923305163, -140.216421139987, -316.05782564975084, 68.37960497371775, 2.0000000000000013, -4.581399370163325, -15.861591812554373, 2.0000000000000013, -369.50025104504715, -129.1603013939312, 2.0000000000000013, -9.132093768765115, -12.924148126449193, -275.00829371929586, -16.518554236302883, -5.41036591277911, -14.368847445549683, -83.53156304601495, -16.39118007532629, -370.74650710737797, 5.201967971899043, -24.458511016004717, 2.0000000000000013, 2.0000000000000013, 81.59943978634814, -470.13838138587533, -681.263699866331, -59.57277501199693, -151.31938986123797, -71.23939057401286, -244.4382193692546, -191.22460247213053, -3.603033299007641, -65.73356469900567, -272.0156735904342, -264.9285725130376, -472.3400754243168, -13.877034138464458, -20.953721790820953, -78.72563859285324, -207.00491234713192, 2.0000000000000013, -39.8896420271754, -53.655975258409896, -10.110568233893623, -82.29581375155043, 61.73117346111277, -428.3617703484708, -5.722879851316479, -471.81725399495605, 2.0000000000000013, -529.6127699609632, -79.07387046988492, -141.89131382857843, 2.0000000000000013, -305.10616817543973, 2.0000000000000013, 88.18157299495448, -181.53594292425677, -71.900332320775, -344.3985413834148, -9.851635199258672, -97.17583204969075, -165.5515898435631, -57.75378280567751, -39.69425512370417, -14.099708315183202, -3.9538415647034917, -15.492749408983032, -349.5960250525256, -131.53842252018853, -25.641073431801978, -56.94483244705995, -112.92629953413149, 2.0000000000000013, -175.4831647698604, -109.5803701528311, -91.23769658514587, -132.5444583058643, -39.65733311094437, -238.02515458683484, -149.20711193093948, -110.85168173850396, 14.476440906442544, -3.857745055145763, 86.08036936372449, 2.0000000000000013, -86.63310124252534, -248.85244703450934, 17.481133892707977, -80.41547380352276, -41.27140316016605, -22.930175543440804, -147.43324740717472, 24.993285806321452, -38.51171947817674, -16.620414727087322, -12.64453312859148, 53.599089670743695, -46.90059095304004, -6.647240569763598, -30.861423847644424, -287.5105568084533, -211.03271829496526, -563.2996492872435, -92.93430208522912, -32.67966586929169, -462.77440678812945, -28.701734559084652, -8.00847246136172, -34.872140654322216, -89.88715420776232, -109.68616542268279, 155.17632257666975, 56.679494451960004, -1.056146979113219, -84.88730530750877, -240.77307746018076, -203.76559241019388, 2.0000000000000013, -16.83294305442085, 109.40813067611654, 24.464482340960373, -61.37872196781214, -0.7145366831485924, -35.91277083851072, 55.15935191096745, -73.2410185900609, -60.93686763375931, -279.0000841048201, 2.0000000000000013, -68.43021749418828, 2.0000000000000013, -18.861057938626182, -90.05425238972414, -57.17730375764492, -1.3163812512179855, 2.0000000000000013, -49.78667689518391, -325.72338004492224, 2.0000000000000013, 2.0000000000000013, -229.806661431579, -30.993508028190792, -58.98024188283661, 2.0000000000000013, 118.6558973178611, -252.79033242355214, -80.55698223595705], "policy_predator_policy_reward": [54.6975907557379, 118.71779475234473, 267.07385955629763, 246.79444571806448, 73.29395524826397, 55.70911499319523, 411.59157288455117, 515.5728998899787, 463.7035450427276, 402.1162495282476, 347.8406552445901, 464.6208624823011, 89.9870050631852, 20.889892135722782, 21.217288819238288, 212.57485880009727, 149.80338836896885, 461.01733074010116, 234.12346182202833, 198.94593766631985, 17.819037094334142, 172.8086122759138, 151.98607196616612, 50.94271981223729, 89.39604191762515, 114.6393416484539, 544.1456253116047, 207.06206685684245, 634.5587198097118, 164.4106400833513, 66.28183971406685, 92.67220365326068, 38.14295783872531, 89.3214268829271, 103.74026523096495, 447.5752600777642, 221.38167060334516, 126.58481268317766, 186.40351436002575, 169.04154654202787, 44.78979795340125, 70.17021671892995, 320.865698637263, 223.71309519735232, 273.15551226729866, 273.15551226729866, 295.8175504635659, 125.73777273774489, 144.19526659589863, 192.26736623915937, 424.29652927491196, 75.82785729203697, 351.83121757686786, 223.49642113998704, 27.321685826324547, 9.242384046225386, 22.89953615766038, 9.796363884534491, 252.2231422829876, 384.98694254991733, 194.2381134830255, 91.87044369909269, 1.8021925160862389, 13.582770963256294, 189.15076771061493, 204.11151948568548, 54.70645180836674, 117.82440371427788, 81.9663297512541, 49.925235528493765, 265.2721945639861, 126.52234457149278, 24.613042488464433, 9.819996950623107, 78.63471284746281, 58.73269537219523, 723.8135750624173, 344.1270201992232, 168.68585031282373, 238.8806404569735, 322.6665739073953, 304.85905357601456, 85.47344466992615, 182.49310737083033, 212.9933565750156, 449.77686423136305, 557.7394419531639, 498.07810881045594, 63.667852047786596, 91.27126608079143, 308.0673116418546, 213.66295051076278, 10.67548589111834, 41.77964202717502, 59.05454358471346, 41.22682486321913, 156.88790127983654, 143.97439178514577, 276.81101059144044, 323.64825334046975, 362.538661729994, 388.00700289333054, 263.35310624747996, 365.52353418336867, 114.46000100289787, 74.59968230561095, 138.5017368140627, 268.627829345966, 43.33649008013868, 205.35757182427886, 455.25109684818335, 169.79645759188688, 5.361056483039816, 98.916268442415, 289.3234797004675, 239.57260195855167, 82.75883455419562, 118.74600568318164, 5.92384156470345, 17.442749408983246, 248.32647803410507, 282.56772542338734, 158.55618515637067, 182.63020609884467, 79.424352067672, 92.75266623847128, 188.1896167653893, 329.33263850435077, 125.60795971526639, 140.00166826858455, 253.77213475537883, 309.5319037787918, 155.16733923003835, 159.643239558695, 21.083559093557476, 5.827745055145721, 7.506603693554832, 21.75963063627579, 88.36310124252623, 291.5024470345088, 214.89950643960103, 190.51191006328307, 140.73984041967284, 49.13666334054658, 111.75464957116027, 201.66474384540055, 69.87213420526393, 21.853244089368573, 49.243347027729335, 80.38127413570871, 8.159279667582965, 53.29136642144717, 250.9559364756177, 111.6660441804797, 708.7554873171065, 566.4537622472083, 188.06688166169195, 117.49050910998314, 493.32981416886565, 77.0913827122793, 37.75214065432184, 9.968472461361678, 106.86878889751699, 123.19468003403328, 65.37631949501886, 69.58637634637287, 111.71313158712158, 109.02799919303793, 343.8872313564842, 98.03698018103806, 122.8558030050299, 78.47021963194452, 93.32329299255981, 88.49925991155303, 77.64591666995423, 161.167931966428, 37.80277083851034, 69.3106480890325, 158.0946960198347, 25.269029783598523, 284.14907666779493, 313.2932298577762, 60.23121544973931, 45.077007533876326, 74.9086678052482, 34.34083246536124, 46.99454687698541, 73.58913813187768, 98.16362929305272, 118.47044733479476, 71.43985631367636, 324.5435237312457, 251.02621051779244, 14.309031068884202, 33.92350802819077, 60.79024188283627, 4.335613885595127, 3.9434749035363534, 194.72398088412683, 213.21501857005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5459079315589119, "mean_inference_ms": 1.35604557820455, "mean_action_processing_ms": 0.2339131551362717, "mean_env_wait_ms": 0.17815798352092876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004390239715576172, "StateBufferConnector_ms": 0.0028864145278930664, "ViewRequirementAgentConnector_ms": 0.10743308067321777}, "num_episodes": 18, "episode_return_max": 500.8768819821057, "episode_return_min": -114.52721104311594, "episode_return_mean": 139.95648931832827, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.60503358143643, "num_env_steps_trained_throughput_per_sec": 442.60503358143643, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 88994.507, "restore_workers_time_ms": 0.012, "training_step_time_ms": 88994.47, "sample_time_ms": 1067.382, "learn_time_ms": 87914.212, "learn_throughput": 45.499, "synch_weights_time_ms": 12.005}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "1f15c_00000", "date": "2024-08-16_14-29-42", "timestamp": 1723798782, "time_this_iter_s": 9.040387153625488, "time_total_s": 1586.6965780258179, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8cd940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1586.6965780258179, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 30.425, "ram_util_percent": 76.04166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.888442857650222, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8117359729040237, "policy_loss": -0.004988418605237726, "vf_loss": 2.816641326745351, "vf_explained_var": 0.04668682857795998, "kl": 0.006645466605331456, "entropy": 0.4614318823688245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.782581392671696, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.184371462953154, "policy_loss": -0.009104682740055655, "vf_loss": 4.192549266007842, "vf_explained_var": 0.25520623720512187, "kl": 0.00823882529362439, "entropy": 0.9017443076643363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 500.8768819821057, "episode_reward_min": -83.46148599056525, "episode_reward_mean": 120.82993875362622, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -681.263699866331, "predator_policy": 1.8021925160862389}, "policy_reward_max": {"prey_policy": 155.17632257666975, "predator_policy": 723.8135750624173}, "policy_reward_mean": {"prey_policy": -83.54781283082335, "predator_policy": 143.96278220763656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [483.2055122672986, 99.36906726675335, 204.43102108853844, 117.68747478536677, 119.05339192711762, 106.94367484626777, 12.252908859476875, 269.70983378785763, 158.94825578818674, -6.671278415871772, 101.73543924070171, 152.7516421643157, 31.968822158406063, 26.250000000000334, 11.974528423082468, 220.96684800600553, -83.46148599056525, 196.67432589656264, 311.84801754014035, 73.13891626961865, 325.02098251693866, 318.5489028262654, 120.10836219929276, 235.99971121263067, 14.565485891118257, 36.51482495562885, 280.29765277454317, 166.3746137321231, 280.72841062836767, 20.189999999999984, 49.16836947993118, 104.02339798458894, 155.33969197511567, 208.74868073588087, -2.750142323495549, 305.59070900977866, 147.71087679848893, 3.91999999999996, 49.75975588477853, 258.6004853763525, 61.2507187720103, 232.45872034704874, 41.82747309284069, 285.6215508363919, 54.7517851192899, 37.530000000000236, 117.34660369355564, 44.37999999999974, 342.477076592068, 125.67492505661336, 190.97943181570753, 36.593244089367865, 170.57917770559004, 7.902814566226832, 44.250000000000156, 500.8768819821057, 179.9434228171524, 78.94505553393067, 4.83999999999994, 30.49014930110391, 346.8185128700212, 134.79767849353675, -2.6144583328522453, 186.49307958255253, 315.6951659211892, 176.72058998542133, 126.36000000000038, 49.185839579612306, 320.4422224207497, 38.87800548942572, 0.33418994225787974, 62.08999999999963, 168.84739973266397, 72.25999999999996, 37.52858015509805, 4.739999999999942, 128.9349861069931, 74.59168479466742, 5.461832772349746, 134.24227275393105, 4.819999999999939, 40.299999999999855, -6.606076419064772, 3.8599999999999617, 3.90999999999996, 100.48000000000008, 107.42000000000031, 133.1648475811734, 119.17000000000081, 71.00000000000007, 197.11015925941598, -12.64802072171685, 3.8799999999999617, 49.12999999999977, 65.88429760795533, 120.50735702260967, 102.08245955559704, 3.9199999999999595, 180.1309546629099, 137.71359565753505], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-159.15551226729863, 96.05000000000018, -261.0056736570947, -61.180582277463216, -34.521994442839414, -97.5096173036799, -375.78620185827793, -6.650709923305163, -140.216421139987, -316.05782564975084, 68.37960497371775, 2.0000000000000013, -4.581399370163325, -15.861591812554373, 2.0000000000000013, -369.50025104504715, -129.1603013939312, 2.0000000000000013, -9.132093768765115, -12.924148126449193, -275.00829371929586, -16.518554236302883, -5.41036591277911, -14.368847445549683, -83.53156304601495, -16.39118007532629, -370.74650710737797, 5.201967971899043, -24.458511016004717, 2.0000000000000013, 2.0000000000000013, 81.59943978634814, -470.13838138587533, -681.263699866331, -59.57277501199693, -151.31938986123797, -71.23939057401286, -244.4382193692546, -191.22460247213053, -3.603033299007641, -65.73356469900567, -272.0156735904342, -264.9285725130376, -472.3400754243168, -13.877034138464458, -20.953721790820953, -78.72563859285324, -207.00491234713192, 2.0000000000000013, -39.8896420271754, -53.655975258409896, -10.110568233893623, -82.29581375155043, 61.73117346111277, -428.3617703484708, -5.722879851316479, -471.81725399495605, 2.0000000000000013, -529.6127699609632, -79.07387046988492, -141.89131382857843, 2.0000000000000013, -305.10616817543973, 2.0000000000000013, 88.18157299495448, -181.53594292425677, -71.900332320775, -344.3985413834148, -9.851635199258672, -97.17583204969075, -165.5515898435631, -57.75378280567751, -39.69425512370417, -14.099708315183202, -3.9538415647034917, -15.492749408983032, -349.5960250525256, -131.53842252018853, -25.641073431801978, -56.94483244705995, -112.92629953413149, 2.0000000000000013, -175.4831647698604, -109.5803701528311, -91.23769658514587, -132.5444583058643, -39.65733311094437, -238.02515458683484, -149.20711193093948, -110.85168173850396, 14.476440906442544, -3.857745055145763, 86.08036936372449, 2.0000000000000013, -86.63310124252534, -248.85244703450934, 17.481133892707977, -80.41547380352276, -41.27140316016605, -22.930175543440804, -147.43324740717472, 24.993285806321452, -38.51171947817674, -16.620414727087322, -12.64453312859148, 53.599089670743695, -46.90059095304004, -6.647240569763598, -30.861423847644424, -287.5105568084533, -211.03271829496526, -563.2996492872435, -92.93430208522912, -32.67966586929169, -462.77440678812945, -28.701734559084652, -8.00847246136172, -34.872140654322216, -89.88715420776232, -109.68616542268279, 155.17632257666975, 56.679494451960004, -1.056146979113219, -84.88730530750877, -240.77307746018076, -203.76559241019388, 2.0000000000000013, -16.83294305442085, 109.40813067611654, 24.464482340960373, -61.37872196781214, -0.7145366831485924, -35.91277083851072, 55.15935191096745, -73.2410185900609, -60.93686763375931, -279.0000841048201, 2.0000000000000013, -68.43021749418828, 2.0000000000000013, -18.861057938626182, -90.05425238972414, -57.17730375764492, -1.3163812512179855, 2.0000000000000013, -49.78667689518391, -325.72338004492224, 2.0000000000000013, 2.0000000000000013, -229.806661431579, -30.993508028190792, -58.98024188283661, 2.0000000000000013, 118.6558973178611, -252.79033242355214, -80.55698223595705, -97.84484524228145, -14.39691212537595, 9.919999999999959, 71.63864232443913, -2.399358857616022, -64.5606762699166, -420.37845187333875, -7.413779861469816, -44.53087203628474, -71.24040595031498, -20.08055546703073, -10.44857404957002, -12.245249230191655, -5.515961857020999, -186.01513735398422, 40.74635923552281, -93.9895387872961, -76.62288207896793, -69.3737306281459, -42.25902156136539, 55.146380674643176, -165.4221504070266, -7.371755072167833, 4.390284816837598, -120.35191135212091, 115.80758752114862, -22.426756184577975, -42.54900985041006, -11.630226436799479, -12.273719711749788, -12.913344215266465, -30.74753064337432, -179.81092375800247, -97.39270337191276, -149.32664850921117, 29.952153380107966, -4.320451717558445, -100.9990216362488, -5.825558057470831, -6.468246511029813, 1.0043714167373818, 93.34727933689612, -97.13375729292558, -10.374479285364755], "policy_predator_policy_reward": [273.15551226729866, 273.15551226729866, 295.8175504635659, 125.73777273774489, 144.19526659589863, 192.26736623915937, 424.29652927491196, 75.82785729203697, 351.83121757686786, 223.49642113998704, 27.321685826324547, 9.242384046225386, 22.89953615766038, 9.796363884534491, 252.2231422829876, 384.98694254991733, 194.2381134830255, 91.87044369909269, 1.8021925160862389, 13.582770963256294, 189.15076771061493, 204.11151948568548, 54.70645180836674, 117.82440371427788, 81.9663297512541, 49.925235528493765, 265.2721945639861, 126.52234457149278, 24.613042488464433, 9.819996950623107, 78.63471284746281, 58.73269537219523, 723.8135750624173, 344.1270201992232, 168.68585031282373, 238.8806404569735, 322.6665739073953, 304.85905357601456, 85.47344466992615, 182.49310737083033, 212.9933565750156, 449.77686423136305, 557.7394419531639, 498.07810881045594, 63.667852047786596, 91.27126608079143, 308.0673116418546, 213.66295051076278, 10.67548589111834, 41.77964202717502, 59.05454358471346, 41.22682486321913, 156.88790127983654, 143.97439178514577, 276.81101059144044, 323.64825334046975, 362.538661729994, 388.00700289333054, 263.35310624747996, 365.52353418336867, 114.46000100289787, 74.59968230561095, 138.5017368140627, 268.627829345966, 43.33649008013868, 205.35757182427886, 455.25109684818335, 169.79645759188688, 5.361056483039816, 98.916268442415, 289.3234797004675, 239.57260195855167, 82.75883455419562, 118.74600568318164, 5.92384156470345, 17.442749408983246, 248.32647803410507, 282.56772542338734, 158.55618515637067, 182.63020609884467, 79.424352067672, 92.75266623847128, 188.1896167653893, 329.33263850435077, 125.60795971526639, 140.00166826858455, 253.77213475537883, 309.5319037787918, 155.16733923003835, 159.643239558695, 21.083559093557476, 5.827745055145721, 7.506603693554832, 21.75963063627579, 88.36310124252623, 291.5024470345088, 214.89950643960103, 190.51191006328307, 140.73984041967284, 49.13666334054658, 111.75464957116027, 201.66474384540055, 69.87213420526393, 21.853244089368573, 49.243347027729335, 80.38127413570871, 8.159279667582965, 53.29136642144717, 250.9559364756177, 111.6660441804797, 708.7554873171065, 566.4537622472083, 188.06688166169195, 117.49050910998314, 493.32981416886565, 77.0913827122793, 37.75214065432184, 9.968472461361678, 106.86878889751699, 123.19468003403328, 65.37631949501886, 69.58637634637287, 111.71313158712158, 109.02799919303793, 343.8872313564842, 98.03698018103806, 122.8558030050299, 78.47021963194452, 93.32329299255981, 88.49925991155303, 77.64591666995423, 161.167931966428, 37.80277083851034, 69.3106480890325, 158.0946960198347, 25.269029783598523, 284.14907666779493, 313.2932298577762, 60.23121544973931, 45.077007533876326, 74.9086678052482, 34.34083246536124, 46.99454687698541, 73.58913813187768, 98.16362929305272, 118.47044733479476, 71.43985631367636, 324.5435237312457, 251.02621051779244, 14.309031068884202, 33.92350802819077, 60.79024188283627, 4.335613885595127, 3.9434749035363534, 194.72398088412683, 213.21501857005, 92.99628902513531, 24.707301114872863, 25.374793003415874, 27.308837426076117, 67.40067626991754, 4.37935885761598, 458.70845187333873, 9.383779861469774, 33.144795617219685, 76.02040595031589, 21.99055546703103, 12.398574049569978, 14.185249230191614, 7.485961857020957, 187.72513735398266, 58.023640764477115, 87.29589481944578, 190.73652604681862, 71.80038193635734, 172.99721783432798, 12.143619325356624, 217.3021504070258, 13.63894975130771, 60.34252050402248, 105.76007057524413, 95.89441251514576, 4.645656021434244, 47.68208929183687, 13.580226436799437, 14.203719711749747, 60.183344215266516, 32.607530643374396, 162.47069536549708, 180.61722937237138, 25.490335708402608, 214.39151644331005, 82.13387909838981, 125.26805381101475, 7.785558057470789, 8.428246511029773, 34.08395119862484, 51.695352710652784, 220.8042987291374, 24.4175335066873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5461016542858391, "mean_inference_ms": 1.356426195355567, "mean_action_processing_ms": 0.23359700017752474, "mean_env_wait_ms": 0.17810761891966995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003917694091796875, "StateBufferConnector_ms": 0.00290071964263916, "ViewRequirementAgentConnector_ms": 0.10152637958526611}, "num_episodes": 22, "episode_return_max": 500.8768819821057, "episode_return_min": -83.46148599056525, "episode_return_mean": 120.82993875362622, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.1097384727687, "num_env_steps_trained_throughput_per_sec": 449.1097384727687, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 88997.691, "restore_workers_time_ms": 0.012, "training_step_time_ms": 88997.654, "sample_time_ms": 1075.465, "learn_time_ms": 87909.388, "learn_throughput": 45.501, "synch_weights_time_ms": 11.899}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "1f15c_00000", "date": "2024-08-16_14-29-51", "timestamp": 1723798791, "time_this_iter_s": 8.909641981124878, "time_total_s": 1595.6062200069427, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8e2ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1595.6062200069427, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 26.353846153846153, "ram_util_percent": 75.93846153846152}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5391672188642795, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.217592653900227, "policy_loss": -0.007422052382826608, "vf_loss": 3.2249133429830037, "vf_explained_var": 0.002224543737986731, "kl": 0.008109180099027159, "entropy": 0.4801489803683821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4059853255118013, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.526679802067066, "policy_loss": -0.007826378441504425, "vf_loss": 5.5331620059946856, "vf_explained_var": 0.36271885683927585, "kl": 0.011948143672841251, "entropy": 0.994341563705414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 500.8768819821057, "episode_reward_min": -12.64802072171685, "episode_reward_mean": 121.65589334235852, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -563.2996492872435, "predator_policy": 3.3822022019999096}, "policy_reward_max": {"prey_policy": 155.17632257666975, "predator_policy": 708.7554873171065}, "policy_reward_mean": {"prey_policy": -67.5777454398956, "predator_policy": 128.40569211107496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.84801754014035, 73.13891626961865, 325.02098251693866, 318.5489028262654, 120.10836219929276, 235.99971121263067, 14.565485891118257, 36.51482495562885, 280.29765277454317, 166.3746137321231, 280.72841062836767, 20.189999999999984, 49.16836947993118, 104.02339798458894, 155.33969197511567, 208.74868073588087, -2.750142323495549, 305.59070900977866, 147.71087679848893, 3.91999999999996, 49.75975588477853, 258.6004853763525, 61.2507187720103, 232.45872034704874, 41.82747309284069, 285.6215508363919, 54.7517851192899, 37.530000000000236, 117.34660369355564, 44.37999999999974, 342.477076592068, 125.67492505661336, 190.97943181570753, 36.593244089367865, 170.57917770559004, 7.902814566226832, 44.250000000000156, 500.8768819821057, 179.9434228171524, 78.94505553393067, 4.83999999999994, 30.49014930110391, 346.8185128700212, 134.79767849353675, -2.6144583328522453, 186.49307958255253, 315.6951659211892, 176.72058998542133, 126.36000000000038, 49.185839579612306, 320.4422224207497, 38.87800548942572, 0.33418994225787974, 62.08999999999963, 168.84739973266397, 72.25999999999996, 37.52858015509805, 4.739999999999942, 128.9349861069931, 74.59168479466742, 5.461832772349746, 134.24227275393105, 4.819999999999939, 40.299999999999855, -6.606076419064772, 3.8599999999999617, 3.90999999999996, 100.48000000000008, 107.42000000000031, 133.1648475811734, 119.17000000000081, 71.00000000000007, 197.11015925941598, -12.64802072171685, 3.8799999999999617, 49.12999999999977, 65.88429760795533, 120.50735702260967, 102.08245955559704, 3.9199999999999595, 180.1309546629099, 137.71359565753505, 130.4271714057873, 27.35000000000048, 179.0661950240497, 125.40095319124825, -12.422639371009959, 204.66388897980147, 394.65358258893235, 113.81668949244943, 38.50999999999995, 264.7248635557098, -6.8076072509164955, 95.24534355112725, 284.70848909541957, 36.74226916586831, 42.30337326349776, 242.86735574069357, 135.33598847895414, 9.799524061116246], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-71.23939057401286, -244.4382193692546, -191.22460247213053, -3.603033299007641, -65.73356469900567, -272.0156735904342, -264.9285725130376, -472.3400754243168, -13.877034138464458, -20.953721790820953, -78.72563859285324, -207.00491234713192, 2.0000000000000013, -39.8896420271754, -53.655975258409896, -10.110568233893623, -82.29581375155043, 61.73117346111277, -428.3617703484708, -5.722879851316479, -471.81725399495605, 2.0000000000000013, -529.6127699609632, -79.07387046988492, -141.89131382857843, 2.0000000000000013, -305.10616817543973, 2.0000000000000013, 88.18157299495448, -181.53594292425677, -71.900332320775, -344.3985413834148, -9.851635199258672, -97.17583204969075, -165.5515898435631, -57.75378280567751, -39.69425512370417, -14.099708315183202, -3.9538415647034917, -15.492749408983032, -349.5960250525256, -131.53842252018853, -25.641073431801978, -56.94483244705995, -112.92629953413149, 2.0000000000000013, -175.4831647698604, -109.5803701528311, -91.23769658514587, -132.5444583058643, -39.65733311094437, -238.02515458683484, -149.20711193093948, -110.85168173850396, 14.476440906442544, -3.857745055145763, 86.08036936372449, 2.0000000000000013, -86.63310124252534, -248.85244703450934, 17.481133892707977, -80.41547380352276, -41.27140316016605, -22.930175543440804, -147.43324740717472, 24.993285806321452, -38.51171947817674, -16.620414727087322, -12.64453312859148, 53.599089670743695, -46.90059095304004, -6.647240569763598, -30.861423847644424, -287.5105568084533, -211.03271829496526, -563.2996492872435, -92.93430208522912, -32.67966586929169, -462.77440678812945, -28.701734559084652, -8.00847246136172, -34.872140654322216, -89.88715420776232, -109.68616542268279, 155.17632257666975, 56.679494451960004, -1.056146979113219, -84.88730530750877, -240.77307746018076, -203.76559241019388, 2.0000000000000013, -16.83294305442085, 109.40813067611654, 24.464482340960373, -61.37872196781214, -0.7145366831485924, -35.91277083851072, 55.15935191096745, -73.2410185900609, -60.93686763375931, -279.0000841048201, 2.0000000000000013, -68.43021749418828, 2.0000000000000013, -18.861057938626182, -90.05425238972414, -57.17730375764492, -1.3163812512179855, 2.0000000000000013, -49.78667689518391, -325.72338004492224, 2.0000000000000013, 2.0000000000000013, -229.806661431579, -30.993508028190792, -58.98024188283661, 2.0000000000000013, 118.6558973178611, -252.79033242355214, -80.55698223595705, -97.84484524228145, -14.39691212537595, 9.919999999999959, 71.63864232443913, -2.399358857616022, -64.5606762699166, -420.37845187333875, -7.413779861469816, -44.53087203628474, -71.24040595031498, -20.08055546703073, -10.44857404957002, -12.245249230191655, -5.515961857020999, -186.01513735398422, 40.74635923552281, -93.9895387872961, -76.62288207896793, -69.3737306281459, -42.25902156136539, 55.146380674643176, -165.4221504070266, -7.371755072167833, 4.390284816837598, -120.35191135212091, 115.80758752114862, -22.426756184577975, -42.54900985041006, -11.630226436799479, -12.273719711749788, -12.913344215266465, -30.74753064337432, -179.81092375800247, -97.39270337191276, -149.32664850921117, 29.952153380107966, -4.320451717558445, -100.9990216362488, -5.825558057470831, -6.468246511029813, 1.0043714167373818, 93.34727933689612, -97.13375729292558, -10.374479285364755, -88.97669124804065, 4.8301958707591455, -128.8639880666577, -18.56991883018658, 84.51918067973638, 28.793679788458032, -158.8786743137079, 114.86000000000017, -62.725052182858995, -19.620487095920566, -0.2398859588345248, 103.52544388110474, -183.37479151533904, -1.147667622828548, -108.91274592881558, -76.71851342801358, -6.332845167880635, -7.218861234076844, 92.49119609028949, -110.82612678657856, -27.253237675666192, -24.680259982345465, 88.13, -9.421528003156793, -248.29344460319166, 62.38999999999987, 2.0000000000000013, -82.6421719419808, 2.0000000000000013, 14.667886243994056, 73.26551412987303, 94.00206326450521, 80.27693936247401, 2.0000000000000013, -112.9445516057787, -76.83855792251946], "policy_predator_policy_reward": [322.6665739073953, 304.85905357601456, 85.47344466992615, 182.49310737083033, 212.9933565750156, 449.77686423136305, 557.7394419531639, 498.07810881045594, 63.667852047786596, 91.27126608079143, 308.0673116418546, 213.66295051076278, 10.67548589111834, 41.77964202717502, 59.05454358471346, 41.22682486321913, 156.88790127983654, 143.97439178514577, 276.81101059144044, 323.64825334046975, 362.538661729994, 388.00700289333054, 263.35310624747996, 365.52353418336867, 114.46000100289787, 74.59968230561095, 138.5017368140627, 268.627829345966, 43.33649008013868, 205.35757182427886, 455.25109684818335, 169.79645759188688, 5.361056483039816, 98.916268442415, 289.3234797004675, 239.57260195855167, 82.75883455419562, 118.74600568318164, 5.92384156470345, 17.442749408983246, 248.32647803410507, 282.56772542338734, 158.55618515637067, 182.63020609884467, 79.424352067672, 92.75266623847128, 188.1896167653893, 329.33263850435077, 125.60795971526639, 140.00166826858455, 253.77213475537883, 309.5319037787918, 155.16733923003835, 159.643239558695, 21.083559093557476, 5.827745055145721, 7.506603693554832, 21.75963063627579, 88.36310124252623, 291.5024470345088, 214.89950643960103, 190.51191006328307, 140.73984041967284, 49.13666334054658, 111.75464957116027, 201.66474384540055, 69.87213420526393, 21.853244089368573, 49.243347027729335, 80.38127413570871, 8.159279667582965, 53.29136642144717, 250.9559364756177, 111.6660441804797, 708.7554873171065, 566.4537622472083, 188.06688166169195, 117.49050910998314, 493.32981416886565, 77.0913827122793, 37.75214065432184, 9.968472461361678, 106.86878889751699, 123.19468003403328, 65.37631949501886, 69.58637634637287, 111.71313158712158, 109.02799919303793, 343.8872313564842, 98.03698018103806, 122.8558030050299, 78.47021963194452, 93.32329299255981, 88.49925991155303, 77.64591666995423, 161.167931966428, 37.80277083851034, 69.3106480890325, 158.0946960198347, 25.269029783598523, 284.14907666779493, 313.2932298577762, 60.23121544973931, 45.077007533876326, 74.9086678052482, 34.34083246536124, 46.99454687698541, 73.58913813187768, 98.16362929305272, 118.47044733479476, 71.43985631367636, 324.5435237312457, 251.02621051779244, 14.309031068884202, 33.92350802819077, 60.79024188283627, 4.335613885595127, 3.9434749035363534, 194.72398088412683, 213.21501857005, 92.99628902513531, 24.707301114872863, 25.374793003415874, 27.308837426076117, 67.40067626991754, 4.37935885761598, 458.70845187333873, 9.383779861469774, 33.144795617219685, 76.02040595031589, 21.99055546703103, 12.398574049569978, 14.185249230191614, 7.485961857020957, 187.72513735398266, 58.023640764477115, 87.29589481944578, 190.73652604681862, 71.80038193635734, 172.99721783432798, 12.143619325356624, 217.3021504070258, 13.63894975130771, 60.34252050402248, 105.76007057524413, 95.89441251514576, 4.645656021434244, 47.68208929183687, 13.580226436799437, 14.203719711749747, 60.183344215266516, 32.607530643374396, 162.47069536549708, 180.61722937237138, 25.490335708402608, 214.39151644331005, 82.13387909838981, 125.26805381101475, 7.785558057470789, 8.428246511029773, 34.08395119862484, 51.695352710652784, 220.8042987291374, 24.4175335066873, 115.19693128563276, 99.3767354974376, 119.10406407342838, 55.67984282341549, 33.476501949987984, 32.276832605867476, 10.725216582923597, 158.69441092203056, 29.099368239586408, 40.823531668183215, 62.774442077729596, 38.60388897980148, 305.8963762335341, 273.2796654935661, 212.9762070413095, 86.47174180796891, 42.882845167880326, 9.178861234076802, 144.11622426895113, 138.94356998304897, 10.343681168713548, 34.782209238382286, 11.39152800315675, 5.145343551127164, 194.39119517422512, 276.22073852438683, 32.912269165869034, 84.47217194198174, 22.25328481750368, 3.3822022019999096, 38.50430852535205, 37.09546982096324, 41.27431371921684, 11.784735397262441, 97.38485713702245, 102.19777645239368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5463649126527718, "mean_inference_ms": 1.357190596767748, "mean_action_processing_ms": 0.23392147915567954, "mean_env_wait_ms": 0.1782366162801891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00349581241607666, "StateBufferConnector_ms": 0.002882719039916992, "ViewRequirementAgentConnector_ms": 0.10095417499542236}, "num_episodes": 18, "episode_return_max": 500.8768819821057, "episode_return_min": -12.64802072171685, "episode_return_mean": 121.65589334235852, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.09598240603975, "num_env_steps_trained_throughput_per_sec": 436.09598240603975, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 89011.959, "restore_workers_time_ms": 0.012, "training_step_time_ms": 89011.922, "sample_time_ms": 1067.917, "learn_time_ms": 87931.061, "learn_throughput": 45.49, "synch_weights_time_ms": 12.027}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "1f15c_00000", "date": "2024-08-16_14-30-00", "timestamp": 1723798800, "time_this_iter_s": 9.17579984664917, "time_total_s": 1604.782019853592, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffaa3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1604.782019853592, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 28.007692307692306, "ram_util_percent": 75.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.551019183889268, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8789407426087315, "policy_loss": -0.004856663352992169, "vf_loss": 3.8836369399671202, "vf_explained_var": 0.0290861274830248, "kl": 0.012837501844712157, "entropy": 0.41855945948255124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.638643471841459, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.590465909463388, "policy_loss": -0.008649793723795228, "vf_loss": 5.597557986981023, "vf_explained_var": 0.04827105648933895, "kl": 0.013846328670319671, "entropy": 0.9716165200112358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 500.8768819821057, "episode_reward_min": -53.74123626373048, "episode_reward_mean": 111.87391864352087, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -563.2996492872435, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.17632257666975, "predator_policy": 708.7554873171065}, "policy_reward_mean": {"prey_policy": -46.665413500065235, "predator_policy": 102.60237282182574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [232.45872034704874, 41.82747309284069, 285.6215508363919, 54.7517851192899, 37.530000000000236, 117.34660369355564, 44.37999999999974, 342.477076592068, 125.67492505661336, 190.97943181570753, 36.593244089367865, 170.57917770559004, 7.902814566226832, 44.250000000000156, 500.8768819821057, 179.9434228171524, 78.94505553393067, 4.83999999999994, 30.49014930110391, 346.8185128700212, 134.79767849353675, -2.6144583328522453, 186.49307958255253, 315.6951659211892, 176.72058998542133, 126.36000000000038, 49.185839579612306, 320.4422224207497, 38.87800548942572, 0.33418994225787974, 62.08999999999963, 168.84739973266397, 72.25999999999996, 37.52858015509805, 4.739999999999942, 128.9349861069931, 74.59168479466742, 5.461832772349746, 134.24227275393105, 4.819999999999939, 40.299999999999855, -6.606076419064772, 3.8599999999999617, 3.90999999999996, 100.48000000000008, 107.42000000000031, 133.1648475811734, 119.17000000000081, 71.00000000000007, 197.11015925941598, -12.64802072171685, 3.8799999999999617, 49.12999999999977, 65.88429760795533, 120.50735702260967, 102.08245955559704, 3.9199999999999595, 180.1309546629099, 137.71359565753505, 130.4271714057873, 27.35000000000048, 179.0661950240497, 125.40095319124825, -12.422639371009959, 204.66388897980147, 394.65358258893235, 113.81668949244943, 38.50999999999995, 264.7248635557098, -6.8076072509164955, 95.24534355112725, 284.70848909541957, 36.74226916586831, 42.30337326349776, 242.86735574069357, 135.33598847895414, 9.799524061116246, 95.3800000000003, 217.83964368248755, 64.67129828153898, 169.77573066357425, 186.41880082814882, 80.37000000000006, -53.74123626373048, 6.205042432424403, 186.61062598119074, 260.1541079544083, 106.4300000000004, 221.05762576874656, 156.06094426012328, 246.92000000000021, 85.86000000000034, 97.75000000000024, 7.972378092443483, 85.91000000000005, 129.26229312279702, 75.28826835124572, 7.76999999999992, 89.6900000000005, 22.8454312009306], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-175.4831647698604, -109.5803701528311, -91.23769658514587, -132.5444583058643, -39.65733311094437, -238.02515458683484, -149.20711193093948, -110.85168173850396, 14.476440906442544, -3.857745055145763, 86.08036936372449, 2.0000000000000013, -86.63310124252534, -248.85244703450934, 17.481133892707977, -80.41547380352276, -41.27140316016605, -22.930175543440804, -147.43324740717472, 24.993285806321452, -38.51171947817674, -16.620414727087322, -12.64453312859148, 53.599089670743695, -46.90059095304004, -6.647240569763598, -30.861423847644424, -287.5105568084533, -211.03271829496526, -563.2996492872435, -92.93430208522912, -32.67966586929169, -462.77440678812945, -28.701734559084652, -8.00847246136172, -34.872140654322216, -89.88715420776232, -109.68616542268279, 155.17632257666975, 56.679494451960004, -1.056146979113219, -84.88730530750877, -240.77307746018076, -203.76559241019388, 2.0000000000000013, -16.83294305442085, 109.40813067611654, 24.464482340960373, -61.37872196781214, -0.7145366831485924, -35.91277083851072, 55.15935191096745, -73.2410185900609, -60.93686763375931, -279.0000841048201, 2.0000000000000013, -68.43021749418828, 2.0000000000000013, -18.861057938626182, -90.05425238972414, -57.17730375764492, -1.3163812512179855, 2.0000000000000013, -49.78667689518391, -325.72338004492224, 2.0000000000000013, 2.0000000000000013, -229.806661431579, -30.993508028190792, -58.98024188283661, 2.0000000000000013, 118.6558973178611, -252.79033242355214, -80.55698223595705, -97.84484524228145, -14.39691212537595, 9.919999999999959, 71.63864232443913, -2.399358857616022, -64.5606762699166, -420.37845187333875, -7.413779861469816, -44.53087203628474, -71.24040595031498, -20.08055546703073, -10.44857404957002, -12.245249230191655, -5.515961857020999, -186.01513735398422, 40.74635923552281, -93.9895387872961, -76.62288207896793, -69.3737306281459, -42.25902156136539, 55.146380674643176, -165.4221504070266, -7.371755072167833, 4.390284816837598, -120.35191135212091, 115.80758752114862, -22.426756184577975, -42.54900985041006, -11.630226436799479, -12.273719711749788, -12.913344215266465, -30.74753064337432, -179.81092375800247, -97.39270337191276, -149.32664850921117, 29.952153380107966, -4.320451717558445, -100.9990216362488, -5.825558057470831, -6.468246511029813, 1.0043714167373818, 93.34727933689612, -97.13375729292558, -10.374479285364755, -88.97669124804065, 4.8301958707591455, -128.8639880666577, -18.56991883018658, 84.51918067973638, 28.793679788458032, -158.8786743137079, 114.86000000000017, -62.725052182858995, -19.620487095920566, -0.2398859588345248, 103.52544388110474, -183.37479151533904, -1.147667622828548, -108.91274592881558, -76.71851342801358, -6.332845167880635, -7.218861234076844, 92.49119609028949, -110.82612678657856, -27.253237675666192, -24.680259982345465, 88.13, -9.421528003156793, -248.29344460319166, 62.38999999999987, 2.0000000000000013, -82.6421719419808, 2.0000000000000013, 14.667886243994056, 73.26551412987303, 94.00206326450521, 80.27693936247401, 2.0000000000000013, -112.9445516057787, -76.83855792251946, -150.25557105460365, -6.0149035412552205, 53.73764136080002, 69.23223240895852, 2.0000000000000013, -86.04799713039769, -150.7389795776789, -292.90791190244363, 3.979999999999958, 42.52452778501359, -81.51140521780889, -42.81324978684213, -174.11936189046554, -310.82526881134453, -2.249048423077766, 2.0000000000000013, 35.35183859661762, 17.55461257492228, 45.889191899650065, 14.78239386266806, 53.822253252038436, -129.30106391234136, 25.43240937202951, 26.034646556793046, -15.504356006862125, 148.03199678340934, -66.36567665785785, 53.408710233551695, 66.46307547963049, -89.20469683285741, -70.84943797429541, 81.80837197869992, -9.305200993301012, 2.0000000000000013, 30.663637827934235, -2.842349408423848, -14.1416615357295, 100.16606322840303, -34.721852885579324, -319.08942493494885, -54.258155759251125, -32.956088015217034, 46.01568939202107, -56.30138360743762, -43.630683084905435, -74.24175786210567], "policy_predator_policy_reward": [188.1896167653893, 329.33263850435077, 125.60795971526639, 140.00166826858455, 253.77213475537883, 309.5319037787918, 155.16733923003835, 159.643239558695, 21.083559093557476, 5.827745055145721, 7.506603693554832, 21.75963063627579, 88.36310124252623, 291.5024470345088, 214.89950643960103, 190.51191006328307, 140.73984041967284, 49.13666334054658, 111.75464957116027, 201.66474384540055, 69.87213420526393, 21.853244089368573, 49.243347027729335, 80.38127413570871, 8.159279667582965, 53.29136642144717, 250.9559364756177, 111.6660441804797, 708.7554873171065, 566.4537622472083, 188.06688166169195, 117.49050910998314, 493.32981416886565, 77.0913827122793, 37.75214065432184, 9.968472461361678, 106.86878889751699, 123.19468003403328, 65.37631949501886, 69.58637634637287, 111.71313158712158, 109.02799919303793, 343.8872313564842, 98.03698018103806, 122.8558030050299, 78.47021963194452, 93.32329299255981, 88.49925991155303, 77.64591666995423, 161.167931966428, 37.80277083851034, 69.3106480890325, 158.0946960198347, 25.269029783598523, 284.14907666779493, 313.2932298577762, 60.23121544973931, 45.077007533876326, 74.9086678052482, 34.34083246536124, 46.99454687698541, 73.58913813187768, 98.16362929305272, 118.47044733479476, 71.43985631367636, 324.5435237312457, 251.02621051779244, 14.309031068884202, 33.92350802819077, 60.79024188283627, 4.335613885595127, 3.9434749035363534, 194.72398088412683, 213.21501857005, 92.99628902513531, 24.707301114872863, 25.374793003415874, 27.308837426076117, 67.40067626991754, 4.37935885761598, 458.70845187333873, 9.383779861469774, 33.144795617219685, 76.02040595031589, 21.99055546703103, 12.398574049569978, 14.185249230191614, 7.485961857020957, 187.72513735398266, 58.023640764477115, 87.29589481944578, 190.73652604681862, 71.80038193635734, 172.99721783432798, 12.143619325356624, 217.3021504070258, 13.63894975130771, 60.34252050402248, 105.76007057524413, 95.89441251514576, 4.645656021434244, 47.68208929183687, 13.580226436799437, 14.203719711749747, 60.183344215266516, 32.607530643374396, 162.47069536549708, 180.61722937237138, 25.490335708402608, 214.39151644331005, 82.13387909838981, 125.26805381101475, 7.785558057470789, 8.428246511029773, 34.08395119862484, 51.695352710652784, 220.8042987291374, 24.4175335066873, 115.19693128563276, 99.3767354974376, 119.10406407342838, 55.67984282341549, 33.476501949987984, 32.276832605867476, 10.725216582923597, 158.69441092203056, 29.099368239586408, 40.823531668183215, 62.774442077729596, 38.60388897980148, 305.8963762335341, 273.2796654935661, 212.9762070413095, 86.47174180796891, 42.882845167880326, 9.178861234076802, 144.11622426895113, 138.94356998304897, 10.343681168713548, 34.782209238382286, 11.39152800315675, 5.145343551127164, 194.39119517422512, 276.22073852438683, 32.912269165869034, 84.47217194198174, 22.25328481750368, 3.3822022019999096, 38.50430852535205, 37.09546982096324, 41.27431371921684, 11.784735397262441, 97.38485713702245, 102.19777645239368, 243.6655710546039, 7.9849035412551785, 53.13575530021822, 41.73401461251033, 39.512441545455765, 109.20685386648188, 181.98733306947904, 431.4352890742173, 68.8617371431208, 71.05253590001459, 151.07393471495234, 53.620720289698056, 110.01667152876018, 321.18672290931863, 4.133301278005532, 2.320789577496679, 114.39806275250976, 19.306112057141544, 82.44543267994722, 117.03708951214372, 130.94106391234172, 50.967746747961606, 82.6908644310471, 86.89970540887818, 17.45435600686234, 6.0789474767141485, 259.8769664243058, 0.0, 17.61692452036947, 90.98469683285829, 72.62943797429632, 14.161628021300036, 4.574564344180105, 10.70301474156443, 53.266362172065826, 4.822349408423806, 17.781228252682048, 25.456663177441303, 384.34551433887435, 44.754031832899095, 34.88608801521665, 60.09815575925076, 25.139747694041443, 74.83594652137484, 63.19155311077577, 77.52631903716592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.546766230723837, "mean_inference_ms": 1.3580620683855964, "mean_action_processing_ms": 0.23390950289138515, "mean_env_wait_ms": 0.17826276553208206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034067630767822266, "StateBufferConnector_ms": 0.002891063690185547, "ViewRequirementAgentConnector_ms": 0.10152077674865723}, "num_episodes": 23, "episode_return_max": 500.8768819821057, "episode_return_min": -53.74123626373048, "episode_return_mean": 111.87391864352087, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.9707750777189, "num_env_steps_trained_throughput_per_sec": 442.9707750777189, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 45670.944, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45670.907, "sample_time_ms": 1067.676, "learn_time_ms": 44590.254, "learn_throughput": 89.706, "synch_weights_time_ms": 12.067}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "1f15c_00000", "date": "2024-08-16_14-30-09", "timestamp": 1723798809, "time_this_iter_s": 9.033457040786743, "time_total_s": 1613.8154768943787, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffaab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1613.8154768943787, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 25.3923076923077, "ram_util_percent": 75.47692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9593149945534096, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.005254607982736, "policy_loss": -0.007963928008555539, "vf_loss": 4.013085031130958, "vf_explained_var": 0.015983691764256312, "kl": 0.010681548810712272, "entropy": 0.5550215551935176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.165553688719159, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.424985916021639, "policy_loss": -0.005305142024600948, "vf_loss": 5.4291027600172335, "vf_explained_var": 0.3828970017887297, "kl": 0.010562594360725019, "entropy": 0.8895021114399824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 394.65358258893235, "episode_reward_min": -67.24917015903958, "episode_reward_mean": 104.51372750216609, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -420.37845187333875, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.17632257666975, "predator_policy": 458.70845187333873}, "policy_reward_mean": {"prey_policy": -35.5307106313278, "predator_policy": 87.78757438241085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.49014930110391, 346.8185128700212, 134.79767849353675, -2.6144583328522453, 186.49307958255253, 315.6951659211892, 176.72058998542133, 126.36000000000038, 49.185839579612306, 320.4422224207497, 38.87800548942572, 0.33418994225787974, 62.08999999999963, 168.84739973266397, 72.25999999999996, 37.52858015509805, 4.739999999999942, 128.9349861069931, 74.59168479466742, 5.461832772349746, 134.24227275393105, 4.819999999999939, 40.299999999999855, -6.606076419064772, 3.8599999999999617, 3.90999999999996, 100.48000000000008, 107.42000000000031, 133.1648475811734, 119.17000000000081, 71.00000000000007, 197.11015925941598, -12.64802072171685, 3.8799999999999617, 49.12999999999977, 65.88429760795533, 120.50735702260967, 102.08245955559704, 3.9199999999999595, 180.1309546629099, 137.71359565753505, 130.4271714057873, 27.35000000000048, 179.0661950240497, 125.40095319124825, -12.422639371009959, 204.66388897980147, 394.65358258893235, 113.81668949244943, 38.50999999999995, 264.7248635557098, -6.8076072509164955, 95.24534355112725, 284.70848909541957, 36.74226916586831, 42.30337326349776, 242.86735574069357, 135.33598847895414, 9.799524061116246, 95.3800000000003, 217.83964368248755, 64.67129828153898, 169.77573066357425, 186.41880082814882, 80.37000000000006, -53.74123626373048, 6.205042432424403, 186.61062598119074, 260.1541079544083, 106.4300000000004, 221.05762576874656, 156.06094426012328, 246.92000000000021, 85.86000000000034, 97.75000000000024, 7.972378092443483, 85.91000000000005, 129.26229312279702, 75.28826835124572, 7.76999999999992, 89.6900000000005, 22.8454312009306, -67.24917015903958, 95.88000000000076, 217.91899954427447, 205.48999999999953, 156.03765714404867, 171.53640104828338, 240.7592245167934, 84.53000000000016, 74.9100000000001, -16.397462728430316, 69.49308644400462, 12.455401653522882, 17.740000000000247, 109.48000000000049, -20.602649053595098, 152.45463902269574, 121.31000000000057, 135.2129216798519], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-89.88715420776232, -109.68616542268279, 155.17632257666975, 56.679494451960004, -1.056146979113219, -84.88730530750877, -240.77307746018076, -203.76559241019388, 2.0000000000000013, -16.83294305442085, 109.40813067611654, 24.464482340960373, -61.37872196781214, -0.7145366831485924, -35.91277083851072, 55.15935191096745, -73.2410185900609, -60.93686763375931, -279.0000841048201, 2.0000000000000013, -68.43021749418828, 2.0000000000000013, -18.861057938626182, -90.05425238972414, -57.17730375764492, -1.3163812512179855, 2.0000000000000013, -49.78667689518391, -325.72338004492224, 2.0000000000000013, 2.0000000000000013, -229.806661431579, -30.993508028190792, -58.98024188283661, 2.0000000000000013, 118.6558973178611, -252.79033242355214, -80.55698223595705, -97.84484524228145, -14.39691212537595, 9.919999999999959, 71.63864232443913, -2.399358857616022, -64.5606762699166, -420.37845187333875, -7.413779861469816, -44.53087203628474, -71.24040595031498, -20.08055546703073, -10.44857404957002, -12.245249230191655, -5.515961857020999, -186.01513735398422, 40.74635923552281, -93.9895387872961, -76.62288207896793, -69.3737306281459, -42.25902156136539, 55.146380674643176, -165.4221504070266, -7.371755072167833, 4.390284816837598, -120.35191135212091, 115.80758752114862, -22.426756184577975, -42.54900985041006, -11.630226436799479, -12.273719711749788, -12.913344215266465, -30.74753064337432, -179.81092375800247, -97.39270337191276, -149.32664850921117, 29.952153380107966, -4.320451717558445, -100.9990216362488, -5.825558057470831, -6.468246511029813, 1.0043714167373818, 93.34727933689612, -97.13375729292558, -10.374479285364755, -88.97669124804065, 4.8301958707591455, -128.8639880666577, -18.56991883018658, 84.51918067973638, 28.793679788458032, -158.8786743137079, 114.86000000000017, -62.725052182858995, -19.620487095920566, -0.2398859588345248, 103.52544388110474, -183.37479151533904, -1.147667622828548, -108.91274592881558, -76.71851342801358, -6.332845167880635, -7.218861234076844, 92.49119609028949, -110.82612678657856, -27.253237675666192, -24.680259982345465, 88.13, -9.421528003156793, -248.29344460319166, 62.38999999999987, 2.0000000000000013, -82.6421719419808, 2.0000000000000013, 14.667886243994056, 73.26551412987303, 94.00206326450521, 80.27693936247401, 2.0000000000000013, -112.9445516057787, -76.83855792251946, -150.25557105460365, -6.0149035412552205, 53.73764136080002, 69.23223240895852, 2.0000000000000013, -86.04799713039769, -150.7389795776789, -292.90791190244363, 3.979999999999958, 42.52452778501359, -81.51140521780889, -42.81324978684213, -174.11936189046554, -310.82526881134453, -2.249048423077766, 2.0000000000000013, 35.35183859661762, 17.55461257492228, 45.889191899650065, 14.78239386266806, 53.822253252038436, -129.30106391234136, 25.43240937202951, 26.034646556793046, -15.504356006862125, 148.03199678340934, -66.36567665785785, 53.408710233551695, 66.46307547963049, -89.20469683285741, -70.84943797429541, 81.80837197869992, -9.305200993301012, 2.0000000000000013, 30.663637827934235, -2.842349408423848, -14.1416615357295, 100.16606322840303, -34.721852885579324, -319.08942493494885, -54.258155759251125, -32.956088015217034, 46.01568939202107, -56.30138360743762, -43.630683084905435, -74.24175786210567, -83.3445824736559, -118.01144585143844, 2.0000000000000013, 22.595440495736987, 101.00000000000007, -33.51956679952202, 18.385229802900568, 61.10546554349173, -55.05279477060649, -45.59407354242044, 110.49275124344582, -40.58083222956064, -207.51561966487057, -200.79917428525306, -132.36011391540114, -21.343595054872836, 5.377994112000836, -7.098363031991189, -157.67281137629266, -70.09286918681528, -79.5661807749479, -0.2964201836483793, -32.87751313242805, 2.0000000000000013, -5.163819961111747, -9.487802625110294, -155.32776474300388, 65.83601594545749, -46.0280019610407, -84.51676608592541, -2.023975490454024, 76.68706247935859, -78.85743999924533, 53.265656542838904, 2.0000000000000013, 19.976670422020362], "policy_predator_policy_reward": [106.86878889751699, 123.19468003403328, 65.37631949501886, 69.58637634637287, 111.71313158712158, 109.02799919303793, 343.8872313564842, 98.03698018103806, 122.8558030050299, 78.47021963194452, 93.32329299255981, 88.49925991155303, 77.64591666995423, 161.167931966428, 37.80277083851034, 69.3106480890325, 158.0946960198347, 25.269029783598523, 284.14907666779493, 313.2932298577762, 60.23121544973931, 45.077007533876326, 74.9086678052482, 34.34083246536124, 46.99454687698541, 73.58913813187768, 98.16362929305272, 118.47044733479476, 71.43985631367636, 324.5435237312457, 251.02621051779244, 14.309031068884202, 33.92350802819077, 60.79024188283627, 4.335613885595127, 3.9434749035363534, 194.72398088412683, 213.21501857005, 92.99628902513531, 24.707301114872863, 25.374793003415874, 27.308837426076117, 67.40067626991754, 4.37935885761598, 458.70845187333873, 9.383779861469774, 33.144795617219685, 76.02040595031589, 21.99055546703103, 12.398574049569978, 14.185249230191614, 7.485961857020957, 187.72513735398266, 58.023640764477115, 87.29589481944578, 190.73652604681862, 71.80038193635734, 172.99721783432798, 12.143619325356624, 217.3021504070258, 13.63894975130771, 60.34252050402248, 105.76007057524413, 95.89441251514576, 4.645656021434244, 47.68208929183687, 13.580226436799437, 14.203719711749747, 60.183344215266516, 32.607530643374396, 162.47069536549708, 180.61722937237138, 25.490335708402608, 214.39151644331005, 82.13387909838981, 125.26805381101475, 7.785558057470789, 8.428246511029773, 34.08395119862484, 51.695352710652784, 220.8042987291374, 24.4175335066873, 115.19693128563276, 99.3767354974376, 119.10406407342838, 55.67984282341549, 33.476501949987984, 32.276832605867476, 10.725216582923597, 158.69441092203056, 29.099368239586408, 40.823531668183215, 62.774442077729596, 38.60388897980148, 305.8963762335341, 273.2796654935661, 212.9762070413095, 86.47174180796891, 42.882845167880326, 9.178861234076802, 144.11622426895113, 138.94356998304897, 10.343681168713548, 34.782209238382286, 11.39152800315675, 5.145343551127164, 194.39119517422512, 276.22073852438683, 32.912269165869034, 84.47217194198174, 22.25328481750368, 3.3822022019999096, 38.50430852535205, 37.09546982096324, 41.27431371921684, 11.784735397262441, 97.38485713702245, 102.19777645239368, 243.6655710546039, 7.9849035412551785, 53.13575530021822, 41.73401461251033, 39.512441545455765, 109.20685386648188, 181.98733306947904, 431.4352890742173, 68.8617371431208, 71.05253590001459, 151.07393471495234, 53.620720289698056, 110.01667152876018, 321.18672290931863, 4.133301278005532, 2.320789577496679, 114.39806275250976, 19.306112057141544, 82.44543267994722, 117.03708951214372, 130.94106391234172, 50.967746747961606, 82.6908644310471, 86.89970540887818, 17.45435600686234, 6.0789474767141485, 259.8769664243058, 0.0, 17.61692452036947, 90.98469683285829, 72.62943797429632, 14.161628021300036, 4.574564344180105, 10.70301474156443, 53.266362172065826, 4.822349408423806, 17.781228252682048, 25.456663177441303, 384.34551433887435, 44.754031832899095, 34.88608801521665, 60.09815575925076, 25.139747694041443, 74.83594652137484, 63.19155311077577, 77.52631903716592, 125.18164642811954, 8.925211737935356, 10.365283023139288, 60.91927648112386, 39.777041859876384, 110.66152448392066, 71.01237439001032, 54.98693026359736, 153.1125253847256, 103.57200007234927, 53.89019705778265, 47.73428497661589, 350.3852865144773, 298.68873195243964, 102.15104216240391, 136.08266680787062, 11.309045672827668, 65.32132324716277, 49.74490529960155, 161.62331253507477, 30.572219001032344, 118.78346840156871, 10.298777017512021, 33.034137768438804, 32.39162258622197, 0.0, 41.913984054542475, 157.0577647430023, 102.21002495241099, 7.732094040960015, 44.66471857247764, 33.1268334613135, 66.34434345716097, 80.55743999924549, 33.9769185679745, 79.25933268985662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5463041032572158, "mean_inference_ms": 1.3566870176440444, "mean_action_processing_ms": 0.23366816393519874, "mean_env_wait_ms": 0.17805872882514953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033513307571411133, "StateBufferConnector_ms": 0.0028228759765625, "ViewRequirementAgentConnector_ms": 0.08377039432525635}, "num_episodes": 18, "episode_return_max": 394.65358258893235, "episode_return_min": -67.24917015903958, "episode_return_mean": 104.51372750216609, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.0280641387853, "num_env_steps_trained_throughput_per_sec": 438.0280641387853, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 45677.153, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45677.116, "sample_time_ms": 1063.999, "learn_time_ms": 44600.182, "learn_throughput": 89.686, "synch_weights_time_ms": 12.021}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "1f15c_00000", "date": "2024-08-16_14-30-18", "timestamp": 1723798818, "time_this_iter_s": 9.135110139846802, "time_total_s": 1622.9505870342255, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffaae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1622.9505870342255, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 24.39230769230769, "ram_util_percent": 75.35384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1881206047598014, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.109762467909111, "policy_loss": -0.004959189572997352, "vf_loss": 4.114567375056958, "vf_explained_var": 0.034363475457701104, "kl": 0.012342002237234442, "entropy": 0.4790067867469535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.363360030436642, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.813616614366965, "policy_loss": -0.0066195720520915175, "vf_loss": 5.818946939801413, "vf_explained_var": 0.18999967215553162, "kl": 0.011459891940728599, "entropy": 0.975988362232844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 510.6048678133588, "episode_reward_min": -67.24917015903958, "episode_reward_mean": 110.7880005518608, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -511.1738878078078, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 148.03199678340934, "predator_policy": 517.4726749986977}, "policy_reward_mean": {"prey_policy": -33.073039898451206, "predator_policy": 88.46704017438158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.299999999999855, -6.606076419064772, 3.8599999999999617, 3.90999999999996, 100.48000000000008, 107.42000000000031, 133.1648475811734, 119.17000000000081, 71.00000000000007, 197.11015925941598, -12.64802072171685, 3.8799999999999617, 49.12999999999977, 65.88429760795533, 120.50735702260967, 102.08245955559704, 3.9199999999999595, 180.1309546629099, 137.71359565753505, 130.4271714057873, 27.35000000000048, 179.0661950240497, 125.40095319124825, -12.422639371009959, 204.66388897980147, 394.65358258893235, 113.81668949244943, 38.50999999999995, 264.7248635557098, -6.8076072509164955, 95.24534355112725, 284.70848909541957, 36.74226916586831, 42.30337326349776, 242.86735574069357, 135.33598847895414, 9.799524061116246, 95.3800000000003, 217.83964368248755, 64.67129828153898, 169.77573066357425, 186.41880082814882, 80.37000000000006, -53.74123626373048, 6.205042432424403, 186.61062598119074, 260.1541079544083, 106.4300000000004, 221.05762576874656, 156.06094426012328, 246.92000000000021, 85.86000000000034, 97.75000000000024, 7.972378092443483, 85.91000000000005, 129.26229312279702, 75.28826835124572, 7.76999999999992, 89.6900000000005, 22.8454312009306, -67.24917015903958, 95.88000000000076, 217.91899954427447, 205.48999999999953, 156.03765714404867, 171.53640104828338, 240.7592245167934, 84.53000000000016, 74.9100000000001, -16.397462728430316, 69.49308644400462, 12.455401653522882, 17.740000000000247, 109.48000000000049, -20.602649053595098, 152.45463902269574, 121.31000000000057, 135.2129216798519, 66.00565553022614, 119.5513903332578, 180.16888330399743, -2.967321759036709, 510.6048678133588, 114.63821434530797, 179.6028043059844, 99.78740588606149, 186.7943552505011, 137.3907586855456, 118.61000000000017, 67.23000000000032, 176.69097110564275, 185.75433457092288, 135.56000000000037, 112.07927929275665, 8.117824326857711, 282.9397281900692, 94.1700000000002, 125.63588535673738, 142.32000000000036, 3.859999999999963], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-420.37845187333875, -7.413779861469816, -44.53087203628474, -71.24040595031498, -20.08055546703073, -10.44857404957002, -12.245249230191655, -5.515961857020999, -186.01513735398422, 40.74635923552281, -93.9895387872961, -76.62288207896793, -69.3737306281459, -42.25902156136539, 55.146380674643176, -165.4221504070266, -7.371755072167833, 4.390284816837598, -120.35191135212091, 115.80758752114862, -22.426756184577975, -42.54900985041006, -11.630226436799479, -12.273719711749788, -12.913344215266465, -30.74753064337432, -179.81092375800247, -97.39270337191276, -149.32664850921117, 29.952153380107966, -4.320451717558445, -100.9990216362488, -5.825558057470831, -6.468246511029813, 1.0043714167373818, 93.34727933689612, -97.13375729292558, -10.374479285364755, -88.97669124804065, 4.8301958707591455, -128.8639880666577, -18.56991883018658, 84.51918067973638, 28.793679788458032, -158.8786743137079, 114.86000000000017, -62.725052182858995, -19.620487095920566, -0.2398859588345248, 103.52544388110474, -183.37479151533904, -1.147667622828548, -108.91274592881558, -76.71851342801358, -6.332845167880635, -7.218861234076844, 92.49119609028949, -110.82612678657856, -27.253237675666192, -24.680259982345465, 88.13, -9.421528003156793, -248.29344460319166, 62.38999999999987, 2.0000000000000013, -82.6421719419808, 2.0000000000000013, 14.667886243994056, 73.26551412987303, 94.00206326450521, 80.27693936247401, 2.0000000000000013, -112.9445516057787, -76.83855792251946, -150.25557105460365, -6.0149035412552205, 53.73764136080002, 69.23223240895852, 2.0000000000000013, -86.04799713039769, -150.7389795776789, -292.90791190244363, 3.979999999999958, 42.52452778501359, -81.51140521780889, -42.81324978684213, -174.11936189046554, -310.82526881134453, -2.249048423077766, 2.0000000000000013, 35.35183859661762, 17.55461257492228, 45.889191899650065, 14.78239386266806, 53.822253252038436, -129.30106391234136, 25.43240937202951, 26.034646556793046, -15.504356006862125, 148.03199678340934, -66.36567665785785, 53.408710233551695, 66.46307547963049, -89.20469683285741, -70.84943797429541, 81.80837197869992, -9.305200993301012, 2.0000000000000013, 30.663637827934235, -2.842349408423848, -14.1416615357295, 100.16606322840303, -34.721852885579324, -319.08942493494885, -54.258155759251125, -32.956088015217034, 46.01568939202107, -56.30138360743762, -43.630683084905435, -74.24175786210567, -83.3445824736559, -118.01144585143844, 2.0000000000000013, 22.595440495736987, 101.00000000000007, -33.51956679952202, 18.385229802900568, 61.10546554349173, -55.05279477060649, -45.59407354242044, 110.49275124344582, -40.58083222956064, -207.51561966487057, -200.79917428525306, -132.36011391540114, -21.343595054872836, 5.377994112000836, -7.098363031991189, -157.67281137629266, -70.09286918681528, -79.5661807749479, -0.2964201836483793, -32.87751313242805, 2.0000000000000013, -5.163819961111747, -9.487802625110294, -155.32776474300388, 65.83601594545749, -46.0280019610407, -84.51676608592541, -2.023975490454024, 76.68706247935859, -78.85743999924533, 53.265656542838904, 2.0000000000000013, 19.976670422020362, -37.36606956617203, 2.0000000000000013, 2.0000000000000013, -14.504472133064564, 57.6672312425008, -3.0013771385557924, -172.22530036173626, -184.95075046620516, -511.1738878078078, -13.165438092827257, -3.883427585758909, -237.0315092599339, -43.7429289368103, 0.22527504181473995, 14.280834149229168, 2.0000000000000013, -74.12279979844793, 141.06009149800101, -55.04457418202197, 74.95092964175603, -206.70310191097582, 48.51395322153286, 39.11191440630388, 2.0000000000000013, 2.0000000000000013, 71.42596042246022, 34.22650347771288, 3.903387183201959, 75.13215133669249, -252.8475980857254, 19.12071703819576, -11.36030883067403, -36.389115195501624, 0.7712210482095526, 9.499058034550224, 140.81257772574264, -125.95533207140144, -32.465364844775564, -250.36046673765304, -114.91005256174516, 138.73290472058932, -60.794405112228745, -13.124100188220211, -19.427034074746178], "policy_predator_policy_reward": [458.70845187333873, 9.383779861469774, 33.144795617219685, 76.02040595031589, 21.99055546703103, 12.398574049569978, 14.185249230191614, 7.485961857020957, 187.72513735398266, 58.023640764477115, 87.29589481944578, 190.73652604681862, 71.80038193635734, 172.99721783432798, 12.143619325356624, 217.3021504070258, 13.63894975130771, 60.34252050402248, 105.76007057524413, 95.89441251514576, 4.645656021434244, 47.68208929183687, 13.580226436799437, 14.203719711749747, 60.183344215266516, 32.607530643374396, 162.47069536549708, 180.61722937237138, 25.490335708402608, 214.39151644331005, 82.13387909838981, 125.26805381101475, 7.785558057470789, 8.428246511029773, 34.08395119862484, 51.695352710652784, 220.8042987291374, 24.4175335066873, 115.19693128563276, 99.3767354974376, 119.10406407342838, 55.67984282341549, 33.476501949987984, 32.276832605867476, 10.725216582923597, 158.69441092203056, 29.099368239586408, 40.823531668183215, 62.774442077729596, 38.60388897980148, 305.8963762335341, 273.2796654935661, 212.9762070413095, 86.47174180796891, 42.882845167880326, 9.178861234076802, 144.11622426895113, 138.94356998304897, 10.343681168713548, 34.782209238382286, 11.39152800315675, 5.145343551127164, 194.39119517422512, 276.22073852438683, 32.912269165869034, 84.47217194198174, 22.25328481750368, 3.3822022019999096, 38.50430852535205, 37.09546982096324, 41.27431371921684, 11.784735397262441, 97.38485713702245, 102.19777645239368, 243.6655710546039, 7.9849035412551785, 53.13575530021822, 41.73401461251033, 39.512441545455765, 109.20685386648188, 181.98733306947904, 431.4352890742173, 68.8617371431208, 71.05253590001459, 151.07393471495234, 53.620720289698056, 110.01667152876018, 321.18672290931863, 4.133301278005532, 2.320789577496679, 114.39806275250976, 19.306112057141544, 82.44543267994722, 117.03708951214372, 130.94106391234172, 50.967746747961606, 82.6908644310471, 86.89970540887818, 17.45435600686234, 6.0789474767141485, 259.8769664243058, 0.0, 17.61692452036947, 90.98469683285829, 72.62943797429632, 14.161628021300036, 4.574564344180105, 10.70301474156443, 53.266362172065826, 4.822349408423806, 17.781228252682048, 25.456663177441303, 384.34551433887435, 44.754031832899095, 34.88608801521665, 60.09815575925076, 25.139747694041443, 74.83594652137484, 63.19155311077577, 77.52631903716592, 125.18164642811954, 8.925211737935356, 10.365283023139288, 60.91927648112386, 39.777041859876384, 110.66152448392066, 71.01237439001032, 54.98693026359736, 153.1125253847256, 103.57200007234927, 53.89019705778265, 47.73428497661589, 350.3852865144773, 298.68873195243964, 102.15104216240391, 136.08266680787062, 11.309045672827668, 65.32132324716277, 49.74490529960155, 161.62331253507477, 30.572219001032344, 118.78346840156871, 10.298777017512021, 33.034137768438804, 32.39162258622197, 0.0, 41.913984054542475, 157.0577647430023, 102.21002495241099, 7.732094040960015, 44.66471857247764, 33.1268334613135, 66.34434345716097, 80.55743999924549, 33.9769185679745, 79.25933268985662, 44.335655530225424, 57.0360695661717, 104.6252491735348, 27.43061329278721, 60.051445116799464, 65.45158408325342, 317.8676938128355, 36.341035256067684, 517.4715187152963, 517.4726749986977, 85.56933337893895, 269.9838178120613, 105.50267679884817, 117.61778140213247, 11.98683696577431, 71.51973477105793, 63.23726498943374, 56.61979856151528, 47.921125559887756, 69.56327766592267, 68.99604677846712, 207.80310191097567, 0.0, 26.11808559369599, 58.41147528359657, 44.853535399586534, 77.69110443229648, 69.93333947771137, 59.30784866330758, 253.96759808572438, 16.809588123430064, 87.50928296180435, 13.229131155981456, 30.506587318168034, 34.810504934081855, 97.81758749569465, 127.49533207140223, 125.09536484477552, 418.392875731076, 72.51352892505966, 62.52440511222839, 1.8570952794107385, 21.347034074746478, 15.06410018822017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5455071602222522, "mean_inference_ms": 1.3548420043609053, "mean_action_processing_ms": 0.23299722533371972, "mean_env_wait_ms": 0.17769959749384712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033701658248901367, "StateBufferConnector_ms": 0.0028400421142578125, "ViewRequirementAgentConnector_ms": 0.08404839038848877}, "num_episodes": 22, "episode_return_max": 510.6048678133588, "episode_return_min": -67.24917015903958, "episode_return_mean": 110.7880005518608, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.5189284780208, "num_env_steps_trained_throughput_per_sec": 446.5189284780208, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 45615.854, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45615.817, "sample_time_ms": 1062.087, "learn_time_ms": 44540.715, "learn_throughput": 89.805, "synch_weights_time_ms": 12.074}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "1f15c_00000", "date": "2024-08-16_14-30-27", "timestamp": 1723798827, "time_this_iter_s": 8.96195101737976, "time_total_s": 1631.9125380516052, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffaaee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1631.9125380516052, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 25.353846153846153, "ram_util_percent": 75.26923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5020724354597625, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.165691883980282, "policy_loss": -0.0055380669634335885, "vf_loss": 4.171137703789605, "vf_explained_var": 0.01563486343338376, "kl": 0.007379846560886361, "entropy": 0.41983430519621207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.031921341747203, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.144046142366197, "policy_loss": -0.00822828210207816, "vf_loss": 6.1513094203182, "vf_explained_var": 0.42852833832382525, "kl": 0.008577750146855382, "entropy": 0.9097249559624485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 510.6048678133588, "episode_reward_min": -67.24917015903958, "episode_reward_mean": 119.2823571358357, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -511.1738878078078, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 148.51999999999998, "predator_policy": 517.4726749986977}, "policy_reward_mean": {"prey_policy": -29.64119964077351, "predator_policy": 89.28237820869134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.71359565753505, 130.4271714057873, 27.35000000000048, 179.0661950240497, 125.40095319124825, -12.422639371009959, 204.66388897980147, 394.65358258893235, 113.81668949244943, 38.50999999999995, 264.7248635557098, -6.8076072509164955, 95.24534355112725, 284.70848909541957, 36.74226916586831, 42.30337326349776, 242.86735574069357, 135.33598847895414, 9.799524061116246, 95.3800000000003, 217.83964368248755, 64.67129828153898, 169.77573066357425, 186.41880082814882, 80.37000000000006, -53.74123626373048, 6.205042432424403, 186.61062598119074, 260.1541079544083, 106.4300000000004, 221.05762576874656, 156.06094426012328, 246.92000000000021, 85.86000000000034, 97.75000000000024, 7.972378092443483, 85.91000000000005, 129.26229312279702, 75.28826835124572, 7.76999999999992, 89.6900000000005, 22.8454312009306, -67.24917015903958, 95.88000000000076, 217.91899954427447, 205.48999999999953, 156.03765714404867, 171.53640104828338, 240.7592245167934, 84.53000000000016, 74.9100000000001, -16.397462728430316, 69.49308644400462, 12.455401653522882, 17.740000000000247, 109.48000000000049, -20.602649053595098, 152.45463902269574, 121.31000000000057, 135.2129216798519, 66.00565553022614, 119.5513903332578, 180.16888330399743, -2.967321759036709, 510.6048678133588, 114.63821434530797, 179.6028043059844, 99.78740588606149, 186.7943552505011, 137.3907586855456, 118.61000000000017, 67.23000000000032, 176.69097110564275, 185.75433457092288, 135.56000000000037, 112.07927929275665, 8.117824326857711, 282.9397281900692, 94.1700000000002, 125.63588535673738, 142.32000000000036, 3.859999999999963, 102.42799543502731, 114.10000000000035, 129.8049806272807, 183.64698815756051, 124.23000000000079, 59.33606901010373, 144.80325930880392, 108.85000000000046, 41.738338110430526, 34.18112335731367, 83.02000000000007, 103.90000000000063, 104.60000000000059, 155.97529052875495, 81.2999999999999, 250.39, 153.39394077007717, 156.43365164101724], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-97.13375729292558, -10.374479285364755, -88.97669124804065, 4.8301958707591455, -128.8639880666577, -18.56991883018658, 84.51918067973638, 28.793679788458032, -158.8786743137079, 114.86000000000017, -62.725052182858995, -19.620487095920566, -0.2398859588345248, 103.52544388110474, -183.37479151533904, -1.147667622828548, -108.91274592881558, -76.71851342801358, -6.332845167880635, -7.218861234076844, 92.49119609028949, -110.82612678657856, -27.253237675666192, -24.680259982345465, 88.13, -9.421528003156793, -248.29344460319166, 62.38999999999987, 2.0000000000000013, -82.6421719419808, 2.0000000000000013, 14.667886243994056, 73.26551412987303, 94.00206326450521, 80.27693936247401, 2.0000000000000013, -112.9445516057787, -76.83855792251946, -150.25557105460365, -6.0149035412552205, 53.73764136080002, 69.23223240895852, 2.0000000000000013, -86.04799713039769, -150.7389795776789, -292.90791190244363, 3.979999999999958, 42.52452778501359, -81.51140521780889, -42.81324978684213, -174.11936189046554, -310.82526881134453, -2.249048423077766, 2.0000000000000013, 35.35183859661762, 17.55461257492228, 45.889191899650065, 14.78239386266806, 53.822253252038436, -129.30106391234136, 25.43240937202951, 26.034646556793046, -15.504356006862125, 148.03199678340934, -66.36567665785785, 53.408710233551695, 66.46307547963049, -89.20469683285741, -70.84943797429541, 81.80837197869992, -9.305200993301012, 2.0000000000000013, 30.663637827934235, -2.842349408423848, -14.1416615357295, 100.16606322840303, -34.721852885579324, -319.08942493494885, -54.258155759251125, -32.956088015217034, 46.01568939202107, -56.30138360743762, -43.630683084905435, -74.24175786210567, -83.3445824736559, -118.01144585143844, 2.0000000000000013, 22.595440495736987, 101.00000000000007, -33.51956679952202, 18.385229802900568, 61.10546554349173, -55.05279477060649, -45.59407354242044, 110.49275124344582, -40.58083222956064, -207.51561966487057, -200.79917428525306, -132.36011391540114, -21.343595054872836, 5.377994112000836, -7.098363031991189, -157.67281137629266, -70.09286918681528, -79.5661807749479, -0.2964201836483793, -32.87751313242805, 2.0000000000000013, -5.163819961111747, -9.487802625110294, -155.32776474300388, 65.83601594545749, -46.0280019610407, -84.51676608592541, -2.023975490454024, 76.68706247935859, -78.85743999924533, 53.265656542838904, 2.0000000000000013, 19.976670422020362, -37.36606956617203, 2.0000000000000013, 2.0000000000000013, -14.504472133064564, 57.6672312425008, -3.0013771385557924, -172.22530036173626, -184.95075046620516, -511.1738878078078, -13.165438092827257, -3.883427585758909, -237.0315092599339, -43.7429289368103, 0.22527504181473995, 14.280834149229168, 2.0000000000000013, -74.12279979844793, 141.06009149800101, -55.04457418202197, 74.95092964175603, -206.70310191097582, 48.51395322153286, 39.11191440630388, 2.0000000000000013, 2.0000000000000013, 71.42596042246022, 34.22650347771288, 3.903387183201959, 75.13215133669249, -252.8475980857254, 19.12071703819576, -11.36030883067403, -36.389115195501624, 0.7712210482095526, 9.499058034550224, 140.81257772574264, -125.95533207140144, -32.465364844775564, -250.36046673765304, -114.91005256174516, 138.73290472058932, -60.794405112228745, -13.124100188220211, -19.427034074746178, 2.0000000000000013, -19.124321323973856, -148.40629724232477, 72.34626641128875, 104.16092498444814, -25.7044177091974, 42.063736801819225, -38.65045504354774, -89.21218968157778, 99.87703642225311, -100.70380818763516, -77.46641068317822, -122.93817061834542, -46.176383650723366, -10.475370127340492, 98.97285452844395, -67.56189884895846, -145.8884478318408, 2.0000000000000013, -58.46878607756577, -176.89617426189395, -91.21504520504052, -4.322927299784581, 80.5948562779212, -8.115485535029327, -28.75079675097894, -7.1736017723154575, 4.615477766988408, -106.5207132305668, -122.55608085044085, 104.00242137114994, 107.86756275256633, 148.51999999999998, -207.05268266957216, -72.52470129331581, -94.29762167420692], "policy_predator_policy_reward": [220.8042987291374, 24.4175335066873, 115.19693128563276, 99.3767354974376, 119.10406407342838, 55.67984282341549, 33.476501949987984, 32.276832605867476, 10.725216582923597, 158.69441092203056, 29.099368239586408, 40.823531668183215, 62.774442077729596, 38.60388897980148, 305.8963762335341, 273.2796654935661, 212.9762070413095, 86.47174180796891, 42.882845167880326, 9.178861234076802, 144.11622426895113, 138.94356998304897, 10.343681168713548, 34.782209238382286, 11.39152800315675, 5.145343551127164, 194.39119517422512, 276.22073852438683, 32.912269165869034, 84.47217194198174, 22.25328481750368, 3.3822022019999096, 38.50430852535205, 37.09546982096324, 41.27431371921684, 11.784735397262441, 97.38485713702245, 102.19777645239368, 243.6655710546039, 7.9849035412551785, 53.13575530021822, 41.73401461251033, 39.512441545455765, 109.20685386648188, 181.98733306947904, 431.4352890742173, 68.8617371431208, 71.05253590001459, 151.07393471495234, 53.620720289698056, 110.01667152876018, 321.18672290931863, 4.133301278005532, 2.320789577496679, 114.39806275250976, 19.306112057141544, 82.44543267994722, 117.03708951214372, 130.94106391234172, 50.967746747961606, 82.6908644310471, 86.89970540887818, 17.45435600686234, 6.0789474767141485, 259.8769664243058, 0.0, 17.61692452036947, 90.98469683285829, 72.62943797429632, 14.161628021300036, 4.574564344180105, 10.70301474156443, 53.266362172065826, 4.822349408423806, 17.781228252682048, 25.456663177441303, 384.34551433887435, 44.754031832899095, 34.88608801521665, 60.09815575925076, 25.139747694041443, 74.83594652137484, 63.19155311077577, 77.52631903716592, 125.18164642811954, 8.925211737935356, 10.365283023139288, 60.91927648112386, 39.777041859876384, 110.66152448392066, 71.01237439001032, 54.98693026359736, 153.1125253847256, 103.57200007234927, 53.89019705778265, 47.73428497661589, 350.3852865144773, 298.68873195243964, 102.15104216240391, 136.08266680787062, 11.309045672827668, 65.32132324716277, 49.74490529960155, 161.62331253507477, 30.572219001032344, 118.78346840156871, 10.298777017512021, 33.034137768438804, 32.39162258622197, 0.0, 41.913984054542475, 157.0577647430023, 102.21002495241099, 7.732094040960015, 44.66471857247764, 33.1268334613135, 66.34434345716097, 80.55743999924549, 33.9769185679745, 79.25933268985662, 44.335655530225424, 57.0360695661717, 104.6252491735348, 27.43061329278721, 60.051445116799464, 65.45158408325342, 317.8676938128355, 36.341035256067684, 517.4715187152963, 517.4726749986977, 85.56933337893895, 269.9838178120613, 105.50267679884817, 117.61778140213247, 11.98683696577431, 71.51973477105793, 63.23726498943374, 56.61979856151528, 47.921125559887756, 69.56327766592267, 68.99604677846712, 207.80310191097567, 0.0, 26.11808559369599, 58.41147528359657, 44.853535399586534, 77.69110443229648, 69.93333947771137, 59.30784866330758, 253.96759808572438, 16.809588123430064, 87.50928296180435, 13.229131155981456, 30.506587318168034, 34.810504934081855, 97.81758749569465, 127.49533207140223, 125.09536484477552, 418.392875731076, 72.51352892505966, 62.52440511222839, 1.8570952794107385, 21.347034074746478, 15.06410018822017, 18.579167570660488, 100.97314918834022, 40.36373358871126, 149.7962972423251, 17.7444877741742, 33.603985577855696, 17.354609853892285, 162.87909654539726, 22.78296357774702, 90.78218968157832, 142.08527285842564, 95.42101502249223, 256.3272304426498, 57.59058313522277, 7.92714547155611, 12.42537012734045, 114.75880281146722, 140.4298819797624, 52.537731852218165, 38.11217758266109, 178.1661742618933, 172.9650452050404, 19.633755182328755, 7.994315839534833, 20.751447392548773, 120.71483489345957, 139.43932503980807, 19.094089494273685, 186.2607132305664, 124.11608085044165, 26.722437247433703, 11.797578628850143, 208.3726826695717, 3.553940770077133, 152.02551605576488, 171.2304585527788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5449981997174256, "mean_inference_ms": 1.353563335915008, "mean_action_processing_ms": 0.23305654914284182, "mean_env_wait_ms": 0.17763043454029984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033922195434570312, "StateBufferConnector_ms": 0.0028454065322875977, "ViewRequirementAgentConnector_ms": 0.08280825614929199}, "num_episodes": 18, "episode_return_max": 510.6048678133588, "episode_return_min": -67.24917015903958, "episode_return_mean": 119.2823571358357, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.70505915430795, "num_env_steps_trained_throughput_per_sec": 431.70505915430795, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 45622.656, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45622.62, "sample_time_ms": 1054.182, "learn_time_ms": 44555.494, "learn_throughput": 89.776, "synch_weights_time_ms": 11.995}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "1f15c_00000", "date": "2024-08-16_14-30-36", "timestamp": 1723798836, "time_this_iter_s": 9.269141912460327, "time_total_s": 1641.1816799640656, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f880160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1641.1816799640656, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 25.084615384615386, "ram_util_percent": 75.05384615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8639074251449927, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.371847662597737, "policy_loss": -0.007882365204145017, "vf_loss": 3.3795879902663053, "vf_explained_var": 0.02351523237253623, "kl": 0.011363124251947992, "entropy": 0.4340855161348979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0208526957602726, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.384853428633756, "policy_loss": -0.00480679528400913, "vf_loss": 5.388854401704496, "vf_explained_var": 0.6027557470811107, "kl": 0.0071628031176213, "entropy": 0.843495611696647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 510.6048678133588, "episode_reward_min": -164.0395443457289, "episode_reward_mean": 106.54406817705872, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -511.1738878078078, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 148.51999999999998, "predator_policy": 517.4726749986977}, "policy_reward_mean": {"prey_policy": -33.106622674271385, "predator_policy": 86.37865676280069}, "custom_metrics": {}, "hist_stats": {"episode_reward": [186.41880082814882, 80.37000000000006, -53.74123626373048, 6.205042432424403, 186.61062598119074, 260.1541079544083, 106.4300000000004, 221.05762576874656, 156.06094426012328, 246.92000000000021, 85.86000000000034, 97.75000000000024, 7.972378092443483, 85.91000000000005, 129.26229312279702, 75.28826835124572, 7.76999999999992, 89.6900000000005, 22.8454312009306, -67.24917015903958, 95.88000000000076, 217.91899954427447, 205.48999999999953, 156.03765714404867, 171.53640104828338, 240.7592245167934, 84.53000000000016, 74.9100000000001, -16.397462728430316, 69.49308644400462, 12.455401653522882, 17.740000000000247, 109.48000000000049, -20.602649053595098, 152.45463902269574, 121.31000000000057, 135.2129216798519, 66.00565553022614, 119.5513903332578, 180.16888330399743, -2.967321759036709, 510.6048678133588, 114.63821434530797, 179.6028043059844, 99.78740588606149, 186.7943552505011, 137.3907586855456, 118.61000000000017, 67.23000000000032, 176.69097110564275, 185.75433457092288, 135.56000000000037, 112.07927929275665, 8.117824326857711, 282.9397281900692, 94.1700000000002, 125.63588535673738, 142.32000000000036, 3.859999999999963, 102.42799543502731, 114.10000000000035, 129.8049806272807, 183.64698815756051, 124.23000000000079, 59.33606901010373, 144.80325930880392, 108.85000000000046, 41.738338110430526, 34.18112335731367, 83.02000000000007, 103.90000000000063, 104.60000000000059, 155.97529052875495, 81.2999999999999, 250.39, 153.39394077007717, 156.43365164101724, 5.9106238055379565, 119.87795687549186, 56.60157117559691, 125.82625470123223, 31.569755587172885, -161.84483343717793, 320.80202302103453, 257.96685499867357, 56.16609438601955, 30.990000000000112, 100.77000000000024, 81.36000000000013, 259.90402641704117, 128.57000000000073, 112.82000000000023, 29.720000000000553, -0.8039755401559106, 83.614112324807, -12.214991653841267, -164.0395443457289, 14.223784169408118, 103.66111615934531, 136.4859847357077], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.979999999999958, 42.52452778501359, -81.51140521780889, -42.81324978684213, -174.11936189046554, -310.82526881134453, -2.249048423077766, 2.0000000000000013, 35.35183859661762, 17.55461257492228, 45.889191899650065, 14.78239386266806, 53.822253252038436, -129.30106391234136, 25.43240937202951, 26.034646556793046, -15.504356006862125, 148.03199678340934, -66.36567665785785, 53.408710233551695, 66.46307547963049, -89.20469683285741, -70.84943797429541, 81.80837197869992, -9.305200993301012, 2.0000000000000013, 30.663637827934235, -2.842349408423848, -14.1416615357295, 100.16606322840303, -34.721852885579324, -319.08942493494885, -54.258155759251125, -32.956088015217034, 46.01568939202107, -56.30138360743762, -43.630683084905435, -74.24175786210567, -83.3445824736559, -118.01144585143844, 2.0000000000000013, 22.595440495736987, 101.00000000000007, -33.51956679952202, 18.385229802900568, 61.10546554349173, -55.05279477060649, -45.59407354242044, 110.49275124344582, -40.58083222956064, -207.51561966487057, -200.79917428525306, -132.36011391540114, -21.343595054872836, 5.377994112000836, -7.098363031991189, -157.67281137629266, -70.09286918681528, -79.5661807749479, -0.2964201836483793, -32.87751313242805, 2.0000000000000013, -5.163819961111747, -9.487802625110294, -155.32776474300388, 65.83601594545749, -46.0280019610407, -84.51676608592541, -2.023975490454024, 76.68706247935859, -78.85743999924533, 53.265656542838904, 2.0000000000000013, 19.976670422020362, -37.36606956617203, 2.0000000000000013, 2.0000000000000013, -14.504472133064564, 57.6672312425008, -3.0013771385557924, -172.22530036173626, -184.95075046620516, -511.1738878078078, -13.165438092827257, -3.883427585758909, -237.0315092599339, -43.7429289368103, 0.22527504181473995, 14.280834149229168, 2.0000000000000013, -74.12279979844793, 141.06009149800101, -55.04457418202197, 74.95092964175603, -206.70310191097582, 48.51395322153286, 39.11191440630388, 2.0000000000000013, 2.0000000000000013, 71.42596042246022, 34.22650347771288, 3.903387183201959, 75.13215133669249, -252.8475980857254, 19.12071703819576, -11.36030883067403, -36.389115195501624, 0.7712210482095526, 9.499058034550224, 140.81257772574264, -125.95533207140144, -32.465364844775564, -250.36046673765304, -114.91005256174516, 138.73290472058932, -60.794405112228745, -13.124100188220211, -19.427034074746178, 2.0000000000000013, -19.124321323973856, -148.40629724232477, 72.34626641128875, 104.16092498444814, -25.7044177091974, 42.063736801819225, -38.65045504354774, -89.21218968157778, 99.87703642225311, -100.70380818763516, -77.46641068317822, -122.93817061834542, -46.176383650723366, -10.475370127340492, 98.97285452844395, -67.56189884895846, -145.8884478318408, 2.0000000000000013, -58.46878607756577, -176.89617426189395, -91.21504520504052, -4.322927299784581, 80.5948562779212, -8.115485535029327, -28.75079675097894, -7.1736017723154575, 4.615477766988408, -106.5207132305668, -122.55608085044085, 104.00242137114994, 107.86756275256633, 148.51999999999998, -207.05268266957216, -72.52470129331581, -94.29762167420692, -0.7193476767228717, 2.0000000000000013, 49.086574121196435, 2.0000000000000013, -90.80160425439927, 21.1599342491999, 64.35137485627914, 2.0000000000000013, -315.30620578392836, -192.04774484335218, -212.72723514632168, -285.5002924104957, 39.68834497914646, -81.72924692354769, 59.25666142996564, 128.2622706799046, 2.2526451182485454, -83.8336133469784, -0.3391084405783509, -138.51753400920293, -11.848467146699369, 36.753193013514284, 50.01114718128654, -143.93150073446137, 68.02793659452432, -32.237109476951225, 2.0000000000000013, 53.42919216384165, -229.97771729318916, 79.58978298878178, 2.0000000000000013, 23.47403002746346, -30.91002769739332, -2.723975540155898, -91.68355501333984, 16.107544461901334, -178.16795770503157, -222.86696399328815, -236.27521554062565, -241.10719909889337, -11.412481938723062, 2.0000000000000013, -15.842352131189852, 12.677129709400772, 64.06246005314404, 2.0000000000000013], "policy_predator_policy_reward": [68.8617371431208, 71.05253590001459, 151.07393471495234, 53.620720289698056, 110.01667152876018, 321.18672290931863, 4.133301278005532, 2.320789577496679, 114.39806275250976, 19.306112057141544, 82.44543267994722, 117.03708951214372, 130.94106391234172, 50.967746747961606, 82.6908644310471, 86.89970540887818, 17.45435600686234, 6.0789474767141485, 259.8769664243058, 0.0, 17.61692452036947, 90.98469683285829, 72.62943797429632, 14.161628021300036, 4.574564344180105, 10.70301474156443, 53.266362172065826, 4.822349408423806, 17.781228252682048, 25.456663177441303, 384.34551433887435, 44.754031832899095, 34.88608801521665, 60.09815575925076, 25.139747694041443, 74.83594652137484, 63.19155311077577, 77.52631903716592, 125.18164642811954, 8.925211737935356, 10.365283023139288, 60.91927648112386, 39.777041859876384, 110.66152448392066, 71.01237439001032, 54.98693026359736, 153.1125253847256, 103.57200007234927, 53.89019705778265, 47.73428497661589, 350.3852865144773, 298.68873195243964, 102.15104216240391, 136.08266680787062, 11.309045672827668, 65.32132324716277, 49.74490529960155, 161.62331253507477, 30.572219001032344, 118.78346840156871, 10.298777017512021, 33.034137768438804, 32.39162258622197, 0.0, 41.913984054542475, 157.0577647430023, 102.21002495241099, 7.732094040960015, 44.66471857247764, 33.1268334613135, 66.34434345716097, 80.55743999924549, 33.9769185679745, 79.25933268985662, 44.335655530225424, 57.0360695661717, 104.6252491735348, 27.43061329278721, 60.051445116799464, 65.45158408325342, 317.8676938128355, 36.341035256067684, 517.4715187152963, 517.4726749986977, 85.56933337893895, 269.9838178120613, 105.50267679884817, 117.61778140213247, 11.98683696577431, 71.51973477105793, 63.23726498943374, 56.61979856151528, 47.921125559887756, 69.56327766592267, 68.99604677846712, 207.80310191097567, 0.0, 26.11808559369599, 58.41147528359657, 44.853535399586534, 77.69110443229648, 69.93333947771137, 59.30784866330758, 253.96759808572438, 16.809588123430064, 87.50928296180435, 13.229131155981456, 30.506587318168034, 34.810504934081855, 97.81758749569465, 127.49533207140223, 125.09536484477552, 418.392875731076, 72.51352892505966, 62.52440511222839, 1.8570952794107385, 21.347034074746478, 15.06410018822017, 18.579167570660488, 100.97314918834022, 40.36373358871126, 149.7962972423251, 17.7444877741742, 33.603985577855696, 17.354609853892285, 162.87909654539726, 22.78296357774702, 90.78218968157832, 142.08527285842564, 95.42101502249223, 256.3272304426498, 57.59058313522277, 7.92714547155611, 12.42537012734045, 114.75880281146722, 140.4298819797624, 52.537731852218165, 38.11217758266109, 178.1661742618933, 172.9650452050404, 19.633755182328755, 7.994315839534833, 20.751447392548773, 120.71483489345957, 139.43932503980807, 19.094089494273685, 186.2607132305664, 124.11608085044165, 26.722437247433703, 11.797578628850143, 208.3726826695717, 3.553940770077133, 152.02551605576488, 171.2304585527788, 1.92062380553804, 2.709347676722858, 27.96115894191262, 40.83022381238199, 111.27993837586997, 14.963302804927926, 10.156254701231633, 49.31862514372081, 250.50325683229212, 288.4204493821609, 8.425118329556424, 327.95757579008125, 206.7709089910786, 156.07201597435758, 53.255829911574246, 17.192092977229162, 21.44759882937538, 116.29946378537511, 2.3291084405783455, 167.517534009203, 62.05680698648562, 13.808467146699327, 145.24150073446106, 30.038852818713405, 148.06550035677526, 76.04769894269305, 73.14080783615834, 0.0, 231.0177172931891, 32.190217011218266, 1.9006670665173755, 2.345302906019435, 32.83002769739333, 0.0, 67.12556133080284, 92.06456154544313, 165.39484508975679, 223.42508495472075, 34.53808121388127, 278.80478907990846, 13.37248193872302, 10.2637841694082, 90.02265188904406, 16.803686692090604, 43.171511579274345, 27.252013103288846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5445015411492522, "mean_inference_ms": 1.3514302706817118, "mean_action_processing_ms": 0.23262978078788826, "mean_env_wait_ms": 0.17762319026329534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458738327026367, "StateBufferConnector_ms": 0.0028715133666992188, "ViewRequirementAgentConnector_ms": 0.0857163667678833}, "num_episodes": 23, "episode_return_max": 510.6048678133588, "episode_return_min": -164.0395443457289, "episode_return_mean": 106.54406817705872, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.9336625532131, "num_env_steps_trained_throughput_per_sec": 443.9336625532131, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 45629.369, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45629.332, "sample_time_ms": 1059.106, "learn_time_ms": 44557.374, "learn_throughput": 89.772, "synch_weights_time_ms": 11.872}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "1f15c_00000", "date": "2024-08-16_14-30-45", "timestamp": 1723798845, "time_this_iter_s": 9.01416277885437, "time_total_s": 1650.19584274292, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f880d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1650.19584274292, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 24.307692307692303, "ram_util_percent": 74.73846153846155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9677538825721337, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.870283949690521, "policy_loss": -0.005583429599190673, "vf_loss": 3.875775923047747, "vf_explained_var": 0.029798177688840837, "kl": 0.007315850216964148, "entropy": 0.42921956457473615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.450988643005411, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.785526113913804, "policy_loss": -0.0061468281305183175, "vf_loss": 6.790705523162923, "vf_explained_var": 0.6941931252126341, "kl": 0.008599225260290907, "entropy": 0.9228557436239152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 510.6048678133588, "episode_reward_min": -164.0395443457289, "episode_reward_mean": 104.74676273428932, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -511.1738878078078, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 149.02055269786183, "predator_policy": 517.4726749986977}, "policy_reward_mean": {"prey_policy": -38.38491463811164, "predator_policy": 90.7582960052562}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.8454312009306, -67.24917015903958, 95.88000000000076, 217.91899954427447, 205.48999999999953, 156.03765714404867, 171.53640104828338, 240.7592245167934, 84.53000000000016, 74.9100000000001, -16.397462728430316, 69.49308644400462, 12.455401653522882, 17.740000000000247, 109.48000000000049, -20.602649053595098, 152.45463902269574, 121.31000000000057, 135.2129216798519, 66.00565553022614, 119.5513903332578, 180.16888330399743, -2.967321759036709, 510.6048678133588, 114.63821434530797, 179.6028043059844, 99.78740588606149, 186.7943552505011, 137.3907586855456, 118.61000000000017, 67.23000000000032, 176.69097110564275, 185.75433457092288, 135.56000000000037, 112.07927929275665, 8.117824326857711, 282.9397281900692, 94.1700000000002, 125.63588535673738, 142.32000000000036, 3.859999999999963, 102.42799543502731, 114.10000000000035, 129.8049806272807, 183.64698815756051, 124.23000000000079, 59.33606901010373, 144.80325930880392, 108.85000000000046, 41.738338110430526, 34.18112335731367, 83.02000000000007, 103.90000000000063, 104.60000000000059, 155.97529052875495, 81.2999999999999, 250.39, 153.39394077007717, 156.43365164101724, 5.9106238055379565, 119.87795687549186, 56.60157117559691, 125.82625470123223, 31.569755587172885, -161.84483343717793, 320.80202302103453, 257.96685499867357, 56.16609438601955, 30.990000000000112, 100.77000000000024, 81.36000000000013, 259.90402641704117, 128.57000000000073, 112.82000000000023, 29.720000000000553, -0.8039755401559106, 83.614112324807, -12.214991653841267, -164.0395443457289, 14.223784169408118, 103.66111615934531, 136.4859847357077, 202.19012822550593, 160.3600000000001, 90.25537337762698, 124.95000000000067, 102.32728347653158, 269.18322686209376, 128.35268932930984, 110.78000000000019, 207.7360396663394, 140.01508257181183, -118.30688890760126, 228.58488095924008, -70.25937528737049, 173.28439948916144, 168.54341348809785, -142.31919131158838, -140.28875568830375, 160.86999999999992], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-43.630683084905435, -74.24175786210567, -83.3445824736559, -118.01144585143844, 2.0000000000000013, 22.595440495736987, 101.00000000000007, -33.51956679952202, 18.385229802900568, 61.10546554349173, -55.05279477060649, -45.59407354242044, 110.49275124344582, -40.58083222956064, -207.51561966487057, -200.79917428525306, -132.36011391540114, -21.343595054872836, 5.377994112000836, -7.098363031991189, -157.67281137629266, -70.09286918681528, -79.5661807749479, -0.2964201836483793, -32.87751313242805, 2.0000000000000013, -5.163819961111747, -9.487802625110294, -155.32776474300388, 65.83601594545749, -46.0280019610407, -84.51676608592541, -2.023975490454024, 76.68706247935859, -78.85743999924533, 53.265656542838904, 2.0000000000000013, 19.976670422020362, -37.36606956617203, 2.0000000000000013, 2.0000000000000013, -14.504472133064564, 57.6672312425008, -3.0013771385557924, -172.22530036173626, -184.95075046620516, -511.1738878078078, -13.165438092827257, -3.883427585758909, -237.0315092599339, -43.7429289368103, 0.22527504181473995, 14.280834149229168, 2.0000000000000013, -74.12279979844793, 141.06009149800101, -55.04457418202197, 74.95092964175603, -206.70310191097582, 48.51395322153286, 39.11191440630388, 2.0000000000000013, 2.0000000000000013, 71.42596042246022, 34.22650347771288, 3.903387183201959, 75.13215133669249, -252.8475980857254, 19.12071703819576, -11.36030883067403, -36.389115195501624, 0.7712210482095526, 9.499058034550224, 140.81257772574264, -125.95533207140144, -32.465364844775564, -250.36046673765304, -114.91005256174516, 138.73290472058932, -60.794405112228745, -13.124100188220211, -19.427034074746178, 2.0000000000000013, -19.124321323973856, -148.40629724232477, 72.34626641128875, 104.16092498444814, -25.7044177091974, 42.063736801819225, -38.65045504354774, -89.21218968157778, 99.87703642225311, -100.70380818763516, -77.46641068317822, -122.93817061834542, -46.176383650723366, -10.475370127340492, 98.97285452844395, -67.56189884895846, -145.8884478318408, 2.0000000000000013, -58.46878607756577, -176.89617426189395, -91.21504520504052, -4.322927299784581, 80.5948562779212, -8.115485535029327, -28.75079675097894, -7.1736017723154575, 4.615477766988408, -106.5207132305668, -122.55608085044085, 104.00242137114994, 107.86756275256633, 148.51999999999998, -207.05268266957216, -72.52470129331581, -94.29762167420692, -0.7193476767228717, 2.0000000000000013, 49.086574121196435, 2.0000000000000013, -90.80160425439927, 21.1599342491999, 64.35137485627914, 2.0000000000000013, -315.30620578392836, -192.04774484335218, -212.72723514632168, -285.5002924104957, 39.68834497914646, -81.72924692354769, 59.25666142996564, 128.2622706799046, 2.2526451182485454, -83.8336133469784, -0.3391084405783509, -138.51753400920293, -11.848467146699369, 36.753193013514284, 50.01114718128654, -143.93150073446137, 68.02793659452432, -32.237109476951225, 2.0000000000000013, 53.42919216384165, -229.97771729318916, 79.58978298878178, 2.0000000000000013, 23.47403002746346, -30.91002769739332, -2.723975540155898, -91.68355501333984, 16.107544461901334, -178.16795770503157, -222.86696399328815, -236.27521554062565, -241.10719909889337, -11.412481938723062, 2.0000000000000013, -15.842352131189852, 12.677129709400772, 64.06246005314404, 2.0000000000000013, 88.48842870577398, -92.26603805365916, -226.79103680281477, 149.02055269786183, 2.0000000000000013, -198.7006106324584, 122.25069664660911, -168.28498044350707, 22.452795014432166, -5.375082805939412, 118.5422997775324, 84.06971065914846, 91.11342902868003, -6.2516883021716385, 2.0000000000000013, 77.28792945358263, -69.2744807039176, -32.73773346467532, 2.0000000000000013, -31.91131605571205, -178.40586488993424, -212.77327414044902, 96.72540708971975, -0.08073610891034377, -198.4269634775554, -101.84278387439035, 8.661486260870248, 2.0000000000000013, -16.549453028527886, -11.590769043730026, -239.94216284311813, -200.88790373810716, -207.9183442042388, -229.9636399344293, -318.0547319028445, 115.32820251856948], "policy_predator_policy_reward": [63.19155311077577, 77.52631903716592, 125.18164642811954, 8.925211737935356, 10.365283023139288, 60.91927648112386, 39.777041859876384, 110.66152448392066, 71.01237439001032, 54.98693026359736, 153.1125253847256, 103.57200007234927, 53.89019705778265, 47.73428497661589, 350.3852865144773, 298.68873195243964, 102.15104216240391, 136.08266680787062, 11.309045672827668, 65.32132324716277, 49.74490529960155, 161.62331253507477, 30.572219001032344, 118.78346840156871, 10.298777017512021, 33.034137768438804, 32.39162258622197, 0.0, 41.913984054542475, 157.0577647430023, 102.21002495241099, 7.732094040960015, 44.66471857247764, 33.1268334613135, 66.34434345716097, 80.55743999924549, 33.9769185679745, 79.25933268985662, 44.335655530225424, 57.0360695661717, 104.6252491735348, 27.43061329278721, 60.051445116799464, 65.45158408325342, 317.8676938128355, 36.341035256067684, 517.4715187152963, 517.4726749986977, 85.56933337893895, 269.9838178120613, 105.50267679884817, 117.61778140213247, 11.98683696577431, 71.51973477105793, 63.23726498943374, 56.61979856151528, 47.921125559887756, 69.56327766592267, 68.99604677846712, 207.80310191097567, 0.0, 26.11808559369599, 58.41147528359657, 44.853535399586534, 77.69110443229648, 69.93333947771137, 59.30784866330758, 253.96759808572438, 16.809588123430064, 87.50928296180435, 13.229131155981456, 30.506587318168034, 34.810504934081855, 97.81758749569465, 127.49533207140223, 125.09536484477552, 418.392875731076, 72.51352892505966, 62.52440511222839, 1.8570952794107385, 21.347034074746478, 15.06410018822017, 18.579167570660488, 100.97314918834022, 40.36373358871126, 149.7962972423251, 17.7444877741742, 33.603985577855696, 17.354609853892285, 162.87909654539726, 22.78296357774702, 90.78218968157832, 142.08527285842564, 95.42101502249223, 256.3272304426498, 57.59058313522277, 7.92714547155611, 12.42537012734045, 114.75880281146722, 140.4298819797624, 52.537731852218165, 38.11217758266109, 178.1661742618933, 172.9650452050404, 19.633755182328755, 7.994315839534833, 20.751447392548773, 120.71483489345957, 139.43932503980807, 19.094089494273685, 186.2607132305664, 124.11608085044165, 26.722437247433703, 11.797578628850143, 208.3726826695717, 3.553940770077133, 152.02551605576488, 171.2304585527788, 1.92062380553804, 2.709347676722858, 27.96115894191262, 40.83022381238199, 111.27993837586997, 14.963302804927926, 10.156254701231633, 49.31862514372081, 250.50325683229212, 288.4204493821609, 8.425118329556424, 327.95757579008125, 206.7709089910786, 156.07201597435758, 53.255829911574246, 17.192092977229162, 21.44759882937538, 116.29946378537511, 2.3291084405783455, 167.517534009203, 62.05680698648562, 13.808467146699327, 145.24150073446106, 30.038852818713405, 148.06550035677526, 76.04769894269305, 73.14080783615834, 0.0, 231.0177172931891, 32.190217011218266, 1.9006670665173755, 2.345302906019435, 32.83002769739333, 0.0, 67.12556133080284, 92.06456154544313, 165.39484508975679, 223.42508495472075, 34.53808121388127, 278.80478907990846, 13.37248193872302, 10.2637841694082, 90.02265188904406, 16.803686692090604, 43.171511579274345, 27.252013103288846, 74.03486066697752, 131.93287690641475, 10.339447302138229, 227.79103680281486, 261.16805472852724, 25.787929281556345, 1.509303353391187, 169.47498044350695, 73.889060162021, 11.360511106017528, 44.50017283558236, 22.071043589830836, 9.786031747725062, 33.704916855075844, 29.322587076897086, 2.1694834695203737, 183.87693146367283, 125.87132237126013, 103.05187548871666, 66.87452313880682, 242.81976505818457, 30.052485064596244, 12.300855829998365, 119.63935414843252, 66.82177998119414, 163.1885920833793, 111.03831457078051, 51.58459865751112, 89.61785822229845, 107.06577733805779, 253.03953288135887, 45.471342388276234, 23.402335689788575, 274.19089276057394, 44.86179748143059, 318.73473190284415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5436960342709213, "mean_inference_ms": 1.3507564101222294, "mean_action_processing_ms": 0.23242982104129786, "mean_env_wait_ms": 0.17724129875744918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035142898559570312, "StateBufferConnector_ms": 0.0029087066650390625, "ViewRequirementAgentConnector_ms": 0.08671975135803223}, "num_episodes": 18, "episode_return_max": 510.6048678133588, "episode_return_min": -164.0395443457289, "episode_return_mean": 104.74676273428932, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.9234004241313, "num_env_steps_trained_throughput_per_sec": 442.9234004241313, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 9182.295, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9182.258, "sample_time_ms": 1059.246, "learn_time_ms": 8110.808, "learn_throughput": 493.169, "synch_weights_time_ms": 11.35}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "1f15c_00000", "date": "2024-08-16_14-30-55", "timestamp": 1723798855, "time_this_iter_s": 9.034312963485718, "time_total_s": 1659.2301557064056, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8cdb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1659.2301557064056, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 23.22307692307692, "ram_util_percent": 74.66923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3133202707956708, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.030785771021767, "policy_loss": -0.008780307563948174, "vf_loss": 5.039451408512378, "vf_explained_var": 0.057743220322977296, "kl": 0.009175027880664904, "entropy": 0.4726934563703638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.751463307527007, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.530213192531041, "policy_loss": -0.001902264057505856, "vf_loss": 6.531216394585907, "vf_explained_var": 0.5669623360432015, "kl": 0.007991732900679727, "entropy": 0.9326195420726897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 510.6048678133588, "episode_reward_min": -199.88691649302814, "episode_reward_mean": 108.22350139783343, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -511.1738878078078, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.2199999999999, "predator_policy": 517.4726749986977}, "policy_reward_mean": {"prey_policy": -48.880745588810434, "predator_policy": 102.99249628772705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.2129216798519, 66.00565553022614, 119.5513903332578, 180.16888330399743, -2.967321759036709, 510.6048678133588, 114.63821434530797, 179.6028043059844, 99.78740588606149, 186.7943552505011, 137.3907586855456, 118.61000000000017, 67.23000000000032, 176.69097110564275, 185.75433457092288, 135.56000000000037, 112.07927929275665, 8.117824326857711, 282.9397281900692, 94.1700000000002, 125.63588535673738, 142.32000000000036, 3.859999999999963, 102.42799543502731, 114.10000000000035, 129.8049806272807, 183.64698815756051, 124.23000000000079, 59.33606901010373, 144.80325930880392, 108.85000000000046, 41.738338110430526, 34.18112335731367, 83.02000000000007, 103.90000000000063, 104.60000000000059, 155.97529052875495, 81.2999999999999, 250.39, 153.39394077007717, 156.43365164101724, 5.9106238055379565, 119.87795687549186, 56.60157117559691, 125.82625470123223, 31.569755587172885, -161.84483343717793, 320.80202302103453, 257.96685499867357, 56.16609438601955, 30.990000000000112, 100.77000000000024, 81.36000000000013, 259.90402641704117, 128.57000000000073, 112.82000000000023, 29.720000000000553, -0.8039755401559106, 83.614112324807, -12.214991653841267, -164.0395443457289, 14.223784169408118, 103.66111615934531, 136.4859847357077, 202.19012822550593, 160.3600000000001, 90.25537337762698, 124.95000000000067, 102.32728347653158, 269.18322686209376, 128.35268932930984, 110.78000000000019, 207.7360396663394, 140.01508257181183, -118.30688890760126, 228.58488095924008, -70.25937528737049, 173.28439948916144, 168.54341348809785, -142.31919131158838, -140.28875568830375, 160.86999999999992, 114.18000000000022, 190.93088983134678, 121.20000000000024, 227.4053591300202, 338.4196513847994, 145.3890163434517, 154.4566076856655, 188.13009587291867, 148.4500000000001, 142.66000000000014, -199.88691649302814, 73.21999999999997, -183.24769202322796, 184.66597909901148, 240.51580580741398, 127.03046298952728, 126.43000000000022, -143.6838346399969], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, 19.976670422020362, -37.36606956617203, 2.0000000000000013, 2.0000000000000013, -14.504472133064564, 57.6672312425008, -3.0013771385557924, -172.22530036173626, -184.95075046620516, -511.1738878078078, -13.165438092827257, -3.883427585758909, -237.0315092599339, -43.7429289368103, 0.22527504181473995, 14.280834149229168, 2.0000000000000013, -74.12279979844793, 141.06009149800101, -55.04457418202197, 74.95092964175603, -206.70310191097582, 48.51395322153286, 39.11191440630388, 2.0000000000000013, 2.0000000000000013, 71.42596042246022, 34.22650347771288, 3.903387183201959, 75.13215133669249, -252.8475980857254, 19.12071703819576, -11.36030883067403, -36.389115195501624, 0.7712210482095526, 9.499058034550224, 140.81257772574264, -125.95533207140144, -32.465364844775564, -250.36046673765304, -114.91005256174516, 138.73290472058932, -60.794405112228745, -13.124100188220211, -19.427034074746178, 2.0000000000000013, -19.124321323973856, -148.40629724232477, 72.34626641128875, 104.16092498444814, -25.7044177091974, 42.063736801819225, -38.65045504354774, -89.21218968157778, 99.87703642225311, -100.70380818763516, -77.46641068317822, -122.93817061834542, -46.176383650723366, -10.475370127340492, 98.97285452844395, -67.56189884895846, -145.8884478318408, 2.0000000000000013, -58.46878607756577, -176.89617426189395, -91.21504520504052, -4.322927299784581, 80.5948562779212, -8.115485535029327, -28.75079675097894, -7.1736017723154575, 4.615477766988408, -106.5207132305668, -122.55608085044085, 104.00242137114994, 107.86756275256633, 148.51999999999998, -207.05268266957216, -72.52470129331581, -94.29762167420692, -0.7193476767228717, 2.0000000000000013, 49.086574121196435, 2.0000000000000013, -90.80160425439927, 21.1599342491999, 64.35137485627914, 2.0000000000000013, -315.30620578392836, -192.04774484335218, -212.72723514632168, -285.5002924104957, 39.68834497914646, -81.72924692354769, 59.25666142996564, 128.2622706799046, 2.2526451182485454, -83.8336133469784, -0.3391084405783509, -138.51753400920293, -11.848467146699369, 36.753193013514284, 50.01114718128654, -143.93150073446137, 68.02793659452432, -32.237109476951225, 2.0000000000000013, 53.42919216384165, -229.97771729318916, 79.58978298878178, 2.0000000000000013, 23.47403002746346, -30.91002769739332, -2.723975540155898, -91.68355501333984, 16.107544461901334, -178.16795770503157, -222.86696399328815, -236.27521554062565, -241.10719909889337, -11.412481938723062, 2.0000000000000013, -15.842352131189852, 12.677129709400772, 64.06246005314404, 2.0000000000000013, 88.48842870577398, -92.26603805365916, -226.79103680281477, 149.02055269786183, 2.0000000000000013, -198.7006106324584, 122.25069664660911, -168.28498044350707, 22.452795014432166, -5.375082805939412, 118.5422997775324, 84.06971065914846, 91.11342902868003, -6.2516883021716385, 2.0000000000000013, 77.28792945358263, -69.2744807039176, -32.73773346467532, 2.0000000000000013, -31.91131605571205, -178.40586488993424, -212.77327414044902, 96.72540708971975, -0.08073610891034377, -198.4269634775554, -101.84278387439035, 8.661486260870248, 2.0000000000000013, -16.549453028527886, -11.590769043730026, -239.94216284311813, -200.88790373810716, -207.9183442042388, -229.9636399344293, -318.0547319028445, 115.32820251856948, 27.784313520943577, -321.06479221967766, -226.28364197107166, 178.2199999999999, 55.146964624847975, -152.25438704107074, -26.419766468484994, -28.319702709616426, 81.21969979510477, 56.74360097277688, 30.604500215239455, -203.83936949970538, 150.49999999999983, -14.294662247132925, 98.42424603453091, 2.0000000000000013, 139.1559730518928, -286.11957574375805, -42.74601517790536, -366.2038261777099, -305.3878767320107, -286.44967712625834, -202.9908031247645, -311.83746707380425, -225.99264519907567, -230.24286092717068, -5.320140443741627, 133.7236814172594, 39.84885593456099, -50.9896292538681, -19.551580720340752, -33.73514518089185, -277.82734446713494, 49.56532759547265, -376.47592898049936, -414.0148667380897], "policy_predator_policy_reward": [33.9769185679745, 79.25933268985662, 44.335655530225424, 57.0360695661717, 104.6252491735348, 27.43061329278721, 60.051445116799464, 65.45158408325342, 317.8676938128355, 36.341035256067684, 517.4715187152963, 517.4726749986977, 85.56933337893895, 269.9838178120613, 105.50267679884817, 117.61778140213247, 11.98683696577431, 71.51973477105793, 63.23726498943374, 56.61979856151528, 47.921125559887756, 69.56327766592267, 68.99604677846712, 207.80310191097567, 0.0, 26.11808559369599, 58.41147528359657, 44.853535399586534, 77.69110443229648, 69.93333947771137, 59.30784866330758, 253.96759808572438, 16.809588123430064, 87.50928296180435, 13.229131155981456, 30.506587318168034, 34.810504934081855, 97.81758749569465, 127.49533207140223, 125.09536484477552, 418.392875731076, 72.51352892505966, 62.52440511222839, 1.8570952794107385, 21.347034074746478, 15.06410018822017, 18.579167570660488, 100.97314918834022, 40.36373358871126, 149.7962972423251, 17.7444877741742, 33.603985577855696, 17.354609853892285, 162.87909654539726, 22.78296357774702, 90.78218968157832, 142.08527285842564, 95.42101502249223, 256.3272304426498, 57.59058313522277, 7.92714547155611, 12.42537012734045, 114.75880281146722, 140.4298819797624, 52.537731852218165, 38.11217758266109, 178.1661742618933, 172.9650452050404, 19.633755182328755, 7.994315839534833, 20.751447392548773, 120.71483489345957, 139.43932503980807, 19.094089494273685, 186.2607132305664, 124.11608085044165, 26.722437247433703, 11.797578628850143, 208.3726826695717, 3.553940770077133, 152.02551605576488, 171.2304585527788, 1.92062380553804, 2.709347676722858, 27.96115894191262, 40.83022381238199, 111.27993837586997, 14.963302804927926, 10.156254701231633, 49.31862514372081, 250.50325683229212, 288.4204493821609, 8.425118329556424, 327.95757579008125, 206.7709089910786, 156.07201597435758, 53.255829911574246, 17.192092977229162, 21.44759882937538, 116.29946378537511, 2.3291084405783455, 167.517534009203, 62.05680698648562, 13.808467146699327, 145.24150073446106, 30.038852818713405, 148.06550035677526, 76.04769894269305, 73.14080783615834, 0.0, 231.0177172931891, 32.190217011218266, 1.9006670665173755, 2.345302906019435, 32.83002769739333, 0.0, 67.12556133080284, 92.06456154544313, 165.39484508975679, 223.42508495472075, 34.53808121388127, 278.80478907990846, 13.37248193872302, 10.2637841694082, 90.02265188904406, 16.803686692090604, 43.171511579274345, 27.252013103288846, 74.03486066697752, 131.93287690641475, 10.339447302138229, 227.79103680281486, 261.16805472852724, 25.787929281556345, 1.509303353391187, 169.47498044350695, 73.889060162021, 11.360511106017528, 44.50017283558236, 22.071043589830836, 9.786031747725062, 33.704916855075844, 29.322587076897086, 2.1694834695203737, 183.87693146367283, 125.87132237126013, 103.05187548871666, 66.87452313880682, 242.81976505818457, 30.052485064596244, 12.300855829998365, 119.63935414843252, 66.82177998119414, 163.1885920833793, 111.03831457078051, 51.58459865751112, 89.61785822229845, 107.06577733805779, 253.03953288135887, 45.471342388276234, 23.402335689788575, 274.19089276057394, 44.86179748143059, 318.73473190284415, 85.73568647905643, 321.7247922196776, 221.3982218992095, 17.596309903208784, 64.49303537515215, 153.81438704107106, 156.01066714462206, 126.13416116350062, 115.04455631095374, 85.41179430596429, 113.82168914699537, 204.8021964809222, 16.234662247132924, 2.0166076856658184, 45.64109004716786, 42.0647597912202, 287.0795757437575, 8.33402694810716, 184.94601517790528, 366.66382617770955, 317.0221519491231, 74.92848541611606, 204.1008031247644, 383.94746707380415, 250.45774309880701, 22.530071004211276, 27.752346074808504, 28.510092050685316, 122.79146468517222, 128.86511444154974, 90.87370596102681, 89.44348292973315, 278.77734446713407, 75.91467240452727, 323.64181119743347, 323.1651498811587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5430989356718547, "mean_inference_ms": 1.3495154641576597, "mean_action_processing_ms": 0.23214677856464314, "mean_env_wait_ms": 0.17707452910075733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034949779510498047, "StateBufferConnector_ms": 0.0028673410415649414, "ViewRequirementAgentConnector_ms": 0.08538389205932617}, "num_episodes": 18, "episode_return_max": 510.6048678133588, "episode_return_min": -199.88691649302814, "episode_return_mean": 108.22350139783343, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.29329424856985, "num_env_steps_trained_throughput_per_sec": 438.29329424856985, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 9066.939, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9066.904, "sample_time_ms": 991.359, "learn_time_ms": 8063.225, "learn_throughput": 496.079, "synch_weights_time_ms": 11.485}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "1f15c_00000", "date": "2024-08-16_14-31-04", "timestamp": 1723798864, "time_this_iter_s": 9.130131006240845, "time_total_s": 1668.3602867126465, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8b1430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1668.3602867126465, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 26.407692307692304, "ram_util_percent": 74.64615384615387}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3605621639067533, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.910743853024074, "policy_loss": -0.009492478113641184, "vf_loss": 4.919936895244336, "vf_explained_var": 0.06715772927753509, "kl": 0.023954712670619632, "entropy": 0.46223971082104576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1862873151504174, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.15882898789865, "policy_loss": -0.0032647766259119465, "vf_loss": 6.161468585332234, "vf_explained_var": 0.43010692722582944, "kl": 0.005557078883663912, "entropy": 0.887954594155468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 406.5834463615538, "episode_reward_min": -399.4707564700795, "episode_reward_mean": 101.67554412311685, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -472.93165582147464, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.2199999999999, "predator_policy": 509.24594040456367}, "policy_reward_mean": {"prey_policy": -59.24037296942253, "predator_policy": 110.07814503098092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.859999999999963, 102.42799543502731, 114.10000000000035, 129.8049806272807, 183.64698815756051, 124.23000000000079, 59.33606901010373, 144.80325930880392, 108.85000000000046, 41.738338110430526, 34.18112335731367, 83.02000000000007, 103.90000000000063, 104.60000000000059, 155.97529052875495, 81.2999999999999, 250.39, 153.39394077007717, 156.43365164101724, 5.9106238055379565, 119.87795687549186, 56.60157117559691, 125.82625470123223, 31.569755587172885, -161.84483343717793, 320.80202302103453, 257.96685499867357, 56.16609438601955, 30.990000000000112, 100.77000000000024, 81.36000000000013, 259.90402641704117, 128.57000000000073, 112.82000000000023, 29.720000000000553, -0.8039755401559106, 83.614112324807, -12.214991653841267, -164.0395443457289, 14.223784169408118, 103.66111615934531, 136.4859847357077, 202.19012822550593, 160.3600000000001, 90.25537337762698, 124.95000000000067, 102.32728347653158, 269.18322686209376, 128.35268932930984, 110.78000000000019, 207.7360396663394, 140.01508257181183, -118.30688890760126, 228.58488095924008, -70.25937528737049, 173.28439948916144, 168.54341348809785, -142.31919131158838, -140.28875568830375, 160.86999999999992, 114.18000000000022, 190.93088983134678, 121.20000000000024, 227.4053591300202, 338.4196513847994, 145.3890163434517, 154.4566076856655, 188.13009587291867, 148.4500000000001, 142.66000000000014, -199.88691649302814, 73.21999999999997, -183.24769202322796, 184.66597909901148, 240.51580580741398, 127.03046298952728, 126.43000000000022, -143.6838346399969, 346.1287326672391, 186.89615462520268, 406.5834463615538, -235.3252856824073, 273.6068992309896, 178.3261608160197, 152.89182019826953, 301.6962908024795, 113.22275868010713, 183.70491860757943, -399.4707564700795, 195.754391760024, 212.50743558934215, 130.40000000000026, 149.1199999999999, 129.56000000000034, 61.33454456629244, 22.54780371758782, 15.81322311398458, 155.4199999999999, -63.566307837799286, 3.9499999999999598], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.124100188220211, -19.427034074746178, 2.0000000000000013, -19.124321323973856, -148.40629724232477, 72.34626641128875, 104.16092498444814, -25.7044177091974, 42.063736801819225, -38.65045504354774, -89.21218968157778, 99.87703642225311, -100.70380818763516, -77.46641068317822, -122.93817061834542, -46.176383650723366, -10.475370127340492, 98.97285452844395, -67.56189884895846, -145.8884478318408, 2.0000000000000013, -58.46878607756577, -176.89617426189395, -91.21504520504052, -4.322927299784581, 80.5948562779212, -8.115485535029327, -28.75079675097894, -7.1736017723154575, 4.615477766988408, -106.5207132305668, -122.55608085044085, 104.00242137114994, 107.86756275256633, 148.51999999999998, -207.05268266957216, -72.52470129331581, -94.29762167420692, -0.7193476767228717, 2.0000000000000013, 49.086574121196435, 2.0000000000000013, -90.80160425439927, 21.1599342491999, 64.35137485627914, 2.0000000000000013, -315.30620578392836, -192.04774484335218, -212.72723514632168, -285.5002924104957, 39.68834497914646, -81.72924692354769, 59.25666142996564, 128.2622706799046, 2.2526451182485454, -83.8336133469784, -0.3391084405783509, -138.51753400920293, -11.848467146699369, 36.753193013514284, 50.01114718128654, -143.93150073446137, 68.02793659452432, -32.237109476951225, 2.0000000000000013, 53.42919216384165, -229.97771729318916, 79.58978298878178, 2.0000000000000013, 23.47403002746346, -30.91002769739332, -2.723975540155898, -91.68355501333984, 16.107544461901334, -178.16795770503157, -222.86696399328815, -236.27521554062565, -241.10719909889337, -11.412481938723062, 2.0000000000000013, -15.842352131189852, 12.677129709400772, 64.06246005314404, 2.0000000000000013, 88.48842870577398, -92.26603805365916, -226.79103680281477, 149.02055269786183, 2.0000000000000013, -198.7006106324584, 122.25069664660911, -168.28498044350707, 22.452795014432166, -5.375082805939412, 118.5422997775324, 84.06971065914846, 91.11342902868003, -6.2516883021716385, 2.0000000000000013, 77.28792945358263, -69.2744807039176, -32.73773346467532, 2.0000000000000013, -31.91131605571205, -178.40586488993424, -212.77327414044902, 96.72540708971975, -0.08073610891034377, -198.4269634775554, -101.84278387439035, 8.661486260870248, 2.0000000000000013, -16.549453028527886, -11.590769043730026, -239.94216284311813, -200.88790373810716, -207.9183442042388, -229.9636399344293, -318.0547319028445, 115.32820251856948, 27.784313520943577, -321.06479221967766, -226.28364197107166, 178.2199999999999, 55.146964624847975, -152.25438704107074, -26.419766468484994, -28.319702709616426, 81.21969979510477, 56.74360097277688, 30.604500215239455, -203.83936949970538, 150.49999999999983, -14.294662247132925, 98.42424603453091, 2.0000000000000013, 139.1559730518928, -286.11957574375805, -42.74601517790536, -366.2038261777099, -305.3878767320107, -286.44967712625834, -202.9908031247645, -311.83746707380425, -225.99264519907567, -230.24286092717068, -5.320140443741627, 133.7236814172594, 39.84885593456099, -50.9896292538681, -19.551580720340752, -33.73514518089185, -277.82734446713494, 49.56532759547265, -376.47592898049936, -414.0148667380897, 114.74494161054739, 99.72536794335953, -90.24045593709548, 20.903537382146148, -368.6952989010893, 171.29000000000005, -320.23295353121813, -314.25530013349123, 145.55000000000013, -52.49806908921781, 2.758390743098763, 62.52313840296683, -146.79624948331139, -16.24139035894323, 141.29815314620345, 149.51000000000005, -20.021067429552566, -58.68859899158085, 0.3812452771596835, 2.0000000000000013, -470.62498499184574, -406.2214409775178, -186.8567591798648, -8.439759125363134, -98.26318145826393, -29.05892393329217, 69.89508895521024, -9.218707533486262, 37.186488759759996, -254.06298854340824, 107.19136032614837, -13.143171970733038, -81.97187953118727, -1.9045457545095732, -472.93165582147464, -38.79751987066314, -31.24019443027099, 2.0000000000000013, 77.36186580395582, -469.66334566753306, -438.07529016509767, -412.4762037637129, 0.32720969355669544, -6.539227662319197], "policy_predator_policy_reward": [21.347034074746478, 15.06410018822017, 18.579167570660488, 100.97314918834022, 40.36373358871126, 149.7962972423251, 17.7444877741742, 33.603985577855696, 17.354609853892285, 162.87909654539726, 22.78296357774702, 90.78218968157832, 142.08527285842564, 95.42101502249223, 256.3272304426498, 57.59058313522277, 7.92714547155611, 12.42537012734045, 114.75880281146722, 140.4298819797624, 52.537731852218165, 38.11217758266109, 178.1661742618933, 172.9650452050404, 19.633755182328755, 7.994315839534833, 20.751447392548773, 120.71483489345957, 139.43932503980807, 19.094089494273685, 186.2607132305664, 124.11608085044165, 26.722437247433703, 11.797578628850143, 208.3726826695717, 3.553940770077133, 152.02551605576488, 171.2304585527788, 1.92062380553804, 2.709347676722858, 27.96115894191262, 40.83022381238199, 111.27993837586997, 14.963302804927926, 10.156254701231633, 49.31862514372081, 250.50325683229212, 288.4204493821609, 8.425118329556424, 327.95757579008125, 206.7709089910786, 156.07201597435758, 53.255829911574246, 17.192092977229162, 21.44759882937538, 116.29946378537511, 2.3291084405783455, 167.517534009203, 62.05680698648562, 13.808467146699327, 145.24150073446106, 30.038852818713405, 148.06550035677526, 76.04769894269305, 73.14080783615834, 0.0, 231.0177172931891, 32.190217011218266, 1.9006670665173755, 2.345302906019435, 32.83002769739333, 0.0, 67.12556133080284, 92.06456154544313, 165.39484508975679, 223.42508495472075, 34.53808121388127, 278.80478907990846, 13.37248193872302, 10.2637841694082, 90.02265188904406, 16.803686692090604, 43.171511579274345, 27.252013103288846, 74.03486066697752, 131.93287690641475, 10.339447302138229, 227.79103680281486, 261.16805472852724, 25.787929281556345, 1.509303353391187, 169.47498044350695, 73.889060162021, 11.360511106017528, 44.50017283558236, 22.071043589830836, 9.786031747725062, 33.704916855075844, 29.322587076897086, 2.1694834695203737, 183.87693146367283, 125.87132237126013, 103.05187548871666, 66.87452313880682, 242.81976505818457, 30.052485064596244, 12.300855829998365, 119.63935414843252, 66.82177998119414, 163.1885920833793, 111.03831457078051, 51.58459865751112, 89.61785822229845, 107.06577733805779, 253.03953288135887, 45.471342388276234, 23.402335689788575, 274.19089276057394, 44.86179748143059, 318.73473190284415, 85.73568647905643, 321.7247922196776, 221.3982218992095, 17.596309903208784, 64.49303537515215, 153.81438704107106, 156.01066714462206, 126.13416116350062, 115.04455631095374, 85.41179430596429, 113.82168914699537, 204.8021964809222, 16.234662247132924, 2.0166076856658184, 45.64109004716786, 42.0647597912202, 287.0795757437575, 8.33402694810716, 184.94601517790528, 366.66382617770955, 317.0221519491231, 74.92848541611606, 204.1008031247644, 383.94746707380415, 250.45774309880701, 22.530071004211276, 27.752346074808504, 28.510092050685316, 122.79146468517222, 128.86511444154974, 90.87370596102681, 89.44348292973315, 278.77734446713407, 75.91467240452727, 323.64181119743347, 323.1651498811587, 75.37534324871055, 56.283079864622046, 130.4116563830306, 125.82141679712286, 338.0227941162308, 265.96595114641275, 38.85028411076287, 360.3126838715385, 28.67689923099003, 151.87806908921786, 52.77712395414707, 60.26750771580753, 207.16054340750534, 108.76891663301801, 2.206683643877449, 8.681454012398802, 42.47831850665342, 149.45410659458616, 81.4444169396251, 99.87925639079522, 5.6627819024041415, 471.71288759687985, 117.9117425230152, 273.13916754223663, 214.99127178078254, 124.838269200116, 11.17870753348622, 58.54491104478976, 110.94351124024001, 255.05298854340816, 15.063171970732997, 20.448639673851705, 68.5940170201692, 76.61695283182172, 509.24594040456367, 25.03103900516184, 17.780745271044854, 27.272672273210702, 77.87813419604423, 469.84334566753284, 419.5433117781715, 367.44187431284047, 8.499227662319155, 1.662790306443306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5424336289132631, "mean_inference_ms": 1.3481726386450448, "mean_action_processing_ms": 0.23183398637754452, "mean_env_wait_ms": 0.17690696541786374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034464597702026367, "StateBufferConnector_ms": 0.0029822587966918945, "ViewRequirementAgentConnector_ms": 0.09070062637329102}, "num_episodes": 22, "episode_return_max": 406.5834463615538, "episode_return_min": -399.4707564700795, "episode_return_mean": 101.67554412311685, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.12680168769157, "num_env_steps_trained_throughput_per_sec": 440.12680168769157, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 9072.028, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9071.992, "sample_time_ms": 996.39, "learn_time_ms": 8063.257, "learn_throughput": 496.077, "synch_weights_time_ms": 11.521}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "1f15c_00000", "date": "2024-08-16_14-31-13", "timestamp": 1723798873, "time_this_iter_s": 9.091975927352905, "time_total_s": 1677.4522626399994, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffbb5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1677.4522626399994, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 26.907692307692308, "ram_util_percent": 74.57692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.71068018219143, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.2590114371486445, "policy_loss": -0.0054734380095310155, "vf_loss": 6.264369356064569, "vf_explained_var": 0.08932858131549977, "kl": 0.006161463237383281, "entropy": 0.4798528988998403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6969381070326244, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.500538659726502, "policy_loss": -0.003671073219640348, "vf_loss": 7.503400740547786, "vf_explained_var": 0.41966936376990466, "kl": 0.007191032161164104, "entropy": 0.9397349658151152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 566.7228484149556, "episode_reward_min": -408.78486399771776, "episode_reward_mean": 89.76721710543865, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -539.7224711927608, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.2199999999999, "predator_policy": 527.6469287740636}, "policy_reward_mean": {"prey_policy": -92.35770304602752, "predator_policy": 137.2413115987468}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.43365164101724, 5.9106238055379565, 119.87795687549186, 56.60157117559691, 125.82625470123223, 31.569755587172885, -161.84483343717793, 320.80202302103453, 257.96685499867357, 56.16609438601955, 30.990000000000112, 100.77000000000024, 81.36000000000013, 259.90402641704117, 128.57000000000073, 112.82000000000023, 29.720000000000553, -0.8039755401559106, 83.614112324807, -12.214991653841267, -164.0395443457289, 14.223784169408118, 103.66111615934531, 136.4859847357077, 202.19012822550593, 160.3600000000001, 90.25537337762698, 124.95000000000067, 102.32728347653158, 269.18322686209376, 128.35268932930984, 110.78000000000019, 207.7360396663394, 140.01508257181183, -118.30688890760126, 228.58488095924008, -70.25937528737049, 173.28439948916144, 168.54341348809785, -142.31919131158838, -140.28875568830375, 160.86999999999992, 114.18000000000022, 190.93088983134678, 121.20000000000024, 227.4053591300202, 338.4196513847994, 145.3890163434517, 154.4566076856655, 188.13009587291867, 148.4500000000001, 142.66000000000014, -199.88691649302814, 73.21999999999997, -183.24769202322796, 184.66597909901148, 240.51580580741398, 127.03046298952728, 126.43000000000022, -143.6838346399969, 346.1287326672391, 186.89615462520268, 406.5834463615538, -235.3252856824073, 273.6068992309896, 178.3261608160197, 152.89182019826953, 301.6962908024795, 113.22275868010713, 183.70491860757943, -399.4707564700795, 195.754391760024, 212.50743558934215, 130.40000000000026, 149.1199999999999, 129.56000000000034, 61.33454456629244, 22.54780371758782, 15.81322311398458, 155.4199999999999, -63.566307837799286, 3.9499999999999598, 115.49000000000008, 63.61999999999989, 128.50000000000063, 113.51000000000035, -276.0416092286197, -389.29353344020143, 566.7228484149556, 25.555745449094488, 28.06000000000003, 133.18, 23.16903415024375, 147.95276146125136, 77.69301431758109, 194.78230623469688, 111.25999999999999, -5.939894611350107, 139.28947478760097, -408.78486399771776], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-72.52470129331581, -94.29762167420692, -0.7193476767228717, 2.0000000000000013, 49.086574121196435, 2.0000000000000013, -90.80160425439927, 21.1599342491999, 64.35137485627914, 2.0000000000000013, -315.30620578392836, -192.04774484335218, -212.72723514632168, -285.5002924104957, 39.68834497914646, -81.72924692354769, 59.25666142996564, 128.2622706799046, 2.2526451182485454, -83.8336133469784, -0.3391084405783509, -138.51753400920293, -11.848467146699369, 36.753193013514284, 50.01114718128654, -143.93150073446137, 68.02793659452432, -32.237109476951225, 2.0000000000000013, 53.42919216384165, -229.97771729318916, 79.58978298878178, 2.0000000000000013, 23.47403002746346, -30.91002769739332, -2.723975540155898, -91.68355501333984, 16.107544461901334, -178.16795770503157, -222.86696399328815, -236.27521554062565, -241.10719909889337, -11.412481938723062, 2.0000000000000013, -15.842352131189852, 12.677129709400772, 64.06246005314404, 2.0000000000000013, 88.48842870577398, -92.26603805365916, -226.79103680281477, 149.02055269786183, 2.0000000000000013, -198.7006106324584, 122.25069664660911, -168.28498044350707, 22.452795014432166, -5.375082805939412, 118.5422997775324, 84.06971065914846, 91.11342902868003, -6.2516883021716385, 2.0000000000000013, 77.28792945358263, -69.2744807039176, -32.73773346467532, 2.0000000000000013, -31.91131605571205, -178.40586488993424, -212.77327414044902, 96.72540708971975, -0.08073610891034377, -198.4269634775554, -101.84278387439035, 8.661486260870248, 2.0000000000000013, -16.549453028527886, -11.590769043730026, -239.94216284311813, -200.88790373810716, -207.9183442042388, -229.9636399344293, -318.0547319028445, 115.32820251856948, 27.784313520943577, -321.06479221967766, -226.28364197107166, 178.2199999999999, 55.146964624847975, -152.25438704107074, -26.419766468484994, -28.319702709616426, 81.21969979510477, 56.74360097277688, 30.604500215239455, -203.83936949970538, 150.49999999999983, -14.294662247132925, 98.42424603453091, 2.0000000000000013, 139.1559730518928, -286.11957574375805, -42.74601517790536, -366.2038261777099, -305.3878767320107, -286.44967712625834, -202.9908031247645, -311.83746707380425, -225.99264519907567, -230.24286092717068, -5.320140443741627, 133.7236814172594, 39.84885593456099, -50.9896292538681, -19.551580720340752, -33.73514518089185, -277.82734446713494, 49.56532759547265, -376.47592898049936, -414.0148667380897, 114.74494161054739, 99.72536794335953, -90.24045593709548, 20.903537382146148, -368.6952989010893, 171.29000000000005, -320.23295353121813, -314.25530013349123, 145.55000000000013, -52.49806908921781, 2.758390743098763, 62.52313840296683, -146.79624948331139, -16.24139035894323, 141.29815314620345, 149.51000000000005, -20.021067429552566, -58.68859899158085, 0.3812452771596835, 2.0000000000000013, -470.62498499184574, -406.2214409775178, -186.8567591798648, -8.439759125363134, -98.26318145826393, -29.05892393329217, 69.89508895521024, -9.218707533486262, 37.186488759759996, -254.06298854340824, 107.19136032614837, -13.143171970733038, -81.97187953118727, -1.9045457545095732, -472.93165582147464, -38.79751987066314, -31.24019443027099, 2.0000000000000013, 77.36186580395582, -469.66334566753306, -438.07529016509767, -412.4762037637129, 0.32720969355669544, -6.539227662319197, -50.99428444684442, -427.9295000091526, -174.74424791310162, -426.5993695903765, -22.9640911542097, 56.06832498257798, -1.6634074998308521, 28.562923261786338, -392.38453421576315, -410.3378195632936, -421.08852488798027, -432.12650483779504, 116.84000000000009, -539.7224711927608, -384.39311064129544, -168.90945378693408, -437.6279874404523, -303.7953864244213, -489.2523746466212, 35.586340663448404, -51.886962156750975, 10.909999999999963, -410.5804004426611, 2.0000000000000013, -5.95510229160228, -276.67566156699195, -58.20100435867915, 119.39657061800578, 76.36889975318903, -338.6363270881706, -468.60960264556087, -453.0852388527956, -6.996767081614751, 69.11996648569834, -427.2016505293509, -424.8677173686095], "policy_predator_policy_reward": [152.02551605576488, 171.2304585527788, 1.92062380553804, 2.709347676722858, 27.96115894191262, 40.83022381238199, 111.27993837586997, 14.963302804927926, 10.156254701231633, 49.31862514372081, 250.50325683229212, 288.4204493821609, 8.425118329556424, 327.95757579008125, 206.7709089910786, 156.07201597435758, 53.255829911574246, 17.192092977229162, 21.44759882937538, 116.29946378537511, 2.3291084405783455, 167.517534009203, 62.05680698648562, 13.808467146699327, 145.24150073446106, 30.038852818713405, 148.06550035677526, 76.04769894269305, 73.14080783615834, 0.0, 231.0177172931891, 32.190217011218266, 1.9006670665173755, 2.345302906019435, 32.83002769739333, 0.0, 67.12556133080284, 92.06456154544313, 165.39484508975679, 223.42508495472075, 34.53808121388127, 278.80478907990846, 13.37248193872302, 10.2637841694082, 90.02265188904406, 16.803686692090604, 43.171511579274345, 27.252013103288846, 74.03486066697752, 131.93287690641475, 10.339447302138229, 227.79103680281486, 261.16805472852724, 25.787929281556345, 1.509303353391187, 169.47498044350695, 73.889060162021, 11.360511106017528, 44.50017283558236, 22.071043589830836, 9.786031747725062, 33.704916855075844, 29.322587076897086, 2.1694834695203737, 183.87693146367283, 125.87132237126013, 103.05187548871666, 66.87452313880682, 242.81976505818457, 30.052485064596244, 12.300855829998365, 119.63935414843252, 66.82177998119414, 163.1885920833793, 111.03831457078051, 51.58459865751112, 89.61785822229845, 107.06577733805779, 253.03953288135887, 45.471342388276234, 23.402335689788575, 274.19089276057394, 44.86179748143059, 318.73473190284415, 85.73568647905643, 321.7247922196776, 221.3982218992095, 17.596309903208784, 64.49303537515215, 153.81438704107106, 156.01066714462206, 126.13416116350062, 115.04455631095374, 85.41179430596429, 113.82168914699537, 204.8021964809222, 16.234662247132924, 2.0166076856658184, 45.64109004716786, 42.0647597912202, 287.0795757437575, 8.33402694810716, 184.94601517790528, 366.66382617770955, 317.0221519491231, 74.92848541611606, 204.1008031247644, 383.94746707380415, 250.45774309880701, 22.530071004211276, 27.752346074808504, 28.510092050685316, 122.79146468517222, 128.86511444154974, 90.87370596102681, 89.44348292973315, 278.77734446713407, 75.91467240452727, 323.64181119743347, 323.1651498811587, 75.37534324871055, 56.283079864622046, 130.4116563830306, 125.82141679712286, 338.0227941162308, 265.96595114641275, 38.85028411076287, 360.3126838715385, 28.67689923099003, 151.87806908921786, 52.77712395414707, 60.26750771580753, 207.16054340750534, 108.76891663301801, 2.206683643877449, 8.681454012398802, 42.47831850665342, 149.45410659458616, 81.4444169396251, 99.87925639079522, 5.6627819024041415, 471.71288759687985, 117.9117425230152, 273.13916754223663, 214.99127178078254, 124.838269200116, 11.17870753348622, 58.54491104478976, 110.94351124024001, 255.05298854340816, 15.063171970732997, 20.448639673851705, 68.5940170201692, 76.61695283182172, 509.24594040456367, 25.03103900516184, 17.780745271044854, 27.272672273210702, 77.87813419604423, 469.84334566753284, 419.5433117781715, 367.44187431284047, 8.499227662319155, 1.662790306443306, 427.99950000915254, 166.4142844468446, 238.2142479131013, 426.74936959037643, 33.700909533260656, 61.69485663837135, 0.0, 86.61048423804453, 445.99450730625637, 80.68623724418124, 451.74174442599, 12.179751859583945, 520.5263091851025, 469.0790104226136, 527.6469287740636, 51.21138110325987, 331.5853864244207, 437.8979874404522, 489.2523746466212, 97.59365933655161, 11.266862204522273, 52.87913410247152, 243.93990165130387, 312.5932602526082, 319.7470417332818, 40.57673644289342, 74.73128382391803, 58.85545615145199, 339.12632708817057, 34.401100246811055, 463.1684848812302, 452.5864620057764, 67.37003351430158, 9.796241869215246, 6.582256213029072, 436.70224768721346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5418937852691913, "mean_inference_ms": 1.3470801936961727, "mean_action_processing_ms": 0.23159415564671715, "mean_env_wait_ms": 0.1767780500930333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449559211730957, "StateBufferConnector_ms": 0.002955913543701172, "ViewRequirementAgentConnector_ms": 0.09044134616851807}, "num_episodes": 18, "episode_return_max": 566.7228484149556, "episode_return_min": -408.78486399771776, "episode_return_mean": 89.76721710543865, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.54476129886876, "num_env_steps_trained_throughput_per_sec": 435.54476129886876, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 9099.767, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9099.731, "sample_time_ms": 992.993, "learn_time_ms": 8094.222, "learn_throughput": 494.18, "synch_weights_time_ms": 11.694}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "1f15c_00000", "date": "2024-08-16_14-31-22", "timestamp": 1723798882, "time_this_iter_s": 9.187553882598877, "time_total_s": 1686.6398165225983, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f879700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1686.6398165225983, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 25.361538461538466, "ram_util_percent": 74.62307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8540078987520208, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.775014685070704, "policy_loss": -0.005362878905895053, "vf_loss": 6.780257612056833, "vf_explained_var": 0.13342575427716372, "kl": 0.00639783485735994, "entropy": 0.5031712486315025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5184252622266294, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.35201290726031, "policy_loss": -0.004465480875618086, "vf_loss": 7.355390260333107, "vf_explained_var": 0.4203047030186527, "kl": 0.009672094041707343, "entropy": 0.9116789112330744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 566.7228484149556, "episode_reward_min": -408.78486399771776, "episode_reward_mean": 91.2332015208325, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -584.4853182102875, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.2199999999999, "predator_policy": 560.7256423688448}, "policy_reward_mean": {"prey_policy": -119.98122284988895, "predator_policy": 165.59782361030517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.4859847357077, 202.19012822550593, 160.3600000000001, 90.25537337762698, 124.95000000000067, 102.32728347653158, 269.18322686209376, 128.35268932930984, 110.78000000000019, 207.7360396663394, 140.01508257181183, -118.30688890760126, 228.58488095924008, -70.25937528737049, 173.28439948916144, 168.54341348809785, -142.31919131158838, -140.28875568830375, 160.86999999999992, 114.18000000000022, 190.93088983134678, 121.20000000000024, 227.4053591300202, 338.4196513847994, 145.3890163434517, 154.4566076856655, 188.13009587291867, 148.4500000000001, 142.66000000000014, -199.88691649302814, 73.21999999999997, -183.24769202322796, 184.66597909901148, 240.51580580741398, 127.03046298952728, 126.43000000000022, -143.6838346399969, 346.1287326672391, 186.89615462520268, 406.5834463615538, -235.3252856824073, 273.6068992309896, 178.3261608160197, 152.89182019826953, 301.6962908024795, 113.22275868010713, 183.70491860757943, -399.4707564700795, 195.754391760024, 212.50743558934215, 130.40000000000026, 149.1199999999999, 129.56000000000034, 61.33454456629244, 22.54780371758782, 15.81322311398458, 155.4199999999999, -63.566307837799286, 3.9499999999999598, 115.49000000000008, 63.61999999999989, 128.50000000000063, 113.51000000000035, -276.0416092286197, -389.29353344020143, 566.7228484149556, 25.555745449094488, 28.06000000000003, 133.18, 23.16903415024375, 147.95276146125136, 77.69301431758109, 194.78230623469688, 111.25999999999999, -5.939894611350107, 139.28947478760097, -408.78486399771776, -4.110854203192741, -384.4805114492303, 21.71139246214664, -120.19019765801666, 453.238528597423, 182.21905491063728, 94.4394483577083, -338.716544826572, 103.95507020433732, 137.62000000000015, 191.35976184544293, 271.83320829480334, -235.51021173214562, -114.13336352316186, 185.4822381534227, 5.487769269171206, 280.2332593580586, 13.120391621519978, 228.5845982722466, 492.6249803154347, 228.2900291005213, 44.00000000000002, 147.4248744543053], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [64.06246005314404, 2.0000000000000013, 88.48842870577398, -92.26603805365916, -226.79103680281477, 149.02055269786183, 2.0000000000000013, -198.7006106324584, 122.25069664660911, -168.28498044350707, 22.452795014432166, -5.375082805939412, 118.5422997775324, 84.06971065914846, 91.11342902868003, -6.2516883021716385, 2.0000000000000013, 77.28792945358263, -69.2744807039176, -32.73773346467532, 2.0000000000000013, -31.91131605571205, -178.40586488993424, -212.77327414044902, 96.72540708971975, -0.08073610891034377, -198.4269634775554, -101.84278387439035, 8.661486260870248, 2.0000000000000013, -16.549453028527886, -11.590769043730026, -239.94216284311813, -200.88790373810716, -207.9183442042388, -229.9636399344293, -318.0547319028445, 115.32820251856948, 27.784313520943577, -321.06479221967766, -226.28364197107166, 178.2199999999999, 55.146964624847975, -152.25438704107074, -26.419766468484994, -28.319702709616426, 81.21969979510477, 56.74360097277688, 30.604500215239455, -203.83936949970538, 150.49999999999983, -14.294662247132925, 98.42424603453091, 2.0000000000000013, 139.1559730518928, -286.11957574375805, -42.74601517790536, -366.2038261777099, -305.3878767320107, -286.44967712625834, -202.9908031247645, -311.83746707380425, -225.99264519907567, -230.24286092717068, -5.320140443741627, 133.7236814172594, 39.84885593456099, -50.9896292538681, -19.551580720340752, -33.73514518089185, -277.82734446713494, 49.56532759547265, -376.47592898049936, -414.0148667380897, 114.74494161054739, 99.72536794335953, -90.24045593709548, 20.903537382146148, -368.6952989010893, 171.29000000000005, -320.23295353121813, -314.25530013349123, 145.55000000000013, -52.49806908921781, 2.758390743098763, 62.52313840296683, -146.79624948331139, -16.24139035894323, 141.29815314620345, 149.51000000000005, -20.021067429552566, -58.68859899158085, 0.3812452771596835, 2.0000000000000013, -470.62498499184574, -406.2214409775178, -186.8567591798648, -8.439759125363134, -98.26318145826393, -29.05892393329217, 69.89508895521024, -9.218707533486262, 37.186488759759996, -254.06298854340824, 107.19136032614837, -13.143171970733038, -81.97187953118727, -1.9045457545095732, -472.93165582147464, -38.79751987066314, -31.24019443027099, 2.0000000000000013, 77.36186580395582, -469.66334566753306, -438.07529016509767, -412.4762037637129, 0.32720969355669544, -6.539227662319197, -50.99428444684442, -427.9295000091526, -174.74424791310162, -426.5993695903765, -22.9640911542097, 56.06832498257798, -1.6634074998308521, 28.562923261786338, -392.38453421576315, -410.3378195632936, -421.08852488798027, -432.12650483779504, 116.84000000000009, -539.7224711927608, -384.39311064129544, -168.90945378693408, -437.6279874404523, -303.7953864244213, -489.2523746466212, 35.586340663448404, -51.886962156750975, 10.909999999999963, -410.5804004426611, 2.0000000000000013, -5.95510229160228, -276.67566156699195, -58.20100435867915, 119.39657061800578, 76.36889975318903, -338.6363270881706, -468.60960264556087, -453.0852388527956, -6.996767081614751, 69.11996648569834, -427.2016505293509, -424.8677173686095, -507.70933012437723, -380.9438030505074, -461.6844304084929, -421.32907205863313, -60.0706730219421, -185.92371581074326, -508.25439931039506, -547.0451131182382, -524.0115638226314, 128.72000000000003, -259.02725082617536, -11.313662202046917, -157.9444008163806, 2.0000000000000013, -372.7823487085331, -346.51091619375114, -5.238513401298199, -102.65809046576625, -527.3533817043518, 135.66603171250856, -18.088286736598743, 42.41150582946701, 51.18047214531461, 73.11511904724858, -294.6428175670367, -489.47997033356165, -571.8970075883067, -584.4853182102875, -56.22740048913923, -6.982600464315528, 2.0000000000000013, -40.50163896197021, -336.6657192982517, 26.70731650007617, -10.3938058570224, -33.13534502480596, 73.76756339994719, 101.88086092230418, -501.60942082262375, 104.9600000000001, -20.737094856604216, -196.89963280133037, -116.39028279033052, -8.95120806588886, 102.89070181875904, -4.31633477391488], "policy_predator_policy_reward": [43.171511579274345, 27.252013103288846, 74.03486066697752, 131.93287690641475, 10.339447302138229, 227.79103680281486, 261.16805472852724, 25.787929281556345, 1.509303353391187, 169.47498044350695, 73.889060162021, 11.360511106017528, 44.50017283558236, 22.071043589830836, 9.786031747725062, 33.704916855075844, 29.322587076897086, 2.1694834695203737, 183.87693146367283, 125.87132237126013, 103.05187548871666, 66.87452313880682, 242.81976505818457, 30.052485064596244, 12.300855829998365, 119.63935414843252, 66.82177998119414, 163.1885920833793, 111.03831457078051, 51.58459865751112, 89.61785822229845, 107.06577733805779, 253.03953288135887, 45.471342388276234, 23.402335689788575, 274.19089276057394, 44.86179748143059, 318.73473190284415, 85.73568647905643, 321.7247922196776, 221.3982218992095, 17.596309903208784, 64.49303537515215, 153.81438704107106, 156.01066714462206, 126.13416116350062, 115.04455631095374, 85.41179430596429, 113.82168914699537, 204.8021964809222, 16.234662247132924, 2.0166076856658184, 45.64109004716786, 42.0647597912202, 287.0795757437575, 8.33402694810716, 184.94601517790528, 366.66382617770955, 317.0221519491231, 74.92848541611606, 204.1008031247644, 383.94746707380415, 250.45774309880701, 22.530071004211276, 27.752346074808504, 28.510092050685316, 122.79146468517222, 128.86511444154974, 90.87370596102681, 89.44348292973315, 278.77734446713407, 75.91467240452727, 323.64181119743347, 323.1651498811587, 75.37534324871055, 56.283079864622046, 130.4116563830306, 125.82141679712286, 338.0227941162308, 265.96595114641275, 38.85028411076287, 360.3126838715385, 28.67689923099003, 151.87806908921786, 52.77712395414707, 60.26750771580753, 207.16054340750534, 108.76891663301801, 2.206683643877449, 8.681454012398802, 42.47831850665342, 149.45410659458616, 81.4444169396251, 99.87925639079522, 5.6627819024041415, 471.71288759687985, 117.9117425230152, 273.13916754223663, 214.99127178078254, 124.838269200116, 11.17870753348622, 58.54491104478976, 110.94351124024001, 255.05298854340816, 15.063171970732997, 20.448639673851705, 68.5940170201692, 76.61695283182172, 509.24594040456367, 25.03103900516184, 17.780745271044854, 27.272672273210702, 77.87813419604423, 469.84334566753284, 419.5433117781715, 367.44187431284047, 8.499227662319155, 1.662790306443306, 427.99950000915254, 166.4142844468446, 238.2142479131013, 426.74936959037643, 33.700909533260656, 61.69485663837135, 0.0, 86.61048423804453, 445.99450730625637, 80.68623724418124, 451.74174442599, 12.179751859583945, 520.5263091851025, 469.0790104226136, 527.6469287740636, 51.21138110325987, 331.5853864244207, 437.8979874404522, 489.2523746466212, 97.59365933655161, 11.266862204522273, 52.87913410247152, 243.93990165130387, 312.5932602526082, 319.7470417332818, 40.57673644289342, 74.73128382391803, 58.85545615145199, 339.12632708817057, 34.401100246811055, 463.1684848812302, 452.5864620057764, 67.37003351430158, 9.796241869215246, 6.582256213029072, 436.70224768721346, 439.7041896192516, 444.83808935244036, 494.5800994856752, 3.952891532220508, 234.18017083709879, 33.52561045773256, 496.40606132279186, 438.703253447825, 387.8085606227816, 460.7215317972733, 163.73167529831014, 288.8282926405496, 190.76669757470415, 59.617151599383966, 10.028271012999529, 370.54844906271273, 194.58486595169606, 17.266808119705356, 527.3533817043518, 1.9539682874916182, 150.75298186773642, 16.283560884838487, 90.15076916965283, 57.38684793258747, 47.37955418471732, 501.233021983735, 481.52331990658746, 560.7256423688448, 143.77571977962995, 104.91651932724758, 35.19992846148959, 8.789479769651573, 253.95476378248586, 336.23689837375014, 34.985345024805596, 21.664197478542416, 9.566108759934494, 43.37006519006103, 468.1258071095054, 421.1485940285536, 183.90961308988793, 262.01714366856834, 42.982160164684075, 126.35933069153552, 25.11120922822033, 23.73929818124116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5412039097568225, "mean_inference_ms": 1.3456266961737635, "mean_action_processing_ms": 0.23129422366818986, "mean_env_wait_ms": 0.1766153947198889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003437042236328125, "StateBufferConnector_ms": 0.0029573440551757812, "ViewRequirementAgentConnector_ms": 0.08890402317047119}, "num_episodes": 23, "episode_return_max": 566.7228484149556, "episode_return_min": -408.78486399771776, "episode_return_mean": 91.2332015208325, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.24936403614817, "num_env_steps_trained_throughput_per_sec": 435.24936403614817, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 9101.551, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9101.515, "sample_time_ms": 996.203, "learn_time_ms": 8092.959, "learn_throughput": 494.257, "synch_weights_time_ms": 11.532}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "1f15c_00000", "date": "2024-08-16_14-31-31", "timestamp": 1723798891, "time_this_iter_s": 9.193902254104614, "time_total_s": 1695.8337187767029, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f879a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1695.8337187767029, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 24.87692307692308, "ram_util_percent": 74.67692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4006926510384474, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.626509294308052, "policy_loss": -0.005367509727292354, "vf_loss": 6.631705225838555, "vf_explained_var": 0.08087166711766884, "kl": 0.00915071873485469, "entropy": 0.5159978237417009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.287667893984961, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.83166146000857, "policy_loss": -0.00889967452222235, "vf_loss": 7.839236964119805, "vf_explained_var": 0.4138976871336579, "kl": 0.011770423404736505, "entropy": 1.019398820431775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 566.7228484149556, "episode_reward_min": -472.7342060019792, "episode_reward_mean": 79.01604672835637, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -595.8709163339888, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.2199999999999, "predator_policy": 584.6208739248806}, "policy_reward_mean": {"prey_policy": -142.47338972529815, "predator_policy": 181.98141308947635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [160.86999999999992, 114.18000000000022, 190.93088983134678, 121.20000000000024, 227.4053591300202, 338.4196513847994, 145.3890163434517, 154.4566076856655, 188.13009587291867, 148.4500000000001, 142.66000000000014, -199.88691649302814, 73.21999999999997, -183.24769202322796, 184.66597909901148, 240.51580580741398, 127.03046298952728, 126.43000000000022, -143.6838346399969, 346.1287326672391, 186.89615462520268, 406.5834463615538, -235.3252856824073, 273.6068992309896, 178.3261608160197, 152.89182019826953, 301.6962908024795, 113.22275868010713, 183.70491860757943, -399.4707564700795, 195.754391760024, 212.50743558934215, 130.40000000000026, 149.1199999999999, 129.56000000000034, 61.33454456629244, 22.54780371758782, 15.81322311398458, 155.4199999999999, -63.566307837799286, 3.9499999999999598, 115.49000000000008, 63.61999999999989, 128.50000000000063, 113.51000000000035, -276.0416092286197, -389.29353344020143, 566.7228484149556, 25.555745449094488, 28.06000000000003, 133.18, 23.16903415024375, 147.95276146125136, 77.69301431758109, 194.78230623469688, 111.25999999999999, -5.939894611350107, 139.28947478760097, -408.78486399771776, -4.110854203192741, -384.4805114492303, 21.71139246214664, -120.19019765801666, 453.238528597423, 182.21905491063728, 94.4394483577083, -338.716544826572, 103.95507020433732, 137.62000000000015, 191.35976184544293, 271.83320829480334, -235.51021173214562, -114.13336352316186, 185.4822381534227, 5.487769269171206, 280.2332593580586, 13.120391621519978, 228.5845982722466, 492.6249803154347, 228.2900291005213, 44.00000000000002, 147.4248744543053, 200.89144351285444, 33.061519379502464, 101.70145059266127, -90.55209782157388, -472.7342060019792, 129.60072749666355, 125.81866738949805, 244.35478366301197, 92.40296766514423, 100.5960683573984, -416.4012471412191, -346.8879315249041, 124.3551048298961, 182.10662237673722, 168.3495018002426, 166.89440451613422, 61.55221254633116, 145.0488201025529], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-318.0547319028445, 115.32820251856948, 27.784313520943577, -321.06479221967766, -226.28364197107166, 178.2199999999999, 55.146964624847975, -152.25438704107074, -26.419766468484994, -28.319702709616426, 81.21969979510477, 56.74360097277688, 30.604500215239455, -203.83936949970538, 150.49999999999983, -14.294662247132925, 98.42424603453091, 2.0000000000000013, 139.1559730518928, -286.11957574375805, -42.74601517790536, -366.2038261777099, -305.3878767320107, -286.44967712625834, -202.9908031247645, -311.83746707380425, -225.99264519907567, -230.24286092717068, -5.320140443741627, 133.7236814172594, 39.84885593456099, -50.9896292538681, -19.551580720340752, -33.73514518089185, -277.82734446713494, 49.56532759547265, -376.47592898049936, -414.0148667380897, 114.74494161054739, 99.72536794335953, -90.24045593709548, 20.903537382146148, -368.6952989010893, 171.29000000000005, -320.23295353121813, -314.25530013349123, 145.55000000000013, -52.49806908921781, 2.758390743098763, 62.52313840296683, -146.79624948331139, -16.24139035894323, 141.29815314620345, 149.51000000000005, -20.021067429552566, -58.68859899158085, 0.3812452771596835, 2.0000000000000013, -470.62498499184574, -406.2214409775178, -186.8567591798648, -8.439759125363134, -98.26318145826393, -29.05892393329217, 69.89508895521024, -9.218707533486262, 37.186488759759996, -254.06298854340824, 107.19136032614837, -13.143171970733038, -81.97187953118727, -1.9045457545095732, -472.93165582147464, -38.79751987066314, -31.24019443027099, 2.0000000000000013, 77.36186580395582, -469.66334566753306, -438.07529016509767, -412.4762037637129, 0.32720969355669544, -6.539227662319197, -50.99428444684442, -427.9295000091526, -174.74424791310162, -426.5993695903765, -22.9640911542097, 56.06832498257798, -1.6634074998308521, 28.562923261786338, -392.38453421576315, -410.3378195632936, -421.08852488798027, -432.12650483779504, 116.84000000000009, -539.7224711927608, -384.39311064129544, -168.90945378693408, -437.6279874404523, -303.7953864244213, -489.2523746466212, 35.586340663448404, -51.886962156750975, 10.909999999999963, -410.5804004426611, 2.0000000000000013, -5.95510229160228, -276.67566156699195, -58.20100435867915, 119.39657061800578, 76.36889975318903, -338.6363270881706, -468.60960264556087, -453.0852388527956, -6.996767081614751, 69.11996648569834, -427.2016505293509, -424.8677173686095, -507.70933012437723, -380.9438030505074, -461.6844304084929, -421.32907205863313, -60.0706730219421, -185.92371581074326, -508.25439931039506, -547.0451131182382, -524.0115638226314, 128.72000000000003, -259.02725082617536, -11.313662202046917, -157.9444008163806, 2.0000000000000013, -372.7823487085331, -346.51091619375114, -5.238513401298199, -102.65809046576625, -527.3533817043518, 135.66603171250856, -18.088286736598743, 42.41150582946701, 51.18047214531461, 73.11511904724858, -294.6428175670367, -489.47997033356165, -571.8970075883067, -584.4853182102875, -56.22740048913923, -6.982600464315528, 2.0000000000000013, -40.50163896197021, -336.6657192982517, 26.70731650007617, -10.3938058570224, -33.13534502480596, 73.76756339994719, 101.88086092230418, -501.60942082262375, 104.9600000000001, -20.737094856604216, -196.89963280133037, -116.39028279033052, -8.95120806588886, 102.89070181875904, -4.31633477391488, -295.79399070760917, 2.0000000000000013, -131.28468693457967, -117.347685167336, -121.03834316418123, 2.0000000000000013, -529.8034421364637, -494.1245602970446, -560.9793649773225, -595.8709163339888, -228.84732597705477, -162.71374295038098, -208.01930052931752, 8.929999999999959, -30.96001590606288, -56.81951726856008, -157.2710373849511, -12.26219396280093, -88.11084643907469, -85.01979104474248, -512.0594308540445, -449.47141288873513, -430.9605789960115, -371.32141242554763, 30.74204905011889, -95.88129806141343, 50.808316236889446, 14.101001692631263, -121.64681252734141, -169.6771334195564, 39.32130734582239, 63.057157768469175, -0.044244746107035327, -117.26551057557015, 2.0000000000000013, -64.09827866086496], "policy_predator_policy_reward": [44.86179748143059, 318.73473190284415, 85.73568647905643, 321.7247922196776, 221.3982218992095, 17.596309903208784, 64.49303537515215, 153.81438704107106, 156.01066714462206, 126.13416116350062, 115.04455631095374, 85.41179430596429, 113.82168914699537, 204.8021964809222, 16.234662247132924, 2.0166076856658184, 45.64109004716786, 42.0647597912202, 287.0795757437575, 8.33402694810716, 184.94601517790528, 366.66382617770955, 317.0221519491231, 74.92848541611606, 204.1008031247644, 383.94746707380415, 250.45774309880701, 22.530071004211276, 27.752346074808504, 28.510092050685316, 122.79146468517222, 128.86511444154974, 90.87370596102681, 89.44348292973315, 278.77734446713407, 75.91467240452727, 323.64181119743347, 323.1651498811587, 75.37534324871055, 56.283079864622046, 130.4116563830306, 125.82141679712286, 338.0227941162308, 265.96595114641275, 38.85028411076287, 360.3126838715385, 28.67689923099003, 151.87806908921786, 52.77712395414707, 60.26750771580753, 207.16054340750534, 108.76891663301801, 2.206683643877449, 8.681454012398802, 42.47831850665342, 149.45410659458616, 81.4444169396251, 99.87925639079522, 5.6627819024041415, 471.71288759687985, 117.9117425230152, 273.13916754223663, 214.99127178078254, 124.838269200116, 11.17870753348622, 58.54491104478976, 110.94351124024001, 255.05298854340816, 15.063171970732997, 20.448639673851705, 68.5940170201692, 76.61695283182172, 509.24594040456367, 25.03103900516184, 17.780745271044854, 27.272672273210702, 77.87813419604423, 469.84334566753284, 419.5433117781715, 367.44187431284047, 8.499227662319155, 1.662790306443306, 427.99950000915254, 166.4142844468446, 238.2142479131013, 426.74936959037643, 33.700909533260656, 61.69485663837135, 0.0, 86.61048423804453, 445.99450730625637, 80.68623724418124, 451.74174442599, 12.179751859583945, 520.5263091851025, 469.0790104226136, 527.6469287740636, 51.21138110325987, 331.5853864244207, 437.8979874404522, 489.2523746466212, 97.59365933655161, 11.266862204522273, 52.87913410247152, 243.93990165130387, 312.5932602526082, 319.7470417332818, 40.57673644289342, 74.73128382391803, 58.85545615145199, 339.12632708817057, 34.401100246811055, 463.1684848812302, 452.5864620057764, 67.37003351430158, 9.796241869215246, 6.582256213029072, 436.70224768721346, 439.7041896192516, 444.83808935244036, 494.5800994856752, 3.952891532220508, 234.18017083709879, 33.52561045773256, 496.40606132279186, 438.703253447825, 387.8085606227816, 460.7215317972733, 163.73167529831014, 288.8282926405496, 190.76669757470415, 59.617151599383966, 10.028271012999529, 370.54844906271273, 194.58486595169606, 17.266808119705356, 527.3533817043518, 1.9539682874916182, 150.75298186773642, 16.283560884838487, 90.15076916965283, 57.38684793258747, 47.37955418471732, 501.233021983735, 481.52331990658746, 560.7256423688448, 143.77571977962995, 104.91651932724758, 35.19992846148959, 8.789479769651573, 253.95476378248586, 336.23689837375014, 34.985345024805596, 21.664197478542416, 9.566108759934494, 43.37006519006103, 468.1258071095054, 421.1485940285536, 183.90961308988793, 262.01714366856834, 42.982160164684075, 126.35933069153552, 25.11120922822033, 23.73929818124116, 223.28942883822418, 271.3960053822393, 281.6938914814176, 0.0, 110.92991282267951, 109.80988093416238, 420.7297911746502, 512.6461134372848, 99.49520138445068, 584.6208739248806, 245.8707901240878, 275.2910063000106, 132.39172535721326, 192.51624256160085, 146.10811119533213, 186.0262056423034, 133.73832347883555, 128.197875534059, 151.68086541742963, 122.0458404237864, 520.8448968050614, 24.284699796499403, 432.0137012463738, 23.38035865028121, 7.710669687390404, 181.7836841538, 115.63354397877225, 1.5637604684441606, 272.012978437257, 187.66046930988338, 36.86762868754886, 27.6483107142935, 155.34935909038214, 23.51260877762678, 122.10646983307127, 85.04062893034649]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5406429285273617, "mean_inference_ms": 1.3444573666161228, "mean_action_processing_ms": 0.2310540351869344, "mean_env_wait_ms": 0.17650102593140413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034325122833251953, "StateBufferConnector_ms": 0.0029419660568237305, "ViewRequirementAgentConnector_ms": 0.08885633945465088}, "num_episodes": 18, "episode_return_max": 566.7228484149556, "episode_return_min": -472.7342060019792, "episode_return_mean": 79.01604672835637, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.45779710096065, "num_env_steps_trained_throughput_per_sec": 436.45779710096065, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 9115.025, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9114.99, "sample_time_ms": 991.132, "learn_time_ms": 8111.401, "learn_throughput": 493.133, "synch_weights_time_ms": 11.635}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "1f15c_00000", "date": "2024-08-16_14-31-40", "timestamp": 1723798900, "time_this_iter_s": 9.16823697090149, "time_total_s": 1705.0019557476044, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f880160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1705.0019557476044, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 23.323076923076925, "ram_util_percent": 73.96153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4499392351460836, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.830665682484864, "policy_loss": -0.0053172580720413296, "vf_loss": 5.835603883783653, "vf_explained_var": 0.11472417444148392, "kl": 0.020216473868948582, "entropy": 0.5448153170012923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.909860833612069, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.288076526651938, "policy_loss": -0.004811922560825392, "vf_loss": 8.29180790179621, "vf_explained_var": 0.5158378206863605, "kl": 0.009604948678372874, "entropy": 0.9762191643790593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 566.7228484149556, "episode_reward_min": -472.7342060019792, "episode_reward_mean": 67.80965605221547, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -665.60483548717, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 149.51000000000005, "predator_policy": 592.9480078078295}, "policy_reward_mean": {"prey_policy": -155.00937627986215, "predator_policy": 188.91420430596986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-235.3252856824073, 273.6068992309896, 178.3261608160197, 152.89182019826953, 301.6962908024795, 113.22275868010713, 183.70491860757943, -399.4707564700795, 195.754391760024, 212.50743558934215, 130.40000000000026, 149.1199999999999, 129.56000000000034, 61.33454456629244, 22.54780371758782, 15.81322311398458, 155.4199999999999, -63.566307837799286, 3.9499999999999598, 115.49000000000008, 63.61999999999989, 128.50000000000063, 113.51000000000035, -276.0416092286197, -389.29353344020143, 566.7228484149556, 25.555745449094488, 28.06000000000003, 133.18, 23.16903415024375, 147.95276146125136, 77.69301431758109, 194.78230623469688, 111.25999999999999, -5.939894611350107, 139.28947478760097, -408.78486399771776, -4.110854203192741, -384.4805114492303, 21.71139246214664, -120.19019765801666, 453.238528597423, 182.21905491063728, 94.4394483577083, -338.716544826572, 103.95507020433732, 137.62000000000015, 191.35976184544293, 271.83320829480334, -235.51021173214562, -114.13336352316186, 185.4822381534227, 5.487769269171206, 280.2332593580586, 13.120391621519978, 228.5845982722466, 492.6249803154347, 228.2900291005213, 44.00000000000002, 147.4248744543053, 200.89144351285444, 33.061519379502464, 101.70145059266127, -90.55209782157388, -472.7342060019792, 129.60072749666355, 125.81866738949805, 244.35478366301197, 92.40296766514423, 100.5960683573984, -416.4012471412191, -346.8879315249041, 124.3551048298961, 182.10662237673722, 168.3495018002426, 166.89440451613422, 61.55221254633116, 145.0488201025529, 163.18254126138015, -456.13760821110804, 145.8288700604631, 99.87067666988571, 171.8695517776596, 87.07, 135.8722320696562, -9.602138127454102, 264.0499999999999, 101.0829621672496, 117.93817359728418, 111.78640527628303, 55.05000000000002, -63.51457345625801, 82.23852711043318, 152.90124557835304, 62.65720983417678, 145.55, 64.01031112791354, 207.62999999999977, 235.66030429189072, 101.11000000000004], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-320.23295353121813, -314.25530013349123, 145.55000000000013, -52.49806908921781, 2.758390743098763, 62.52313840296683, -146.79624948331139, -16.24139035894323, 141.29815314620345, 149.51000000000005, -20.021067429552566, -58.68859899158085, 0.3812452771596835, 2.0000000000000013, -470.62498499184574, -406.2214409775178, -186.8567591798648, -8.439759125363134, -98.26318145826393, -29.05892393329217, 69.89508895521024, -9.218707533486262, 37.186488759759996, -254.06298854340824, 107.19136032614837, -13.143171970733038, -81.97187953118727, -1.9045457545095732, -472.93165582147464, -38.79751987066314, -31.24019443027099, 2.0000000000000013, 77.36186580395582, -469.66334566753306, -438.07529016509767, -412.4762037637129, 0.32720969355669544, -6.539227662319197, -50.99428444684442, -427.9295000091526, -174.74424791310162, -426.5993695903765, -22.9640911542097, 56.06832498257798, -1.6634074998308521, 28.562923261786338, -392.38453421576315, -410.3378195632936, -421.08852488798027, -432.12650483779504, 116.84000000000009, -539.7224711927608, -384.39311064129544, -168.90945378693408, -437.6279874404523, -303.7953864244213, -489.2523746466212, 35.586340663448404, -51.886962156750975, 10.909999999999963, -410.5804004426611, 2.0000000000000013, -5.95510229160228, -276.67566156699195, -58.20100435867915, 119.39657061800578, 76.36889975318903, -338.6363270881706, -468.60960264556087, -453.0852388527956, -6.996767081614751, 69.11996648569834, -427.2016505293509, -424.8677173686095, -507.70933012437723, -380.9438030505074, -461.6844304084929, -421.32907205863313, -60.0706730219421, -185.92371581074326, -508.25439931039506, -547.0451131182382, -524.0115638226314, 128.72000000000003, -259.02725082617536, -11.313662202046917, -157.9444008163806, 2.0000000000000013, -372.7823487085331, -346.51091619375114, -5.238513401298199, -102.65809046576625, -527.3533817043518, 135.66603171250856, -18.088286736598743, 42.41150582946701, 51.18047214531461, 73.11511904724858, -294.6428175670367, -489.47997033356165, -571.8970075883067, -584.4853182102875, -56.22740048913923, -6.982600464315528, 2.0000000000000013, -40.50163896197021, -336.6657192982517, 26.70731650007617, -10.3938058570224, -33.13534502480596, 73.76756339994719, 101.88086092230418, -501.60942082262375, 104.9600000000001, -20.737094856604216, -196.89963280133037, -116.39028279033052, -8.95120806588886, 102.89070181875904, -4.31633477391488, -295.79399070760917, 2.0000000000000013, -131.28468693457967, -117.347685167336, -121.03834316418123, 2.0000000000000013, -529.8034421364637, -494.1245602970446, -560.9793649773225, -595.8709163339888, -228.84732597705477, -162.71374295038098, -208.01930052931752, 8.929999999999959, -30.96001590606288, -56.81951726856008, -157.2710373849511, -12.26219396280093, -88.11084643907469, -85.01979104474248, -512.0594308540445, -449.47141288873513, -430.9605789960115, -371.32141242554763, 30.74204905011889, -95.88129806141343, 50.808316236889446, 14.101001692631263, -121.64681252734141, -169.6771334195564, 39.32130734582239, 63.057157768469175, -0.044244746107035327, -117.26551057557015, 2.0000000000000013, -64.09827866086496, -146.5118773018062, 2.0000000000000013, -517.4238137093066, -496.29001845973323, -38.149764589937064, 111.89000000000014, -49.8019876252554, -25.92999852204889, 33.7094541051283, 56.88681587278205, -554.2995348709832, 72.26555169223896, -113.32373153793486, -51.755414451858535, -422.91377042107644, -583.7771390328024, 58.571753655720286, 138.12526613040194, 10.823390060712407, -80.00409097563737, -15.377740771222273, -88.24496341287006, -531.0076066475507, 99.01999999999998, -28.546126287921172, -526.1377072849085, -573.362043721831, -665.60483548717, -491.6320715678342, 7.187470125935862, 11.192173779692121, 33.40932312687183, -8.900943513766405, -19.199245877335986, -580.0576765236318, 145.55000000000013, -8.301056379545114, -83.62116919238868, 59.524281731441185, 85.76363381197594, -36.25921348951224, 95.95171758818167, 85.7309095839645, -498.78848986953676], "policy_predator_policy_reward": [38.85028411076287, 360.3126838715385, 28.67689923099003, 151.87806908921786, 52.77712395414707, 60.26750771580753, 207.16054340750534, 108.76891663301801, 2.206683643877449, 8.681454012398802, 42.47831850665342, 149.45410659458616, 81.4444169396251, 99.87925639079522, 5.6627819024041415, 471.71288759687985, 117.9117425230152, 273.13916754223663, 214.99127178078254, 124.838269200116, 11.17870753348622, 58.54491104478976, 110.94351124024001, 255.05298854340816, 15.063171970732997, 20.448639673851705, 68.5940170201692, 76.61695283182172, 509.24594040456367, 25.03103900516184, 17.780745271044854, 27.272672273210702, 77.87813419604423, 469.84334566753284, 419.5433117781715, 367.44187431284047, 8.499227662319155, 1.662790306443306, 427.99950000915254, 166.4142844468446, 238.2142479131013, 426.74936959037643, 33.700909533260656, 61.69485663837135, 0.0, 86.61048423804453, 445.99450730625637, 80.68623724418124, 451.74174442599, 12.179751859583945, 520.5263091851025, 469.0790104226136, 527.6469287740636, 51.21138110325987, 331.5853864244207, 437.8979874404522, 489.2523746466212, 97.59365933655161, 11.266862204522273, 52.87913410247152, 243.93990165130387, 312.5932602526082, 319.7470417332818, 40.57673644289342, 74.73128382391803, 58.85545615145199, 339.12632708817057, 34.401100246811055, 463.1684848812302, 452.5864620057764, 67.37003351430158, 9.796241869215246, 6.582256213029072, 436.70224768721346, 439.7041896192516, 444.83808935244036, 494.5800994856752, 3.952891532220508, 234.18017083709879, 33.52561045773256, 496.40606132279186, 438.703253447825, 387.8085606227816, 460.7215317972733, 163.73167529831014, 288.8282926405496, 190.76669757470415, 59.617151599383966, 10.028271012999529, 370.54844906271273, 194.58486595169606, 17.266808119705356, 527.3533817043518, 1.9539682874916182, 150.75298186773642, 16.283560884838487, 90.15076916965283, 57.38684793258747, 47.37955418471732, 501.233021983735, 481.52331990658746, 560.7256423688448, 143.77571977962995, 104.91651932724758, 35.19992846148959, 8.789479769651573, 253.95476378248586, 336.23689837375014, 34.985345024805596, 21.664197478542416, 9.566108759934494, 43.37006519006103, 468.1258071095054, 421.1485940285536, 183.90961308988793, 262.01714366856834, 42.982160164684075, 126.35933069153552, 25.11120922822033, 23.73929818124116, 223.28942883822418, 271.3960053822393, 281.6938914814176, 0.0, 110.92991282267951, 109.80988093416238, 420.7297911746502, 512.6461134372848, 99.49520138445068, 584.6208739248806, 245.8707901240878, 275.2910063000106, 132.39172535721326, 192.51624256160085, 146.10811119533213, 186.0262056423034, 133.73832347883555, 128.197875534059, 151.68086541742963, 122.0458404237864, 520.8448968050614, 24.284699796499403, 432.0137012463738, 23.38035865028121, 7.710669687390404, 181.7836841538, 115.63354397877225, 1.5637604684441606, 272.012978437257, 187.66046930988338, 36.86762868754886, 27.6483107142935, 155.34935909038214, 23.51260877762678, 122.10646983307127, 85.04062893034649, 142.79194628469983, 164.90247227848698, 3.7089000869230424, 553.8673238710091, 35.47288791612843, 36.615746734270935, 173.3347944025139, 2.267868414676003, 43.94867956996548, 37.32460222978389, 14.804448307761028, 554.2995348709832, 78.78021578106419, 222.17116227838522, 530.1817947897157, 466.9069765367084, 11.59689163153752, 55.75608858234032, 116.15812822589417, 54.10553485628079, 23.23542579222821, 198.32545198914846, 17.79238718431221, 525.9816247395216, 526.1377072849085, 83.59612628792121, 592.9480078078295, 582.5042979449137, 476.5754311887619, 90.10769736356973, 15.170025615447715, 93.12972305634135, 87.15065631052877, 3.6067429147506287, 580.0576765236318, 0.0, 0.0, 155.9325366998478, 62.34208445658306, 0.0, 88.81820045350888, 87.14959973971324, 15.209090416035536, 498.9584898695368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5398719915262248, "mean_inference_ms": 1.3430262747692832, "mean_action_processing_ms": 0.23045034601883002, "mean_env_wait_ms": 0.1762654726462706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034264326095581055, "StateBufferConnector_ms": 0.0029505491256713867, "ViewRequirementAgentConnector_ms": 0.0889275074005127}, "num_episodes": 22, "episode_return_max": 566.7228484149556, "episode_return_min": -472.7342060019792, "episode_return_mean": 67.80965605221547, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.9669716545125, "num_env_steps_trained_throughput_per_sec": 432.9669716545125, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 9125.7, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9125.664, "sample_time_ms": 993.146, "learn_time_ms": 8120.103, "learn_throughput": 492.605, "synch_weights_time_ms": 11.57}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "1f15c_00000", "date": "2024-08-16_14-31-50", "timestamp": 1723798910, "time_this_iter_s": 9.242141246795654, "time_total_s": 1714.2440969944, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffaa280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1714.2440969944, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 24.746153846153845, "ram_util_percent": 73.73076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.51677423299305, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.063840893589, "policy_loss": -0.006882067721598244, "vf_loss": 7.070503801012796, "vf_explained_var": 0.07573151383450423, "kl": 0.007791454886003242, "entropy": 0.5339115000906445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0104850886675414, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.562267123328315, "policy_loss": -0.004388669780923655, "vf_loss": 7.565785704466401, "vf_explained_var": 0.30838202641754553, "kl": 0.0077341965246346045, "entropy": 0.9636143453222104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 615.1659285545621, "episode_reward_min": -472.7342060019792, "episode_reward_mean": 62.85182609912682, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -883.3246092976951, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 145.55000000000013, "predator_policy": 883.3246092976951}, "policy_reward_mean": {"prey_policy": -189.2611476779532, "predator_policy": 220.68706072751658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.9499999999999598, 115.49000000000008, 63.61999999999989, 128.50000000000063, 113.51000000000035, -276.0416092286197, -389.29353344020143, 566.7228484149556, 25.555745449094488, 28.06000000000003, 133.18, 23.16903415024375, 147.95276146125136, 77.69301431758109, 194.78230623469688, 111.25999999999999, -5.939894611350107, 139.28947478760097, -408.78486399771776, -4.110854203192741, -384.4805114492303, 21.71139246214664, -120.19019765801666, 453.238528597423, 182.21905491063728, 94.4394483577083, -338.716544826572, 103.95507020433732, 137.62000000000015, 191.35976184544293, 271.83320829480334, -235.51021173214562, -114.13336352316186, 185.4822381534227, 5.487769269171206, 280.2332593580586, 13.120391621519978, 228.5845982722466, 492.6249803154347, 228.2900291005213, 44.00000000000002, 147.4248744543053, 200.89144351285444, 33.061519379502464, 101.70145059266127, -90.55209782157388, -472.7342060019792, 129.60072749666355, 125.81866738949805, 244.35478366301197, 92.40296766514423, 100.5960683573984, -416.4012471412191, -346.8879315249041, 124.3551048298961, 182.10662237673722, 168.3495018002426, 166.89440451613422, 61.55221254633116, 145.0488201025529, 163.18254126138015, -456.13760821110804, 145.8288700604631, 99.87067666988571, 171.8695517776596, 87.07, 135.8722320696562, -9.602138127454102, 264.0499999999999, 101.0829621672496, 117.93817359728418, 111.78640527628303, 55.05000000000002, -63.51457345625801, 82.23852711043318, 152.90124557835304, 62.65720983417678, 145.55, 64.01031112791354, 207.62999999999977, 235.66030429189072, 101.11000000000004, 81.56616942324553, -110.49737243395705, 34.64000000000008, 86.71194954504773, 91.10000000000038, 92.42341723711333, -225.55369104777878, 615.1659285545621, -207.97738547523545, 16.73999999999999, 19.21000000000001, 112.42372387586175, -72.80535986954408, 126.3667718541345, 166.72364786836326, 8.49506354991252, 163.76239344807334, 83.26564525372464], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.32720969355669544, -6.539227662319197, -50.99428444684442, -427.9295000091526, -174.74424791310162, -426.5993695903765, -22.9640911542097, 56.06832498257798, -1.6634074998308521, 28.562923261786338, -392.38453421576315, -410.3378195632936, -421.08852488798027, -432.12650483779504, 116.84000000000009, -539.7224711927608, -384.39311064129544, -168.90945378693408, -437.6279874404523, -303.7953864244213, -489.2523746466212, 35.586340663448404, -51.886962156750975, 10.909999999999963, -410.5804004426611, 2.0000000000000013, -5.95510229160228, -276.67566156699195, -58.20100435867915, 119.39657061800578, 76.36889975318903, -338.6363270881706, -468.60960264556087, -453.0852388527956, -6.996767081614751, 69.11996648569834, -427.2016505293509, -424.8677173686095, -507.70933012437723, -380.9438030505074, -461.6844304084929, -421.32907205863313, -60.0706730219421, -185.92371581074326, -508.25439931039506, -547.0451131182382, -524.0115638226314, 128.72000000000003, -259.02725082617536, -11.313662202046917, -157.9444008163806, 2.0000000000000013, -372.7823487085331, -346.51091619375114, -5.238513401298199, -102.65809046576625, -527.3533817043518, 135.66603171250856, -18.088286736598743, 42.41150582946701, 51.18047214531461, 73.11511904724858, -294.6428175670367, -489.47997033356165, -571.8970075883067, -584.4853182102875, -56.22740048913923, -6.982600464315528, 2.0000000000000013, -40.50163896197021, -336.6657192982517, 26.70731650007617, -10.3938058570224, -33.13534502480596, 73.76756339994719, 101.88086092230418, -501.60942082262375, 104.9600000000001, -20.737094856604216, -196.89963280133037, -116.39028279033052, -8.95120806588886, 102.89070181875904, -4.31633477391488, -295.79399070760917, 2.0000000000000013, -131.28468693457967, -117.347685167336, -121.03834316418123, 2.0000000000000013, -529.8034421364637, -494.1245602970446, -560.9793649773225, -595.8709163339888, -228.84732597705477, -162.71374295038098, -208.01930052931752, 8.929999999999959, -30.96001590606288, -56.81951726856008, -157.2710373849511, -12.26219396280093, -88.11084643907469, -85.01979104474248, -512.0594308540445, -449.47141288873513, -430.9605789960115, -371.32141242554763, 30.74204905011889, -95.88129806141343, 50.808316236889446, 14.101001692631263, -121.64681252734141, -169.6771334195564, 39.32130734582239, 63.057157768469175, -0.044244746107035327, -117.26551057557015, 2.0000000000000013, -64.09827866086496, -146.5118773018062, 2.0000000000000013, -517.4238137093066, -496.29001845973323, -38.149764589937064, 111.89000000000014, -49.8019876252554, -25.92999852204889, 33.7094541051283, 56.88681587278205, -554.2995348709832, 72.26555169223896, -113.32373153793486, -51.755414451858535, -422.91377042107644, -583.7771390328024, 58.571753655720286, 138.12526613040194, 10.823390060712407, -80.00409097563737, -15.377740771222273, -88.24496341287006, -531.0076066475507, 99.01999999999998, -28.546126287921172, -526.1377072849085, -573.362043721831, -665.60483548717, -491.6320715678342, 7.187470125935862, 11.192173779692121, 33.40932312687183, -8.900943513766405, -19.199245877335986, -580.0576765236318, 145.55000000000013, -8.301056379545114, -83.62116919238868, 59.524281731441185, 85.76363381197594, -36.25921348951224, 95.95171758818167, 85.7309095839645, -498.78848986953676, -146.15557370690863, -129.7119314492783, -685.8645644126868, -611.621074128561, -9.712615625326327, -168.6359001051989, -42.08576641200489, -4.6692407830532945, -1.2557715383513977, 89.12000000000015, -229.73305412518513, -241.5879825290956, -756.9010784797318, -759.9758749180423, -724.3613472693011, 128.7200000000002, -806.7525602436033, -783.8811335702183, -222.72421948515034, -883.3246092976951, -138.33264751087114, -510.9859856486139, -97.2176032609361, -23.167625976778627, -664.1608367585679, -585.3415355382406, 1.5634708517111868, -89.58110663220879, -47.40830786493161, -14.75350532050472, -275.5395123507332, -658.2052868601162, -121.63538029645062, 0.0567344654111939, -8.272678004225027, -180.28662515378983], "policy_predator_policy_reward": [8.499227662319155, 1.662790306443306, 427.99950000915254, 166.4142844468446, 238.2142479131013, 426.74936959037643, 33.700909533260656, 61.69485663837135, 0.0, 86.61048423804453, 445.99450730625637, 80.68623724418124, 451.74174442599, 12.179751859583945, 520.5263091851025, 469.0790104226136, 527.6469287740636, 51.21138110325987, 331.5853864244207, 437.8979874404522, 489.2523746466212, 97.59365933655161, 11.266862204522273, 52.87913410247152, 243.93990165130387, 312.5932602526082, 319.7470417332818, 40.57673644289342, 74.73128382391803, 58.85545615145199, 339.12632708817057, 34.401100246811055, 463.1684848812302, 452.5864620057764, 67.37003351430158, 9.796241869215246, 6.582256213029072, 436.70224768721346, 439.7041896192516, 444.83808935244036, 494.5800994856752, 3.952891532220508, 234.18017083709879, 33.52561045773256, 496.40606132279186, 438.703253447825, 387.8085606227816, 460.7215317972733, 163.73167529831014, 288.8282926405496, 190.76669757470415, 59.617151599383966, 10.028271012999529, 370.54844906271273, 194.58486595169606, 17.266808119705356, 527.3533817043518, 1.9539682874916182, 150.75298186773642, 16.283560884838487, 90.15076916965283, 57.38684793258747, 47.37955418471732, 501.233021983735, 481.52331990658746, 560.7256423688448, 143.77571977962995, 104.91651932724758, 35.19992846148959, 8.789479769651573, 253.95476378248586, 336.23689837375014, 34.985345024805596, 21.664197478542416, 9.566108759934494, 43.37006519006103, 468.1258071095054, 421.1485940285536, 183.90961308988793, 262.01714366856834, 42.982160164684075, 126.35933069153552, 25.11120922822033, 23.73929818124116, 223.28942883822418, 271.3960053822393, 281.6938914814176, 0.0, 110.92991282267951, 109.80988093416238, 420.7297911746502, 512.6461134372848, 99.49520138445068, 584.6208739248806, 245.8707901240878, 275.2910063000106, 132.39172535721326, 192.51624256160085, 146.10811119533213, 186.0262056423034, 133.73832347883555, 128.197875534059, 151.68086541742963, 122.0458404237864, 520.8448968050614, 24.284699796499403, 432.0137012463738, 23.38035865028121, 7.710669687390404, 181.7836841538, 115.63354397877225, 1.5637604684441606, 272.012978437257, 187.66046930988338, 36.86762868754886, 27.6483107142935, 155.34935909038214, 23.51260877762678, 122.10646983307127, 85.04062893034649, 142.79194628469983, 164.90247227848698, 3.7089000869230424, 553.8673238710091, 35.47288791612843, 36.615746734270935, 173.3347944025139, 2.267868414676003, 43.94867956996548, 37.32460222978389, 14.804448307761028, 554.2995348709832, 78.78021578106419, 222.17116227838522, 530.1817947897157, 466.9069765367084, 11.59689163153752, 55.75608858234032, 116.15812822589417, 54.10553485628079, 23.23542579222821, 198.32545198914846, 17.79238718431221, 525.9816247395216, 526.1377072849085, 83.59612628792121, 592.9480078078295, 582.5042979449137, 476.5754311887619, 90.10769736356973, 15.170025615447715, 93.12972305634135, 87.15065631052877, 3.6067429147506287, 580.0576765236318, 0.0, 0.0, 155.9325366998478, 62.34208445658306, 0.0, 88.81820045350888, 87.14959973971324, 15.209090416035536, 498.9584898695368, 233.47337840428364, 123.96029617514864, 684.8071626038676, 502.1811035034237, 201.32590010519897, 11.662615625326286, 66.84569993027608, 66.62125680982935, 3.235771538351377, 0.0, 275.14711519780667, 288.5973386935864, 590.5665531231878, 700.7567092268121, 703.6573460556269, 507.1499297682355, 735.8085806829137, 646.8477276556761, 239.4642194851503, 883.3246092976951, 511.1459856486139, 157.38264751087084, 224.96074474786474, 7.848208365711987, 531.4541994913232, 645.2428129359423, 121.15312427023675, 93.23128336439521, 152.05821379252427, 76.82724726127539, 284.00457590064576, 658.2352868601164, 167.63303465206903, 117.70800462704422, 107.75110978977388, 164.07383862196605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.539474192130989, "mean_inference_ms": 1.3421223865901388, "mean_action_processing_ms": 0.23056167872171063, "mean_env_wait_ms": 0.17629489924194236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034519433975219727, "StateBufferConnector_ms": 0.002814173698425293, "ViewRequirementAgentConnector_ms": 0.08297443389892578}, "num_episodes": 18, "episode_return_max": 615.1659285545621, "episode_return_min": -472.7342060019792, "episode_return_mean": 62.85182609912682, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.89231976002037, "num_env_steps_trained_throughput_per_sec": 436.89231976002037, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 9145.439, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9145.404, "sample_time_ms": 993.339, "learn_time_ms": 8139.701, "learn_throughput": 491.419, "synch_weights_time_ms": 11.521}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "1f15c_00000", "date": "2024-08-16_14-31-59", "timestamp": 1723798919, "time_this_iter_s": 9.159597158432007, "time_total_s": 1723.403694152832, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f879700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1723.403694152832, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 25.3923076923077, "ram_util_percent": 73.91538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9284640748664816, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.585372616752745, "policy_loss": -0.0038745650600287176, "vf_loss": 7.588977709775248, "vf_explained_var": 0.031627914293733225, "kl": 0.00958163025623704, "entropy": 0.6077945059569424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3382419100514165, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.899194313483264, "policy_loss": -0.006146023548873407, "vf_loss": 7.904251125123766, "vf_explained_var": 0.2702658710971711, "kl": 0.00968179252931201, "entropy": 0.984631961426407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 675.8660331475864, "episode_reward_min": -472.7342060019792, "episode_reward_mean": 86.44121528530319, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -922.5700012529294, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 145.55000000000013, "predator_policy": 922.5700012529294}, "policy_reward_mean": {"prey_policy": -175.3323186951085, "predator_policy": 218.55292633776014}, "custom_metrics": {}, "hist_stats": {"episode_reward": [453.238528597423, 182.21905491063728, 94.4394483577083, -338.716544826572, 103.95507020433732, 137.62000000000015, 191.35976184544293, 271.83320829480334, -235.51021173214562, -114.13336352316186, 185.4822381534227, 5.487769269171206, 280.2332593580586, 13.120391621519978, 228.5845982722466, 492.6249803154347, 228.2900291005213, 44.00000000000002, 147.4248744543053, 200.89144351285444, 33.061519379502464, 101.70145059266127, -90.55209782157388, -472.7342060019792, 129.60072749666355, 125.81866738949805, 244.35478366301197, 92.40296766514423, 100.5960683573984, -416.4012471412191, -346.8879315249041, 124.3551048298961, 182.10662237673722, 168.3495018002426, 166.89440451613422, 61.55221254633116, 145.0488201025529, 163.18254126138015, -456.13760821110804, 145.8288700604631, 99.87067666988571, 171.8695517776596, 87.07, 135.8722320696562, -9.602138127454102, 264.0499999999999, 101.0829621672496, 117.93817359728418, 111.78640527628303, 55.05000000000002, -63.51457345625801, 82.23852711043318, 152.90124557835304, 62.65720983417678, 145.55, 64.01031112791354, 207.62999999999977, 235.66030429189072, 101.11000000000004, 81.56616942324553, -110.49737243395705, 34.64000000000008, 86.71194954504773, 91.10000000000038, 92.42341723711333, -225.55369104777878, 615.1659285545621, -207.97738547523545, 16.73999999999999, 19.21000000000001, 112.42372387586175, -72.80535986954408, 126.3667718541345, 166.72364786836326, 8.49506354991252, 163.76239344807334, 83.26564525372464, 244.5399999999989, 47.98712511208513, 5.709562334286714, 119.81085961269972, 158.2579789458664, 157.34999999999997, 63.54451287689924, 62.98801767995903, 81.72488238651661, 24.550000000000004, 40.05107813158333, 14.6914568562904, 675.8660331475864, 52.09999999999998, 129.96342304753614, 249.45999999999978, 74.60660040957953, -50.01623815452107, 113.53308361943567, 61.96999999999996, 111.79938623105608, 78.27999999999997, 145.7762690700237], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-524.0115638226314, 128.72000000000003, -259.02725082617536, -11.313662202046917, -157.9444008163806, 2.0000000000000013, -372.7823487085331, -346.51091619375114, -5.238513401298199, -102.65809046576625, -527.3533817043518, 135.66603171250856, -18.088286736598743, 42.41150582946701, 51.18047214531461, 73.11511904724858, -294.6428175670367, -489.47997033356165, -571.8970075883067, -584.4853182102875, -56.22740048913923, -6.982600464315528, 2.0000000000000013, -40.50163896197021, -336.6657192982517, 26.70731650007617, -10.3938058570224, -33.13534502480596, 73.76756339994719, 101.88086092230418, -501.60942082262375, 104.9600000000001, -20.737094856604216, -196.89963280133037, -116.39028279033052, -8.95120806588886, 102.89070181875904, -4.31633477391488, -295.79399070760917, 2.0000000000000013, -131.28468693457967, -117.347685167336, -121.03834316418123, 2.0000000000000013, -529.8034421364637, -494.1245602970446, -560.9793649773225, -595.8709163339888, -228.84732597705477, -162.71374295038098, -208.01930052931752, 8.929999999999959, -30.96001590606288, -56.81951726856008, -157.2710373849511, -12.26219396280093, -88.11084643907469, -85.01979104474248, -512.0594308540445, -449.47141288873513, -430.9605789960115, -371.32141242554763, 30.74204905011889, -95.88129806141343, 50.808316236889446, 14.101001692631263, -121.64681252734141, -169.6771334195564, 39.32130734582239, 63.057157768469175, -0.044244746107035327, -117.26551057557015, 2.0000000000000013, -64.09827866086496, -146.5118773018062, 2.0000000000000013, -517.4238137093066, -496.29001845973323, -38.149764589937064, 111.89000000000014, -49.8019876252554, -25.92999852204889, 33.7094541051283, 56.88681587278205, -554.2995348709832, 72.26555169223896, -113.32373153793486, -51.755414451858535, -422.91377042107644, -583.7771390328024, 58.571753655720286, 138.12526613040194, 10.823390060712407, -80.00409097563737, -15.377740771222273, -88.24496341287006, -531.0076066475507, 99.01999999999998, -28.546126287921172, -526.1377072849085, -573.362043721831, -665.60483548717, -491.6320715678342, 7.187470125935862, 11.192173779692121, 33.40932312687183, -8.900943513766405, -19.199245877335986, -580.0576765236318, 145.55000000000013, -8.301056379545114, -83.62116919238868, 59.524281731441185, 85.76363381197594, -36.25921348951224, 95.95171758818167, 85.7309095839645, -498.78848986953676, -146.15557370690863, -129.7119314492783, -685.8645644126868, -611.621074128561, -9.712615625326327, -168.6359001051989, -42.08576641200489, -4.6692407830532945, -1.2557715383513977, 89.12000000000015, -229.73305412518513, -241.5879825290956, -756.9010784797318, -759.9758749180423, -724.3613472693011, 128.7200000000002, -806.7525602436033, -783.8811335702183, -222.72421948515034, -883.3246092976951, -138.33264751087114, -510.9859856486139, -97.2176032609361, -23.167625976778627, -664.1608367585679, -585.3415355382406, 1.5634708517111868, -89.58110663220879, -47.40830786493161, -14.75350532050472, -275.5395123507332, -658.2052868601162, -121.63538029645062, 0.0567344654111939, -8.272678004225027, -180.28662515378983, 126.13843527135212, 112.88000000000031, -288.97484502592914, -15.151719074711524, -720.1605184076138, -217.96100010525933, -287.1944440269423, -102.60456857257287, 73.40942181383441, -46.51459568144528, 127.6517109649778, -657.4183349392647, -63.4646228659484, -75.15206677071333, -82.23347456892961, -123.60344513994497, -41.710236976717056, -74.0708002158779, -922.5700012529294, -301.3245670174729, -0.09992229084124231, -140.58213900475977, -21.377439031140593, -1.293029209905084, 100.01000000000019, -909.6737662909813, -530.2170566135168, -85.6289167313018, 120.60166379120946, -8.005673117055972, 116.13412942927977, 122.97099299984161, -5.439694046441112, -69.39693612215821, -262.3412673358163, -275.4074742611984, -368.7644768903075, -223.764474864625, -21.903141877918358, -846.5246168931686, 20.044778702624242, -32.41746366450679, -646.7190760281608, 78.23000000000002, -267.0321294100058, -47.15643381911424], "policy_predator_policy_reward": [387.8085606227816, 460.7215317972733, 163.73167529831014, 288.8282926405496, 190.76669757470415, 59.617151599383966, 10.028271012999529, 370.54844906271273, 194.58486595169606, 17.266808119705356, 527.3533817043518, 1.9539682874916182, 150.75298186773642, 16.283560884838487, 90.15076916965283, 57.38684793258747, 47.37955418471732, 501.233021983735, 481.52331990658746, 560.7256423688448, 143.77571977962995, 104.91651932724758, 35.19992846148959, 8.789479769651573, 253.95476378248586, 336.23689837375014, 34.985345024805596, 21.664197478542416, 9.566108759934494, 43.37006519006103, 468.1258071095054, 421.1485940285536, 183.90961308988793, 262.01714366856834, 42.982160164684075, 126.35933069153552, 25.11120922822033, 23.73929818124116, 223.28942883822418, 271.3960053822393, 281.6938914814176, 0.0, 110.92991282267951, 109.80988093416238, 420.7297911746502, 512.6461134372848, 99.49520138445068, 584.6208739248806, 245.8707901240878, 275.2910063000106, 132.39172535721326, 192.51624256160085, 146.10811119533213, 186.0262056423034, 133.73832347883555, 128.197875534059, 151.68086541742963, 122.0458404237864, 520.8448968050614, 24.284699796499403, 432.0137012463738, 23.38035865028121, 7.710669687390404, 181.7836841538, 115.63354397877225, 1.5637604684441606, 272.012978437257, 187.66046930988338, 36.86762868754886, 27.6483107142935, 155.34935909038214, 23.51260877762678, 122.10646983307127, 85.04062893034649, 142.79194628469983, 164.90247227848698, 3.7089000869230424, 553.8673238710091, 35.47288791612843, 36.615746734270935, 173.3347944025139, 2.267868414676003, 43.94867956996548, 37.32460222978389, 14.804448307761028, 554.2995348709832, 78.78021578106419, 222.17116227838522, 530.1817947897157, 466.9069765367084, 11.59689163153752, 55.75608858234032, 116.15812822589417, 54.10553485628079, 23.23542579222821, 198.32545198914846, 17.79238718431221, 525.9816247395216, 526.1377072849085, 83.59612628792121, 592.9480078078295, 582.5042979449137, 476.5754311887619, 90.10769736356973, 15.170025615447715, 93.12972305634135, 87.15065631052877, 3.6067429147506287, 580.0576765236318, 0.0, 0.0, 155.9325366998478, 62.34208445658306, 0.0, 88.81820045350888, 87.14959973971324, 15.209090416035536, 498.9584898695368, 233.47337840428364, 123.96029617514864, 684.8071626038676, 502.1811035034237, 201.32590010519897, 11.662615625326286, 66.84569993027608, 66.62125680982935, 3.235771538351377, 0.0, 275.14711519780667, 288.5973386935864, 590.5665531231878, 700.7567092268121, 703.6573460556269, 507.1499297682355, 735.8085806829137, 646.8477276556761, 239.4642194851503, 883.3246092976951, 511.1459856486139, 157.38264751087084, 224.96074474786474, 7.848208365711987, 531.4541994913232, 645.2428129359423, 121.15312427023675, 93.23128336439521, 152.05821379252427, 76.82724726127539, 284.00457590064576, 658.2352868601164, 167.63303465206903, 117.70800462704422, 107.75110978977388, 164.07383862196605, 5.521564728648179, 0.0, 128.55601822815586, 223.5576709845697, 225.86364553522802, 717.9674353119318, 323.5714536704114, 186.03841854180314, 1.9785571320320279, 129.38459568144557, 29.67828903502225, 657.4383349392647, 5.88451287689929, 196.27668963666278, 60.88118727066711, 207.94375011816663, 175.8403560767694, 21.665563502342508, 922.5700012529294, 325.8745670174724, 51.135251676952144, 129.59788775023213, 23.307439031140895, 14.054486066195544, 657.960492514006, 827.5693069245634, 135.47891673130206, 532.4670566135168, 9.95567311705593, 7.411759256326206, 6.76261947029244, 3.5922581005862684, 127.8121764395959, 21.63105413858293, 177.7393282336195, 309.9931752088739, 423.8459244916562, 282.2161108827107, 846.5246168931686, 83.87314187791829, 65.75580638038798, 58.41626481254991, 3.412519021003791, 643.356557007157, 253.03735843245406, 206.92747386668893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5390402759568006, "mean_inference_ms": 1.3402480611453662, "mean_action_processing_ms": 0.2302148494352593, "mean_env_wait_ms": 0.17638061072270333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038565397262573242, "StateBufferConnector_ms": 0.002813100814819336, "ViewRequirementAgentConnector_ms": 0.0824364423751831}, "num_episodes": 23, "episode_return_max": 675.8660331475864, "episode_return_min": -472.7342060019792, "episode_return_mean": 86.44121528530319, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.038546201252, "num_env_steps_trained_throughput_per_sec": 421.038546201252, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 9168.912, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9168.877, "sample_time_ms": 994.41, "learn_time_ms": 8162.037, "learn_throughput": 490.074, "synch_weights_time_ms": 11.579}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "1f15c_00000", "date": "2024-08-16_14-32-08", "timestamp": 1723798928, "time_this_iter_s": 9.503641843795776, "time_total_s": 1732.9073359966278, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f879a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1732.9073359966278, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 27.669230769230772, "ram_util_percent": 74.22307692307695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7055809607423802, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.046894002591491, "policy_loss": -0.004757654530774783, "vf_loss": 8.05137582809206, "vf_explained_var": 0.0035774554525102886, "kl": 0.009807400386872537, "entropy": 0.6195462385498026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5985741104083084, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.372316408914234, "policy_loss": -0.00402280139470739, "vf_loss": 8.375362269335954, "vf_explained_var": 0.23006441905384972, "kl": 0.00868386382519674, "entropy": 0.9395415901507019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 675.8660331475864, "episode_reward_min": -887.1755396675396, "episode_reward_mean": 56.217668202787145, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1167.611142666553, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 145.55000000000013, "predator_policy": 1203.4101299054303}, "policy_reward_mean": {"prey_policy": -215.6150531348964, "predator_policy": 243.72388723629004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.4248744543053, 200.89144351285444, 33.061519379502464, 101.70145059266127, -90.55209782157388, -472.7342060019792, 129.60072749666355, 125.81866738949805, 244.35478366301197, 92.40296766514423, 100.5960683573984, -416.4012471412191, -346.8879315249041, 124.3551048298961, 182.10662237673722, 168.3495018002426, 166.89440451613422, 61.55221254633116, 145.0488201025529, 163.18254126138015, -456.13760821110804, 145.8288700604631, 99.87067666988571, 171.8695517776596, 87.07, 135.8722320696562, -9.602138127454102, 264.0499999999999, 101.0829621672496, 117.93817359728418, 111.78640527628303, 55.05000000000002, -63.51457345625801, 82.23852711043318, 152.90124557835304, 62.65720983417678, 145.55, 64.01031112791354, 207.62999999999977, 235.66030429189072, 101.11000000000004, 81.56616942324553, -110.49737243395705, 34.64000000000008, 86.71194954504773, 91.10000000000038, 92.42341723711333, -225.55369104777878, 615.1659285545621, -207.97738547523545, 16.73999999999999, 19.21000000000001, 112.42372387586175, -72.80535986954408, 126.3667718541345, 166.72364786836326, 8.49506354991252, 163.76239344807334, 83.26564525372464, 244.5399999999989, 47.98712511208513, 5.709562334286714, 119.81085961269972, 158.2579789458664, 157.34999999999997, 63.54451287689924, 62.98801767995903, 81.72488238651661, 24.550000000000004, 40.05107813158333, 14.6914568562904, 675.8660331475864, 52.09999999999998, 129.96342304753614, 249.45999999999978, 74.60660040957953, -50.01623815452107, 113.53308361943567, 61.96999999999996, 111.79938623105608, 78.27999999999997, 145.7762690700237, 105.56537017771105, 114.45975348271875, 10.97, 66.1214608330354, 59.24340194667019, -345.5362949157109, 109.6204644305253, 89.5894317454971, -206.4246461211823, 199.8184779991594, -49.557758099443845, 8.780661262279462, 45.98466311011536, -330.46751694622935, 105.80175968799, 66.84000000000003, -887.1755396675396, 38.13982104164667], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [102.89070181875904, -4.31633477391488, -295.79399070760917, 2.0000000000000013, -131.28468693457967, -117.347685167336, -121.03834316418123, 2.0000000000000013, -529.8034421364637, -494.1245602970446, -560.9793649773225, -595.8709163339888, -228.84732597705477, -162.71374295038098, -208.01930052931752, 8.929999999999959, -30.96001590606288, -56.81951726856008, -157.2710373849511, -12.26219396280093, -88.11084643907469, -85.01979104474248, -512.0594308540445, -449.47141288873513, -430.9605789960115, -371.32141242554763, 30.74204905011889, -95.88129806141343, 50.808316236889446, 14.101001692631263, -121.64681252734141, -169.6771334195564, 39.32130734582239, 63.057157768469175, -0.044244746107035327, -117.26551057557015, 2.0000000000000013, -64.09827866086496, -146.5118773018062, 2.0000000000000013, -517.4238137093066, -496.29001845973323, -38.149764589937064, 111.89000000000014, -49.8019876252554, -25.92999852204889, 33.7094541051283, 56.88681587278205, -554.2995348709832, 72.26555169223896, -113.32373153793486, -51.755414451858535, -422.91377042107644, -583.7771390328024, 58.571753655720286, 138.12526613040194, 10.823390060712407, -80.00409097563737, -15.377740771222273, -88.24496341287006, -531.0076066475507, 99.01999999999998, -28.546126287921172, -526.1377072849085, -573.362043721831, -665.60483548717, -491.6320715678342, 7.187470125935862, 11.192173779692121, 33.40932312687183, -8.900943513766405, -19.199245877335986, -580.0576765236318, 145.55000000000013, -8.301056379545114, -83.62116919238868, 59.524281731441185, 85.76363381197594, -36.25921348951224, 95.95171758818167, 85.7309095839645, -498.78848986953676, -146.15557370690863, -129.7119314492783, -685.8645644126868, -611.621074128561, -9.712615625326327, -168.6359001051989, -42.08576641200489, -4.6692407830532945, -1.2557715383513977, 89.12000000000015, -229.73305412518513, -241.5879825290956, -756.9010784797318, -759.9758749180423, -724.3613472693011, 128.7200000000002, -806.7525602436033, -783.8811335702183, -222.72421948515034, -883.3246092976951, -138.33264751087114, -510.9859856486139, -97.2176032609361, -23.167625976778627, -664.1608367585679, -585.3415355382406, 1.5634708517111868, -89.58110663220879, -47.40830786493161, -14.75350532050472, -275.5395123507332, -658.2052868601162, -121.63538029645062, 0.0567344654111939, -8.272678004225027, -180.28662515378983, 126.13843527135212, 112.88000000000031, -288.97484502592914, -15.151719074711524, -720.1605184076138, -217.96100010525933, -287.1944440269423, -102.60456857257287, 73.40942181383441, -46.51459568144528, 127.6517109649778, -657.4183349392647, -63.4646228659484, -75.15206677071333, -82.23347456892961, -123.60344513994497, -41.710236976717056, -74.0708002158779, -922.5700012529294, -301.3245670174729, -0.09992229084124231, -140.58213900475977, -21.377439031140593, -1.293029209905084, 100.01000000000019, -909.6737662909813, -530.2170566135168, -85.6289167313018, 120.60166379120946, -8.005673117055972, 116.13412942927977, 122.97099299984161, -5.439694046441112, -69.39693612215821, -262.3412673358163, -275.4074742611984, -368.7644768903075, -223.764474864625, -21.903141877918358, -846.5246168931686, 20.044778702624242, -32.41746366450679, -646.7190760281608, 78.23000000000002, -267.0321294100058, -47.15643381911424, -373.32649889624065, -247.6348152297237, -296.07099893476715, -143.1510683021998, -277.4192837993298, -707.112090660502, -181.0896476147994, -291.91706042395896, -34.71487272012265, -585.255008718763, -1167.611142666553, -1051.3384395868122, -191.3681913378728, -36.28802586505469, -164.3779334664325, -74.51142540877106, -826.9307040965716, -844.1408758255615, 58.78495199091361, 22.630449448993435, -210.09835597700098, -344.228233565917, -143.50999463086887, -203.42977560393751, -92.92822530708878, -121.76721979262508, -1134.9257762339369, -1094.1606178243505, -95.13741817549901, -1.4948447019062236, -1.5044901895196499, -26.79269016498685, -969.309446818494, -923.0599329858175, 2.0000000000000013, -134.87599232364357], "policy_predator_policy_reward": [25.11120922822033, 23.73929818124116, 223.28942883822418, 271.3960053822393, 281.6938914814176, 0.0, 110.92991282267951, 109.80988093416238, 420.7297911746502, 512.6461134372848, 99.49520138445068, 584.6208739248806, 245.8707901240878, 275.2910063000106, 132.39172535721326, 192.51624256160085, 146.10811119533213, 186.0262056423034, 133.73832347883555, 128.197875534059, 151.68086541742963, 122.0458404237864, 520.8448968050614, 24.284699796499403, 432.0137012463738, 23.38035865028121, 7.710669687390404, 181.7836841538, 115.63354397877225, 1.5637604684441606, 272.012978437257, 187.66046930988338, 36.86762868754886, 27.6483107142935, 155.34935909038214, 23.51260877762678, 122.10646983307127, 85.04062893034649, 142.79194628469983, 164.90247227848698, 3.7089000869230424, 553.8673238710091, 35.47288791612843, 36.615746734270935, 173.3347944025139, 2.267868414676003, 43.94867956996548, 37.32460222978389, 14.804448307761028, 554.2995348709832, 78.78021578106419, 222.17116227838522, 530.1817947897157, 466.9069765367084, 11.59689163153752, 55.75608858234032, 116.15812822589417, 54.10553485628079, 23.23542579222821, 198.32545198914846, 17.79238718431221, 525.9816247395216, 526.1377072849085, 83.59612628792121, 592.9480078078295, 582.5042979449137, 476.5754311887619, 90.10769736356973, 15.170025615447715, 93.12972305634135, 87.15065631052877, 3.6067429147506287, 580.0576765236318, 0.0, 0.0, 155.9325366998478, 62.34208445658306, 0.0, 88.81820045350888, 87.14959973971324, 15.209090416035536, 498.9584898695368, 233.47337840428364, 123.96029617514864, 684.8071626038676, 502.1811035034237, 201.32590010519897, 11.662615625326286, 66.84569993027608, 66.62125680982935, 3.235771538351377, 0.0, 275.14711519780667, 288.5973386935864, 590.5665531231878, 700.7567092268121, 703.6573460556269, 507.1499297682355, 735.8085806829137, 646.8477276556761, 239.4642194851503, 883.3246092976951, 511.1459856486139, 157.38264751087084, 224.96074474786474, 7.848208365711987, 531.4541994913232, 645.2428129359423, 121.15312427023675, 93.23128336439521, 152.05821379252427, 76.82724726127539, 284.00457590064576, 658.2352868601164, 167.63303465206903, 117.70800462704422, 107.75110978977388, 164.07383862196605, 5.521564728648179, 0.0, 128.55601822815586, 223.5576709845697, 225.86364553522802, 717.9674353119318, 323.5714536704114, 186.03841854180314, 1.9785571320320279, 129.38459568144557, 29.67828903502225, 657.4383349392647, 5.88451287689929, 196.27668963666278, 60.88118727066711, 207.94375011816663, 175.8403560767694, 21.665563502342508, 922.5700012529294, 325.8745670174724, 51.135251676952144, 129.59788775023213, 23.307439031140895, 14.054486066195544, 657.960492514006, 827.5693069245634, 135.47891673130206, 532.4670566135168, 9.95567311705593, 7.411759256326206, 6.76261947029244, 3.5922581005862684, 127.8121764395959, 21.63105413858293, 177.7393282336195, 309.9931752088739, 423.8459244916562, 282.2161108827107, 846.5246168931686, 83.87314187791829, 65.75580638038798, 58.41626481254991, 3.412519021003791, 643.356557007157, 253.03735843245406, 206.92747386668893, 381.0256876761521, 345.50099662752234, 322.5140450165886, 231.16777570309534, 288.22928379932944, 707.2720906605019, 377.2671823702979, 161.8609865014954, 585.3150087187629, 93.89827466679279, 859.5684563092357, 1013.8448310284202, 153.91827677799847, 183.35840485545216, 140.35712899845097, 188.12166162224858, 639.1565424850711, 825.4903913158822, 83.34121086632695, 35.061865692926034, 335.3283505340973, 169.44048090937636, 21.649149319348012, 334.07128217773806, 234.15192111589167, 26.528187093937895, 695.2087472066314, 1203.4101299054303, 127.93549822949745, 74.49852433589805, 81.44313741456766, 13.69404293993871, 4.254416759510477, 1000.9394233772618, 83.14471873003254, 87.8710946352575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5383007122857054, "mean_inference_ms": 1.339608809563492, "mean_action_processing_ms": 0.2300471781489231, "mean_env_wait_ms": 0.1760904803612796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004194855690002441, "StateBufferConnector_ms": 0.0027571916580200195, "ViewRequirementAgentConnector_ms": 0.0803384780883789}, "num_episodes": 18, "episode_return_max": 675.8660331475864, "episode_return_min": -887.1755396675396, "episode_return_mean": 56.217668202787145, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.18154456281053, "num_env_steps_trained_throughput_per_sec": 437.18154456281053, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 9182.828, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9182.793, "sample_time_ms": 992.865, "learn_time_ms": 8177.378, "learn_throughput": 489.154, "synch_weights_time_ms": 11.726}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "1f15c_00000", "date": "2024-08-16_14-32-18", "timestamp": 1723798938, "time_this_iter_s": 9.152878999710083, "time_total_s": 1742.060214996338, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fe97550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1742.060214996338, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 22.546153846153842, "ram_util_percent": 74.24615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7643524616010606, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.104036523173095, "policy_loss": -0.00531129296487148, "vf_loss": 7.1089481575779185, "vf_explained_var": -0.003856376018473711, "kl": 0.014210372676030316, "entropy": 0.6829513383920861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.569392340066572, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.973145621920389, "policy_loss": -0.005669194445378644, "vf_loss": 7.977719546373559, "vf_explained_var": 0.24418495912400504, "kl": 0.00973545636011776, "entropy": 0.8781691276207172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 675.8660331475864, "episode_reward_min": -887.1755396675396, "episode_reward_mean": 53.09412664657114, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1250.3527675586943, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 145.55000000000013, "predator_policy": 1250.3527675586943}, "policy_reward_mean": {"prey_policy": -241.92507895712978, "predator_policy": 268.47214228041537}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0488201025529, 163.18254126138015, -456.13760821110804, 145.8288700604631, 99.87067666988571, 171.8695517776596, 87.07, 135.8722320696562, -9.602138127454102, 264.0499999999999, 101.0829621672496, 117.93817359728418, 111.78640527628303, 55.05000000000002, -63.51457345625801, 82.23852711043318, 152.90124557835304, 62.65720983417678, 145.55, 64.01031112791354, 207.62999999999977, 235.66030429189072, 101.11000000000004, 81.56616942324553, -110.49737243395705, 34.64000000000008, 86.71194954504773, 91.10000000000038, 92.42341723711333, -225.55369104777878, 615.1659285545621, -207.97738547523545, 16.73999999999999, 19.21000000000001, 112.42372387586175, -72.80535986954408, 126.3667718541345, 166.72364786836326, 8.49506354991252, 163.76239344807334, 83.26564525372464, 244.5399999999989, 47.98712511208513, 5.709562334286714, 119.81085961269972, 158.2579789458664, 157.34999999999997, 63.54451287689924, 62.98801767995903, 81.72488238651661, 24.550000000000004, 40.05107813158333, 14.6914568562904, 675.8660331475864, 52.09999999999998, 129.96342304753614, 249.45999999999978, 74.60660040957953, -50.01623815452107, 113.53308361943567, 61.96999999999996, 111.79938623105608, 78.27999999999997, 145.7762690700237, 105.56537017771105, 114.45975348271875, 10.97, 66.1214608330354, 59.24340194667019, -345.5362949157109, 109.6204644305253, 89.5894317454971, -206.4246461211823, 199.8184779991594, -49.557758099443845, 8.780661262279462, 45.98466311011536, -330.46751694622935, 105.80175968799, 66.84000000000003, -887.1755396675396, 38.13982104164667, 13.229999999999988, -551.7133052359926, 103.88777939548484, -598.1649999801681, 1.7599999999999838, 105.405614632422, 14.859999999999982, 92.23962783292122, 109.85062491584937, 107.19315404771719, 34.73000000000002, 7.039999999999974, 172.57287759553685, 116.61134112018323, 104.5242568142533, 88.41017982533039, 269.7635595055649, 47.98000000000023], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -64.09827866086496, -146.5118773018062, 2.0000000000000013, -517.4238137093066, -496.29001845973323, -38.149764589937064, 111.89000000000014, -49.8019876252554, -25.92999852204889, 33.7094541051283, 56.88681587278205, -554.2995348709832, 72.26555169223896, -113.32373153793486, -51.755414451858535, -422.91377042107644, -583.7771390328024, 58.571753655720286, 138.12526613040194, 10.823390060712407, -80.00409097563737, -15.377740771222273, -88.24496341287006, -531.0076066475507, 99.01999999999998, -28.546126287921172, -526.1377072849085, -573.362043721831, -665.60483548717, -491.6320715678342, 7.187470125935862, 11.192173779692121, 33.40932312687183, -8.900943513766405, -19.199245877335986, -580.0576765236318, 145.55000000000013, -8.301056379545114, -83.62116919238868, 59.524281731441185, 85.76363381197594, -36.25921348951224, 95.95171758818167, 85.7309095839645, -498.78848986953676, -146.15557370690863, -129.7119314492783, -685.8645644126868, -611.621074128561, -9.712615625326327, -168.6359001051989, -42.08576641200489, -4.6692407830532945, -1.2557715383513977, 89.12000000000015, -229.73305412518513, -241.5879825290956, -756.9010784797318, -759.9758749180423, -724.3613472693011, 128.7200000000002, -806.7525602436033, -783.8811335702183, -222.72421948515034, -883.3246092976951, -138.33264751087114, -510.9859856486139, -97.2176032609361, -23.167625976778627, -664.1608367585679, -585.3415355382406, 1.5634708517111868, -89.58110663220879, -47.40830786493161, -14.75350532050472, -275.5395123507332, -658.2052868601162, -121.63538029645062, 0.0567344654111939, -8.272678004225027, -180.28662515378983, 126.13843527135212, 112.88000000000031, -288.97484502592914, -15.151719074711524, -720.1605184076138, -217.96100010525933, -287.1944440269423, -102.60456857257287, 73.40942181383441, -46.51459568144528, 127.6517109649778, -657.4183349392647, -63.4646228659484, -75.15206677071333, -82.23347456892961, -123.60344513994497, -41.710236976717056, -74.0708002158779, -922.5700012529294, -301.3245670174729, -0.09992229084124231, -140.58213900475977, -21.377439031140593, -1.293029209905084, 100.01000000000019, -909.6737662909813, -530.2170566135168, -85.6289167313018, 120.60166379120946, -8.005673117055972, 116.13412942927977, 122.97099299984161, -5.439694046441112, -69.39693612215821, -262.3412673358163, -275.4074742611984, -368.7644768903075, -223.764474864625, -21.903141877918358, -846.5246168931686, 20.044778702624242, -32.41746366450679, -646.7190760281608, 78.23000000000002, -267.0321294100058, -47.15643381911424, -373.32649889624065, -247.6348152297237, -296.07099893476715, -143.1510683021998, -277.4192837993298, -707.112090660502, -181.0896476147994, -291.91706042395896, -34.71487272012265, -585.255008718763, -1167.611142666553, -1051.3384395868122, -191.3681913378728, -36.28802586505469, -164.3779334664325, -74.51142540877106, -826.9307040965716, -844.1408758255615, 58.78495199091361, 22.630449448993435, -210.09835597700098, -344.228233565917, -143.50999463086887, -203.42977560393751, -92.92822530708878, -121.76721979262508, -1134.9257762339369, -1094.1606178243505, -95.13741817549901, -1.4948447019062236, -1.5044901895196499, -26.79269016498685, -969.309446818494, -923.0599329858175, 2.0000000000000013, -134.87599232364357, -262.84436216449245, -478.7728224408246, -628.7211314899919, -647.6282460225931, -13.001604207184986, -119.72310556924354, -712.5036695306243, -613.3460352732421, -713.5057346324236, -285.53507345330115, 75.63217448927364, -11.787461753273874, -904.091561034856, -337.05754838441, -81.85328498360182, -189.47798128217207, -277.59242276172034, -162.7303399907019, -210.6815721339807, -297.1549956504305, -697.6226639449869, -188.0049335699214, -251.4478516141379, -1250.3527675586943, -168.3622319478941, -289.0980685456817, -96.96966044197856, -1.2951022046375338, -13.280911440137059, -86.91595326002621, -2.7413320435622213, 71.66033865471658, -843.3566666827876, -335.5688408586924, -68.35495548650806, -2.9771817689698654], "policy_predator_policy_reward": [122.10646983307127, 85.04062893034649, 142.79194628469983, 164.90247227848698, 3.7089000869230424, 553.8673238710091, 35.47288791612843, 36.615746734270935, 173.3347944025139, 2.267868414676003, 43.94867956996548, 37.32460222978389, 14.804448307761028, 554.2995348709832, 78.78021578106419, 222.17116227838522, 530.1817947897157, 466.9069765367084, 11.59689163153752, 55.75608858234032, 116.15812822589417, 54.10553485628079, 23.23542579222821, 198.32545198914846, 17.79238718431221, 525.9816247395216, 526.1377072849085, 83.59612628792121, 592.9480078078295, 582.5042979449137, 476.5754311887619, 90.10769736356973, 15.170025615447715, 93.12972305634135, 87.15065631052877, 3.6067429147506287, 580.0576765236318, 0.0, 0.0, 155.9325366998478, 62.34208445658306, 0.0, 88.81820045350888, 87.14959973971324, 15.209090416035536, 498.9584898695368, 233.47337840428364, 123.96029617514864, 684.8071626038676, 502.1811035034237, 201.32590010519897, 11.662615625326286, 66.84569993027608, 66.62125680982935, 3.235771538351377, 0.0, 275.14711519780667, 288.5973386935864, 590.5665531231878, 700.7567092268121, 703.6573460556269, 507.1499297682355, 735.8085806829137, 646.8477276556761, 239.4642194851503, 883.3246092976951, 511.1459856486139, 157.38264751087084, 224.96074474786474, 7.848208365711987, 531.4541994913232, 645.2428129359423, 121.15312427023675, 93.23128336439521, 152.05821379252427, 76.82724726127539, 284.00457590064576, 658.2352868601164, 167.63303465206903, 117.70800462704422, 107.75110978977388, 164.07383862196605, 5.521564728648179, 0.0, 128.55601822815586, 223.5576709845697, 225.86364553522802, 717.9674353119318, 323.5714536704114, 186.03841854180314, 1.9785571320320279, 129.38459568144557, 29.67828903502225, 657.4383349392647, 5.88451287689929, 196.27668963666278, 60.88118727066711, 207.94375011816663, 175.8403560767694, 21.665563502342508, 922.5700012529294, 325.8745670174724, 51.135251676952144, 129.59788775023213, 23.307439031140895, 14.054486066195544, 657.960492514006, 827.5693069245634, 135.47891673130206, 532.4670566135168, 9.95567311705593, 7.411759256326206, 6.76261947029244, 3.5922581005862684, 127.8121764395959, 21.63105413858293, 177.7393282336195, 309.9931752088739, 423.8459244916562, 282.2161108827107, 846.5246168931686, 83.87314187791829, 65.75580638038798, 58.41626481254991, 3.412519021003791, 643.356557007157, 253.03735843245406, 206.92747386668893, 381.0256876761521, 345.50099662752234, 322.5140450165886, 231.16777570309534, 288.22928379932944, 707.2720906605019, 377.2671823702979, 161.8609865014954, 585.3150087187629, 93.89827466679279, 859.5684563092357, 1013.8448310284202, 153.91827677799847, 183.35840485545216, 140.35712899845097, 188.12166162224858, 639.1565424850711, 825.4903913158822, 83.34121086632695, 35.061865692926034, 335.3283505340973, 169.44048090937636, 21.649149319348012, 334.07128217773806, 234.15192111589167, 26.528187093937895, 695.2087472066314, 1203.4101299054303, 127.93549822949745, 74.49852433589805, 81.44313741456766, 13.69404293993871, 4.254416759510477, 1000.9394233772618, 83.14471873003254, 87.8710946352575, 275.9143621644914, 478.9328224408246, 672.5031298527805, 52.132942423811734, 6.6418991559089156, 229.9705900160045, 724.1856343741559, 3.499070449542698, 713.5157346324236, 287.2850734533008, 22.116208268246112, 19.444693628175862, 904.1015610348561, 351.9075483844092, 192.69866573413427, 170.87222836455976, 398.7637857091529, 151.4096019591181, 276.48946717082146, 338.54025466130736, 697.6226639449869, 222.7349335699215, 258.48785161413747, 1250.3527675586943, 285.1465123072317, 344.88666578188116, 130.0259455166267, 84.85015825017238, 4.03073866318896, 200.69038285122778, 12.757019448797466, 6.734153765378078, 772.3860099689845, 676.3030570780608, 108.15791926480279, 11.154217990675065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5377671620133732, "mean_inference_ms": 1.3384811744693896, "mean_action_processing_ms": 0.22981876090433873, "mean_env_wait_ms": 0.17600563682591144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004521727561950684, "StateBufferConnector_ms": 0.0027544498443603516, "ViewRequirementAgentConnector_ms": 0.0793001651763916}, "num_episodes": 18, "episode_return_max": 675.8660331475864, "episode_return_min": -887.1755396675396, "episode_return_mean": 53.09412664657114, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.07264560111406, "num_env_steps_trained_throughput_per_sec": 443.07264560111406, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 9182.524, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9182.489, "sample_time_ms": 991.608, "learn_time_ms": 8178.328, "learn_throughput": 489.098, "synch_weights_time_ms": 11.71}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "1f15c_00000", "date": "2024-08-16_14-32-27", "timestamp": 1723798947, "time_this_iter_s": 9.032044887542725, "time_total_s": 1751.0922598838806, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fec8af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1751.0922598838806, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 23.299999999999997, "ram_util_percent": 74.37692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8039704562179626, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.730649369608157, "policy_loss": -0.00689974357152269, "vf_loss": 8.737079869880878, "vf_explained_var": -0.003445470900762649, "kl": 0.01668413558092203, "entropy": 0.7296662726414898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7418832001547333, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.636875969266134, "policy_loss": -0.0024472729438452653, "vf_loss": 8.637657321697821, "vf_explained_var": 0.1887060681663493, "kl": 0.014808022375604359, "entropy": 0.8422889674151385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 675.8660331475864, "episode_reward_min": -887.1755396675396, "episode_reward_mean": 21.274227527911847, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1357.1364157739893, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 128.7200000000002, "predator_policy": 1357.1364157739893}, "policy_reward_mean": {"prey_policy": -313.52623229236247, "predator_policy": 324.1633460563184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.11000000000004, 81.56616942324553, -110.49737243395705, 34.64000000000008, 86.71194954504773, 91.10000000000038, 92.42341723711333, -225.55369104777878, 615.1659285545621, -207.97738547523545, 16.73999999999999, 19.21000000000001, 112.42372387586175, -72.80535986954408, 126.3667718541345, 166.72364786836326, 8.49506354991252, 163.76239344807334, 83.26564525372464, 244.5399999999989, 47.98712511208513, 5.709562334286714, 119.81085961269972, 158.2579789458664, 157.34999999999997, 63.54451287689924, 62.98801767995903, 81.72488238651661, 24.550000000000004, 40.05107813158333, 14.6914568562904, 675.8660331475864, 52.09999999999998, 129.96342304753614, 249.45999999999978, 74.60660040957953, -50.01623815452107, 113.53308361943567, 61.96999999999996, 111.79938623105608, 78.27999999999997, 145.7762690700237, 105.56537017771105, 114.45975348271875, 10.97, 66.1214608330354, 59.24340194667019, -345.5362949157109, 109.6204644305253, 89.5894317454971, -206.4246461211823, 199.8184779991594, -49.557758099443845, 8.780661262279462, 45.98466311011536, -330.46751694622935, 105.80175968799, 66.84000000000003, -887.1755396675396, 38.13982104164667, 13.229999999999988, -551.7133052359926, 103.88777939548484, -598.1649999801681, 1.7599999999999838, 105.405614632422, 14.859999999999982, 92.23962783292122, 109.85062491584937, 107.19315404771719, 34.73000000000002, 7.039999999999974, 172.57287759553685, 116.61134112018323, 104.5242568142533, 88.41017982533039, 269.7635595055649, 47.98000000000023, 19.419999999999888, 120.99859424317948, 42.67409346369873, -263.7884854440676, 384.77813118109384, 18.54853621777106, -215.87474835769765, 9.029999999999978, 31.353809332497832, 13.04540038619783, 96.41504379797274, 13.70354109224336, 175.9130197381991, -728.7382044459277, 17.345850492588635, -323.01254768244104, 22.12999999999996, 50.43999999999997, -190.51356536744544, -655.7877753640937, 170.1719127941765, 29.800993186489045], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.7309095839645, -498.78848986953676, -146.15557370690863, -129.7119314492783, -685.8645644126868, -611.621074128561, -9.712615625326327, -168.6359001051989, -42.08576641200489, -4.6692407830532945, -1.2557715383513977, 89.12000000000015, -229.73305412518513, -241.5879825290956, -756.9010784797318, -759.9758749180423, -724.3613472693011, 128.7200000000002, -806.7525602436033, -783.8811335702183, -222.72421948515034, -883.3246092976951, -138.33264751087114, -510.9859856486139, -97.2176032609361, -23.167625976778627, -664.1608367585679, -585.3415355382406, 1.5634708517111868, -89.58110663220879, -47.40830786493161, -14.75350532050472, -275.5395123507332, -658.2052868601162, -121.63538029645062, 0.0567344654111939, -8.272678004225027, -180.28662515378983, 126.13843527135212, 112.88000000000031, -288.97484502592914, -15.151719074711524, -720.1605184076138, -217.96100010525933, -287.1944440269423, -102.60456857257287, 73.40942181383441, -46.51459568144528, 127.6517109649778, -657.4183349392647, -63.4646228659484, -75.15206677071333, -82.23347456892961, -123.60344513994497, -41.710236976717056, -74.0708002158779, -922.5700012529294, -301.3245670174729, -0.09992229084124231, -140.58213900475977, -21.377439031140593, -1.293029209905084, 100.01000000000019, -909.6737662909813, -530.2170566135168, -85.6289167313018, 120.60166379120946, -8.005673117055972, 116.13412942927977, 122.97099299984161, -5.439694046441112, -69.39693612215821, -262.3412673358163, -275.4074742611984, -368.7644768903075, -223.764474864625, -21.903141877918358, -846.5246168931686, 20.044778702624242, -32.41746366450679, -646.7190760281608, 78.23000000000002, -267.0321294100058, -47.15643381911424, -373.32649889624065, -247.6348152297237, -296.07099893476715, -143.1510683021998, -277.4192837993298, -707.112090660502, -181.0896476147994, -291.91706042395896, -34.71487272012265, -585.255008718763, -1167.611142666553, -1051.3384395868122, -191.3681913378728, -36.28802586505469, -164.3779334664325, -74.51142540877106, -826.9307040965716, -844.1408758255615, 58.78495199091361, 22.630449448993435, -210.09835597700098, -344.228233565917, -143.50999463086887, -203.42977560393751, -92.92822530708878, -121.76721979262508, -1134.9257762339369, -1094.1606178243505, -95.13741817549901, -1.4948447019062236, -1.5044901895196499, -26.79269016498685, -969.309446818494, -923.0599329858175, 2.0000000000000013, -134.87599232364357, -262.84436216449245, -478.7728224408246, -628.7211314899919, -647.6282460225931, -13.001604207184986, -119.72310556924354, -712.5036695306243, -613.3460352732421, -713.5057346324236, -285.53507345330115, 75.63217448927364, -11.787461753273874, -904.091561034856, -337.05754838441, -81.85328498360182, -189.47798128217207, -277.59242276172034, -162.7303399907019, -210.6815721339807, -297.1549956504305, -697.6226639449869, -188.0049335699214, -251.4478516141379, -1250.3527675586943, -168.3622319478941, -289.0980685456817, -96.96966044197856, -1.2951022046375338, -13.280911440137059, -86.91595326002621, -2.7413320435622213, 71.66033865471658, -843.3566666827876, -335.5688408586924, -68.35495548650806, -2.9771817689698654, -987.3752562839895, -64.00889157422945, -144.58575726157423, -162.65149193214867, -50.72208568836853, -156.4075566520876, -731.347984397605, -285.6936092689118, 98.94494018986398, -730.8976917689594, -69.14754403251702, -72.60790588725465, -903.4302334445175, -1055.6433484408915, -1357.1364157739893, -214.66650241715462, -121.43017630552066, -204.2162696151698, -1.81357298983732, -25.3964974862591, -202.42566993015865, -127.16777795387725, -932.509595809863, -115.52822096342062, -237.82645265692136, 2.0000000000000013, -1090.2571796553555, -1123.6518467235974, -5.25033893329366, -111.95070872443938, -1170.9613092121685, -1157.7827737931464, -644.7030625852061, -116.212984658511, -872.8375894354405, 38.906418410663896, -1089.519398493286, -1022.8960292222897, -772.7980936232418, -746.3671709421509, 2.0000000000000013, -258.93197837246305, -199.39956020004576, -900.5864811728519], "policy_predator_policy_reward": [15.209090416035536, 498.9584898695368, 233.47337840428364, 123.96029617514864, 684.8071626038676, 502.1811035034237, 201.32590010519897, 11.662615625326286, 66.84569993027608, 66.62125680982935, 3.235771538351377, 0.0, 275.14711519780667, 288.5973386935864, 590.5665531231878, 700.7567092268121, 703.6573460556269, 507.1499297682355, 735.8085806829137, 646.8477276556761, 239.4642194851503, 883.3246092976951, 511.1459856486139, 157.38264751087084, 224.96074474786474, 7.848208365711987, 531.4541994913232, 645.2428129359423, 121.15312427023675, 93.23128336439521, 152.05821379252427, 76.82724726127539, 284.00457590064576, 658.2352868601164, 167.63303465206903, 117.70800462704422, 107.75110978977388, 164.07383862196605, 5.521564728648179, 0.0, 128.55601822815586, 223.5576709845697, 225.86364553522802, 717.9674353119318, 323.5714536704114, 186.03841854180314, 1.9785571320320279, 129.38459568144557, 29.67828903502225, 657.4383349392647, 5.88451287689929, 196.27668963666278, 60.88118727066711, 207.94375011816663, 175.8403560767694, 21.665563502342508, 922.5700012529294, 325.8745670174724, 51.135251676952144, 129.59788775023213, 23.307439031140895, 14.054486066195544, 657.960492514006, 827.5693069245634, 135.47891673130206, 532.4670566135168, 9.95567311705593, 7.411759256326206, 6.76261947029244, 3.5922581005862684, 127.8121764395959, 21.63105413858293, 177.7393282336195, 309.9931752088739, 423.8459244916562, 282.2161108827107, 846.5246168931686, 83.87314187791829, 65.75580638038798, 58.41626481254991, 3.412519021003791, 643.356557007157, 253.03735843245406, 206.92747386668893, 381.0256876761521, 345.50099662752234, 322.5140450165886, 231.16777570309534, 288.22928379932944, 707.2720906605019, 377.2671823702979, 161.8609865014954, 585.3150087187629, 93.89827466679279, 859.5684563092357, 1013.8448310284202, 153.91827677799847, 183.35840485545216, 140.35712899845097, 188.12166162224858, 639.1565424850711, 825.4903913158822, 83.34121086632695, 35.061865692926034, 335.3283505340973, 169.44048090937636, 21.649149319348012, 334.07128217773806, 234.15192111589167, 26.528187093937895, 695.2087472066314, 1203.4101299054303, 127.93549822949745, 74.49852433589805, 81.44313741456766, 13.69404293993871, 4.254416759510477, 1000.9394233772618, 83.14471873003254, 87.8710946352575, 275.9143621644914, 478.9328224408246, 672.5031298527805, 52.132942423811734, 6.6418991559089156, 229.9705900160045, 724.1856343741559, 3.499070449542698, 713.5157346324236, 287.2850734533008, 22.116208268246112, 19.444693628175862, 904.1015610348561, 351.9075483844092, 192.69866573413427, 170.87222836455976, 398.7637857091529, 151.4096019591181, 276.48946717082146, 338.54025466130736, 697.6226639449869, 222.7349335699215, 258.48785161413747, 1250.3527675586943, 285.1465123072317, 344.88666578188116, 130.0259455166267, 84.85015825017238, 4.03073866318896, 200.69038285122778, 12.757019448797466, 6.734153765378078, 772.3860099689845, 676.3030570780608, 108.15791926480279, 11.154217990675065, 987.3852562839895, 83.41889157422952, 251.72520720943962, 176.5106362274606, 52.092564457812074, 197.71117134634267, 7.751471660487278, 745.5016365619617, 635.7647417117711, 380.9661410484198, 9.419093795309582, 150.8848923422334, 1067.9822692989135, 675.2165642287995, 223.69650241715425, 1357.1364157739893, 125.30237602467405, 231.697879228514, 12.820455976994069, 27.435014885300532, 230.2090211677376, 195.79947051427123, 930.247293701459, 131.4940641640681, 211.26035495774084, 200.47911743737873, 1176.8004550500461, 308.3703668829774, 112.9007824504199, 21.64611569990213, 771.56249409355, 1234.1690412293208, 138.33298465851115, 644.7130625852061, 11.533581589336205, 872.8375894354405, 1004.797014306573, 917.1048480415575, 843.3757465435934, 20.00174265770622, 169.2874985545176, 257.816392612123, 900.5964811728519, 229.19055338653413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5371401795811498, "mean_inference_ms": 1.3372057443631473, "mean_action_processing_ms": 0.22954789664716876, "mean_env_wait_ms": 0.17593221577527365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005003571510314941, "StateBufferConnector_ms": 0.002784132957458496, "ViewRequirementAgentConnector_ms": 0.08076822757720947}, "num_episodes": 22, "episode_return_max": 675.8660331475864, "episode_return_min": -887.1755396675396, "episode_return_mean": 21.274227527911847, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.1389919553431, "num_env_steps_trained_throughput_per_sec": 432.1389919553431, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 9195.521, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9195.485, "sample_time_ms": 998.121, "learn_time_ms": 8184.938, "learn_throughput": 488.703, "synch_weights_time_ms": 11.563}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "1f15c_00000", "date": "2024-08-16_14-32-36", "timestamp": 1723798956, "time_this_iter_s": 9.260296106338501, "time_total_s": 1760.3525559902191, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f8cd940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1760.3525559902191, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 24.14615384615384, "ram_util_percent": 74.38461538461537}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.364713772074886, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.971506714694714, "policy_loss": -0.007127515441077766, "vf_loss": 8.978193225810136, "vf_explained_var": -0.004690676233755848, "kl": 0.01567998009697173, "entropy": 0.7105596135848413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0320903050836434, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.416520355870484, "policy_loss": -0.004084256443653315, "vf_loss": 9.41923499435344, "vf_explained_var": 0.23227890499685178, "kl": 0.01217438425107274, "entropy": 0.8637010633945466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 675.8660331475864, "episode_reward_min": -887.1755396675396, "episode_reward_mean": -0.6221480249128944, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1357.1364157739893, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 127.6517109649778, "predator_policy": 1357.1364157739893}, "policy_reward_mean": {"prey_policy": -336.6473283578147, "predator_policy": 336.33625434535827}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.26564525372464, 244.5399999999989, 47.98712511208513, 5.709562334286714, 119.81085961269972, 158.2579789458664, 157.34999999999997, 63.54451287689924, 62.98801767995903, 81.72488238651661, 24.550000000000004, 40.05107813158333, 14.6914568562904, 675.8660331475864, 52.09999999999998, 129.96342304753614, 249.45999999999978, 74.60660040957953, -50.01623815452107, 113.53308361943567, 61.96999999999996, 111.79938623105608, 78.27999999999997, 145.7762690700237, 105.56537017771105, 114.45975348271875, 10.97, 66.1214608330354, 59.24340194667019, -345.5362949157109, 109.6204644305253, 89.5894317454971, -206.4246461211823, 199.8184779991594, -49.557758099443845, 8.780661262279462, 45.98466311011536, -330.46751694622935, 105.80175968799, 66.84000000000003, -887.1755396675396, 38.13982104164667, 13.229999999999988, -551.7133052359926, 103.88777939548484, -598.1649999801681, 1.7599999999999838, 105.405614632422, 14.859999999999982, 92.23962783292122, 109.85062491584937, 107.19315404771719, 34.73000000000002, 7.039999999999974, 172.57287759553685, 116.61134112018323, 104.5242568142533, 88.41017982533039, 269.7635595055649, 47.98000000000023, 19.419999999999888, 120.99859424317948, 42.67409346369873, -263.7884854440676, 384.77813118109384, 18.54853621777106, -215.87474835769765, 9.029999999999978, 31.353809332497832, 13.04540038619783, 96.41504379797274, 13.70354109224336, 175.9130197381991, -728.7382044459277, 17.345850492588635, -323.01254768244104, 22.12999999999996, 50.43999999999997, -190.51356536744544, -655.7877753640937, 170.1719127941765, 29.800993186489045, -788.692479654014, 288.43425988956864, 21.900000000000134, 50.408262072330466, -188.8124810047546, 1.3999999999999817, 323.21200080771314, 35.71804095027362, 81.17859963230856, 1.2599999999999714, 107.39379512840264, 193.47550871725508, -187.9827736642375, -10.79778146634844, -478.4651866646913, 217.58431932173986, 0.44516402385473564, -757.6915468420771], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.272678004225027, -180.28662515378983, 126.13843527135212, 112.88000000000031, -288.97484502592914, -15.151719074711524, -720.1605184076138, -217.96100010525933, -287.1944440269423, -102.60456857257287, 73.40942181383441, -46.51459568144528, 127.6517109649778, -657.4183349392647, -63.4646228659484, -75.15206677071333, -82.23347456892961, -123.60344513994497, -41.710236976717056, -74.0708002158779, -922.5700012529294, -301.3245670174729, -0.09992229084124231, -140.58213900475977, -21.377439031140593, -1.293029209905084, 100.01000000000019, -909.6737662909813, -530.2170566135168, -85.6289167313018, 120.60166379120946, -8.005673117055972, 116.13412942927977, 122.97099299984161, -5.439694046441112, -69.39693612215821, -262.3412673358163, -275.4074742611984, -368.7644768903075, -223.764474864625, -21.903141877918358, -846.5246168931686, 20.044778702624242, -32.41746366450679, -646.7190760281608, 78.23000000000002, -267.0321294100058, -47.15643381911424, -373.32649889624065, -247.6348152297237, -296.07099893476715, -143.1510683021998, -277.4192837993298, -707.112090660502, -181.0896476147994, -291.91706042395896, -34.71487272012265, -585.255008718763, -1167.611142666553, -1051.3384395868122, -191.3681913378728, -36.28802586505469, -164.3779334664325, -74.51142540877106, -826.9307040965716, -844.1408758255615, 58.78495199091361, 22.630449448993435, -210.09835597700098, -344.228233565917, -143.50999463086887, -203.42977560393751, -92.92822530708878, -121.76721979262508, -1134.9257762339369, -1094.1606178243505, -95.13741817549901, -1.4948447019062236, -1.5044901895196499, -26.79269016498685, -969.309446818494, -923.0599329858175, 2.0000000000000013, -134.87599232364357, -262.84436216449245, -478.7728224408246, -628.7211314899919, -647.6282460225931, -13.001604207184986, -119.72310556924354, -712.5036695306243, -613.3460352732421, -713.5057346324236, -285.53507345330115, 75.63217448927364, -11.787461753273874, -904.091561034856, -337.05754838441, -81.85328498360182, -189.47798128217207, -277.59242276172034, -162.7303399907019, -210.6815721339807, -297.1549956504305, -697.6226639449869, -188.0049335699214, -251.4478516141379, -1250.3527675586943, -168.3622319478941, -289.0980685456817, -96.96966044197856, -1.2951022046375338, -13.280911440137059, -86.91595326002621, -2.7413320435622213, 71.66033865471658, -843.3566666827876, -335.5688408586924, -68.35495548650806, -2.9771817689698654, -987.3752562839895, -64.00889157422945, -144.58575726157423, -162.65149193214867, -50.72208568836853, -156.4075566520876, -731.347984397605, -285.6936092689118, 98.94494018986398, -730.8976917689594, -69.14754403251702, -72.60790588725465, -903.4302334445175, -1055.6433484408915, -1357.1364157739893, -214.66650241715462, -121.43017630552066, -204.2162696151698, -1.81357298983732, -25.3964974862591, -202.42566993015865, -127.16777795387725, -932.509595809863, -115.52822096342062, -237.82645265692136, 2.0000000000000013, -1090.2571796553555, -1123.6518467235974, -5.25033893329366, -111.95070872443938, -1170.9613092121685, -1157.7827737931464, -644.7030625852061, -116.212984658511, -872.8375894354405, 38.906418410663896, -1089.519398493286, -1022.8960292222897, -772.7980936232418, -746.3671709421509, 2.0000000000000013, -258.93197837246305, -199.39956020004576, -900.5864811728519, -925.0629859304471, -827.8913538356021, -71.5648195394508, -403.9925196697477, -237.2675523736557, -778.400610842364, -6.115223861418828, -64.33168137156002, -1041.4512564079484, -982.7777665780023, -898.0712089824252, -156.68304114841894, -570.4530462199756, 34.85916791461133, -213.5061929166082, -191.59316314323948, -0.10043689026113216, -143.0179010155434, -1042.9722572373896, -157.888585035946, -224.59498782173117, -13.738168546695244, -369.10153863966985, -132.8306899357965, -1031.7636668824439, -950.9629330403114, -151.65240240198736, -87.307783519685, -598.8677568122671, -521.4733028174161, -411.7121541527241, -144.94351624385948, -73.0162036340195, -208.0529944149207, -789.5716623562097, -865.2280238521224], "policy_predator_policy_reward": [107.75110978977388, 164.07383862196605, 5.521564728648179, 0.0, 128.55601822815586, 223.5576709845697, 225.86364553522802, 717.9674353119318, 323.5714536704114, 186.03841854180314, 1.9785571320320279, 129.38459568144557, 29.67828903502225, 657.4383349392647, 5.88451287689929, 196.27668963666278, 60.88118727066711, 207.94375011816663, 175.8403560767694, 21.665563502342508, 922.5700012529294, 325.8745670174724, 51.135251676952144, 129.59788775023213, 23.307439031140895, 14.054486066195544, 657.960492514006, 827.5693069245634, 135.47891673130206, 532.4670566135168, 9.95567311705593, 7.411759256326206, 6.76261947029244, 3.5922581005862684, 127.8121764395959, 21.63105413858293, 177.7393282336195, 309.9931752088739, 423.8459244916562, 282.2161108827107, 846.5246168931686, 83.87314187791829, 65.75580638038798, 58.41626481254991, 3.412519021003791, 643.356557007157, 253.03735843245406, 206.92747386668893, 381.0256876761521, 345.50099662752234, 322.5140450165886, 231.16777570309534, 288.22928379932944, 707.2720906605019, 377.2671823702979, 161.8609865014954, 585.3150087187629, 93.89827466679279, 859.5684563092357, 1013.8448310284202, 153.91827677799847, 183.35840485545216, 140.35712899845097, 188.12166162224858, 639.1565424850711, 825.4903913158822, 83.34121086632695, 35.061865692926034, 335.3283505340973, 169.44048090937636, 21.649149319348012, 334.07128217773806, 234.15192111589167, 26.528187093937895, 695.2087472066314, 1203.4101299054303, 127.93549822949745, 74.49852433589805, 81.44313741456766, 13.69404293993871, 4.254416759510477, 1000.9394233772618, 83.14471873003254, 87.8710946352575, 275.9143621644914, 478.9328224408246, 672.5031298527805, 52.132942423811734, 6.6418991559089156, 229.9705900160045, 724.1856343741559, 3.499070449542698, 713.5157346324236, 287.2850734533008, 22.116208268246112, 19.444693628175862, 904.1015610348561, 351.9075483844092, 192.69866573413427, 170.87222836455976, 398.7637857091529, 151.4096019591181, 276.48946717082146, 338.54025466130736, 697.6226639449869, 222.7349335699215, 258.48785161413747, 1250.3527675586943, 285.1465123072317, 344.88666578188116, 130.0259455166267, 84.85015825017238, 4.03073866318896, 200.69038285122778, 12.757019448797466, 6.734153765378078, 772.3860099689845, 676.3030570780608, 108.15791926480279, 11.154217990675065, 987.3852562839895, 83.41889157422952, 251.72520720943962, 176.5106362274606, 52.092564457812074, 197.71117134634267, 7.751471660487278, 745.5016365619617, 635.7647417117711, 380.9661410484198, 9.419093795309582, 150.8848923422334, 1067.9822692989135, 675.2165642287995, 223.69650241715425, 1357.1364157739893, 125.30237602467405, 231.697879228514, 12.820455976994069, 27.435014885300532, 230.2090211677376, 195.79947051427123, 930.247293701459, 131.4940641640681, 211.26035495774084, 200.47911743737873, 1176.8004550500461, 308.3703668829774, 112.9007824504199, 21.64611569990213, 771.56249409355, 1234.1690412293208, 138.33298465851115, 644.7130625852061, 11.533581589336205, 872.8375894354405, 1004.797014306573, 917.1048480415575, 843.3757465435934, 20.00174265770622, 169.2874985545176, 257.816392612123, 900.5964811728519, 229.19055338653413, 18.33241741435217, 945.9294426976829, 342.61766704604236, 421.37393205272514, 259.1575523736549, 778.410610842364, 39.34104141536333, 81.51412588994603, 926.8485186836715, 908.5680232975271, 885.7735839776419, 170.38066615320233, 332.8245207838144, 525.9813583292637, 136.44792508393277, 304.3694719261878, 97.5013090177511, 126.79562852036203, 159.1485850359456, 1042.9722572373896, 205.0434385251248, 140.6835129717035, 312.0261774132879, 383.3815598794341, 1018.6778249176106, 776.0660013409067, 228.16240445532375, 0.0, 4.35118817639055, 637.5246847885999, 421.7696963450277, 352.4702933732934, 259.97233032715417, 21.54203174564075, 897.1081393662547, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5366232092205849, "mean_inference_ms": 1.336188114554334, "mean_action_processing_ms": 0.22935292247927797, "mean_env_wait_ms": 0.1758737783397249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005335330963134766, "StateBufferConnector_ms": 0.002821683883666992, "ViewRequirementAgentConnector_ms": 0.08192813396453857}, "num_episodes": 18, "episode_return_max": 675.8660331475864, "episode_return_min": -887.1755396675396, "episode_return_mean": -0.6221480249128944, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.0341758578107, "num_env_steps_trained_throughput_per_sec": 428.0341758578107, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 9221.197, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9221.161, "sample_time_ms": 994.422, "learn_time_ms": 8214.161, "learn_throughput": 486.964, "synch_weights_time_ms": 11.69}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "1f15c_00000", "date": "2024-08-16_14-32-45", "timestamp": 1723798965, "time_this_iter_s": 9.348373174667358, "time_total_s": 1769.7009291648865, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fe974c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1769.7009291648865, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 23.321428571428566, "ram_util_percent": 74.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.654269458046035, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.315884979692086, "policy_loss": -0.008269739869696202, "vf_loss": 8.323762060599352, "vf_explained_var": -0.003554702498925426, "kl": 0.01396139448223842, "entropy": 0.6948771036175824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.958448386539227, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.482586756206693, "policy_loss": -0.0036200242733001394, "vf_loss": 9.485623980829956, "vf_explained_var": 0.21078240921888403, "kl": 0.0051805400224397245, "entropy": 0.8378799981856472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 481.5272896467394, "episode_reward_min": -926.2436869772624, "episode_reward_mean": -44.174973860071894, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1480.249391289427, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 98.94494018986398, "predator_policy": 1524.571128860681}, "policy_reward_mean": {"prey_policy": -412.30329511923895, "predator_policy": 390.215808189203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.7762690700237, 105.56537017771105, 114.45975348271875, 10.97, 66.1214608330354, 59.24340194667019, -345.5362949157109, 109.6204644305253, 89.5894317454971, -206.4246461211823, 199.8184779991594, -49.557758099443845, 8.780661262279462, 45.98466311011536, -330.46751694622935, 105.80175968799, 66.84000000000003, -887.1755396675396, 38.13982104164667, 13.229999999999988, -551.7133052359926, 103.88777939548484, -598.1649999801681, 1.7599999999999838, 105.405614632422, 14.859999999999982, 92.23962783292122, 109.85062491584937, 107.19315404771719, 34.73000000000002, 7.039999999999974, 172.57287759553685, 116.61134112018323, 104.5242568142533, 88.41017982533039, 269.7635595055649, 47.98000000000023, 19.419999999999888, 120.99859424317948, 42.67409346369873, -263.7884854440676, 384.77813118109384, 18.54853621777106, -215.87474835769765, 9.029999999999978, 31.353809332497832, 13.04540038619783, 96.41504379797274, 13.70354109224336, 175.9130197381991, -728.7382044459277, 17.345850492588635, -323.01254768244104, 22.12999999999996, 50.43999999999997, -190.51356536744544, -655.7877753640937, 170.1719127941765, 29.800993186489045, -788.692479654014, 288.43425988956864, 21.900000000000134, 50.408262072330466, -188.8124810047546, 1.3999999999999817, 323.21200080771314, 35.71804095027362, 81.17859963230856, 1.2599999999999714, 107.39379512840264, 193.47550871725508, -187.9827736642375, -10.79778146634844, -478.4651866646913, 217.58431932173986, 0.44516402385473564, -757.6915468420771, 481.5272896467394, 15.259999999999975, -3.514906328393807, -87.27174016110872, -365.3277298225088, -26.20800547353081, 68.58139138746922, -926.2436869772624, 74.20727153284079, -300.41895951663275, -134.52719388049243, -659.3032773505869, 19.749999999999925, 25.03999999999993, 156.84103008186307, 414.5370514988032, -553.8336798391798, 64.82799234285733, 97.37754474427243, -35.74113166867899, 18.251481173335296, -113.31991741512135, 16.260000000000026], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-267.0321294100058, -47.15643381911424, -373.32649889624065, -247.6348152297237, -296.07099893476715, -143.1510683021998, -277.4192837993298, -707.112090660502, -181.0896476147994, -291.91706042395896, -34.71487272012265, -585.255008718763, -1167.611142666553, -1051.3384395868122, -191.3681913378728, -36.28802586505469, -164.3779334664325, -74.51142540877106, -826.9307040965716, -844.1408758255615, 58.78495199091361, 22.630449448993435, -210.09835597700098, -344.228233565917, -143.50999463086887, -203.42977560393751, -92.92822530708878, -121.76721979262508, -1134.9257762339369, -1094.1606178243505, -95.13741817549901, -1.4948447019062236, -1.5044901895196499, -26.79269016498685, -969.309446818494, -923.0599329858175, 2.0000000000000013, -134.87599232364357, -262.84436216449245, -478.7728224408246, -628.7211314899919, -647.6282460225931, -13.001604207184986, -119.72310556924354, -712.5036695306243, -613.3460352732421, -713.5057346324236, -285.53507345330115, 75.63217448927364, -11.787461753273874, -904.091561034856, -337.05754838441, -81.85328498360182, -189.47798128217207, -277.59242276172034, -162.7303399907019, -210.6815721339807, -297.1549956504305, -697.6226639449869, -188.0049335699214, -251.4478516141379, -1250.3527675586943, -168.3622319478941, -289.0980685456817, -96.96966044197856, -1.2951022046375338, -13.280911440137059, -86.91595326002621, -2.7413320435622213, 71.66033865471658, -843.3566666827876, -335.5688408586924, -68.35495548650806, -2.9771817689698654, -987.3752562839895, -64.00889157422945, -144.58575726157423, -162.65149193214867, -50.72208568836853, -156.4075566520876, -731.347984397605, -285.6936092689118, 98.94494018986398, -730.8976917689594, -69.14754403251702, -72.60790588725465, -903.4302334445175, -1055.6433484408915, -1357.1364157739893, -214.66650241715462, -121.43017630552066, -204.2162696151698, -1.81357298983732, -25.3964974862591, -202.42566993015865, -127.16777795387725, -932.509595809863, -115.52822096342062, -237.82645265692136, 2.0000000000000013, -1090.2571796553555, -1123.6518467235974, -5.25033893329366, -111.95070872443938, -1170.9613092121685, -1157.7827737931464, -644.7030625852061, -116.212984658511, -872.8375894354405, 38.906418410663896, -1089.519398493286, -1022.8960292222897, -772.7980936232418, -746.3671709421509, 2.0000000000000013, -258.93197837246305, -199.39956020004576, -900.5864811728519, -925.0629859304471, -827.8913538356021, -71.5648195394508, -403.9925196697477, -237.2675523736557, -778.400610842364, -6.115223861418828, -64.33168137156002, -1041.4512564079484, -982.7777665780023, -898.0712089824252, -156.68304114841894, -570.4530462199756, 34.85916791461133, -213.5061929166082, -191.59316314323948, -0.10043689026113216, -143.0179010155434, -1042.9722572373896, -157.888585035946, -224.59498782173117, -13.738168546695244, -369.10153863966985, -132.8306899357965, -1031.7636668824439, -950.9629330403114, -151.65240240198736, -87.307783519685, -598.8677568122671, -521.4733028174161, -411.7121541527241, -144.94351624385948, -73.0162036340195, -208.0529944149207, -789.5716623562097, -865.2280238521224, -855.883662899558, 47.70530436356602, -181.75177869743553, -914.4360511669048, -842.9120729540139, -847.4240601223032, -164.63047744316157, -290.5073916003628, -615.2527339051622, -662.0202460261769, -159.1083940882489, -250.96269295917108, -49.74971750198854, -224.65899259850565, -972.4620324763721, -1183.7168546031226, -269.75477000846683, -160.9553035159778, -656.4197772173886, -595.3619698936362, -920.8656466393414, -957.3971814351925, -1480.249391289427, -1417.18373162088, -484.96813850863964, -88.9071522297722, -1421.7709920313491, -112.03221728323528, -205.1473908362073, -212.19987393741292, -12.839643477983467, -1064.3562660848681, -817.6698781775443, -615.8717738095177, -130.66757963429208, -77.58897390341617, -188.39416387718228, -75.3859606378644, -186.1542819798906, -165.2122498188711, -192.65961890176635, -143.9418032081903, -588.8386962760717, -521.5952724329921, -196.32680179746725, -662.8589722420554], "policy_predator_policy_reward": [253.03735843245406, 206.92747386668893, 381.0256876761521, 345.50099662752234, 322.5140450165886, 231.16777570309534, 288.22928379932944, 707.2720906605019, 377.2671823702979, 161.8609865014954, 585.3150087187629, 93.89827466679279, 859.5684563092357, 1013.8448310284202, 153.91827677799847, 183.35840485545216, 140.35712899845097, 188.12166162224858, 639.1565424850711, 825.4903913158822, 83.34121086632695, 35.061865692926034, 335.3283505340973, 169.44048090937636, 21.649149319348012, 334.07128217773806, 234.15192111589167, 26.528187093937895, 695.2087472066314, 1203.4101299054303, 127.93549822949745, 74.49852433589805, 81.44313741456766, 13.69404293993871, 4.254416759510477, 1000.9394233772618, 83.14471873003254, 87.8710946352575, 275.9143621644914, 478.9328224408246, 672.5031298527805, 52.132942423811734, 6.6418991559089156, 229.9705900160045, 724.1856343741559, 3.499070449542698, 713.5157346324236, 287.2850734533008, 22.116208268246112, 19.444693628175862, 904.1015610348561, 351.9075483844092, 192.69866573413427, 170.87222836455976, 398.7637857091529, 151.4096019591181, 276.48946717082146, 338.54025466130736, 697.6226639449869, 222.7349335699215, 258.48785161413747, 1250.3527675586943, 285.1465123072317, 344.88666578188116, 130.0259455166267, 84.85015825017238, 4.03073866318896, 200.69038285122778, 12.757019448797466, 6.734153765378078, 772.3860099689845, 676.3030570780608, 108.15791926480279, 11.154217990675065, 987.3852562839895, 83.41889157422952, 251.72520720943962, 176.5106362274606, 52.092564457812074, 197.71117134634267, 7.751471660487278, 745.5016365619617, 635.7647417117711, 380.9661410484198, 9.419093795309582, 150.8848923422334, 1067.9822692989135, 675.2165642287995, 223.69650241715425, 1357.1364157739893, 125.30237602467405, 231.697879228514, 12.820455976994069, 27.435014885300532, 230.2090211677376, 195.79947051427123, 930.247293701459, 131.4940641640681, 211.26035495774084, 200.47911743737873, 1176.8004550500461, 308.3703668829774, 112.9007824504199, 21.64611569990213, 771.56249409355, 1234.1690412293208, 138.33298465851115, 644.7130625852061, 11.533581589336205, 872.8375894354405, 1004.797014306573, 917.1048480415575, 843.3757465435934, 20.00174265770622, 169.2874985545176, 257.816392612123, 900.5964811728519, 229.19055338653413, 18.33241741435217, 945.9294426976829, 342.61766704604236, 421.37393205272514, 259.1575523736549, 778.410610842364, 39.34104141536333, 81.51412588994603, 926.8485186836715, 908.5680232975271, 885.7735839776419, 170.38066615320233, 332.8245207838144, 525.9813583292637, 136.44792508393277, 304.3694719261878, 97.5013090177511, 126.79562852036203, 159.1485850359456, 1042.9722572373896, 205.0434385251248, 140.6835129717035, 312.0261774132879, 383.3815598794341, 1018.6778249176106, 776.0660013409067, 228.16240445532375, 0.0, 4.35118817639055, 637.5246847885999, 421.7696963450277, 352.4702933732934, 259.97233032715417, 21.54203174564075, 897.1081393662547, 0.0, 450.8929169161108, 838.8127312666203, 914.5660511669048, 196.88177869743535, 872.7746187576398, 814.0466079902844, 31.762537520404678, 336.1035913620106, 192.35784435767295, 719.5874057511573, 175.80679886557607, 208.05628270831235, 171.45248320780658, 171.53761828015573, 0.0, 1229.9352001022328, 324.17163649628895, 180.7457085609959, 627.8637478316138, 323.499039762779, 918.8974142792898, 824.8382199147538, 713.558716699041, 1524.571128860681, 108.17715222977203, 485.4481385086396, 137.07221728323537, 1421.7709920313491, 302.2916862735454, 271.89660858193764, 1020.3905422569044, 471.34241880475173, 15.449172540683353, 864.2587996071976, 137.25465847359726, 135.8298874069682, 216.69533331710494, 144.4623359422137, 274.3054735512127, 41.31992657886945, 168.09243468277646, 186.7604686005157, 616.0227987956334, 381.09125249830794, 663.1489722420554, 212.2968017974665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5360070465920775, "mean_inference_ms": 1.3350052657660734, "mean_action_processing_ms": 0.22913283998174044, "mean_env_wait_ms": 0.17581236262999575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004914999008178711, "StateBufferConnector_ms": 0.002808213233947754, "ViewRequirementAgentConnector_ms": 0.08213484287261963}, "num_episodes": 23, "episode_return_max": 481.5272896467394, "episode_return_min": -926.2436869772624, "episode_return_mean": -44.174973860071894, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.6527577163582, "num_env_steps_trained_throughput_per_sec": 433.6527577163582, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 9225.204, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9225.168, "sample_time_ms": 997.964, "learn_time_ms": 8214.735, "learn_throughput": 486.93, "synch_weights_time_ms": 11.569}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "1f15c_00000", "date": "2024-08-16_14-32-55", "timestamp": 1723798975, "time_this_iter_s": 9.22795295715332, "time_total_s": 1778.9288821220398, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f880160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1778.9288821220398, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 24.099999999999998, "ram_util_percent": 74.12307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.211161940517249, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.008316361462628, "policy_loss": -0.009169599664195505, "vf_loss": 8.017009332444932, "vf_explained_var": -0.0031485708302290984, "kl": 0.016946540288201417, "entropy": 0.6107084192926922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.474614122746483, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.099198070405022, "policy_loss": -0.006983688970283659, "vf_loss": 9.104407998241445, "vf_explained_var": 0.13338674511859025, "kl": 0.01576680759951097, "entropy": 0.8295999609604083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 1147.1153495821977, "episode_reward_min": -926.2436869772624, "episode_reward_mean": -21.498858454161187, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1657.892469962932, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 98.94494018986398, "predator_policy": 1595.9343049698286}, "policy_reward_mean": {"prey_policy": -442.03653953046773, "predator_policy": 431.287110303387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.13982104164667, 13.229999999999988, -551.7133052359926, 103.88777939548484, -598.1649999801681, 1.7599999999999838, 105.405614632422, 14.859999999999982, 92.23962783292122, 109.85062491584937, 107.19315404771719, 34.73000000000002, 7.039999999999974, 172.57287759553685, 116.61134112018323, 104.5242568142533, 88.41017982533039, 269.7635595055649, 47.98000000000023, 19.419999999999888, 120.99859424317948, 42.67409346369873, -263.7884854440676, 384.77813118109384, 18.54853621777106, -215.87474835769765, 9.029999999999978, 31.353809332497832, 13.04540038619783, 96.41504379797274, 13.70354109224336, 175.9130197381991, -728.7382044459277, 17.345850492588635, -323.01254768244104, 22.12999999999996, 50.43999999999997, -190.51356536744544, -655.7877753640937, 170.1719127941765, 29.800993186489045, -788.692479654014, 288.43425988956864, 21.900000000000134, 50.408262072330466, -188.8124810047546, 1.3999999999999817, 323.21200080771314, 35.71804095027362, 81.17859963230856, 1.2599999999999714, 107.39379512840264, 193.47550871725508, -187.9827736642375, -10.79778146634844, -478.4651866646913, 217.58431932173986, 0.44516402385473564, -757.6915468420771, 481.5272896467394, 15.259999999999975, -3.514906328393807, -87.27174016110872, -365.3277298225088, -26.20800547353081, 68.58139138746922, -926.2436869772624, 74.20727153284079, -300.41895951663275, -134.52719388049243, -659.3032773505869, 19.749999999999925, 25.03999999999993, 156.84103008186307, 414.5370514988032, -553.8336798391798, 64.82799234285733, 97.37754474427243, -35.74113166867899, 18.251481173335296, -113.31991741512135, 16.260000000000026, 76.84351688838504, -155.2359902718653, 19.49752549267466, 504.38738442763736, -396.6665567357447, 4.989999999999979, 575.7690715014792, -468.66919362599293, 71.19197846328996, 64.06529802534973, 44.419999999999725, 1147.1153495821977, -159.1949941446774, -120.18931576193492, -30.33420701848602, 87.70724123070103, 263.69830170013796, 47.62608883353881], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -134.87599232364357, -262.84436216449245, -478.7728224408246, -628.7211314899919, -647.6282460225931, -13.001604207184986, -119.72310556924354, -712.5036695306243, -613.3460352732421, -713.5057346324236, -285.53507345330115, 75.63217448927364, -11.787461753273874, -904.091561034856, -337.05754838441, -81.85328498360182, -189.47798128217207, -277.59242276172034, -162.7303399907019, -210.6815721339807, -297.1549956504305, -697.6226639449869, -188.0049335699214, -251.4478516141379, -1250.3527675586943, -168.3622319478941, -289.0980685456817, -96.96966044197856, -1.2951022046375338, -13.280911440137059, -86.91595326002621, -2.7413320435622213, 71.66033865471658, -843.3566666827876, -335.5688408586924, -68.35495548650806, -2.9771817689698654, -987.3752562839895, -64.00889157422945, -144.58575726157423, -162.65149193214867, -50.72208568836853, -156.4075566520876, -731.347984397605, -285.6936092689118, 98.94494018986398, -730.8976917689594, -69.14754403251702, -72.60790588725465, -903.4302334445175, -1055.6433484408915, -1357.1364157739893, -214.66650241715462, -121.43017630552066, -204.2162696151698, -1.81357298983732, -25.3964974862591, -202.42566993015865, -127.16777795387725, -932.509595809863, -115.52822096342062, -237.82645265692136, 2.0000000000000013, -1090.2571796553555, -1123.6518467235974, -5.25033893329366, -111.95070872443938, -1170.9613092121685, -1157.7827737931464, -644.7030625852061, -116.212984658511, -872.8375894354405, 38.906418410663896, -1089.519398493286, -1022.8960292222897, -772.7980936232418, -746.3671709421509, 2.0000000000000013, -258.93197837246305, -199.39956020004576, -900.5864811728519, -925.0629859304471, -827.8913538356021, -71.5648195394508, -403.9925196697477, -237.2675523736557, -778.400610842364, -6.115223861418828, -64.33168137156002, -1041.4512564079484, -982.7777665780023, -898.0712089824252, -156.68304114841894, -570.4530462199756, 34.85916791461133, -213.5061929166082, -191.59316314323948, -0.10043689026113216, -143.0179010155434, -1042.9722572373896, -157.888585035946, -224.59498782173117, -13.738168546695244, -369.10153863966985, -132.8306899357965, -1031.7636668824439, -950.9629330403114, -151.65240240198736, -87.307783519685, -598.8677568122671, -521.4733028174161, -411.7121541527241, -144.94351624385948, -73.0162036340195, -208.0529944149207, -789.5716623562097, -865.2280238521224, -855.883662899558, 47.70530436356602, -181.75177869743553, -914.4360511669048, -842.9120729540139, -847.4240601223032, -164.63047744316157, -290.5073916003628, -615.2527339051622, -662.0202460261769, -159.1083940882489, -250.96269295917108, -49.74971750198854, -224.65899259850565, -972.4620324763721, -1183.7168546031226, -269.75477000846683, -160.9553035159778, -656.4197772173886, -595.3619698936362, -920.8656466393414, -957.3971814351925, -1480.249391289427, -1417.18373162088, -484.96813850863964, -88.9071522297722, -1421.7709920313491, -112.03221728323528, -205.1473908362073, -212.19987393741292, -12.839643477983467, -1064.3562660848681, -817.6698781775443, -615.8717738095177, -130.66757963429208, -77.58897390341617, -188.39416387718228, -75.3859606378644, -186.1542819798906, -165.2122498188711, -192.65961890176635, -143.9418032081903, -588.8386962760717, -521.5952724329921, -196.32680179746725, -662.8589722420554, -113.62062808992341, -204.02841837991951, -1214.1211422646682, -1307.5674561545247, 2.645353432990923, -30.656483315434652, -1345.1427205199539, 5.137277420307144, -508.6555098173005, -639.0254251368114, -255.06780620192183, -1159.6133727975446, -1125.8301135418958, 26.667959937418498, -1511.6487397124424, -1450.4802377508086, -91.79642207358044, -44.24684689475125, -100.33560345549988, -1209.1539705634414, 2.9416800924906354, -10.13985107743532, -1657.892469962932, 41.59999999999991, -956.8992491624039, -877.2850414027329, -823.4777299539298, -891.0851870477943, -85.47172526067288, -141.62227913784776, -63.06130789828124, 27.7400000000001, -741.7249658367843, -39.74089028594262, -223.11537851742753, -320.2524482295344], "policy_predator_policy_reward": [83.14471873003254, 87.8710946352575, 275.9143621644914, 478.9328224408246, 672.5031298527805, 52.132942423811734, 6.6418991559089156, 229.9705900160045, 724.1856343741559, 3.499070449542698, 713.5157346324236, 287.2850734533008, 22.116208268246112, 19.444693628175862, 904.1015610348561, 351.9075483844092, 192.69866573413427, 170.87222836455976, 398.7637857091529, 151.4096019591181, 276.48946717082146, 338.54025466130736, 697.6226639449869, 222.7349335699215, 258.48785161413747, 1250.3527675586943, 285.1465123072317, 344.88666578188116, 130.0259455166267, 84.85015825017238, 4.03073866318896, 200.69038285122778, 12.757019448797466, 6.734153765378078, 772.3860099689845, 676.3030570780608, 108.15791926480279, 11.154217990675065, 987.3852562839895, 83.41889157422952, 251.72520720943962, 176.5106362274606, 52.092564457812074, 197.71117134634267, 7.751471660487278, 745.5016365619617, 635.7647417117711, 380.9661410484198, 9.419093795309582, 150.8848923422334, 1067.9822692989135, 675.2165642287995, 223.69650241715425, 1357.1364157739893, 125.30237602467405, 231.697879228514, 12.820455976994069, 27.435014885300532, 230.2090211677376, 195.79947051427123, 930.247293701459, 131.4940641640681, 211.26035495774084, 200.47911743737873, 1176.8004550500461, 308.3703668829774, 112.9007824504199, 21.64611569990213, 771.56249409355, 1234.1690412293208, 138.33298465851115, 644.7130625852061, 11.533581589336205, 872.8375894354405, 1004.797014306573, 917.1048480415575, 843.3757465435934, 20.00174265770622, 169.2874985545176, 257.816392612123, 900.5964811728519, 229.19055338653413, 18.33241741435217, 945.9294426976829, 342.61766704604236, 421.37393205272514, 259.1575523736549, 778.410610842364, 39.34104141536333, 81.51412588994603, 926.8485186836715, 908.5680232975271, 885.7735839776419, 170.38066615320233, 332.8245207838144, 525.9813583292637, 136.44792508393277, 304.3694719261878, 97.5013090177511, 126.79562852036203, 159.1485850359456, 1042.9722572373896, 205.0434385251248, 140.6835129717035, 312.0261774132879, 383.3815598794341, 1018.6778249176106, 776.0660013409067, 228.16240445532375, 0.0, 4.35118817639055, 637.5246847885999, 421.7696963450277, 352.4702933732934, 259.97233032715417, 21.54203174564075, 897.1081393662547, 0.0, 450.8929169161108, 838.8127312666203, 914.5660511669048, 196.88177869743535, 872.7746187576398, 814.0466079902844, 31.762537520404678, 336.1035913620106, 192.35784435767295, 719.5874057511573, 175.80679886557607, 208.05628270831235, 171.45248320780658, 171.53761828015573, 0.0, 1229.9352001022328, 324.17163649628895, 180.7457085609959, 627.8637478316138, 323.499039762779, 918.8974142792898, 824.8382199147538, 713.558716699041, 1524.571128860681, 108.17715222977203, 485.4481385086396, 137.07221728323537, 1421.7709920313491, 302.2916862735454, 271.89660858193764, 1020.3905422569044, 471.34241880475173, 15.449172540683353, 864.2587996071976, 137.25465847359726, 135.8298874069682, 216.69533331710494, 144.4623359422137, 274.3054735512127, 41.31992657886945, 168.09243468277646, 186.7604686005157, 616.0227987956334, 381.09125249830794, 663.1489722420554, 212.2968017974665, 284.7485912854338, 109.74397207279469, 1180.8609353569095, 1185.5916727904182, 3.1421720596836833, 44.36648331543442, 1285.035794095042, 559.3570334322419, 89.17725805864397, 661.8371201597229, 260.057806201921, 1159.6133727975446, 1036.99325254545, 637.9379725605058, 1595.9343049698286, 897.5254788674301, 73.01801868167748, 134.2172287499435, 164.32090148084995, 1209.2339705634415, 2.054756338860673, 49.56341464608429, 1307.8927158577303, 1455.5151036874015, 723.6840883747668, 951.305208045694, 931.7325002798253, 662.6411009599661, 10.374379624482861, 186.38541775555177, 76.9339727044314, 46.09457642455077, 723.1380935980378, 322.02606422482705, 272.1548202438204, 318.83909533667963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5355439201929358, "mean_inference_ms": 1.334129467850151, "mean_action_processing_ms": 0.22896558584511958, "mean_env_wait_ms": 0.17577157761187095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004570722579956055, "StateBufferConnector_ms": 0.0028470754623413086, "ViewRequirementAgentConnector_ms": 0.08439195156097412}, "num_episodes": 18, "episode_return_max": 1147.1153495821977, "episode_return_min": -926.2436869772624, "episode_return_mean": -21.498858454161187, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.2860766711854, "num_env_steps_trained_throughput_per_sec": 430.2860766711854, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 9235.805, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9235.769, "sample_time_ms": 995.232, "learn_time_ms": 8227.852, "learn_throughput": 486.154, "synch_weights_time_ms": 11.771}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "1f15c_00000", "date": "2024-08-16_14-33-04", "timestamp": 1723798984, "time_this_iter_s": 9.299931287765503, "time_total_s": 1788.2288134098053, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f879700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1788.2288134098053, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.284615384615385, "ram_util_percent": 74.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2539909359008548, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.008831783072658, "policy_loss": -0.008017149751651145, "vf_loss": 9.01646485833264, "vf_explained_var": -0.005050534482986208, "kl": 0.013656965697793299, "entropy": 0.6267996121651281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2518862079691, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.35507200281456, "policy_loss": -0.004522688119061213, "vf_loss": 9.358301340335261, "vf_explained_var": 0.11562758419248793, "kl": 0.011496909001424176, "entropy": 0.8379948699600482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 1147.1153495821977, "episode_reward_min": -1121.857569208137, "episode_reward_mean": 9.927358576363396, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1657.892469962932, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 98.94494018986398, "predator_policy": 1640.9437788313194}, "policy_reward_mean": {"prey_policy": -503.1039658782047, "predator_policy": 508.06764516638634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-263.7884854440676, 384.77813118109384, 18.54853621777106, -215.87474835769765, 9.029999999999978, 31.353809332497832, 13.04540038619783, 96.41504379797274, 13.70354109224336, 175.9130197381991, -728.7382044459277, 17.345850492588635, -323.01254768244104, 22.12999999999996, 50.43999999999997, -190.51356536744544, -655.7877753640937, 170.1719127941765, 29.800993186489045, -788.692479654014, 288.43425988956864, 21.900000000000134, 50.408262072330466, -188.8124810047546, 1.3999999999999817, 323.21200080771314, 35.71804095027362, 81.17859963230856, 1.2599999999999714, 107.39379512840264, 193.47550871725508, -187.9827736642375, -10.79778146634844, -478.4651866646913, 217.58431932173986, 0.44516402385473564, -757.6915468420771, 481.5272896467394, 15.259999999999975, -3.514906328393807, -87.27174016110872, -365.3277298225088, -26.20800547353081, 68.58139138746922, -926.2436869772624, 74.20727153284079, -300.41895951663275, -134.52719388049243, -659.3032773505869, 19.749999999999925, 25.03999999999993, 156.84103008186307, 414.5370514988032, -553.8336798391798, 64.82799234285733, 97.37754474427243, -35.74113166867899, 18.251481173335296, -113.31991741512135, 16.260000000000026, 76.84351688838504, -155.2359902718653, 19.49752549267466, 504.38738442763736, -396.6665567357447, 4.989999999999979, 575.7690715014792, -468.66919362599293, 71.19197846328996, 64.06529802534973, 44.419999999999725, 1147.1153495821977, -159.1949941446774, -120.18931576193492, -30.33420701848602, 87.70724123070103, 263.69830170013796, 47.62608883353881, 139.15941428824883, 12.949999999999964, 7.499999999999968, 459.5456460039771, 303.9284388117318, -536.6110892524881, 797.3503250781624, 688.8597877701822, 170.35002605378375, 994.8333712158792, 79.05533174822972, -1121.857569208137, 76.03331072294372, -276.65722703428065, 66.30418054925599, -187.5160196135911, 153.0212431760036, 368.4234980181073, 90.06622866878595, 870.3059759049071, 397.5561868280523, 51.433862540330665], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-731.347984397605, -285.6936092689118, 98.94494018986398, -730.8976917689594, -69.14754403251702, -72.60790588725465, -903.4302334445175, -1055.6433484408915, -1357.1364157739893, -214.66650241715462, -121.43017630552066, -204.2162696151698, -1.81357298983732, -25.3964974862591, -202.42566993015865, -127.16777795387725, -932.509595809863, -115.52822096342062, -237.82645265692136, 2.0000000000000013, -1090.2571796553555, -1123.6518467235974, -5.25033893329366, -111.95070872443938, -1170.9613092121685, -1157.7827737931464, -644.7030625852061, -116.212984658511, -872.8375894354405, 38.906418410663896, -1089.519398493286, -1022.8960292222897, -772.7980936232418, -746.3671709421509, 2.0000000000000013, -258.93197837246305, -199.39956020004576, -900.5864811728519, -925.0629859304471, -827.8913538356021, -71.5648195394508, -403.9925196697477, -237.2675523736557, -778.400610842364, -6.115223861418828, -64.33168137156002, -1041.4512564079484, -982.7777665780023, -898.0712089824252, -156.68304114841894, -570.4530462199756, 34.85916791461133, -213.5061929166082, -191.59316314323948, -0.10043689026113216, -143.0179010155434, -1042.9722572373896, -157.888585035946, -224.59498782173117, -13.738168546695244, -369.10153863966985, -132.8306899357965, -1031.7636668824439, -950.9629330403114, -151.65240240198736, -87.307783519685, -598.8677568122671, -521.4733028174161, -411.7121541527241, -144.94351624385948, -73.0162036340195, -208.0529944149207, -789.5716623562097, -865.2280238521224, -855.883662899558, 47.70530436356602, -181.75177869743553, -914.4360511669048, -842.9120729540139, -847.4240601223032, -164.63047744316157, -290.5073916003628, -615.2527339051622, -662.0202460261769, -159.1083940882489, -250.96269295917108, -49.74971750198854, -224.65899259850565, -972.4620324763721, -1183.7168546031226, -269.75477000846683, -160.9553035159778, -656.4197772173886, -595.3619698936362, -920.8656466393414, -957.3971814351925, -1480.249391289427, -1417.18373162088, -484.96813850863964, -88.9071522297722, -1421.7709920313491, -112.03221728323528, -205.1473908362073, -212.19987393741292, -12.839643477983467, -1064.3562660848681, -817.6698781775443, -615.8717738095177, -130.66757963429208, -77.58897390341617, -188.39416387718228, -75.3859606378644, -186.1542819798906, -165.2122498188711, -192.65961890176635, -143.9418032081903, -588.8386962760717, -521.5952724329921, -196.32680179746725, -662.8589722420554, -113.62062808992341, -204.02841837991951, -1214.1211422646682, -1307.5674561545247, 2.645353432990923, -30.656483315434652, -1345.1427205199539, 5.137277420307144, -508.6555098173005, -639.0254251368114, -255.06780620192183, -1159.6133727975446, -1125.8301135418958, 26.667959937418498, -1511.6487397124424, -1450.4802377508086, -91.79642207358044, -44.24684689475125, -100.33560345549988, -1209.1539705634414, 2.9416800924906354, -10.13985107743532, -1657.892469962932, 41.59999999999991, -956.8992491624039, -877.2850414027329, -823.4777299539298, -891.0851870477943, -85.47172526067288, -141.62227913784776, -63.06130789828124, 27.7400000000001, -741.7249658367843, -39.74089028594262, -223.11537851742753, -320.2524482295344, -132.18199013280997, -130.13703972301892, -316.1628263501581, -70.32821207441914, -1029.419732719013, -238.90368849311375, -1582.3034844057747, -74.21329351081968, -550.0366628565453, -72.54536756854233, -1574.7374851433294, -1462.4261860600177, -1028.7273603377896, 47.54000000000007, -1094.5011985400079, 18.830000000000066, -60.831685545688664, -276.9020872619424, -1392.4716182884017, 25.760000000000122, -446.03807472808995, -160.58567850815567, -1446.294969193964, -1519.1745588005929, -116.15832728896682, -339.78096728700797, -1320.5511886410718, -1276.7894403996743, -167.4139704113545, -339.8950595581624, -625.185292266085, -773.494787369146, -203.55084466367344, -474.12629416192226, -1017.008105326842, -236.06981356239743, -48.27039817631217, -207.84122312652937, -161.22681100125425, -1391.8562554536918, -62.819244628061504, -1110.8430249789258, -294.2285014607594, -275.27511224310337], "policy_predator_policy_reward": [7.751471660487278, 745.5016365619617, 635.7647417117711, 380.9661410484198, 9.419093795309582, 150.8848923422334, 1067.9822692989135, 675.2165642287995, 223.69650241715425, 1357.1364157739893, 125.30237602467405, 231.697879228514, 12.820455976994069, 27.435014885300532, 230.2090211677376, 195.79947051427123, 930.247293701459, 131.4940641640681, 211.26035495774084, 200.47911743737873, 1176.8004550500461, 308.3703668829774, 112.9007824504199, 21.64611569990213, 771.56249409355, 1234.1690412293208, 138.33298465851115, 644.7130625852061, 11.533581589336205, 872.8375894354405, 1004.797014306573, 917.1048480415575, 843.3757465435934, 20.00174265770622, 169.2874985545176, 257.816392612123, 900.5964811728519, 229.19055338653413, 18.33241741435217, 945.9294426976829, 342.61766704604236, 421.37393205272514, 259.1575523736549, 778.410610842364, 39.34104141536333, 81.51412588994603, 926.8485186836715, 908.5680232975271, 885.7735839776419, 170.38066615320233, 332.8245207838144, 525.9813583292637, 136.44792508393277, 304.3694719261878, 97.5013090177511, 126.79562852036203, 159.1485850359456, 1042.9722572373896, 205.0434385251248, 140.6835129717035, 312.0261774132879, 383.3815598794341, 1018.6778249176106, 776.0660013409067, 228.16240445532375, 0.0, 4.35118817639055, 637.5246847885999, 421.7696963450277, 352.4702933732934, 259.97233032715417, 21.54203174564075, 897.1081393662547, 0.0, 450.8929169161108, 838.8127312666203, 914.5660511669048, 196.88177869743535, 872.7746187576398, 814.0466079902844, 31.762537520404678, 336.1035913620106, 192.35784435767295, 719.5874057511573, 175.80679886557607, 208.05628270831235, 171.45248320780658, 171.53761828015573, 0.0, 1229.9352001022328, 324.17163649628895, 180.7457085609959, 627.8637478316138, 323.499039762779, 918.8974142792898, 824.8382199147538, 713.558716699041, 1524.571128860681, 108.17715222977203, 485.4481385086396, 137.07221728323537, 1421.7709920313491, 302.2916862735454, 271.89660858193764, 1020.3905422569044, 471.34241880475173, 15.449172540683353, 864.2587996071976, 137.25465847359726, 135.8298874069682, 216.69533331710494, 144.4623359422137, 274.3054735512127, 41.31992657886945, 168.09243468277646, 186.7604686005157, 616.0227987956334, 381.09125249830794, 663.1489722420554, 212.2968017974665, 284.7485912854338, 109.74397207279469, 1180.8609353569095, 1185.5916727904182, 3.1421720596836833, 44.36648331543442, 1285.035794095042, 559.3570334322419, 89.17725805864397, 661.8371201597229, 260.057806201921, 1159.6133727975446, 1036.99325254545, 637.9379725605058, 1595.9343049698286, 897.5254788674301, 73.01801868167748, 134.2172287499435, 164.32090148084995, 1209.2339705634415, 2.054756338860673, 49.56341464608429, 1307.8927158577303, 1455.5151036874015, 723.6840883747668, 951.305208045694, 931.7325002798253, 662.6411009599661, 10.374379624482861, 186.38541775555177, 76.9339727044314, 46.09457642455077, 723.1380935980378, 322.02606422482705, 272.1548202438204, 318.83909533667963, 186.33494709331606, 215.14349705076145, 81.74461350592827, 317.6964249186488, 246.08368849311273, 1029.7397327190129, 538.4973166896891, 1577.5651072308829, 464.2528654694377, 462.25760376738305, 965.6700493862961, 1534.882532564565, 814.2483241035877, 964.2893613123655, 1036.278104733979, 728.2528815762114, 208.33258274786843, 299.7512161135467, 1174.4785064092296, 1187.066483095053, 497.1043758826201, 188.57470910185438, 1640.9437788313194, 202.66817995509922, 125.69403390372875, 406.2785713951886, 1362.090475303409, 958.5929267030562, 220.32186303306818, 353.2913474857033, 566.4363003331337, 644.7277596885062, 466.07531104271305, 364.6230709588848, 944.8117868170056, 676.6896300903416, 121.9098096725351, 224.26804029909235, 1152.2971159892102, 1271.0919263706433, 1051.6599284830017, 519.5585279520376, 260.72554853131, 360.211927712885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348646014878181, "mean_inference_ms": 1.3329305224147463, "mean_action_processing_ms": 0.2284293561772865, "mean_env_wait_ms": 0.17560977396235422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004127383232116699, "StateBufferConnector_ms": 0.002809762954711914, "ViewRequirementAgentConnector_ms": 0.08474791049957275}, "num_episodes": 22, "episode_return_max": 1147.1153495821977, "episode_return_min": -1121.857569208137, "episode_return_mean": 9.927358576363396, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.2377573456439, "num_env_steps_trained_throughput_per_sec": 430.2377573456439, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 9249.055, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9249.019, "sample_time_ms": 998.903, "learn_time_ms": 8237.421, "learn_throughput": 485.589, "synch_weights_time_ms": 11.752}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "1f15c_00000", "date": "2024-08-16_14-33-13", "timestamp": 1723798993, "time_this_iter_s": 9.301029205322266, "time_total_s": 1797.5298426151276, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3051670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1797.5298426151276, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 23.184615384615384, "ram_util_percent": 74.03076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.592224063854369, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.81874420630238, "policy_loss": -0.010290456303055324, "vf_loss": 7.828489431754622, "vf_explained_var": -0.003461138344315625, "kl": 0.019386962040497786, "entropy": 0.5985498139940242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.284790407097529, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.839798054114851, "policy_loss": -0.007799909412910147, "vf_loss": 8.846151604728092, "vf_explained_var": 0.08201605863672085, "kl": 0.01285657871895688, "entropy": 0.8790915292406839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 1147.1153495821977, "episode_reward_min": -1121.857569208137, "episode_reward_mean": 37.057096006031756, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1790.7774917765712, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 47.70530436356602, "predator_policy": 1640.9437788313194}, "policy_reward_mean": {"prey_policy": -519.1968983971735, "predator_policy": 537.7254464001894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.800993186489045, -788.692479654014, 288.43425988956864, 21.900000000000134, 50.408262072330466, -188.8124810047546, 1.3999999999999817, 323.21200080771314, 35.71804095027362, 81.17859963230856, 1.2599999999999714, 107.39379512840264, 193.47550871725508, -187.9827736642375, -10.79778146634844, -478.4651866646913, 217.58431932173986, 0.44516402385473564, -757.6915468420771, 481.5272896467394, 15.259999999999975, -3.514906328393807, -87.27174016110872, -365.3277298225088, -26.20800547353081, 68.58139138746922, -926.2436869772624, 74.20727153284079, -300.41895951663275, -134.52719388049243, -659.3032773505869, 19.749999999999925, 25.03999999999993, 156.84103008186307, 414.5370514988032, -553.8336798391798, 64.82799234285733, 97.37754474427243, -35.74113166867899, 18.251481173335296, -113.31991741512135, 16.260000000000026, 76.84351688838504, -155.2359902718653, 19.49752549267466, 504.38738442763736, -396.6665567357447, 4.989999999999979, 575.7690715014792, -468.66919362599293, 71.19197846328996, 64.06529802534973, 44.419999999999725, 1147.1153495821977, -159.1949941446774, -120.18931576193492, -30.33420701848602, 87.70724123070103, 263.69830170013796, 47.62608883353881, 139.15941428824883, 12.949999999999964, 7.499999999999968, 459.5456460039771, 303.9284388117318, -536.6110892524881, 797.3503250781624, 688.8597877701822, 170.35002605378375, 994.8333712158792, 79.05533174822972, -1121.857569208137, 76.03331072294372, -276.65722703428065, 66.30418054925599, -187.5160196135911, 153.0212431760036, 368.4234980181073, 90.06622866878595, 870.3059759049071, 397.5561868280523, 51.433862540330665, 906.0722426135598, 36.02382235633884, 19.177957890759096, 797.7287949078685, 3.8690024612887868, 9.589999999999966, -29.0421113617572, 449.67081296390126, 14.851683609449863, -963.0835618057081, -36.60996858037415, -405.19642164302223, -347.7646242062014, 27.89486197712396, 768.0225267698742, 54.421681293095865, -52.79086962479352, 85.29783171650102], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-199.39956020004576, -900.5864811728519, -925.0629859304471, -827.8913538356021, -71.5648195394508, -403.9925196697477, -237.2675523736557, -778.400610842364, -6.115223861418828, -64.33168137156002, -1041.4512564079484, -982.7777665780023, -898.0712089824252, -156.68304114841894, -570.4530462199756, 34.85916791461133, -213.5061929166082, -191.59316314323948, -0.10043689026113216, -143.0179010155434, -1042.9722572373896, -157.888585035946, -224.59498782173117, -13.738168546695244, -369.10153863966985, -132.8306899357965, -1031.7636668824439, -950.9629330403114, -151.65240240198736, -87.307783519685, -598.8677568122671, -521.4733028174161, -411.7121541527241, -144.94351624385948, -73.0162036340195, -208.0529944149207, -789.5716623562097, -865.2280238521224, -855.883662899558, 47.70530436356602, -181.75177869743553, -914.4360511669048, -842.9120729540139, -847.4240601223032, -164.63047744316157, -290.5073916003628, -615.2527339051622, -662.0202460261769, -159.1083940882489, -250.96269295917108, -49.74971750198854, -224.65899259850565, -972.4620324763721, -1183.7168546031226, -269.75477000846683, -160.9553035159778, -656.4197772173886, -595.3619698936362, -920.8656466393414, -957.3971814351925, -1480.249391289427, -1417.18373162088, -484.96813850863964, -88.9071522297722, -1421.7709920313491, -112.03221728323528, -205.1473908362073, -212.19987393741292, -12.839643477983467, -1064.3562660848681, -817.6698781775443, -615.8717738095177, -130.66757963429208, -77.58897390341617, -188.39416387718228, -75.3859606378644, -186.1542819798906, -165.2122498188711, -192.65961890176635, -143.9418032081903, -588.8386962760717, -521.5952724329921, -196.32680179746725, -662.8589722420554, -113.62062808992341, -204.02841837991951, -1214.1211422646682, -1307.5674561545247, 2.645353432990923, -30.656483315434652, -1345.1427205199539, 5.137277420307144, -508.6555098173005, -639.0254251368114, -255.06780620192183, -1159.6133727975446, -1125.8301135418958, 26.667959937418498, -1511.6487397124424, -1450.4802377508086, -91.79642207358044, -44.24684689475125, -100.33560345549988, -1209.1539705634414, 2.9416800924906354, -10.13985107743532, -1657.892469962932, 41.59999999999991, -956.8992491624039, -877.2850414027329, -823.4777299539298, -891.0851870477943, -85.47172526067288, -141.62227913784776, -63.06130789828124, 27.7400000000001, -741.7249658367843, -39.74089028594262, -223.11537851742753, -320.2524482295344, -132.18199013280997, -130.13703972301892, -316.1628263501581, -70.32821207441914, -1029.419732719013, -238.90368849311375, -1582.3034844057747, -74.21329351081968, -550.0366628565453, -72.54536756854233, -1574.7374851433294, -1462.4261860600177, -1028.7273603377896, 47.54000000000007, -1094.5011985400079, 18.830000000000066, -60.831685545688664, -276.9020872619424, -1392.4716182884017, 25.760000000000122, -446.03807472808995, -160.58567850815567, -1446.294969193964, -1519.1745588005929, -116.15832728896682, -339.78096728700797, -1320.5511886410718, -1276.7894403996743, -167.4139704113545, -339.8950595581624, -625.185292266085, -773.494787369146, -203.55084466367344, -474.12629416192226, -1017.008105326842, -236.06981356239743, -48.27039817631217, -207.84122312652937, -161.22681100125425, -1391.8562554536918, -62.819244628061504, -1110.8430249789258, -294.2285014607594, -275.27511224310337, 2.0000000000000013, -1291.5453281631299, -4.538060062367277, 7.939999999999965, -519.8106275433045, -378.28159967131006, -26.2619851879595, -1166.5584538926378, -176.7633625195906, -121.13751507400337, -80.19682314850077, -1034.252712195274, -1061.3320755345444, -1187.5584998108275, -668.57542110985, 12.218077392340712, -110.80825955890232, -45.944104008019245, -1058.693207876715, -993.9388820511767, -480.1089198290946, -123.44027399579673, -1790.7774917765712, -1750.5756096311306, -961.1749934467779, -1114.302403630241, -615.6215755239541, -572.7572639203622, -1286.3825253745133, 21.800000000000022, -252.23475564219183, -389.5632209051311, -186.01726567779724, -99.90212213155152, -243.33825959742396, -901.3055576123555], "policy_predator_policy_reward": [900.5964811728519, 229.19055338653413, 18.33241741435217, 945.9294426976829, 342.61766704604236, 421.37393205272514, 259.1575523736549, 778.410610842364, 39.34104141536333, 81.51412588994603, 926.8485186836715, 908.5680232975271, 885.7735839776419, 170.38066615320233, 332.8245207838144, 525.9813583292637, 136.44792508393277, 304.3694719261878, 97.5013090177511, 126.79562852036203, 159.1485850359456, 1042.9722572373896, 205.0434385251248, 140.6835129717035, 312.0261774132879, 383.3815598794341, 1018.6778249176106, 776.0660013409067, 228.16240445532375, 0.0, 4.35118817639055, 637.5246847885999, 421.7696963450277, 352.4702933732934, 259.97233032715417, 21.54203174564075, 897.1081393662547, 0.0, 450.8929169161108, 838.8127312666203, 914.5660511669048, 196.88177869743535, 872.7746187576398, 814.0466079902844, 31.762537520404678, 336.1035913620106, 192.35784435767295, 719.5874057511573, 175.80679886557607, 208.05628270831235, 171.45248320780658, 171.53761828015573, 0.0, 1229.9352001022328, 324.17163649628895, 180.7457085609959, 627.8637478316138, 323.499039762779, 918.8974142792898, 824.8382199147538, 713.558716699041, 1524.571128860681, 108.17715222977203, 485.4481385086396, 137.07221728323537, 1421.7709920313491, 302.2916862735454, 271.89660858193764, 1020.3905422569044, 471.34241880475173, 15.449172540683353, 864.2587996071976, 137.25465847359726, 135.8298874069682, 216.69533331710494, 144.4623359422137, 274.3054735512127, 41.31992657886945, 168.09243468277646, 186.7604686005157, 616.0227987956334, 381.09125249830794, 663.1489722420554, 212.2968017974665, 284.7485912854338, 109.74397207279469, 1180.8609353569095, 1185.5916727904182, 3.1421720596836833, 44.36648331543442, 1285.035794095042, 559.3570334322419, 89.17725805864397, 661.8371201597229, 260.057806201921, 1159.6133727975446, 1036.99325254545, 637.9379725605058, 1595.9343049698286, 897.5254788674301, 73.01801868167748, 134.2172287499435, 164.32090148084995, 1209.2339705634415, 2.054756338860673, 49.56341464608429, 1307.8927158577303, 1455.5151036874015, 723.6840883747668, 951.305208045694, 931.7325002798253, 662.6411009599661, 10.374379624482861, 186.38541775555177, 76.9339727044314, 46.09457642455077, 723.1380935980378, 322.02606422482705, 272.1548202438204, 318.83909533667963, 186.33494709331606, 215.14349705076145, 81.74461350592827, 317.6964249186488, 246.08368849311273, 1029.7397327190129, 538.4973166896891, 1577.5651072308829, 464.2528654694377, 462.25760376738305, 965.6700493862961, 1534.882532564565, 814.2483241035877, 964.2893613123655, 1036.278104733979, 728.2528815762114, 208.33258274786843, 299.7512161135467, 1174.4785064092296, 1187.066483095053, 497.1043758826201, 188.57470910185438, 1640.9437788313194, 202.66817995509922, 125.69403390372875, 406.2785713951886, 1362.090475303409, 958.5929267030562, 220.32186303306818, 353.2913474857033, 566.4363003331337, 644.7277596885062, 466.07531104271305, 364.6230709588848, 944.8117868170056, 676.6896300903416, 121.9098096725351, 224.26804029909235, 1152.2971159892102, 1271.0919263706433, 1051.6599284830017, 519.5585279520376, 260.72554853131, 360.211927712885, 1111.6746278049582, 1083.942942971732, 14.523802105973003, 18.098080312733217, 488.2075985657906, 429.0625865395817, 1005.9852149228358, 984.56401906563, 29.235808032315493, 272.5340720225669, 1034.292712195274, 89.74682314850152, 1072.2428354297774, 1147.6056285538384, 492.6526194123367, 613.3755372690752, 171.60404717637195, 0.0, 2.469282356405837, 1087.0792457657776, 158.40122731165926, 408.53799793285907, 1525.6049794268404, 1610.5517003378372, 529.2763910450075, 1198.4363818258112, 487.0237423941526, 729.2499590272878, 1007.3047981102076, 1025.3002540341795, 434.7580361891243, 261.46162165129317, 233.12851818455496, 0.0, 328.63609131392354, 901.3055576123555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.534596297681049, "mean_inference_ms": 1.3321992904427569, "mean_action_processing_ms": 0.22859237096139695, "mean_env_wait_ms": 0.17568217556155083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037469863891601562, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.08405482769012451}, "num_episodes": 18, "episode_return_max": 1147.1153495821977, "episode_return_min": -1121.857569208137, "episode_return_mean": 37.057096006031756, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.69924981337505, "num_env_steps_trained_throughput_per_sec": 415.69924981337505, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 9287.431, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9287.394, "sample_time_ms": 995.971, "learn_time_ms": 8278.696, "learn_throughput": 483.168, "synch_weights_time_ms": 11.777}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "1f15c_00000", "date": "2024-08-16_14-33-23", "timestamp": 1723799003, "time_this_iter_s": 9.626161813735962, "time_total_s": 1807.1560044288635, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3051f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1807.1560044288635, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 26.00714285714286, "ram_util_percent": 73.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4832734803674081, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.779306536376792, "policy_loss": -0.010423790902224561, "vf_loss": 6.789163584936233, "vf_explained_var": -0.003222966887963512, "kl": 0.020151101897178787, "entropy": 0.7158227728157447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.3695808961277915, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.284221941074996, "policy_loss": -0.004299767844369093, "vf_loss": 8.287817164072914, "vf_explained_var": 0.06044301065818342, "kl": 0.0062629320363920965, "entropy": 0.7954375094522244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 1176.4598124985632, "episode_reward_min": -1219.1377971496834, "episode_reward_mean": 71.84844988727933, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1790.7774917765712, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 55.83142684243829, "predator_policy": 1640.9437788313194}, "policy_reward_mean": {"prey_policy": -548.5886754162597, "predator_policy": 584.5129003598992}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-365.3277298225088, -26.20800547353081, 68.58139138746922, -926.2436869772624, 74.20727153284079, -300.41895951663275, -134.52719388049243, -659.3032773505869, 19.749999999999925, 25.03999999999993, 156.84103008186307, 414.5370514988032, -553.8336798391798, 64.82799234285733, 97.37754474427243, -35.74113166867899, 18.251481173335296, -113.31991741512135, 16.260000000000026, 76.84351688838504, -155.2359902718653, 19.49752549267466, 504.38738442763736, -396.6665567357447, 4.989999999999979, 575.7690715014792, -468.66919362599293, 71.19197846328996, 64.06529802534973, 44.419999999999725, 1147.1153495821977, -159.1949941446774, -120.18931576193492, -30.33420701848602, 87.70724123070103, 263.69830170013796, 47.62608883353881, 139.15941428824883, 12.949999999999964, 7.499999999999968, 459.5456460039771, 303.9284388117318, -536.6110892524881, 797.3503250781624, 688.8597877701822, 170.35002605378375, 994.8333712158792, 79.05533174822972, -1121.857569208137, 76.03331072294372, -276.65722703428065, 66.30418054925599, -187.5160196135911, 153.0212431760036, 368.4234980181073, 90.06622866878595, 870.3059759049071, 397.5561868280523, 51.433862540330665, 906.0722426135598, 36.02382235633884, 19.177957890759096, 797.7287949078685, 3.8690024612887868, 9.589999999999966, -29.0421113617572, 449.67081296390126, 14.851683609449863, -963.0835618057081, -36.60996858037415, -405.19642164302223, -347.7646242062014, 27.89486197712396, 768.0225267698742, 54.421681293095865, -52.79086962479352, 85.29783171650102, 457.88763227929707, 33.690000000000566, 512.7601213577514, 11.858857231489441, 705.0564822932968, 81.07713079914993, 1176.4598124985632, 38.378535179403904, 8.379999999999974, 10.949999999999967, 94.07000000000038, 13.849999999999984, 538.7755599005925, 152.45077004583263, -242.40323717025748, -1219.1377971496834, 4.829999999999969, -44.56945428585135, -319.6012677217202, 12.809999999999965, 614.4497401320722, 21.488283854866644, 161.3935564710019], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-615.2527339051622, -662.0202460261769, -159.1083940882489, -250.96269295917108, -49.74971750198854, -224.65899259850565, -972.4620324763721, -1183.7168546031226, -269.75477000846683, -160.9553035159778, -656.4197772173886, -595.3619698936362, -920.8656466393414, -957.3971814351925, -1480.249391289427, -1417.18373162088, -484.96813850863964, -88.9071522297722, -1421.7709920313491, -112.03221728323528, -205.1473908362073, -212.19987393741292, -12.839643477983467, -1064.3562660848681, -817.6698781775443, -615.8717738095177, -130.66757963429208, -77.58897390341617, -188.39416387718228, -75.3859606378644, -186.1542819798906, -165.2122498188711, -192.65961890176635, -143.9418032081903, -588.8386962760717, -521.5952724329921, -196.32680179746725, -662.8589722420554, -113.62062808992341, -204.02841837991951, -1214.1211422646682, -1307.5674561545247, 2.645353432990923, -30.656483315434652, -1345.1427205199539, 5.137277420307144, -508.6555098173005, -639.0254251368114, -255.06780620192183, -1159.6133727975446, -1125.8301135418958, 26.667959937418498, -1511.6487397124424, -1450.4802377508086, -91.79642207358044, -44.24684689475125, -100.33560345549988, -1209.1539705634414, 2.9416800924906354, -10.13985107743532, -1657.892469962932, 41.59999999999991, -956.8992491624039, -877.2850414027329, -823.4777299539298, -891.0851870477943, -85.47172526067288, -141.62227913784776, -63.06130789828124, 27.7400000000001, -741.7249658367843, -39.74089028594262, -223.11537851742753, -320.2524482295344, -132.18199013280997, -130.13703972301892, -316.1628263501581, -70.32821207441914, -1029.419732719013, -238.90368849311375, -1582.3034844057747, -74.21329351081968, -550.0366628565453, -72.54536756854233, -1574.7374851433294, -1462.4261860600177, -1028.7273603377896, 47.54000000000007, -1094.5011985400079, 18.830000000000066, -60.831685545688664, -276.9020872619424, -1392.4716182884017, 25.760000000000122, -446.03807472808995, -160.58567850815567, -1446.294969193964, -1519.1745588005929, -116.15832728896682, -339.78096728700797, -1320.5511886410718, -1276.7894403996743, -167.4139704113545, -339.8950595581624, -625.185292266085, -773.494787369146, -203.55084466367344, -474.12629416192226, -1017.008105326842, -236.06981356239743, -48.27039817631217, -207.84122312652937, -161.22681100125425, -1391.8562554536918, -62.819244628061504, -1110.8430249789258, -294.2285014607594, -275.27511224310337, 2.0000000000000013, -1291.5453281631299, -4.538060062367277, 7.939999999999965, -519.8106275433045, -378.28159967131006, -26.2619851879595, -1166.5584538926378, -176.7633625195906, -121.13751507400337, -80.19682314850077, -1034.252712195274, -1061.3320755345444, -1187.5584998108275, -668.57542110985, 12.218077392340712, -110.80825955890232, -45.944104008019245, -1058.693207876715, -993.9388820511767, -480.1089198290946, -123.44027399579673, -1790.7774917765712, -1750.5756096311306, -961.1749934467779, -1114.302403630241, -615.6215755239541, -572.7572639203622, -1286.3825253745133, 21.800000000000022, -252.23475564219183, -389.5632209051311, -186.01726567779724, -99.90212213155152, -243.33825959742396, -901.3055576123555, -935.459447445578, -171.89775316352907, 17.694214753674352, 13.87999999999996, -1206.0413762784615, 11.899999999999963, -1349.8695047124752, -94.33788958076686, -1406.927765769256, 4.336334210932277, -73.15791001130356, -392.67013324357725, -1611.453087428153, 7.939999999999977, -701.7951037313175, -455.744283212105, -1271.2460493565625, -169.84464556272937, -62.55455341463077, -267.63908407657163, 34.669999999999845, 55.83142684243829, -1467.6803875223081, -444.43072788170457, -1444.5579600712076, -14.238713818454865, -347.1440686873264, -0.17347510956918666, -1521.2090060757748, -1585.130771159571, -1408.770739703378, -1316.6072535634705, -1061.6428082213788, -95.33941484827656, -128.1852171889348, -124.37443822285665, -460.85147656268316, -653.648707164729, -1468.49004105114, -85.14480579919517, -1008.8471600789733, 8.200241202630338, -355.1337075864459, -462.2917635054634, -544.1627991541022, -267.04004291325543], "policy_predator_policy_reward": [192.35784435767295, 719.5874057511573, 175.80679886557607, 208.05628270831235, 171.45248320780658, 171.53761828015573, 0.0, 1229.9352001022328, 324.17163649628895, 180.7457085609959, 627.8637478316138, 323.499039762779, 918.8974142792898, 824.8382199147538, 713.558716699041, 1524.571128860681, 108.17715222977203, 485.4481385086396, 137.07221728323537, 1421.7709920313491, 302.2916862735454, 271.89660858193764, 1020.3905422569044, 471.34241880475173, 15.449172540683353, 864.2587996071976, 137.25465847359726, 135.8298874069682, 216.69533331710494, 144.4623359422137, 274.3054735512127, 41.31992657886945, 168.09243468277646, 186.7604686005157, 616.0227987956334, 381.09125249830794, 663.1489722420554, 212.2968017974665, 284.7485912854338, 109.74397207279469, 1180.8609353569095, 1185.5916727904182, 3.1421720596836833, 44.36648331543442, 1285.035794095042, 559.3570334322419, 89.17725805864397, 661.8371201597229, 260.057806201921, 1159.6133727975446, 1036.99325254545, 637.9379725605058, 1595.9343049698286, 897.5254788674301, 73.01801868167748, 134.2172287499435, 164.32090148084995, 1209.2339705634415, 2.054756338860673, 49.56341464608429, 1307.8927158577303, 1455.5151036874015, 723.6840883747668, 951.305208045694, 931.7325002798253, 662.6411009599661, 10.374379624482861, 186.38541775555177, 76.9339727044314, 46.09457642455077, 723.1380935980378, 322.02606422482705, 272.1548202438204, 318.83909533667963, 186.33494709331606, 215.14349705076145, 81.74461350592827, 317.6964249186488, 246.08368849311273, 1029.7397327190129, 538.4973166896891, 1577.5651072308829, 464.2528654694377, 462.25760376738305, 965.6700493862961, 1534.882532564565, 814.2483241035877, 964.2893613123655, 1036.278104733979, 728.2528815762114, 208.33258274786843, 299.7512161135467, 1174.4785064092296, 1187.066483095053, 497.1043758826201, 188.57470910185438, 1640.9437788313194, 202.66817995509922, 125.69403390372875, 406.2785713951886, 1362.090475303409, 958.5929267030562, 220.32186303306818, 353.2913474857033, 566.4363003331337, 644.7277596885062, 466.07531104271305, 364.6230709588848, 944.8117868170056, 676.6896300903416, 121.9098096725351, 224.26804029909235, 1152.2971159892102, 1271.0919263706433, 1051.6599284830017, 519.5585279520376, 260.72554853131, 360.211927712885, 1111.6746278049582, 1083.942942971732, 14.523802105973003, 18.098080312733217, 488.2075985657906, 429.0625865395817, 1005.9852149228358, 984.56401906563, 29.235808032315493, 272.5340720225669, 1034.292712195274, 89.74682314850152, 1072.2428354297774, 1147.6056285538384, 492.6526194123367, 613.3755372690752, 171.60404717637195, 0.0, 2.469282356405837, 1087.0792457657776, 158.40122731165926, 408.53799793285907, 1525.6049794268404, 1610.5517003378372, 529.2763910450075, 1198.4363818258112, 487.0237423941526, 729.2499590272878, 1007.3047981102076, 1025.3002540341795, 434.7580361891243, 261.46162165129317, 233.12851818455496, 0.0, 328.63609131392354, 901.3055576123555, 778.790311976288, 786.4545209121136, 2.115785246325607, 0.0, 520.0544138267712, 1186.8470838094418, 106.09674681225702, 1349.969504712475, 728.8318943441537, 1378.8160195074674, 394.65719657596566, 152.24797747806346, 1304.6768443012138, 1475.2960556255032, 734.7916241410077, 461.12629798181746, 178.19464556272828, 1271.2760493565622, 69.32455341463135, 271.8190840765707, 3.568573157561704, 0.0, 1467.6803875223081, 458.2807278817038, 658.0599213115902, 1339.5123124786662, 340.65540847083986, 159.11290537188967, 1443.2474380244778, 1420.6891020406094, 22.032309295872253, 1484.2078868212925, 1061.792808221379, 100.01941484827742, 36.62961430211702, 171.36058682382122, 100.25461263986459, 694.6443033658271, 97.64480579919594, 1468.80004105114, 638.7074272372462, 976.3892317711709, 370.29370758644484, 468.62004736032986, 517.6936152161171, 454.9027833222422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.534262470049208, "mean_inference_ms": 1.3304800731334625, "mean_action_processing_ms": 0.22829483878814016, "mean_env_wait_ms": 0.17579215429501457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00338590145111084, "StateBufferConnector_ms": 0.0027763843536376953, "ViewRequirementAgentConnector_ms": 0.08261716365814209}, "num_episodes": 23, "episode_return_max": 1176.4598124985632, "episode_return_min": -1219.1377971496834, "episode_return_mean": 71.84844988727933, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.59067712741387, "num_env_steps_trained_throughput_per_sec": 443.59067712741387, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 9273.606, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9273.569, "sample_time_ms": 994.91, "learn_time_ms": 8265.96, "learn_throughput": 483.912, "synch_weights_time_ms": 11.721}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "1f15c_00000", "date": "2024-08-16_14-33-32", "timestamp": 1723799012, "time_this_iter_s": 9.020916938781738, "time_total_s": 1816.1769213676453, "pid": 18616, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffbb430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1816.1769213676453, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 23.261538461538464, "ram_util_percent": 73.53846153846153}}
