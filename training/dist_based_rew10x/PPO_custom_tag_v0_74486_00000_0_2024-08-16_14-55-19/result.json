{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7589020853793179, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.617934853437716, "policy_loss": -0.005307050954264702, "vf_loss": 7.622040587127524, "vf_explained_var": 0.0020747919562001706, "kl": 0.006006477032578385, "entropy": 1.603361287760356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5752220993556043, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.51877328807084, "policy_loss": -0.0067781089834632385, "vf_loss": 5.524165975606, "vf_explained_var": 0.00036820472863616135, "kl": 0.0069271349384839665, "entropy": 1.6026961879124717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 175.8892358229175, "episode_reward_min": 3.6999999999999895, "episode_reward_mean": 90.79325805595235, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -671.6282036379862, "predator_policy": 4.202213205843816}, "policy_reward_max": {"prey_policy": 155.2915411953105, "predator_policy": 674.3582036379856}, "policy_reward_mean": {"prey_policy": -172.98977681140303, "predator_policy": 218.38640583937914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.06482551884432, 147.84648038944943, 148.0761688095723, 46.632419340238364, 153.46266386235402, 22.360000000000273, 18.840000000000103, 161.89403038159207, 4.469999999999987, 107.90220077894323, 135.23000000000013, 167.61999999999983, 56.84999999999974, 6.239999999999936, 25.93000000000017, 3.6999999999999895, 175.8892358229175, 79.27062010323107], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.2915411953105, -47.227746699527934, -323.06484349648224, -450.98865908694927, -255.13005859034263, -8.133044357285742, -68.81729396510228, -241.23486607347584, 109.03439525268664, -333.865778475562, -39.529507368964175, -95.75837187133627, -311.9859808098132, -68.11923737491186, -411.61368823464016, 103.95130489345318, -591.41676897554, -671.6282036379862, 16.8170580695988, -211.32324135551542, 110.46970621943295, -93.98409228322642, 73.09357712114625, -105.2897601063058, -262.85036335225874, -186.23148864633222, -125.63090482561523, -91.81980546356024, -118.14414475964725, -405.98404036473687, -175.17222819749483, -660.8672908881526, 58.45516761972762, -72.7851815018306, -133.51385473216607, -292.6342700871038], "policy_predator_policy_reward": [11.129270260682315, 52.87176076237948, 638.7172196755854, 283.18276329729474, 236.7737762152755, 174.56549554192392, 78.92221613005748, 277.76236324875936, 27.992707983112684, 350.30133910211583, 51.29950736896382, 106.34837187133708, 15.400799542629105, 383.5444186420964, 437.44872130741186, 32.10769241536704, 593.1567689755393, 674.3582036379856, 4.202213205843816, 298.20617085901534, 14.250052476360414, 104.4943335874339, 92.97642287885374, 106.83976010630613, 368.5422099432228, 137.38964205536797, 130.28090482561586, 93.40980546356066, 143.46414475964792, 406.5940403647363, 176.65222819749462, 663.0872908881526, 161.14056166757922, 29.078688037442063, 281.9715355110486, 223.4472094114507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5342784732803592, "mean_inference_ms": 1.3269596854579397, "mean_action_processing_ms": 0.2240675569363463, "mean_env_wait_ms": 0.18212416439740112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014454126358032227, "StateBufferConnector_ms": 0.0030524200863308376, "ViewRequirementAgentConnector_ms": 0.09169644779629177}, "num_episodes": 18, "episode_return_max": 175.8892358229175, "episode_return_min": 3.6999999999999895, "episode_return_mean": 90.79325805595235, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.05098586706475, "num_env_steps_trained_throughput_per_sec": 399.05098586706475, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10023.794, "restore_workers_time_ms": 0.019, "training_step_time_ms": 10023.737, "sample_time_ms": 1133.327, "learn_time_ms": 8876.842, "learn_throughput": 450.611, "synch_weights_time_ms": 12.895}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "74486_00000", "date": "2024-08-16_14-55-38", "timestamp": 1723800338, "time_this_iter_s": 10.029605150222778, "time_total_s": 10.029605150222778, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39727faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.029605150222778, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.713333333333335, "ram_util_percent": 74.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9242729532813269, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.354277286327705, "policy_loss": -0.008452544641981601, "vf_loss": 7.3610556531835485, "vf_explained_var": 0.008867989425305967, "kl": 0.008370852953613752, "entropy": 1.5890218408019454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6129198867492575, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.223855425693371, "policy_loss": -0.00998003901470275, "vf_loss": 5.232033553956047, "vf_explained_var": -0.00016079097197800086, "kl": 0.009009524228708786, "entropy": 1.5950108152848703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 237.71946676109997, "episode_reward_min": -2.0495470119920536, "episode_reward_mean": 98.33470395419084, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -765.640775013856, "predator_policy": 4.202213205843816}, "policy_reward_max": {"prey_policy": 161.10851766236897, "predator_policy": 765.9707750138557}, "policy_reward_mean": {"prey_policy": -173.84988499435153, "predator_policy": 223.01723697144683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.06482551884432, 147.84648038944943, 148.0761688095723, 46.632419340238364, 153.46266386235402, 22.360000000000273, 18.840000000000103, 161.89403038159207, 4.469999999999987, 107.90220077894323, 135.23000000000013, 167.61999999999983, 56.84999999999974, 6.239999999999936, 25.93000000000017, 3.6999999999999895, 175.8892358229175, 79.27062010323107, 60.209999999999816, 77.88569393165518, 100.14277387308198, 63.56999999999966, 156.42000000000002, 84.02000000000105, -2.0495470119920536, 54.3999999999999, 101.11000000000007, 179.45999999999992, 81.0577033305603, 176.69284290801855, 146.37999999999977, 237.71946676109997, 78.56000000000041, 1.5199999999999894, 107.09237593161478, 201.57938761968893], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.2915411953105, -47.227746699527934, -323.06484349648224, -450.98865908694927, -255.13005859034263, -8.133044357285742, -68.81729396510228, -241.23486607347584, 109.03439525268664, -333.865778475562, -39.529507368964175, -95.75837187133627, -311.9859808098132, -68.11923737491186, -411.61368823464016, 103.95130489345318, -591.41676897554, -671.6282036379862, 16.8170580695988, -211.32324135551542, 110.46970621943295, -93.98409228322642, 73.09357712114625, -105.2897601063058, -262.85036335225874, -186.23148864633222, -125.63090482561523, -91.81980546356024, -118.14414475964725, -405.98404036473687, -175.17222819749483, -660.8672908881526, 58.45516761972762, -72.7851815018306, -133.51385473216607, -292.6342700871038, -166.4668569924081, -219.8903341954201, -22.176757204035884, -37.64725167076428, -377.3890264037286, 46.6250208136849, -86.38641254472485, -114.47429392523246, -157.4720720447695, -18.898974240372098, 68.87732556168169, -32.08701533333011, -380.58962823016213, -335.27575820201815, -181.73636370729017, -149.3802462461911, -14.265939402373366, -732.95804172046, -765.640775013856, 161.10851766236897, -134.92636106227684, -200.33277293259437, -573.6911460794861, 67.03661629732298, -317.60865995554246, 90.74953348134663, -146.51809408835837, 87.58625949841837, -117.1286976480624, -10.834701888654202, -675.2320255427676, -256.5358499393454, -85.21224037561753, -92.09254397164062, -434.462529823994, 25.768342687853412], "policy_predator_policy_reward": [11.129270260682315, 52.87176076237948, 638.7172196755854, 283.18276329729474, 236.7737762152755, 174.56549554192392, 78.92221613005748, 277.76236324875936, 27.992707983112684, 350.30133910211583, 51.29950736896382, 106.34837187133708, 15.400799542629105, 383.5444186420964, 437.44872130741186, 32.10769241536704, 593.1567689755393, 674.3582036379856, 4.202213205843816, 298.20617085901534, 14.250052476360414, 104.4943335874339, 92.97642287885374, 106.83976010630613, 368.5422099432228, 137.38964205536797, 130.28090482561586, 93.40980546356066, 143.46414475964792, 406.5940403647363, 176.65222819749462, 663.0872908881526, 161.14056166757922, 29.078688037442063, 281.9715355110486, 223.4472094114507, 225.2968569924078, 221.27033419541905, 69.36216456086763, 68.34753824558845, 386.7703958470842, 44.136383616039836, 123.54641254472493, 140.88429392523153, 189.5320720447685, 143.2589742403718, 10.215117412973813, 37.01457235867463, 547.0591916258035, 166.75664779438426, 234.53636370728958, 150.98024624619003, 115.06593940237374, 733.26804172046, 765.9707750138557, 18.02148233763096, 330.8918283155702, 85.4250090098604, 577.2411460794856, 106.10622661069554, 323.61865995554206, 49.62046651865348, 224.698995157555, 71.95230619348507, 119.77869764806324, 86.74470188865429, 675.4420255427674, 257.8458499393456, 159.92544101983495, 124.47171925903868, 263.1864026397688, 347.0871721160616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5285758802352536, "mean_inference_ms": 1.305143695580141, "mean_action_processing_ms": 0.22054420722483897, "mean_env_wait_ms": 0.17724215195762083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010030799441867404, "StateBufferConnector_ms": 0.002954403559366862, "ViewRequirementAgentConnector_ms": 0.0883251428604126}, "num_episodes": 18, "episode_return_max": 237.71946676109997, "episode_return_min": -2.0495470119920536, "episode_return_mean": 98.33470395419084, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.92103149298043, "num_env_steps_trained_throughput_per_sec": 421.92103149298043, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 9752.124, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9752.079, "sample_time_ms": 1083.715, "learn_time_ms": 8655.543, "learn_throughput": 462.132, "synch_weights_time_ms": 12.147}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "74486_00000", "date": "2024-08-16_14-55-49", "timestamp": 1723800349, "time_this_iter_s": 9.48361873626709, "time_total_s": 19.513223886489868, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39727f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.513223886489868, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.1375, "ram_util_percent": 74.45625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4539633037236632, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.12822223088098, "policy_loss": -0.008683794714441454, "vf_loss": 8.133907447037874, "vf_explained_var": 0.029973692742605057, "kl": 0.01499291852263473, "entropy": 1.5851577212570835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7097036717745362, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.893296978713344, "policy_loss": -0.012477219982870987, "vf_loss": 4.903109919078767, "vf_explained_var": 0.001900024798812059, "kl": 0.013321431153703062, "entropy": 1.5848839418597953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 257.84000000000003, "episode_reward_min": -90.72140610978988, "episode_reward_mean": 102.52267318461769, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -765.640775013856, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 161.10851766236897, "predator_policy": 765.9707750138557}, "policy_reward_mean": {"prey_policy": -164.67153658390293, "predator_policy": 215.93287317621167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.06482551884432, 147.84648038944943, 148.0761688095723, 46.632419340238364, 153.46266386235402, 22.360000000000273, 18.840000000000103, 161.89403038159207, 4.469999999999987, 107.90220077894323, 135.23000000000013, 167.61999999999983, 56.84999999999974, 6.239999999999936, 25.93000000000017, 3.6999999999999895, 175.8892358229175, 79.27062010323107, 60.209999999999816, 77.88569393165518, 100.14277387308198, 63.56999999999966, 156.42000000000002, 84.02000000000105, -2.0495470119920536, 54.3999999999999, 101.11000000000007, 179.45999999999992, 81.0577033305603, 176.69284290801855, 146.37999999999977, 237.71946676109997, 78.56000000000041, 1.5199999999999894, 107.09237593161478, 201.57938761968893, 9.029999999999976, 246.6639231361818, 161.86848452317474, 139.92243747779432, 79.53999999999998, 176.84999999999997, 12.29999999999993, 127.31685858857291, 115.15000000000042, 220.92000000000002, 21.669999999999984, 189.22888796953012, -90.72140610978988, -27.1870630741667, 257.84000000000003, 184.21999999999915, 116.88000000000011, 54.68288710718771], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.2915411953105, -47.227746699527934, -323.06484349648224, -450.98865908694927, -255.13005859034263, -8.133044357285742, -68.81729396510228, -241.23486607347584, 109.03439525268664, -333.865778475562, -39.529507368964175, -95.75837187133627, -311.9859808098132, -68.11923737491186, -411.61368823464016, 103.95130489345318, -591.41676897554, -671.6282036379862, 16.8170580695988, -211.32324135551542, 110.46970621943295, -93.98409228322642, 73.09357712114625, -105.2897601063058, -262.85036335225874, -186.23148864633222, -125.63090482561523, -91.81980546356024, -118.14414475964725, -405.98404036473687, -175.17222819749483, -660.8672908881526, 58.45516761972762, -72.7851815018306, -133.51385473216607, -292.6342700871038, -166.4668569924081, -219.8903341954201, -22.176757204035884, -37.64725167076428, -377.3890264037286, 46.6250208136849, -86.38641254472485, -114.47429392523246, -157.4720720447695, -18.898974240372098, 68.87732556168169, -32.08701533333011, -380.58962823016213, -335.27575820201815, -181.73636370729017, -149.3802462461911, -14.265939402373366, -732.95804172046, -765.640775013856, 161.10851766236897, -134.92636106227684, -200.33277293259437, -573.6911460794861, 67.03661629732298, -317.60865995554246, 90.74953348134663, -146.51809408835837, 87.58625949841837, -117.1286976480624, -10.834701888654202, -675.2320255427676, -256.5358499393454, -85.21224037561753, -92.09254397164062, -434.462529823994, 25.768342687853412, -112.51074266465916, -88.6663460465459, -289.658136775229, 0.9597488457946588, 25.217239003174615, -211.39187687508422, -144.28277028988177, -101.38135751345706, -482.1906919378582, -636.4887070273576, 11.267355416495995, -2.1929247600624606, -245.0866341058506, -2.2162857969940646, -187.2958427658936, -220.3634478393579, -258.80422628810646, 99.59614222516268, 106.4414936633329, -251.26571381057434, -173.52965271924523, -122.83380672733482, -79.26901295449129, 8.125716329418061, -255.6872402384676, -417.6549879319191, -229.2055560657955, -221.2373114331027, 57.1022544486081, 74.23868146602877, 31.175453107637363, -109.1545972709546, 65.98983827406778, -220.862971944122, -150.10475682697512, -534.1125556386081], "policy_predator_policy_reward": [11.129270260682315, 52.87176076237948, 638.7172196755854, 283.18276329729474, 236.7737762152755, 174.56549554192392, 78.92221613005748, 277.76236324875936, 27.992707983112684, 350.30133910211583, 51.29950736896382, 106.34837187133708, 15.400799542629105, 383.5444186420964, 437.44872130741186, 32.10769241536704, 593.1567689755393, 674.3582036379856, 4.202213205843816, 298.20617085901534, 14.250052476360414, 104.4943335874339, 92.97642287885374, 106.83976010630613, 368.5422099432228, 137.38964205536797, 130.28090482561586, 93.40980546356066, 143.46414475964792, 406.5940403647363, 176.65222819749462, 663.0872908881526, 161.14056166757922, 29.078688037442063, 281.9715355110486, 223.4472094114507, 225.2968569924078, 221.27033419541905, 69.36216456086763, 68.34753824558845, 386.7703958470842, 44.136383616039836, 123.54641254472493, 140.88429392523153, 189.5320720447685, 143.2589742403718, 10.215117412973813, 37.01457235867463, 547.0591916258035, 166.75664779438426, 234.53636370728958, 150.98024624619003, 115.06593940237374, 733.26804172046, 765.9707750138557, 18.02148233763096, 330.8918283155702, 85.4250090098604, 577.2411460794856, 106.10622661069554, 323.61865995554206, 49.62046651865348, 224.698995157555, 71.95230619348507, 119.77869764806324, 86.74470188865429, 675.4420255427674, 257.8458499393456, 159.92544101983495, 124.47171925903868, 263.1864026397688, 347.0871721160616, 119.92074266465984, 90.28634604654623, 230.94332902476117, 304.41898204085567, 344.4879346363808, 3.555187758703665, 162.8331332807345, 222.75343200039845, 560.2406919378582, 637.9787070273571, 56.892644583503994, 110.88292476006278, 0.0, 259.6029199028435, 392.8262255306758, 142.1499236631471, 260.15422628810535, 14.203857774837536, 3.989354639323288, 361.75486550791794, 181.81965271924562, 136.21380672733397, 95.6382070101422, 164.73397758446134, 87.1282865895839, 495.4925354710129, 102.31442058099425, 320.9413838437349, 87.06774555139191, 39.43131853397119, 85.3645468923627, 176.8345972709546, 18.070161725932355, 253.68297194412136, 192.73270968684136, 546.1674898859284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255726549945712, "mean_inference_ms": 1.29632036743632, "mean_action_processing_ms": 0.21914114354656528, "mean_env_wait_ms": 0.1758233382333151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008611325864438657, "StateBufferConnector_ms": 0.0029175369827835647, "ViewRequirementAgentConnector_ms": 0.09844523889047128}, "num_episodes": 18, "episode_return_max": 257.84000000000003, "episode_return_min": -90.72140610978988, "episode_return_mean": 102.52267318461769, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.73380514562274, "num_env_steps_trained_throughput_per_sec": 429.73380514562274, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 9604.113, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9604.074, "sample_time_ms": 1070.879, "learn_time_ms": 8520.688, "learn_throughput": 469.446, "synch_weights_time_ms": 11.796}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "74486_00000", "date": "2024-08-16_14-55-59", "timestamp": 1723800359, "time_this_iter_s": 9.310864925384521, "time_total_s": 28.82408881187439, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3972eb5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.82408881187439, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.77692307692308, "ram_util_percent": 74.43846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4901868655410393, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.86921439145608, "policy_loss": -0.006026746943918249, "vf_loss": 8.874009779773692, "vf_explained_var": 0.05883831712934706, "kl": 0.006156865957783133, "entropy": 1.5807727357697865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8124740542085083, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3061095736014146, "policy_loss": -0.010852807162147232, "vf_loss": 5.315039611745764, "vf_explained_var": 0.0016175633700436386, "kl": 0.009613864681861704, "entropy": 1.5726955229012425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 257.84000000000003, "episode_reward_min": -90.72140610978988, "episode_reward_mean": 110.23410776985367, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -765.640775013856, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 170.7377515633159, "predator_policy": 765.9707750138557}, "policy_reward_mean": {"prey_policy": -156.62555614923912, "predator_policy": 211.7426100341658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.06482551884432, 147.84648038944943, 148.0761688095723, 46.632419340238364, 153.46266386235402, 22.360000000000273, 18.840000000000103, 161.89403038159207, 4.469999999999987, 107.90220077894323, 135.23000000000013, 167.61999999999983, 56.84999999999974, 6.239999999999936, 25.93000000000017, 3.6999999999999895, 175.8892358229175, 79.27062010323107, 60.209999999999816, 77.88569393165518, 100.14277387308198, 63.56999999999966, 156.42000000000002, 84.02000000000105, -2.0495470119920536, 54.3999999999999, 101.11000000000007, 179.45999999999992, 81.0577033305603, 176.69284290801855, 146.37999999999977, 237.71946676109997, 78.56000000000041, 1.5199999999999894, 107.09237593161478, 201.57938761968893, 9.029999999999976, 246.6639231361818, 161.86848452317474, 139.92243747779432, 79.53999999999998, 176.84999999999997, 12.29999999999993, 127.31685858857291, 115.15000000000042, 220.92000000000002, 21.669999999999984, 189.22888796953012, -90.72140610978988, -27.1870630741667, 257.84000000000003, 184.21999999999915, 116.88000000000011, 54.68288710718771, 121.4962927536379, 29.282168959709516, 148.21377221098447, 70.35689226005941, 191.07000000000008, 24.720657450026398, 206.9722186746495, 201.52109008857246, 248.54475996506818, 127.88682106559857, -46.034030310242116, 150.92000000000024, 139.7390999879713, 168.83999999999992, 75.72000000000001, 245.299999999999, 60.17000000000005, 235.91166435407285], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.2915411953105, -47.227746699527934, -323.06484349648224, -450.98865908694927, -255.13005859034263, -8.133044357285742, -68.81729396510228, -241.23486607347584, 109.03439525268664, -333.865778475562, -39.529507368964175, -95.75837187133627, -311.9859808098132, -68.11923737491186, -411.61368823464016, 103.95130489345318, -591.41676897554, -671.6282036379862, 16.8170580695988, -211.32324135551542, 110.46970621943295, -93.98409228322642, 73.09357712114625, -105.2897601063058, -262.85036335225874, -186.23148864633222, -125.63090482561523, -91.81980546356024, -118.14414475964725, -405.98404036473687, -175.17222819749483, -660.8672908881526, 58.45516761972762, -72.7851815018306, -133.51385473216607, -292.6342700871038, -166.4668569924081, -219.8903341954201, -22.176757204035884, -37.64725167076428, -377.3890264037286, 46.6250208136849, -86.38641254472485, -114.47429392523246, -157.4720720447695, -18.898974240372098, 68.87732556168169, -32.08701533333011, -380.58962823016213, -335.27575820201815, -181.73636370729017, -149.3802462461911, -14.265939402373366, -732.95804172046, -765.640775013856, 161.10851766236897, -134.92636106227684, -200.33277293259437, -573.6911460794861, 67.03661629732298, -317.60865995554246, 90.74953348134663, -146.51809408835837, 87.58625949841837, -117.1286976480624, -10.834701888654202, -675.2320255427676, -256.5358499393454, -85.21224037561753, -92.09254397164062, -434.462529823994, 25.768342687853412, -112.51074266465916, -88.6663460465459, -289.658136775229, 0.9597488457946588, 25.217239003174615, -211.39187687508422, -144.28277028988177, -101.38135751345706, -482.1906919378582, -636.4887070273576, 11.267355416495995, -2.1929247600624606, -245.0866341058506, -2.2162857969940646, -187.2958427658936, -220.3634478393579, -258.80422628810646, 99.59614222516268, 106.4414936633329, -251.26571381057434, -173.52965271924523, -122.83380672733482, -79.26901295449129, 8.125716329418061, -255.6872402384676, -417.6549879319191, -229.2055560657955, -221.2373114331027, 57.1022544486081, 74.23868146602877, 31.175453107637363, -109.1545972709546, 65.98983827406778, -220.862971944122, -150.10475682697512, -534.1125556386081, -260.4412089600575, -271.590507049054, -134.98689709743033, -286.6790441927316, 20.391171180556626, -148.95087961037626, -229.57691318719594, -216.12131407620808, -25.02185756891587, -319.7438625408479, -49.69986308819994, -104.56651856372484, -61.681011782899176, -80.97055817455254, -293.7712720839291, -184.92754232734143, -40.20844835321182, 5.496465833219723, -24.347668727967122, -91.46730558428152, -203.35950832435395, -409.1693530867433, -195.67993548957782, -203.9180212430514, 7.683856881746042, -291.3323864461521, -60.55382272492619, 55.429937806715046, -247.2356371591817, -125.58570914232547, 64.37418943310189, 119.55950536975193, -2.295798188180486, -518.5824534925471, 170.7377515633159, -130.76171423135892], "policy_predator_policy_reward": [11.129270260682315, 52.87176076237948, 638.7172196755854, 283.18276329729474, 236.7737762152755, 174.56549554192392, 78.92221613005748, 277.76236324875936, 27.992707983112684, 350.30133910211583, 51.29950736896382, 106.34837187133708, 15.400799542629105, 383.5444186420964, 437.44872130741186, 32.10769241536704, 593.1567689755393, 674.3582036379856, 4.202213205843816, 298.20617085901534, 14.250052476360414, 104.4943335874339, 92.97642287885374, 106.83976010630613, 368.5422099432228, 137.38964205536797, 130.28090482561586, 93.40980546356066, 143.46414475964792, 406.5940403647363, 176.65222819749462, 663.0872908881526, 161.14056166757922, 29.078688037442063, 281.9715355110486, 223.4472094114507, 225.2968569924078, 221.27033419541905, 69.36216456086763, 68.34753824558845, 386.7703958470842, 44.136383616039836, 123.54641254472493, 140.88429392523153, 189.5320720447685, 143.2589742403718, 10.215117412973813, 37.01457235867463, 547.0591916258035, 166.75664779438426, 234.53636370728958, 150.98024624619003, 115.06593940237374, 733.26804172046, 765.9707750138557, 18.02148233763096, 330.8918283155702, 85.4250090098604, 577.2411460794856, 106.10622661069554, 323.61865995554206, 49.62046651865348, 224.698995157555, 71.95230619348507, 119.77869764806324, 86.74470188865429, 675.4420255427674, 257.8458499393456, 159.92544101983495, 124.47171925903868, 263.1864026397688, 347.0871721160616, 119.92074266465984, 90.28634604654623, 230.94332902476117, 304.41898204085567, 344.4879346363808, 3.555187758703665, 162.8331332807345, 222.75343200039845, 560.2406919378582, 637.9787070273571, 56.892644583503994, 110.88292476006278, 0.0, 259.6029199028435, 392.8262255306758, 142.1499236631471, 260.15422628810535, 14.203857774837536, 3.989354639323288, 361.75486550791794, 181.81965271924562, 136.21380672733397, 95.6382070101422, 164.73397758446134, 87.1282865895839, 495.4925354710129, 102.31442058099425, 320.9413838437349, 87.06774555139191, 39.43131853397119, 85.3645468923627, 176.8345972709546, 18.070161725932355, 253.68297194412136, 192.73270968684136, 546.1674898859284, 269.2878972002779, 384.24011156247053, 101.97276305869127, 348.97534719117874, 122.21088207493158, 154.5625985658715, 115.12877893216447, 400.92634059129904, 166.38185756891585, 369.45386254084724, 151.7287246594797, 27.258314442472088, 95.48948473954404, 254.13430389255663, 235.3754951861115, 444.8444093137306, 176.25844835321178, 106.9982941318482, 104.53124312425638, 139.17055225359107, 334.099083076739, 232.3957480241162, 139.70208674319497, 410.8158699894341, 109.77614311825407, 313.6114864341231, 67.66278041100617, 106.3011045072046, 263.1206885942246, 185.42065770728138, 29.555810566898494, 31.810494630247995, 4.275798188180444, 576.772453492547, 72.14857453723879, 123.78705248487775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5223247749445865, "mean_inference_ms": 1.2920599969025088, "mean_action_processing_ms": 0.21797097411711153, "mean_env_wait_ms": 0.17477609048684467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007966988616519503, "StateBufferConnector_ms": 0.002930727269914415, "ViewRequirementAgentConnector_ms": 0.09560154543982612}, "num_episodes": 18, "episode_return_max": 257.84000000000003, "episode_return_min": -90.72140610978988, "episode_return_mean": 110.23410776985367, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.86699810778725, "num_env_steps_trained_throughput_per_sec": 424.86699810778725, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 9556.764, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9556.726, "sample_time_ms": 1066.739, "learn_time_ms": 8477.441, "learn_throughput": 471.84, "synch_weights_time_ms": 11.796}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "74486_00000", "date": "2024-08-16_14-56-08", "timestamp": 1723800368, "time_this_iter_s": 9.418142795562744, "time_total_s": 38.242231607437134, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397334280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.242231607437134, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.92142857142857, "ram_util_percent": 74.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.820065369807854, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.388463603630267, "policy_loss": -0.006453738750633661, "vf_loss": 9.39275642173, "vf_explained_var": 0.010064885666761449, "kl": 0.01080461211783005, "entropy": 1.563490842763709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1169901188246156, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.03143891657471, "policy_loss": -0.013698397474930124, "vf_loss": 6.0426649350968615, "vf_explained_var": 0.012044074106468726, "kl": 0.01236178305835939, "entropy": 1.5739925025001404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 340.49999999999955, "episode_reward_min": -90.72140610978988, "episode_reward_mean": 136.92055769174522, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -765.640775013856, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.00420968308657, "predator_policy": 765.9707750138557}, "policy_reward_mean": {"prey_policy": -138.93410789270973, "predator_policy": 207.39438673858223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.06482551884432, 147.84648038944943, 148.0761688095723, 46.632419340238364, 153.46266386235402, 22.360000000000273, 18.840000000000103, 161.89403038159207, 4.469999999999987, 107.90220077894323, 135.23000000000013, 167.61999999999983, 56.84999999999974, 6.239999999999936, 25.93000000000017, 3.6999999999999895, 175.8892358229175, 79.27062010323107, 60.209999999999816, 77.88569393165518, 100.14277387308198, 63.56999999999966, 156.42000000000002, 84.02000000000105, -2.0495470119920536, 54.3999999999999, 101.11000000000007, 179.45999999999992, 81.0577033305603, 176.69284290801855, 146.37999999999977, 237.71946676109997, 78.56000000000041, 1.5199999999999894, 107.09237593161478, 201.57938761968893, 9.029999999999976, 246.6639231361818, 161.86848452317474, 139.92243747779432, 79.53999999999998, 176.84999999999997, 12.29999999999993, 127.31685858857291, 115.15000000000042, 220.92000000000002, 21.669999999999984, 189.22888796953012, -90.72140610978988, -27.1870630741667, 257.84000000000003, 184.21999999999915, 116.88000000000011, 54.68288710718771, 121.4962927536379, 29.282168959709516, 148.21377221098447, 70.35689226005941, 191.07000000000008, 24.720657450026398, 206.9722186746495, 201.52109008857246, 248.54475996506818, 127.88682106559857, -46.034030310242116, 150.92000000000024, 139.7390999879713, 168.83999999999992, 75.72000000000001, 245.299999999999, 60.17000000000005, 235.91166435407285, 340.49999999999955, 87.25509261517665, 213.0099999999997, 172.73000000000008, 272.49, 335.1086209483923, 117.04000000000026, 307.25373155671133, 323.1550539105302, 150.09000000000017, 307.28, 125.81958563016622, 246.318655789775, 162.92000000000013, 43.38061760896048, 296.0562113530789, 248.8082042300203, 159.59237598904267, 96.04912409281148, 149.3859583433127, 188.73769091686225, 227.6602240683854, 172.48999999999984, 305.9098923730318, 314.2292502844691, 77.33345222139853, 177.67571012118748], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.2915411953105, -47.227746699527934, -323.06484349648224, -450.98865908694927, -255.13005859034263, -8.133044357285742, -68.81729396510228, -241.23486607347584, 109.03439525268664, -333.865778475562, -39.529507368964175, -95.75837187133627, -311.9859808098132, -68.11923737491186, -411.61368823464016, 103.95130489345318, -591.41676897554, -671.6282036379862, 16.8170580695988, -211.32324135551542, 110.46970621943295, -93.98409228322642, 73.09357712114625, -105.2897601063058, -262.85036335225874, -186.23148864633222, -125.63090482561523, -91.81980546356024, -118.14414475964725, -405.98404036473687, -175.17222819749483, -660.8672908881526, 58.45516761972762, -72.7851815018306, -133.51385473216607, -292.6342700871038, -166.4668569924081, -219.8903341954201, -22.176757204035884, -37.64725167076428, -377.3890264037286, 46.6250208136849, -86.38641254472485, -114.47429392523246, -157.4720720447695, -18.898974240372098, 68.87732556168169, -32.08701533333011, -380.58962823016213, -335.27575820201815, -181.73636370729017, -149.3802462461911, -14.265939402373366, -732.95804172046, -765.640775013856, 161.10851766236897, -134.92636106227684, -200.33277293259437, -573.6911460794861, 67.03661629732298, -317.60865995554246, 90.74953348134663, -146.51809408835837, 87.58625949841837, -117.1286976480624, -10.834701888654202, -675.2320255427676, -256.5358499393454, -85.21224037561753, -92.09254397164062, -434.462529823994, 25.768342687853412, -112.51074266465916, -88.6663460465459, -289.658136775229, 0.9597488457946588, 25.217239003174615, -211.39187687508422, -144.28277028988177, -101.38135751345706, -482.1906919378582, -636.4887070273576, 11.267355416495995, -2.1929247600624606, -245.0866341058506, -2.2162857969940646, -187.2958427658936, -220.3634478393579, -258.80422628810646, 99.59614222516268, 106.4414936633329, -251.26571381057434, -173.52965271924523, -122.83380672733482, -79.26901295449129, 8.125716329418061, -255.6872402384676, -417.6549879319191, -229.2055560657955, -221.2373114331027, 57.1022544486081, 74.23868146602877, 31.175453107637363, -109.1545972709546, 65.98983827406778, -220.862971944122, -150.10475682697512, -534.1125556386081, -260.4412089600575, -271.590507049054, -134.98689709743033, -286.6790441927316, 20.391171180556626, -148.95087961037626, -229.57691318719594, -216.12131407620808, -25.02185756891587, -319.7438625408479, -49.69986308819994, -104.56651856372484, -61.681011782899176, -80.97055817455254, -293.7712720839291, -184.92754232734143, -40.20844835321182, 5.496465833219723, -24.347668727967122, -91.46730558428152, -203.35950832435395, -409.1693530867433, -195.67993548957782, -203.9180212430514, 7.683856881746042, -291.3323864461521, -60.55382272492619, 55.429937806715046, -247.2356371591817, -125.58570914232547, 64.37418943310189, 119.55950536975193, -2.295798188180486, -518.5824534925471, 170.7377515633159, -130.76171423135892, 176.61131588892925, 144.27640115737873, -214.1838080837329, -145.44853249452234, -368.64333177584496, 188.00420968308657, -50.85772183772144, -466.932390627462, -142.94181037716535, 137.34334487453577, 167.77435156322468, 42.46490233464601, -152.80863437666355, -380.1072629202074, 91.80396039484546, 122.7483365537056, -73.47659285898607, 105.50944052924447, -294.0404866556939, 32.53243166486552, 103.50527841305653, -21.947690313031515, -119.58818720472141, -36.84422776797534, -53.91488739906484, -38.51278270625888, -63.13465371346757, 19.860818068190035, -245.8828675564638, -330.97575804920314, 101.38543502325476, 32.15724484062826, 22.13502804065873, -276.7178304869532, -586.9685564086676, 31.64179387939645, -539.8845830926551, -4.216152992876616, -504.48273265991406, 19.119397235962975, -53.33831451313106, 15.227107968507745, 62.53804707780771, -8.041259382212452, -140.68672553776887, 38.984766780638495, 80.96446715432711, 55.83916758101973, -97.21407273964513, -34.353021788264186, -74.03739428371914, -655.8962937456695, -569.6188936441041, -1.6030659802349057], "policy_predator_policy_reward": [11.129270260682315, 52.87176076237948, 638.7172196755854, 283.18276329729474, 236.7737762152755, 174.56549554192392, 78.92221613005748, 277.76236324875936, 27.992707983112684, 350.30133910211583, 51.29950736896382, 106.34837187133708, 15.400799542629105, 383.5444186420964, 437.44872130741186, 32.10769241536704, 593.1567689755393, 674.3582036379856, 4.202213205843816, 298.20617085901534, 14.250052476360414, 104.4943335874339, 92.97642287885374, 106.83976010630613, 368.5422099432228, 137.38964205536797, 130.28090482561586, 93.40980546356066, 143.46414475964792, 406.5940403647363, 176.65222819749462, 663.0872908881526, 161.14056166757922, 29.078688037442063, 281.9715355110486, 223.4472094114507, 225.2968569924078, 221.27033419541905, 69.36216456086763, 68.34753824558845, 386.7703958470842, 44.136383616039836, 123.54641254472493, 140.88429392523153, 189.5320720447685, 143.2589742403718, 10.215117412973813, 37.01457235867463, 547.0591916258035, 166.75664779438426, 234.53636370728958, 150.98024624619003, 115.06593940237374, 733.26804172046, 765.9707750138557, 18.02148233763096, 330.8918283155702, 85.4250090098604, 577.2411460794856, 106.10622661069554, 323.61865995554206, 49.62046651865348, 224.698995157555, 71.95230619348507, 119.77869764806324, 86.74470188865429, 675.4420255427674, 257.8458499393456, 159.92544101983495, 124.47171925903868, 263.1864026397688, 347.0871721160616, 119.92074266465984, 90.28634604654623, 230.94332902476117, 304.41898204085567, 344.4879346363808, 3.555187758703665, 162.8331332807345, 222.75343200039845, 560.2406919378582, 637.9787070273571, 56.892644583503994, 110.88292476006278, 0.0, 259.6029199028435, 392.8262255306758, 142.1499236631471, 260.15422628810535, 14.203857774837536, 3.989354639323288, 361.75486550791794, 181.81965271924562, 136.21380672733397, 95.6382070101422, 164.73397758446134, 87.1282865895839, 495.4925354710129, 102.31442058099425, 320.9413838437349, 87.06774555139191, 39.43131853397119, 85.3645468923627, 176.8345972709546, 18.070161725932355, 253.68297194412136, 192.73270968684136, 546.1674898859284, 269.2878972002779, 384.24011156247053, 101.97276305869127, 348.97534719117874, 122.21088207493158, 154.5625985658715, 115.12877893216447, 400.92634059129904, 166.38185756891585, 369.45386254084724, 151.7287246594797, 27.258314442472088, 95.48948473954404, 254.13430389255663, 235.3754951861115, 444.8444093137306, 176.25844835321178, 106.9982941318482, 104.53124312425638, 139.17055225359107, 334.099083076739, 232.3957480241162, 139.70208674319497, 410.8158699894341, 109.77614311825407, 313.6114864341231, 67.66278041100617, 106.3011045072046, 263.1206885942246, 185.42065770728138, 29.555810566898494, 31.810494630247995, 4.275798188180444, 576.772453492547, 72.14857453723879, 123.78705248487775, 14.159818664014674, 5.452464289677579, 163.0856693433484, 283.8017638500836, 385.64333177584416, 8.005790316913442, 196.51771272246268, 494.0023997427206, 236.41181037716498, 41.6766551254642, 17.124133902938592, 107.74523314758301, 267.9386343766634, 382.0172629202069, 26.17845314644484, 66.5229814617157, 197.8649361815961, 93.25727005867572, 298.90851085259817, 112.68954413822932, 63.13143812102394, 162.59097377895105, 135.87738110145017, 146.3746195014129, 321.1659911765723, 17.580334718526665, 193.41465371346732, 12.77918193180993, 309.436009218306, 310.8032339963204, 6.048040733598827, 156.465490755597, 119.82567917581743, 383.56532750049735, 267.4036544723024, 447.5154840460114, 216.62643442498745, 423.52342575335535, 471.98437353384196, 162.76492023342186, 211.70861348325516, 15.140283978230638, 104.18972023217195, 68.97371614061804, 144.13672553776877, 130.05523321936153, 30.131633373333347, 138.9746242643517, 342.7614542546338, 103.0348905577444, 80.33076545115549, 726.9363747996322, 295.4029454000787, 453.49472434544776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5189533546476021, "mean_inference_ms": 1.28742355236353, "mean_action_processing_ms": 0.21677381182441294, "mean_env_wait_ms": 0.17356881046734196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007151834892504143, "StateBufferConnector_ms": 0.0029261666114884194, "ViewRequirementAgentConnector_ms": 0.09142389201154613}, "num_episodes": 27, "episode_return_max": 340.49999999999955, "episode_return_min": -90.72140610978988, "episode_return_mean": 136.92055769174522, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.4915044693658, "num_env_steps_trained_throughput_per_sec": 431.4915044693658, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 9499.447, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9499.41, "sample_time_ms": 1060.39, "learn_time_ms": 8426.75, "learn_throughput": 474.679, "synch_weights_time_ms": 11.551}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "74486_00000", "date": "2024-08-16_14-56-17", "timestamp": 1723800377, "time_this_iter_s": 9.273388147354126, "time_total_s": 47.51561975479126, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39732d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 47.51561975479126, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.01538461538462, "ram_util_percent": 74.36923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.86071842891514, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.452660721571988, "policy_loss": -0.007456293089004854, "vf_loss": 9.457359901307122, "vf_explained_var": 0.006458633822738809, "kl": 0.01378560383877868, "entropy": 1.5406210536679263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2109997162270167, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.36809270646837, "policy_loss": -0.010354045238937177, "vf_loss": 7.376285393275912, "vf_explained_var": 0.005077520974729427, "kl": 0.010806795450183993, "entropy": 1.5490766242698386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 340.49999999999955, "episode_reward_min": -90.72140610978988, "episode_reward_mean": 145.77292377510966, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -765.640775013856, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.00420968308657, "predator_policy": 943.7393184323976}, "policy_reward_mean": {"prey_policy": -147.98504024427297, "predator_policy": 220.8715021318277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.27062010323107, 60.209999999999816, 77.88569393165518, 100.14277387308198, 63.56999999999966, 156.42000000000002, 84.02000000000105, -2.0495470119920536, 54.3999999999999, 101.11000000000007, 179.45999999999992, 81.0577033305603, 176.69284290801855, 146.37999999999977, 237.71946676109997, 78.56000000000041, 1.5199999999999894, 107.09237593161478, 201.57938761968893, 9.029999999999976, 246.6639231361818, 161.86848452317474, 139.92243747779432, 79.53999999999998, 176.84999999999997, 12.29999999999993, 127.31685858857291, 115.15000000000042, 220.92000000000002, 21.669999999999984, 189.22888796953012, -90.72140610978988, -27.1870630741667, 257.84000000000003, 184.21999999999915, 116.88000000000011, 54.68288710718771, 121.4962927536379, 29.282168959709516, 148.21377221098447, 70.35689226005941, 191.07000000000008, 24.720657450026398, 206.9722186746495, 201.52109008857246, 248.54475996506818, 127.88682106559857, -46.034030310242116, 150.92000000000024, 139.7390999879713, 168.83999999999992, 75.72000000000001, 245.299999999999, 60.17000000000005, 235.91166435407285, 340.49999999999955, 87.25509261517665, 213.0099999999997, 172.73000000000008, 272.49, 335.1086209483923, 117.04000000000026, 307.25373155671133, 323.1550539105302, 150.09000000000017, 307.28, 125.81958563016622, 246.318655789775, 162.92000000000013, 43.38061760896048, 296.0562113530789, 248.8082042300203, 159.59237598904267, 96.04912409281148, 149.3859583433127, 188.73769091686225, 227.6602240683854, 172.48999999999984, 305.9098923730318, 314.2292502844691, 77.33345222139853, 177.67571012118748, 325.63621733367546, -60.379225839877016, -33.4873126432866, 259.55352788983265, -1.187502647933603, 260.5644930546461, 179.5399999999999, 233.1907815887239, 295.81, -65.34846604940311, -23.758677137284792, 90.31975055813652, 268.55999999999966, 302.5346468932177, 143.5456577533449, 16.261300455649348, 154.40999972266178, 231.39999999999972], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-133.51385473216607, -292.6342700871038, -166.4668569924081, -219.8903341954201, -22.176757204035884, -37.64725167076428, -377.3890264037286, 46.6250208136849, -86.38641254472485, -114.47429392523246, -157.4720720447695, -18.898974240372098, 68.87732556168169, -32.08701533333011, -380.58962823016213, -335.27575820201815, -181.73636370729017, -149.3802462461911, -14.265939402373366, -732.95804172046, -765.640775013856, 161.10851766236897, -134.92636106227684, -200.33277293259437, -573.6911460794861, 67.03661629732298, -317.60865995554246, 90.74953348134663, -146.51809408835837, 87.58625949841837, -117.1286976480624, -10.834701888654202, -675.2320255427676, -256.5358499393454, -85.21224037561753, -92.09254397164062, -434.462529823994, 25.768342687853412, -112.51074266465916, -88.6663460465459, -289.658136775229, 0.9597488457946588, 25.217239003174615, -211.39187687508422, -144.28277028988177, -101.38135751345706, -482.1906919378582, -636.4887070273576, 11.267355416495995, -2.1929247600624606, -245.0866341058506, -2.2162857969940646, -187.2958427658936, -220.3634478393579, -258.80422628810646, 99.59614222516268, 106.4414936633329, -251.26571381057434, -173.52965271924523, -122.83380672733482, -79.26901295449129, 8.125716329418061, -255.6872402384676, -417.6549879319191, -229.2055560657955, -221.2373114331027, 57.1022544486081, 74.23868146602877, 31.175453107637363, -109.1545972709546, 65.98983827406778, -220.862971944122, -150.10475682697512, -534.1125556386081, -260.4412089600575, -271.590507049054, -134.98689709743033, -286.6790441927316, 20.391171180556626, -148.95087961037626, -229.57691318719594, -216.12131407620808, -25.02185756891587, -319.7438625408479, -49.69986308819994, -104.56651856372484, -61.681011782899176, -80.97055817455254, -293.7712720839291, -184.92754232734143, -40.20844835321182, 5.496465833219723, -24.347668727967122, -91.46730558428152, -203.35950832435395, -409.1693530867433, -195.67993548957782, -203.9180212430514, 7.683856881746042, -291.3323864461521, -60.55382272492619, 55.429937806715046, -247.2356371591817, -125.58570914232547, 64.37418943310189, 119.55950536975193, -2.295798188180486, -518.5824534925471, 170.7377515633159, -130.76171423135892, 176.61131588892925, 144.27640115737873, -214.1838080837329, -145.44853249452234, -368.64333177584496, 188.00420968308657, -50.85772183772144, -466.932390627462, -142.94181037716535, 137.34334487453577, 167.77435156322468, 42.46490233464601, -152.80863437666355, -380.1072629202074, 91.80396039484546, 122.7483365537056, -73.47659285898607, 105.50944052924447, -294.0404866556939, 32.53243166486552, 103.50527841305653, -21.947690313031515, -119.58818720472141, -36.84422776797534, -53.91488739906484, -38.51278270625888, -63.13465371346757, 19.860818068190035, -245.8828675564638, -330.97575804920314, 101.38543502325476, 32.15724484062826, 22.13502804065873, -276.7178304869532, -586.9685564086676, 31.64179387939645, -539.8845830926551, -4.216152992876616, -504.48273265991406, 19.119397235962975, -53.33831451313106, 15.227107968507745, 62.53804707780771, -8.041259382212452, -140.68672553776887, 38.984766780638495, 80.96446715432711, 55.83916758101973, -97.21407273964513, -34.353021788264186, -74.03739428371914, -655.8962937456695, -569.6188936441041, -1.6030659802349057, -491.3462397820734, 69.48310325613221, -491.45354209070877, -583.2646105806672, -436.8006975618203, -231.953863450847, -624.9594630925037, -19.580601304496792, -400.86566276493005, -290.0394917148359, 51.66859710487351, -23.34555286058475, 101.26396708135616, -599.5609615274465, -55.15692599829255, 140.6996383414543, 149.95179132046928, 77.02875918621618, -275.83980937959194, -556.1796453254768, -589.4772291020945, -167.08656350361807, -216.77724883036962, -469.00771965351925, 69.55160343043083, -0.8370006397938563, 44.49238994498614, -515.2875517171734, -72.6276993443346, -66.4346081349655, -149.49501333825845, -490.270535037986, -544.9804076266067, -48.15220913070405, 103.0398991225458, -285.937421784074], "policy_predator_policy_reward": [281.9715355110486, 223.4472094114507, 225.2968569924078, 221.27033419541905, 69.36216456086763, 68.34753824558845, 386.7703958470842, 44.136383616039836, 123.54641254472493, 140.88429392523153, 189.5320720447685, 143.2589742403718, 10.215117412973813, 37.01457235867463, 547.0591916258035, 166.75664779438426, 234.53636370728958, 150.98024624619003, 115.06593940237374, 733.26804172046, 765.9707750138557, 18.02148233763096, 330.8918283155702, 85.4250090098604, 577.2411460794856, 106.10622661069554, 323.61865995554206, 49.62046651865348, 224.698995157555, 71.95230619348507, 119.77869764806324, 86.74470188865429, 675.4420255427674, 257.8458499393456, 159.92544101983495, 124.47171925903868, 263.1864026397688, 347.0871721160616, 119.92074266465984, 90.28634604654623, 230.94332902476117, 304.41898204085567, 344.4879346363808, 3.555187758703665, 162.8331332807345, 222.75343200039845, 560.2406919378582, 637.9787070273571, 56.892644583503994, 110.88292476006278, 0.0, 259.6029199028435, 392.8262255306758, 142.1499236631471, 260.15422628810535, 14.203857774837536, 3.989354639323288, 361.75486550791794, 181.81965271924562, 136.21380672733397, 95.6382070101422, 164.73397758446134, 87.1282865895839, 495.4925354710129, 102.31442058099425, 320.9413838437349, 87.06774555139191, 39.43131853397119, 85.3645468923627, 176.8345972709546, 18.070161725932355, 253.68297194412136, 192.73270968684136, 546.1674898859284, 269.2878972002779, 384.24011156247053, 101.97276305869127, 348.97534719117874, 122.21088207493158, 154.5625985658715, 115.12877893216447, 400.92634059129904, 166.38185756891585, 369.45386254084724, 151.7287246594797, 27.258314442472088, 95.48948473954404, 254.13430389255663, 235.3754951861115, 444.8444093137306, 176.25844835321178, 106.9982941318482, 104.53124312425638, 139.17055225359107, 334.099083076739, 232.3957480241162, 139.70208674319497, 410.8158699894341, 109.77614311825407, 313.6114864341231, 67.66278041100617, 106.3011045072046, 263.1206885942246, 185.42065770728138, 29.555810566898494, 31.810494630247995, 4.275798188180444, 576.772453492547, 72.14857453723879, 123.78705248487775, 14.159818664014674, 5.452464289677579, 163.0856693433484, 283.8017638500836, 385.64333177584416, 8.005790316913442, 196.51771272246268, 494.0023997427206, 236.41181037716498, 41.6766551254642, 17.124133902938592, 107.74523314758301, 267.9386343766634, 382.0172629202069, 26.17845314644484, 66.5229814617157, 197.8649361815961, 93.25727005867572, 298.90851085259817, 112.68954413822932, 63.13143812102394, 162.59097377895105, 135.87738110145017, 146.3746195014129, 321.1659911765723, 17.580334718526665, 193.41465371346732, 12.77918193180993, 309.436009218306, 310.8032339963204, 6.048040733598827, 156.465490755597, 119.82567917581743, 383.56532750049735, 267.4036544723024, 447.5154840460114, 216.62643442498745, 423.52342575335535, 471.98437353384196, 162.76492023342186, 211.70861348325516, 15.140283978230638, 104.18972023217195, 68.97371614061804, 144.13672553776877, 130.05523321936153, 30.131633373333347, 138.9746242643517, 342.7614542546338, 103.0348905577444, 80.33076545115549, 726.9363747996322, 295.4029454000787, 453.49472434544776, 291.27343431028106, 456.2259195493355, 70.59960839910038, 943.7393184323976, 426.09268209970304, 209.1745662696773, 412.4250667719278, 491.66852551490547, 492.4660855036969, 197.2515663281346, 112.52156925066734, 119.71987955968997, 40.156032918643845, 637.6809615274466, 101.9237224320896, 45.72434681347252, 8.428208679530695, 60.40124081378376, 554.9942481653233, 211.67674049034213, 7.239805611615851, 725.5653098568115, 344.4241776693937, 431.68054137263147, 113.96083787053436, 85.8845593388287, 243.46520565685887, 529.8646030085463, 117.09848450905045, 165.50948072359486, 95.54153310758973, 560.4853157243043, 554.3995028694173, 193.14311361055482, 263.49850340202926, 150.7990192594992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5140144739806525, "mean_inference_ms": 1.277071565819487, "mean_action_processing_ms": 0.2145457242533439, "mean_env_wait_ms": 0.1715632241754709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005207657814025879, "StateBufferConnector_ms": 0.002855062484741211, "ViewRequirementAgentConnector_ms": 0.08895003795623779}, "num_episodes": 18, "episode_return_max": 340.49999999999955, "episode_return_min": -90.72140610978988, "episode_return_mean": 145.77292377510966, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.94855094899754, "num_env_steps_trained_throughput_per_sec": 420.94855094899754, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9499.932, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9499.895, "sample_time_ms": 1047.304, "learn_time_ms": 8440.424, "learn_throughput": 473.91, "synch_weights_time_ms": 11.456}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "74486_00000", "date": "2024-08-16_14-56-27", "timestamp": 1723800387, "time_this_iter_s": 9.50541067123413, "time_total_s": 57.02103042602539, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39732daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.02103042602539, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.63571428571429, "ram_util_percent": 74.56428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1050637706246955, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.400500414106581, "policy_loss": -0.006195854369757904, "vf_loss": 9.404400161965183, "vf_explained_var": 0.008274927782633949, "kl": 0.011480591277027786, "entropy": 1.5413039978219087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2658857999339936, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.800456407839659, "policy_loss": -0.015612059227121925, "vf_loss": 7.812481171239621, "vf_explained_var": 0.00106049482784574, "kl": 0.01793655456550244, "entropy": 1.5251969661662188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 378.05279843844966, "episode_reward_min": -90.72140610978988, "episode_reward_mean": 154.0153726643871, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -844.9750570296943, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.00420968308657, "predator_policy": 943.7393184323976}, "policy_reward_mean": {"prey_policy": -163.13648360953562, "predator_policy": 240.14416994172907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201.57938761968893, 9.029999999999976, 246.6639231361818, 161.86848452317474, 139.92243747779432, 79.53999999999998, 176.84999999999997, 12.29999999999993, 127.31685858857291, 115.15000000000042, 220.92000000000002, 21.669999999999984, 189.22888796953012, -90.72140610978988, -27.1870630741667, 257.84000000000003, 184.21999999999915, 116.88000000000011, 54.68288710718771, 121.4962927536379, 29.282168959709516, 148.21377221098447, 70.35689226005941, 191.07000000000008, 24.720657450026398, 206.9722186746495, 201.52109008857246, 248.54475996506818, 127.88682106559857, -46.034030310242116, 150.92000000000024, 139.7390999879713, 168.83999999999992, 75.72000000000001, 245.299999999999, 60.17000000000005, 235.91166435407285, 340.49999999999955, 87.25509261517665, 213.0099999999997, 172.73000000000008, 272.49, 335.1086209483923, 117.04000000000026, 307.25373155671133, 323.1550539105302, 150.09000000000017, 307.28, 125.81958563016622, 246.318655789775, 162.92000000000013, 43.38061760896048, 296.0562113530789, 248.8082042300203, 159.59237598904267, 96.04912409281148, 149.3859583433127, 188.73769091686225, 227.6602240683854, 172.48999999999984, 305.9098923730318, 314.2292502844691, 77.33345222139853, 177.67571012118748, 325.63621733367546, -60.379225839877016, -33.4873126432866, 259.55352788983265, -1.187502647933603, 260.5644930546461, 179.5399999999999, 233.1907815887239, 295.81, -65.34846604940311, -23.758677137284792, 90.31975055813652, 268.55999999999966, 302.5346468932177, 143.5456577533449, 16.261300455649348, 154.40999972266178, 231.39999999999972, 176.3967495178304, 95.29525495436478, 321.32999999999987, 181.30353611319148, 217.11147121635653, 100.03116805577342, 70.53292915718716, 356.1422198581924, 71.14949001893567, 110.28033000059092, -87.66833641394754, -7.8678831905851006, 18.08583352639066, 155.5791680840763, 58.56010412254191, 378.05279843844966, 86.67050841949849, 306.7214768761666], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-434.462529823994, 25.768342687853412, -112.51074266465916, -88.6663460465459, -289.658136775229, 0.9597488457946588, 25.217239003174615, -211.39187687508422, -144.28277028988177, -101.38135751345706, -482.1906919378582, -636.4887070273576, 11.267355416495995, -2.1929247600624606, -245.0866341058506, -2.2162857969940646, -187.2958427658936, -220.3634478393579, -258.80422628810646, 99.59614222516268, 106.4414936633329, -251.26571381057434, -173.52965271924523, -122.83380672733482, -79.26901295449129, 8.125716329418061, -255.6872402384676, -417.6549879319191, -229.2055560657955, -221.2373114331027, 57.1022544486081, 74.23868146602877, 31.175453107637363, -109.1545972709546, 65.98983827406778, -220.862971944122, -150.10475682697512, -534.1125556386081, -260.4412089600575, -271.590507049054, -134.98689709743033, -286.6790441927316, 20.391171180556626, -148.95087961037626, -229.57691318719594, -216.12131407620808, -25.02185756891587, -319.7438625408479, -49.69986308819994, -104.56651856372484, -61.681011782899176, -80.97055817455254, -293.7712720839291, -184.92754232734143, -40.20844835321182, 5.496465833219723, -24.347668727967122, -91.46730558428152, -203.35950832435395, -409.1693530867433, -195.67993548957782, -203.9180212430514, 7.683856881746042, -291.3323864461521, -60.55382272492619, 55.429937806715046, -247.2356371591817, -125.58570914232547, 64.37418943310189, 119.55950536975193, -2.295798188180486, -518.5824534925471, 170.7377515633159, -130.76171423135892, 176.61131588892925, 144.27640115737873, -214.1838080837329, -145.44853249452234, -368.64333177584496, 188.00420968308657, -50.85772183772144, -466.932390627462, -142.94181037716535, 137.34334487453577, 167.77435156322468, 42.46490233464601, -152.80863437666355, -380.1072629202074, 91.80396039484546, 122.7483365537056, -73.47659285898607, 105.50944052924447, -294.0404866556939, 32.53243166486552, 103.50527841305653, -21.947690313031515, -119.58818720472141, -36.84422776797534, -53.91488739906484, -38.51278270625888, -63.13465371346757, 19.860818068190035, -245.8828675564638, -330.97575804920314, 101.38543502325476, 32.15724484062826, 22.13502804065873, -276.7178304869532, -586.9685564086676, 31.64179387939645, -539.8845830926551, -4.216152992876616, -504.48273265991406, 19.119397235962975, -53.33831451313106, 15.227107968507745, 62.53804707780771, -8.041259382212452, -140.68672553776887, 38.984766780638495, 80.96446715432711, 55.83916758101973, -97.21407273964513, -34.353021788264186, -74.03739428371914, -655.8962937456695, -569.6188936441041, -1.6030659802349057, -491.3462397820734, 69.48310325613221, -491.45354209070877, -583.2646105806672, -436.8006975618203, -231.953863450847, -624.9594630925037, -19.580601304496792, -400.86566276493005, -290.0394917148359, 51.66859710487351, -23.34555286058475, 101.26396708135616, -599.5609615274465, -55.15692599829255, 140.6996383414543, 149.95179132046928, 77.02875918621618, -275.83980937959194, -556.1796453254768, -589.4772291020945, -167.08656350361807, -216.77724883036962, -469.00771965351925, 69.55160343043083, -0.8370006397938563, 44.49238994498614, -515.2875517171734, -72.6276993443346, -66.4346081349655, -149.49501333825845, -490.270535037986, -544.9804076266067, -48.15220913070405, 103.0398991225458, -285.937421784074, -324.0786577029981, -308.79000836992543, -355.412799074468, -470.0747565294903, 50.01204726699878, 123.54362892763311, -193.9028381458454, -11.423369419808388, -212.14688740795492, 56.662633697939924, -809.9313265611004, -57.66076695754035, -202.6020382349703, -166.6646079990707, -817.1013297580815, -283.850548218083, -403.7552829557735, -53.2459760694819, -844.9750570296943, -286.7968196572217, -491.85630562378424, -330.00761173305875, -284.22855278419286, -305.1744909830074, -347.6436310121959, -373.17792382730397, 14.634884933084543, -346.21876107419075, -265.9403981275418, -168.73667717674397, -71.85865538957688, -431.2870649064133, -236.30561620705978, -280.94873073507557, 20.805048827237613, 132.83688090030023], "policy_predator_policy_reward": [263.1864026397688, 347.0871721160616, 119.92074266465984, 90.28634604654623, 230.94332902476117, 304.41898204085567, 344.4879346363808, 3.555187758703665, 162.8331332807345, 222.75343200039845, 560.2406919378582, 637.9787070273571, 56.892644583503994, 110.88292476006278, 0.0, 259.6029199028435, 392.8262255306758, 142.1499236631471, 260.15422628810535, 14.203857774837536, 3.989354639323288, 361.75486550791794, 181.81965271924562, 136.21380672733397, 95.6382070101422, 164.73397758446134, 87.1282865895839, 495.4925354710129, 102.31442058099425, 320.9413838437349, 87.06774555139191, 39.43131853397119, 85.3645468923627, 176.8345972709546, 18.070161725932355, 253.68297194412136, 192.73270968684136, 546.1674898859284, 269.2878972002779, 384.24011156247053, 101.97276305869127, 348.97534719117874, 122.21088207493158, 154.5625985658715, 115.12877893216447, 400.92634059129904, 166.38185756891585, 369.45386254084724, 151.7287246594797, 27.258314442472088, 95.48948473954404, 254.13430389255663, 235.3754951861115, 444.8444093137306, 176.25844835321178, 106.9982941318482, 104.53124312425638, 139.17055225359107, 334.099083076739, 232.3957480241162, 139.70208674319497, 410.8158699894341, 109.77614311825407, 313.6114864341231, 67.66278041100617, 106.3011045072046, 263.1206885942246, 185.42065770728138, 29.555810566898494, 31.810494630247995, 4.275798188180444, 576.772453492547, 72.14857453723879, 123.78705248487775, 14.159818664014674, 5.452464289677579, 163.0856693433484, 283.8017638500836, 385.64333177584416, 8.005790316913442, 196.51771272246268, 494.0023997427206, 236.41181037716498, 41.6766551254642, 17.124133902938592, 107.74523314758301, 267.9386343766634, 382.0172629202069, 26.17845314644484, 66.5229814617157, 197.8649361815961, 93.25727005867572, 298.90851085259817, 112.68954413822932, 63.13143812102394, 162.59097377895105, 135.87738110145017, 146.3746195014129, 321.1659911765723, 17.580334718526665, 193.41465371346732, 12.77918193180993, 309.436009218306, 310.8032339963204, 6.048040733598827, 156.465490755597, 119.82567917581743, 383.56532750049735, 267.4036544723024, 447.5154840460114, 216.62643442498745, 423.52342575335535, 471.98437353384196, 162.76492023342186, 211.70861348325516, 15.140283978230638, 104.18972023217195, 68.97371614061804, 144.13672553776877, 130.05523321936153, 30.131633373333347, 138.9746242643517, 342.7614542546338, 103.0348905577444, 80.33076545115549, 726.9363747996322, 295.4029454000787, 453.49472434544776, 291.27343431028106, 456.2259195493355, 70.59960839910038, 943.7393184323976, 426.09268209970304, 209.1745662696773, 412.4250667719278, 491.66852551490547, 492.4660855036969, 197.2515663281346, 112.52156925066734, 119.71987955968997, 40.156032918643845, 637.6809615274466, 101.9237224320896, 45.72434681347252, 8.428208679530695, 60.40124081378376, 554.9942481653233, 211.67674049034213, 7.239805611615851, 725.5653098568115, 344.4241776693937, 431.68054137263147, 113.96083787053436, 85.8845593388287, 243.46520565685887, 529.8646030085463, 117.09848450905045, 165.50948072359486, 95.54153310758973, 560.4853157243043, 554.3995028694173, 193.14311361055482, 263.49850340202926, 150.7990192594992, 569.2058651771566, 240.0595504135978, 445.8011898523981, 474.9816207059245, 126.65296301181031, 21.121360793557827, 43.999916020372254, 342.6298276584733, 148.08611356550918, 224.50961136086298, 606.9411952583213, 360.68206631609326, 207.67885601644653, 232.12071937478154, 691.3859848449194, 765.708112989438, 279.1438015989615, 249.00694744522986, 532.058676732671, 709.9935299548358, 338.7644039735553, 395.43117696934, 3.726523772816362, 577.8086368037992, 521.0504359754369, 217.85695239045387, 92.12572586540031, 395.03731835978215, 167.82610367911988, 325.41107574770746, 519.6152572969329, 361.5832614375069, 528.4546541554946, 75.47020120613811, 125.59076892047386, 27.48877822815499]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5098642808395881, "mean_inference_ms": 1.2744296121094931, "mean_action_processing_ms": 0.21337330997671075, "mean_env_wait_ms": 0.17090056695951752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046738386154174805, "StateBufferConnector_ms": 0.0028237104415893555, "ViewRequirementAgentConnector_ms": 0.08728349208831787}, "num_episodes": 18, "episode_return_max": 378.05279843844966, "episode_return_min": -90.72140610978988, "episode_return_mean": 154.0153726643871, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.6436012691387, "num_env_steps_trained_throughput_per_sec": 428.6436012691387, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9475.908, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9475.873, "sample_time_ms": 1040.988, "learn_time_ms": 8422.634, "learn_throughput": 474.911, "synch_weights_time_ms": 11.522}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "74486_00000", "date": "2024-08-16_14-56-36", "timestamp": 1723800396, "time_this_iter_s": 9.335421800613403, "time_total_s": 66.3564522266388, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39734f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.3564522266388, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.176923076923075, "ram_util_percent": 74.49230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2548957260197433, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.608523878723226, "policy_loss": -0.00958089114452599, "vf_loss": 8.615723379326877, "vf_explained_var": -0.02976116310982477, "kl": 0.01190700558141136, "entropy": 1.5344797857223995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3369881753568296, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.375042821490576, "policy_loss": -0.012166828177770768, "vf_loss": 7.384699692801823, "vf_explained_var": 0.0032084618611310524, "kl": 0.012549761501746838, "entropy": 1.5286867988172663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 378.05279843844966, "episode_reward_min": -127.40415677298584, "episode_reward_mean": 150.54109101976516, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -844.9750570296943, "predator_policy": 3.726523772816362}, "policy_reward_max": {"prey_policy": 188.00420968308657, "predator_policy": 943.7393184323976}, "policy_reward_mean": {"prey_policy": -193.6892246206046, "predator_policy": 268.95977013048713}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.68288710718771, 121.4962927536379, 29.282168959709516, 148.21377221098447, 70.35689226005941, 191.07000000000008, 24.720657450026398, 206.9722186746495, 201.52109008857246, 248.54475996506818, 127.88682106559857, -46.034030310242116, 150.92000000000024, 139.7390999879713, 168.83999999999992, 75.72000000000001, 245.299999999999, 60.17000000000005, 235.91166435407285, 340.49999999999955, 87.25509261517665, 213.0099999999997, 172.73000000000008, 272.49, 335.1086209483923, 117.04000000000026, 307.25373155671133, 323.1550539105302, 150.09000000000017, 307.28, 125.81958563016622, 246.318655789775, 162.92000000000013, 43.38061760896048, 296.0562113530789, 248.8082042300203, 159.59237598904267, 96.04912409281148, 149.3859583433127, 188.73769091686225, 227.6602240683854, 172.48999999999984, 305.9098923730318, 314.2292502844691, 77.33345222139853, 177.67571012118748, 325.63621733367546, -60.379225839877016, -33.4873126432866, 259.55352788983265, -1.187502647933603, 260.5644930546461, 179.5399999999999, 233.1907815887239, 295.81, -65.34846604940311, -23.758677137284792, 90.31975055813652, 268.55999999999966, 302.5346468932177, 143.5456577533449, 16.261300455649348, 154.40999972266178, 231.39999999999972, 176.3967495178304, 95.29525495436478, 321.32999999999987, 181.30353611319148, 217.11147121635653, 100.03116805577342, 70.53292915718716, 356.1422198581924, 71.14949001893567, 110.28033000059092, -87.66833641394754, -7.8678831905851006, 18.08583352639066, 155.5791680840763, 58.56010412254191, 378.05279843844966, 86.67050841949849, 306.7214768761666, 125.18307444482828, 70.32880138602405, 207.7882356671744, 83.24000000000034, 172.04446319494704, 192.55011448327684, -3.8935063428076013, 89.13880047498867, 96.50573745923263, 123.25368844640892, 57.59481109938689, 67.70251463049276, 172.66214277219774, -127.40415677298584, 209.16077194742869, -9.925069892100277, 40.78780093563139, 228.92512173466636], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-150.10475682697512, -534.1125556386081, -260.4412089600575, -271.590507049054, -134.98689709743033, -286.6790441927316, 20.391171180556626, -148.95087961037626, -229.57691318719594, -216.12131407620808, -25.02185756891587, -319.7438625408479, -49.69986308819994, -104.56651856372484, -61.681011782899176, -80.97055817455254, -293.7712720839291, -184.92754232734143, -40.20844835321182, 5.496465833219723, -24.347668727967122, -91.46730558428152, -203.35950832435395, -409.1693530867433, -195.67993548957782, -203.9180212430514, 7.683856881746042, -291.3323864461521, -60.55382272492619, 55.429937806715046, -247.2356371591817, -125.58570914232547, 64.37418943310189, 119.55950536975193, -2.295798188180486, -518.5824534925471, 170.7377515633159, -130.76171423135892, 176.61131588892925, 144.27640115737873, -214.1838080837329, -145.44853249452234, -368.64333177584496, 188.00420968308657, -50.85772183772144, -466.932390627462, -142.94181037716535, 137.34334487453577, 167.77435156322468, 42.46490233464601, -152.80863437666355, -380.1072629202074, 91.80396039484546, 122.7483365537056, -73.47659285898607, 105.50944052924447, -294.0404866556939, 32.53243166486552, 103.50527841305653, -21.947690313031515, -119.58818720472141, -36.84422776797534, -53.91488739906484, -38.51278270625888, -63.13465371346757, 19.860818068190035, -245.8828675564638, -330.97575804920314, 101.38543502325476, 32.15724484062826, 22.13502804065873, -276.7178304869532, -586.9685564086676, 31.64179387939645, -539.8845830926551, -4.216152992876616, -504.48273265991406, 19.119397235962975, -53.33831451313106, 15.227107968507745, 62.53804707780771, -8.041259382212452, -140.68672553776887, 38.984766780638495, 80.96446715432711, 55.83916758101973, -97.21407273964513, -34.353021788264186, -74.03739428371914, -655.8962937456695, -569.6188936441041, -1.6030659802349057, -491.3462397820734, 69.48310325613221, -491.45354209070877, -583.2646105806672, -436.8006975618203, -231.953863450847, -624.9594630925037, -19.580601304496792, -400.86566276493005, -290.0394917148359, 51.66859710487351, -23.34555286058475, 101.26396708135616, -599.5609615274465, -55.15692599829255, 140.6996383414543, 149.95179132046928, 77.02875918621618, -275.83980937959194, -556.1796453254768, -589.4772291020945, -167.08656350361807, -216.77724883036962, -469.00771965351925, 69.55160343043083, -0.8370006397938563, 44.49238994498614, -515.2875517171734, -72.6276993443346, -66.4346081349655, -149.49501333825845, -490.270535037986, -544.9804076266067, -48.15220913070405, 103.0398991225458, -285.937421784074, -324.0786577029981, -308.79000836992543, -355.412799074468, -470.0747565294903, 50.01204726699878, 123.54362892763311, -193.9028381458454, -11.423369419808388, -212.14688740795492, 56.662633697939924, -809.9313265611004, -57.66076695754035, -202.6020382349703, -166.6646079990707, -817.1013297580815, -283.850548218083, -403.7552829557735, -53.2459760694819, -844.9750570296943, -286.7968196572217, -491.85630562378424, -330.00761173305875, -284.22855278419286, -305.1744909830074, -347.6436310121959, -373.17792382730397, 14.634884933084543, -346.21876107419075, -265.9403981275418, -168.73667717674397, -71.85865538957688, -431.2870649064133, -236.30561620705978, -280.94873073507557, 20.805048827237613, 132.83688090030023, -522.5446475329488, -85.54224437130644, -576.3680423928083, -408.24126510028844, -204.3317094442907, -82.3577300531527, -117.59790433778502, -70.92002048055609, -466.0147764950621, -309.3080846199579, -26.82615513073993, -13.980220953735193, -726.1128666701898, -423.48055682166756, -566.1015817663496, -778.8964034950491, -238.19765648405053, -262.06180395724374, -367.2174084632718, -288.66143974601715, -445.970041913157, -437.20229090786233, -80.71563050088356, -181.60482201175233, 15.513758812222791, -536.5612391532253, -471.7855908232598, -482.5701336371117, -224.51460774991392, -88.33632813257995, -110.69154726109765, -419.65797373758465, -314.2730046191759, -296.7056694990934, -24.555645923657018, -467.96602297796085], "policy_predator_policy_reward": [192.73270968684136, 546.1674898859284, 269.2878972002779, 384.24011156247053, 101.97276305869127, 348.97534719117874, 122.21088207493158, 154.5625985658715, 115.12877893216447, 400.92634059129904, 166.38185756891585, 369.45386254084724, 151.7287246594797, 27.258314442472088, 95.48948473954404, 254.13430389255663, 235.3754951861115, 444.8444093137306, 176.25844835321178, 106.9982941318482, 104.53124312425638, 139.17055225359107, 334.099083076739, 232.3957480241162, 139.70208674319497, 410.8158699894341, 109.77614311825407, 313.6114864341231, 67.66278041100617, 106.3011045072046, 263.1206885942246, 185.42065770728138, 29.555810566898494, 31.810494630247995, 4.275798188180444, 576.772453492547, 72.14857453723879, 123.78705248487775, 14.159818664014674, 5.452464289677579, 163.0856693433484, 283.8017638500836, 385.64333177584416, 8.005790316913442, 196.51771272246268, 494.0023997427206, 236.41181037716498, 41.6766551254642, 17.124133902938592, 107.74523314758301, 267.9386343766634, 382.0172629202069, 26.17845314644484, 66.5229814617157, 197.8649361815961, 93.25727005867572, 298.90851085259817, 112.68954413822932, 63.13143812102394, 162.59097377895105, 135.87738110145017, 146.3746195014129, 321.1659911765723, 17.580334718526665, 193.41465371346732, 12.77918193180993, 309.436009218306, 310.8032339963204, 6.048040733598827, 156.465490755597, 119.82567917581743, 383.56532750049735, 267.4036544723024, 447.5154840460114, 216.62643442498745, 423.52342575335535, 471.98437353384196, 162.76492023342186, 211.70861348325516, 15.140283978230638, 104.18972023217195, 68.97371614061804, 144.13672553776877, 130.05523321936153, 30.131633373333347, 138.9746242643517, 342.7614542546338, 103.0348905577444, 80.33076545115549, 726.9363747996322, 295.4029454000787, 453.49472434544776, 291.27343431028106, 456.2259195493355, 70.59960839910038, 943.7393184323976, 426.09268209970304, 209.1745662696773, 412.4250667719278, 491.66852551490547, 492.4660855036969, 197.2515663281346, 112.52156925066734, 119.71987955968997, 40.156032918643845, 637.6809615274466, 101.9237224320896, 45.72434681347252, 8.428208679530695, 60.40124081378376, 554.9942481653233, 211.67674049034213, 7.239805611615851, 725.5653098568115, 344.4241776693937, 431.68054137263147, 113.96083787053436, 85.8845593388287, 243.46520565685887, 529.8646030085463, 117.09848450905045, 165.50948072359486, 95.54153310758973, 560.4853157243043, 554.3995028694173, 193.14311361055482, 263.49850340202926, 150.7990192594992, 569.2058651771566, 240.0595504135978, 445.8011898523981, 474.9816207059245, 126.65296301181031, 21.121360793557827, 43.999916020372254, 342.6298276584733, 148.08611356550918, 224.50961136086298, 606.9411952583213, 360.68206631609326, 207.67885601644653, 232.12071937478154, 691.3859848449194, 765.708112989438, 279.1438015989615, 249.00694744522986, 532.058676732671, 709.9935299548358, 338.7644039735553, 395.43117696934, 3.726523772816362, 577.8086368037992, 521.0504359754369, 217.85695239045387, 92.12572586540031, 395.03731835978215, 167.82610367911988, 325.41107574770746, 519.6152572969329, 361.5832614375069, 528.4546541554946, 75.47020120613811, 125.59076892047386, 27.48877822815499, 537.4530527211434, 195.81691362794035, 539.7702922613106, 515.1678166178091, 245.2332907193559, 249.2443844452621, 3.848013281136702, 267.9099115372053, 245.86958665221323, 701.4977376577535, 71.20052884302507, 162.1559617247279, 632.8845581449042, 512.8153590041456, 667.8650642697755, 766.2717214666121, 348.7288726765961, 248.03632522392957, 309.0698637692397, 470.06267288645853, 393.60694945154756, 547.1601944688589, 44.22890610533628, 285.7940610377923, 185.85155358569241, 507.85806952750806, 238.39589347420502, 588.5556742131809, 159.01025414001114, 363.0014536899113, 452.21769198821875, 68.20675911836351, 420.7333553151787, 231.03311973872198, 428.83634250052745, 292.6104481357572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5062492149063951, "mean_inference_ms": 1.2722266221262541, "mean_action_processing_ms": 0.21240188042667726, "mean_env_wait_ms": 0.17026056562338582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042656660079956055, "StateBufferConnector_ms": 0.0028235912322998047, "ViewRequirementAgentConnector_ms": 0.08072400093078613}, "num_episodes": 18, "episode_return_max": 378.05279843844966, "episode_return_min": -127.40415677298584, "episode_return_mean": 150.54109101976516, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.84605927382563, "num_env_steps_trained_throughput_per_sec": 421.84605927382563, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 9476.687, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9476.653, "sample_time_ms": 1036.016, "learn_time_ms": 8428.28, "learn_throughput": 474.593, "synch_weights_time_ms": 11.629}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "74486_00000", "date": "2024-08-16_14-56-46", "timestamp": 1723800406, "time_this_iter_s": 9.485352993011475, "time_total_s": 75.84180521965027, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39732d820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.84180521965027, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.799999999999997, "ram_util_percent": 74.55384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8946850636333386, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.84026284722424, "policy_loss": -0.007406717872187969, "vf_loss": 7.845293790575058, "vf_explained_var": -0.07502857900801159, "kl": 0.011878880547919093, "entropy": 1.5257870554293274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3997199012173547, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8452606133052285, "policy_loss": -0.012997627910041797, "vf_loss": 7.855191614514306, "vf_explained_var": 0.0048658851277891295, "kl": 0.01533312659948146, "entropy": 1.5106660427870573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 378.05279843844966, "episode_reward_min": -135.6431380118239, "episode_reward_mean": 138.20592180826318, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -844.9750570296943, "predator_policy": 3.360087547396603}, "policy_reward_max": {"prey_policy": 167.77435156322468, "predator_policy": 943.7393184323976}, "policy_reward_mean": {"prey_policy": -225.00239146061722, "predator_policy": 294.10535236474874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.73000000000008, 272.49, 335.1086209483923, 117.04000000000026, 307.25373155671133, 323.1550539105302, 150.09000000000017, 307.28, 125.81958563016622, 246.318655789775, 162.92000000000013, 43.38061760896048, 296.0562113530789, 248.8082042300203, 159.59237598904267, 96.04912409281148, 149.3859583433127, 188.73769091686225, 227.6602240683854, 172.48999999999984, 305.9098923730318, 314.2292502844691, 77.33345222139853, 177.67571012118748, 325.63621733367546, -60.379225839877016, -33.4873126432866, 259.55352788983265, -1.187502647933603, 260.5644930546461, 179.5399999999999, 233.1907815887239, 295.81, -65.34846604940311, -23.758677137284792, 90.31975055813652, 268.55999999999966, 302.5346468932177, 143.5456577533449, 16.261300455649348, 154.40999972266178, 231.39999999999972, 176.3967495178304, 95.29525495436478, 321.32999999999987, 181.30353611319148, 217.11147121635653, 100.03116805577342, 70.53292915718716, 356.1422198581924, 71.14949001893567, 110.28033000059092, -87.66833641394754, -7.8678831905851006, 18.08583352639066, 155.5791680840763, 58.56010412254191, 378.05279843844966, 86.67050841949849, 306.7214768761666, 125.18307444482828, 70.32880138602405, 207.7882356671744, 83.24000000000034, 172.04446319494704, 192.55011448327684, -3.8935063428076013, 89.13880047498867, 96.50573745923263, 123.25368844640892, 57.59481109938689, 67.70251463049276, 172.66214277219774, -127.40415677298584, 209.16077194742869, -9.925069892100277, 40.78780093563139, 228.92512173466636, 87.0087701396441, 69.87000000000022, -123.48528435958309, 85.58000000000074, -135.6431380118239, 130.9743705556892, 188.5256382039012, 44.20475090993636, 24.503721664693003, 136.3971690331685, -6.777484450408381, 219.74889765985057, 84.92869438860097, 120.19166105002658, 96.92218691289158, 3.629999999999963, 216.28306670271866, 263.03625394989234, 25.03586757145019, 60.794259651988185, 217.72225538093736, 53.11080907869933], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-50.85772183772144, -466.932390627462, -142.94181037716535, 137.34334487453577, 167.77435156322468, 42.46490233464601, -152.80863437666355, -380.1072629202074, 91.80396039484546, 122.7483365537056, -73.47659285898607, 105.50944052924447, -294.0404866556939, 32.53243166486552, 103.50527841305653, -21.947690313031515, -119.58818720472141, -36.84422776797534, -53.91488739906484, -38.51278270625888, -63.13465371346757, 19.860818068190035, -245.8828675564638, -330.97575804920314, 101.38543502325476, 32.15724484062826, 22.13502804065873, -276.7178304869532, -586.9685564086676, 31.64179387939645, -539.8845830926551, -4.216152992876616, -504.48273265991406, 19.119397235962975, -53.33831451313106, 15.227107968507745, 62.53804707780771, -8.041259382212452, -140.68672553776887, 38.984766780638495, 80.96446715432711, 55.83916758101973, -97.21407273964513, -34.353021788264186, -74.03739428371914, -655.8962937456695, -569.6188936441041, -1.6030659802349057, -491.3462397820734, 69.48310325613221, -491.45354209070877, -583.2646105806672, -436.8006975618203, -231.953863450847, -624.9594630925037, -19.580601304496792, -400.86566276493005, -290.0394917148359, 51.66859710487351, -23.34555286058475, 101.26396708135616, -599.5609615274465, -55.15692599829255, 140.6996383414543, 149.95179132046928, 77.02875918621618, -275.83980937959194, -556.1796453254768, -589.4772291020945, -167.08656350361807, -216.77724883036962, -469.00771965351925, 69.55160343043083, -0.8370006397938563, 44.49238994498614, -515.2875517171734, -72.6276993443346, -66.4346081349655, -149.49501333825845, -490.270535037986, -544.9804076266067, -48.15220913070405, 103.0398991225458, -285.937421784074, -324.0786577029981, -308.79000836992543, -355.412799074468, -470.0747565294903, 50.01204726699878, 123.54362892763311, -193.9028381458454, -11.423369419808388, -212.14688740795492, 56.662633697939924, -809.9313265611004, -57.66076695754035, -202.6020382349703, -166.6646079990707, -817.1013297580815, -283.850548218083, -403.7552829557735, -53.2459760694819, -844.9750570296943, -286.7968196572217, -491.85630562378424, -330.00761173305875, -284.22855278419286, -305.1744909830074, -347.6436310121959, -373.17792382730397, 14.634884933084543, -346.21876107419075, -265.9403981275418, -168.73667717674397, -71.85865538957688, -431.2870649064133, -236.30561620705978, -280.94873073507557, 20.805048827237613, 132.83688090030023, -522.5446475329488, -85.54224437130644, -576.3680423928083, -408.24126510028844, -204.3317094442907, -82.3577300531527, -117.59790433778502, -70.92002048055609, -466.0147764950621, -309.3080846199579, -26.82615513073993, -13.980220953735193, -726.1128666701898, -423.48055682166756, -566.1015817663496, -778.8964034950491, -238.19765648405053, -262.06180395724374, -367.2174084632718, -288.66143974601715, -445.970041913157, -437.20229090786233, -80.71563050088356, -181.60482201175233, 15.513758812222791, -536.5612391532253, -471.7855908232598, -482.5701336371117, -224.51460774991392, -88.33632813257995, -110.69154726109765, -419.65797373758465, -314.2730046191759, -296.7056694990934, -24.555645923657018, -467.96602297796085, -99.78200951966994, -107.25630218193744, -253.5179580205561, -194.70669613915447, -495.88124435305383, -364.64949290814235, -8.460181561263344, -70.16839862582526, -380.7111394146453, -348.3184385150093, -298.4331425978597, -598.6739271466639, -136.73614767540542, -221.03100178058338, -576.2093400588734, -395.058600471597, -120.8733709278005, -314.3973249509959, -122.86816809222731, -596.1737118715478, -653.2234580114907, -438.79591129841526, -396.0996598455621, -531.6085148527497, -427.52665499235883, -25.88059776607678, -373.99552798084983, 2.7385831967208216, -263.7124405426147, -158.41443396514745, -87.29154421723828, -42.474157225642514, 72.46025112458528, 29.707601159791636, 0.17596143109821044, -638.0472216687147, -162.47411864935347, -612.8755024642953, -388.54679720106043, -255.6766318717207, -21.69439237717201, -533.7452064819317, -11.631048354196334, -313.25054085452103], "policy_predator_policy_reward": [196.51771272246268, 494.0023997427206, 236.41181037716498, 41.6766551254642, 17.124133902938592, 107.74523314758301, 267.9386343766634, 382.0172629202069, 26.17845314644484, 66.5229814617157, 197.8649361815961, 93.25727005867572, 298.90851085259817, 112.68954413822932, 63.13143812102394, 162.59097377895105, 135.87738110145017, 146.3746195014129, 321.1659911765723, 17.580334718526665, 193.41465371346732, 12.77918193180993, 309.436009218306, 310.8032339963204, 6.048040733598827, 156.465490755597, 119.82567917581743, 383.56532750049735, 267.4036544723024, 447.5154840460114, 216.62643442498745, 423.52342575335535, 471.98437353384196, 162.76492023342186, 211.70861348325516, 15.140283978230638, 104.18972023217195, 68.97371614061804, 144.13672553776877, 130.05523321936153, 30.131633373333347, 138.9746242643517, 342.7614542546338, 103.0348905577444, 80.33076545115549, 726.9363747996322, 295.4029454000787, 453.49472434544776, 291.27343431028106, 456.2259195493355, 70.59960839910038, 943.7393184323976, 426.09268209970304, 209.1745662696773, 412.4250667719278, 491.66852551490547, 492.4660855036969, 197.2515663281346, 112.52156925066734, 119.71987955968997, 40.156032918643845, 637.6809615274466, 101.9237224320896, 45.72434681347252, 8.428208679530695, 60.40124081378376, 554.9942481653233, 211.67674049034213, 7.239805611615851, 725.5653098568115, 344.4241776693937, 431.68054137263147, 113.96083787053436, 85.8845593388287, 243.46520565685887, 529.8646030085463, 117.09848450905045, 165.50948072359486, 95.54153310758973, 560.4853157243043, 554.3995028694173, 193.14311361055482, 263.49850340202926, 150.7990192594992, 569.2058651771566, 240.0595504135978, 445.8011898523981, 474.9816207059245, 126.65296301181031, 21.121360793557827, 43.999916020372254, 342.6298276584733, 148.08611356550918, 224.50961136086298, 606.9411952583213, 360.68206631609326, 207.67885601644653, 232.12071937478154, 691.3859848449194, 765.708112989438, 279.1438015989615, 249.00694744522986, 532.058676732671, 709.9935299548358, 338.7644039735553, 395.43117696934, 3.726523772816362, 577.8086368037992, 521.0504359754369, 217.85695239045387, 92.12572586540031, 395.03731835978215, 167.82610367911988, 325.41107574770746, 519.6152572969329, 361.5832614375069, 528.4546541554946, 75.47020120613811, 125.59076892047386, 27.48877822815499, 537.4530527211434, 195.81691362794035, 539.7702922613106, 515.1678166178091, 245.2332907193559, 249.2443844452621, 3.848013281136702, 267.9099115372053, 245.86958665221323, 701.4977376577535, 71.20052884302507, 162.1559617247279, 632.8845581449042, 512.8153590041456, 667.8650642697755, 766.2717214666121, 348.7288726765961, 248.03632522392957, 309.0698637692397, 470.06267288645853, 393.60694945154756, 547.1601944688589, 44.22890610533628, 285.7940610377923, 185.85155358569241, 507.85806952750806, 238.39589347420502, 588.5556742131809, 159.01025414001114, 363.0014536899113, 452.21769198821875, 68.20675911836351, 420.7333553151787, 231.03311973872198, 428.83634250052745, 292.6104481357572, 147.91033568772684, 146.13674615352497, 113.32096301797742, 404.77369114173143, 66.61483156368192, 670.4306213379316, 12.077927705338183, 152.13065248175124, 3.360087547396603, 590.026352370434, 491.5764950565149, 536.5049452436965, 294.1968291127484, 252.09595854714112, 569.9627272810238, 445.5099641593824, 335.8712372546035, 123.9031802888854, 474.5742704687594, 380.8647785281838, 221.23953933351103, 864.0023455259856, 656.3309487443028, 491.12612361386016, 246.68977662349081, 291.64617052354475, 306.4678358396304, 184.9807699945236, 372.7264980659235, 146.32256335472968, 89.11154421723921, 44.2841572256428, 24.087525283768912, 90.0276891345733, 439.14008481917784, 461.7674293683318, 386.495141342567, 413.8903473425332, 304.08502129841764, 400.93266742635103, 328.72347479171646, 444.43837944832546, 196.6541882003555, 181.33821008706087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5031540165899681, "mean_inference_ms": 1.2692868303507163, "mean_action_processing_ms": 0.21168481782299978, "mean_env_wait_ms": 0.16942793019211386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003666400909423828, "StateBufferConnector_ms": 0.0027698278427124023, "ViewRequirementAgentConnector_ms": 0.07894480228424072}, "num_episodes": 22, "episode_return_max": 378.05279843844966, "episode_return_min": -135.6431380118239, "episode_return_mean": 138.20592180826318, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.09747999015286, "num_env_steps_trained_throughput_per_sec": 416.09747999015286, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 9491.848, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9491.814, "sample_time_ms": 1034.404, "learn_time_ms": 8444.891, "learn_throughput": 473.659, "synch_weights_time_ms": 11.807}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "74486_00000", "date": "2024-08-16_14-56-56", "timestamp": 1723800416, "time_this_iter_s": 9.616482734680176, "time_total_s": 85.45828795433044, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39732d430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.45828795433044, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.714285714285715, "ram_util_percent": 74.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3990672698411992, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.442660817141255, "policy_loss": -0.008741390621215697, "vf_loss": 6.4489907529619, "vf_explained_var": -0.030455178747732174, "kl": 0.01205720567979227, "entropy": 1.5157604286910364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0429373493585636, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.912426877147937, "policy_loss": -0.007291005492683441, "vf_loss": 6.917249428279816, "vf_explained_var": 0.003349237908761968, "kl": 0.012342346858894362, "entropy": 1.5129713448897872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 378.05279843844966, "episode_reward_min": -135.6431380118239, "episode_reward_mean": 99.84480830729453, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -844.9750570296943, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 149.95179132046928, "predator_policy": 943.7393184323976}, "policy_reward_mean": {"prey_policy": -256.3182542994908, "predator_policy": 306.24065845313794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [177.67571012118748, 325.63621733367546, -60.379225839877016, -33.4873126432866, 259.55352788983265, -1.187502647933603, 260.5644930546461, 179.5399999999999, 233.1907815887239, 295.81, -65.34846604940311, -23.758677137284792, 90.31975055813652, 268.55999999999966, 302.5346468932177, 143.5456577533449, 16.261300455649348, 154.40999972266178, 231.39999999999972, 176.3967495178304, 95.29525495436478, 321.32999999999987, 181.30353611319148, 217.11147121635653, 100.03116805577342, 70.53292915718716, 356.1422198581924, 71.14949001893567, 110.28033000059092, -87.66833641394754, -7.8678831905851006, 18.08583352639066, 155.5791680840763, 58.56010412254191, 378.05279843844966, 86.67050841949849, 306.7214768761666, 125.18307444482828, 70.32880138602405, 207.7882356671744, 83.24000000000034, 172.04446319494704, 192.55011448327684, -3.8935063428076013, 89.13880047498867, 96.50573745923263, 123.25368844640892, 57.59481109938689, 67.70251463049276, 172.66214277219774, -127.40415677298584, 209.16077194742869, -9.925069892100277, 40.78780093563139, 228.92512173466636, 87.0087701396441, 69.87000000000022, -123.48528435958309, 85.58000000000074, -135.6431380118239, 130.9743705556892, 188.5256382039012, 44.20475090993636, 24.503721664693003, 136.3971690331685, -6.777484450408381, 219.74889765985057, 84.92869438860097, 120.19166105002658, 96.92218691289158, 3.629999999999963, 216.28306670271866, 263.03625394989234, 25.03586757145019, 60.794259651988185, 217.72225538093736, 53.11080907869933, 23.984565921311333, 164.30326334898783, 51.02452529852376, 115.32374709540056, 40.15630531817927, -8.170668525841556, -10.009891235493043, 113.90699642718585, 51.508994049757746, 62.23999999999965, 56.129999999999704, 66.6611685152684, 113.99522338930507, -72.08728279833542, -53.84180247510744, 30.107787399369112, 72.3934570389504, 132.0521867933495, 23.78468779534205, 4.799999999999939, -18.22549931299129, -15.960760383552444, 19.650295560477595], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-569.6188936441041, -1.6030659802349057, -491.3462397820734, 69.48310325613221, -491.45354209070877, -583.2646105806672, -436.8006975618203, -231.953863450847, -624.9594630925037, -19.580601304496792, -400.86566276493005, -290.0394917148359, 51.66859710487351, -23.34555286058475, 101.26396708135616, -599.5609615274465, -55.15692599829255, 140.6996383414543, 149.95179132046928, 77.02875918621618, -275.83980937959194, -556.1796453254768, -589.4772291020945, -167.08656350361807, -216.77724883036962, -469.00771965351925, 69.55160343043083, -0.8370006397938563, 44.49238994498614, -515.2875517171734, -72.6276993443346, -66.4346081349655, -149.49501333825845, -490.270535037986, -544.9804076266067, -48.15220913070405, 103.0398991225458, -285.937421784074, -324.0786577029981, -308.79000836992543, -355.412799074468, -470.0747565294903, 50.01204726699878, 123.54362892763311, -193.9028381458454, -11.423369419808388, -212.14688740795492, 56.662633697939924, -809.9313265611004, -57.66076695754035, -202.6020382349703, -166.6646079990707, -817.1013297580815, -283.850548218083, -403.7552829557735, -53.2459760694819, -844.9750570296943, -286.7968196572217, -491.85630562378424, -330.00761173305875, -284.22855278419286, -305.1744909830074, -347.6436310121959, -373.17792382730397, 14.634884933084543, -346.21876107419075, -265.9403981275418, -168.73667717674397, -71.85865538957688, -431.2870649064133, -236.30561620705978, -280.94873073507557, 20.805048827237613, 132.83688090030023, -522.5446475329488, -85.54224437130644, -576.3680423928083, -408.24126510028844, -204.3317094442907, -82.3577300531527, -117.59790433778502, -70.92002048055609, -466.0147764950621, -309.3080846199579, -26.82615513073993, -13.980220953735193, -726.1128666701898, -423.48055682166756, -566.1015817663496, -778.8964034950491, -238.19765648405053, -262.06180395724374, -367.2174084632718, -288.66143974601715, -445.970041913157, -437.20229090786233, -80.71563050088356, -181.60482201175233, 15.513758812222791, -536.5612391532253, -471.7855908232598, -482.5701336371117, -224.51460774991392, -88.33632813257995, -110.69154726109765, -419.65797373758465, -314.2730046191759, -296.7056694990934, -24.555645923657018, -467.96602297796085, -99.78200951966994, -107.25630218193744, -253.5179580205561, -194.70669613915447, -495.88124435305383, -364.64949290814235, -8.460181561263344, -70.16839862582526, -380.7111394146453, -348.3184385150093, -298.4331425978597, -598.6739271466639, -136.73614767540542, -221.03100178058338, -576.2093400588734, -395.058600471597, -120.8733709278005, -314.3973249509959, -122.86816809222731, -596.1737118715478, -653.2234580114907, -438.79591129841526, -396.0996598455621, -531.6085148527497, -427.52665499235883, -25.88059776607678, -373.99552798084983, 2.7385831967208216, -263.7124405426147, -158.41443396514745, -87.29154421723828, -42.474157225642514, 72.46025112458528, 29.707601159791636, 0.17596143109821044, -638.0472216687147, -162.47411864935347, -612.8755024642953, -388.54679720106043, -255.6766318717207, -21.69439237717201, -533.7452064819317, -11.631048354196334, -313.25054085452103, -287.5899641731859, -191.92129840749786, -374.2180153477644, -224.54783760505362, -401.37983584166335, -55.81061015751285, -437.8727990079218, -118.32004475184219, -50.962073070687865, -70.10423705281833, -580.6840970281821, -415.986343480176, -82.00160296759174, -250.87970934212552, -77.51929049258196, -542.3824089067436, -0.07244336881236166, -413.2893420227008, -444.85606539468756, 49.798453774980764, -222.85571717500113, -168.28908658895395, -87.6437399288086, -450.59762925474354, -279.9794099505128, -180.70743753069905, -304.01517145858566, -296.8556524061849, -408.7137276689487, -394.6117129781864, -580.622785034956, -568.4360894759444, -222.307719392642, -27.294053980440804, -54.01278494260489, -230.20108186456292, -100.48207176616684, 0.3097210419550606, -59.317912404275255, -3.634382604021072, -414.77717502512644, -145.00279531192976, -126.80415405486919, -32.040143246479225, -35.66758772138005, -62.28027442312835], "policy_predator_policy_reward": [295.4029454000787, 453.49472434544776, 291.27343431028106, 456.2259195493355, 70.59960839910038, 943.7393184323976, 426.09268209970304, 209.1745662696773, 412.4250667719278, 491.66852551490547, 492.4660855036969, 197.2515663281346, 112.52156925066734, 119.71987955968997, 40.156032918643845, 637.6809615274466, 101.9237224320896, 45.72434681347252, 8.428208679530695, 60.40124081378376, 554.9942481653233, 211.67674049034213, 7.239805611615851, 725.5653098568115, 344.4241776693937, 431.68054137263147, 113.96083787053436, 85.8845593388287, 243.46520565685887, 529.8646030085463, 117.09848450905045, 165.50948072359486, 95.54153310758973, 560.4853157243043, 554.3995028694173, 193.14311361055482, 263.49850340202926, 150.7990192594992, 569.2058651771566, 240.0595504135978, 445.8011898523981, 474.9816207059245, 126.65296301181031, 21.121360793557827, 43.999916020372254, 342.6298276584733, 148.08611356550918, 224.50961136086298, 606.9411952583213, 360.68206631609326, 207.67885601644653, 232.12071937478154, 691.3859848449194, 765.708112989438, 279.1438015989615, 249.00694744522986, 532.058676732671, 709.9935299548358, 338.7644039735553, 395.43117696934, 3.726523772816362, 577.8086368037992, 521.0504359754369, 217.85695239045387, 92.12572586540031, 395.03731835978215, 167.82610367911988, 325.41107574770746, 519.6152572969329, 361.5832614375069, 528.4546541554946, 75.47020120613811, 125.59076892047386, 27.48877822815499, 537.4530527211434, 195.81691362794035, 539.7702922613106, 515.1678166178091, 245.2332907193559, 249.2443844452621, 3.848013281136702, 267.9099115372053, 245.86958665221323, 701.4977376577535, 71.20052884302507, 162.1559617247279, 632.8845581449042, 512.8153590041456, 667.8650642697755, 766.2717214666121, 348.7288726765961, 248.03632522392957, 309.0698637692397, 470.06267288645853, 393.60694945154756, 547.1601944688589, 44.22890610533628, 285.7940610377923, 185.85155358569241, 507.85806952750806, 238.39589347420502, 588.5556742131809, 159.01025414001114, 363.0014536899113, 452.21769198821875, 68.20675911836351, 420.7333553151787, 231.03311973872198, 428.83634250052745, 292.6104481357572, 147.91033568772684, 146.13674615352497, 113.32096301797742, 404.77369114173143, 66.61483156368192, 670.4306213379316, 12.077927705338183, 152.13065248175124, 3.360087547396603, 590.026352370434, 491.5764950565149, 536.5049452436965, 294.1968291127484, 252.09595854714112, 569.9627272810238, 445.5099641593824, 335.8712372546035, 123.9031802888854, 474.5742704687594, 380.8647785281838, 221.23953933351103, 864.0023455259856, 656.3309487443028, 491.12612361386016, 246.68977662349081, 291.64617052354475, 306.4678358396304, 184.9807699945236, 372.7264980659235, 146.32256335472968, 89.11154421723921, 44.2841572256428, 24.087525283768912, 90.0276891345733, 439.14008481917784, 461.7674293683318, 386.495141342567, 413.8903473425332, 304.08502129841764, 400.93266742635103, 328.72347479171646, 444.43837944832546, 196.6541882003555, 181.33821008706087, 204.03679894070717, 299.4590295612861, 407.1167842797973, 355.9523320220081, 351.71351872492284, 156.50145257277634, 283.72108129423015, 387.7955095609339, 92.73121215442472, 68.49140328726043, 545.0712246278426, 443.42854735467347, 55.09631446653495, 267.7751066076887, 536.9936728561424, 196.81502297036835, 333.19619425298976, 131.67458518828113, 445.76606539468696, 11.531546225018968, 222.3170859600134, 224.95771780393986, 425.27070491235736, 179.63183278646392, 278.96933505348096, 295.71273581703235, 518.8781851184978, 9.90535594793539, 579.5906039388075, 169.89303423321914, 476.2040195820809, 702.9626423281871, 180.1837079355461, 141.81152247648552, 201.1910338109835, 215.07501978953246, 44.88138953989549, 79.0756489796587, 67.75229500829592, 0.0, 318.69613849286503, 222.8583325311994, 130.366873008006, 12.516663909789958, 45.71880601477013, 71.87935169021527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5003731457861719, "mean_inference_ms": 1.266527556126841, "mean_action_processing_ms": 0.21122443818447098, "mean_env_wait_ms": 0.16909181504375173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032755136489868164, "StateBufferConnector_ms": 0.00274813175201416, "ViewRequirementAgentConnector_ms": 0.07999002933502197}, "num_episodes": 23, "episode_return_max": 378.05279843844966, "episode_return_min": -135.6431380118239, "episode_return_mean": 99.84480830729453, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.79232100473826, "num_env_steps_trained_throughput_per_sec": 421.79232100473826, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 9490.998, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9490.964, "sample_time_ms": 1029.737, "learn_time_ms": 8448.613, "learn_throughput": 473.45, "synch_weights_time_ms": 11.895}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "74486_00000", "date": "2024-08-16_14-57-05", "timestamp": 1723800425, "time_this_iter_s": 9.48744821548462, "time_total_s": 94.94573616981506, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3972eb8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 94.94573616981506, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.107142857142858, "ram_util_percent": 74.68571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9005262110599135, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.383277634338096, "policy_loss": -0.012106333992310933, "vf_loss": 4.392597927492131, "vf_explained_var": -0.025574762606746935, "kl": 0.013930225594758419, "entropy": 1.516032007762364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4414254391161854, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.203068590542626, "policy_loss": -0.007770546597413837, "vf_loss": 5.209001855118565, "vf_explained_var": -0.00012205167422218928, "kl": 0.00918641940283234, "entropy": 1.5078839760608773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 378.05279843844966, "episode_reward_min": -135.6431380118239, "episode_reward_mean": 82.56320931363467, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -844.9750570296943, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 132.83688090030023, "predator_policy": 864.0023455259856}, "policy_reward_mean": {"prey_policy": -247.71520761231656, "predator_policy": 288.9968122691337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [231.39999999999972, 176.3967495178304, 95.29525495436478, 321.32999999999987, 181.30353611319148, 217.11147121635653, 100.03116805577342, 70.53292915718716, 356.1422198581924, 71.14949001893567, 110.28033000059092, -87.66833641394754, -7.8678831905851006, 18.08583352639066, 155.5791680840763, 58.56010412254191, 378.05279843844966, 86.67050841949849, 306.7214768761666, 125.18307444482828, 70.32880138602405, 207.7882356671744, 83.24000000000034, 172.04446319494704, 192.55011448327684, -3.8935063428076013, 89.13880047498867, 96.50573745923263, 123.25368844640892, 57.59481109938689, 67.70251463049276, 172.66214277219774, -127.40415677298584, 209.16077194742869, -9.925069892100277, 40.78780093563139, 228.92512173466636, 87.0087701396441, 69.87000000000022, -123.48528435958309, 85.58000000000074, -135.6431380118239, 130.9743705556892, 188.5256382039012, 44.20475090993636, 24.503721664693003, 136.3971690331685, -6.777484450408381, 219.74889765985057, 84.92869438860097, 120.19166105002658, 96.92218691289158, 3.629999999999963, 216.28306670271866, 263.03625394989234, 25.03586757145019, 60.794259651988185, 217.72225538093736, 53.11080907869933, 23.984565921311333, 164.30326334898783, 51.02452529852376, 115.32374709540056, 40.15630531817927, -8.170668525841556, -10.009891235493043, 113.90699642718585, 51.508994049757746, 62.23999999999965, 56.129999999999704, 66.6611685152684, 113.99522338930507, -72.08728279833542, -53.84180247510744, 30.107787399369112, 72.3934570389504, 132.0521867933495, 23.78468779534205, 4.799999999999939, -18.22549931299129, -15.960760383552444, 19.650295560477595, 33.95999999999969, 82.15019867706788, 11.89999999999994, 22.928721147948508, 22.83000000000044, -26.640454945683654, -18.98599570625387, 224.16746782350071, -11.477467810499851, 79.0132887645915, 150.22730985643597, 13.03631295866065, 37.919999999999455, 61.10994094734688, 23.019708002796047, 54.92126877767691, 13.969999999999951, 21.230703193716444], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [103.0398991225458, -285.937421784074, -324.0786577029981, -308.79000836992543, -355.412799074468, -470.0747565294903, 50.01204726699878, 123.54362892763311, -193.9028381458454, -11.423369419808388, -212.14688740795492, 56.662633697939924, -809.9313265611004, -57.66076695754035, -202.6020382349703, -166.6646079990707, -817.1013297580815, -283.850548218083, -403.7552829557735, -53.2459760694819, -844.9750570296943, -286.7968196572217, -491.85630562378424, -330.00761173305875, -284.22855278419286, -305.1744909830074, -347.6436310121959, -373.17792382730397, 14.634884933084543, -346.21876107419075, -265.9403981275418, -168.73667717674397, -71.85865538957688, -431.2870649064133, -236.30561620705978, -280.94873073507557, 20.805048827237613, 132.83688090030023, -522.5446475329488, -85.54224437130644, -576.3680423928083, -408.24126510028844, -204.3317094442907, -82.3577300531527, -117.59790433778502, -70.92002048055609, -466.0147764950621, -309.3080846199579, -26.82615513073993, -13.980220953735193, -726.1128666701898, -423.48055682166756, -566.1015817663496, -778.8964034950491, -238.19765648405053, -262.06180395724374, -367.2174084632718, -288.66143974601715, -445.970041913157, -437.20229090786233, -80.71563050088356, -181.60482201175233, 15.513758812222791, -536.5612391532253, -471.7855908232598, -482.5701336371117, -224.51460774991392, -88.33632813257995, -110.69154726109765, -419.65797373758465, -314.2730046191759, -296.7056694990934, -24.555645923657018, -467.96602297796085, -99.78200951966994, -107.25630218193744, -253.5179580205561, -194.70669613915447, -495.88124435305383, -364.64949290814235, -8.460181561263344, -70.16839862582526, -380.7111394146453, -348.3184385150093, -298.4331425978597, -598.6739271466639, -136.73614767540542, -221.03100178058338, -576.2093400588734, -395.058600471597, -120.8733709278005, -314.3973249509959, -122.86816809222731, -596.1737118715478, -653.2234580114907, -438.79591129841526, -396.0996598455621, -531.6085148527497, -427.52665499235883, -25.88059776607678, -373.99552798084983, 2.7385831967208216, -263.7124405426147, -158.41443396514745, -87.29154421723828, -42.474157225642514, 72.46025112458528, 29.707601159791636, 0.17596143109821044, -638.0472216687147, -162.47411864935347, -612.8755024642953, -388.54679720106043, -255.6766318717207, -21.69439237717201, -533.7452064819317, -11.631048354196334, -313.25054085452103, -287.5899641731859, -191.92129840749786, -374.2180153477644, -224.54783760505362, -401.37983584166335, -55.81061015751285, -437.8727990079218, -118.32004475184219, -50.962073070687865, -70.10423705281833, -580.6840970281821, -415.986343480176, -82.00160296759174, -250.87970934212552, -77.51929049258196, -542.3824089067436, -0.07244336881236166, -413.2893420227008, -444.85606539468756, 49.798453774980764, -222.85571717500113, -168.28908658895395, -87.6437399288086, -450.59762925474354, -279.9794099505128, -180.70743753069905, -304.01517145858566, -296.8556524061849, -408.7137276689487, -394.6117129781864, -580.622785034956, -568.4360894759444, -222.307719392642, -27.294053980440804, -54.01278494260489, -230.20108186456292, -100.48207176616684, 0.3097210419550606, -59.317912404275255, -3.634382604021072, -414.77717502512644, -145.00279531192976, -126.80415405486919, -32.040143246479225, -35.66758772138005, -62.28027442312835, -49.83166550810293, -93.88200561571081, -427.1296161427101, -578.8840374749254, -276.38674837466533, -91.33633078731307, -277.94370020806633, -197.20998312386973, -30.239867664173726, -290.7577108432828, -96.57177167608131, -114.40380076785604, -202.0017906839265, -89.82017481234962, -12.584786670426608, -305.6471803891635, -279.60365452648745, -129.21654250339128, -167.76696000431468, -381.64629982540924, -256.383149766195, -382.1268541425206, -357.7151365362152, -74.08915472449932, -51.30914768244983, -73.90051578527553, -220.27920365947932, -170.0181681982058, -110.89962628779988, -126.88600607740793, -139.68128479826885, -46.82764095847359, -176.55190588325797, -77.05643384907924, -200.48700541203104, -0.17776465387785656], "policy_predator_policy_reward": [263.49850340202926, 150.7990192594992, 569.2058651771566, 240.0595504135978, 445.8011898523981, 474.9816207059245, 126.65296301181031, 21.121360793557827, 43.999916020372254, 342.6298276584733, 148.08611356550918, 224.50961136086298, 606.9411952583213, 360.68206631609326, 207.67885601644653, 232.12071937478154, 691.3859848449194, 765.708112989438, 279.1438015989615, 249.00694744522986, 532.058676732671, 709.9935299548358, 338.7644039735553, 395.43117696934, 3.726523772816362, 577.8086368037992, 521.0504359754369, 217.85695239045387, 92.12572586540031, 395.03731835978215, 167.82610367911988, 325.41107574770746, 519.6152572969329, 361.5832614375069, 528.4546541554946, 75.47020120613811, 125.59076892047386, 27.48877822815499, 537.4530527211434, 195.81691362794035, 539.7702922613106, 515.1678166178091, 245.2332907193559, 249.2443844452621, 3.848013281136702, 267.9099115372053, 245.86958665221323, 701.4977376577535, 71.20052884302507, 162.1559617247279, 632.8845581449042, 512.8153590041456, 667.8650642697755, 766.2717214666121, 348.7288726765961, 248.03632522392957, 309.0698637692397, 470.06267288645853, 393.60694945154756, 547.1601944688589, 44.22890610533628, 285.7940610377923, 185.85155358569241, 507.85806952750806, 238.39589347420502, 588.5556742131809, 159.01025414001114, 363.0014536899113, 452.21769198821875, 68.20675911836351, 420.7333553151787, 231.03311973872198, 428.83634250052745, 292.6104481357572, 147.91033568772684, 146.13674615352497, 113.32096301797742, 404.77369114173143, 66.61483156368192, 670.4306213379316, 12.077927705338183, 152.13065248175124, 3.360087547396603, 590.026352370434, 491.5764950565149, 536.5049452436965, 294.1968291127484, 252.09595854714112, 569.9627272810238, 445.5099641593824, 335.8712372546035, 123.9031802888854, 474.5742704687594, 380.8647785281838, 221.23953933351103, 864.0023455259856, 656.3309487443028, 491.12612361386016, 246.68977662349081, 291.64617052354475, 306.4678358396304, 184.9807699945236, 372.7264980659235, 146.32256335472968, 89.11154421723921, 44.2841572256428, 24.087525283768912, 90.0276891345733, 439.14008481917784, 461.7674293683318, 386.495141342567, 413.8903473425332, 304.08502129841764, 400.93266742635103, 328.72347479171646, 444.43837944832546, 196.6541882003555, 181.33821008706087, 204.03679894070717, 299.4590295612861, 407.1167842797973, 355.9523320220081, 351.71351872492284, 156.50145257277634, 283.72108129423015, 387.7955095609339, 92.73121215442472, 68.49140328726043, 545.0712246278426, 443.42854735467347, 55.09631446653495, 267.7751066076887, 536.9936728561424, 196.81502297036835, 333.19619425298976, 131.67458518828113, 445.76606539468696, 11.531546225018968, 222.3170859600134, 224.95771780393986, 425.27070491235736, 179.63183278646392, 278.96933505348096, 295.71273581703235, 518.8781851184978, 9.90535594793539, 579.5906039388075, 169.89303423321914, 476.2040195820809, 702.9626423281871, 180.1837079355461, 141.81152247648552, 201.1910338109835, 215.07501978953246, 44.88138953989549, 79.0756489796587, 67.75229500829592, 0.0, 318.69613849286503, 222.8583325311994, 130.366873008006, 12.516663909789958, 45.71880601477013, 71.87935169021527, 51.651665508102575, 126.02200561571127, 606.7529367346137, 481.4109155600882, 277.7167483746641, 101.90633078731388, 259.94445880561153, 238.13794567427072, 51.799867664173966, 292.0277108432816, 133.64169918883616, 50.69341830941871, 211.79811446470762, 61.037855325313814, 338.7706516615896, 203.62878322150203, 301.925832274067, 95.41689694530953, 329.6968645796462, 298.729684014668, 478.9312655476734, 309.80604821747744, 361.3897390217847, 83.45086519759089, 157.3347217770612, 5.794941690664336, 169.0695443652248, 282.3377684398054, 107.5507419048651, 153.2545984631395, 71.22179235183793, 170.20840218258033, 177.98190588325684, 89.59643384907967, 170.79014116117028, 51.105332098453594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4988723459383507, "mean_inference_ms": 1.265557456380977, "mean_action_processing_ms": 0.21128025316917906, "mean_env_wait_ms": 0.16877395828926076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032243728637695312, "StateBufferConnector_ms": 0.002729177474975586, "ViewRequirementAgentConnector_ms": 0.07945144176483154}, "num_episodes": 18, "episode_return_max": 378.05279843844966, "episode_return_min": -135.6431380118239, "episode_return_mean": 82.56320931363467, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.0706069304199, "num_env_steps_trained_throughput_per_sec": 419.0706069304199, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9443.112, "restore_workers_time_ms": 0.01, "training_step_time_ms": 9443.081, "sample_time_ms": 1023.673, "learn_time_ms": 8406.882, "learn_throughput": 475.801, "synch_weights_time_ms": 11.806}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "74486_00000", "date": "2024-08-16_14-57-15", "timestamp": 1723800435, "time_this_iter_s": 9.548427820205688, "time_total_s": 104.49416399002075, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397351790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 104.49416399002075, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.00769230769231, "ram_util_percent": 74.78461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4211903664012435, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8482551879352993, "policy_loss": -0.00791720913146578, "vf_loss": 2.8549680164251376, "vf_explained_var": 0.0014176374705380233, "kl": 0.006021903587948544, "entropy": 1.5241127204011988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3452048488710293, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.334360923338189, "policy_loss": -0.0070692202509947556, "vf_loss": 3.340322966171951, "vf_explained_var": 0.0017762479958710847, "kl": 0.005535854852200557, "entropy": 1.5114875575852773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 306.7214768761666, "episode_reward_min": -135.6431380118239, "episode_reward_mean": 62.51705290793438, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -778.8964034950491, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 132.83688090030023, "predator_policy": 864.0023455259856}, "policy_reward_mean": {"prey_policy": -221.07416972444653, "predator_policy": 252.33269617841353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.7214768761666, 125.18307444482828, 70.32880138602405, 207.7882356671744, 83.24000000000034, 172.04446319494704, 192.55011448327684, -3.8935063428076013, 89.13880047498867, 96.50573745923263, 123.25368844640892, 57.59481109938689, 67.70251463049276, 172.66214277219774, -127.40415677298584, 209.16077194742869, -9.925069892100277, 40.78780093563139, 228.92512173466636, 87.0087701396441, 69.87000000000022, -123.48528435958309, 85.58000000000074, -135.6431380118239, 130.9743705556892, 188.5256382039012, 44.20475090993636, 24.503721664693003, 136.3971690331685, -6.777484450408381, 219.74889765985057, 84.92869438860097, 120.19166105002658, 96.92218691289158, 3.629999999999963, 216.28306670271866, 263.03625394989234, 25.03586757145019, 60.794259651988185, 217.72225538093736, 53.11080907869933, 23.984565921311333, 164.30326334898783, 51.02452529852376, 115.32374709540056, 40.15630531817927, -8.170668525841556, -10.009891235493043, 113.90699642718585, 51.508994049757746, 62.23999999999965, 56.129999999999704, 66.6611685152684, 113.99522338930507, -72.08728279833542, -53.84180247510744, 30.107787399369112, 72.3934570389504, 132.0521867933495, 23.78468779534205, 4.799999999999939, -18.22549931299129, -15.960760383552444, 19.650295560477595, 33.95999999999969, 82.15019867706788, 11.89999999999994, 22.928721147948508, 22.83000000000044, -26.640454945683654, -18.98599570625387, 224.16746782350071, -11.477467810499851, 79.0132887645915, 150.22730985643597, 13.03631295866065, 37.919999999999455, 61.10994094734688, 23.019708002796047, 54.92126877767691, 13.969999999999951, 21.230703193716444, -9.82310933900487, 52.90939901552114, 7.289999999999967, 21.520000000000547, 39.217210201393485, 38.14468751139975, 30.601097082299344, 3.539999999999968, -21.72447082839723, 103.62509650355395, 16.955425938349777, 62.094901377319985, 13.198540256457802, 6.589999999999957, 72.34994796978843, 8.30999999999996, 69.92266241950372, 13.048313200630513], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.805048827237613, 132.83688090030023, -522.5446475329488, -85.54224437130644, -576.3680423928083, -408.24126510028844, -204.3317094442907, -82.3577300531527, -117.59790433778502, -70.92002048055609, -466.0147764950621, -309.3080846199579, -26.82615513073993, -13.980220953735193, -726.1128666701898, -423.48055682166756, -566.1015817663496, -778.8964034950491, -238.19765648405053, -262.06180395724374, -367.2174084632718, -288.66143974601715, -445.970041913157, -437.20229090786233, -80.71563050088356, -181.60482201175233, 15.513758812222791, -536.5612391532253, -471.7855908232598, -482.5701336371117, -224.51460774991392, -88.33632813257995, -110.69154726109765, -419.65797373758465, -314.2730046191759, -296.7056694990934, -24.555645923657018, -467.96602297796085, -99.78200951966994, -107.25630218193744, -253.5179580205561, -194.70669613915447, -495.88124435305383, -364.64949290814235, -8.460181561263344, -70.16839862582526, -380.7111394146453, -348.3184385150093, -298.4331425978597, -598.6739271466639, -136.73614767540542, -221.03100178058338, -576.2093400588734, -395.058600471597, -120.8733709278005, -314.3973249509959, -122.86816809222731, -596.1737118715478, -653.2234580114907, -438.79591129841526, -396.0996598455621, -531.6085148527497, -427.52665499235883, -25.88059776607678, -373.99552798084983, 2.7385831967208216, -263.7124405426147, -158.41443396514745, -87.29154421723828, -42.474157225642514, 72.46025112458528, 29.707601159791636, 0.17596143109821044, -638.0472216687147, -162.47411864935347, -612.8755024642953, -388.54679720106043, -255.6766318717207, -21.69439237717201, -533.7452064819317, -11.631048354196334, -313.25054085452103, -287.5899641731859, -191.92129840749786, -374.2180153477644, -224.54783760505362, -401.37983584166335, -55.81061015751285, -437.8727990079218, -118.32004475184219, -50.962073070687865, -70.10423705281833, -580.6840970281821, -415.986343480176, -82.00160296759174, -250.87970934212552, -77.51929049258196, -542.3824089067436, -0.07244336881236166, -413.2893420227008, -444.85606539468756, 49.798453774980764, -222.85571717500113, -168.28908658895395, -87.6437399288086, -450.59762925474354, -279.9794099505128, -180.70743753069905, -304.01517145858566, -296.8556524061849, -408.7137276689487, -394.6117129781864, -580.622785034956, -568.4360894759444, -222.307719392642, -27.294053980440804, -54.01278494260489, -230.20108186456292, -100.48207176616684, 0.3097210419550606, -59.317912404275255, -3.634382604021072, -414.77717502512644, -145.00279531192976, -126.80415405486919, -32.040143246479225, -35.66758772138005, -62.28027442312835, -49.83166550810293, -93.88200561571081, -427.1296161427101, -578.8840374749254, -276.38674837466533, -91.33633078731307, -277.94370020806633, -197.20998312386973, -30.239867664173726, -290.7577108432828, -96.57177167608131, -114.40380076785604, -202.0017906839265, -89.82017481234962, -12.584786670426608, -305.6471803891635, -279.60365452648745, -129.21654250339128, -167.76696000431468, -381.64629982540924, -256.383149766195, -382.1268541425206, -357.7151365362152, -74.08915472449932, -51.30914768244983, -73.90051578527553, -220.27920365947932, -170.0181681982058, -110.89962628779988, -126.88600607740793, -139.68128479826885, -46.82764095847359, -176.55190588325797, -77.05643384907924, -200.48700541203104, -0.17776465387785656, -20.098050621256977, -73.7904963325672, -106.839404756343, -88.55401300851364, -204.36956380418172, -36.60831249674415, -12.065080939581543, -113.13261955970471, -259.6093502691585, -62.377904743710126, -2.063405126962242, -32.02524267484515, -50.32232397130713, -98.34854082408917, -129.09131970279586, -51.01237033141064, -156.21955415301517, -195.4302563373209, -345.6851056235001, -29.761974273839638, -130.17325425252463, -8.61446061781662, -6.6181978395263314, -404.5343227153099, -80.17719951497352, -29.42519075002677, -458.5374749243531, -13.016091399590929, -106.45549005112737, -183.56675232592931, -179.67446399511206, -59.424774387439435, -21.40093088658891, -205.09022799698155, -381.7553371677279, -9.765181557654252], "policy_predator_policy_reward": [125.59076892047386, 27.48877822815499, 537.4530527211434, 195.81691362794035, 539.7702922613106, 515.1678166178091, 245.2332907193559, 249.2443844452621, 3.848013281136702, 267.9099115372053, 245.86958665221323, 701.4977376577535, 71.20052884302507, 162.1559617247279, 632.8845581449042, 512.8153590041456, 667.8650642697755, 766.2717214666121, 348.7288726765961, 248.03632522392957, 309.0698637692397, 470.06267288645853, 393.60694945154756, 547.1601944688589, 44.22890610533628, 285.7940610377923, 185.85155358569241, 507.85806952750806, 238.39589347420502, 588.5556742131809, 159.01025414001114, 363.0014536899113, 452.21769198821875, 68.20675911836351, 420.7333553151787, 231.03311973872198, 428.83634250052745, 292.6104481357572, 147.91033568772684, 146.13674615352497, 113.32096301797742, 404.77369114173143, 66.61483156368192, 670.4306213379316, 12.077927705338183, 152.13065248175124, 3.360087547396603, 590.026352370434, 491.5764950565149, 536.5049452436965, 294.1968291127484, 252.09595854714112, 569.9627272810238, 445.5099641593824, 335.8712372546035, 123.9031802888854, 474.5742704687594, 380.8647785281838, 221.23953933351103, 864.0023455259856, 656.3309487443028, 491.12612361386016, 246.68977662349081, 291.64617052354475, 306.4678358396304, 184.9807699945236, 372.7264980659235, 146.32256335472968, 89.11154421723921, 44.2841572256428, 24.087525283768912, 90.0276891345733, 439.14008481917784, 461.7674293683318, 386.495141342567, 413.8903473425332, 304.08502129841764, 400.93266742635103, 328.72347479171646, 444.43837944832546, 196.6541882003555, 181.33821008706087, 204.03679894070717, 299.4590295612861, 407.1167842797973, 355.9523320220081, 351.71351872492284, 156.50145257277634, 283.72108129423015, 387.7955095609339, 92.73121215442472, 68.49140328726043, 545.0712246278426, 443.42854735467347, 55.09631446653495, 267.7751066076887, 536.9936728561424, 196.81502297036835, 333.19619425298976, 131.67458518828113, 445.76606539468696, 11.531546225018968, 222.3170859600134, 224.95771780393986, 425.27070491235736, 179.63183278646392, 278.96933505348096, 295.71273581703235, 518.8781851184978, 9.90535594793539, 579.5906039388075, 169.89303423321914, 476.2040195820809, 702.9626423281871, 180.1837079355461, 141.81152247648552, 201.1910338109835, 215.07501978953246, 44.88138953989549, 79.0756489796587, 67.75229500829592, 0.0, 318.69613849286503, 222.8583325311994, 130.366873008006, 12.516663909789958, 45.71880601477013, 71.87935169021527, 51.651665508102575, 126.02200561571127, 606.7529367346137, 481.4109155600882, 277.7167483746641, 101.90633078731388, 259.94445880561153, 238.13794567427072, 51.799867664173966, 292.0277108432816, 133.64169918883616, 50.69341830941871, 211.79811446470762, 61.037855325313814, 338.7706516615896, 203.62878322150203, 301.925832274067, 95.41689694530953, 329.6968645796462, 298.729684014668, 478.9312655476734, 309.80604821747744, 361.3897390217847, 83.45086519759089, 157.3347217770612, 5.794941690664336, 169.0695443652248, 282.3377684398054, 107.5507419048651, 153.2545984631395, 71.22179235183793, 170.20840218258033, 177.98190588325684, 89.59643384907967, 170.79014116117028, 51.105332098453594, 69.37420263302734, 14.69123498179323, 67.06258988426727, 181.2402268961122, 207.67503903677655, 40.59283726414798, 30.815080939581506, 115.90261955970561, 91.0404920536533, 270.1639731606079, 4.043405126962204, 68.18993018624515, 138.4508980612437, 40.82106381645177, 130.8013197027943, 52.84237033141027, 308.48847269261813, 21.436866969317723, 330.29894929058986, 148.77322711030217, 89.56194263675717, 66.18119817193246, 75.80182543867213, 397.4455964934838, 69.5774332189036, 53.22349730255572, 462.1874749243525, 15.95609139959089, 131.89543802091575, 230.47675232592854, 186.20446399511184, 61.204774387439116, 193.4642500919422, 102.94957121112961, 382.775337167727, 21.793494758284776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49787083422579215, "mean_inference_ms": 1.2652267306200684, "mean_action_processing_ms": 0.21153640412765617, "mean_env_wait_ms": 0.1684638488883768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032186508178710938, "StateBufferConnector_ms": 0.0027025938034057617, "ViewRequirementAgentConnector_ms": 0.07926666736602783}, "num_episodes": 18, "episode_return_max": 306.7214768761666, "episode_return_min": -135.6431380118239, "episode_return_mean": 62.51705290793438, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.204093563361, "num_env_steps_trained_throughput_per_sec": 386.204093563361, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9530.79, "restore_workers_time_ms": 0.01, "training_step_time_ms": 9530.755, "sample_time_ms": 1023.264, "learn_time_ms": 8494.3, "learn_throughput": 470.904, "synch_weights_time_ms": 12.139}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "74486_00000", "date": "2024-08-16_14-57-25", "timestamp": 1723800445, "time_this_iter_s": 10.378826141357422, "time_total_s": 114.87299013137817, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39737f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 114.87299013137817, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.0, "ram_util_percent": 76.22666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3609234996731319, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3882941936058972, "policy_loss": -0.007414535403488174, "vf_loss": 2.3938482703355253, "vf_explained_var": 0.019154438266047725, "kl": 0.009302310149990004, "entropy": 1.5100431165367207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3048961869623295, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8441987569369966, "policy_loss": -0.008102416112728258, "vf_loss": 2.8503340674455835, "vf_explained_var": -0.0003113654870835562, "kl": 0.009835577757392295, "entropy": 1.4967287708211827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 263.03625394989234, "episode_reward_min": -135.6431380118239, "episode_reward_mean": 46.22294368474573, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -653.2234580114907, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 72.46025112458528, "predator_policy": 864.0023455259856}, "policy_reward_mean": {"prey_policy": -187.56406725336512, "predator_policy": 210.67553909573772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.92512173466636, 87.0087701396441, 69.87000000000022, -123.48528435958309, 85.58000000000074, -135.6431380118239, 130.9743705556892, 188.5256382039012, 44.20475090993636, 24.503721664693003, 136.3971690331685, -6.777484450408381, 219.74889765985057, 84.92869438860097, 120.19166105002658, 96.92218691289158, 3.629999999999963, 216.28306670271866, 263.03625394989234, 25.03586757145019, 60.794259651988185, 217.72225538093736, 53.11080907869933, 23.984565921311333, 164.30326334898783, 51.02452529852376, 115.32374709540056, 40.15630531817927, -8.170668525841556, -10.009891235493043, 113.90699642718585, 51.508994049757746, 62.23999999999965, 56.129999999999704, 66.6611685152684, 113.99522338930507, -72.08728279833542, -53.84180247510744, 30.107787399369112, 72.3934570389504, 132.0521867933495, 23.78468779534205, 4.799999999999939, -18.22549931299129, -15.960760383552444, 19.650295560477595, 33.95999999999969, 82.15019867706788, 11.89999999999994, 22.928721147948508, 22.83000000000044, -26.640454945683654, -18.98599570625387, 224.16746782350071, -11.477467810499851, 79.0132887645915, 150.22730985643597, 13.03631295866065, 37.919999999999455, 61.10994094734688, 23.019708002796047, 54.92126877767691, 13.969999999999951, 21.230703193716444, -9.82310933900487, 52.90939901552114, 7.289999999999967, 21.520000000000547, 39.217210201393485, 38.14468751139975, 30.601097082299344, 3.539999999999968, -21.72447082839723, 103.62509650355395, 16.955425938349777, 62.094901377319985, 13.198540256457802, 6.589999999999957, 72.34994796978843, 8.30999999999996, 69.92266241950372, 13.048313200630513, -23.82621747049975, 91.21780782108326, 36.379999999999654, 21.61000000000054, 40.5827740573296, 19.180000000000252, 5.818569135443918, -57.81647039759528, 6.029999999999944, 23.794532837571886, -16.984430604944826, 5.3899999999999695, -0.9500049119057825, 35.53999999999937, 16.659845973267927, 4.959999999999937, 19.00931247481769, 17.433059576859137], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.555645923657018, -467.96602297796085, -99.78200951966994, -107.25630218193744, -253.5179580205561, -194.70669613915447, -495.88124435305383, -364.64949290814235, -8.460181561263344, -70.16839862582526, -380.7111394146453, -348.3184385150093, -298.4331425978597, -598.6739271466639, -136.73614767540542, -221.03100178058338, -576.2093400588734, -395.058600471597, -120.8733709278005, -314.3973249509959, -122.86816809222731, -596.1737118715478, -653.2234580114907, -438.79591129841526, -396.0996598455621, -531.6085148527497, -427.52665499235883, -25.88059776607678, -373.99552798084983, 2.7385831967208216, -263.7124405426147, -158.41443396514745, -87.29154421723828, -42.474157225642514, 72.46025112458528, 29.707601159791636, 0.17596143109821044, -638.0472216687147, -162.47411864935347, -612.8755024642953, -388.54679720106043, -255.6766318717207, -21.69439237717201, -533.7452064819317, -11.631048354196334, -313.25054085452103, -287.5899641731859, -191.92129840749786, -374.2180153477644, -224.54783760505362, -401.37983584166335, -55.81061015751285, -437.8727990079218, -118.32004475184219, -50.962073070687865, -70.10423705281833, -580.6840970281821, -415.986343480176, -82.00160296759174, -250.87970934212552, -77.51929049258196, -542.3824089067436, -0.07244336881236166, -413.2893420227008, -444.85606539468756, 49.798453774980764, -222.85571717500113, -168.28908658895395, -87.6437399288086, -450.59762925474354, -279.9794099505128, -180.70743753069905, -304.01517145858566, -296.8556524061849, -408.7137276689487, -394.6117129781864, -580.622785034956, -568.4360894759444, -222.307719392642, -27.294053980440804, -54.01278494260489, -230.20108186456292, -100.48207176616684, 0.3097210419550606, -59.317912404275255, -3.634382604021072, -414.77717502512644, -145.00279531192976, -126.80415405486919, -32.040143246479225, -35.66758772138005, -62.28027442312835, -49.83166550810293, -93.88200561571081, -427.1296161427101, -578.8840374749254, -276.38674837466533, -91.33633078731307, -277.94370020806633, -197.20998312386973, -30.239867664173726, -290.7577108432828, -96.57177167608131, -114.40380076785604, -202.0017906839265, -89.82017481234962, -12.584786670426608, -305.6471803891635, -279.60365452648745, -129.21654250339128, -167.76696000431468, -381.64629982540924, -256.383149766195, -382.1268541425206, -357.7151365362152, -74.08915472449932, -51.30914768244983, -73.90051578527553, -220.27920365947932, -170.0181681982058, -110.89962628779988, -126.88600607740793, -139.68128479826885, -46.82764095847359, -176.55190588325797, -77.05643384907924, -200.48700541203104, -0.17776465387785656, -20.098050621256977, -73.7904963325672, -106.839404756343, -88.55401300851364, -204.36956380418172, -36.60831249674415, -12.065080939581543, -113.13261955970471, -259.6093502691585, -62.377904743710126, -2.063405126962242, -32.02524267484515, -50.32232397130713, -98.34854082408917, -129.09131970279586, -51.01237033141064, -156.21955415301517, -195.4302563373209, -345.6851056235001, -29.761974273839638, -130.17325425252463, -8.61446061781662, -6.6181978395263314, -404.5343227153099, -80.17719951497352, -29.42519075002677, -458.5374749243531, -13.016091399590929, -106.45549005112737, -183.56675232592931, -179.67446399511206, -59.424774387439435, -21.40093088658891, -205.09022799698155, -381.7553371677279, -9.765181557654252, -213.26415558573555, -201.02859966542027, -163.80064597539936, -204.20630424375864, -566.0444472077209, -22.428472219584474, -5.64650261510231, -23.448303316370126, -158.65360390942385, -118.33481632262153, -115.25156587468616, -79.55678584429171, -14.72546481964734, 0.41301571774252127, -117.00489453810292, -73.5211561808458, -102.23559351407356, -262.56462004619806, -50.62565606710644, -46.608108584821366, -29.001414262059924, -49.36863757783299, -17.541911650192535, -185.98658895856417, -60.02296108810217, -181.31918048141833, 27.325317725661964, -31.18201301553671, -144.92677760393642, -37.95332497300459, -184.79240764721132, -106.10347466264005, -68.8087296256413, 2.0000000000000013, -120.12871324712809, -27.827717626345365], "policy_predator_policy_reward": [428.83634250052745, 292.6104481357572, 147.91033568772684, 146.13674615352497, 113.32096301797742, 404.77369114173143, 66.61483156368192, 670.4306213379316, 12.077927705338183, 152.13065248175124, 3.360087547396603, 590.026352370434, 491.5764950565149, 536.5049452436965, 294.1968291127484, 252.09595854714112, 569.9627272810238, 445.5099641593824, 335.8712372546035, 123.9031802888854, 474.5742704687594, 380.8647785281838, 221.23953933351103, 864.0023455259856, 656.3309487443028, 491.12612361386016, 246.68977662349081, 291.64617052354475, 306.4678358396304, 184.9807699945236, 372.7264980659235, 146.32256335472968, 89.11154421723921, 44.2841572256428, 24.087525283768912, 90.0276891345733, 439.14008481917784, 461.7674293683318, 386.495141342567, 413.8903473425332, 304.08502129841764, 400.93266742635103, 328.72347479171646, 444.43837944832546, 196.6541882003555, 181.33821008706087, 204.03679894070717, 299.4590295612861, 407.1167842797973, 355.9523320220081, 351.71351872492284, 156.50145257277634, 283.72108129423015, 387.7955095609339, 92.73121215442472, 68.49140328726043, 545.0712246278426, 443.42854735467347, 55.09631446653495, 267.7751066076887, 536.9936728561424, 196.81502297036835, 333.19619425298976, 131.67458518828113, 445.76606539468696, 11.531546225018968, 222.3170859600134, 224.95771780393986, 425.27070491235736, 179.63183278646392, 278.96933505348096, 295.71273581703235, 518.8781851184978, 9.90535594793539, 579.5906039388075, 169.89303423321914, 476.2040195820809, 702.9626423281871, 180.1837079355461, 141.81152247648552, 201.1910338109835, 215.07501978953246, 44.88138953989549, 79.0756489796587, 67.75229500829592, 0.0, 318.69613849286503, 222.8583325311994, 130.366873008006, 12.516663909789958, 45.71880601477013, 71.87935169021527, 51.651665508102575, 126.02200561571127, 606.7529367346137, 481.4109155600882, 277.7167483746641, 101.90633078731388, 259.94445880561153, 238.13794567427072, 51.799867664173966, 292.0277108432816, 133.64169918883616, 50.69341830941871, 211.79811446470762, 61.037855325313814, 338.7706516615896, 203.62878322150203, 301.925832274067, 95.41689694530953, 329.6968645796462, 298.729684014668, 478.9312655476734, 309.80604821747744, 361.3897390217847, 83.45086519759089, 157.3347217770612, 5.794941690664336, 169.0695443652248, 282.3377684398054, 107.5507419048651, 153.2545984631395, 71.22179235183793, 170.20840218258033, 177.98190588325684, 89.59643384907967, 170.79014116117028, 51.105332098453594, 69.37420263302734, 14.69123498179323, 67.06258988426727, 181.2402268961122, 207.67503903677655, 40.59283726414798, 30.815080939581506, 115.90261955970561, 91.0404920536533, 270.1639731606079, 4.043405126962204, 68.18993018624515, 138.4508980612437, 40.82106381645177, 130.8013197027943, 52.84237033141027, 308.48847269261813, 21.436866969317723, 330.29894929058986, 148.77322711030217, 89.56194263675717, 66.18119817193246, 75.80182543867213, 397.4455964934838, 69.5774332189036, 53.22349730255572, 462.1874749243525, 15.95609139959089, 131.89543802091575, 230.47675232592854, 186.20446399511184, 61.204774387439116, 193.4642500919422, 102.94957121112961, 382.775337167727, 21.793494758284776, 115.42720417214768, 275.03933360850743, 329.5809118154246, 129.6438462248126, 563.4228606306839, 61.43005879662075, 14.52650261510227, 36.1783033163704, 123.26673145083545, 194.30446283854084, 116.80156587468693, 97.18678584429254, 8.990295610845026, 11.14072262650374, 121.87612405112816, 10.833456270227616, 103.8855935140744, 266.9446200461968, 87.44071742447875, 33.58758006501972, 57.684731682885776, 3.700889552061696, 136.5836927011679, 72.33480790758877, 78.21930517199232, 162.17283148562075, 1.7965511794019045, 37.600144110473025, 143.21348101031867, 56.32646753988851, 151.5636739934736, 144.2922083163778, 66.78068188009301, 19.037360220366015, 136.98530859283522, 28.404181857498227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.499584192359664, "mean_inference_ms": 1.2714464076021006, "mean_action_processing_ms": 0.21245136618732324, "mean_env_wait_ms": 0.16908400484175257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034319162368774414, "StateBufferConnector_ms": 0.003912806510925293, "ViewRequirementAgentConnector_ms": 0.08332180976867676}, "num_episodes": 18, "episode_return_max": 263.03625394989234, "episode_return_min": -135.6431380118239, "episode_return_mean": 46.22294368474573, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.44257044800264, "num_env_steps_trained_throughput_per_sec": 372.44257044800264, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 9673.972, "restore_workers_time_ms": 0.01, "training_step_time_ms": 9673.936, "sample_time_ms": 1061.474, "learn_time_ms": 8598.566, "learn_throughput": 465.194, "synch_weights_time_ms": 12.838}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "74486_00000", "date": "2024-08-16_14-57-36", "timestamp": 1723800456, "time_this_iter_s": 10.749671936035156, "time_total_s": 125.62266206741333, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39737fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 125.62266206741333, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 40.46666666666666, "ram_util_percent": 78.41333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3904090156000126, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3057102714266096, "policy_loss": -0.005367052119235119, "vf_loss": 2.3100615080071503, "vf_explained_var": 0.023670569551054132, "kl": 0.005079072401980813, "entropy": 1.5224037087152875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1922298532787454, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8960497181251568, "policy_loss": -0.010203947072168665, "vf_loss": 2.9044641406447798, "vf_explained_var": 0.00015996877478544045, "kl": 0.00894763758412469, "entropy": 1.4716739072370781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 224.16746782350071, "episode_reward_min": -72.08728279833542, "episode_reward_mean": 26.59375738896777, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -580.6840970281821, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 49.798453774980764, "predator_policy": 702.9626423281871}, "policy_reward_mean": {"prey_policy": -136.68266780663595, "predator_policy": 149.97954650111956}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.15630531817927, -8.170668525841556, -10.009891235493043, 113.90699642718585, 51.508994049757746, 62.23999999999965, 56.129999999999704, 66.6611685152684, 113.99522338930507, -72.08728279833542, -53.84180247510744, 30.107787399369112, 72.3934570389504, 132.0521867933495, 23.78468779534205, 4.799999999999939, -18.22549931299129, -15.960760383552444, 19.650295560477595, 33.95999999999969, 82.15019867706788, 11.89999999999994, 22.928721147948508, 22.83000000000044, -26.640454945683654, -18.98599570625387, 224.16746782350071, -11.477467810499851, 79.0132887645915, 150.22730985643597, 13.03631295866065, 37.919999999999455, 61.10994094734688, 23.019708002796047, 54.92126877767691, 13.969999999999951, 21.230703193716444, -9.82310933900487, 52.90939901552114, 7.289999999999967, 21.520000000000547, 39.217210201393485, 38.14468751139975, 30.601097082299344, 3.539999999999968, -21.72447082839723, 103.62509650355395, 16.955425938349777, 62.094901377319985, 13.198540256457802, 6.589999999999957, 72.34994796978843, 8.30999999999996, 69.92266241950372, 13.048313200630513, -23.82621747049975, 91.21780782108326, 36.379999999999654, 21.61000000000054, 40.5827740573296, 19.180000000000252, 5.818569135443918, -57.81647039759528, 6.029999999999944, 23.794532837571886, -16.984430604944826, 5.3899999999999695, -0.9500049119057825, 35.53999999999937, 16.659845973267927, 4.959999999999937, 19.00931247481769, 17.433059576859137, 21.350000000000506, 5.152272984755436, 21.240745696607924, 28.855246004873063, 8.589999999999923, 37.056086845249425, 60.991487638492245, 20.173764426059762, 43.08395800118911, 13.957256402322692, 58.27640145955345, 25.540000000000553, 11.075180114478941, 4.209999999999958, 20.720000000000546, 12.1858569075076, 11.126923351469507, 5.0378257479074025, 11.639999999999967, 11.379999999999928, 3.859999999999961, -7.029330585521933, -4.350179037754714, 5.559999999999926, 40.79156389617599, 8.789999999999928, 3.93999999999996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-50.962073070687865, -70.10423705281833, -580.6840970281821, -415.986343480176, -82.00160296759174, -250.87970934212552, -77.51929049258196, -542.3824089067436, -0.07244336881236166, -413.2893420227008, -444.85606539468756, 49.798453774980764, -222.85571717500113, -168.28908658895395, -87.6437399288086, -450.59762925474354, -279.9794099505128, -180.70743753069905, -304.01517145858566, -296.8556524061849, -408.7137276689487, -394.6117129781864, -580.622785034956, -568.4360894759444, -222.307719392642, -27.294053980440804, -54.01278494260489, -230.20108186456292, -100.48207176616684, 0.3097210419550606, -59.317912404275255, -3.634382604021072, -414.77717502512644, -145.00279531192976, -126.80415405486919, -32.040143246479225, -35.66758772138005, -62.28027442312835, -49.83166550810293, -93.88200561571081, -427.1296161427101, -578.8840374749254, -276.38674837466533, -91.33633078731307, -277.94370020806633, -197.20998312386973, -30.239867664173726, -290.7577108432828, -96.57177167608131, -114.40380076785604, -202.0017906839265, -89.82017481234962, -12.584786670426608, -305.6471803891635, -279.60365452648745, -129.21654250339128, -167.76696000431468, -381.64629982540924, -256.383149766195, -382.1268541425206, -357.7151365362152, -74.08915472449932, -51.30914768244983, -73.90051578527553, -220.27920365947932, -170.0181681982058, -110.89962628779988, -126.88600607740793, -139.68128479826885, -46.82764095847359, -176.55190588325797, -77.05643384907924, -200.48700541203104, -0.17776465387785656, -20.098050621256977, -73.7904963325672, -106.839404756343, -88.55401300851364, -204.36956380418172, -36.60831249674415, -12.065080939581543, -113.13261955970471, -259.6093502691585, -62.377904743710126, -2.063405126962242, -32.02524267484515, -50.32232397130713, -98.34854082408917, -129.09131970279586, -51.01237033141064, -156.21955415301517, -195.4302563373209, -345.6851056235001, -29.761974273839638, -130.17325425252463, -8.61446061781662, -6.6181978395263314, -404.5343227153099, -80.17719951497352, -29.42519075002677, -458.5374749243531, -13.016091399590929, -106.45549005112737, -183.56675232592931, -179.67446399511206, -59.424774387439435, -21.40093088658891, -205.09022799698155, -381.7553371677279, -9.765181557654252, -213.26415558573555, -201.02859966542027, -163.80064597539936, -204.20630424375864, -566.0444472077209, -22.428472219584474, -5.64650261510231, -23.448303316370126, -158.65360390942385, -118.33481632262153, -115.25156587468616, -79.55678584429171, -14.72546481964734, 0.41301571774252127, -117.00489453810292, -73.5211561808458, -102.23559351407356, -262.56462004619806, -50.62565606710644, -46.608108584821366, -29.001414262059924, -49.36863757783299, -17.541911650192535, -185.98658895856417, -60.02296108810217, -181.31918048141833, 27.325317725661964, -31.18201301553671, -144.92677760393642, -37.95332497300459, -184.79240764721132, -106.10347466264005, -68.8087296256413, 2.0000000000000013, -120.12871324712809, -27.827717626345365, -34.347056258092906, -72.47760541847789, -82.2555769510076, -18.37908362025922, -162.8216013696294, -34.798525854162804, -55.29457032169395, -19.355994658047052, -40.76805940942013, -84.85027625531582, -103.25350526878476, -19.98594009818676, -12.802669025328132, -101.0224254647974, -106.40242935471758, -0.20017646680273327, -157.07205258843996, -122.88952799480536, -368.04079212056223, -257.73305563415784, -225.6035206235906, -180.68641057893996, 20.25670517604644, -101.83294396273773, -76.45243229113967, -2.6352312918780347, -162.17163834230894, -183.4680369226327, 13.809077585851844, -12.643395482744157, -19.120725579176494, -259.3706565080925, -44.35202645595793, -84.23558255841039, -239.937032439991, -18.560382814532524, -23.877974832490338, -36.13769995434109, -137.08638990784513, -85.3987750859278, -3.395419848714023, -23.481922221790988, -29.000905643444007, -65.33412812863955, -88.55430072145606, -208.94445949078442, -6.901436876828619, -108.89467986133789, -31.96733830896862, -20.31701059719152, -28.34162012675626, -7.281043856250948, -3.161560787536862, -3.8589218967209], "policy_predator_policy_reward": [92.73121215442472, 68.49140328726043, 545.0712246278426, 443.42854735467347, 55.09631446653495, 267.7751066076887, 536.9936728561424, 196.81502297036835, 333.19619425298976, 131.67458518828113, 445.76606539468696, 11.531546225018968, 222.3170859600134, 224.95771780393986, 425.27070491235736, 179.63183278646392, 278.96933505348096, 295.71273581703235, 518.8781851184978, 9.90535594793539, 579.5906039388075, 169.89303423321914, 476.2040195820809, 702.9626423281871, 180.1837079355461, 141.81152247648552, 201.1910338109835, 215.07501978953246, 44.88138953989549, 79.0756489796587, 67.75229500829592, 0.0, 318.69613849286503, 222.8583325311994, 130.366873008006, 12.516663909789958, 45.71880601477013, 71.87935169021527, 51.651665508102575, 126.02200561571127, 606.7529367346137, 481.4109155600882, 277.7167483746641, 101.90633078731388, 259.94445880561153, 238.13794567427072, 51.799867664173966, 292.0277108432816, 133.64169918883616, 50.69341830941871, 211.79811446470762, 61.037855325313814, 338.7706516615896, 203.62878322150203, 301.925832274067, 95.41689694530953, 329.6968645796462, 298.729684014668, 478.9312655476734, 309.80604821747744, 361.3897390217847, 83.45086519759089, 157.3347217770612, 5.794941690664336, 169.0695443652248, 282.3377684398054, 107.5507419048651, 153.2545984631395, 71.22179235183793, 170.20840218258033, 177.98190588325684, 89.59643384907967, 170.79014116117028, 51.105332098453594, 69.37420263302734, 14.69123498179323, 67.06258988426727, 181.2402268961122, 207.67503903677655, 40.59283726414798, 30.815080939581506, 115.90261955970561, 91.0404920536533, 270.1639731606079, 4.043405126962204, 68.18993018624515, 138.4508980612437, 40.82106381645177, 130.8013197027943, 52.84237033141027, 308.48847269261813, 21.436866969317723, 330.29894929058986, 148.77322711030217, 89.56194263675717, 66.18119817193246, 75.80182543867213, 397.4455964934838, 69.5774332189036, 53.22349730255572, 462.1874749243525, 15.95609139959089, 131.89543802091575, 230.47675232592854, 186.20446399511184, 61.204774387439116, 193.4642500919422, 102.94957121112961, 382.775337167727, 21.793494758284776, 115.42720417214768, 275.03933360850743, 329.5809118154246, 129.6438462248126, 563.4228606306839, 61.43005879662075, 14.52650261510227, 36.1783033163704, 123.26673145083545, 194.30446283854084, 116.80156587468693, 97.18678584429254, 8.990295610845026, 11.14072262650374, 121.87612405112816, 10.833456270227616, 103.8855935140744, 266.9446200461968, 87.44071742447875, 33.58758006501972, 57.684731682885776, 3.700889552061696, 136.5836927011679, 72.33480790758877, 78.21930517199232, 162.17283148562075, 1.7965511794019045, 37.600144110473025, 143.21348101031867, 56.32646753988851, 151.5636739934736, 144.2922083163778, 66.78068188009301, 19.037360220366015, 136.98530859283522, 28.404181857498227, 29.606202358835013, 98.56845931773636, 83.93557695100773, 21.851356605014974, 45.6343774318126, 173.22649548858521, 49.13034835645033, 54.37546262816312, 134.20833566473613, 0.0, 81.05132542754129, 79.2442067846806, 49.49283474964103, 125.32374737897803, 35.21272144711874, 91.56364880046172, 226.35286862812967, 96.69266995630386, 395.23420922259726, 244.49689493444328, 221.38073290441588, 243.18559975766607, 3.5032948239538326, 103.61294396273864, 54.172399920490534, 35.99044377700624, 163.83163834230743, 186.0180369226313, 4.990922414148119, 14.563395482744117, 253.34351513719832, 37.33372385757743, 117.76808763095124, 21.946444734886327, 236.41026100294098, 27.12497999948911, 70.22061056262159, 1.4350642242100187, 139.74638990784362, 94.11877508592872, 5.365419848713982, 25.37192222179128, 71.23798029827535, 16.067722888287655, 230.9954430174456, 62.153138157039955, 10.821436876828578, 110.53467986133872, 32.731257827477094, 60.34465497485964, 34.19162012675649, 10.221043856250907, 5.131560787536821, 5.828921896720858]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5015531279254546, "mean_inference_ms": 1.2780859233548973, "mean_action_processing_ms": 0.21321796327120088, "mean_env_wait_ms": 0.16976180295160628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037273168563842773, "StateBufferConnector_ms": 0.0040149688720703125, "ViewRequirementAgentConnector_ms": 0.0898054838180542}, "num_episodes": 27, "episode_return_max": 224.16746782350071, "episode_return_min": -72.08728279833542, "episode_return_mean": 26.59375738896777, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 408.2397523213546, "num_env_steps_trained_throughput_per_sec": 408.2397523213546, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 9712.318, "restore_workers_time_ms": 0.01, "training_step_time_ms": 9712.281, "sample_time_ms": 1066.688, "learn_time_ms": 8631.709, "learn_throughput": 463.408, "synch_weights_time_ms": 12.84}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "74486_00000", "date": "2024-08-16_14-57-46", "timestamp": 1723800466, "time_this_iter_s": 9.802309036254883, "time_total_s": 135.4249711036682, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39737f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.4249711036682, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 78.33571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.300049952823649, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2639142714480243, "policy_loss": -0.009656201380615433, "vf_loss": 2.2720350797214204, "vf_explained_var": -0.007290794515105152, "kl": 0.0076769577932468015, "entropy": 1.5241964673239088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2516892987268942, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4345089499912564, "policy_loss": -0.008813399357583235, "vf_loss": 2.4418069731621515, "vf_explained_var": 0.0011000942300867151, "kl": 0.007576868903653967, "entropy": 1.46826740995286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 224.16746782350071, "episode_reward_min": -60.71174928272058, "episode_reward_mean": 24.484834132949622, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -578.8840374749254, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.325317725661964, "predator_policy": 606.7529367346137}, "policy_reward_mean": {"prey_policy": -106.53444070325955, "predator_policy": 118.77685776973422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.650295560477595, 33.95999999999969, 82.15019867706788, 11.89999999999994, 22.928721147948508, 22.83000000000044, -26.640454945683654, -18.98599570625387, 224.16746782350071, -11.477467810499851, 79.0132887645915, 150.22730985643597, 13.03631295866065, 37.919999999999455, 61.10994094734688, 23.019708002796047, 54.92126877767691, 13.969999999999951, 21.230703193716444, -9.82310933900487, 52.90939901552114, 7.289999999999967, 21.520000000000547, 39.217210201393485, 38.14468751139975, 30.601097082299344, 3.539999999999968, -21.72447082839723, 103.62509650355395, 16.955425938349777, 62.094901377319985, 13.198540256457802, 6.589999999999957, 72.34994796978843, 8.30999999999996, 69.92266241950372, 13.048313200630513, -23.82621747049975, 91.21780782108326, 36.379999999999654, 21.61000000000054, 40.5827740573296, 19.180000000000252, 5.818569135443918, -57.81647039759528, 6.029999999999944, 23.794532837571886, -16.984430604944826, 5.3899999999999695, -0.9500049119057825, 35.53999999999937, 16.659845973267927, 4.959999999999937, 19.00931247481769, 17.433059576859137, 21.350000000000506, 5.152272984755436, 21.240745696607924, 28.855246004873063, 8.589999999999923, 37.056086845249425, 60.991487638492245, 20.173764426059762, 43.08395800118911, 13.957256402322692, 58.27640145955345, 25.540000000000553, 11.075180114478941, 4.209999999999958, 20.720000000000546, 12.1858569075076, 11.126923351469507, 5.0378257479074025, 11.639999999999967, 11.379999999999928, 3.859999999999961, -7.029330585521933, -4.350179037754714, 5.559999999999926, 40.79156389617599, 8.789999999999928, 3.93999999999996, 9.649999999999922, 43.19966363072345, 44.25999999999943, 4.439999999999948, 61.12922472623909, 6.7599999999999225, 9.709999999999921, 3.909999999999959, -60.71174928272058, 3.8099999999999614, 44.17771159264948, 3.5499999999999643, 5.880821813614897, 58.285261203520925, 4.279999999999952, 34.62829755477245, 97.62934515477158, 3.95999999999996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-35.66758772138005, -62.28027442312835, -49.83166550810293, -93.88200561571081, -427.1296161427101, -578.8840374749254, -276.38674837466533, -91.33633078731307, -277.94370020806633, -197.20998312386973, -30.239867664173726, -290.7577108432828, -96.57177167608131, -114.40380076785604, -202.0017906839265, -89.82017481234962, -12.584786670426608, -305.6471803891635, -279.60365452648745, -129.21654250339128, -167.76696000431468, -381.64629982540924, -256.383149766195, -382.1268541425206, -357.7151365362152, -74.08915472449932, -51.30914768244983, -73.90051578527553, -220.27920365947932, -170.0181681982058, -110.89962628779988, -126.88600607740793, -139.68128479826885, -46.82764095847359, -176.55190588325797, -77.05643384907924, -200.48700541203104, -0.17776465387785656, -20.098050621256977, -73.7904963325672, -106.839404756343, -88.55401300851364, -204.36956380418172, -36.60831249674415, -12.065080939581543, -113.13261955970471, -259.6093502691585, -62.377904743710126, -2.063405126962242, -32.02524267484515, -50.32232397130713, -98.34854082408917, -129.09131970279586, -51.01237033141064, -156.21955415301517, -195.4302563373209, -345.6851056235001, -29.761974273839638, -130.17325425252463, -8.61446061781662, -6.6181978395263314, -404.5343227153099, -80.17719951497352, -29.42519075002677, -458.5374749243531, -13.016091399590929, -106.45549005112737, -183.56675232592931, -179.67446399511206, -59.424774387439435, -21.40093088658891, -205.09022799698155, -381.7553371677279, -9.765181557654252, -213.26415558573555, -201.02859966542027, -163.80064597539936, -204.20630424375864, -566.0444472077209, -22.428472219584474, -5.64650261510231, -23.448303316370126, -158.65360390942385, -118.33481632262153, -115.25156587468616, -79.55678584429171, -14.72546481964734, 0.41301571774252127, -117.00489453810292, -73.5211561808458, -102.23559351407356, -262.56462004619806, -50.62565606710644, -46.608108584821366, -29.001414262059924, -49.36863757783299, -17.541911650192535, -185.98658895856417, -60.02296108810217, -181.31918048141833, 27.325317725661964, -31.18201301553671, -144.92677760393642, -37.95332497300459, -184.79240764721132, -106.10347466264005, -68.8087296256413, 2.0000000000000013, -120.12871324712809, -27.827717626345365, -34.347056258092906, -72.47760541847789, -82.2555769510076, -18.37908362025922, -162.8216013696294, -34.798525854162804, -55.29457032169395, -19.355994658047052, -40.76805940942013, -84.85027625531582, -103.25350526878476, -19.98594009818676, -12.802669025328132, -101.0224254647974, -106.40242935471758, -0.20017646680273327, -157.07205258843996, -122.88952799480536, -368.04079212056223, -257.73305563415784, -225.6035206235906, -180.68641057893996, 20.25670517604644, -101.83294396273773, -76.45243229113967, -2.6352312918780347, -162.17163834230894, -183.4680369226327, 13.809077585851844, -12.643395482744157, -19.120725579176494, -259.3706565080925, -44.35202645595793, -84.23558255841039, -239.937032439991, -18.560382814532524, -23.877974832490338, -36.13769995434109, -137.08638990784513, -85.3987750859278, -3.395419848714023, -23.481922221790988, -29.000905643444007, -65.33412812863955, -88.55430072145606, -208.94445949078442, -6.901436876828619, -108.89467986133789, -31.96733830896862, -20.31701059719152, -28.34162012675626, -7.281043856250948, -3.161560787536862, -3.8589218967209, -29.10942650450774, -99.27932579557555, -81.12414783043042, -16.442616815847895, 17.453366397978353, -122.40973875669204, -72.31462852587384, -99.09890101461758, -74.29905453702074, 0.30804669790883116, -10.908028562507752, -28.14107790597933, -50.526443211288125, -20.97976310223969, -25.151699211452428, 2.0000000000000013, -150.89867712130743, -262.17324564135373, -51.99476064629936, -10.941588745556933, -16.70985800152901, -25.485728621961794, -79.77504344753105, -42.15214341350473, -3.660563207519921, 2.0000000000000013, -176.4455682733856, 1.5586235578775283, -54.44042040970966, -186.18591256148792, -64.22623277541821, -80.5721132193741, -47.15804248704711, -241.99747528343, -7.188355295327716, 0.28409259247081237], "policy_predator_policy_reward": [45.71880601477013, 71.87935169021527, 51.651665508102575, 126.02200561571127, 606.7529367346137, 481.4109155600882, 277.7167483746641, 101.90633078731388, 259.94445880561153, 238.13794567427072, 51.799867664173966, 292.0277108432816, 133.64169918883616, 50.69341830941871, 211.79811446470762, 61.037855325313814, 338.7706516615896, 203.62878322150203, 301.925832274067, 95.41689694530953, 329.6968645796462, 298.729684014668, 478.9312655476734, 309.80604821747744, 361.3897390217847, 83.45086519759089, 157.3347217770612, 5.794941690664336, 169.0695443652248, 282.3377684398054, 107.5507419048651, 153.2545984631395, 71.22179235183793, 170.20840218258033, 177.98190588325684, 89.59643384907967, 170.79014116117028, 51.105332098453594, 69.37420263302734, 14.69123498179323, 67.06258988426727, 181.2402268961122, 207.67503903677655, 40.59283726414798, 30.815080939581506, 115.90261955970561, 91.0404920536533, 270.1639731606079, 4.043405126962204, 68.18993018624515, 138.4508980612437, 40.82106381645177, 130.8013197027943, 52.84237033141027, 308.48847269261813, 21.436866969317723, 330.29894929058986, 148.77322711030217, 89.56194263675717, 66.18119817193246, 75.80182543867213, 397.4455964934838, 69.5774332189036, 53.22349730255572, 462.1874749243525, 15.95609139959089, 131.89543802091575, 230.47675232592854, 186.20446399511184, 61.204774387439116, 193.4642500919422, 102.94957121112961, 382.775337167727, 21.793494758284776, 115.42720417214768, 275.03933360850743, 329.5809118154246, 129.6438462248126, 563.4228606306839, 61.43005879662075, 14.52650261510227, 36.1783033163704, 123.26673145083545, 194.30446283854084, 116.80156587468693, 97.18678584429254, 8.990295610845026, 11.14072262650374, 121.87612405112816, 10.833456270227616, 103.8855935140744, 266.9446200461968, 87.44071742447875, 33.58758006501972, 57.684731682885776, 3.700889552061696, 136.5836927011679, 72.33480790758877, 78.21930517199232, 162.17283148562075, 1.7965511794019045, 37.600144110473025, 143.21348101031867, 56.32646753988851, 151.5636739934736, 144.2922083163778, 66.78068188009301, 19.037360220366015, 136.98530859283522, 28.404181857498227, 29.606202358835013, 98.56845931773636, 83.93557695100773, 21.851356605014974, 45.6343774318126, 173.22649548858521, 49.13034835645033, 54.37546262816312, 134.20833566473613, 0.0, 81.05132542754129, 79.2442067846806, 49.49283474964103, 125.32374737897803, 35.21272144711874, 91.56364880046172, 226.35286862812967, 96.69266995630386, 395.23420922259726, 244.49689493444328, 221.38073290441588, 243.18559975766607, 3.5032948239538326, 103.61294396273864, 54.172399920490534, 35.99044377700624, 163.83163834230743, 186.0180369226313, 4.990922414148119, 14.563395482744117, 253.34351513719832, 37.33372385757743, 117.76808763095124, 21.946444734886327, 236.41026100294098, 27.12497999948911, 70.22061056262159, 1.4350642242100187, 139.74638990784362, 94.11877508592872, 5.365419848713982, 25.37192222179128, 71.23798029827535, 16.067722888287655, 230.9954430174456, 62.153138157039955, 10.821436876828578, 110.53467986133872, 32.731257827477094, 60.34465497485964, 34.19162012675649, 10.221043856250907, 5.131560787536821, 5.828921896720858, 36.91942650450789, 101.11932579557649, 66.88209045636937, 73.88433782063417, 21.11663360202187, 128.09973875669203, 40.93456924615456, 134.9189602943375, 62.62986897181796, 72.4903635935347, 9.746794390713209, 36.06231207777413, 58.30644321128777, 22.909763102239992, 27.061699211452726, 0.0, 294.6864423414779, 57.673731138460774, 53.85476064629899, 12.891588745556891, 49.96695395947278, 36.40634425666793, 81.49504344753193, 43.982143413504474, 5.5681664659397985, 1.9732185551950607, 168.8695691155992, 64.30263680342915, 55.79254710417262, 189.11378586702332, 42.204098063264254, 137.22254548630235, 208.2270453796936, 178.55781754555204, 9.158355295327674, 1.7059074075291891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5058124880472206, "mean_inference_ms": 1.290135868102653, "mean_action_processing_ms": 0.21464476034978308, "mean_env_wait_ms": 0.17107954533553552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037947893142700195, "StateBufferConnector_ms": 0.004093527793884277, "ViewRequirementAgentConnector_ms": 0.09463953971862793}, "num_episodes": 18, "episode_return_max": 224.16746782350071, "episode_return_min": -60.71174928272058, "episode_return_mean": 24.484834132949622, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.5962996165849, "num_env_steps_trained_throughput_per_sec": 406.5962996165849, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 9769.078, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9769.04, "sample_time_ms": 1074.763, "learn_time_ms": 8680.22, "learn_throughput": 460.818, "synch_weights_time_ms": 13.0}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "74486_00000", "date": "2024-08-16_14-57-55", "timestamp": 1723800475, "time_this_iter_s": 9.841341972351074, "time_total_s": 145.2663130760193, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39737f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.2663130760193, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 30.342857142857138, "ram_util_percent": 78.27857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0717784516079716, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8824955432503312, "policy_loss": -0.009849478909992194, "vf_loss": 1.8901831193891152, "vf_explained_var": -0.004207110089599771, "kl": 0.010809518128417116, "entropy": 1.5040090931155694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8070754446838267, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.590441603824575, "policy_loss": -0.010399798006213531, "vf_loss": 1.5995314351780705, "vf_explained_var": -0.00014381594758815867, "kl": 0.006549834751155483, "entropy": 1.4674034079546652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 103.62509650355395, "episode_reward_min": -239.90544536943133, "episode_reward_mean": 14.051150113065844, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -566.0444472077209, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.325317725661964, "predator_policy": 765.2882459651626}, "policy_reward_mean": {"prey_policy": -94.9076740057085, "predator_policy": 101.9332490622413}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.230703193716444, -9.82310933900487, 52.90939901552114, 7.289999999999967, 21.520000000000547, 39.217210201393485, 38.14468751139975, 30.601097082299344, 3.539999999999968, -21.72447082839723, 103.62509650355395, 16.955425938349777, 62.094901377319985, 13.198540256457802, 6.589999999999957, 72.34994796978843, 8.30999999999996, 69.92266241950372, 13.048313200630513, -23.82621747049975, 91.21780782108326, 36.379999999999654, 21.61000000000054, 40.5827740573296, 19.180000000000252, 5.818569135443918, -57.81647039759528, 6.029999999999944, 23.794532837571886, -16.984430604944826, 5.3899999999999695, -0.9500049119057825, 35.53999999999937, 16.659845973267927, 4.959999999999937, 19.00931247481769, 17.433059576859137, 21.350000000000506, 5.152272984755436, 21.240745696607924, 28.855246004873063, 8.589999999999923, 37.056086845249425, 60.991487638492245, 20.173764426059762, 43.08395800118911, 13.957256402322692, 58.27640145955345, 25.540000000000553, 11.075180114478941, 4.209999999999958, 20.720000000000546, 12.1858569075076, 11.126923351469507, 5.0378257479074025, 11.639999999999967, 11.379999999999928, 3.859999999999961, -7.029330585521933, -4.350179037754714, 5.559999999999926, 40.79156389617599, 8.789999999999928, 3.93999999999996, 9.649999999999922, 43.19966363072345, 44.25999999999943, 4.439999999999948, 61.12922472623909, 6.7599999999999225, 9.709999999999921, 3.909999999999959, -60.71174928272058, 3.8099999999999614, 44.17771159264948, 3.5499999999999643, 5.880821813614897, 58.285261203520925, 4.279999999999952, 34.62829755477245, 97.62934515477158, 3.95999999999996, 3.8299999999999605, 5.829999999999921, 43.10337087534021, 3.779999999999959, 22.48000000000053, 26.932505495160168, 13.799999999999919, 3.4099999999999735, -2.0740563346298897, -202.49491735966072, 11.520734758908072, 3.7799999999999634, 13.77999999999992, -239.90544536943133, 26.46000000000048, 9.689999999999921, 2.6799999999999775, 3.7299999999999622], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-200.48700541203104, -0.17776465387785656, -20.098050621256977, -73.7904963325672, -106.839404756343, -88.55401300851364, -204.36956380418172, -36.60831249674415, -12.065080939581543, -113.13261955970471, -259.6093502691585, -62.377904743710126, -2.063405126962242, -32.02524267484515, -50.32232397130713, -98.34854082408917, -129.09131970279586, -51.01237033141064, -156.21955415301517, -195.4302563373209, -345.6851056235001, -29.761974273839638, -130.17325425252463, -8.61446061781662, -6.6181978395263314, -404.5343227153099, -80.17719951497352, -29.42519075002677, -458.5374749243531, -13.016091399590929, -106.45549005112737, -183.56675232592931, -179.67446399511206, -59.424774387439435, -21.40093088658891, -205.09022799698155, -381.7553371677279, -9.765181557654252, -213.26415558573555, -201.02859966542027, -163.80064597539936, -204.20630424375864, -566.0444472077209, -22.428472219584474, -5.64650261510231, -23.448303316370126, -158.65360390942385, -118.33481632262153, -115.25156587468616, -79.55678584429171, -14.72546481964734, 0.41301571774252127, -117.00489453810292, -73.5211561808458, -102.23559351407356, -262.56462004619806, -50.62565606710644, -46.608108584821366, -29.001414262059924, -49.36863757783299, -17.541911650192535, -185.98658895856417, -60.02296108810217, -181.31918048141833, 27.325317725661964, -31.18201301553671, -144.92677760393642, -37.95332497300459, -184.79240764721132, -106.10347466264005, -68.8087296256413, 2.0000000000000013, -120.12871324712809, -27.827717626345365, -34.347056258092906, -72.47760541847789, -82.2555769510076, -18.37908362025922, -162.8216013696294, -34.798525854162804, -55.29457032169395, -19.355994658047052, -40.76805940942013, -84.85027625531582, -103.25350526878476, -19.98594009818676, -12.802669025328132, -101.0224254647974, -106.40242935471758, -0.20017646680273327, -157.07205258843996, -122.88952799480536, -368.04079212056223, -257.73305563415784, -225.6035206235906, -180.68641057893996, 20.25670517604644, -101.83294396273773, -76.45243229113967, -2.6352312918780347, -162.17163834230894, -183.4680369226327, 13.809077585851844, -12.643395482744157, -19.120725579176494, -259.3706565080925, -44.35202645595793, -84.23558255841039, -239.937032439991, -18.560382814532524, -23.877974832490338, -36.13769995434109, -137.08638990784513, -85.3987750859278, -3.395419848714023, -23.481922221790988, -29.000905643444007, -65.33412812863955, -88.55430072145606, -208.94445949078442, -6.901436876828619, -108.89467986133789, -31.96733830896862, -20.31701059719152, -28.34162012675626, -7.281043856250948, -3.161560787536862, -3.8589218967209, -29.10942650450774, -99.27932579557555, -81.12414783043042, -16.442616815847895, 17.453366397978353, -122.40973875669204, -72.31462852587384, -99.09890101461758, -74.29905453702074, 0.30804669790883116, -10.908028562507752, -28.14107790597933, -50.526443211288125, -20.97976310223969, -25.151699211452428, 2.0000000000000013, -150.89867712130743, -262.17324564135373, -51.99476064629936, -10.941588745556933, -16.70985800152901, -25.485728621961794, -79.77504344753105, -42.15214341350473, -3.660563207519921, 2.0000000000000013, -176.4455682733856, 1.5586235578775283, -54.44042040970966, -186.18591256148792, -64.22623277541821, -80.5721132193741, -47.15804248704711, -241.99747528343, -7.188355295327716, 0.28409259247081237, -4.874400796202878, -54.86353273330357, -37.03228751953536, 0.4212496216697507, -220.58483600570665, -37.26260487539762, -111.78016713295057, 2.0000000000000013, -28.367681034397204, -63.51151899438239, -50.97779659466182, -0.469717775906207, -1.9211901839333216, -8.404107585746504, -120.5693963124207, -83.03420251314209, -219.19154058163232, -110.08814369605741, -547.883232380687, -466.4821007741289, -6.724125560809835, -48.27843523150369, -19.764770509166755, -24.83984294339474, 8.049762553349334, -56.02647710473495, -526.3548004253597, -476.814697230562, -23.279187588673224, -47.327741697416094, -39.404200958108326, -55.54360922870282, -185.8446368446692, -405.16709419261247, -1.6809548332838218, -55.30535892147952], "policy_predator_policy_reward": [170.79014116117028, 51.105332098453594, 69.37420263302734, 14.69123498179323, 67.06258988426727, 181.2402268961122, 207.67503903677655, 40.59283726414798, 30.815080939581506, 115.90261955970561, 91.0404920536533, 270.1639731606079, 4.043405126962204, 68.18993018624515, 138.4508980612437, 40.82106381645177, 130.8013197027943, 52.84237033141027, 308.48847269261813, 21.436866969317723, 330.29894929058986, 148.77322711030217, 89.56194263675717, 66.18119817193246, 75.80182543867213, 397.4455964934838, 69.5774332189036, 53.22349730255572, 462.1874749243525, 15.95609139959089, 131.89543802091575, 230.47675232592854, 186.20446399511184, 61.204774387439116, 193.4642500919422, 102.94957121112961, 382.775337167727, 21.793494758284776, 115.42720417214768, 275.03933360850743, 329.5809118154246, 129.6438462248126, 563.4228606306839, 61.43005879662075, 14.52650261510227, 36.1783033163704, 123.26673145083545, 194.30446283854084, 116.80156587468693, 97.18678584429254, 8.990295610845026, 11.14072262650374, 121.87612405112816, 10.833456270227616, 103.8855935140744, 266.9446200461968, 87.44071742447875, 33.58758006501972, 57.684731682885776, 3.700889552061696, 136.5836927011679, 72.33480790758877, 78.21930517199232, 162.17283148562075, 1.7965511794019045, 37.600144110473025, 143.21348101031867, 56.32646753988851, 151.5636739934736, 144.2922083163778, 66.78068188009301, 19.037360220366015, 136.98530859283522, 28.404181857498227, 29.606202358835013, 98.56845931773636, 83.93557695100773, 21.851356605014974, 45.6343774318126, 173.22649548858521, 49.13034835645033, 54.37546262816312, 134.20833566473613, 0.0, 81.05132542754129, 79.2442067846806, 49.49283474964103, 125.32374737897803, 35.21272144711874, 91.56364880046172, 226.35286862812967, 96.69266995630386, 395.23420922259726, 244.49689493444328, 221.38073290441588, 243.18559975766607, 3.5032948239538326, 103.61294396273864, 54.172399920490534, 35.99044377700624, 163.83163834230743, 186.0180369226313, 4.990922414148119, 14.563395482744117, 253.34351513719832, 37.33372385757743, 117.76808763095124, 21.946444734886327, 236.41026100294098, 27.12497999948911, 70.22061056262159, 1.4350642242100187, 139.74638990784362, 94.11877508592872, 5.365419848713982, 25.37192222179128, 71.23798029827535, 16.067722888287655, 230.9954430174456, 62.153138157039955, 10.821436876828578, 110.53467986133872, 32.731257827477094, 60.34465497485964, 34.19162012675649, 10.221043856250907, 5.131560787536821, 5.828921896720858, 36.91942650450789, 101.11932579557649, 66.88209045636937, 73.88433782063417, 21.11663360202187, 128.09973875669203, 40.93456924615456, 134.9189602943375, 62.62986897181796, 72.4903635935347, 9.746794390713209, 36.06231207777413, 58.30644321128777, 22.909763102239992, 27.061699211452726, 0.0, 294.6864423414779, 57.673731138460774, 53.85476064629899, 12.891588745556891, 49.96695395947278, 36.40634425666793, 81.49504344753193, 43.982143413504474, 5.5681664659397985, 1.9732185551950607, 168.8695691155992, 64.30263680342915, 55.79254710417262, 189.11378586702332, 42.204098063264254, 137.22254548630235, 208.2270453796936, 178.55781754555204, 9.158355295327674, 1.7059074075291891, 6.854400796202836, 56.713532733303204, 40.87228751953499, 1.5687503783302508, 146.8766406398928, 154.07417111655076, 113.56016713295148, 0.0, 0.0, 114.35920002878045, 33.702594667215834, 44.67742519851138, 10.185716337826516, 13.93958143185323, 122.23939631242155, 84.77420251314297, 304.24785938082755, 22.957768562231646, 765.2882459651626, 46.582169829991564, 48.21966671453941, 18.30362883668186, 8.164982491864748, 40.21963096069732, 1.746277509165812, 60.01043704221939, 673.0974936841152, 90.16655860237458, 92.64319261636089, 4.423736669728425, 47.224200958107964, 57.41360922870245, 187.42463684466776, 406.26709419261226, 3.6609548332837867, 57.055358921479176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5082477692608084, "mean_inference_ms": 1.297089516712673, "mean_action_processing_ms": 0.2152728269187299, "mean_env_wait_ms": 0.17182984350516725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037851333618164062, "StateBufferConnector_ms": 0.004091024398803711, "ViewRequirementAgentConnector_ms": 0.09416604042053223}, "num_episodes": 18, "episode_return_max": 103.62509650355395, "episode_return_min": -239.90544536943133, "episode_return_mean": 14.051150113065844, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.8022702586017, "num_env_steps_trained_throughput_per_sec": 428.8022702586017, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 9751.674, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9751.636, "sample_time_ms": 1072.584, "learn_time_ms": 8664.87, "learn_throughput": 461.634, "synch_weights_time_ms": 13.094}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "74486_00000", "date": "2024-08-16_14-58-05", "timestamp": 1723800485, "time_this_iter_s": 9.332281827926636, "time_total_s": 154.59859490394592, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3972ebe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 154.59859490394592, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 28.400000000000002, "ram_util_percent": 78.17142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0074478960699504, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.05484193736914, "policy_loss": -0.009281918686129665, "vf_loss": 2.0620852504457745, "vf_explained_var": -0.0028181005722631223, "kl": 0.010192984828754158, "entropy": 1.4920359635479237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9554724690617707, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8465974668346385, "policy_loss": -0.009655151143916465, "vf_loss": 1.8548089560692904, "vf_explained_var": 0.002031035997249462, "kl": 0.0072183089712599315, "entropy": 1.45185763034871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 97.62934515477158, "episode_reward_min": -446.13945374100587, "episode_reward_mean": 6.79649170234349, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -738.6507788672719, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.325317725661964, "predator_policy": 851.0815715564548}, "policy_reward_mean": {"prey_policy": -91.18391784941956, "predator_policy": 94.58216370059122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.048313200630513, -23.82621747049975, 91.21780782108326, 36.379999999999654, 21.61000000000054, 40.5827740573296, 19.180000000000252, 5.818569135443918, -57.81647039759528, 6.029999999999944, 23.794532837571886, -16.984430604944826, 5.3899999999999695, -0.9500049119057825, 35.53999999999937, 16.659845973267927, 4.959999999999937, 19.00931247481769, 17.433059576859137, 21.350000000000506, 5.152272984755436, 21.240745696607924, 28.855246004873063, 8.589999999999923, 37.056086845249425, 60.991487638492245, 20.173764426059762, 43.08395800118911, 13.957256402322692, 58.27640145955345, 25.540000000000553, 11.075180114478941, 4.209999999999958, 20.720000000000546, 12.1858569075076, 11.126923351469507, 5.0378257479074025, 11.639999999999967, 11.379999999999928, 3.859999999999961, -7.029330585521933, -4.350179037754714, 5.559999999999926, 40.79156389617599, 8.789999999999928, 3.93999999999996, 9.649999999999922, 43.19966363072345, 44.25999999999943, 4.439999999999948, 61.12922472623909, 6.7599999999999225, 9.709999999999921, 3.909999999999959, -60.71174928272058, 3.8099999999999614, 44.17771159264948, 3.5499999999999643, 5.880821813614897, 58.285261203520925, 4.279999999999952, 34.62829755477245, 97.62934515477158, 3.95999999999996, 3.8299999999999605, 5.829999999999921, 43.10337087534021, 3.779999999999959, 22.48000000000053, 26.932505495160168, 13.799999999999919, 3.4099999999999735, -2.0740563346298897, -202.49491735966072, 11.520734758908072, 3.7799999999999634, 13.77999999999992, -239.90544536943133, 26.46000000000048, 9.689999999999921, 2.6799999999999775, 3.7299999999999622, 3.9099999999999593, 3.859999999999962, 10.489999999999933, 13.809999999999919, 26.400000000000535, 9.600774922465973, 8.119999999999933, -446.13945374100587, 5.499999999999925, 5.659999999999924, -1.5980050424221959, -3.9571870326804426, 6.559999999999922, 3.1099999999999763, 50.267496206205784, 14.709999999999916, 49.15335038088684, 51.02927453621653], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-381.7553371677279, -9.765181557654252, -213.26415558573555, -201.02859966542027, -163.80064597539936, -204.20630424375864, -566.0444472077209, -22.428472219584474, -5.64650261510231, -23.448303316370126, -158.65360390942385, -118.33481632262153, -115.25156587468616, -79.55678584429171, -14.72546481964734, 0.41301571774252127, -117.00489453810292, -73.5211561808458, -102.23559351407356, -262.56462004619806, -50.62565606710644, -46.608108584821366, -29.001414262059924, -49.36863757783299, -17.541911650192535, -185.98658895856417, -60.02296108810217, -181.31918048141833, 27.325317725661964, -31.18201301553671, -144.92677760393642, -37.95332497300459, -184.79240764721132, -106.10347466264005, -68.8087296256413, 2.0000000000000013, -120.12871324712809, -27.827717626345365, -34.347056258092906, -72.47760541847789, -82.2555769510076, -18.37908362025922, -162.8216013696294, -34.798525854162804, -55.29457032169395, -19.355994658047052, -40.76805940942013, -84.85027625531582, -103.25350526878476, -19.98594009818676, -12.802669025328132, -101.0224254647974, -106.40242935471758, -0.20017646680273327, -157.07205258843996, -122.88952799480536, -368.04079212056223, -257.73305563415784, -225.6035206235906, -180.68641057893996, 20.25670517604644, -101.83294396273773, -76.45243229113967, -2.6352312918780347, -162.17163834230894, -183.4680369226327, 13.809077585851844, -12.643395482744157, -19.120725579176494, -259.3706565080925, -44.35202645595793, -84.23558255841039, -239.937032439991, -18.560382814532524, -23.877974832490338, -36.13769995434109, -137.08638990784513, -85.3987750859278, -3.395419848714023, -23.481922221790988, -29.000905643444007, -65.33412812863955, -88.55430072145606, -208.94445949078442, -6.901436876828619, -108.89467986133789, -31.96733830896862, -20.31701059719152, -28.34162012675626, -7.281043856250948, -3.161560787536862, -3.8589218967209, -29.10942650450774, -99.27932579557555, -81.12414783043042, -16.442616815847895, 17.453366397978353, -122.40973875669204, -72.31462852587384, -99.09890101461758, -74.29905453702074, 0.30804669790883116, -10.908028562507752, -28.14107790597933, -50.526443211288125, -20.97976310223969, -25.151699211452428, 2.0000000000000013, -150.89867712130743, -262.17324564135373, -51.99476064629936, -10.941588745556933, -16.70985800152901, -25.485728621961794, -79.77504344753105, -42.15214341350473, -3.660563207519921, 2.0000000000000013, -176.4455682733856, 1.5586235578775283, -54.44042040970966, -186.18591256148792, -64.22623277541821, -80.5721132193741, -47.15804248704711, -241.99747528343, -7.188355295327716, 0.28409259247081237, -4.874400796202878, -54.86353273330357, -37.03228751953536, 0.4212496216697507, -220.58483600570665, -37.26260487539762, -111.78016713295057, 2.0000000000000013, -28.367681034397204, -63.51151899438239, -50.97779659466182, -0.469717775906207, -1.9211901839333216, -8.404107585746504, -120.5693963124207, -83.03420251314209, -219.19154058163232, -110.08814369605741, -547.883232380687, -466.4821007741289, -6.724125560809835, -48.27843523150369, -19.764770509166755, -24.83984294339474, 8.049762553349334, -56.02647710473495, -526.3548004253597, -476.814697230562, -23.279187588673224, -47.327741697416094, -39.404200958108326, -55.54360922870282, -185.8446368446692, -405.16709419261247, -1.6809548332838218, -55.30535892147952, 2.0000000000000013, -30.59622459435762, -17.697695523311776, -14.341520834494805, -193.8248634895398, -3.5438194939219443, -4.386475550167761, -1.3766539655903751, 23.196025204896724, -96.38019890167973, -33.81713577444979, -6.409909712935725, -382.5107516685789, -7.135912331204626, -738.6507788672719, -558.5702464301896, 3.9799999999999582, -162.96765383834, -12.62638889905262, -78.08203766027827, -48.733728908572644, -23.220282640068618, -102.21810006296742, -18.327007309988748, -33.51852976585342, -94.43933466172406, -271.1943302896028, -42.37625835206038, -60.953172389692114, -85.41882021089886, 8.131224889215696, -32.54809923974325, -108.74661698681773, -26.464232142394938, -144.95445900394276, -11.303270610688374], "policy_predator_policy_reward": [382.775337167727, 21.793494758284776, 115.42720417214768, 275.03933360850743, 329.5809118154246, 129.6438462248126, 563.4228606306839, 61.43005879662075, 14.52650261510227, 36.1783033163704, 123.26673145083545, 194.30446283854084, 116.80156587468693, 97.18678584429254, 8.990295610845026, 11.14072262650374, 121.87612405112816, 10.833456270227616, 103.8855935140744, 266.9446200461968, 87.44071742447875, 33.58758006501972, 57.684731682885776, 3.700889552061696, 136.5836927011679, 72.33480790758877, 78.21930517199232, 162.17283148562075, 1.7965511794019045, 37.600144110473025, 143.21348101031867, 56.32646753988851, 151.5636739934736, 144.2922083163778, 66.78068188009301, 19.037360220366015, 136.98530859283522, 28.404181857498227, 29.606202358835013, 98.56845931773636, 83.93557695100773, 21.851356605014974, 45.6343774318126, 173.22649548858521, 49.13034835645033, 54.37546262816312, 134.20833566473613, 0.0, 81.05132542754129, 79.2442067846806, 49.49283474964103, 125.32374737897803, 35.21272144711874, 91.56364880046172, 226.35286862812967, 96.69266995630386, 395.23420922259726, 244.49689493444328, 221.38073290441588, 243.18559975766607, 3.5032948239538326, 103.61294396273864, 54.172399920490534, 35.99044377700624, 163.83163834230743, 186.0180369226313, 4.990922414148119, 14.563395482744117, 253.34351513719832, 37.33372385757743, 117.76808763095124, 21.946444734886327, 236.41026100294098, 27.12497999948911, 70.22061056262159, 1.4350642242100187, 139.74638990784362, 94.11877508592872, 5.365419848713982, 25.37192222179128, 71.23798029827535, 16.067722888287655, 230.9954430174456, 62.153138157039955, 10.821436876828578, 110.53467986133872, 32.731257827477094, 60.34465497485964, 34.19162012675649, 10.221043856250907, 5.131560787536821, 5.828921896720858, 36.91942650450789, 101.11932579557649, 66.88209045636937, 73.88433782063417, 21.11663360202187, 128.09973875669203, 40.93456924615456, 134.9189602943375, 62.62986897181796, 72.4903635935347, 9.746794390713209, 36.06231207777413, 58.30644321128777, 22.909763102239992, 27.061699211452726, 0.0, 294.6864423414779, 57.673731138460774, 53.85476064629899, 12.891588745556891, 49.96695395947278, 36.40634425666793, 81.49504344753193, 43.982143413504474, 5.5681664659397985, 1.9732185551950607, 168.8695691155992, 64.30263680342915, 55.79254710417262, 189.11378586702332, 42.204098063264254, 137.22254548630235, 208.2270453796936, 178.55781754555204, 9.158355295327674, 1.7059074075291891, 6.854400796202836, 56.713532733303204, 40.87228751953499, 1.5687503783302508, 146.8766406398928, 154.07417111655076, 113.56016713295148, 0.0, 0.0, 114.35920002878045, 33.702594667215834, 44.67742519851138, 10.185716337826516, 13.93958143185323, 122.23939631242155, 84.77420251314297, 304.24785938082755, 22.957768562231646, 765.2882459651626, 46.582169829991564, 48.21966671453941, 18.30362883668186, 8.164982491864748, 40.21963096069732, 1.746277509165812, 60.01043704221939, 673.0974936841152, 90.16655860237458, 92.64319261636089, 4.423736669728425, 47.224200958107964, 57.41360922870245, 187.42463684466776, 406.26709419261226, 3.6609548332837867, 57.055358921479176, 0.0, 32.50622459435774, 19.627695523312077, 16.271520834494762, 202.34486348953843, 5.513819493921902, 6.35647555016772, 13.21665396559035, 1.5639747951035505, 98.02019890168057, 21.45568886405244, 28.37213154579877, 383.7407516685791, 14.025912331204585, 0.0, 851.0815715564548, 0.0, 164.48765383833862, 87.09816176667314, 9.270264792658583, 50.66372890857226, 19.692277597646747, 103.97810006296832, 12.609820277308662, 38.33852976585305, 96.17933466172495, 272.5243302896018, 44.15625835206009, 90.27429736835322, 106.36519143844441, 4.728775110784265, 34.39809923974292, 107.20809225269115, 77.15610725741006, 120.98304976146018, 86.30395438938685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.510695362198724, "mean_inference_ms": 1.3037450765300755, "mean_action_processing_ms": 0.2159844365405216, "mean_env_wait_ms": 0.17246105142224707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003851175308227539, "StateBufferConnector_ms": 0.0041615962982177734, "ViewRequirementAgentConnector_ms": 0.09617006778717041}, "num_episodes": 18, "episode_return_max": 97.62934515477158, "episode_return_min": -446.13945374100587, "episode_return_mean": 6.79649170234349, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.6392185623521, "num_env_steps_trained_throughput_per_sec": 386.6392185623521, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 9853.054, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9853.016, "sample_time_ms": 1075.297, "learn_time_ms": 8763.288, "learn_throughput": 456.45, "synch_weights_time_ms": 13.247}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "74486_00000", "date": "2024-08-16_14-58-15", "timestamp": 1723800495, "time_this_iter_s": 10.350718975067139, "time_total_s": 164.94931387901306, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39732d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 164.94931387901306, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 33.642857142857146, "ram_util_percent": 77.5142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9944139536568728, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.877657904322185, "policy_loss": -0.005791194158207093, "vf_loss": 4.882319743166525, "vf_explained_var": 0.0002426142415041646, "kl": 0.005646808320049984, "entropy": 1.4699636926095951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.832405516899452, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.130751482897965, "policy_loss": -0.010757978932892598, "vf_loss": 4.13919351277528, "vf_explained_var": 0.0037248253506958168, "kl": 0.01157976925725153, "entropy": 1.3992424133593444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 97.62934515477158, "episode_reward_min": -606.5118598919508, "episode_reward_mean": -10.59853902136214, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1175.1893449523932, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 23.196025204896724, "predator_policy": 1228.1315084919042}, "policy_reward_mean": {"prey_policy": -126.0519427155061, "predator_policy": 120.75267320482504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.855246004873063, 8.589999999999923, 37.056086845249425, 60.991487638492245, 20.173764426059762, 43.08395800118911, 13.957256402322692, 58.27640145955345, 25.540000000000553, 11.075180114478941, 4.209999999999958, 20.720000000000546, 12.1858569075076, 11.126923351469507, 5.0378257479074025, 11.639999999999967, 11.379999999999928, 3.859999999999961, -7.029330585521933, -4.350179037754714, 5.559999999999926, 40.79156389617599, 8.789999999999928, 3.93999999999996, 9.649999999999922, 43.19966363072345, 44.25999999999943, 4.439999999999948, 61.12922472623909, 6.7599999999999225, 9.709999999999921, 3.909999999999959, -60.71174928272058, 3.8099999999999614, 44.17771159264948, 3.5499999999999643, 5.880821813614897, 58.285261203520925, 4.279999999999952, 34.62829755477245, 97.62934515477158, 3.95999999999996, 3.8299999999999605, 5.829999999999921, 43.10337087534021, 3.779999999999959, 22.48000000000053, 26.932505495160168, 13.799999999999919, 3.4099999999999735, -2.0740563346298897, -202.49491735966072, 11.520734758908072, 3.7799999999999634, 13.77999999999992, -239.90544536943133, 26.46000000000048, 9.689999999999921, 2.6799999999999775, 3.7299999999999622, 3.9099999999999593, 3.859999999999962, 10.489999999999933, 13.809999999999919, 26.400000000000535, 9.600774922465973, 8.119999999999933, -446.13945374100587, 5.499999999999925, 5.659999999999924, -1.5980050424221959, -3.9571870326804426, 6.559999999999922, 3.1099999999999763, 50.267496206205784, 14.709999999999916, 49.15335038088684, 51.02927453621653, 3.8799999999999613, 3.879999999999961, 1.94999999999997, 5.659999999999925, -264.40996630123846, 2.7399999999999842, 35.74938053764505, -501.6415286309719, 22.679799609458673, 28.71648581870094, 32.88364180367548, 14.148820934420437, -34.102665317727016, -205.99586651719636, 3.7899999999999636, 19.600000000000534, 2.9199999999999746, -606.5118598919508, 3.9599999999999596, 16.67000000000005, -33.029204041957065, 11.77999999999992], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-55.29457032169395, -19.355994658047052, -40.76805940942013, -84.85027625531582, -103.25350526878476, -19.98594009818676, -12.802669025328132, -101.0224254647974, -106.40242935471758, -0.20017646680273327, -157.07205258843996, -122.88952799480536, -368.04079212056223, -257.73305563415784, -225.6035206235906, -180.68641057893996, 20.25670517604644, -101.83294396273773, -76.45243229113967, -2.6352312918780347, -162.17163834230894, -183.4680369226327, 13.809077585851844, -12.643395482744157, -19.120725579176494, -259.3706565080925, -44.35202645595793, -84.23558255841039, -239.937032439991, -18.560382814532524, -23.877974832490338, -36.13769995434109, -137.08638990784513, -85.3987750859278, -3.395419848714023, -23.481922221790988, -29.000905643444007, -65.33412812863955, -88.55430072145606, -208.94445949078442, -6.901436876828619, -108.89467986133789, -31.96733830896862, -20.31701059719152, -28.34162012675626, -7.281043856250948, -3.161560787536862, -3.8589218967209, -29.10942650450774, -99.27932579557555, -81.12414783043042, -16.442616815847895, 17.453366397978353, -122.40973875669204, -72.31462852587384, -99.09890101461758, -74.29905453702074, 0.30804669790883116, -10.908028562507752, -28.14107790597933, -50.526443211288125, -20.97976310223969, -25.151699211452428, 2.0000000000000013, -150.89867712130743, -262.17324564135373, -51.99476064629936, -10.941588745556933, -16.70985800152901, -25.485728621961794, -79.77504344753105, -42.15214341350473, -3.660563207519921, 2.0000000000000013, -176.4455682733856, 1.5586235578775283, -54.44042040970966, -186.18591256148792, -64.22623277541821, -80.5721132193741, -47.15804248704711, -241.99747528343, -7.188355295327716, 0.28409259247081237, -4.874400796202878, -54.86353273330357, -37.03228751953536, 0.4212496216697507, -220.58483600570665, -37.26260487539762, -111.78016713295057, 2.0000000000000013, -28.367681034397204, -63.51151899438239, -50.97779659466182, -0.469717775906207, -1.9211901839333216, -8.404107585746504, -120.5693963124207, -83.03420251314209, -219.19154058163232, -110.08814369605741, -547.883232380687, -466.4821007741289, -6.724125560809835, -48.27843523150369, -19.764770509166755, -24.83984294339474, 8.049762553349334, -56.02647710473495, -526.3548004253597, -476.814697230562, -23.279187588673224, -47.327741697416094, -39.404200958108326, -55.54360922870282, -185.8446368446692, -405.16709419261247, -1.6809548332838218, -55.30535892147952, 2.0000000000000013, -30.59622459435762, -17.697695523311776, -14.341520834494805, -193.8248634895398, -3.5438194939219443, -4.386475550167761, -1.3766539655903751, 23.196025204896724, -96.38019890167973, -33.81713577444979, -6.409909712935725, -382.5107516685789, -7.135912331204626, -738.6507788672719, -558.5702464301896, 3.9799999999999582, -162.96765383834, -12.62638889905262, -78.08203766027827, -48.733728908572644, -23.220282640068618, -102.21810006296742, -18.327007309988748, -33.51852976585342, -94.43933466172406, -271.1943302896028, -42.37625835206038, -60.953172389692114, -85.41882021089886, 8.131224889215696, -32.54809923974325, -108.74661698681773, -26.464232142394938, -144.95445900394276, -11.303270610688374, -23.41949537517771, -0.10983720604249039, -10.82380711807141, -17.838308819485572, -948.5987583067244, -33.44782934505212, -31.3696046962471, -82.74207280474292, -590.3636701386328, -484.7714457419087, -10.065995150794778, -568.5163998398054, -104.23665232534185, -31.275507650986828, -569.1581847351239, -884.5517814941392, -22.022931304880736, -130.4754144318091, -73.31858089194013, 2.0000000000000013, -22.864130888518233, -24.06368202526616, -1175.1893449523932, -1109.7299206887983, -95.14004212142565, -62.032630210032615, -876.7238905766131, -847.9930279410744, -41.963218446114126, -16.27130366858854, 0.18966986904673883, -50.06246602363143, -2.612879802117158, -428.83303778907094, -1065.8877359702149, -815.2932552196695, -5.759487920419708, 2.0000000000000013, -25.029831083443668, -14.523809683145263, -91.35001630963428, -104.79819659547233, -42.2916414979357, 6.949999999999958], "policy_predator_policy_reward": [49.13034835645033, 54.37546262816312, 134.20833566473613, 0.0, 81.05132542754129, 79.2442067846806, 49.49283474964103, 125.32374737897803, 35.21272144711874, 91.56364880046172, 226.35286862812967, 96.69266995630386, 395.23420922259726, 244.49689493444328, 221.38073290441588, 243.18559975766607, 3.5032948239538326, 103.61294396273864, 54.172399920490534, 35.99044377700624, 163.83163834230743, 186.0180369226313, 4.990922414148119, 14.563395482744117, 253.34351513719832, 37.33372385757743, 117.76808763095124, 21.946444734886327, 236.41026100294098, 27.12497999948911, 70.22061056262159, 1.4350642242100187, 139.74638990784362, 94.11877508592872, 5.365419848713982, 25.37192222179128, 71.23798029827535, 16.067722888287655, 230.9954430174456, 62.153138157039955, 10.821436876828578, 110.53467986133872, 32.731257827477094, 60.34465497485964, 34.19162012675649, 10.221043856250907, 5.131560787536821, 5.828921896720858, 36.91942650450789, 101.11932579557649, 66.88209045636937, 73.88433782063417, 21.11663360202187, 128.09973875669203, 40.93456924615456, 134.9189602943375, 62.62986897181796, 72.4903635935347, 9.746794390713209, 36.06231207777413, 58.30644321128777, 22.909763102239992, 27.061699211452726, 0.0, 294.6864423414779, 57.673731138460774, 53.85476064629899, 12.891588745556891, 49.96695395947278, 36.40634425666793, 81.49504344753193, 43.982143413504474, 5.5681664659397985, 1.9732185551950607, 168.8695691155992, 64.30263680342915, 55.79254710417262, 189.11378586702332, 42.204098063264254, 137.22254548630235, 208.2270453796936, 178.55781754555204, 9.158355295327674, 1.7059074075291891, 6.854400796202836, 56.713532733303204, 40.87228751953499, 1.5687503783302508, 146.8766406398928, 154.07417111655076, 113.56016713295148, 0.0, 0.0, 114.35920002878045, 33.702594667215834, 44.67742519851138, 10.185716337826516, 13.93958143185323, 122.23939631242155, 84.77420251314297, 304.24785938082755, 22.957768562231646, 765.2882459651626, 46.582169829991564, 48.21966671453941, 18.30362883668186, 8.164982491864748, 40.21963096069732, 1.746277509165812, 60.01043704221939, 673.0974936841152, 90.16655860237458, 92.64319261636089, 4.423736669728425, 47.224200958107964, 57.41360922870245, 187.42463684466776, 406.26709419261226, 3.6609548332837867, 57.055358921479176, 0.0, 32.50622459435774, 19.627695523312077, 16.271520834494762, 202.34486348953843, 5.513819493921902, 6.35647555016772, 13.21665396559035, 1.5639747951035505, 98.02019890168057, 21.45568886405244, 28.37213154579877, 383.7407516685791, 14.025912331204585, 0.0, 851.0815715564548, 0.0, 164.48765383833862, 87.09816176667314, 9.270264792658583, 50.66372890857226, 19.692277597646747, 103.97810006296832, 12.609820277308662, 38.33852976585305, 96.17933466172495, 272.5243302896018, 44.15625835206009, 90.27429736835322, 106.36519143844441, 4.728775110784265, 34.39809923974292, 107.20809225269115, 77.15610725741006, 120.98304976146018, 86.30395438938685, 25.309495375177956, 2.09983720604249, 11.214916889334868, 21.327199048222376, 948.6887583067246, 35.307829345051815, 33.27960469624695, 86.49207280474381, 87.52493806227265, 723.20021151703, 12.025995150794737, 569.2963998398054, 65.98310471963617, 105.27843579433905, 34.407306532474266, 917.6611310658172, 51.32941398230861, 123.84873136383796, 51.70512440892033, 48.329942301721005, 37.991106349484944, 41.820348367975306, 1174.7507294964626, 1124.3173570791498, 114.56670380921888, 8.503303204513601, 626.2507590348531, 892.4702929656391, 43.82321844611378, 18.201303668588842, 1.8003301309532627, 67.67246602363139, 4.592879802117116, 429.7730377890702, 1228.1315084919042, 46.53762280603209, 7.719487920419666, 0.0, 26.929831083443965, 29.293809683145277, 159.02898338707922, 4.09002547607281, 47.121641497935336, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5136364515052013, "mean_inference_ms": 1.31279837101458, "mean_action_processing_ms": 0.2174423630385081, "mean_env_wait_ms": 0.17317718596228113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036679506301879883, "StateBufferConnector_ms": 0.0029658079147338867, "ViewRequirementAgentConnector_ms": 0.09276962280273438}, "num_episodes": 22, "episode_return_max": 97.62934515477158, "episode_return_min": -606.5118598919508, "episode_return_mean": -10.59853902136214, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.05159781991057, "num_env_steps_trained_throughput_per_sec": 376.05159781991057, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 9968.524, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9968.486, "sample_time_ms": 1134.333, "learn_time_ms": 8819.644, "learn_throughput": 453.533, "synch_weights_time_ms": 13.317}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "74486_00000", "date": "2024-08-16_14-58-26", "timestamp": 1723800506, "time_this_iter_s": 10.639891147613525, "time_total_s": 175.5892050266266, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397330790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 175.5892050266266, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 37.266666666666666, "ram_util_percent": 77.51333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8836294044262518, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.090498570538072, "policy_loss": -0.006033608395970924, "vf_loss": 5.094980365258676, "vf_explained_var": 0.0020809846895712392, "kl": 0.007759006599061067, "entropy": 1.4489574499231166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8999080947624943, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.147769793126949, "policy_loss": -0.0060282584163976255, "vf_loss": 4.152499638032661, "vf_explained_var": 0.010405965740718538, "kl": 0.006492057622803396, "entropy": 1.3995614658587825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 248.36041027825803, "episode_reward_min": -695.3596177712509, "episode_reward_mean": -34.80793047959884, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1293.2331064761368, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 23.196025204896724, "predator_policy": 1228.1315084919042}, "policy_reward_mean": {"prey_policy": -190.5256708510656, "predator_policy": 173.12170561126618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.93999999999996, 9.649999999999922, 43.19966363072345, 44.25999999999943, 4.439999999999948, 61.12922472623909, 6.7599999999999225, 9.709999999999921, 3.909999999999959, -60.71174928272058, 3.8099999999999614, 44.17771159264948, 3.5499999999999643, 5.880821813614897, 58.285261203520925, 4.279999999999952, 34.62829755477245, 97.62934515477158, 3.95999999999996, 3.8299999999999605, 5.829999999999921, 43.10337087534021, 3.779999999999959, 22.48000000000053, 26.932505495160168, 13.799999999999919, 3.4099999999999735, -2.0740563346298897, -202.49491735966072, 11.520734758908072, 3.7799999999999634, 13.77999999999992, -239.90544536943133, 26.46000000000048, 9.689999999999921, 2.6799999999999775, 3.7299999999999622, 3.9099999999999593, 3.859999999999962, 10.489999999999933, 13.809999999999919, 26.400000000000535, 9.600774922465973, 8.119999999999933, -446.13945374100587, 5.499999999999925, 5.659999999999924, -1.5980050424221959, -3.9571870326804426, 6.559999999999922, 3.1099999999999763, 50.267496206205784, 14.709999999999916, 49.15335038088684, 51.02927453621653, 3.8799999999999613, 3.879999999999961, 1.94999999999997, 5.659999999999925, -264.40996630123846, 2.7399999999999842, 35.74938053764505, -501.6415286309719, 22.679799609458673, 28.71648581870094, 32.88364180367548, 14.148820934420437, -34.102665317727016, -205.99586651719636, 3.7899999999999636, 19.600000000000534, 2.9199999999999746, -606.5118598919508, 3.9599999999999596, 16.67000000000005, -33.029204041957065, 11.77999999999992, -229.96404240875174, 2.19999999999997, 12.429999999999927, 111.9410275237917, 3.7499999999999636, 3.67999999999996, -319.658837514248, -646.2949089960102, 248.36041027825803, -695.3596177712509, 3.4899999999999713, 2.149999999999983, 2.049999999999974, 2.419999999999992, -611.6424703308725, 6.629999999999923, 5.659999999999965, 2.3999999999999915, 5.38278584654524, 18.46054287337183, 51.43724310564212, 2.02999999999998, 29.030762741858403], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.161560787536862, -3.8589218967209, -29.10942650450774, -99.27932579557555, -81.12414783043042, -16.442616815847895, 17.453366397978353, -122.40973875669204, -72.31462852587384, -99.09890101461758, -74.29905453702074, 0.30804669790883116, -10.908028562507752, -28.14107790597933, -50.526443211288125, -20.97976310223969, -25.151699211452428, 2.0000000000000013, -150.89867712130743, -262.17324564135373, -51.99476064629936, -10.941588745556933, -16.70985800152901, -25.485728621961794, -79.77504344753105, -42.15214341350473, -3.660563207519921, 2.0000000000000013, -176.4455682733856, 1.5586235578775283, -54.44042040970966, -186.18591256148792, -64.22623277541821, -80.5721132193741, -47.15804248704711, -241.99747528343, -7.188355295327716, 0.28409259247081237, -4.874400796202878, -54.86353273330357, -37.03228751953536, 0.4212496216697507, -220.58483600570665, -37.26260487539762, -111.78016713295057, 2.0000000000000013, -28.367681034397204, -63.51151899438239, -50.97779659466182, -0.469717775906207, -1.9211901839333216, -8.404107585746504, -120.5693963124207, -83.03420251314209, -219.19154058163232, -110.08814369605741, -547.883232380687, -466.4821007741289, -6.724125560809835, -48.27843523150369, -19.764770509166755, -24.83984294339474, 8.049762553349334, -56.02647710473495, -526.3548004253597, -476.814697230562, -23.279187588673224, -47.327741697416094, -39.404200958108326, -55.54360922870282, -185.8446368446692, -405.16709419261247, -1.6809548332838218, -55.30535892147952, 2.0000000000000013, -30.59622459435762, -17.697695523311776, -14.341520834494805, -193.8248634895398, -3.5438194939219443, -4.386475550167761, -1.3766539655903751, 23.196025204896724, -96.38019890167973, -33.81713577444979, -6.409909712935725, -382.5107516685789, -7.135912331204626, -738.6507788672719, -558.5702464301896, 3.9799999999999582, -162.96765383834, -12.62638889905262, -78.08203766027827, -48.733728908572644, -23.220282640068618, -102.21810006296742, -18.327007309988748, -33.51852976585342, -94.43933466172406, -271.1943302896028, -42.37625835206038, -60.953172389692114, -85.41882021089886, 8.131224889215696, -32.54809923974325, -108.74661698681773, -26.464232142394938, -144.95445900394276, -11.303270610688374, -23.41949537517771, -0.10983720604249039, -10.82380711807141, -17.838308819485572, -948.5987583067244, -33.44782934505212, -31.3696046962471, -82.74207280474292, -590.3636701386328, -484.7714457419087, -10.065995150794778, -568.5163998398054, -104.23665232534185, -31.275507650986828, -569.1581847351239, -884.5517814941392, -22.022931304880736, -130.4754144318091, -73.31858089194013, 2.0000000000000013, -22.864130888518233, -24.06368202526616, -1175.1893449523932, -1109.7299206887983, -95.14004212142565, -62.032630210032615, -876.7238905766131, -847.9930279410744, -41.963218446114126, -16.27130366858854, 0.18966986904673883, -50.06246602363143, -2.612879802117158, -428.83303778907094, -1065.8877359702149, -815.2932552196695, -5.759487920419708, 2.0000000000000013, -25.029831083443668, -14.523809683145263, -91.35001630963428, -104.79819659547233, -42.2916414979357, 6.949999999999958, -307.8250185339806, -424.8849355009874, -769.3218000822089, -27.892357654216173, -32.000532186697036, -150.20759753141462, -144.18055346276148, 1.6189757300317402, -20.949730579407067, -29.940939102526382, -99.6531366815317, -17.73737186247274, -678.8009119761347, -440.2808735255066, -802.9704417916107, -956.7559026911176, 11.899999999999965, -802.2138663880919, -806.6717734998577, -977.064942539772, -101.62721455626856, -45.09346937749611, 2.0000000000000013, -803.4131474070086, -848.98344614577, -25.550991797781275, 0.48266652926775183, -576.4811166014181, -707.6271566162358, -960.0844761913867, -73.91354000414256, -11.420405628572729, -881.9080576240151, -77.96515224275291, -36.51108505298889, -514.7281488928106, -58.23152075204372, -70.10063789920734, -1293.2331064761368, -913.3603172964152, -2.5772482546311535, -176.7318071842219, -42.26048910872994, -1031.2693872967222, -0.44490985803745753, -99.46856473016908], "policy_predator_policy_reward": [5.131560787536821, 5.828921896720858, 36.91942650450789, 101.11932579557649, 66.88209045636937, 73.88433782063417, 21.11663360202187, 128.09973875669203, 40.93456924615456, 134.9189602943375, 62.62986897181796, 72.4903635935347, 9.746794390713209, 36.06231207777413, 58.30644321128777, 22.909763102239992, 27.061699211452726, 0.0, 294.6864423414779, 57.673731138460774, 53.85476064629899, 12.891588745556891, 49.96695395947278, 36.40634425666793, 81.49504344753193, 43.982143413504474, 5.5681664659397985, 1.9732185551950607, 168.8695691155992, 64.30263680342915, 55.79254710417262, 189.11378586702332, 42.204098063264254, 137.22254548630235, 208.2270453796936, 178.55781754555204, 9.158355295327674, 1.7059074075291891, 6.854400796202836, 56.713532733303204, 40.87228751953499, 1.5687503783302508, 146.8766406398928, 154.07417111655076, 113.56016713295148, 0.0, 0.0, 114.35920002878045, 33.702594667215834, 44.67742519851138, 10.185716337826516, 13.93958143185323, 122.23939631242155, 84.77420251314297, 304.24785938082755, 22.957768562231646, 765.2882459651626, 46.582169829991564, 48.21966671453941, 18.30362883668186, 8.164982491864748, 40.21963096069732, 1.746277509165812, 60.01043704221939, 673.0974936841152, 90.16655860237458, 92.64319261636089, 4.423736669728425, 47.224200958107964, 57.41360922870245, 187.42463684466776, 406.26709419261226, 3.6609548332837867, 57.055358921479176, 0.0, 32.50622459435774, 19.627695523312077, 16.271520834494762, 202.34486348953843, 5.513819493921902, 6.35647555016772, 13.21665396559035, 1.5639747951035505, 98.02019890168057, 21.45568886405244, 28.37213154579877, 383.7407516685791, 14.025912331204585, 0.0, 851.0815715564548, 0.0, 164.48765383833862, 87.09816176667314, 9.270264792658583, 50.66372890857226, 19.692277597646747, 103.97810006296832, 12.609820277308662, 38.33852976585305, 96.17933466172495, 272.5243302896018, 44.15625835206009, 90.27429736835322, 106.36519143844441, 4.728775110784265, 34.39809923974292, 107.20809225269115, 77.15610725741006, 120.98304976146018, 86.30395438938685, 25.309495375177956, 2.09983720604249, 11.214916889334868, 21.327199048222376, 948.6887583067246, 35.307829345051815, 33.27960469624695, 86.49207280474381, 87.52493806227265, 723.20021151703, 12.025995150794737, 569.2963998398054, 65.98310471963617, 105.27843579433905, 34.407306532474266, 917.6611310658172, 51.32941398230861, 123.84873136383796, 51.70512440892033, 48.329942301721005, 37.991106349484944, 41.820348367975306, 1174.7507294964626, 1124.3173570791498, 114.56670380921888, 8.503303204513601, 626.2507590348531, 892.4702929656391, 43.82321844611378, 18.201303668588842, 1.8003301309532627, 67.67246602363139, 4.592879802117116, 429.7730377890702, 1228.1315084919042, 46.53762280603209, 7.719487920419666, 0.0, 26.929831083443965, 29.293809683145277, 159.02898338707922, 4.09002547607281, 47.121641497935336, 0.0, 3.682850743883857, 499.06306088233157, 769.6118000822087, 29.802357654216472, 42.720532186696694, 151.91759753141307, 136.40034289434226, 118.10226236217648, 22.839730579407362, 31.800939102526616, 101.42313668153261, 19.64737186247304, 30.568272867831897, 768.8546751195599, 11.753866630584834, 1101.6775688561331, 440.63400428269, 598.0402723836607, 40.967428337801664, 1047.409669930578, 103.33721455626943, 46.87346937749576, 0.0, 803.5631474070085, 849.0934461457699, 27.49099179778158, 1.5073334707322497, 576.911116601418, 10.073183670959148, 1045.995978805792, 48.45524900027517, 43.50869663244039, 881.9080576240151, 83.62515224275374, 38.35108505298854, 515.2881488928106, 68.7388612016315, 64.97608329616514, 1211.148714130994, 1013.9052525149314, 71.02785163255469, 159.71844691193974, 44.09048910872959, 1031.469387296722, 26.521490798669713, 102.42274653139555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.516388887144662, "mean_inference_ms": 1.3211158566618357, "mean_action_processing_ms": 0.2185157806649944, "mean_env_wait_ms": 0.17406502091790835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034121274948120117, "StateBufferConnector_ms": 0.002894282341003418, "ViewRequirementAgentConnector_ms": 0.09750092029571533}, "num_episodes": 23, "episode_return_max": 248.36041027825803, "episode_return_min": -695.3596177712509, "episode_return_mean": -34.80793047959884, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.33397222643555, "num_env_steps_trained_throughput_per_sec": 402.33397222643555, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 10001.41, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10001.371, "sample_time_ms": 1152.288, "learn_time_ms": 8834.678, "learn_throughput": 452.761, "synch_weights_time_ms": 13.198}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "74486_00000", "date": "2024-08-16_14-58-36", "timestamp": 1723800516, "time_this_iter_s": 9.945800065994263, "time_total_s": 185.53500509262085, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397330e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 185.53500509262085, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.179999999999996, "ram_util_percent": 77.55333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9405847897605291, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.597115547947152, "policy_loss": -0.005023389509460204, "vf_loss": 4.601033659839126, "vf_explained_var": 0.0029492451715721654, "kl": 0.005526376315922886, "entropy": 1.4421273691313607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8832416480338132, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5921704757781256, "policy_loss": -0.010534772626986658, "vf_loss": 3.600407069196146, "vf_explained_var": 0.008673288140978131, "kl": 0.011490840177586023, "entropy": 1.3815170185906547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 248.36041027825803, "episode_reward_min": -773.3683379135424, "episode_reward_mean": -57.082170234154184, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1293.2331064761368, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 23.196025204896724, "predator_policy": 1228.1315084919042}, "policy_reward_mean": {"prey_policy": -224.14770084368064, "predator_policy": 195.6066157266036}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.95999999999996, 3.8299999999999605, 5.829999999999921, 43.10337087534021, 3.779999999999959, 22.48000000000053, 26.932505495160168, 13.799999999999919, 3.4099999999999735, -2.0740563346298897, -202.49491735966072, 11.520734758908072, 3.7799999999999634, 13.77999999999992, -239.90544536943133, 26.46000000000048, 9.689999999999921, 2.6799999999999775, 3.7299999999999622, 3.9099999999999593, 3.859999999999962, 10.489999999999933, 13.809999999999919, 26.400000000000535, 9.600774922465973, 8.119999999999933, -446.13945374100587, 5.499999999999925, 5.659999999999924, -1.5980050424221959, -3.9571870326804426, 6.559999999999922, 3.1099999999999763, 50.267496206205784, 14.709999999999916, 49.15335038088684, 51.02927453621653, 3.8799999999999613, 3.879999999999961, 1.94999999999997, 5.659999999999925, -264.40996630123846, 2.7399999999999842, 35.74938053764505, -501.6415286309719, 22.679799609458673, 28.71648581870094, 32.88364180367548, 14.148820934420437, -34.102665317727016, -205.99586651719636, 3.7899999999999636, 19.600000000000534, 2.9199999999999746, -606.5118598919508, 3.9599999999999596, 16.67000000000005, -33.029204041957065, 11.77999999999992, -229.96404240875174, 2.19999999999997, 12.429999999999927, 111.9410275237917, 3.7499999999999636, 3.67999999999996, -319.658837514248, -646.2949089960102, 248.36041027825803, -695.3596177712509, 3.4899999999999713, 2.149999999999983, 2.049999999999974, 2.419999999999992, -611.6424703308725, 6.629999999999923, 5.659999999999965, 2.3999999999999915, 5.38278584654524, 18.46054287337183, 51.43724310564212, 2.02999999999998, 29.030762741858403, 14.829999999999918, 23.224892459252235, 3.9699999999999593, 6.498867038501196, 3.4999999999999645, 4.7099999999999405, 3.5299999999999674, 7.899999999999918, -171.77430828509057, 134.43104085824731, -503.0929105613507, 3.819999999999961, 20.044745642899034, -195.9471327233453, -773.3683379135424, 3.359999999999972, -437.8022555775344, 3.269999999999971], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.188355295327716, 0.28409259247081237, -4.874400796202878, -54.86353273330357, -37.03228751953536, 0.4212496216697507, -220.58483600570665, -37.26260487539762, -111.78016713295057, 2.0000000000000013, -28.367681034397204, -63.51151899438239, -50.97779659466182, -0.469717775906207, -1.9211901839333216, -8.404107585746504, -120.5693963124207, -83.03420251314209, -219.19154058163232, -110.08814369605741, -547.883232380687, -466.4821007741289, -6.724125560809835, -48.27843523150369, -19.764770509166755, -24.83984294339474, 8.049762553349334, -56.02647710473495, -526.3548004253597, -476.814697230562, -23.279187588673224, -47.327741697416094, -39.404200958108326, -55.54360922870282, -185.8446368446692, -405.16709419261247, -1.6809548332838218, -55.30535892147952, 2.0000000000000013, -30.59622459435762, -17.697695523311776, -14.341520834494805, -193.8248634895398, -3.5438194939219443, -4.386475550167761, -1.3766539655903751, 23.196025204896724, -96.38019890167973, -33.81713577444979, -6.409909712935725, -382.5107516685789, -7.135912331204626, -738.6507788672719, -558.5702464301896, 3.9799999999999582, -162.96765383834, -12.62638889905262, -78.08203766027827, -48.733728908572644, -23.220282640068618, -102.21810006296742, -18.327007309988748, -33.51852976585342, -94.43933466172406, -271.1943302896028, -42.37625835206038, -60.953172389692114, -85.41882021089886, 8.131224889215696, -32.54809923974325, -108.74661698681773, -26.464232142394938, -144.95445900394276, -11.303270610688374, -23.41949537517771, -0.10983720604249039, -10.82380711807141, -17.838308819485572, -948.5987583067244, -33.44782934505212, -31.3696046962471, -82.74207280474292, -590.3636701386328, -484.7714457419087, -10.065995150794778, -568.5163998398054, -104.23665232534185, -31.275507650986828, -569.1581847351239, -884.5517814941392, -22.022931304880736, -130.4754144318091, -73.31858089194013, 2.0000000000000013, -22.864130888518233, -24.06368202526616, -1175.1893449523932, -1109.7299206887983, -95.14004212142565, -62.032630210032615, -876.7238905766131, -847.9930279410744, -41.963218446114126, -16.27130366858854, 0.18966986904673883, -50.06246602363143, -2.612879802117158, -428.83303778907094, -1065.8877359702149, -815.2932552196695, -5.759487920419708, 2.0000000000000013, -25.029831083443668, -14.523809683145263, -91.35001630963428, -104.79819659547233, -42.2916414979357, 6.949999999999958, -307.8250185339806, -424.8849355009874, -769.3218000822089, -27.892357654216173, -32.000532186697036, -150.20759753141462, -144.18055346276148, 1.6189757300317402, -20.949730579407067, -29.940939102526382, -99.6531366815317, -17.73737186247274, -678.8009119761347, -440.2808735255066, -802.9704417916107, -956.7559026911176, 11.899999999999965, -802.2138663880919, -806.6717734998577, -977.064942539772, -101.62721455626856, -45.09346937749611, 2.0000000000000013, -803.4131474070086, -848.98344614577, -25.550991797781275, 0.48266652926775183, -576.4811166014181, -707.6271566162358, -960.0844761913867, -73.91354000414256, -11.420405628572729, -881.9080576240151, -77.96515224275291, -36.51108505298889, -514.7281488928106, -58.23152075204372, -70.10063789920734, -1293.2331064761368, -913.3603172964152, -2.5772482546311535, -176.7318071842219, -42.26048910872994, -1031.2693872967222, -0.44490985803745753, -99.46856473016908, -6.822385034073923, 11.174866806330137, -50.224492297038736, -106.08023549072409, -1.2528124674834349, 0.32988353416111943, -87.00372302703275, -11.89432500593165, -60.57151584594682, -79.46178040248577, -11.647032519630569, -51.75232974219744, -56.64733490120884, -53.62685156281272, 1.081991744282875, -10.918266206147242, -263.8535820872363, -640.2357752781489, -251.81741599679856, -332.38166508795575, -1112.4611319888327, -1056.1630042954828, -16.214484362967173, -53.03118367440728, 2.0000000000000013, -67.45388447920948, -251.43543696151576, -298.749883974919, -933.5564011644922, -1030.0575521270114, -53.89396171341801, -269.1363457676325, -628.6218783069133, -856.015530023335, -244.6713106980555, 0.35810022231556665], "policy_predator_policy_reward": [9.158355295327674, 1.7059074075291891, 6.854400796202836, 56.713532733303204, 40.87228751953499, 1.5687503783302508, 146.8766406398928, 154.07417111655076, 113.56016713295148, 0.0, 0.0, 114.35920002878045, 33.702594667215834, 44.67742519851138, 10.185716337826516, 13.93958143185323, 122.23939631242155, 84.77420251314297, 304.24785938082755, 22.957768562231646, 765.2882459651626, 46.582169829991564, 48.21966671453941, 18.30362883668186, 8.164982491864748, 40.21963096069732, 1.746277509165812, 60.01043704221939, 673.0974936841152, 90.16655860237458, 92.64319261636089, 4.423736669728425, 47.224200958107964, 57.41360922870245, 187.42463684466776, 406.26709419261226, 3.6609548332837867, 57.055358921479176, 0.0, 32.50622459435774, 19.627695523312077, 16.271520834494762, 202.34486348953843, 5.513819493921902, 6.35647555016772, 13.21665396559035, 1.5639747951035505, 98.02019890168057, 21.45568886405244, 28.37213154579877, 383.7407516685791, 14.025912331204585, 0.0, 851.0815715564548, 0.0, 164.48765383833862, 87.09816176667314, 9.270264792658583, 50.66372890857226, 19.692277597646747, 103.97810006296832, 12.609820277308662, 38.33852976585305, 96.17933466172495, 272.5243302896018, 44.15625835206009, 90.27429736835322, 106.36519143844441, 4.728775110784265, 34.39809923974292, 107.20809225269115, 77.15610725741006, 120.98304976146018, 86.30395438938685, 25.309495375177956, 2.09983720604249, 11.214916889334868, 21.327199048222376, 948.6887583067246, 35.307829345051815, 33.27960469624695, 86.49207280474381, 87.52493806227265, 723.20021151703, 12.025995150794737, 569.2963998398054, 65.98310471963617, 105.27843579433905, 34.407306532474266, 917.6611310658172, 51.32941398230861, 123.84873136383796, 51.70512440892033, 48.329942301721005, 37.991106349484944, 41.820348367975306, 1174.7507294964626, 1124.3173570791498, 114.56670380921888, 8.503303204513601, 626.2507590348531, 892.4702929656391, 43.82321844611378, 18.201303668588842, 1.8003301309532627, 67.67246602363139, 4.592879802117116, 429.7730377890702, 1228.1315084919042, 46.53762280603209, 7.719487920419666, 0.0, 26.929831083443965, 29.293809683145277, 159.02898338707922, 4.09002547607281, 47.121641497935336, 0.0, 3.682850743883857, 499.06306088233157, 769.6118000822087, 29.802357654216472, 42.720532186696694, 151.91759753141307, 136.40034289434226, 118.10226236217648, 22.839730579407362, 31.800939102526616, 101.42313668153261, 19.64737186247304, 30.568272867831897, 768.8546751195599, 11.753866630584834, 1101.6775688561331, 440.63400428269, 598.0402723836607, 40.967428337801664, 1047.409669930578, 103.33721455626943, 46.87346937749576, 0.0, 803.5631474070085, 849.0934461457699, 27.49099179778158, 1.5073334707322497, 576.911116601418, 10.073183670959148, 1045.995978805792, 48.45524900027517, 43.50869663244039, 881.9080576240151, 83.62515224275374, 38.35108505298854, 515.2881488928106, 68.7388612016315, 64.97608329616514, 1211.148714130994, 1013.9052525149314, 71.02785163255469, 159.71844691193974, 44.09048910872959, 1031.469387296722, 26.521490798669713, 102.42274653139555, 8.772385034073881, 1.7051331936698224, 106.13286718861116, 73.39675305840383, 4.892928933322292, 0.0, 90.06240142205863, 15.33451364940792, 2.2119484649688843, 141.32134778346432, 13.587032519630528, 54.52232974219709, 44.885508160793265, 68.91867830322816, 3.8680082557171263, 13.8682662061472, 618.8617483684673, 113.45330071182715, 311.10703172174715, 407.52309022125297, 1108.249811912978, 557.2814138099889, 18.144484362967475, 54.921183674406905, 32.59863479713771, 52.89999532497114, 3.9079631419587866, 350.33022507113077, 1129.015333386674, 61.23028199128746, 314.2732727705971, 12.117034710453208, 58.135493881184885, 988.699658871529, 245.95131069805598, 1.6318997776844348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5181128101120513, "mean_inference_ms": 1.3260873359890326, "mean_action_processing_ms": 0.21933264468816738, "mean_env_wait_ms": 0.1745191963927567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033649206161499023, "StateBufferConnector_ms": 0.0028191804885864258, "ViewRequirementAgentConnector_ms": 0.09300673007965088}, "num_episodes": 18, "episode_return_max": 248.36041027825803, "episode_return_min": -773.3683379135424, "episode_return_mean": -57.082170234154184, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.71238318672306, "num_env_steps_trained_throughput_per_sec": 403.71238318672306, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 10043.88, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10043.842, "sample_time_ms": 1150.679, "learn_time_ms": 8878.84, "learn_throughput": 450.509, "synch_weights_time_ms": 13.094}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "74486_00000", "date": "2024-08-16_14-58-46", "timestamp": 1723800526, "time_this_iter_s": 9.911734819412231, "time_total_s": 195.44673991203308, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39734f5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 195.44673991203308, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 29.635714285714283, "ram_util_percent": 77.50714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0044573967418973, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9656340869015487, "policy_loss": -0.011628803619425055, "vf_loss": 3.9747973686803584, "vf_explained_var": 0.0012225810497526138, "kl": 0.012327588369117938, "entropy": 1.4534168836931702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9816525235062554, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.490053897559958, "policy_loss": -0.010025268996617308, "vf_loss": 3.498218282946834, "vf_explained_var": 0.008130305059372433, "kl": 0.009304395896196112, "entropy": 1.3573838649603425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 662.9835013458018, "episode_reward_min": -773.3683379135424, "episode_reward_mean": -52.62619065884837, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1293.2331064761368, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.33673603706976, "predator_policy": 1253.8791990765094}, "policy_reward_mean": {"prey_policy": -257.7998853943956, "predator_policy": 231.48679006497142}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.7299999999999622, 3.9099999999999593, 3.859999999999962, 10.489999999999933, 13.809999999999919, 26.400000000000535, 9.600774922465973, 8.119999999999933, -446.13945374100587, 5.499999999999925, 5.659999999999924, -1.5980050424221959, -3.9571870326804426, 6.559999999999922, 3.1099999999999763, 50.267496206205784, 14.709999999999916, 49.15335038088684, 51.02927453621653, 3.8799999999999613, 3.879999999999961, 1.94999999999997, 5.659999999999925, -264.40996630123846, 2.7399999999999842, 35.74938053764505, -501.6415286309719, 22.679799609458673, 28.71648581870094, 32.88364180367548, 14.148820934420437, -34.102665317727016, -205.99586651719636, 3.7899999999999636, 19.600000000000534, 2.9199999999999746, -606.5118598919508, 3.9599999999999596, 16.67000000000005, -33.029204041957065, 11.77999999999992, -229.96404240875174, 2.19999999999997, 12.429999999999927, 111.9410275237917, 3.7499999999999636, 3.67999999999996, -319.658837514248, -646.2949089960102, 248.36041027825803, -695.3596177712509, 3.4899999999999713, 2.149999999999983, 2.049999999999974, 2.419999999999992, -611.6424703308725, 6.629999999999923, 5.659999999999965, 2.3999999999999915, 5.38278584654524, 18.46054287337183, 51.43724310564212, 2.02999999999998, 29.030762741858403, 14.829999999999918, 23.224892459252235, 3.9699999999999593, 6.498867038501196, 3.4999999999999645, 4.7099999999999405, 3.5299999999999674, 7.899999999999918, -171.77430828509057, 134.43104085824731, -503.0929105613507, 3.819999999999961, 20.044745642899034, -195.9471327233453, -773.3683379135424, 3.359999999999972, -437.8022555775344, 3.269999999999971, -24.392317960364714, 2.3399999999999803, 2.019999999999971, 3.829999999999962, 1.8699999999999601, 662.9835013458018, 3.9099999999999597, -232.59776140259956, 1.8999999999999808, 3.8599999999999604, 122.04404341269036, 2.869999999999979, 13.180659142625027, -477.9579749418865, 54.079999999999494, 3.8999999999999604, 28.700000000000557, 23.62000000000052], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.6809548332838218, -55.30535892147952, 2.0000000000000013, -30.59622459435762, -17.697695523311776, -14.341520834494805, -193.8248634895398, -3.5438194939219443, -4.386475550167761, -1.3766539655903751, 23.196025204896724, -96.38019890167973, -33.81713577444979, -6.409909712935725, -382.5107516685789, -7.135912331204626, -738.6507788672719, -558.5702464301896, 3.9799999999999582, -162.96765383834, -12.62638889905262, -78.08203766027827, -48.733728908572644, -23.220282640068618, -102.21810006296742, -18.327007309988748, -33.51852976585342, -94.43933466172406, -271.1943302896028, -42.37625835206038, -60.953172389692114, -85.41882021089886, 8.131224889215696, -32.54809923974325, -108.74661698681773, -26.464232142394938, -144.95445900394276, -11.303270610688374, -23.41949537517771, -0.10983720604249039, -10.82380711807141, -17.838308819485572, -948.5987583067244, -33.44782934505212, -31.3696046962471, -82.74207280474292, -590.3636701386328, -484.7714457419087, -10.065995150794778, -568.5163998398054, -104.23665232534185, -31.275507650986828, -569.1581847351239, -884.5517814941392, -22.022931304880736, -130.4754144318091, -73.31858089194013, 2.0000000000000013, -22.864130888518233, -24.06368202526616, -1175.1893449523932, -1109.7299206887983, -95.14004212142565, -62.032630210032615, -876.7238905766131, -847.9930279410744, -41.963218446114126, -16.27130366858854, 0.18966986904673883, -50.06246602363143, -2.612879802117158, -428.83303778907094, -1065.8877359702149, -815.2932552196695, -5.759487920419708, 2.0000000000000013, -25.029831083443668, -14.523809683145263, -91.35001630963428, -104.79819659547233, -42.2916414979357, 6.949999999999958, -307.8250185339806, -424.8849355009874, -769.3218000822089, -27.892357654216173, -32.000532186697036, -150.20759753141462, -144.18055346276148, 1.6189757300317402, -20.949730579407067, -29.940939102526382, -99.6531366815317, -17.73737186247274, -678.8009119761347, -440.2808735255066, -802.9704417916107, -956.7559026911176, 11.899999999999965, -802.2138663880919, -806.6717734998577, -977.064942539772, -101.62721455626856, -45.09346937749611, 2.0000000000000013, -803.4131474070086, -848.98344614577, -25.550991797781275, 0.48266652926775183, -576.4811166014181, -707.6271566162358, -960.0844761913867, -73.91354000414256, -11.420405628572729, -881.9080576240151, -77.96515224275291, -36.51108505298889, -514.7281488928106, -58.23152075204372, -70.10063789920734, -1293.2331064761368, -913.3603172964152, -2.5772482546311535, -176.7318071842219, -42.26048910872994, -1031.2693872967222, -0.44490985803745753, -99.46856473016908, -6.822385034073923, 11.174866806330137, -50.224492297038736, -106.08023549072409, -1.2528124674834349, 0.32988353416111943, -87.00372302703275, -11.89432500593165, -60.57151584594682, -79.46178040248577, -11.647032519630569, -51.75232974219744, -56.64733490120884, -53.62685156281272, 1.081991744282875, -10.918266206147242, -263.8535820872363, -640.2357752781489, -251.81741599679856, -332.38166508795575, -1112.4611319888327, -1056.1630042954828, -16.214484362967173, -53.03118367440728, 2.0000000000000013, -67.45388447920948, -251.43543696151576, -298.749883974919, -933.5564011644922, -1030.0575521270114, -53.89396171341801, -269.1363457676325, -628.6218783069133, -856.015530023335, -244.6713106980555, 0.35810022231556665, -98.58193662379745, -93.67159106394229, -712.2340916725187, -30.755090492030224, -875.3718576219056, -32.31798339930211, -32.6782992666349, -6.841066721007206, -1122.4619303422546, -40.827961075600385, -1020.117522743357, 0.259214486523007, -1.9750176681718028, -15.837354416221126, -975.0010457247615, -279.9304514245839, -46.838542109332735, -1026.7928658143835, -44.00661677647198, -8.74470041102392, -1161.730216374476, -1157.3882635845662, -533.7312741365492, 2.0000000000000013, -17.824352702856608, -3.071310652008199, -744.8970066254138, -683.7717399062865, 38.33673603706976, -64.37999512040396, -7.372893926403087, -14.518203313582427, -7.360965602669749, 25.01036537239771, 1.8167600086061306, -15.929166268805286], "policy_predator_policy_reward": [3.6609548332837867, 57.055358921479176, 0.0, 32.50622459435774, 19.627695523312077, 16.271520834494762, 202.34486348953843, 5.513819493921902, 6.35647555016772, 13.21665396559035, 1.5639747951035505, 98.02019890168057, 21.45568886405244, 28.37213154579877, 383.7407516685791, 14.025912331204585, 0.0, 851.0815715564548, 0.0, 164.48765383833862, 87.09816176667314, 9.270264792658583, 50.66372890857226, 19.692277597646747, 103.97810006296832, 12.609820277308662, 38.33852976585305, 96.17933466172495, 272.5243302896018, 44.15625835206009, 90.27429736835322, 106.36519143844441, 4.728775110784265, 34.39809923974292, 107.20809225269115, 77.15610725741006, 120.98304976146018, 86.30395438938685, 25.309495375177956, 2.09983720604249, 11.214916889334868, 21.327199048222376, 948.6887583067246, 35.307829345051815, 33.27960469624695, 86.49207280474381, 87.52493806227265, 723.20021151703, 12.025995150794737, 569.2963998398054, 65.98310471963617, 105.27843579433905, 34.407306532474266, 917.6611310658172, 51.32941398230861, 123.84873136383796, 51.70512440892033, 48.329942301721005, 37.991106349484944, 41.820348367975306, 1174.7507294964626, 1124.3173570791498, 114.56670380921888, 8.503303204513601, 626.2507590348531, 892.4702929656391, 43.82321844611378, 18.201303668588842, 1.8003301309532627, 67.67246602363139, 4.592879802117116, 429.7730377890702, 1228.1315084919042, 46.53762280603209, 7.719487920419666, 0.0, 26.929831083443965, 29.293809683145277, 159.02898338707922, 4.09002547607281, 47.121641497935336, 0.0, 3.682850743883857, 499.06306088233157, 769.6118000822087, 29.802357654216472, 42.720532186696694, 151.91759753141307, 136.40034289434226, 118.10226236217648, 22.839730579407362, 31.800939102526616, 101.42313668153261, 19.64737186247304, 30.568272867831897, 768.8546751195599, 11.753866630584834, 1101.6775688561331, 440.63400428269, 598.0402723836607, 40.967428337801664, 1047.409669930578, 103.33721455626943, 46.87346937749576, 0.0, 803.5631474070085, 849.0934461457699, 27.49099179778158, 1.5073334707322497, 576.911116601418, 10.073183670959148, 1045.995978805792, 48.45524900027517, 43.50869663244039, 881.9080576240151, 83.62515224275374, 38.35108505298854, 515.2881488928106, 68.7388612016315, 64.97608329616514, 1211.148714130994, 1013.9052525149314, 71.02785163255469, 159.71844691193974, 44.09048910872959, 1031.469387296722, 26.521490798669713, 102.42274653139555, 8.772385034073881, 1.7051331936698224, 106.13286718861116, 73.39675305840383, 4.892928933322292, 0.0, 90.06240142205863, 15.33451364940792, 2.2119484649688843, 141.32134778346432, 13.587032519630528, 54.52232974219709, 44.885508160793265, 68.91867830322816, 3.8680082557171263, 13.8682662061472, 618.8617483684673, 113.45330071182715, 311.10703172174715, 407.52309022125297, 1108.249811912978, 557.2814138099889, 18.144484362967475, 54.921183674406905, 32.59863479713771, 52.89999532497114, 3.9079631419587866, 350.33022507113077, 1129.015333386674, 61.23028199128746, 314.2732727705971, 12.117034710453208, 58.135493881184885, 988.699658871529, 245.95131069805598, 1.6318997776844348, 126.27829606872781, 41.58291365864739, 712.674091672519, 32.65509049203034, 875.5018576219055, 34.20798339930173, 34.54829926663464, 8.801066721007164, 1122.4619303422546, 42.69796107560001, 847.5114129565351, 835.3303966461008, 3.9550176681717613, 17.767354416221398, 1018.0338252552848, 4.299910491461621, 48.73854210933236, 1026.7928658143835, 44.32410613546349, 12.287211052031992, 1253.8791990765094, 1187.2833242952236, 534.6012741365497, 0.0, 16.228825336550777, 17.847497160939405, 33.68133359103757, 917.0294379987762, 14.073263962929959, 66.04999512040456, 1.70133497382419, 24.089762266161326, 9.320965602669707, 1.7296346276025611, 19.89323999139387, 17.83916626880556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5201823550723188, "mean_inference_ms": 1.332441575289568, "mean_action_processing_ms": 0.22036616281909843, "mean_env_wait_ms": 0.17520520817867477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003396272659301758, "StateBufferConnector_ms": 0.00285494327545166, "ViewRequirementAgentConnector_ms": 0.09403562545776367}, "num_episodes": 18, "episode_return_max": 662.9835013458018, "episode_return_min": -773.3683379135424, "episode_return_mean": -52.62619065884837, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 379.0732993871618, "num_env_steps_trained_throughput_per_sec": 379.0732993871618, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 10144.592, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10144.553, "sample_time_ms": 1157.415, "learn_time_ms": 8972.865, "learn_throughput": 445.789, "synch_weights_time_ms": 13.009}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "74486_00000", "date": "2024-08-16_14-58-56", "timestamp": 1723800536, "time_this_iter_s": 10.55602502822876, "time_total_s": 206.00276494026184, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39734faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 206.00276494026184, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 37.086666666666666, "ram_util_percent": 77.84666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8412349052057064, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.036539106015806, "policy_loss": -0.009047651991726111, "vf_loss": 5.043985784999908, "vf_explained_var": 0.0019318981460793307, "kl": 0.00800495864733902, "entropy": 1.4568860229360994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8438087443195322, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.346864515006858, "policy_loss": -0.007299298564804885, "vf_loss": 4.352431696054166, "vf_explained_var": 0.0039742415859585715, "kl": 0.008660608648569348, "entropy": 1.3146869285396798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 662.9835013458018, "episode_reward_min": -773.3683379135424, "episode_reward_mean": -47.1639093040446, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1293.2331064761368, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.33673603706976, "predator_policy": 1253.8791990765094}, "policy_reward_mean": {"prey_policy": -286.8996479283609, "predator_policy": 263.3176932763387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.02927453621653, 3.8799999999999613, 3.879999999999961, 1.94999999999997, 5.659999999999925, -264.40996630123846, 2.7399999999999842, 35.74938053764505, -501.6415286309719, 22.679799609458673, 28.71648581870094, 32.88364180367548, 14.148820934420437, -34.102665317727016, -205.99586651719636, 3.7899999999999636, 19.600000000000534, 2.9199999999999746, -606.5118598919508, 3.9599999999999596, 16.67000000000005, -33.029204041957065, 11.77999999999992, -229.96404240875174, 2.19999999999997, 12.429999999999927, 111.9410275237917, 3.7499999999999636, 3.67999999999996, -319.658837514248, -646.2949089960102, 248.36041027825803, -695.3596177712509, 3.4899999999999713, 2.149999999999983, 2.049999999999974, 2.419999999999992, -611.6424703308725, 6.629999999999923, 5.659999999999965, 2.3999999999999915, 5.38278584654524, 18.46054287337183, 51.43724310564212, 2.02999999999998, 29.030762741858403, 14.829999999999918, 23.224892459252235, 3.9699999999999593, 6.498867038501196, 3.4999999999999645, 4.7099999999999405, 3.5299999999999674, 7.899999999999918, -171.77430828509057, 134.43104085824731, -503.0929105613507, 3.819999999999961, 20.044745642899034, -195.9471327233453, -773.3683379135424, 3.359999999999972, -437.8022555775344, 3.269999999999971, -24.392317960364714, 2.3399999999999803, 2.019999999999971, 3.829999999999962, 1.8699999999999601, 662.9835013458018, 3.9099999999999597, -232.59776140259956, 1.8999999999999808, 3.8599999999999604, 122.04404341269036, 2.869999999999979, 13.180659142625027, -477.9579749418865, 54.079999999999494, 3.8999999999999604, 28.700000000000557, 23.62000000000052, 3.8499999999999597, 5.390159243066456, 3.589999999999963, 1.8599999999999763, 641.8064551940203, 4.789999999999941, 3.7499999999999623, 3.9499999999999593, 3.8399999999999612, 280.66035530414314, 3.8899999999999597, 3.90999999999996, -24.06169593290235, 6.569999999999948, 34.41334498034349, -39.88932537758974, -630.9041822372534, 1.9999999999999682], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-144.95445900394276, -11.303270610688374, -23.41949537517771, -0.10983720604249039, -10.82380711807141, -17.838308819485572, -948.5987583067244, -33.44782934505212, -31.3696046962471, -82.74207280474292, -590.3636701386328, -484.7714457419087, -10.065995150794778, -568.5163998398054, -104.23665232534185, -31.275507650986828, -569.1581847351239, -884.5517814941392, -22.022931304880736, -130.4754144318091, -73.31858089194013, 2.0000000000000013, -22.864130888518233, -24.06368202526616, -1175.1893449523932, -1109.7299206887983, -95.14004212142565, -62.032630210032615, -876.7238905766131, -847.9930279410744, -41.963218446114126, -16.27130366858854, 0.18966986904673883, -50.06246602363143, -2.612879802117158, -428.83303778907094, -1065.8877359702149, -815.2932552196695, -5.759487920419708, 2.0000000000000013, -25.029831083443668, -14.523809683145263, -91.35001630963428, -104.79819659547233, -42.2916414979357, 6.949999999999958, -307.8250185339806, -424.8849355009874, -769.3218000822089, -27.892357654216173, -32.000532186697036, -150.20759753141462, -144.18055346276148, 1.6189757300317402, -20.949730579407067, -29.940939102526382, -99.6531366815317, -17.73737186247274, -678.8009119761347, -440.2808735255066, -802.9704417916107, -956.7559026911176, 11.899999999999965, -802.2138663880919, -806.6717734998577, -977.064942539772, -101.62721455626856, -45.09346937749611, 2.0000000000000013, -803.4131474070086, -848.98344614577, -25.550991797781275, 0.48266652926775183, -576.4811166014181, -707.6271566162358, -960.0844761913867, -73.91354000414256, -11.420405628572729, -881.9080576240151, -77.96515224275291, -36.51108505298889, -514.7281488928106, -58.23152075204372, -70.10063789920734, -1293.2331064761368, -913.3603172964152, -2.5772482546311535, -176.7318071842219, -42.26048910872994, -1031.2693872967222, -0.44490985803745753, -99.46856473016908, -6.822385034073923, 11.174866806330137, -50.224492297038736, -106.08023549072409, -1.2528124674834349, 0.32988353416111943, -87.00372302703275, -11.89432500593165, -60.57151584594682, -79.46178040248577, -11.647032519630569, -51.75232974219744, -56.64733490120884, -53.62685156281272, 1.081991744282875, -10.918266206147242, -263.8535820872363, -640.2357752781489, -251.81741599679856, -332.38166508795575, -1112.4611319888327, -1056.1630042954828, -16.214484362967173, -53.03118367440728, 2.0000000000000013, -67.45388447920948, -251.43543696151576, -298.749883974919, -933.5564011644922, -1030.0575521270114, -53.89396171341801, -269.1363457676325, -628.6218783069133, -856.015530023335, -244.6713106980555, 0.35810022231556665, -98.58193662379745, -93.67159106394229, -712.2340916725187, -30.755090492030224, -875.3718576219056, -32.31798339930211, -32.6782992666349, -6.841066721007206, -1122.4619303422546, -40.827961075600385, -1020.117522743357, 0.259214486523007, -1.9750176681718028, -15.837354416221126, -975.0010457247615, -279.9304514245839, -46.838542109332735, -1026.7928658143835, -44.00661677647198, -8.74470041102392, -1161.730216374476, -1157.3882635845662, -533.7312741365492, 2.0000000000000013, -17.824352702856608, -3.071310652008199, -744.8970066254138, -683.7717399062865, 38.33673603706976, -64.37999512040396, -7.372893926403087, -14.518203313582427, -7.360965602669749, 25.01036537239771, 1.8167600086061306, -15.929166268805286, -50.867449442291914, -379.4693111862932, -63.98666957535498, -121.4899948475986, -4.967545362485975, -453.8596740767934, -50.49733699725691, -1041.2132177664964, -1260.549166481885, -364.81096874998696, -31.30685547161746, -26.20394450746061, -19.8800774795026, -36.92806973920184, 2.0000000000000013, -8.035751267666553, -3.8879432599262813, -26.09158883027218, -655.4879891531118, -156.5995164916553, 2.0000000000000013, -24.56621544953646, -0.17273400830370078, -12.892424561489968, -46.936438222393726, -27.643464437074076, -8.05000000000003, -797.146143514437, -10.978019621288182, -75.86764364346513, -171.7597850982171, -494.0833941734232, -1089.9649682707557, -704.961894932763, -894.4163986398373, -19.135755689630503], "policy_predator_policy_reward": [120.98304976146018, 86.30395438938685, 25.309495375177956, 2.09983720604249, 11.214916889334868, 21.327199048222376, 948.6887583067246, 35.307829345051815, 33.27960469624695, 86.49207280474381, 87.52493806227265, 723.20021151703, 12.025995150794737, 569.2963998398054, 65.98310471963617, 105.27843579433905, 34.407306532474266, 917.6611310658172, 51.32941398230861, 123.84873136383796, 51.70512440892033, 48.329942301721005, 37.991106349484944, 41.820348367975306, 1174.7507294964626, 1124.3173570791498, 114.56670380921888, 8.503303204513601, 626.2507590348531, 892.4702929656391, 43.82321844611378, 18.201303668588842, 1.8003301309532627, 67.67246602363139, 4.592879802117116, 429.7730377890702, 1228.1315084919042, 46.53762280603209, 7.719487920419666, 0.0, 26.929831083443965, 29.293809683145277, 159.02898338707922, 4.09002547607281, 47.121641497935336, 0.0, 3.682850743883857, 499.06306088233157, 769.6118000822087, 29.802357654216472, 42.720532186696694, 151.91759753141307, 136.40034289434226, 118.10226236217648, 22.839730579407362, 31.800939102526616, 101.42313668153261, 19.64737186247304, 30.568272867831897, 768.8546751195599, 11.753866630584834, 1101.6775688561331, 440.63400428269, 598.0402723836607, 40.967428337801664, 1047.409669930578, 103.33721455626943, 46.87346937749576, 0.0, 803.5631474070085, 849.0934461457699, 27.49099179778158, 1.5073334707322497, 576.911116601418, 10.073183670959148, 1045.995978805792, 48.45524900027517, 43.50869663244039, 881.9080576240151, 83.62515224275374, 38.35108505298854, 515.2881488928106, 68.7388612016315, 64.97608329616514, 1211.148714130994, 1013.9052525149314, 71.02785163255469, 159.71844691193974, 44.09048910872959, 1031.469387296722, 26.521490798669713, 102.42274653139555, 8.772385034073881, 1.7051331936698224, 106.13286718861116, 73.39675305840383, 4.892928933322292, 0.0, 90.06240142205863, 15.33451364940792, 2.2119484649688843, 141.32134778346432, 13.587032519630528, 54.52232974219709, 44.885508160793265, 68.91867830322816, 3.8680082557171263, 13.8682662061472, 618.8617483684673, 113.45330071182715, 311.10703172174715, 407.52309022125297, 1108.249811912978, 557.2814138099889, 18.144484362967475, 54.921183674406905, 32.59863479713771, 52.89999532497114, 3.9079631419587866, 350.33022507113077, 1129.015333386674, 61.23028199128746, 314.2732727705971, 12.117034710453208, 58.135493881184885, 988.699658871529, 245.95131069805598, 1.6318997776844348, 126.27829606872781, 41.58291365864739, 712.674091672519, 32.65509049203034, 875.5018576219055, 34.20798339930173, 34.54829926663464, 8.801066721007164, 1122.4619303422546, 42.69796107560001, 847.5114129565351, 835.3303966461008, 3.9550176681717613, 17.767354416221398, 1018.0338252552848, 4.299910491461621, 48.73854210933236, 1026.7928658143835, 44.32410613546349, 12.287211052031992, 1253.8791990765094, 1187.2833242952236, 534.6012741365497, 0.0, 16.228825336550777, 17.847497160939405, 33.68133359103757, 917.0294379987762, 14.073263962929959, 66.04999512040456, 1.70133497382419, 24.089762266161326, 9.320965602669707, 1.7296346276025611, 19.89323999139387, 17.83916626880556, 53.68744944229155, 380.4993111862923, 87.08211601821044, 103.78470764781044, 7.917545362485933, 454.4996740767928, 52.35733699725654, 1041.2132177664964, 1095.3653506877913, 1171.8012397381012, 34.20685547161733, 28.093944507460904, 21.800077479502896, 38.758069739201474, 7.7280483392388835, 2.2577029284276278, 5.857943259926239, 27.961588830272472, 493.1251755275586, 599.6226854213525, 0.0, 26.456215449536757, 2.162734008303699, 14.812424561489927, 12.644545391824185, 37.87366133474086, 10.0, 801.7661435144371, 26.798509451407327, 94.46049879369053, 117.21271479410774, 508.7411390999434, 1145.4291081541594, 18.593572812105794, 894.4963986398373, 21.055755689630804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.522178451539732, "mean_inference_ms": 1.3381995857888114, "mean_action_processing_ms": 0.22119807903851638, "mean_env_wait_ms": 0.17596380532323613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003376603126525879, "StateBufferConnector_ms": 0.0028034448623657227, "ViewRequirementAgentConnector_ms": 0.09267604351043701}, "num_episodes": 18, "episode_return_max": 662.9835013458018, "episode_return_min": -773.3683379135424, "episode_return_mean": -47.1639093040446, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.6716988409167, "num_env_steps_trained_throughput_per_sec": 364.6716988409167, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 10205.747, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10205.712, "sample_time_ms": 1155.921, "learn_time_ms": 9035.975, "learn_throughput": 442.675, "synch_weights_time_ms": 12.773}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "74486_00000", "date": "2024-08-16_14-59-07", "timestamp": 1723800547, "time_this_iter_s": 10.989511966705322, "time_total_s": 216.99227690696716, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3972eb8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 216.99227690696716, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 43.10666666666667, "ram_util_percent": 78.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4167465839278761, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.018846942886474, "policy_loss": -0.009971150506297669, "vf_loss": 4.026695664723714, "vf_explained_var": 0.0019712414375688664, "kl": 0.010612098579807544, "entropy": 1.444913214918167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1177217918255973, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.145557315892012, "policy_loss": -0.008664671487603632, "vf_loss": 4.152758712112588, "vf_explained_var": 0.0014946812359744278, "kl": 0.007316352002492567, "entropy": 1.2879435889304631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 721.1518896040491, "episode_reward_min": -773.3683379135424, "episode_reward_mean": -25.50226888293828, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1293.2331064761368, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.33673603706976, "predator_policy": 1253.8791990765094}, "policy_reward_mean": {"prey_policy": -281.9751108319298, "predator_policy": 269.2239763904607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.7499999999999636, 3.67999999999996, -319.658837514248, -646.2949089960102, 248.36041027825803, -695.3596177712509, 3.4899999999999713, 2.149999999999983, 2.049999999999974, 2.419999999999992, -611.6424703308725, 6.629999999999923, 5.659999999999965, 2.3999999999999915, 5.38278584654524, 18.46054287337183, 51.43724310564212, 2.02999999999998, 29.030762741858403, 14.829999999999918, 23.224892459252235, 3.9699999999999593, 6.498867038501196, 3.4999999999999645, 4.7099999999999405, 3.5299999999999674, 7.899999999999918, -171.77430828509057, 134.43104085824731, -503.0929105613507, 3.819999999999961, 20.044745642899034, -195.9471327233453, -773.3683379135424, 3.359999999999972, -437.8022555775344, 3.269999999999971, -24.392317960364714, 2.3399999999999803, 2.019999999999971, 3.829999999999962, 1.8699999999999601, 662.9835013458018, 3.9099999999999597, -232.59776140259956, 1.8999999999999808, 3.8599999999999604, 122.04404341269036, 2.869999999999979, 13.180659142625027, -477.9579749418865, 54.079999999999494, 3.8999999999999604, 28.700000000000557, 23.62000000000052, 3.8499999999999597, 5.390159243066456, 3.589999999999963, 1.8599999999999763, 641.8064551940203, 4.789999999999941, 3.7499999999999623, 3.9499999999999593, 3.8399999999999612, 280.66035530414314, 3.8899999999999597, 3.90999999999996, -24.06169593290235, 6.569999999999948, 34.41334498034349, -39.88932537758974, -630.9041822372534, 1.9999999999999682, -98.57535054200996, 8.66048281676373, 6.919999999999916, 15.71999999999992, 2.789999999999978, 7.318669441598185, -227.74225886573072, -188.63036291658634, 3.489999999999972, 2.539999999999983, 721.1518896040491, 9.669999999999959, 547.0645539857519, 242.905135548996, 6.79999999999992, 1.7399999999999718, 8.75999999999992, 0.09769140853996182, -367.01107935271153, 7.641222924747702, 3.909999999999961, 2.0099999999999834, 1.9800000000000004, -52.473254288659746, 4.899999999999937, 3.5099999999999696, 3.969999999999959], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.949730579407067, -29.940939102526382, -99.6531366815317, -17.73737186247274, -678.8009119761347, -440.2808735255066, -802.9704417916107, -956.7559026911176, 11.899999999999965, -802.2138663880919, -806.6717734998577, -977.064942539772, -101.62721455626856, -45.09346937749611, 2.0000000000000013, -803.4131474070086, -848.98344614577, -25.550991797781275, 0.48266652926775183, -576.4811166014181, -707.6271566162358, -960.0844761913867, -73.91354000414256, -11.420405628572729, -881.9080576240151, -77.96515224275291, -36.51108505298889, -514.7281488928106, -58.23152075204372, -70.10063789920734, -1293.2331064761368, -913.3603172964152, -2.5772482546311535, -176.7318071842219, -42.26048910872994, -1031.2693872967222, -0.44490985803745753, -99.46856473016908, -6.822385034073923, 11.174866806330137, -50.224492297038736, -106.08023549072409, -1.2528124674834349, 0.32988353416111943, -87.00372302703275, -11.89432500593165, -60.57151584594682, -79.46178040248577, -11.647032519630569, -51.75232974219744, -56.64733490120884, -53.62685156281272, 1.081991744282875, -10.918266206147242, -263.8535820872363, -640.2357752781489, -251.81741599679856, -332.38166508795575, -1112.4611319888327, -1056.1630042954828, -16.214484362967173, -53.03118367440728, 2.0000000000000013, -67.45388447920948, -251.43543696151576, -298.749883974919, -933.5564011644922, -1030.0575521270114, -53.89396171341801, -269.1363457676325, -628.6218783069133, -856.015530023335, -244.6713106980555, 0.35810022231556665, -98.58193662379745, -93.67159106394229, -712.2340916725187, -30.755090492030224, -875.3718576219056, -32.31798339930211, -32.6782992666349, -6.841066721007206, -1122.4619303422546, -40.827961075600385, -1020.117522743357, 0.259214486523007, -1.9750176681718028, -15.837354416221126, -975.0010457247615, -279.9304514245839, -46.838542109332735, -1026.7928658143835, -44.00661677647198, -8.74470041102392, -1161.730216374476, -1157.3882635845662, -533.7312741365492, 2.0000000000000013, -17.824352702856608, -3.071310652008199, -744.8970066254138, -683.7717399062865, 38.33673603706976, -64.37999512040396, -7.372893926403087, -14.518203313582427, -7.360965602669749, 25.01036537239771, 1.8167600086061306, -15.929166268805286, -50.867449442291914, -379.4693111862932, -63.98666957535498, -121.4899948475986, -4.967545362485975, -453.8596740767934, -50.49733699725691, -1041.2132177664964, -1260.549166481885, -364.81096874998696, -31.30685547161746, -26.20394450746061, -19.8800774795026, -36.92806973920184, 2.0000000000000013, -8.035751267666553, -3.8879432599262813, -26.09158883027218, -655.4879891531118, -156.5995164916553, 2.0000000000000013, -24.56621544953646, -0.17273400830370078, -12.892424561489968, -46.936438222393726, -27.643464437074076, -8.05000000000003, -797.146143514437, -10.978019621288182, -75.86764364346513, -171.7597850982171, -494.0833941734232, -1089.9649682707557, -704.961894932763, -894.4163986398373, -19.135755689630503, -719.0815772276198, -245.539605003836, -281.8419909288353, -3.5492440824365987, -6.020701336767252, 3.4422712783960794, -20.57459098735487, -13.266515777809765, -515.1462784309598, 2.0000000000000013, -48.0808525539763, -67.50157905165338, -580.0206904851414, -425.60703603934957, -240.71514229699474, -226.25712955801623, -155.90244555601546, -3.8944984490202668, -493.2440133072386, -39.603930282021025, -1216.7301449605945, -118.79040260217046, 2.98999999999998, -62.1261329757647, -1053.539051811966, -202.71330565684394, 0.1638133778482735, -1021.9966469789274, -51.76055940881795, -5.8814823481301595, -919.9575679293124, -96.62631615298326, -50.45018186849335, -13.27695304323754, -10.165093086157455, -24.142269863276855, -467.63247833339284, -654.1225081230994, 2.0000000000000013, -143.4243358471421, -7.795481602737221, -19.645325422417613, -3.5707472085627563, -1044.549265287551, -145.91360760305315, -365.29952736389265, -379.39293235584057, -168.55839327912128, 2.9899999999999793, -20.345425969559063, -202.2342274052055, -4.484810815752167, 2.0000000000000013, -5.037374469270433], "policy_predator_policy_reward": [22.839730579407362, 31.800939102526616, 101.42313668153261, 19.64737186247304, 30.568272867831897, 768.8546751195599, 11.753866630584834, 1101.6775688561331, 440.63400428269, 598.0402723836607, 40.967428337801664, 1047.409669930578, 103.33721455626943, 46.87346937749576, 0.0, 803.5631474070085, 849.0934461457699, 27.49099179778158, 1.5073334707322497, 576.911116601418, 10.073183670959148, 1045.995978805792, 48.45524900027517, 43.50869663244039, 881.9080576240151, 83.62515224275374, 38.35108505298854, 515.2881488928106, 68.7388612016315, 64.97608329616514, 1211.148714130994, 1013.9052525149314, 71.02785163255469, 159.71844691193974, 44.09048910872959, 1031.469387296722, 26.521490798669713, 102.42274653139555, 8.772385034073881, 1.7051331936698224, 106.13286718861116, 73.39675305840383, 4.892928933322292, 0.0, 90.06240142205863, 15.33451364940792, 2.2119484649688843, 141.32134778346432, 13.587032519630528, 54.52232974219709, 44.885508160793265, 68.91867830322816, 3.8680082557171263, 13.8682662061472, 618.8617483684673, 113.45330071182715, 311.10703172174715, 407.52309022125297, 1108.249811912978, 557.2814138099889, 18.144484362967475, 54.921183674406905, 32.59863479713771, 52.89999532497114, 3.9079631419587866, 350.33022507113077, 1129.015333386674, 61.23028199128746, 314.2732727705971, 12.117034710453208, 58.135493881184885, 988.699658871529, 245.95131069805598, 1.6318997776844348, 126.27829606872781, 41.58291365864739, 712.674091672519, 32.65509049203034, 875.5018576219055, 34.20798339930173, 34.54829926663464, 8.801066721007164, 1122.4619303422546, 42.69796107560001, 847.5114129565351, 835.3303966461008, 3.9550176681717613, 17.767354416221398, 1018.0338252552848, 4.299910491461621, 48.73854210933236, 1026.7928658143835, 44.32410613546349, 12.287211052031992, 1253.8791990765094, 1187.2833242952236, 534.6012741365497, 0.0, 16.228825336550777, 17.847497160939405, 33.68133359103757, 917.0294379987762, 14.073263962929959, 66.04999512040456, 1.70133497382419, 24.089762266161326, 9.320965602669707, 1.7296346276025611, 19.89323999139387, 17.83916626880556, 53.68744944229155, 380.4993111862923, 87.08211601821044, 103.78470764781044, 7.917545362485933, 454.4996740767928, 52.35733699725654, 1041.2132177664964, 1095.3653506877913, 1171.8012397381012, 34.20685547161733, 28.093944507460904, 21.800077479502896, 38.758069739201474, 7.7280483392388835, 2.2577029284276278, 5.857943259926239, 27.961588830272472, 493.1251755275586, 599.6226854213525, 0.0, 26.456215449536757, 2.162734008303699, 14.812424561489927, 12.644545391824185, 37.87366133474086, 10.0, 801.7661435144371, 26.798509451407327, 94.46049879369053, 117.21271479410774, 508.7411390999434, 1145.4291081541594, 18.593572812105794, 894.4963986398373, 21.055755689630804, 853.2989133587689, 12.746918330673836, 282.99199092883555, 11.059726899200353, 7.98070133676721, 1.5177287216038904, 1.6467445447720608, 47.91436222039282, 515.9362784309595, 0.0, 58.594182705005764, 64.30691834222289, 107.61024409150615, 670.2752235672535, 12.326670944820194, 266.01523799360456, 9.186186633275042, 154.1007573717605, 493.8840133072383, 41.50393028202065, 1009.3986160242907, 1047.2738211425242, 65.68230389002093, 3.123829085743978, 814.2231559863502, 989.0937554682112, 349.0691888978696, 915.6687802522059, 53.64055940881757, 10.801482348130119, 920.1275679293124, 98.19631615298402, 57.27018186849299, 15.216953043237499, 28.199820873262546, 6.205233484712016, 641.7658649389081, 112.9780421648731, 145.1443358471407, 3.9212229247477812, 9.765481602737179, 21.585325422417917, 5.540747208562714, 1044.589265287551, 147.3436076030527, 365.84952736389266, 61.07087542623443, 434.40719592006604, 0.0, 22.25542596955936, 203.77422740520547, 6.454810815752125, 2.15541464885258, 4.851959820417811]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5211453891927462, "mean_inference_ms": 1.3365698442433374, "mean_action_processing_ms": 0.22068040213511397, "mean_env_wait_ms": 0.1757601356022901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004022479057312012, "StateBufferConnector_ms": 0.0029801130294799805, "ViewRequirementAgentConnector_ms": 0.09370636940002441}, "num_episodes": 27, "episode_return_max": 721.1518896040491, "episode_return_min": -773.3683379135424, "episode_return_mean": -25.50226888293828, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.9604984621885, "num_env_steps_trained_throughput_per_sec": 355.9604984621885, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 10255.476, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10255.441, "sample_time_ms": 1155.77, "learn_time_ms": 9086.216, "learn_throughput": 440.227, "synch_weights_time_ms": 12.397}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "74486_00000", "date": "2024-08-16_14-59-19", "timestamp": 1723800559, "time_this_iter_s": 11.242858171463013, "time_total_s": 228.23513507843018, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39737f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 228.23513507843018, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 37.037499999999994, "ram_util_percent": 79.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7041072768824441, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.93638264893224, "policy_loss": -0.011373910049676264, "vf_loss": 3.946070869132955, "vf_explained_var": -0.0005456530227862968, "kl": 0.008428446144191358, "entropy": 1.417906771135078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1829431669737296, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.057423779068801, "policy_loss": -0.009136851733826376, "vf_loss": 4.064740679756043, "vf_explained_var": 0.009811894161991342, "kl": 0.00909973714469879, "entropy": 1.3048400952702477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 721.1518896040491, "episode_reward_min": -773.3683379135424, "episode_reward_mean": -3.7094935257172175, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1260.549166481885, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.33673603706976, "predator_policy": 1253.8791990765094}, "policy_reward_mean": {"prey_policy": -224.93820212769234, "predator_policy": 223.08345536483375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.030762741858403, 14.829999999999918, 23.224892459252235, 3.9699999999999593, 6.498867038501196, 3.4999999999999645, 4.7099999999999405, 3.5299999999999674, 7.899999999999918, -171.77430828509057, 134.43104085824731, -503.0929105613507, 3.819999999999961, 20.044745642899034, -195.9471327233453, -773.3683379135424, 3.359999999999972, -437.8022555775344, 3.269999999999971, -24.392317960364714, 2.3399999999999803, 2.019999999999971, 3.829999999999962, 1.8699999999999601, 662.9835013458018, 3.9099999999999597, -232.59776140259956, 1.8999999999999808, 3.8599999999999604, 122.04404341269036, 2.869999999999979, 13.180659142625027, -477.9579749418865, 54.079999999999494, 3.8999999999999604, 28.700000000000557, 23.62000000000052, 3.8499999999999597, 5.390159243066456, 3.589999999999963, 1.8599999999999763, 641.8064551940203, 4.789999999999941, 3.7499999999999623, 3.9499999999999593, 3.8399999999999612, 280.66035530414314, 3.8899999999999597, 3.90999999999996, -24.06169593290235, 6.569999999999948, 34.41334498034349, -39.88932537758974, -630.9041822372534, 1.9999999999999682, -98.57535054200996, 8.66048281676373, 6.919999999999916, 15.71999999999992, 2.789999999999978, 7.318669441598185, -227.74225886573072, -188.63036291658634, 3.489999999999972, 2.539999999999983, 721.1518896040491, 9.669999999999959, 547.0645539857519, 242.905135548996, 6.79999999999992, 1.7399999999999718, 8.75999999999992, 0.09769140853996182, -367.01107935271153, 7.641222924747702, 3.909999999999961, 2.0099999999999834, 1.9800000000000004, -52.473254288659746, 4.899999999999937, 3.5099999999999696, 3.969999999999959, 10.107155605633887, 5.6199999999999255, 14.409999999999927, 10.589999999999945, 8.63753428607254, 103.1008089898924, -4.9320650560029495, 20.662720063656014, -15.984308667674824, 3.989140862941455, 7.009999999999957, 2.699999999999984, 36.46999999999943, 21.932163460064775, 5.699999999999923, 12.25953366895944, 3.259999999999974, 18.6900000000004], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.44490985803745753, -99.46856473016908, -6.822385034073923, 11.174866806330137, -50.224492297038736, -106.08023549072409, -1.2528124674834349, 0.32988353416111943, -87.00372302703275, -11.89432500593165, -60.57151584594682, -79.46178040248577, -11.647032519630569, -51.75232974219744, -56.64733490120884, -53.62685156281272, 1.081991744282875, -10.918266206147242, -263.8535820872363, -640.2357752781489, -251.81741599679856, -332.38166508795575, -1112.4611319888327, -1056.1630042954828, -16.214484362967173, -53.03118367440728, 2.0000000000000013, -67.45388447920948, -251.43543696151576, -298.749883974919, -933.5564011644922, -1030.0575521270114, -53.89396171341801, -269.1363457676325, -628.6218783069133, -856.015530023335, -244.6713106980555, 0.35810022231556665, -98.58193662379745, -93.67159106394229, -712.2340916725187, -30.755090492030224, -875.3718576219056, -32.31798339930211, -32.6782992666349, -6.841066721007206, -1122.4619303422546, -40.827961075600385, -1020.117522743357, 0.259214486523007, -1.9750176681718028, -15.837354416221126, -975.0010457247615, -279.9304514245839, -46.838542109332735, -1026.7928658143835, -44.00661677647198, -8.74470041102392, -1161.730216374476, -1157.3882635845662, -533.7312741365492, 2.0000000000000013, -17.824352702856608, -3.071310652008199, -744.8970066254138, -683.7717399062865, 38.33673603706976, -64.37999512040396, -7.372893926403087, -14.518203313582427, -7.360965602669749, 25.01036537239771, 1.8167600086061306, -15.929166268805286, -50.867449442291914, -379.4693111862932, -63.98666957535498, -121.4899948475986, -4.967545362485975, -453.8596740767934, -50.49733699725691, -1041.2132177664964, -1260.549166481885, -364.81096874998696, -31.30685547161746, -26.20394450746061, -19.8800774795026, -36.92806973920184, 2.0000000000000013, -8.035751267666553, -3.8879432599262813, -26.09158883027218, -655.4879891531118, -156.5995164916553, 2.0000000000000013, -24.56621544953646, -0.17273400830370078, -12.892424561489968, -46.936438222393726, -27.643464437074076, -8.05000000000003, -797.146143514437, -10.978019621288182, -75.86764364346513, -171.7597850982171, -494.0833941734232, -1089.9649682707557, -704.961894932763, -894.4163986398373, -19.135755689630503, -719.0815772276198, -245.539605003836, -281.8419909288353, -3.5492440824365987, -6.020701336767252, 3.4422712783960794, -20.57459098735487, -13.266515777809765, -515.1462784309598, 2.0000000000000013, -48.0808525539763, -67.50157905165338, -580.0206904851414, -425.60703603934957, -240.71514229699474, -226.25712955801623, -155.90244555601546, -3.8944984490202668, -493.2440133072386, -39.603930282021025, -1216.7301449605945, -118.79040260217046, 2.98999999999998, -62.1261329757647, -1053.539051811966, -202.71330565684394, 0.1638133778482735, -1021.9966469789274, -51.76055940881795, -5.8814823481301595, -919.9575679293124, -96.62631615298326, -50.45018186849335, -13.27695304323754, -10.165093086157455, -24.142269863276855, -467.63247833339284, -654.1225081230994, 2.0000000000000013, -143.4243358471421, -7.795481602737221, -19.645325422417613, -3.5707472085627563, -1044.549265287551, -145.91360760305315, -365.29952736389265, -379.39293235584057, -168.55839327912128, 2.9899999999999793, -20.345425969559063, -202.2342274052055, -4.484810815752167, 2.0000000000000013, -5.037374469270433, -475.6054217565923, -17.10322959760698, -25.89180243556597, -40.949764269399026, -73.11932934321918, -22.59655496432169, -292.1702964382929, -103.3246540720083, -2.8146473091196462, -2.926558448026011, -258.6998137217678, -26.76365980005233, -49.228163180084515, -119.69932304179041, -11.056684585116505, -239.7626512983288, -65.60981222474034, -75.36325286722771, -59.96811786344609, -55.86303301988568, -347.48285248153815, -168.9020214051288, -348.3873847209818, -76.32946622064972, 6.198325258091236, -9.231562156260024, 2.0000000000000013, -116.75115384007138, -88.2629434884921, 0.04293084322809976, -41.41888681442187, -33.64929010420192, -107.55409136549837, -69.26150965716076, -26.56365236724448, -20.277076911114378], "policy_predator_policy_reward": [26.521490798669713, 102.42274653139555, 8.772385034073881, 1.7051331936698224, 106.13286718861116, 73.39675305840383, 4.892928933322292, 0.0, 90.06240142205863, 15.33451364940792, 2.2119484649688843, 141.32134778346432, 13.587032519630528, 54.52232974219709, 44.885508160793265, 68.91867830322816, 3.8680082557171263, 13.8682662061472, 618.8617483684673, 113.45330071182715, 311.10703172174715, 407.52309022125297, 1108.249811912978, 557.2814138099889, 18.144484362967475, 54.921183674406905, 32.59863479713771, 52.89999532497114, 3.9079631419587866, 350.33022507113077, 1129.015333386674, 61.23028199128746, 314.2732727705971, 12.117034710453208, 58.135493881184885, 988.699658871529, 245.95131069805598, 1.6318997776844348, 126.27829606872781, 41.58291365864739, 712.674091672519, 32.65509049203034, 875.5018576219055, 34.20798339930173, 34.54829926663464, 8.801066721007164, 1122.4619303422546, 42.69796107560001, 847.5114129565351, 835.3303966461008, 3.9550176681717613, 17.767354416221398, 1018.0338252552848, 4.299910491461621, 48.73854210933236, 1026.7928658143835, 44.32410613546349, 12.287211052031992, 1253.8791990765094, 1187.2833242952236, 534.6012741365497, 0.0, 16.228825336550777, 17.847497160939405, 33.68133359103757, 917.0294379987762, 14.073263962929959, 66.04999512040456, 1.70133497382419, 24.089762266161326, 9.320965602669707, 1.7296346276025611, 19.89323999139387, 17.83916626880556, 53.68744944229155, 380.4993111862923, 87.08211601821044, 103.78470764781044, 7.917545362485933, 454.4996740767928, 52.35733699725654, 1041.2132177664964, 1095.3653506877913, 1171.8012397381012, 34.20685547161733, 28.093944507460904, 21.800077479502896, 38.758069739201474, 7.7280483392388835, 2.2577029284276278, 5.857943259926239, 27.961588830272472, 493.1251755275586, 599.6226854213525, 0.0, 26.456215449536757, 2.162734008303699, 14.812424561489927, 12.644545391824185, 37.87366133474086, 10.0, 801.7661435144371, 26.798509451407327, 94.46049879369053, 117.21271479410774, 508.7411390999434, 1145.4291081541594, 18.593572812105794, 894.4963986398373, 21.055755689630804, 853.2989133587689, 12.746918330673836, 282.99199092883555, 11.059726899200353, 7.98070133676721, 1.5177287216038904, 1.6467445447720608, 47.91436222039282, 515.9362784309595, 0.0, 58.594182705005764, 64.30691834222289, 107.61024409150615, 670.2752235672535, 12.326670944820194, 266.01523799360456, 9.186186633275042, 154.1007573717605, 493.8840133072383, 41.50393028202065, 1009.3986160242907, 1047.2738211425242, 65.68230389002093, 3.123829085743978, 814.2231559863502, 989.0937554682112, 349.0691888978696, 915.6687802522059, 53.64055940881757, 10.801482348130119, 920.1275679293124, 98.19631615298402, 57.27018186849299, 15.216953043237499, 28.199820873262546, 6.205233484712016, 641.7658649389081, 112.9780421648731, 145.1443358471407, 3.9212229247477812, 9.765481602737179, 21.585325422417917, 5.540747208562714, 1044.589265287551, 147.3436076030527, 365.84952736389266, 61.07087542623443, 434.40719592006604, 0.0, 22.25542596955936, 203.77422740520547, 6.454810815752125, 2.15541464885258, 4.851959820417811, 420.90812444671366, 81.90768251311913, 27.721802435566186, 44.73976426939883, 74.76932934321988, 35.356554964321965, 293.34029643829183, 112.74465407200839, 0.0, 14.378740043218196, 216.81569560807992, 171.74858690362979, 24.389771582393994, 139.6056495834785, 146.88523736488597, 124.59681858221418, 20.614450800789573, 104.37430562350498, 39.717314841225914, 80.10297690504662, 348.1628524815382, 175.23202140512763, 349.46738472098093, 77.94946622065042, 7.227182460887376, 32.27605443728134, 73.63703405840167, 63.04628324173486, 91.97294348849297, 1.9470691567719018, 20.883261114444746, 66.4444494731383, 34.7064148834127, 145.3691861392478, 65.53072927835913, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5236645521111891, "mean_inference_ms": 1.3448404911058833, "mean_action_processing_ms": 0.22158547356809227, "mean_env_wait_ms": 0.17637811266602377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004484653472900391, "StateBufferConnector_ms": 0.0030478239059448242, "ViewRequirementAgentConnector_ms": 0.08760404586791992}, "num_episodes": 18, "episode_return_max": 721.1518896040491, "episode_return_min": -773.3683379135424, "episode_return_mean": -3.7094935257172175, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.1655923352662, "num_env_steps_trained_throughput_per_sec": 330.1655923352662, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 10487.173, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10487.135, "sample_time_ms": 1183.728, "learn_time_ms": 9289.145, "learn_throughput": 430.61, "synch_weights_time_ms": 13.047}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "74486_00000", "date": "2024-08-16_14-59-31", "timestamp": 1723800571, "time_this_iter_s": 12.183143854141235, "time_total_s": 240.4182789325714, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39736e790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 240.4182789325714, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 38.27222222222222, "ram_util_percent": 79.51666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5755923798475315, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9086537652545505, "policy_loss": -0.005868518357066605, "vf_loss": 2.9132535975446148, "vf_explained_var": 0.006518979993446794, "kl": 0.006343436452809944, "entropy": 1.3810843967886828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1544621003525597, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.270301114062153, "policy_loss": -0.009022125552492167, "vf_loss": 2.277307404979827, "vf_explained_var": 0.02032269479105712, "kl": 0.010079186563131623, "entropy": 1.2917037587317208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 721.1518896040491, "episode_reward_min": -630.9041822372534, "episode_reward_mean": 13.209785645493906, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1260.549166481885, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.33673603706976, "predator_policy": 1253.8791990765094}, "policy_reward_mean": {"prey_policy": -198.47747644636635, "predator_policy": 205.0823692691133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.269999999999971, -24.392317960364714, 2.3399999999999803, 2.019999999999971, 3.829999999999962, 1.8699999999999601, 662.9835013458018, 3.9099999999999597, -232.59776140259956, 1.8999999999999808, 3.8599999999999604, 122.04404341269036, 2.869999999999979, 13.180659142625027, -477.9579749418865, 54.079999999999494, 3.8999999999999604, 28.700000000000557, 23.62000000000052, 3.8499999999999597, 5.390159243066456, 3.589999999999963, 1.8599999999999763, 641.8064551940203, 4.789999999999941, 3.7499999999999623, 3.9499999999999593, 3.8399999999999612, 280.66035530414314, 3.8899999999999597, 3.90999999999996, -24.06169593290235, 6.569999999999948, 34.41334498034349, -39.88932537758974, -630.9041822372534, 1.9999999999999682, -98.57535054200996, 8.66048281676373, 6.919999999999916, 15.71999999999992, 2.789999999999978, 7.318669441598185, -227.74225886573072, -188.63036291658634, 3.489999999999972, 2.539999999999983, 721.1518896040491, 9.669999999999959, 547.0645539857519, 242.905135548996, 6.79999999999992, 1.7399999999999718, 8.75999999999992, 0.09769140853996182, -367.01107935271153, 7.641222924747702, 3.909999999999961, 2.0099999999999834, 1.9800000000000004, -52.473254288659746, 4.899999999999937, 3.5099999999999696, 3.969999999999959, 10.107155605633887, 5.6199999999999255, 14.409999999999927, 10.589999999999945, 8.63753428607254, 103.1008089898924, -4.9320650560029495, 20.662720063656014, -15.984308667674824, 3.989140862941455, 7.009999999999957, 2.699999999999984, 36.46999999999943, 21.932163460064775, 5.699999999999923, 12.25953366895944, 3.259999999999974, 18.6900000000004, 48.554302469890175, 15.259083515824102, 5.89916776656655, 3.9099999999999615, 3.8799999999999613, 41.59178047488301, 20.815006491773698, 3.429999999999972, 10.859999999999923, 23.049999999999997, 3.799999999999961, 43.37817467130286, 3.129999999999973, 65.5849617649829, -91.5053120214297, 26.075292987926872, -367.7591773207132, 8.839999999999963], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-244.6713106980555, 0.35810022231556665, -98.58193662379745, -93.67159106394229, -712.2340916725187, -30.755090492030224, -875.3718576219056, -32.31798339930211, -32.6782992666349, -6.841066721007206, -1122.4619303422546, -40.827961075600385, -1020.117522743357, 0.259214486523007, -1.9750176681718028, -15.837354416221126, -975.0010457247615, -279.9304514245839, -46.838542109332735, -1026.7928658143835, -44.00661677647198, -8.74470041102392, -1161.730216374476, -1157.3882635845662, -533.7312741365492, 2.0000000000000013, -17.824352702856608, -3.071310652008199, -744.8970066254138, -683.7717399062865, 38.33673603706976, -64.37999512040396, -7.372893926403087, -14.518203313582427, -7.360965602669749, 25.01036537239771, 1.8167600086061306, -15.929166268805286, -50.867449442291914, -379.4693111862932, -63.98666957535498, -121.4899948475986, -4.967545362485975, -453.8596740767934, -50.49733699725691, -1041.2132177664964, -1260.549166481885, -364.81096874998696, -31.30685547161746, -26.20394450746061, -19.8800774795026, -36.92806973920184, 2.0000000000000013, -8.035751267666553, -3.8879432599262813, -26.09158883027218, -655.4879891531118, -156.5995164916553, 2.0000000000000013, -24.56621544953646, -0.17273400830370078, -12.892424561489968, -46.936438222393726, -27.643464437074076, -8.05000000000003, -797.146143514437, -10.978019621288182, -75.86764364346513, -171.7597850982171, -494.0833941734232, -1089.9649682707557, -704.961894932763, -894.4163986398373, -19.135755689630503, -719.0815772276198, -245.539605003836, -281.8419909288353, -3.5492440824365987, -6.020701336767252, 3.4422712783960794, -20.57459098735487, -13.266515777809765, -515.1462784309598, 2.0000000000000013, -48.0808525539763, -67.50157905165338, -580.0206904851414, -425.60703603934957, -240.71514229699474, -226.25712955801623, -155.90244555601546, -3.8944984490202668, -493.2440133072386, -39.603930282021025, -1216.7301449605945, -118.79040260217046, 2.98999999999998, -62.1261329757647, -1053.539051811966, -202.71330565684394, 0.1638133778482735, -1021.9966469789274, -51.76055940881795, -5.8814823481301595, -919.9575679293124, -96.62631615298326, -50.45018186849335, -13.27695304323754, -10.165093086157455, -24.142269863276855, -467.63247833339284, -654.1225081230994, 2.0000000000000013, -143.4243358471421, -7.795481602737221, -19.645325422417613, -3.5707472085627563, -1044.549265287551, -145.91360760305315, -365.29952736389265, -379.39293235584057, -168.55839327912128, 2.9899999999999793, -20.345425969559063, -202.2342274052055, -4.484810815752167, 2.0000000000000013, -5.037374469270433, -475.6054217565923, -17.10322959760698, -25.89180243556597, -40.949764269399026, -73.11932934321918, -22.59655496432169, -292.1702964382929, -103.3246540720083, -2.8146473091196462, -2.926558448026011, -258.6998137217678, -26.76365980005233, -49.228163180084515, -119.69932304179041, -11.056684585116505, -239.7626512983288, -65.60981222474034, -75.36325286722771, -59.96811786344609, -55.86303301988568, -347.48285248153815, -168.9020214051288, -348.3873847209818, -76.32946622064972, 6.198325258091236, -9.231562156260024, 2.0000000000000013, -116.75115384007138, -88.2629434884921, 0.04293084322809976, -41.41888681442187, -33.64929010420192, -107.55409136549837, -69.26150965716076, -26.56365236724448, -20.277076911114378, -136.90175128879216, 12.219839472484487, -23.825768450421982, -65.46288405798222, -17.330990794160325, -159.09688150271842, -2.4558176141290335, -14.001014255139024, -8.171033500529228, -16.55938093689815, -5.312478812424548, -71.45417558240176, -73.23195712967204, -151.14620778728147, -124.40735760189018, -86.56763582572069, -2.718770575114511, -1.7747589177467502, -37.49264612988527, -341.4663485495013, -36.34691166839725, -22.878604837005266, -157.38036433553864, 15.445299964375003, -184.43478531145908, -40.8765157585612, -104.98667722669889, -1.6872553448621046, -361.1648569701925, -330.213932109949, -14.231501527179859, -4.153786623379791, -443.5068288260912, -465.61705455932736, 1.522271699074015, -18.494274756099696], "policy_predator_policy_reward": [245.95131069805598, 1.6318997776844348, 126.27829606872781, 41.58291365864739, 712.674091672519, 32.65509049203034, 875.5018576219055, 34.20798339930173, 34.54829926663464, 8.801066721007164, 1122.4619303422546, 42.69796107560001, 847.5114129565351, 835.3303966461008, 3.9550176681717613, 17.767354416221398, 1018.0338252552848, 4.299910491461621, 48.73854210933236, 1026.7928658143835, 44.32410613546349, 12.287211052031992, 1253.8791990765094, 1187.2833242952236, 534.6012741365497, 0.0, 16.228825336550777, 17.847497160939405, 33.68133359103757, 917.0294379987762, 14.073263962929959, 66.04999512040456, 1.70133497382419, 24.089762266161326, 9.320965602669707, 1.7296346276025611, 19.89323999139387, 17.83916626880556, 53.68744944229155, 380.4993111862923, 87.08211601821044, 103.78470764781044, 7.917545362485933, 454.4996740767928, 52.35733699725654, 1041.2132177664964, 1095.3653506877913, 1171.8012397381012, 34.20685547161733, 28.093944507460904, 21.800077479502896, 38.758069739201474, 7.7280483392388835, 2.2577029284276278, 5.857943259926239, 27.961588830272472, 493.1251755275586, 599.6226854213525, 0.0, 26.456215449536757, 2.162734008303699, 14.812424561489927, 12.644545391824185, 37.87366133474086, 10.0, 801.7661435144371, 26.798509451407327, 94.46049879369053, 117.21271479410774, 508.7411390999434, 1145.4291081541594, 18.593572812105794, 894.4963986398373, 21.055755689630804, 853.2989133587689, 12.746918330673836, 282.99199092883555, 11.059726899200353, 7.98070133676721, 1.5177287216038904, 1.6467445447720608, 47.91436222039282, 515.9362784309595, 0.0, 58.594182705005764, 64.30691834222289, 107.61024409150615, 670.2752235672535, 12.326670944820194, 266.01523799360456, 9.186186633275042, 154.1007573717605, 493.8840133072383, 41.50393028202065, 1009.3986160242907, 1047.2738211425242, 65.68230389002093, 3.123829085743978, 814.2231559863502, 989.0937554682112, 349.0691888978696, 915.6687802522059, 53.64055940881757, 10.801482348130119, 920.1275679293124, 98.19631615298402, 57.27018186849299, 15.216953043237499, 28.199820873262546, 6.205233484712016, 641.7658649389081, 112.9780421648731, 145.1443358471407, 3.9212229247477812, 9.765481602737179, 21.585325422417917, 5.540747208562714, 1044.589265287551, 147.3436076030527, 365.84952736389266, 61.07087542623443, 434.40719592006604, 0.0, 22.25542596955936, 203.77422740520547, 6.454810815752125, 2.15541464885258, 4.851959820417811, 420.90812444671366, 81.90768251311913, 27.721802435566186, 44.73976426939883, 74.76932934321988, 35.356554964321965, 293.34029643829183, 112.74465407200839, 0.0, 14.378740043218196, 216.81569560807992, 171.74858690362979, 24.389771582393994, 139.6056495834785, 146.88523736488597, 124.59681858221418, 20.614450800789573, 104.37430562350498, 39.717314841225914, 80.10297690504662, 348.1628524815382, 175.23202140512763, 349.46738472098093, 77.94946622065042, 7.227182460887376, 32.27605443728134, 73.63703405840167, 63.04628324173486, 91.97294348849297, 1.9470691567719018, 20.883261114444746, 66.4444494731383, 34.7064148834127, 145.3691861392478, 65.53072927835913, 0.0, 104.00412438831347, 69.23208989788347, 57.323227073234, 47.22450895099562, 107.37413191219595, 74.95290815124906, 10.480002250475547, 9.886829618792426, 10.131033500529186, 18.47938093689845, 62.16003550768396, 56.19839936202691, 146.2354167076972, 98.95775470102974, 115.9234507594233, 98.48154266818932, 4.698770575114469, 10.654758917746717, 60.082646129884964, 341.9263485495012, 38.25691166839687, 24.76860483700556, 27.45234359407819, 157.86089544838762, 185.6447853114583, 42.796515758560815, 96.46382983594806, 75.79506450059633, 317.69336899531174, 282.18010806339885, 10.882388856119364, 33.578192282366864, 525.3179797186009, 16.04672634610487, 5.407728300925962, 20.404274756099994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5280880101098441, "mean_inference_ms": 1.3651364579684115, "mean_action_processing_ms": 0.23293555010950331, "mean_env_wait_ms": 0.17807724124429464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005550384521484375, "StateBufferConnector_ms": 0.003454446792602539, "ViewRequirementAgentConnector_ms": 0.1084890365600586}, "num_episodes": 18, "episode_return_max": 721.1518896040491, "episode_return_min": -630.9041822372534, "episode_return_mean": 13.209785645493906, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.8532772245338, "num_env_steps_trained_throughput_per_sec": 296.8532772245338, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 10850.863, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10850.825, "sample_time_ms": 1395.613, "learn_time_ms": 9440.72, "learn_throughput": 423.697, "synch_weights_time_ms": 13.261}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "74486_00000", "date": "2024-08-16_14-59-44", "timestamp": 1723800584, "time_this_iter_s": 13.481745958328247, "time_total_s": 253.90002489089966, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39736ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 253.90002489089966, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 47.4, "ram_util_percent": 80.29473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4508663485132198, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2905839884407304, "policy_loss": -0.0069586147337402935, "vf_loss": 2.2967523062355304, "vf_explained_var": 0.004177918635978901, "kl": 0.003951472810880965, "entropy": 1.3766125335895196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0475124234244937, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1613520291116504, "policy_loss": -0.006869024324856659, "vf_loss": 2.1672654472961628, "vf_explained_var": 0.017034039863202937, "kl": 0.004778020515444526, "entropy": 1.3191567391945571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 721.1518896040491, "episode_reward_min": -630.9041822372534, "episode_reward_mean": 13.39818480814188, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1260.549166481885, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.445299964375003, "predator_policy": 1171.8012397381012}, "policy_reward_mean": {"prey_policy": -153.43421112944483, "predator_policy": 160.13330353351574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.62000000000052, 3.8499999999999597, 5.390159243066456, 3.589999999999963, 1.8599999999999763, 641.8064551940203, 4.789999999999941, 3.7499999999999623, 3.9499999999999593, 3.8399999999999612, 280.66035530414314, 3.8899999999999597, 3.90999999999996, -24.06169593290235, 6.569999999999948, 34.41334498034349, -39.88932537758974, -630.9041822372534, 1.9999999999999682, -98.57535054200996, 8.66048281676373, 6.919999999999916, 15.71999999999992, 2.789999999999978, 7.318669441598185, -227.74225886573072, -188.63036291658634, 3.489999999999972, 2.539999999999983, 721.1518896040491, 9.669999999999959, 547.0645539857519, 242.905135548996, 6.79999999999992, 1.7399999999999718, 8.75999999999992, 0.09769140853996182, -367.01107935271153, 7.641222924747702, 3.909999999999961, 2.0099999999999834, 1.9800000000000004, -52.473254288659746, 4.899999999999937, 3.5099999999999696, 3.969999999999959, 10.107155605633887, 5.6199999999999255, 14.409999999999927, 10.589999999999945, 8.63753428607254, 103.1008089898924, -4.9320650560029495, 20.662720063656014, -15.984308667674824, 3.989140862941455, 7.009999999999957, 2.699999999999984, 36.46999999999943, 21.932163460064775, 5.699999999999923, 12.25953366895944, 3.259999999999974, 18.6900000000004, 48.554302469890175, 15.259083515824102, 5.89916776656655, 3.9099999999999615, 3.8799999999999613, 41.59178047488301, 20.815006491773698, 3.429999999999972, 10.859999999999923, 23.049999999999997, 3.799999999999961, 43.37817467130286, 3.129999999999973, 65.5849617649829, -91.5053120214297, 26.075292987926872, -367.7591773207132, 8.839999999999963, 4.939999999999937, 3.6699999999999666, 7.959999999999916, 8.819999999999919, 3.8999999999999617, 3.819999999999959, 23.661362010620888, 3.779999999999964, 3.7799999999999625, 4.559999999999945, 1.8099999999999972, 3.8599999999999612, 2.35471097139325, 4.563700543761245, 16.515646432699565, 23.66472023153164, 46.929999999999794, 26.059925671057634], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.8167600086061306, -15.929166268805286, -50.867449442291914, -379.4693111862932, -63.98666957535498, -121.4899948475986, -4.967545362485975, -453.8596740767934, -50.49733699725691, -1041.2132177664964, -1260.549166481885, -364.81096874998696, -31.30685547161746, -26.20394450746061, -19.8800774795026, -36.92806973920184, 2.0000000000000013, -8.035751267666553, -3.8879432599262813, -26.09158883027218, -655.4879891531118, -156.5995164916553, 2.0000000000000013, -24.56621544953646, -0.17273400830370078, -12.892424561489968, -46.936438222393726, -27.643464437074076, -8.05000000000003, -797.146143514437, -10.978019621288182, -75.86764364346513, -171.7597850982171, -494.0833941734232, -1089.9649682707557, -704.961894932763, -894.4163986398373, -19.135755689630503, -719.0815772276198, -245.539605003836, -281.8419909288353, -3.5492440824365987, -6.020701336767252, 3.4422712783960794, -20.57459098735487, -13.266515777809765, -515.1462784309598, 2.0000000000000013, -48.0808525539763, -67.50157905165338, -580.0206904851414, -425.60703603934957, -240.71514229699474, -226.25712955801623, -155.90244555601546, -3.8944984490202668, -493.2440133072386, -39.603930282021025, -1216.7301449605945, -118.79040260217046, 2.98999999999998, -62.1261329757647, -1053.539051811966, -202.71330565684394, 0.1638133778482735, -1021.9966469789274, -51.76055940881795, -5.8814823481301595, -919.9575679293124, -96.62631615298326, -50.45018186849335, -13.27695304323754, -10.165093086157455, -24.142269863276855, -467.63247833339284, -654.1225081230994, 2.0000000000000013, -143.4243358471421, -7.795481602737221, -19.645325422417613, -3.5707472085627563, -1044.549265287551, -145.91360760305315, -365.29952736389265, -379.39293235584057, -168.55839327912128, 2.9899999999999793, -20.345425969559063, -202.2342274052055, -4.484810815752167, 2.0000000000000013, -5.037374469270433, -475.6054217565923, -17.10322959760698, -25.89180243556597, -40.949764269399026, -73.11932934321918, -22.59655496432169, -292.1702964382929, -103.3246540720083, -2.8146473091196462, -2.926558448026011, -258.6998137217678, -26.76365980005233, -49.228163180084515, -119.69932304179041, -11.056684585116505, -239.7626512983288, -65.60981222474034, -75.36325286722771, -59.96811786344609, -55.86303301988568, -347.48285248153815, -168.9020214051288, -348.3873847209818, -76.32946622064972, 6.198325258091236, -9.231562156260024, 2.0000000000000013, -116.75115384007138, -88.2629434884921, 0.04293084322809976, -41.41888681442187, -33.64929010420192, -107.55409136549837, -69.26150965716076, -26.56365236724448, -20.277076911114378, -136.90175128879216, 12.219839472484487, -23.825768450421982, -65.46288405798222, -17.330990794160325, -159.09688150271842, -2.4558176141290335, -14.001014255139024, -8.171033500529228, -16.55938093689815, -5.312478812424548, -71.45417558240176, -73.23195712967204, -151.14620778728147, -124.40735760189018, -86.56763582572069, -2.718770575114511, -1.7747589177467502, -37.49264612988527, -341.4663485495013, -36.34691166839725, -22.878604837005266, -157.38036433553864, 15.445299964375003, -184.43478531145908, -40.8765157585612, -104.98667722669889, -1.6872553448621046, -361.1648569701925, -330.213932109949, -14.231501527179859, -4.153786623379791, -443.5068288260912, -465.61705455932736, 1.522271699074015, -18.494274756099696, -6.433304491817925, 0.09047314394648187, -33.33132113045791, -60.435637865394206, 2.0000000000000013, 5.959999999999958, -45.03140282190652, -7.076949038526875, -6.652760540680951, -13.810288834818515, -42.15568648193824, -2.2578606086000077, -66.43968401862797, -6.797074761005694, -28.263430742681418, -11.751144271239362, -14.232564177549333, -44.841519907346466, -31.945077062227625, -59.0987166681861, -112.20100551556206, -457.76024101956796, -13.673924874761406, -16.476437775692784, -94.93019620295286, -1.1141298212154018, -56.97768528191236, -37.34160622162912, -117.00051987924833, -48.98661238482872, -6.778690302795331, -66.65344549313214, -325.2946220889676, -47.78768702710304, -1.7618446919192468, -153.84337964761994], "policy_predator_policy_reward": [19.89323999139387, 17.83916626880556, 53.68744944229155, 380.4993111862923, 87.08211601821044, 103.78470764781044, 7.917545362485933, 454.4996740767928, 52.35733699725654, 1041.2132177664964, 1095.3653506877913, 1171.8012397381012, 34.20685547161733, 28.093944507460904, 21.800077479502896, 38.758069739201474, 7.7280483392388835, 2.2577029284276278, 5.857943259926239, 27.961588830272472, 493.1251755275586, 599.6226854213525, 0.0, 26.456215449536757, 2.162734008303699, 14.812424561489927, 12.644545391824185, 37.87366133474086, 10.0, 801.7661435144371, 26.798509451407327, 94.46049879369053, 117.21271479410774, 508.7411390999434, 1145.4291081541594, 18.593572812105794, 894.4963986398373, 21.055755689630804, 853.2989133587689, 12.746918330673836, 282.99199092883555, 11.059726899200353, 7.98070133676721, 1.5177287216038904, 1.6467445447720608, 47.91436222039282, 515.9362784309595, 0.0, 58.594182705005764, 64.30691834222289, 107.61024409150615, 670.2752235672535, 12.326670944820194, 266.01523799360456, 9.186186633275042, 154.1007573717605, 493.8840133072383, 41.50393028202065, 1009.3986160242907, 1047.2738211425242, 65.68230389002093, 3.123829085743978, 814.2231559863502, 989.0937554682112, 349.0691888978696, 915.6687802522059, 53.64055940881757, 10.801482348130119, 920.1275679293124, 98.19631615298402, 57.27018186849299, 15.216953043237499, 28.199820873262546, 6.205233484712016, 641.7658649389081, 112.9780421648731, 145.1443358471407, 3.9212229247477812, 9.765481602737179, 21.585325422417917, 5.540747208562714, 1044.589265287551, 147.3436076030527, 365.84952736389266, 61.07087542623443, 434.40719592006604, 0.0, 22.25542596955936, 203.77422740520547, 6.454810815752125, 2.15541464885258, 4.851959820417811, 420.90812444671366, 81.90768251311913, 27.721802435566186, 44.73976426939883, 74.76932934321988, 35.356554964321965, 293.34029643829183, 112.74465407200839, 0.0, 14.378740043218196, 216.81569560807992, 171.74858690362979, 24.389771582393994, 139.6056495834785, 146.88523736488597, 124.59681858221418, 20.614450800789573, 104.37430562350498, 39.717314841225914, 80.10297690504662, 348.1628524815382, 175.23202140512763, 349.46738472098093, 77.94946622065042, 7.227182460887376, 32.27605443728134, 73.63703405840167, 63.04628324173486, 91.97294348849297, 1.9470691567719018, 20.883261114444746, 66.4444494731383, 34.7064148834127, 145.3691861392478, 65.53072927835913, 0.0, 104.00412438831347, 69.23208989788347, 57.323227073234, 47.22450895099562, 107.37413191219595, 74.95290815124906, 10.480002250475547, 9.886829618792426, 10.131033500529186, 18.47938093689845, 62.16003550768396, 56.19839936202691, 146.2354167076972, 98.95775470102974, 115.9234507594233, 98.48154266818932, 4.698770575114469, 10.654758917746717, 60.082646129884964, 341.9263485495012, 38.25691166839687, 24.76860483700556, 27.45234359407819, 157.86089544838762, 185.6447853114583, 42.796515758560815, 96.46382983594806, 75.79506450059633, 317.69336899531174, 282.18010806339885, 10.882388856119364, 33.578192282366864, 525.3179797186009, 16.04672634610487, 5.407728300925962, 20.404274756099994, 9.383304491817883, 1.8995268560535197, 73.35284507947019, 24.084113916381444, 0.0, 0.0, 46.94140282190614, 13.986949038526834, 11.991028903622508, 12.372020471876874, 10.572327838823405, 37.66121925171443, 36.3980324365798, 60.50008835367502, 30.103430742681706, 13.69114427123932, 16.16256417754932, 46.6915199073461, 68.14581170013822, 27.457982030275204, 113.7310055155627, 458.0402410195677, 15.603924874761365, 18.406437775693085, 4.478475675554252, 93.92056132000812, 65.17769432473638, 33.705297722565696, 65.61423613873575, 116.88854255804122, 69.87250379246987, 27.22435223498954, 325.964622088967, 94.04768702710334, 153.15430671872204, 28.510843291873222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5325583669119411, "mean_inference_ms": 1.3880570465722486, "mean_action_processing_ms": 0.2439033501525889, "mean_env_wait_ms": 0.17974472146448528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006096243858337402, "StateBufferConnector_ms": 0.0035278797149658203, "ViewRequirementAgentConnector_ms": 0.11137425899505615}, "num_episodes": 18, "episode_return_max": 721.1518896040491, "episode_return_min": -630.9041822372534, "episode_return_mean": 13.39818480814188, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.9345583638951, "num_env_steps_trained_throughput_per_sec": 357.9345583638951, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 11035.555, "restore_workers_time_ms": 0.011, "training_step_time_ms": 11035.517, "sample_time_ms": 1435.461, "learn_time_ms": 9585.534, "learn_throughput": 417.295, "synch_weights_time_ms": 13.291}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "74486_00000", "date": "2024-08-16_14-59-56", "timestamp": 1723800596, "time_this_iter_s": 11.184499263763428, "time_total_s": 265.0845241546631, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39737f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 265.0845241546631, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 32.162499999999994, "ram_util_percent": 80.16250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.876538841591941, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7211355156368677, "policy_loss": -0.009626785961162083, "vf_loss": 3.72932871308907, "vf_explained_var": 0.016162138925027596, "kl": 0.014335936306070846, "entropy": 1.3535842610414697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.055794092161315, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.682894380824276, "policy_loss": -0.009641421742481057, "vf_loss": 2.6915072018507296, "vf_explained_var": 0.015548874934514364, "kl": 0.010286032860898481, "entropy": 1.261003561183889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 721.1518896040491, "episode_reward_min": -367.7591773207132, "episode_reward_mean": 12.782755935809744, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1216.7301449605945, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 39.95611959188445, "predator_policy": 1047.2738211425242}, "policy_reward_mean": {"prey_policy": -117.14656983579374, "predator_policy": 123.53794780369859}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.71999999999992, 2.789999999999978, 7.318669441598185, -227.74225886573072, -188.63036291658634, 3.489999999999972, 2.539999999999983, 721.1518896040491, 9.669999999999959, 547.0645539857519, 242.905135548996, 6.79999999999992, 1.7399999999999718, 8.75999999999992, 0.09769140853996182, -367.01107935271153, 7.641222924747702, 3.909999999999961, 2.0099999999999834, 1.9800000000000004, -52.473254288659746, 4.899999999999937, 3.5099999999999696, 3.969999999999959, 10.107155605633887, 5.6199999999999255, 14.409999999999927, 10.589999999999945, 8.63753428607254, 103.1008089898924, -4.9320650560029495, 20.662720063656014, -15.984308667674824, 3.989140862941455, 7.009999999999957, 2.699999999999984, 36.46999999999943, 21.932163460064775, 5.699999999999923, 12.25953366895944, 3.259999999999974, 18.6900000000004, 48.554302469890175, 15.259083515824102, 5.89916776656655, 3.9099999999999615, 3.8799999999999613, 41.59178047488301, 20.815006491773698, 3.429999999999972, 10.859999999999923, 23.049999999999997, 3.799999999999961, 43.37817467130286, 3.129999999999973, 65.5849617649829, -91.5053120214297, 26.075292987926872, -367.7591773207132, 8.839999999999963, 4.939999999999937, 3.6699999999999666, 7.959999999999916, 8.819999999999919, 3.8999999999999617, 3.819999999999959, 23.661362010620888, 3.779999999999964, 3.7799999999999625, 4.559999999999945, 1.8099999999999972, 3.8599999999999612, 2.35471097139325, 4.563700543761245, 16.515646432699565, 23.66472023153164, 46.929999999999794, 26.059925671057634, 27.55000000000037, 49.63999999999987, 17.54930769856543, 13.619999999999923, 40.44967747327771, 94.81000000000037, 29.249999999999986, 24.72000000000023, 40.7154984574902, 4.87999999999996, 12.836994030906782, 23.98508987328519, -366.97708923830515, 3.397479343646839, -4.975580992827627, 99.5844156520564, 18.87803176313072, 2.809999999999978, 7.0467696238348925, 3.799999999999961, 19.539999999999992, 25.386762530305727], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.57459098735487, -13.266515777809765, -515.1462784309598, 2.0000000000000013, -48.0808525539763, -67.50157905165338, -580.0206904851414, -425.60703603934957, -240.71514229699474, -226.25712955801623, -155.90244555601546, -3.8944984490202668, -493.2440133072386, -39.603930282021025, -1216.7301449605945, -118.79040260217046, 2.98999999999998, -62.1261329757647, -1053.539051811966, -202.71330565684394, 0.1638133778482735, -1021.9966469789274, -51.76055940881795, -5.8814823481301595, -919.9575679293124, -96.62631615298326, -50.45018186849335, -13.27695304323754, -10.165093086157455, -24.142269863276855, -467.63247833339284, -654.1225081230994, 2.0000000000000013, -143.4243358471421, -7.795481602737221, -19.645325422417613, -3.5707472085627563, -1044.549265287551, -145.91360760305315, -365.29952736389265, -379.39293235584057, -168.55839327912128, 2.9899999999999793, -20.345425969559063, -202.2342274052055, -4.484810815752167, 2.0000000000000013, -5.037374469270433, -475.6054217565923, -17.10322959760698, -25.89180243556597, -40.949764269399026, -73.11932934321918, -22.59655496432169, -292.1702964382929, -103.3246540720083, -2.8146473091196462, -2.926558448026011, -258.6998137217678, -26.76365980005233, -49.228163180084515, -119.69932304179041, -11.056684585116505, -239.7626512983288, -65.60981222474034, -75.36325286722771, -59.96811786344609, -55.86303301988568, -347.48285248153815, -168.9020214051288, -348.3873847209818, -76.32946622064972, 6.198325258091236, -9.231562156260024, 2.0000000000000013, -116.75115384007138, -88.2629434884921, 0.04293084322809976, -41.41888681442187, -33.64929010420192, -107.55409136549837, -69.26150965716076, -26.56365236724448, -20.277076911114378, -136.90175128879216, 12.219839472484487, -23.825768450421982, -65.46288405798222, -17.330990794160325, -159.09688150271842, -2.4558176141290335, -14.001014255139024, -8.171033500529228, -16.55938093689815, -5.312478812424548, -71.45417558240176, -73.23195712967204, -151.14620778728147, -124.40735760189018, -86.56763582572069, -2.718770575114511, -1.7747589177467502, -37.49264612988527, -341.4663485495013, -36.34691166839725, -22.878604837005266, -157.38036433553864, 15.445299964375003, -184.43478531145908, -40.8765157585612, -104.98667722669889, -1.6872553448621046, -361.1648569701925, -330.213932109949, -14.231501527179859, -4.153786623379791, -443.5068288260912, -465.61705455932736, 1.522271699074015, -18.494274756099696, -6.433304491817925, 0.09047314394648187, -33.33132113045791, -60.435637865394206, 2.0000000000000013, 5.959999999999958, -45.03140282190652, -7.076949038526875, -6.652760540680951, -13.810288834818515, -42.15568648193824, -2.2578606086000077, -66.43968401862797, -6.797074761005694, -28.263430742681418, -11.751144271239362, -14.232564177549333, -44.841519907346466, -31.945077062227625, -59.0987166681861, -112.20100551556206, -457.76024101956796, -13.673924874761406, -16.476437775692784, -94.93019620295286, -1.1141298212154018, -56.97768528191236, -37.34160622162912, -117.00051987924833, -48.98661238482872, -6.778690302795331, -66.65344549313214, -325.2946220889676, -47.78768702710304, -1.7618446919192468, -153.84337964761994, -10.436040052081847, -4.113989694052799, -135.9261269457451, -345.50851673784877, -25.160738571448192, 2.0000000000000013, 11.89999999999996, -80.40481094207308, -25.328635556650077, -39.37486785019868, 39.95611959188445, -8.067079786984284, -71.387786144949, -43.02673693115385, 1.687423617765129, 3.441719059061874, -123.75154108062961, 2.0000000000000013, -2.3564614114718037, -26.956693043323625, -6.205523328980483, -6.690299186202742, 2.2550898732846427, 5.615928617686011, -433.08095777717745, -494.58087930819806, -56.15538778021284, -24.78925985693823, -39.88544592673452, -126.54869443109934, 6.002106611388687, -225.03855654392586, -92.74098253984425, -47.87043886207003, -174.65250489148914, -151.74230139567527, -67.4720739067047, -95.03492929089921, -10.516169166858381, -37.424138686567694, -29.959234546531995, -40.65553312870538, -104.37941752390395, -7.518980324291823], "policy_predator_policy_reward": [1.6467445447720608, 47.91436222039282, 515.9362784309595, 0.0, 58.594182705005764, 64.30691834222289, 107.61024409150615, 670.2752235672535, 12.326670944820194, 266.01523799360456, 9.186186633275042, 154.1007573717605, 493.8840133072383, 41.50393028202065, 1009.3986160242907, 1047.2738211425242, 65.68230389002093, 3.123829085743978, 814.2231559863502, 989.0937554682112, 349.0691888978696, 915.6687802522059, 53.64055940881757, 10.801482348130119, 920.1275679293124, 98.19631615298402, 57.27018186849299, 15.216953043237499, 28.199820873262546, 6.205233484712016, 641.7658649389081, 112.9780421648731, 145.1443358471407, 3.9212229247477812, 9.765481602737179, 21.585325422417917, 5.540747208562714, 1044.589265287551, 147.3436076030527, 365.84952736389266, 61.07087542623443, 434.40719592006604, 0.0, 22.25542596955936, 203.77422740520547, 6.454810815752125, 2.15541464885258, 4.851959820417811, 420.90812444671366, 81.90768251311913, 27.721802435566186, 44.73976426939883, 74.76932934321988, 35.356554964321965, 293.34029643829183, 112.74465407200839, 0.0, 14.378740043218196, 216.81569560807992, 171.74858690362979, 24.389771582393994, 139.6056495834785, 146.88523736488597, 124.59681858221418, 20.614450800789573, 104.37430562350498, 39.717314841225914, 80.10297690504662, 348.1628524815382, 175.23202140512763, 349.46738472098093, 77.94946622065042, 7.227182460887376, 32.27605443728134, 73.63703405840167, 63.04628324173486, 91.97294348849297, 1.9470691567719018, 20.883261114444746, 66.4444494731383, 34.7064148834127, 145.3691861392478, 65.53072927835913, 0.0, 104.00412438831347, 69.23208989788347, 57.323227073234, 47.22450895099562, 107.37413191219595, 74.95290815124906, 10.480002250475547, 9.886829618792426, 10.131033500529186, 18.47938093689845, 62.16003550768396, 56.19839936202691, 146.2354167076972, 98.95775470102974, 115.9234507594233, 98.48154266818932, 4.698770575114469, 10.654758917746717, 60.082646129884964, 341.9263485495012, 38.25691166839687, 24.76860483700556, 27.45234359407819, 157.86089544838762, 185.6447853114583, 42.796515758560815, 96.46382983594806, 75.79506450059633, 317.69336899531174, 282.18010806339885, 10.882388856119364, 33.578192282366864, 525.3179797186009, 16.04672634610487, 5.407728300925962, 20.404274756099994, 9.383304491817883, 1.8995268560535197, 73.35284507947019, 24.084113916381444, 0.0, 0.0, 46.94140282190614, 13.986949038526834, 11.991028903622508, 12.372020471876874, 10.572327838823405, 37.66121925171443, 36.3980324365798, 60.50008835367502, 30.103430742681706, 13.69114427123932, 16.16256417754932, 46.6915199073461, 68.14581170013822, 27.457982030275204, 113.7310055155627, 458.0402410195677, 15.603924874761365, 18.406437775693085, 4.478475675554252, 93.92056132000812, 65.17769432473638, 33.705297722565696, 65.61423613873575, 116.88854255804122, 69.87250379246987, 27.22435223498954, 325.964622088967, 94.04768702710334, 153.15430671872204, 28.510843291873222, 36.01604005208182, 6.083989694052757, 177.9361269457444, 353.1385167378473, 4.397348251076389, 36.31269801893707, 0.0, 82.12481094207389, 79.02372200979117, 26.12945887033582, 32.183880408115556, 30.73707978698454, 97.79778614494971, 45.86673693115348, 11.16257638223485, 8.428280940938095, 125.44154108063047, 37.02549845749088, 4.3364614114717615, 29.856693043323922, 5.604592262713091, 20.12822428337702, 0.0, 16.114071382313952, 515.1957691622663, 45.48897868480427, 29.728766465264396, 54.61336051553346, 92.46351042301984, 68.9950489419868, 157.13887509586505, 161.48199048872647, 88.74552315325174, 70.74393001179332, 175.92250489148805, 153.28230139567387, 109.5170549739522, 60.036717847487516, 0.0, 51.74030785342566, 43.561552936318805, 46.59321473891788, 105.12994077176792, 32.15521960673335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5387378540767953, "mean_inference_ms": 1.4209266980600155, "mean_action_processing_ms": 0.2572205669382151, "mean_env_wait_ms": 0.18182259212695245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00726473331451416, "StateBufferConnector_ms": 0.0036666393280029297, "ViewRequirementAgentConnector_ms": 0.1160515546798706}, "num_episodes": 22, "episode_return_max": 721.1518896040491, "episode_return_min": -367.7591773207132, "episode_return_mean": 12.782755935809744, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.14193735578954, "num_env_steps_trained_throughput_per_sec": 358.14193735578954, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 11117.876, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11117.83, "sample_time_ms": 1485.639, "learn_time_ms": 9617.614, "learn_throughput": 415.904, "synch_weights_time_ms": 13.452}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "74486_00000", "date": "2024-08-16_15-00-07", "timestamp": 1723800607, "time_this_iter_s": 11.176899671554565, "time_total_s": 276.26142382621765, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39737f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 276.26142382621765, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 34.59375, "ram_util_percent": 79.94375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9026773737851905, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.500852233770663, "policy_loss": -0.00947558014683189, "vf_loss": 4.509045203400667, "vf_explained_var": 0.015909923321355587, "kl": 0.012826020489172718, "entropy": 1.3730963032081644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.99691968448263, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1639569483736834, "policy_loss": -0.005873531290384197, "vf_loss": 3.16898513761147, "vf_explained_var": 0.027005684785741977, "kl": 0.008453462741650949, "entropy": 1.2230480698681383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 167.78777592477408, "episode_reward_min": -442.0227532983696, "episode_reward_mean": 0.4226628692172746, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -610.1376915660735, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 77.9169170562941, "predator_policy": 610.7995945814697}, "policy_reward_mean": {"prey_policy": -92.04264380128336, "predator_policy": 92.25397523589197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.969999999999959, 10.107155605633887, 5.6199999999999255, 14.409999999999927, 10.589999999999945, 8.63753428607254, 103.1008089898924, -4.9320650560029495, 20.662720063656014, -15.984308667674824, 3.989140862941455, 7.009999999999957, 2.699999999999984, 36.46999999999943, 21.932163460064775, 5.699999999999923, 12.25953366895944, 3.259999999999974, 18.6900000000004, 48.554302469890175, 15.259083515824102, 5.89916776656655, 3.9099999999999615, 3.8799999999999613, 41.59178047488301, 20.815006491773698, 3.429999999999972, 10.859999999999923, 23.049999999999997, 3.799999999999961, 43.37817467130286, 3.129999999999973, 65.5849617649829, -91.5053120214297, 26.075292987926872, -367.7591773207132, 8.839999999999963, 4.939999999999937, 3.6699999999999666, 7.959999999999916, 8.819999999999919, 3.8999999999999617, 3.819999999999959, 23.661362010620888, 3.779999999999964, 3.7799999999999625, 4.559999999999945, 1.8099999999999972, 3.8599999999999612, 2.35471097139325, 4.563700543761245, 16.515646432699565, 23.66472023153164, 46.929999999999794, 26.059925671057634, 27.55000000000037, 49.63999999999987, 17.54930769856543, 13.619999999999923, 40.44967747327771, 94.81000000000037, 29.249999999999986, 24.72000000000023, 40.7154984574902, 4.87999999999996, 12.836994030906782, 23.98508987328519, -366.97708923830515, 3.397479343646839, -4.975580992827627, 99.5844156520564, 18.87803176313072, 2.809999999999978, 7.0467696238348925, 3.799999999999961, 19.539999999999992, 25.386762530305727, 21.460000000000363, 167.78777592477408, -319.5887227869158, 44.00999999999992, 47.309999999999796, -409.0411342259318, 69.15696905202802, 3.7299999999999685, 3.7799999999999647, 3.769999999999964, 5.809999999999919, 21.819945783250365, -95.66296365203983, 31.97000000000018, -442.0227532983696, 8.74999999999992, 51.369999999999614, 98.59540637133506, 129.90331258756237, 17.710000000000225, 2.0799999999999876, 52.239999999999355, 7.195065075055107], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -5.037374469270433, -475.6054217565923, -17.10322959760698, -25.89180243556597, -40.949764269399026, -73.11932934321918, -22.59655496432169, -292.1702964382929, -103.3246540720083, -2.8146473091196462, -2.926558448026011, -258.6998137217678, -26.76365980005233, -49.228163180084515, -119.69932304179041, -11.056684585116505, -239.7626512983288, -65.60981222474034, -75.36325286722771, -59.96811786344609, -55.86303301988568, -347.48285248153815, -168.9020214051288, -348.3873847209818, -76.32946622064972, 6.198325258091236, -9.231562156260024, 2.0000000000000013, -116.75115384007138, -88.2629434884921, 0.04293084322809976, -41.41888681442187, -33.64929010420192, -107.55409136549837, -69.26150965716076, -26.56365236724448, -20.277076911114378, -136.90175128879216, 12.219839472484487, -23.825768450421982, -65.46288405798222, -17.330990794160325, -159.09688150271842, -2.4558176141290335, -14.001014255139024, -8.171033500529228, -16.55938093689815, -5.312478812424548, -71.45417558240176, -73.23195712967204, -151.14620778728147, -124.40735760189018, -86.56763582572069, -2.718770575114511, -1.7747589177467502, -37.49264612988527, -341.4663485495013, -36.34691166839725, -22.878604837005266, -157.38036433553864, 15.445299964375003, -184.43478531145908, -40.8765157585612, -104.98667722669889, -1.6872553448621046, -361.1648569701925, -330.213932109949, -14.231501527179859, -4.153786623379791, -443.5068288260912, -465.61705455932736, 1.522271699074015, -18.494274756099696, -6.433304491817925, 0.09047314394648187, -33.33132113045791, -60.435637865394206, 2.0000000000000013, 5.959999999999958, -45.03140282190652, -7.076949038526875, -6.652760540680951, -13.810288834818515, -42.15568648193824, -2.2578606086000077, -66.43968401862797, -6.797074761005694, -28.263430742681418, -11.751144271239362, -14.232564177549333, -44.841519907346466, -31.945077062227625, -59.0987166681861, -112.20100551556206, -457.76024101956796, -13.673924874761406, -16.476437775692784, -94.93019620295286, -1.1141298212154018, -56.97768528191236, -37.34160622162912, -117.00051987924833, -48.98661238482872, -6.778690302795331, -66.65344549313214, -325.2946220889676, -47.78768702710304, -1.7618446919192468, -153.84337964761994, -10.436040052081847, -4.113989694052799, -135.9261269457451, -345.50851673784877, -25.160738571448192, 2.0000000000000013, 11.89999999999996, -80.40481094207308, -25.328635556650077, -39.37486785019868, 39.95611959188445, -8.067079786984284, -71.387786144949, -43.02673693115385, 1.687423617765129, 3.441719059061874, -123.75154108062961, 2.0000000000000013, -2.3564614114718037, -26.956693043323625, -6.205523328980483, -6.690299186202742, 2.2550898732846427, 5.615928617686011, -433.08095777717745, -494.58087930819806, -56.15538778021284, -24.78925985693823, -39.88544592673452, -126.54869443109934, 6.002106611388687, -225.03855654392586, -92.74098253984425, -47.87043886207003, -174.65250489148914, -151.74230139567527, -67.4720739067047, -95.03492929089921, -10.516169166858381, -37.424138686567694, -29.959234546531995, -40.65553312870538, -104.37941752390395, -7.518980324291823, -45.737191040460694, -133.50241102078837, 15.22082276331011, -64.76084988155031, -353.3469818628552, -390.9370441310532, -360.8717098521287, 9.831954285096039, -27.635985550604822, -14.350364532328353, -516.256480099909, -493.6143394979735, -25.76473793664864, -133.40569276147812, -31.55550391708999, -81.78553704982447, -20.884369379209296, -24.32893909757279, -33.28009115989024, -46.60466230758501, -7.93235390909893, -21.585298518386264, -60.45116268594581, 2.712651597391917, -567.5920914080742, -610.1376915660735, -31.15171528688889, -190.9784554260772, -549.7721319303965, -509.3057680398983, -3.3591750004148793, -30.226128354170843, 36.217120622895344, -22.09128811202377, -13.877061409561565, -154.02930641312588, 77.9169170562941, -68.08763955725888, 10.194385281958018, -29.553975000985442, -501.2545278873296, -1.1051545361707893, 8.483306547550708, -10.27590274164486, -52.858570682267725, -200.33972640938205], "policy_predator_policy_reward": [2.15541464885258, 4.851959820417811, 420.90812444671366, 81.90768251311913, 27.721802435566186, 44.73976426939883, 74.76932934321988, 35.356554964321965, 293.34029643829183, 112.74465407200839, 0.0, 14.378740043218196, 216.81569560807992, 171.74858690362979, 24.389771582393994, 139.6056495834785, 146.88523736488597, 124.59681858221418, 20.614450800789573, 104.37430562350498, 39.717314841225914, 80.10297690504662, 348.1628524815382, 175.23202140512763, 349.46738472098093, 77.94946622065042, 7.227182460887376, 32.27605443728134, 73.63703405840167, 63.04628324173486, 91.97294348849297, 1.9470691567719018, 20.883261114444746, 66.4444494731383, 34.7064148834127, 145.3691861392478, 65.53072927835913, 0.0, 104.00412438831347, 69.23208989788347, 57.323227073234, 47.22450895099562, 107.37413191219595, 74.95290815124906, 10.480002250475547, 9.886829618792426, 10.131033500529186, 18.47938093689845, 62.16003550768396, 56.19839936202691, 146.2354167076972, 98.95775470102974, 115.9234507594233, 98.48154266818932, 4.698770575114469, 10.654758917746717, 60.082646129884964, 341.9263485495012, 38.25691166839687, 24.76860483700556, 27.45234359407819, 157.86089544838762, 185.6447853114583, 42.796515758560815, 96.46382983594806, 75.79506450059633, 317.69336899531174, 282.18010806339885, 10.882388856119364, 33.578192282366864, 525.3179797186009, 16.04672634610487, 5.407728300925962, 20.404274756099994, 9.383304491817883, 1.8995268560535197, 73.35284507947019, 24.084113916381444, 0.0, 0.0, 46.94140282190614, 13.986949038526834, 11.991028903622508, 12.372020471876874, 10.572327838823405, 37.66121925171443, 36.3980324365798, 60.50008835367502, 30.103430742681706, 13.69114427123932, 16.16256417754932, 46.6915199073461, 68.14581170013822, 27.457982030275204, 113.7310055155627, 458.0402410195677, 15.603924874761365, 18.406437775693085, 4.478475675554252, 93.92056132000812, 65.17769432473638, 33.705297722565696, 65.61423613873575, 116.88854255804122, 69.87250379246987, 27.22435223498954, 325.964622088967, 94.04768702710334, 153.15430671872204, 28.510843291873222, 36.01604005208182, 6.083989694052757, 177.9361269457444, 353.1385167378473, 4.397348251076389, 36.31269801893707, 0.0, 82.12481094207389, 79.02372200979117, 26.12945887033582, 32.183880408115556, 30.73707978698454, 97.79778614494971, 45.86673693115348, 11.16257638223485, 8.428280940938095, 125.44154108063047, 37.02549845749088, 4.3364614114717615, 29.856693043323922, 5.604592262713091, 20.12822428337702, 0.0, 16.114071382313952, 515.1957691622663, 45.48897868480427, 29.728766465264396, 54.61336051553346, 92.46351042301984, 68.9950489419868, 157.13887509586505, 161.48199048872647, 88.74552315325174, 70.74393001179332, 175.92250489148805, 153.28230139567387, 109.5170549739522, 60.036717847487516, 0.0, 51.74030785342566, 43.561552936318805, 46.59321473891788, 105.12994077176792, 32.15521960673335, 47.60719104046032, 153.09241102078693, 100.1379560272205, 117.1898470157947, 404.99121112681667, 19.70409208017626, 361.4417098521286, 33.60804571490404, 79.25076439991957, 10.045585683013869, 567.356058547625, 33.473626824326466, 220.23285188665437, 8.094547863499614, 33.45550391708978, 83.6155370498254, 22.794369379209595, 26.19893909757306, 35.18009115988986, 48.47466230758464, 25.32058730861877, 10.007065118866661, 63.19116268594552, 16.367294185858217, 491.5490315157975, 590.5177878063106, 60.42930760873835, 193.67086310422673, 610.7995945814697, 6.255552090455361, 8.289175000414838, 34.04612835417106, 13.232879377104469, 24.01128811202407, 56.0403221244734, 210.4614520695487, 10.766395531269547, 109.3076395572595, 5.635614718041944, 31.433975000985736, 501.3445278873295, 3.095154536170767, 35.54019776753335, 18.492398426560726, 48.18511871610601, 212.20824345059725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5442118187349199, "mean_inference_ms": 1.4557506631228296, "mean_action_processing_ms": 0.2703954155199902, "mean_env_wait_ms": 0.18401570932900352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006785750389099121, "StateBufferConnector_ms": 0.0034884214401245117, "ViewRequirementAgentConnector_ms": 0.11196255683898926}, "num_episodes": 23, "episode_return_max": 167.78777592477408, "episode_return_min": -442.0227532983696, "episode_return_mean": 0.4226628692172746, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.85323268770964, "num_env_steps_trained_throughput_per_sec": 356.85323268770964, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 11175.102, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11175.055, "sample_time_ms": 1457.677, "learn_time_ms": 9702.63, "learn_throughput": 412.259, "synch_weights_time_ms": 13.473}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "74486_00000", "date": "2024-08-16_15-00-18", "timestamp": 1723800618, "time_this_iter_s": 11.239203929901123, "time_total_s": 287.5006277561188, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3972ebdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 287.5006277561188, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 32.36875, "ram_util_percent": 79.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5624839395915389, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.57291122845241, "policy_loss": -0.006414144909718917, "vf_loss": 6.578531248355038, "vf_explained_var": 0.024210166552710154, "kl": 0.00794132976290625, "entropy": 1.3435344062154255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1317487014191492, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.123357510945153, "policy_loss": -0.008368252158391648, "vf_loss": 4.130678025250712, "vf_explained_var": 0.022038228423507125, "kl": 0.010477259162207918, "entropy": 1.1741007261806065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 167.78777592477408, "episode_reward_min": -475.70095293882184, "episode_reward_mean": -14.665785616294372, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -652.1796792319755, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 77.9169170562941, "predator_policy": 643.2435210161692}, "policy_reward_mean": {"prey_policy": -121.737776029001, "predator_policy": 114.40488322085379}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.6900000000004, 48.554302469890175, 15.259083515824102, 5.89916776656655, 3.9099999999999615, 3.8799999999999613, 41.59178047488301, 20.815006491773698, 3.429999999999972, 10.859999999999923, 23.049999999999997, 3.799999999999961, 43.37817467130286, 3.129999999999973, 65.5849617649829, -91.5053120214297, 26.075292987926872, -367.7591773207132, 8.839999999999963, 4.939999999999937, 3.6699999999999666, 7.959999999999916, 8.819999999999919, 3.8999999999999617, 3.819999999999959, 23.661362010620888, 3.779999999999964, 3.7799999999999625, 4.559999999999945, 1.8099999999999972, 3.8599999999999612, 2.35471097139325, 4.563700543761245, 16.515646432699565, 23.66472023153164, 46.929999999999794, 26.059925671057634, 27.55000000000037, 49.63999999999987, 17.54930769856543, 13.619999999999923, 40.44967747327771, 94.81000000000037, 29.249999999999986, 24.72000000000023, 40.7154984574902, 4.87999999999996, 12.836994030906782, 23.98508987328519, -366.97708923830515, 3.397479343646839, -4.975580992827627, 99.5844156520564, 18.87803176313072, 2.809999999999978, 7.0467696238348925, 3.799999999999961, 19.539999999999992, 25.386762530305727, 21.460000000000363, 167.78777592477408, -319.5887227869158, 44.00999999999992, 47.309999999999796, -409.0411342259318, 69.15696905202802, 3.7299999999999685, 3.7799999999999647, 3.769999999999964, 5.809999999999919, 21.819945783250365, -95.66296365203983, 31.97000000000018, -442.0227532983696, 8.74999999999992, 51.369999999999614, 98.59540637133506, 129.90331258756237, 17.710000000000225, 2.0799999999999876, 52.239999999999355, 7.195065075055107, 35.49999999999943, -25.432520892370654, 112.84846290233644, 52.93179469188024, 51.32999999999956, -412.3508288864132, 83.01000000000074, 62.45003652528682, -39.18069828976158, -475.70095293882184, -463.1331845536429, 61.31999999999951, -172.87746155205454, -256.29650940473175, 103.48000000000047, 47.959999999999745, -13.543140078486712, -11.657162860842996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.56365236724448, -20.277076911114378, -136.90175128879216, 12.219839472484487, -23.825768450421982, -65.46288405798222, -17.330990794160325, -159.09688150271842, -2.4558176141290335, -14.001014255139024, -8.171033500529228, -16.55938093689815, -5.312478812424548, -71.45417558240176, -73.23195712967204, -151.14620778728147, -124.40735760189018, -86.56763582572069, -2.718770575114511, -1.7747589177467502, -37.49264612988527, -341.4663485495013, -36.34691166839725, -22.878604837005266, -157.38036433553864, 15.445299964375003, -184.43478531145908, -40.8765157585612, -104.98667722669889, -1.6872553448621046, -361.1648569701925, -330.213932109949, -14.231501527179859, -4.153786623379791, -443.5068288260912, -465.61705455932736, 1.522271699074015, -18.494274756099696, -6.433304491817925, 0.09047314394648187, -33.33132113045791, -60.435637865394206, 2.0000000000000013, 5.959999999999958, -45.03140282190652, -7.076949038526875, -6.652760540680951, -13.810288834818515, -42.15568648193824, -2.2578606086000077, -66.43968401862797, -6.797074761005694, -28.263430742681418, -11.751144271239362, -14.232564177549333, -44.841519907346466, -31.945077062227625, -59.0987166681861, -112.20100551556206, -457.76024101956796, -13.673924874761406, -16.476437775692784, -94.93019620295286, -1.1141298212154018, -56.97768528191236, -37.34160622162912, -117.00051987924833, -48.98661238482872, -6.778690302795331, -66.65344549313214, -325.2946220889676, -47.78768702710304, -1.7618446919192468, -153.84337964761994, -10.436040052081847, -4.113989694052799, -135.9261269457451, -345.50851673784877, -25.160738571448192, 2.0000000000000013, 11.89999999999996, -80.40481094207308, -25.328635556650077, -39.37486785019868, 39.95611959188445, -8.067079786984284, -71.387786144949, -43.02673693115385, 1.687423617765129, 3.441719059061874, -123.75154108062961, 2.0000000000000013, -2.3564614114718037, -26.956693043323625, -6.205523328980483, -6.690299186202742, 2.2550898732846427, 5.615928617686011, -433.08095777717745, -494.58087930819806, -56.15538778021284, -24.78925985693823, -39.88544592673452, -126.54869443109934, 6.002106611388687, -225.03855654392586, -92.74098253984425, -47.87043886207003, -174.65250489148914, -151.74230139567527, -67.4720739067047, -95.03492929089921, -10.516169166858381, -37.424138686567694, -29.959234546531995, -40.65553312870538, -104.37941752390395, -7.518980324291823, -45.737191040460694, -133.50241102078837, 15.22082276331011, -64.76084988155031, -353.3469818628552, -390.9370441310532, -360.8717098521287, 9.831954285096039, -27.635985550604822, -14.350364532328353, -516.256480099909, -493.6143394979735, -25.76473793664864, -133.40569276147812, -31.55550391708999, -81.78553704982447, -20.884369379209296, -24.32893909757279, -33.28009115989024, -46.60466230758501, -7.93235390909893, -21.585298518386264, -60.45116268594581, 2.712651597391917, -567.5920914080742, -610.1376915660735, -31.15171528688889, -190.9784554260772, -549.7721319303965, -509.3057680398983, -3.3591750004148793, -30.226128354170843, 36.217120622895344, -22.09128811202377, -13.877061409561565, -154.02930641312588, 77.9169170562941, -68.08763955725888, 10.194385281958018, -29.553975000985442, -501.2545278873296, -1.1051545361707893, 8.483306547550708, -10.27590274164486, -52.858570682267725, -200.33972640938205, -10.255856033851499, 3.5399485095093652, -615.9547906595228, -652.1796792319755, 44.80224275870445, -114.17745938981984, 32.01150614253463, -609.4465186012235, -1.0856462986753934, -35.658182494692426, -548.5854432975221, -477.0141481635003, -0.8726347109910824, 24.066230977527344, -81.72073298484672, 0.6115129410454148, -563.6273672244431, -621.3446662070062, -528.7688212691014, -592.2293816159125, -500.9052244151341, -592.2725867916726, 51.873338618579886, -13.179814715003971, -328.472986687439, -223.8213554375361, -312.66632205466317, -529.9326216962619, 2.4494038806508476, -18.551783446587198, -232.46202080593827, 0.3592507324069904, -30.8906725288864, -47.73323773755228, -593.3424167753865, -642.1315596882885], "policy_predator_policy_reward": [65.53072927835913, 0.0, 104.00412438831347, 69.23208989788347, 57.323227073234, 47.22450895099562, 107.37413191219595, 74.95290815124906, 10.480002250475547, 9.886829618792426, 10.131033500529186, 18.47938093689845, 62.16003550768396, 56.19839936202691, 146.2354167076972, 98.95775470102974, 115.9234507594233, 98.48154266818932, 4.698770575114469, 10.654758917746717, 60.082646129884964, 341.9263485495012, 38.25691166839687, 24.76860483700556, 27.45234359407819, 157.86089544838762, 185.6447853114583, 42.796515758560815, 96.46382983594806, 75.79506450059633, 317.69336899531174, 282.18010806339885, 10.882388856119364, 33.578192282366864, 525.3179797186009, 16.04672634610487, 5.407728300925962, 20.404274756099994, 9.383304491817883, 1.8995268560535197, 73.35284507947019, 24.084113916381444, 0.0, 0.0, 46.94140282190614, 13.986949038526834, 11.991028903622508, 12.372020471876874, 10.572327838823405, 37.66121925171443, 36.3980324365798, 60.50008835367502, 30.103430742681706, 13.69114427123932, 16.16256417754932, 46.6915199073461, 68.14581170013822, 27.457982030275204, 113.7310055155627, 458.0402410195677, 15.603924874761365, 18.406437775693085, 4.478475675554252, 93.92056132000812, 65.17769432473638, 33.705297722565696, 65.61423613873575, 116.88854255804122, 69.87250379246987, 27.22435223498954, 325.964622088967, 94.04768702710334, 153.15430671872204, 28.510843291873222, 36.01604005208182, 6.083989694052757, 177.9361269457444, 353.1385167378473, 4.397348251076389, 36.31269801893707, 0.0, 82.12481094207389, 79.02372200979117, 26.12945887033582, 32.183880408115556, 30.73707978698454, 97.79778614494971, 45.86673693115348, 11.16257638223485, 8.428280940938095, 125.44154108063047, 37.02549845749088, 4.3364614114717615, 29.856693043323922, 5.604592262713091, 20.12822428337702, 0.0, 16.114071382313952, 515.1957691622663, 45.48897868480427, 29.728766465264396, 54.61336051553346, 92.46351042301984, 68.9950489419868, 157.13887509586505, 161.48199048872647, 88.74552315325174, 70.74393001179332, 175.92250489148805, 153.28230139567387, 109.5170549739522, 60.036717847487516, 0.0, 51.74030785342566, 43.561552936318805, 46.59321473891788, 105.12994077176792, 32.15521960673335, 47.60719104046032, 153.09241102078693, 100.1379560272205, 117.1898470157947, 404.99121112681667, 19.70409208017626, 361.4417098521286, 33.60804571490404, 79.25076439991957, 10.045585683013869, 567.356058547625, 33.473626824326466, 220.23285188665437, 8.094547863499614, 33.45550391708978, 83.6155370498254, 22.794369379209595, 26.19893909757306, 35.18009115988986, 48.47466230758464, 25.32058730861877, 10.007065118866661, 63.19116268594552, 16.367294185858217, 491.5490315157975, 590.5177878063106, 60.42930760873835, 193.67086310422673, 610.7995945814697, 6.255552090455361, 8.289175000414838, 34.04612835417106, 13.232879377104469, 24.01128811202407, 56.0403221244734, 210.4614520695487, 10.766395531269547, 109.3076395572595, 5.635614718041944, 31.433975000985736, 501.3445278873295, 3.095154536170767, 35.54019776753335, 18.492398426560726, 48.18511871610601, 212.20824345059725, 29.945856033851463, 12.270051490490596, 638.8797626242745, 603.8221863748533, 33.52717763640792, 148.69650189704248, 20.920288549345624, 609.4465186012235, 29.725646298675464, 58.34818249469209, 593.0713086391794, 20.1774539354306, 59.81640373346378, 0.0, 60.61306159281622, 82.9461949762723, 582.9476792676753, 562.843655874013, 2.053728930023472, 643.2435210161692, 3.8185246214217385, 626.2261020317418, 7.506661381419883, 15.11981471500393, 81.56699096246831, 297.8498896104528, 14.87378014117224, 571.4286542050216, 108.6511869530391, 10.931192612897366, 278.4320208059374, 1.630749267593011, 56.695968933235875, 8.384801254715642, 639.6020425584964, 584.2147710443351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481129563864828, "mean_inference_ms": 1.4815553555797834, "mean_action_processing_ms": 0.28027401288503456, "mean_env_wait_ms": 0.18551678322856469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006363630294799805, "StateBufferConnector_ms": 0.003470778465270996, "ViewRequirementAgentConnector_ms": 0.11143708229064941}, "num_episodes": 18, "episode_return_max": 167.78777592477408, "episode_return_min": -475.70095293882184, "episode_return_mean": -14.665785616294372, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.70030736351066, "num_env_steps_trained_throughput_per_sec": 354.70030736351066, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 11308.616, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11308.569, "sample_time_ms": 1472.974, "learn_time_ms": 9820.804, "learn_throughput": 407.299, "synch_weights_time_ms": 13.532}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "74486_00000", "date": "2024-08-16_15-00-29", "timestamp": 1723800629, "time_this_iter_s": 11.282336950302124, "time_total_s": 298.7829647064209, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39734fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 298.7829647064209, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.275, "ram_util_percent": 78.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9036459099994134, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.24968179836475, "policy_loss": -0.006054787833007082, "vf_loss": 5.254743604559116, "vf_explained_var": 0.02477998515916249, "kl": 0.009929813691376308, "entropy": 1.3345613774799165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9059736327204124, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.374739471377519, "policy_loss": -0.007463823467685235, "vf_loss": 2.3813056509330788, "vf_explained_var": 0.029128436815171015, "kl": 0.008976433424973652, "entropy": 1.238441377278989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 167.78777592477408, "episode_reward_min": -475.70095293882184, "episode_reward_mean": -25.885560549318473, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -652.1796792319755, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.43021457164839, "predator_policy": 669.3832806421266}, "policy_reward_mean": {"prey_policy": -133.53589573349495, "predator_policy": 120.59311545883571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.839999999999963, 4.939999999999937, 3.6699999999999666, 7.959999999999916, 8.819999999999919, 3.8999999999999617, 3.819999999999959, 23.661362010620888, 3.779999999999964, 3.7799999999999625, 4.559999999999945, 1.8099999999999972, 3.8599999999999612, 2.35471097139325, 4.563700543761245, 16.515646432699565, 23.66472023153164, 46.929999999999794, 26.059925671057634, 27.55000000000037, 49.63999999999987, 17.54930769856543, 13.619999999999923, 40.44967747327771, 94.81000000000037, 29.249999999999986, 24.72000000000023, 40.7154984574902, 4.87999999999996, 12.836994030906782, 23.98508987328519, -366.97708923830515, 3.397479343646839, -4.975580992827627, 99.5844156520564, 18.87803176313072, 2.809999999999978, 7.0467696238348925, 3.799999999999961, 19.539999999999992, 25.386762530305727, 21.460000000000363, 167.78777592477408, -319.5887227869158, 44.00999999999992, 47.309999999999796, -409.0411342259318, 69.15696905202802, 3.7299999999999685, 3.7799999999999647, 3.769999999999964, 5.809999999999919, 21.819945783250365, -95.66296365203983, 31.97000000000018, -442.0227532983696, 8.74999999999992, 51.369999999999614, 98.59540637133506, 129.90331258756237, 17.710000000000225, 2.0799999999999876, 52.239999999999355, 7.195065075055107, 35.49999999999943, -25.432520892370654, 112.84846290233644, 52.93179469188024, 51.32999999999956, -412.3508288864132, 83.01000000000074, 62.45003652528682, -39.18069828976158, -475.70095293882184, -463.1331845536429, 61.31999999999951, -172.87746155205454, -256.29650940473175, 103.48000000000047, 47.959999999999745, -13.543140078486712, -11.657162860842996, 6.619999999999924, -0.516966500423824, -378.66237313409846, 69.18, -452.766603066716, -385.6464673569827, 43.47999999999954, 52.146049777853634, -10.9351742991805, 107.88000000000103, 55.269999999999534, 39.10811350308208, 85.68000000000042, -362.9625912868468, 42.296572568912815, -284.0895698866288, 70.85000000000016, 59.73479717962518], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.522271699074015, -18.494274756099696, -6.433304491817925, 0.09047314394648187, -33.33132113045791, -60.435637865394206, 2.0000000000000013, 5.959999999999958, -45.03140282190652, -7.076949038526875, -6.652760540680951, -13.810288834818515, -42.15568648193824, -2.2578606086000077, -66.43968401862797, -6.797074761005694, -28.263430742681418, -11.751144271239362, -14.232564177549333, -44.841519907346466, -31.945077062227625, -59.0987166681861, -112.20100551556206, -457.76024101956796, -13.673924874761406, -16.476437775692784, -94.93019620295286, -1.1141298212154018, -56.97768528191236, -37.34160622162912, -117.00051987924833, -48.98661238482872, -6.778690302795331, -66.65344549313214, -325.2946220889676, -47.78768702710304, -1.7618446919192468, -153.84337964761994, -10.436040052081847, -4.113989694052799, -135.9261269457451, -345.50851673784877, -25.160738571448192, 2.0000000000000013, 11.89999999999996, -80.40481094207308, -25.328635556650077, -39.37486785019868, 39.95611959188445, -8.067079786984284, -71.387786144949, -43.02673693115385, 1.687423617765129, 3.441719059061874, -123.75154108062961, 2.0000000000000013, -2.3564614114718037, -26.956693043323625, -6.205523328980483, -6.690299186202742, 2.2550898732846427, 5.615928617686011, -433.08095777717745, -494.58087930819806, -56.15538778021284, -24.78925985693823, -39.88544592673452, -126.54869443109934, 6.002106611388687, -225.03855654392586, -92.74098253984425, -47.87043886207003, -174.65250489148914, -151.74230139567527, -67.4720739067047, -95.03492929089921, -10.516169166858381, -37.424138686567694, -29.959234546531995, -40.65553312870538, -104.37941752390395, -7.518980324291823, -45.737191040460694, -133.50241102078837, 15.22082276331011, -64.76084988155031, -353.3469818628552, -390.9370441310532, -360.8717098521287, 9.831954285096039, -27.635985550604822, -14.350364532328353, -516.256480099909, -493.6143394979735, -25.76473793664864, -133.40569276147812, -31.55550391708999, -81.78553704982447, -20.884369379209296, -24.32893909757279, -33.28009115989024, -46.60466230758501, -7.93235390909893, -21.585298518386264, -60.45116268594581, 2.712651597391917, -567.5920914080742, -610.1376915660735, -31.15171528688889, -190.9784554260772, -549.7721319303965, -509.3057680398983, -3.3591750004148793, -30.226128354170843, 36.217120622895344, -22.09128811202377, -13.877061409561565, -154.02930641312588, 77.9169170562941, -68.08763955725888, 10.194385281958018, -29.553975000985442, -501.2545278873296, -1.1051545361707893, 8.483306547550708, -10.27590274164486, -52.858570682267725, -200.33972640938205, -10.255856033851499, 3.5399485095093652, -615.9547906595228, -652.1796792319755, 44.80224275870445, -114.17745938981984, 32.01150614253463, -609.4465186012235, -1.0856462986753934, -35.658182494692426, -548.5854432975221, -477.0141481635003, -0.8726347109910824, 24.066230977527344, -81.72073298484672, 0.6115129410454148, -563.6273672244431, -621.3446662070062, -528.7688212691014, -592.2293816159125, -500.9052244151341, -592.2725867916726, 51.873338618579886, -13.179814715003971, -328.472986687439, -223.8213554375361, -312.66632205466317, -529.9326216962619, 2.4494038806508476, -18.551783446587198, -232.46202080593827, 0.3592507324069904, -30.8906725288864, -47.73323773755228, -593.3424167753865, -642.1315596882885, -11.835533666709928, -92.79121285147093, -32.97634591498247, -42.7665413794561, -472.94864816216085, -490.34140471143206, 47.423464881705314, -19.57605000316183, -537.0595554708341, -498.64382305207266, -643.2604386100417, -427.5376984515345, -4.494266397586073, 24.204561680881373, 28.379048183289456, -82.44463998020638, -218.81996995095716, -131.85286656598637, 11.592398996390644, 78.43021457164839, -16.484213151690817, 25.843906658146132, -127.23322764650159, -19.68782005611268, -85.45468239825715, -51.921420983990686, -591.8453039660195, -401.1390481743391, -66.56831247329785, -6.754611946544779, -615.7999145619607, -346.9634095364134, -20.493025875676885, -58.66011277037776, -7.563850407709804, 22.387888994084605], "policy_predator_policy_reward": [5.407728300925962, 20.404274756099994, 9.383304491817883, 1.8995268560535197, 73.35284507947019, 24.084113916381444, 0.0, 0.0, 46.94140282190614, 13.986949038526834, 11.991028903622508, 12.372020471876874, 10.572327838823405, 37.66121925171443, 36.3980324365798, 60.50008835367502, 30.103430742681706, 13.69114427123932, 16.16256417754932, 46.6915199073461, 68.14581170013822, 27.457982030275204, 113.7310055155627, 458.0402410195677, 15.603924874761365, 18.406437775693085, 4.478475675554252, 93.92056132000812, 65.17769432473638, 33.705297722565696, 65.61423613873575, 116.88854255804122, 69.87250379246987, 27.22435223498954, 325.964622088967, 94.04768702710334, 153.15430671872204, 28.510843291873222, 36.01604005208182, 6.083989694052757, 177.9361269457444, 353.1385167378473, 4.397348251076389, 36.31269801893707, 0.0, 82.12481094207389, 79.02372200979117, 26.12945887033582, 32.183880408115556, 30.73707978698454, 97.79778614494971, 45.86673693115348, 11.16257638223485, 8.428280940938095, 125.44154108063047, 37.02549845749088, 4.3364614114717615, 29.856693043323922, 5.604592262713091, 20.12822428337702, 0.0, 16.114071382313952, 515.1957691622663, 45.48897868480427, 29.728766465264396, 54.61336051553346, 92.46351042301984, 68.9950489419868, 157.13887509586505, 161.48199048872647, 88.74552315325174, 70.74393001179332, 175.92250489148805, 153.28230139567387, 109.5170549739522, 60.036717847487516, 0.0, 51.74030785342566, 43.561552936318805, 46.59321473891788, 105.12994077176792, 32.15521960673335, 47.60719104046032, 153.09241102078693, 100.1379560272205, 117.1898470157947, 404.99121112681667, 19.70409208017626, 361.4417098521286, 33.60804571490404, 79.25076439991957, 10.045585683013869, 567.356058547625, 33.473626824326466, 220.23285188665437, 8.094547863499614, 33.45550391708978, 83.6155370498254, 22.794369379209595, 26.19893909757306, 35.18009115988986, 48.47466230758464, 25.32058730861877, 10.007065118866661, 63.19116268594552, 16.367294185858217, 491.5490315157975, 590.5177878063106, 60.42930760873835, 193.67086310422673, 610.7995945814697, 6.255552090455361, 8.289175000414838, 34.04612835417106, 13.232879377104469, 24.01128811202407, 56.0403221244734, 210.4614520695487, 10.766395531269547, 109.3076395572595, 5.635614718041944, 31.433975000985736, 501.3445278873295, 3.095154536170767, 35.54019776753335, 18.492398426560726, 48.18511871610601, 212.20824345059725, 29.945856033851463, 12.270051490490596, 638.8797626242745, 603.8221863748533, 33.52717763640792, 148.69650189704248, 20.920288549345624, 609.4465186012235, 29.725646298675464, 58.34818249469209, 593.0713086391794, 20.1774539354306, 59.81640373346378, 0.0, 60.61306159281622, 82.9461949762723, 582.9476792676753, 562.843655874013, 2.053728930023472, 643.2435210161692, 3.8185246214217385, 626.2261020317418, 7.506661381419883, 15.11981471500393, 81.56699096246831, 297.8498896104528, 14.87378014117224, 571.4286542050216, 108.6511869530391, 10.931192612897366, 278.4320208059374, 1.630749267593011, 56.695968933235875, 8.384801254715642, 639.6020425584964, 584.2147710443351, 13.775533666709887, 97.4712128514718, 1.744585971290951, 73.48133482272311, 39.376174081545265, 545.2515056579484, 19.826535118294736, 21.50605000316213, 581.2401795908734, 1.6965958653176423, 669.3832806421266, 15.768389062467033, 6.464266397586031, 17.305438319118828, 46.31561350328231, 59.89602807148961, 321.35806783378723, 18.379594383974148, 9.18760100360932, 8.669785428352055, 39.5078596753119, 6.402446818232903, 121.12186934247394, 64.90729186322275, 170.3850490764675, 52.67105430578103, 626.3123677673733, 3.7093930861386424, 43.44049730839611, 72.17899968036085, 642.6867981871617, 35.98695602458378, 67.68528099899913, 82.31785764705545, 15.395938021066984, 29.514820572183897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5483980370288023, "mean_inference_ms": 1.4938312400576734, "mean_action_processing_ms": 0.2794090280160394, "mean_env_wait_ms": 0.1856246702359403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005400300025939941, "StateBufferConnector_ms": 0.0031305551528930664, "ViewRequirementAgentConnector_ms": 0.09228396415710449}, "num_episodes": 18, "episode_return_max": 167.78777592477408, "episode_return_min": -475.70095293882184, "episode_return_mean": -25.885560549318473, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.6079135960006, "num_env_steps_trained_throughput_per_sec": 381.6079135960006, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 11366.008, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11365.961, "sample_time_ms": 1502.622, "learn_time_ms": 9848.062, "learn_throughput": 406.171, "synch_weights_time_ms": 13.944}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "74486_00000", "date": "2024-08-16_15-00-40", "timestamp": 1723800640, "time_this_iter_s": 10.487022876739502, "time_total_s": 309.2699875831604, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397746820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 309.2699875831604, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 27.9, "ram_util_percent": 78.51333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5717784236663233, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.039029138807266, "policy_loss": -0.006041014105051992, "vf_loss": 7.044167188866429, "vf_explained_var": 0.02781877142411691, "kl": 0.009029467844508135, "entropy": 1.2971967639115753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9080284838007872, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.685146559357013, "policy_loss": -0.0098919158404762, "vf_loss": 4.693672724501797, "vf_explained_var": 0.035339734667823426, "kl": 0.013657562465844316, "entropy": 1.1416356906689034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 167.78777592477408, "episode_reward_min": -483.19851335352627, "episode_reward_mean": -55.24745044498682, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -687.2500819876657, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.43021457164839, "predator_policy": 724.5601369143951}, "policy_reward_mean": {"prey_policy": -179.44263697257782, "predator_policy": 151.8189117500844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.059925671057634, 27.55000000000037, 49.63999999999987, 17.54930769856543, 13.619999999999923, 40.44967747327771, 94.81000000000037, 29.249999999999986, 24.72000000000023, 40.7154984574902, 4.87999999999996, 12.836994030906782, 23.98508987328519, -366.97708923830515, 3.397479343646839, -4.975580992827627, 99.5844156520564, 18.87803176313072, 2.809999999999978, 7.0467696238348925, 3.799999999999961, 19.539999999999992, 25.386762530305727, 21.460000000000363, 167.78777592477408, -319.5887227869158, 44.00999999999992, 47.309999999999796, -409.0411342259318, 69.15696905202802, 3.7299999999999685, 3.7799999999999647, 3.769999999999964, 5.809999999999919, 21.819945783250365, -95.66296365203983, 31.97000000000018, -442.0227532983696, 8.74999999999992, 51.369999999999614, 98.59540637133506, 129.90331258756237, 17.710000000000225, 2.0799999999999876, 52.239999999999355, 7.195065075055107, 35.49999999999943, -25.432520892370654, 112.84846290233644, 52.93179469188024, 51.32999999999956, -412.3508288864132, 83.01000000000074, 62.45003652528682, -39.18069828976158, -475.70095293882184, -463.1331845536429, 61.31999999999951, -172.87746155205454, -256.29650940473175, 103.48000000000047, 47.959999999999745, -13.543140078486712, -11.657162860842996, 6.619999999999924, -0.516966500423824, -378.66237313409846, 69.18, -452.766603066716, -385.6464673569827, 43.47999999999954, 52.146049777853634, -10.9351742991805, 107.88000000000103, 55.269999999999534, 39.10811350308208, 85.68000000000042, -362.9625912868468, 42.296572568912815, -284.0895698866288, 70.85000000000016, 59.73479717962518, -426.16716100936355, -414.83353940664875, 32.963934945146676, -34.05886840691074, -313.4667284198435, -398.90239960265524, 40.00889099935377, -483.19851335352627, 3.759999999999962, -51.35667590248642, -6.368629218226911, -129.91813664486494, -444.462098447892, 65.9043216993641, 96.93243264781394, -183.49905849046883, -164.24662076561867, 52.14999999999943], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.7618446919192468, -153.84337964761994, -10.436040052081847, -4.113989694052799, -135.9261269457451, -345.50851673784877, -25.160738571448192, 2.0000000000000013, 11.89999999999996, -80.40481094207308, -25.328635556650077, -39.37486785019868, 39.95611959188445, -8.067079786984284, -71.387786144949, -43.02673693115385, 1.687423617765129, 3.441719059061874, -123.75154108062961, 2.0000000000000013, -2.3564614114718037, -26.956693043323625, -6.205523328980483, -6.690299186202742, 2.2550898732846427, 5.615928617686011, -433.08095777717745, -494.58087930819806, -56.15538778021284, -24.78925985693823, -39.88544592673452, -126.54869443109934, 6.002106611388687, -225.03855654392586, -92.74098253984425, -47.87043886207003, -174.65250489148914, -151.74230139567527, -67.4720739067047, -95.03492929089921, -10.516169166858381, -37.424138686567694, -29.959234546531995, -40.65553312870538, -104.37941752390395, -7.518980324291823, -45.737191040460694, -133.50241102078837, 15.22082276331011, -64.76084988155031, -353.3469818628552, -390.9370441310532, -360.8717098521287, 9.831954285096039, -27.635985550604822, -14.350364532328353, -516.256480099909, -493.6143394979735, -25.76473793664864, -133.40569276147812, -31.55550391708999, -81.78553704982447, -20.884369379209296, -24.32893909757279, -33.28009115989024, -46.60466230758501, -7.93235390909893, -21.585298518386264, -60.45116268594581, 2.712651597391917, -567.5920914080742, -610.1376915660735, -31.15171528688889, -190.9784554260772, -549.7721319303965, -509.3057680398983, -3.3591750004148793, -30.226128354170843, 36.217120622895344, -22.09128811202377, -13.877061409561565, -154.02930641312588, 77.9169170562941, -68.08763955725888, 10.194385281958018, -29.553975000985442, -501.2545278873296, -1.1051545361707893, 8.483306547550708, -10.27590274164486, -52.858570682267725, -200.33972640938205, -10.255856033851499, 3.5399485095093652, -615.9547906595228, -652.1796792319755, 44.80224275870445, -114.17745938981984, 32.01150614253463, -609.4465186012235, -1.0856462986753934, -35.658182494692426, -548.5854432975221, -477.0141481635003, -0.8726347109910824, 24.066230977527344, -81.72073298484672, 0.6115129410454148, -563.6273672244431, -621.3446662070062, -528.7688212691014, -592.2293816159125, -500.9052244151341, -592.2725867916726, 51.873338618579886, -13.179814715003971, -328.472986687439, -223.8213554375361, -312.66632205466317, -529.9326216962619, 2.4494038806508476, -18.551783446587198, -232.46202080593827, 0.3592507324069904, -30.8906725288864, -47.73323773755228, -593.3424167753865, -642.1315596882885, -11.835533666709928, -92.79121285147093, -32.97634591498247, -42.7665413794561, -472.94864816216085, -490.34140471143206, 47.423464881705314, -19.57605000316183, -537.0595554708341, -498.64382305207266, -643.2604386100417, -427.5376984515345, -4.494266397586073, 24.204561680881373, 28.379048183289456, -82.44463998020638, -218.81996995095716, -131.85286656598637, 11.592398996390644, 78.43021457164839, -16.484213151690817, 25.843906658146132, -127.23322764650159, -19.68782005611268, -85.45468239825715, -51.921420983990686, -591.8453039660195, -401.1390481743391, -66.56831247329785, -6.754611946544779, -615.7999145619607, -346.9634095364134, -20.493025875676885, -58.66011277037776, -7.563850407709804, 22.387888994084605, -682.9237763054698, -611.4864972900449, -514.1840567064284, -591.5386630931276, 20.39863295027013, -19.62666355159257, -270.85465274373047, -185.7758073434191, -500.4624292950012, -485.5380506105116, -596.6263691432353, -687.2500819876657, 8.953728297579719, 6.481401661873543, -650.5219844877059, -568.0018830881855, -37.622524197392146, -22.949963894040035, -102.47166001707375, -569.1817688800753, -99.05320180895602, -17.52155274390619, -590.8497304475638, -612.1704590439318, -610.6104405553325, -581.6979383785433, -35.04045086271466, -28.918645694514353, 21.178545288865536, 30.013572139673705, -348.4354758117034, -217.57907960045438, -602.2875893237044, -268.1955799533644, 18.365541103236886, -69.81544962413557], "policy_predator_policy_reward": [153.15430671872204, 28.510843291873222, 36.01604005208182, 6.083989694052757, 177.9361269457444, 353.1385167378473, 4.397348251076389, 36.31269801893707, 0.0, 82.12481094207389, 79.02372200979117, 26.12945887033582, 32.183880408115556, 30.73707978698454, 97.79778614494971, 45.86673693115348, 11.16257638223485, 8.428280940938095, 125.44154108063047, 37.02549845749088, 4.3364614114717615, 29.856693043323922, 5.604592262713091, 20.12822428337702, 0.0, 16.114071382313952, 515.1957691622663, 45.48897868480427, 29.728766465264396, 54.61336051553346, 92.46351042301984, 68.9950489419868, 157.13887509586505, 161.48199048872647, 88.74552315325174, 70.74393001179332, 175.92250489148805, 153.28230139567387, 109.5170549739522, 60.036717847487516, 0.0, 51.74030785342566, 43.561552936318805, 46.59321473891788, 105.12994077176792, 32.15521960673335, 47.60719104046032, 153.09241102078693, 100.1379560272205, 117.1898470157947, 404.99121112681667, 19.70409208017626, 361.4417098521286, 33.60804571490404, 79.25076439991957, 10.045585683013869, 567.356058547625, 33.473626824326466, 220.23285188665437, 8.094547863499614, 33.45550391708978, 83.6155370498254, 22.794369379209595, 26.19893909757306, 35.18009115988986, 48.47466230758464, 25.32058730861877, 10.007065118866661, 63.19116268594552, 16.367294185858217, 491.5490315157975, 590.5177878063106, 60.42930760873835, 193.67086310422673, 610.7995945814697, 6.255552090455361, 8.289175000414838, 34.04612835417106, 13.232879377104469, 24.01128811202407, 56.0403221244734, 210.4614520695487, 10.766395531269547, 109.3076395572595, 5.635614718041944, 31.433975000985736, 501.3445278873295, 3.095154536170767, 35.54019776753335, 18.492398426560726, 48.18511871610601, 212.20824345059725, 29.945856033851463, 12.270051490490596, 638.8797626242745, 603.8221863748533, 33.52717763640792, 148.69650189704248, 20.920288549345624, 609.4465186012235, 29.725646298675464, 58.34818249469209, 593.0713086391794, 20.1774539354306, 59.81640373346378, 0.0, 60.61306159281622, 82.9461949762723, 582.9476792676753, 562.843655874013, 2.053728930023472, 643.2435210161692, 3.8185246214217385, 626.2261020317418, 7.506661381419883, 15.11981471500393, 81.56699096246831, 297.8498896104528, 14.87378014117224, 571.4286542050216, 108.6511869530391, 10.931192612897366, 278.4320208059374, 1.630749267593011, 56.695968933235875, 8.384801254715642, 639.6020425584964, 584.2147710443351, 13.775533666709887, 97.4712128514718, 1.744585971290951, 73.48133482272311, 39.376174081545265, 545.2515056579484, 19.826535118294736, 21.50605000316213, 581.2401795908734, 1.6965958653176423, 669.3832806421266, 15.768389062467033, 6.464266397586031, 17.305438319118828, 46.31561350328231, 59.89602807148961, 321.35806783378723, 18.379594383974148, 9.18760100360932, 8.669785428352055, 39.5078596753119, 6.402446818232903, 121.12186934247394, 64.90729186322275, 170.3850490764675, 52.67105430578103, 626.3123677673733, 3.7093930861386424, 43.44049730839611, 72.17899968036085, 642.6867981871617, 35.98695602458378, 67.68528099899913, 82.31785764705545, 15.395938021066984, 29.514820572183897, 164.6983400886609, 703.5447724974902, 0.0, 690.8891803929088, 0.0, 32.191965546469454, 130.00542149660143, 292.56617018363596, 611.1870335177188, 61.34671796795267, 724.5601369143951, 160.41391461385052, 24.573761039901076, 0.0, 69.25744922886658, 666.0679049934988, 39.44252419739178, 24.88996389404034, 3.959926045321911, 616.3368269493412, 7.65119511479852, 102.5549302198376, 433.5553831129931, 639.5466697336382, 653.3363104920847, 94.50996999389938, 43.84269717659515, 86.02072107999805, 15.600190114824267, 30.140125104449822, 373.9363832134697, 8.579113708218108, 685.4157680541252, 20.820780457325757, 24.14445889676335, 79.45544962413634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5483278900822677, "mean_inference_ms": 1.5038478379528317, "mean_action_processing_ms": 0.2777683538028756, "mean_env_wait_ms": 0.18563974959966675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004943490028381348, "StateBufferConnector_ms": 0.0030881166458129883, "ViewRequirementAgentConnector_ms": 0.09146082401275635}, "num_episodes": 18, "episode_return_max": 167.78777592477408, "episode_return_min": -483.19851335352627, "episode_return_mean": -55.24745044498682, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.0362348858875, "num_env_steps_trained_throughput_per_sec": 382.0362348858875, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 11357.824, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11357.777, "sample_time_ms": 1518.398, "learn_time_ms": 9823.962, "learn_throughput": 407.168, "synch_weights_time_ms": 14.08}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "74486_00000", "date": "2024-08-16_15-00-50", "timestamp": 1723800650, "time_this_iter_s": 10.475499153137207, "time_total_s": 319.7454867362976, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397746dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 319.7454867362976, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 27.835714285714285, "ram_util_percent": 78.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7378322277434919, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.460575578073977, "policy_loss": -0.005660774235776256, "vf_loss": 8.465526479640335, "vf_explained_var": 0.03606467978664176, "kl": 0.007098759668937533, "entropy": 1.3312828291660894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0924466216374957, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.395754480614233, "policy_loss": -0.008327108378418617, "vf_loss": 6.403022094756838, "vf_explained_var": 0.06807764910516284, "kl": 0.010594916750752371, "entropy": 1.0349741324230477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 129.90331258756237, "episode_reward_min": -483.19851335352627, "episode_reward_mean": -73.68129811126772, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -687.2500819876657, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 102.9800000000001, "predator_policy": 724.5601369143951}, "policy_reward_mean": {"prey_policy": -235.71255357941624, "predator_policy": 198.87190452378243}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.309999999999796, -409.0411342259318, 69.15696905202802, 3.7299999999999685, 3.7799999999999647, 3.769999999999964, 5.809999999999919, 21.819945783250365, -95.66296365203983, 31.97000000000018, -442.0227532983696, 8.74999999999992, 51.369999999999614, 98.59540637133506, 129.90331258756237, 17.710000000000225, 2.0799999999999876, 52.239999999999355, 7.195065075055107, 35.49999999999943, -25.432520892370654, 112.84846290233644, 52.93179469188024, 51.32999999999956, -412.3508288864132, 83.01000000000074, 62.45003652528682, -39.18069828976158, -475.70095293882184, -463.1331845536429, 61.31999999999951, -172.87746155205454, -256.29650940473175, 103.48000000000047, 47.959999999999745, -13.543140078486712, -11.657162860842996, 6.619999999999924, -0.516966500423824, -378.66237313409846, 69.18, -452.766603066716, -385.6464673569827, 43.47999999999954, 52.146049777853634, -10.9351742991805, 107.88000000000103, 55.269999999999534, 39.10811350308208, 85.68000000000042, -362.9625912868468, 42.296572568912815, -284.0895698866288, 70.85000000000016, 59.73479717962518, -426.16716100936355, -414.83353940664875, 32.963934945146676, -34.05886840691074, -313.4667284198435, -398.90239960265524, 40.00889099935377, -483.19851335352627, 3.759999999999962, -51.35667590248642, -6.368629218226911, -129.91813664486494, -444.462098447892, 65.9043216993641, 96.93243264781394, -183.49905849046883, -164.24662076561867, 52.14999999999943, -372.7959181878273, 80.98999999999972, 86.92000000000036, 1.3747174183631745, -241.6852463277368, -154.31041484254746, 22.95937560732623, -60.88318633564519, 43.979999999999976, 96.89000000000111, -143.06064125011565, -103.95980767006743, -169.57442346247618, 61.71999999999988, 9.340810870273355, 104.96000000000035, -402.9716021139398, -370.5962591013139, 37.570783174950506, -399.5162076942533, 2.809999999999984, 16.72000000000005, 21.77000000000009, 80.07000000000104, 18.430000000000355, -32.210411688799155, 49.899999999999665], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.635985550604822, -14.350364532328353, -516.256480099909, -493.6143394979735, -25.76473793664864, -133.40569276147812, -31.55550391708999, -81.78553704982447, -20.884369379209296, -24.32893909757279, -33.28009115989024, -46.60466230758501, -7.93235390909893, -21.585298518386264, -60.45116268594581, 2.712651597391917, -567.5920914080742, -610.1376915660735, -31.15171528688889, -190.9784554260772, -549.7721319303965, -509.3057680398983, -3.3591750004148793, -30.226128354170843, 36.217120622895344, -22.09128811202377, -13.877061409561565, -154.02930641312588, 77.9169170562941, -68.08763955725888, 10.194385281958018, -29.553975000985442, -501.2545278873296, -1.1051545361707893, 8.483306547550708, -10.27590274164486, -52.858570682267725, -200.33972640938205, -10.255856033851499, 3.5399485095093652, -615.9547906595228, -652.1796792319755, 44.80224275870445, -114.17745938981984, 32.01150614253463, -609.4465186012235, -1.0856462986753934, -35.658182494692426, -548.5854432975221, -477.0141481635003, -0.8726347109910824, 24.066230977527344, -81.72073298484672, 0.6115129410454148, -563.6273672244431, -621.3446662070062, -528.7688212691014, -592.2293816159125, -500.9052244151341, -592.2725867916726, 51.873338618579886, -13.179814715003971, -328.472986687439, -223.8213554375361, -312.66632205466317, -529.9326216962619, 2.4494038806508476, -18.551783446587198, -232.46202080593827, 0.3592507324069904, -30.8906725288864, -47.73323773755228, -593.3424167753865, -642.1315596882885, -11.835533666709928, -92.79121285147093, -32.97634591498247, -42.7665413794561, -472.94864816216085, -490.34140471143206, 47.423464881705314, -19.57605000316183, -537.0595554708341, -498.64382305207266, -643.2604386100417, -427.5376984515345, -4.494266397586073, 24.204561680881373, 28.379048183289456, -82.44463998020638, -218.81996995095716, -131.85286656598637, 11.592398996390644, 78.43021457164839, -16.484213151690817, 25.843906658146132, -127.23322764650159, -19.68782005611268, -85.45468239825715, -51.921420983990686, -591.8453039660195, -401.1390481743391, -66.56831247329785, -6.754611946544779, -615.7999145619607, -346.9634095364134, -20.493025875676885, -58.66011277037776, -7.563850407709804, 22.387888994084605, -682.9237763054698, -611.4864972900449, -514.1840567064284, -591.5386630931276, 20.39863295027013, -19.62666355159257, -270.85465274373047, -185.7758073434191, -500.4624292950012, -485.5380506105116, -596.6263691432353, -687.2500819876657, 8.953728297579719, 6.481401661873543, -650.5219844877059, -568.0018830881855, -37.622524197392146, -22.949963894040035, -102.47166001707375, -569.1817688800753, -99.05320180895602, -17.52155274390619, -590.8497304475638, -612.1704590439318, -610.6104405553325, -581.6979383785433, -35.04045086271466, -28.918645694514353, 21.178545288865536, 30.013572139673705, -348.4354758117034, -217.57907960045438, -602.2875893237044, -268.1955799533644, 18.365541103236886, -69.81544962413557, -485.4145397451395, -506.7837973773463, -42.110863860890326, 33.614489789963855, -275.2331440478842, 62.36500657824429, -609.9016603859703, -630.0003854757405, -495.5566364160699, -549.735973078274, -587.794548382924, -595.6991576760611, -75.02137856622309, 19.517086911308475, -251.7734400906139, -164.83910311430026, 16.021979556493733, -444.20926537026776, 47.11800087942059, 9.551150399481628, -599.860504579385, -526.3832712503545, -541.2273704146814, -235.92891520671373, -374.52013747064734, -337.9182209028979, -145.49782406244563, 17.707590851618477, -659.8243356492065, -593.7873093103284, 102.9800000000001, -1.2372462252204224, -520.0166445229539, -475.8446428480903, -512.2749149008529, -586.4442655955645, -417.37630208562774, -304.37666123101565, -451.7319344535233, -566.9632750587642, -0.6195182158016401, -288.48566287807654, -32.931486282084514, -4.175198734254649, 5.0354852904876175, -617.6120891438143, -6.405036359556927, 53.971280408804716, -83.7732783583559, -37.33645128477861, -636.0379270450204, -599.4522621571932, -397.23771894077134, 27.896925861653724], "policy_predator_policy_reward": [79.25076439991957, 10.045585683013869, 567.356058547625, 33.473626824326466, 220.23285188665437, 8.094547863499614, 33.45550391708978, 83.6155370498254, 22.794369379209595, 26.19893909757306, 35.18009115988986, 48.47466230758464, 25.32058730861877, 10.007065118866661, 63.19116268594552, 16.367294185858217, 491.5490315157975, 590.5177878063106, 60.42930760873835, 193.67086310422673, 610.7995945814697, 6.255552090455361, 8.289175000414838, 34.04612835417106, 13.232879377104469, 24.01128811202407, 56.0403221244734, 210.4614520695487, 10.766395531269547, 109.3076395572595, 5.635614718041944, 31.433975000985736, 501.3445278873295, 3.095154536170767, 35.54019776753335, 18.492398426560726, 48.18511871610601, 212.20824345059725, 29.945856033851463, 12.270051490490596, 638.8797626242745, 603.8221863748533, 33.52717763640792, 148.69650189704248, 20.920288549345624, 609.4465186012235, 29.725646298675464, 58.34818249469209, 593.0713086391794, 20.1774539354306, 59.81640373346378, 0.0, 60.61306159281622, 82.9461949762723, 582.9476792676753, 562.843655874013, 2.053728930023472, 643.2435210161692, 3.8185246214217385, 626.2261020317418, 7.506661381419883, 15.11981471500393, 81.56699096246831, 297.8498896104528, 14.87378014117224, 571.4286542050216, 108.6511869530391, 10.931192612897366, 278.4320208059374, 1.630749267593011, 56.695968933235875, 8.384801254715642, 639.6020425584964, 584.2147710443351, 13.775533666709887, 97.4712128514718, 1.744585971290951, 73.48133482272311, 39.376174081545265, 545.2515056579484, 19.826535118294736, 21.50605000316213, 581.2401795908734, 1.6965958653176423, 669.3832806421266, 15.768389062467033, 6.464266397586031, 17.305438319118828, 46.31561350328231, 59.89602807148961, 321.35806783378723, 18.379594383974148, 9.18760100360932, 8.669785428352055, 39.5078596753119, 6.402446818232903, 121.12186934247394, 64.90729186322275, 170.3850490764675, 52.67105430578103, 626.3123677673733, 3.7093930861386424, 43.44049730839611, 72.17899968036085, 642.6867981871617, 35.98695602458378, 67.68528099899913, 82.31785764705545, 15.395938021066984, 29.514820572183897, 164.6983400886609, 703.5447724974902, 0.0, 690.8891803929088, 0.0, 32.191965546469454, 130.00542149660143, 292.56617018363596, 611.1870335177188, 61.34671796795267, 724.5601369143951, 160.41391461385052, 24.573761039901076, 0.0, 69.25744922886658, 666.0679049934988, 39.44252419739178, 24.88996389404034, 3.959926045321911, 616.3368269493412, 7.65119511479852, 102.5549302198376, 433.5553831129931, 639.5466697336382, 653.3363104920847, 94.50996999389938, 43.84269717659515, 86.02072107999805, 15.600190114824267, 30.140125104449822, 373.9363832134697, 8.579113708218108, 685.4157680541252, 20.820780457325757, 24.14445889676335, 79.45544962413634, 29.55287997274216, 589.8495389619164, 59.42971252784131, 30.05666154308542, 276.1131440478841, 23.674993421755584, 637.8272139309552, 603.4495493491178, 229.66261266956224, 573.944750497046, 609.0873755590627, 420.0959156573758, 78.46366726224136, 0.0, 78.32435403883994, 277.4050028304279, 27.488020443506485, 444.6792653702676, 29.001999120579317, 11.218849600518338, 634.9419618065617, 348.24117277306317, 612.2011047524215, 60.995373198906044, 48.5916713865905, 494.2722635244788, 146.96782406244563, 42.54240914838161, 667.1825350813269, 595.7699207484815, 0.0, 3.2172462252203977, 10.981688733325871, 581.9079965237788, 113.4373003917132, 614.6856210033914, 383.92110669969185, 375.40263979190206, 13.400210821742371, 605.7787909962924, 2.6095182158016286, 289.30566287807653, 47.68148628208417, 6.145198734254607, 15.734514709512345, 618.6120891438143, 8.365036359556886, 24.138719591195095, 85.57327835835682, 53.96645128477829, 661.0458794701492, 542.2338980432645, 406.5877189407711, 12.653074138346517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5451936617239624, "mean_inference_ms": 1.5088951975346356, "mean_action_processing_ms": 0.27381539598001303, "mean_env_wait_ms": 0.1849381401011461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003718733787536621, "StateBufferConnector_ms": 0.002966642379760742, "ViewRequirementAgentConnector_ms": 0.08719408512115479}, "num_episodes": 27, "episode_return_max": 129.90331258756237, "episode_return_min": -483.19851335352627, "episode_return_mean": -73.68129811126772, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.89680657957626, "num_env_steps_trained_throughput_per_sec": 369.89680657957626, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 11342.33, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11342.283, "sample_time_ms": 1539.472, "learn_time_ms": 9787.276, "learn_throughput": 408.694, "synch_weights_time_ms": 14.29}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "74486_00000", "date": "2024-08-16_15-01-01", "timestamp": 1723800661, "time_this_iter_s": 10.820410966873169, "time_total_s": 330.5658977031708, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397330790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 330.5658977031708, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 29.93125, "ram_util_percent": 77.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.568745547596109, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.189307253449051, "policy_loss": -0.009048775358805581, "vf_loss": 8.197157377162307, "vf_explained_var": 0.03794388625987623, "kl": 0.011986430987365135, "entropy": 1.319293500885131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1205018885867306, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.516020131237292, "policy_loss": -0.009888249261565901, "vf_loss": 5.524855664924339, "vf_explained_var": 0.05743855827699893, "kl": 0.01052713050404979, "entropy": 1.117979453669654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 121.4400000000006, "episode_reward_min": -489.3824988618237, "episode_reward_mean": -98.71392587078404, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -695.4772602153474, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 102.9800000000001, "predator_policy": 724.5601369143951}, "policy_reward_mean": {"prey_policy": -285.12793532481425, "predator_policy": 235.77097238942224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.195065075055107, 35.49999999999943, -25.432520892370654, 112.84846290233644, 52.93179469188024, 51.32999999999956, -412.3508288864132, 83.01000000000074, 62.45003652528682, -39.18069828976158, -475.70095293882184, -463.1331845536429, 61.31999999999951, -172.87746155205454, -256.29650940473175, 103.48000000000047, 47.959999999999745, -13.543140078486712, -11.657162860842996, 6.619999999999924, -0.516966500423824, -378.66237313409846, 69.18, -452.766603066716, -385.6464673569827, 43.47999999999954, 52.146049777853634, -10.9351742991805, 107.88000000000103, 55.269999999999534, 39.10811350308208, 85.68000000000042, -362.9625912868468, 42.296572568912815, -284.0895698866288, 70.85000000000016, 59.73479717962518, -426.16716100936355, -414.83353940664875, 32.963934945146676, -34.05886840691074, -313.4667284198435, -398.90239960265524, 40.00889099935377, -483.19851335352627, 3.759999999999962, -51.35667590248642, -6.368629218226911, -129.91813664486494, -444.462098447892, 65.9043216993641, 96.93243264781394, -183.49905849046883, -164.24662076561867, 52.14999999999943, -372.7959181878273, 80.98999999999972, 86.92000000000036, 1.3747174183631745, -241.6852463277368, -154.31041484254746, 22.95937560732623, -60.88318633564519, 43.979999999999976, 96.89000000000111, -143.06064125011565, -103.95980767006743, -169.57442346247618, 61.71999999999988, 9.340810870273355, 104.96000000000035, -402.9716021139398, -370.5962591013139, 37.570783174950506, -399.5162076942533, 2.809999999999984, 16.72000000000005, 21.77000000000009, 80.07000000000104, 18.430000000000355, -32.210411688799155, 49.899999999999665, 118.52415123650076, 75.88000000000059, -262.56183139916715, -15.61014317365835, -146.70652034958533, -67.54688201875557, -431.97436066690324, 19.716068940041346, -336.1469072822485, -445.3538186828292, 111.01628528707708, -338.547984055231, -36.33776714256391, -489.3824988618237, 121.4400000000006, -35.33145918581874, -294.836652058897, -448.2336739199402], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-52.858570682267725, -200.33972640938205, -10.255856033851499, 3.5399485095093652, -615.9547906595228, -652.1796792319755, 44.80224275870445, -114.17745938981984, 32.01150614253463, -609.4465186012235, -1.0856462986753934, -35.658182494692426, -548.5854432975221, -477.0141481635003, -0.8726347109910824, 24.066230977527344, -81.72073298484672, 0.6115129410454148, -563.6273672244431, -621.3446662070062, -528.7688212691014, -592.2293816159125, -500.9052244151341, -592.2725867916726, 51.873338618579886, -13.179814715003971, -328.472986687439, -223.8213554375361, -312.66632205466317, -529.9326216962619, 2.4494038806508476, -18.551783446587198, -232.46202080593827, 0.3592507324069904, -30.8906725288864, -47.73323773755228, -593.3424167753865, -642.1315596882885, -11.835533666709928, -92.79121285147093, -32.97634591498247, -42.7665413794561, -472.94864816216085, -490.34140471143206, 47.423464881705314, -19.57605000316183, -537.0595554708341, -498.64382305207266, -643.2604386100417, -427.5376984515345, -4.494266397586073, 24.204561680881373, 28.379048183289456, -82.44463998020638, -218.81996995095716, -131.85286656598637, 11.592398996390644, 78.43021457164839, -16.484213151690817, 25.843906658146132, -127.23322764650159, -19.68782005611268, -85.45468239825715, -51.921420983990686, -591.8453039660195, -401.1390481743391, -66.56831247329785, -6.754611946544779, -615.7999145619607, -346.9634095364134, -20.493025875676885, -58.66011277037776, -7.563850407709804, 22.387888994084605, -682.9237763054698, -611.4864972900449, -514.1840567064284, -591.5386630931276, 20.39863295027013, -19.62666355159257, -270.85465274373047, -185.7758073434191, -500.4624292950012, -485.5380506105116, -596.6263691432353, -687.2500819876657, 8.953728297579719, 6.481401661873543, -650.5219844877059, -568.0018830881855, -37.622524197392146, -22.949963894040035, -102.47166001707375, -569.1817688800753, -99.05320180895602, -17.52155274390619, -590.8497304475638, -612.1704590439318, -610.6104405553325, -581.6979383785433, -35.04045086271466, -28.918645694514353, 21.178545288865536, 30.013572139673705, -348.4354758117034, -217.57907960045438, -602.2875893237044, -268.1955799533644, 18.365541103236886, -69.81544962413557, -485.4145397451395, -506.7837973773463, -42.110863860890326, 33.614489789963855, -275.2331440478842, 62.36500657824429, -609.9016603859703, -630.0003854757405, -495.5566364160699, -549.735973078274, -587.794548382924, -595.6991576760611, -75.02137856622309, 19.517086911308475, -251.7734400906139, -164.83910311430026, 16.021979556493733, -444.20926537026776, 47.11800087942059, 9.551150399481628, -599.860504579385, -526.3832712503545, -541.2273704146814, -235.92891520671373, -374.52013747064734, -337.9182209028979, -145.49782406244563, 17.707590851618477, -659.8243356492065, -593.7873093103284, 102.9800000000001, -1.2372462252204224, -520.0166445229539, -475.8446428480903, -512.2749149008529, -586.4442655955645, -417.37630208562774, -304.37666123101565, -451.7319344535233, -566.9632750587642, -0.6195182158016401, -288.48566287807654, -32.931486282084514, -4.175198734254649, 5.0354852904876175, -617.6120891438143, -6.405036359556927, 53.971280408804716, -83.7732783583559, -37.33645128477861, -636.0379270450204, -599.4522621571932, -397.23771894077134, 27.896925861653724, -80.05900920999294, 0.2192543275058529, -38.999949154185614, 30.47201763260211, -568.0009185536143, -695.4772602153474, -653.0547514619285, -506.9409576073303, -435.9020116050126, -501.59429205500305, -131.58499489360958, -463.52726483429046, -576.4316428250278, -568.1291230898959, -584.2779458852161, -560.7383653601503, -535.5302312822855, -415.1266516806428, -569.006559758234, -491.20080717197146, -589.6417444061907, -584.686002864384, -490.29850684126666, -524.8131479447442, -406.57959627182146, -351.4835041236815, -584.4623066435333, -564.6369107209448, -3.0823831218518585, 6.927618443289925, -86.08603925055233, -110.1752709146967, -561.2620425890443, -365.657564682069, -489.58057426082365, -529.3760581711963], "policy_predator_policy_reward": [48.18511871610601, 212.20824345059725, 29.945856033851463, 12.270051490490596, 638.8797626242745, 603.8221863748533, 33.52717763640792, 148.69650189704248, 20.920288549345624, 609.4465186012235, 29.725646298675464, 58.34818249469209, 593.0713086391794, 20.1774539354306, 59.81640373346378, 0.0, 60.61306159281622, 82.9461949762723, 582.9476792676753, 562.843655874013, 2.053728930023472, 643.2435210161692, 3.8185246214217385, 626.2261020317418, 7.506661381419883, 15.11981471500393, 81.56699096246831, 297.8498896104528, 14.87378014117224, 571.4286542050216, 108.6511869530391, 10.931192612897366, 278.4320208059374, 1.630749267593011, 56.695968933235875, 8.384801254715642, 639.6020425584964, 584.2147710443351, 13.775533666709887, 97.4712128514718, 1.744585971290951, 73.48133482272311, 39.376174081545265, 545.2515056579484, 19.826535118294736, 21.50605000316213, 581.2401795908734, 1.6965958653176423, 669.3832806421266, 15.768389062467033, 6.464266397586031, 17.305438319118828, 46.31561350328231, 59.89602807148961, 321.35806783378723, 18.379594383974148, 9.18760100360932, 8.669785428352055, 39.5078596753119, 6.402446818232903, 121.12186934247394, 64.90729186322275, 170.3850490764675, 52.67105430578103, 626.3123677673733, 3.7093930861386424, 43.44049730839611, 72.17899968036085, 642.6867981871617, 35.98695602458378, 67.68528099899913, 82.31785764705545, 15.395938021066984, 29.514820572183897, 164.6983400886609, 703.5447724974902, 0.0, 690.8891803929088, 0.0, 32.191965546469454, 130.00542149660143, 292.56617018363596, 611.1870335177188, 61.34671796795267, 724.5601369143951, 160.41391461385052, 24.573761039901076, 0.0, 69.25744922886658, 666.0679049934988, 39.44252419739178, 24.88996389404034, 3.959926045321911, 616.3368269493412, 7.65119511479852, 102.5549302198376, 433.5553831129931, 639.5466697336382, 653.3363104920847, 94.50996999389938, 43.84269717659515, 86.02072107999805, 15.600190114824267, 30.140125104449822, 373.9363832134697, 8.579113708218108, 685.4157680541252, 20.820780457325757, 24.14445889676335, 79.45544962413634, 29.55287997274216, 589.8495389619164, 59.42971252784131, 30.05666154308542, 276.1131440478841, 23.674993421755584, 637.8272139309552, 603.4495493491178, 229.66261266956224, 573.944750497046, 609.0873755590627, 420.0959156573758, 78.46366726224136, 0.0, 78.32435403883994, 277.4050028304279, 27.488020443506485, 444.6792653702676, 29.001999120579317, 11.218849600518338, 634.9419618065617, 348.24117277306317, 612.2011047524215, 60.995373198906044, 48.5916713865905, 494.2722635244788, 146.96782406244563, 42.54240914838161, 667.1825350813269, 595.7699207484815, 0.0, 3.2172462252203977, 10.981688733325871, 581.9079965237788, 113.4373003917132, 614.6856210033914, 383.92110669969185, 375.40263979190206, 13.400210821742371, 605.7787909962924, 2.6095182158016286, 289.30566287807653, 47.68148628208417, 6.145198734254607, 15.734514709512345, 618.6120891438143, 8.365036359556886, 24.138719591195095, 85.57327835835682, 53.96645128477829, 661.0458794701492, 542.2338980432645, 406.5877189407711, 12.653074138346517, 125.84644168739447, 72.51746443159269, 46.739949154185304, 37.66798236739792, 280.66371900825243, 720.2526283615438, 683.0513766109757, 461.3341892846251, 300.17185232889244, 490.61793098153896, 19.95429403116063, 507.6110836779838, 19.773355771371197, 692.81304947665, 616.7807552638764, 547.9516249215313, 138.25859597235072, 476.25137970832907, 607.7656795870184, 7.087868660357492, 618.4194428234416, 666.9245897342114, 75.75964395739241, 600.8040267733885, 401.6625959776498, 320.0627372752894, 653.3708825573365, 6.345835945317784, 5.062383121851816, 112.53238155671009, 35.4755841896849, 125.45426678974786, 627.3657610682334, 4.717194143984143, 4.772180557038961, 565.9507779550413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.546466091165517, "mean_inference_ms": 1.5195203571469014, "mean_action_processing_ms": 0.27346817310318644, "mean_env_wait_ms": 0.18526064628836963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036290884017944336, "StateBufferConnector_ms": 0.0030177831649780273, "ViewRequirementAgentConnector_ms": 0.08918023109436035}, "num_episodes": 18, "episode_return_max": 121.4400000000006, "episode_return_min": -489.3824988618237, "episode_return_mean": -98.71392587078404, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.02978918720106, "num_env_steps_trained_throughput_per_sec": 381.02978918720106, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 11268.396, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11268.35, "sample_time_ms": 1527.6, "learn_time_ms": 9725.258, "learn_throughput": 411.3, "synch_weights_time_ms": 14.247}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "74486_00000", "date": "2024-08-16_15-01-12", "timestamp": 1723800672, "time_this_iter_s": 10.502821207046509, "time_total_s": 341.0687189102173, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397330550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 341.0687189102173, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 26.706666666666663, "ram_util_percent": 78.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6425889839570988, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.118496355934749, "policy_loss": -0.006854987022757688, "vf_loss": 8.124576376102588, "vf_explained_var": 0.05144744316736857, "kl": 0.007749614043768947, "entropy": 1.3023497869728735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0914796775610989, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.43898782175054, "policy_loss": -0.012351813846361385, "vf_loss": 5.44991169127207, "vf_explained_var": 0.06818343817241608, "kl": 0.014279489715945509, "entropy": 1.1263009961950716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 376.1431509515317, "episode_reward_min": -489.3824988618237, "episode_reward_mean": -101.12362483524538, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -695.4772602153474, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 102.9800000000001, "predator_policy": 724.5601369143951}, "policy_reward_mean": {"prey_policy": -301.2586841543842, "predator_policy": 250.69687173676158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.657162860842996, 6.619999999999924, -0.516966500423824, -378.66237313409846, 69.18, -452.766603066716, -385.6464673569827, 43.47999999999954, 52.146049777853634, -10.9351742991805, 107.88000000000103, 55.269999999999534, 39.10811350308208, 85.68000000000042, -362.9625912868468, 42.296572568912815, -284.0895698866288, 70.85000000000016, 59.73479717962518, -426.16716100936355, -414.83353940664875, 32.963934945146676, -34.05886840691074, -313.4667284198435, -398.90239960265524, 40.00889099935377, -483.19851335352627, 3.759999999999962, -51.35667590248642, -6.368629218226911, -129.91813664486494, -444.462098447892, 65.9043216993641, 96.93243264781394, -183.49905849046883, -164.24662076561867, 52.14999999999943, -372.7959181878273, 80.98999999999972, 86.92000000000036, 1.3747174183631745, -241.6852463277368, -154.31041484254746, 22.95937560732623, -60.88318633564519, 43.979999999999976, 96.89000000000111, -143.06064125011565, -103.95980767006743, -169.57442346247618, 61.71999999999988, 9.340810870273355, 104.96000000000035, -402.9716021139398, -370.5962591013139, 37.570783174950506, -399.5162076942533, 2.809999999999984, 16.72000000000005, 21.77000000000009, 80.07000000000104, 18.430000000000355, -32.210411688799155, 49.899999999999665, 118.52415123650076, 75.88000000000059, -262.56183139916715, -15.61014317365835, -146.70652034958533, -67.54688201875557, -431.97436066690324, 19.716068940041346, -336.1469072822485, -445.3538186828292, 111.01628528707708, -338.547984055231, -36.33776714256391, -489.3824988618237, 121.4400000000006, -35.33145918581874, -294.836652058897, -448.2336739199402, 3.8999999999999613, 74.76999999999974, -339.08409887413166, -142.40106614647698, 61.57997913298091, -294.7448672620211, 183.89000000000013, 376.1431509515317, -249.61257823027947, -19.247351064315655, -8.526791864336534, 127.64000000000078, -28.21336960826468, -408.3201870327622, -364.0176262201512, -396.66432705720416, -81.00200081592129, 22.451300243493968], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-593.3424167753865, -642.1315596882885, -11.835533666709928, -92.79121285147093, -32.97634591498247, -42.7665413794561, -472.94864816216085, -490.34140471143206, 47.423464881705314, -19.57605000316183, -537.0595554708341, -498.64382305207266, -643.2604386100417, -427.5376984515345, -4.494266397586073, 24.204561680881373, 28.379048183289456, -82.44463998020638, -218.81996995095716, -131.85286656598637, 11.592398996390644, 78.43021457164839, -16.484213151690817, 25.843906658146132, -127.23322764650159, -19.68782005611268, -85.45468239825715, -51.921420983990686, -591.8453039660195, -401.1390481743391, -66.56831247329785, -6.754611946544779, -615.7999145619607, -346.9634095364134, -20.493025875676885, -58.66011277037776, -7.563850407709804, 22.387888994084605, -682.9237763054698, -611.4864972900449, -514.1840567064284, -591.5386630931276, 20.39863295027013, -19.62666355159257, -270.85465274373047, -185.7758073434191, -500.4624292950012, -485.5380506105116, -596.6263691432353, -687.2500819876657, 8.953728297579719, 6.481401661873543, -650.5219844877059, -568.0018830881855, -37.622524197392146, -22.949963894040035, -102.47166001707375, -569.1817688800753, -99.05320180895602, -17.52155274390619, -590.8497304475638, -612.1704590439318, -610.6104405553325, -581.6979383785433, -35.04045086271466, -28.918645694514353, 21.178545288865536, 30.013572139673705, -348.4354758117034, -217.57907960045438, -602.2875893237044, -268.1955799533644, 18.365541103236886, -69.81544962413557, -485.4145397451395, -506.7837973773463, -42.110863860890326, 33.614489789963855, -275.2331440478842, 62.36500657824429, -609.9016603859703, -630.0003854757405, -495.5566364160699, -549.735973078274, -587.794548382924, -595.6991576760611, -75.02137856622309, 19.517086911308475, -251.7734400906139, -164.83910311430026, 16.021979556493733, -444.20926537026776, 47.11800087942059, 9.551150399481628, -599.860504579385, -526.3832712503545, -541.2273704146814, -235.92891520671373, -374.52013747064734, -337.9182209028979, -145.49782406244563, 17.707590851618477, -659.8243356492065, -593.7873093103284, 102.9800000000001, -1.2372462252204224, -520.0166445229539, -475.8446428480903, -512.2749149008529, -586.4442655955645, -417.37630208562774, -304.37666123101565, -451.7319344535233, -566.9632750587642, -0.6195182158016401, -288.48566287807654, -32.931486282084514, -4.175198734254649, 5.0354852904876175, -617.6120891438143, -6.405036359556927, 53.971280408804716, -83.7732783583559, -37.33645128477861, -636.0379270450204, -599.4522621571932, -397.23771894077134, 27.896925861653724, -80.05900920999294, 0.2192543275058529, -38.999949154185614, 30.47201763260211, -568.0009185536143, -695.4772602153474, -653.0547514619285, -506.9409576073303, -435.9020116050126, -501.59429205500305, -131.58499489360958, -463.52726483429046, -576.4316428250278, -568.1291230898959, -584.2779458852161, -560.7383653601503, -535.5302312822855, -415.1266516806428, -569.006559758234, -491.20080717197146, -589.6417444061907, -584.686002864384, -490.29850684126666, -524.8131479447442, -406.57959627182146, -351.4835041236815, -584.4623066435333, -564.6369107209448, -3.0823831218518585, 6.927618443289925, -86.08603925055233, -110.1752709146967, -561.2620425890443, -365.657564682069, -489.58057426082365, -529.3760581711963, -9.03845498080543, -17.10876601497381, 28.32787056585469, -154.49090909937098, -620.1469670561398, -452.7895168328482, -594.0524081491849, -604.0268469467075, 12.627254274504079, 19.7873939741324, -405.76587715394595, -490.44199609098507, 18.681189061110167, 93.32566437924005, -278.1907804704946, -61.18140424054275, -436.9790300567721, -463.9066118199026, -571.7475964650698, -614.3517814664816, -283.5006121301396, -99.92662617473485, 80.88097126748484, 2.0000000000000013, -411.955427980231, -382.20418849223483, -528.7537073323346, -523.63321716396, -451.1050327969436, -639.8853471535848, -613.6158467170687, -442.5310256551338, -553.3169841451179, -158.1904948743385, -477.0621178973344, -519.1753511093923], "policy_predator_policy_reward": [639.6020425584964, 584.2147710443351, 13.775533666709887, 97.4712128514718, 1.744585971290951, 73.48133482272311, 39.376174081545265, 545.2515056579484, 19.826535118294736, 21.50605000316213, 581.2401795908734, 1.6965958653176423, 669.3832806421266, 15.768389062467033, 6.464266397586031, 17.305438319118828, 46.31561350328231, 59.89602807148961, 321.35806783378723, 18.379594383974148, 9.18760100360932, 8.669785428352055, 39.5078596753119, 6.402446818232903, 121.12186934247394, 64.90729186322275, 170.3850490764675, 52.67105430578103, 626.3123677673733, 3.7093930861386424, 43.44049730839611, 72.17899968036085, 642.6867981871617, 35.98695602458378, 67.68528099899913, 82.31785764705545, 15.395938021066984, 29.514820572183897, 164.6983400886609, 703.5447724974902, 0.0, 690.8891803929088, 0.0, 32.191965546469454, 130.00542149660143, 292.56617018363596, 611.1870335177188, 61.34671796795267, 724.5601369143951, 160.41391461385052, 24.573761039901076, 0.0, 69.25744922886658, 666.0679049934988, 39.44252419739178, 24.88996389404034, 3.959926045321911, 616.3368269493412, 7.65119511479852, 102.5549302198376, 433.5553831129931, 639.5466697336382, 653.3363104920847, 94.50996999389938, 43.84269717659515, 86.02072107999805, 15.600190114824267, 30.140125104449822, 373.9363832134697, 8.579113708218108, 685.4157680541252, 20.820780457325757, 24.14445889676335, 79.45544962413634, 29.55287997274216, 589.8495389619164, 59.42971252784131, 30.05666154308542, 276.1131440478841, 23.674993421755584, 637.8272139309552, 603.4495493491178, 229.66261266956224, 573.944750497046, 609.0873755590627, 420.0959156573758, 78.46366726224136, 0.0, 78.32435403883994, 277.4050028304279, 27.488020443506485, 444.6792653702676, 29.001999120579317, 11.218849600518338, 634.9419618065617, 348.24117277306317, 612.2011047524215, 60.995373198906044, 48.5916713865905, 494.2722635244788, 146.96782406244563, 42.54240914838161, 667.1825350813269, 595.7699207484815, 0.0, 3.2172462252203977, 10.981688733325871, 581.9079965237788, 113.4373003917132, 614.6856210033914, 383.92110669969185, 375.40263979190206, 13.400210821742371, 605.7787909962924, 2.6095182158016286, 289.30566287807653, 47.68148628208417, 6.145198734254607, 15.734514709512345, 618.6120891438143, 8.365036359556886, 24.138719591195095, 85.57327835835682, 53.96645128477829, 661.0458794701492, 542.2338980432645, 406.5877189407711, 12.653074138346517, 125.84644168739447, 72.51746443159269, 46.739949154185304, 37.66798236739792, 280.66371900825243, 720.2526283615438, 683.0513766109757, 461.3341892846251, 300.17185232889244, 490.61793098153896, 19.95429403116063, 507.6110836779838, 19.773355771371197, 692.81304947665, 616.7807552638764, 547.9516249215313, 138.25859597235072, 476.25137970832907, 607.7656795870184, 7.087868660357492, 618.4194428234416, 666.9245897342114, 75.75964395739241, 600.8040267733885, 401.6625959776498, 320.0627372752894, 653.3708825573365, 6.345835945317784, 5.062383121851816, 112.53238155671009, 35.4755841896849, 125.45426678974786, 627.3657610682334, 4.717194143984143, 4.772180557038961, 565.9507779550413, 10.988454980805388, 19.058766014974115, 44.78212943414529, 156.15090909936947, 667.3329479745919, 66.51943704026382, 399.9895349755143, 655.6886539739012, 0.0, 29.16533088434523, 541.3148293210854, 60.148176661824806, 57.31881093888973, 14.564335620759968, 397.3597489685196, 318.15558669404965, 509.8863363430332, 141.38672730336245, 556.9661853869069, 609.8858414803288, 3.405078628572307, 371.49536781196565, 44.75902873251533, 0.0, 429.91868709796853, 336.02755976623257, 67.12917554205465, 576.9375619214785, 57.42058499202699, 669.5521687383506, 655.5300524261394, 3.952492888858959, 601.6647522488466, 28.84072595468881, 571.0293809479542, 447.65938830226645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5455565810662952, "mean_inference_ms": 1.5243362324680982, "mean_action_processing_ms": 0.27181378168778464, "mean_env_wait_ms": 0.1851042222420592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036461353302001953, "StateBufferConnector_ms": 0.0029708147048950195, "ViewRequirementAgentConnector_ms": 0.08917820453643799}, "num_episodes": 18, "episode_return_max": 376.1431509515317, "episode_return_min": -489.3824988618237, "episode_return_mean": -101.12362483524538, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.770733307112, "num_env_steps_trained_throughput_per_sec": 384.770733307112, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 11096.463, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11096.42, "sample_time_ms": 1518.396, "learn_time_ms": 9563.121, "learn_throughput": 418.273, "synch_weights_time_ms": 13.776}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "74486_00000", "date": "2024-08-16_15-01-22", "timestamp": 1723800682, "time_this_iter_s": 10.400630950927734, "time_total_s": 351.469349861145, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3972ebd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 351.469349861145, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 29.233333333333334, "ram_util_percent": 78.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5325987261281442, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.466006693007454, "policy_loss": -0.0070304121430371964, "vf_loss": 8.472156004174046, "vf_explained_var": 0.05247321002697818, "kl": 0.008811162986988088, "entropy": 1.2917923003277452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0325795581258794, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.923498936052676, "policy_loss": -0.00811345745543284, "vf_loss": 6.930730923647603, "vf_explained_var": 0.07399182827384383, "kl": 0.008814639741326112, "entropy": 1.0872485770119562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 376.1431509515317, "episode_reward_min": -489.3824988618237, "episode_reward_mean": -96.53666838671299, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -706.8249166362941, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 130.4520445394014, "predator_policy": 727.7660336225844}, "policy_reward_mean": {"prey_policy": -333.4543193746239, "predator_policy": 285.1859851812675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.73479717962518, -426.16716100936355, -414.83353940664875, 32.963934945146676, -34.05886840691074, -313.4667284198435, -398.90239960265524, 40.00889099935377, -483.19851335352627, 3.759999999999962, -51.35667590248642, -6.368629218226911, -129.91813664486494, -444.462098447892, 65.9043216993641, 96.93243264781394, -183.49905849046883, -164.24662076561867, 52.14999999999943, -372.7959181878273, 80.98999999999972, 86.92000000000036, 1.3747174183631745, -241.6852463277368, -154.31041484254746, 22.95937560732623, -60.88318633564519, 43.979999999999976, 96.89000000000111, -143.06064125011565, -103.95980767006743, -169.57442346247618, 61.71999999999988, 9.340810870273355, 104.96000000000035, -402.9716021139398, -370.5962591013139, 37.570783174950506, -399.5162076942533, 2.809999999999984, 16.72000000000005, 21.77000000000009, 80.07000000000104, 18.430000000000355, -32.210411688799155, 49.899999999999665, 118.52415123650076, 75.88000000000059, -262.56183139916715, -15.61014317365835, -146.70652034958533, -67.54688201875557, -431.97436066690324, 19.716068940041346, -336.1469072822485, -445.3538186828292, 111.01628528707708, -338.547984055231, -36.33776714256391, -489.3824988618237, 121.4400000000006, -35.33145918581874, -294.836652058897, -448.2336739199402, 3.8999999999999613, 74.76999999999974, -339.08409887413166, -142.40106614647698, 61.57997913298091, -294.7448672620211, 183.89000000000013, 376.1431509515317, -249.61257823027947, -19.247351064315655, -8.526791864336534, 127.64000000000078, -28.21336960826468, -408.3201870327622, -364.0176262201512, -396.66432705720416, -81.00200081592129, 22.451300243493968, -170.86907139170884, 34.692190313157596, -266.4838798717904, 260.3394319814206, -311.09882101945055, 3.8099999999999627, 74.10724297703008, -50.65079177731054, -135.6866524647281, -4.6332764043909105, 151.63576140165088, 26.936650449170145, -320.22669476318663, -112.73689466876411, -235.8339764561646, 55.134776892234996, 77.08999999999969, 68.44347711420087], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.563850407709804, 22.387888994084605, -682.9237763054698, -611.4864972900449, -514.1840567064284, -591.5386630931276, 20.39863295027013, -19.62666355159257, -270.85465274373047, -185.7758073434191, -500.4624292950012, -485.5380506105116, -596.6263691432353, -687.2500819876657, 8.953728297579719, 6.481401661873543, -650.5219844877059, -568.0018830881855, -37.622524197392146, -22.949963894040035, -102.47166001707375, -569.1817688800753, -99.05320180895602, -17.52155274390619, -590.8497304475638, -612.1704590439318, -610.6104405553325, -581.6979383785433, -35.04045086271466, -28.918645694514353, 21.178545288865536, 30.013572139673705, -348.4354758117034, -217.57907960045438, -602.2875893237044, -268.1955799533644, 18.365541103236886, -69.81544962413557, -485.4145397451395, -506.7837973773463, -42.110863860890326, 33.614489789963855, -275.2331440478842, 62.36500657824429, -609.9016603859703, -630.0003854757405, -495.5566364160699, -549.735973078274, -587.794548382924, -595.6991576760611, -75.02137856622309, 19.517086911308475, -251.7734400906139, -164.83910311430026, 16.021979556493733, -444.20926537026776, 47.11800087942059, 9.551150399481628, -599.860504579385, -526.3832712503545, -541.2273704146814, -235.92891520671373, -374.52013747064734, -337.9182209028979, -145.49782406244563, 17.707590851618477, -659.8243356492065, -593.7873093103284, 102.9800000000001, -1.2372462252204224, -520.0166445229539, -475.8446428480903, -512.2749149008529, -586.4442655955645, -417.37630208562774, -304.37666123101565, -451.7319344535233, -566.9632750587642, -0.6195182158016401, -288.48566287807654, -32.931486282084514, -4.175198734254649, 5.0354852904876175, -617.6120891438143, -6.405036359556927, 53.971280408804716, -83.7732783583559, -37.33645128477861, -636.0379270450204, -599.4522621571932, -397.23771894077134, 27.896925861653724, -80.05900920999294, 0.2192543275058529, -38.999949154185614, 30.47201763260211, -568.0009185536143, -695.4772602153474, -653.0547514619285, -506.9409576073303, -435.9020116050126, -501.59429205500305, -131.58499489360958, -463.52726483429046, -576.4316428250278, -568.1291230898959, -584.2779458852161, -560.7383653601503, -535.5302312822855, -415.1266516806428, -569.006559758234, -491.20080717197146, -589.6417444061907, -584.686002864384, -490.29850684126666, -524.8131479447442, -406.57959627182146, -351.4835041236815, -584.4623066435333, -564.6369107209448, -3.0823831218518585, 6.927618443289925, -86.08603925055233, -110.1752709146967, -561.2620425890443, -365.657564682069, -489.58057426082365, -529.3760581711963, -9.03845498080543, -17.10876601497381, 28.32787056585469, -154.49090909937098, -620.1469670561398, -452.7895168328482, -594.0524081491849, -604.0268469467075, 12.627254274504079, 19.7873939741324, -405.76587715394595, -490.44199609098507, 18.681189061110167, 93.32566437924005, -278.1907804704946, -61.18140424054275, -436.9790300567721, -463.9066118199026, -571.7475964650698, -614.3517814664816, -283.5006121301396, -99.92662617473485, 80.88097126748484, 2.0000000000000013, -411.955427980231, -382.20418849223483, -528.7537073323346, -523.63321716396, -451.1050327969436, -639.8853471535848, -613.6158467170687, -442.5310256551338, -553.3169841451179, -158.1904948743385, -477.0621178973344, -519.1753511093923, -346.5025359877866, -233.34528496718738, -634.6062561004713, -685.1164735472889, -612.3886984921133, -508.6593031108889, -441.46713949797316, 130.4520445394014, -537.0867945952433, -460.39836204232444, -16.645079319103058, -55.70644147828146, 19.820000000000285, -52.80713520695755, -440.82820546471453, -136.4340210593959, -652.3207095157508, -669.3165803438134, -103.40597973677328, -126.00696018067548, -591.6903794004697, -350.0988694070733, -617.2135490350217, -593.859323891586, -706.8249166362941, -361.98143368252175, -606.2053989815477, -534.3417683873556, -283.2697411124998, -658.47701440824, -570.0750280594982, -207.57784761282218, -28.064371469609593, 47.035795915757184, -461.4410730447154, -488.22668892849], "policy_predator_policy_reward": [15.395938021066984, 29.514820572183897, 164.6983400886609, 703.5447724974902, 0.0, 690.8891803929088, 0.0, 32.191965546469454, 130.00542149660143, 292.56617018363596, 611.1870335177188, 61.34671796795267, 724.5601369143951, 160.41391461385052, 24.573761039901076, 0.0, 69.25744922886658, 666.0679049934988, 39.44252419739178, 24.88996389404034, 3.959926045321911, 616.3368269493412, 7.65119511479852, 102.5549302198376, 433.5553831129931, 639.5466697336382, 653.3363104920847, 94.50996999389938, 43.84269717659515, 86.02072107999805, 15.600190114824267, 30.140125104449822, 373.9363832134697, 8.579113708218108, 685.4157680541252, 20.820780457325757, 24.14445889676335, 79.45544962413634, 29.55287997274216, 589.8495389619164, 59.42971252784131, 30.05666154308542, 276.1131440478841, 23.674993421755584, 637.8272139309552, 603.4495493491178, 229.66261266956224, 573.944750497046, 609.0873755590627, 420.0959156573758, 78.46366726224136, 0.0, 78.32435403883994, 277.4050028304279, 27.488020443506485, 444.6792653702676, 29.001999120579317, 11.218849600518338, 634.9419618065617, 348.24117277306317, 612.2011047524215, 60.995373198906044, 48.5916713865905, 494.2722635244788, 146.96782406244563, 42.54240914838161, 667.1825350813269, 595.7699207484815, 0.0, 3.2172462252203977, 10.981688733325871, 581.9079965237788, 113.4373003917132, 614.6856210033914, 383.92110669969185, 375.40263979190206, 13.400210821742371, 605.7787909962924, 2.6095182158016286, 289.30566287807653, 47.68148628208417, 6.145198734254607, 15.734514709512345, 618.6120891438143, 8.365036359556886, 24.138719591195095, 85.57327835835682, 53.96645128477829, 661.0458794701492, 542.2338980432645, 406.5877189407711, 12.653074138346517, 125.84644168739447, 72.51746443159269, 46.739949154185304, 37.66798236739792, 280.66371900825243, 720.2526283615438, 683.0513766109757, 461.3341892846251, 300.17185232889244, 490.61793098153896, 19.95429403116063, 507.6110836779838, 19.773355771371197, 692.81304947665, 616.7807552638764, 547.9516249215313, 138.25859597235072, 476.25137970832907, 607.7656795870184, 7.087868660357492, 618.4194428234416, 666.9245897342114, 75.75964395739241, 600.8040267733885, 401.6625959776498, 320.0627372752894, 653.3708825573365, 6.345835945317784, 5.062383121851816, 112.53238155671009, 35.4755841896849, 125.45426678974786, 627.3657610682334, 4.717194143984143, 4.772180557038961, 565.9507779550413, 10.988454980805388, 19.058766014974115, 44.78212943414529, 156.15090909936947, 667.3329479745919, 66.51943704026382, 399.9895349755143, 655.6886539739012, 0.0, 29.16533088434523, 541.3148293210854, 60.148176661824806, 57.31881093888973, 14.564335620759968, 397.3597489685196, 318.15558669404965, 509.8863363430332, 141.38672730336245, 556.9661853869069, 609.8858414803288, 3.405078628572307, 371.49536781196565, 44.75902873251533, 0.0, 429.91868709796853, 336.02755976623257, 67.12917554205465, 576.9375619214785, 57.42058499202699, 669.5521687383506, 655.5300524261394, 3.952492888858959, 601.6647522488466, 28.84072595468881, 571.0293809479542, 447.65938830226645, 163.97662352789953, 245.00212603536514, 691.5802965215183, 662.8346234393995, 658.5559879209179, 196.00813381029596, 189.50970761939695, 381.8448193205956, 635.4946061937397, 50.89172942437833, 71.95007635112671, 4.211444446257756, 57.506756834362115, 49.58762134962358, 477.62283600588637, 48.988598740913865, 701.2707213285695, 484.6799160662668, 212.51198407053653, 12.26767944252118, 582.6764476545069, 510.748562554687, 610.8981416568561, 627.1113817189216, 727.7660336225844, 20.813621933045184, 637.2209455330585, 390.5893271670808, 9.426830397075664, 696.4859486675001, 572.2077007988472, 260.57995176570887, 51.80164380412419, 6.316931749728431, 531.3527871907578, 486.75845189664784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5447593775065985, "mean_inference_ms": 1.5290991976194448, "mean_action_processing_ms": 0.2702822931617774, "mean_env_wait_ms": 0.18501507805241985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003634214401245117, "StateBufferConnector_ms": 0.0029534101486206055, "ViewRequirementAgentConnector_ms": 0.08961665630340576}, "num_episodes": 18, "episode_return_max": 376.1431509515317, "episode_return_min": -489.3824988618237, "episode_return_mean": -96.53666838671299, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.0599691571855, "num_env_steps_trained_throughput_per_sec": 373.0599691571855, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 10821.21, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10821.168, "sample_time_ms": 1325.688, "learn_time_ms": 9480.544, "learn_throughput": 421.917, "synch_weights_time_ms": 13.83}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "74486_00000", "date": "2024-08-16_15-01-33", "timestamp": 1723800693, "time_this_iter_s": 10.726966142654419, "time_total_s": 362.19631600379944, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39736f0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 362.19631600379944, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.679999999999993, "ram_util_percent": 78.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6899545316027587, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.262712882813954, "policy_loss": -0.008313541155968787, "vf_loss": 8.269912460367516, "vf_explained_var": 0.04102509866946589, "kl": 0.011139468822745146, "entropy": 1.2952030526897895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0125239506442711, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.80479002402573, "policy_loss": -0.008890364877633238, "vf_loss": 8.812386031882474, "vf_explained_var": 0.05016169535419928, "kl": 0.012944033360008097, "entropy": 0.9836005681721621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 390.3877302554436, "episode_reward_min": -489.3824988618237, "episode_reward_mean": -53.74410256540023, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -706.8249166362941, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 130.4520445394014, "predator_policy": 727.7660336225844}, "policy_reward_mean": {"prey_policy": -350.2353702768445, "predator_policy": 323.36331899414444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.3747174183631745, -241.6852463277368, -154.31041484254746, 22.95937560732623, -60.88318633564519, 43.979999999999976, 96.89000000000111, -143.06064125011565, -103.95980767006743, -169.57442346247618, 61.71999999999988, 9.340810870273355, 104.96000000000035, -402.9716021139398, -370.5962591013139, 37.570783174950506, -399.5162076942533, 2.809999999999984, 16.72000000000005, 21.77000000000009, 80.07000000000104, 18.430000000000355, -32.210411688799155, 49.899999999999665, 118.52415123650076, 75.88000000000059, -262.56183139916715, -15.61014317365835, -146.70652034958533, -67.54688201875557, -431.97436066690324, 19.716068940041346, -336.1469072822485, -445.3538186828292, 111.01628528707708, -338.547984055231, -36.33776714256391, -489.3824988618237, 121.4400000000006, -35.33145918581874, -294.836652058897, -448.2336739199402, 3.8999999999999613, 74.76999999999974, -339.08409887413166, -142.40106614647698, 61.57997913298091, -294.7448672620211, 183.89000000000013, 376.1431509515317, -249.61257823027947, -19.247351064315655, -8.526791864336534, 127.64000000000078, -28.21336960826468, -408.3201870327622, -364.0176262201512, -396.66432705720416, -81.00200081592129, 22.451300243493968, -170.86907139170884, 34.692190313157596, -266.4838798717904, 260.3394319814206, -311.09882101945055, 3.8099999999999627, 74.10724297703008, -50.65079177731054, -135.6866524647281, -4.6332764043909105, 151.63576140165088, 26.936650449170145, -320.22669476318663, -112.73689466876411, -235.8339764561646, 55.134776892234996, 77.08999999999969, 68.44347711420087, 208.21005839562767, 134.59945375554958, 55.26779296337678, -5.439669906516193, 231.61584635065816, 350.68151462621427, 266.73205337722294, 20.189640860630305, 347.9909841084318, 87.19121534045411, -5.751557410236721, -86.40102803177092, -189.81427983208292, 390.3877302554436, -82.25920321203814, 3.848262074839352, 19.169999999999966, 222.15315641274367, -181.70742476234187, -102.65308500149047, 78.06000000000006, -386.7248486184698], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-609.9016603859703, -630.0003854757405, -495.5566364160699, -549.735973078274, -587.794548382924, -595.6991576760611, -75.02137856622309, 19.517086911308475, -251.7734400906139, -164.83910311430026, 16.021979556493733, -444.20926537026776, 47.11800087942059, 9.551150399481628, -599.860504579385, -526.3832712503545, -541.2273704146814, -235.92891520671373, -374.52013747064734, -337.9182209028979, -145.49782406244563, 17.707590851618477, -659.8243356492065, -593.7873093103284, 102.9800000000001, -1.2372462252204224, -520.0166445229539, -475.8446428480903, -512.2749149008529, -586.4442655955645, -417.37630208562774, -304.37666123101565, -451.7319344535233, -566.9632750587642, -0.6195182158016401, -288.48566287807654, -32.931486282084514, -4.175198734254649, 5.0354852904876175, -617.6120891438143, -6.405036359556927, 53.971280408804716, -83.7732783583559, -37.33645128477861, -636.0379270450204, -599.4522621571932, -397.23771894077134, 27.896925861653724, -80.05900920999294, 0.2192543275058529, -38.999949154185614, 30.47201763260211, -568.0009185536143, -695.4772602153474, -653.0547514619285, -506.9409576073303, -435.9020116050126, -501.59429205500305, -131.58499489360958, -463.52726483429046, -576.4316428250278, -568.1291230898959, -584.2779458852161, -560.7383653601503, -535.5302312822855, -415.1266516806428, -569.006559758234, -491.20080717197146, -589.6417444061907, -584.686002864384, -490.29850684126666, -524.8131479447442, -406.57959627182146, -351.4835041236815, -584.4623066435333, -564.6369107209448, -3.0823831218518585, 6.927618443289925, -86.08603925055233, -110.1752709146967, -561.2620425890443, -365.657564682069, -489.58057426082365, -529.3760581711963, -9.03845498080543, -17.10876601497381, 28.32787056585469, -154.49090909937098, -620.1469670561398, -452.7895168328482, -594.0524081491849, -604.0268469467075, 12.627254274504079, 19.7873939741324, -405.76587715394595, -490.44199609098507, 18.681189061110167, 93.32566437924005, -278.1907804704946, -61.18140424054275, -436.9790300567721, -463.9066118199026, -571.7475964650698, -614.3517814664816, -283.5006121301396, -99.92662617473485, 80.88097126748484, 2.0000000000000013, -411.955427980231, -382.20418849223483, -528.7537073323346, -523.63321716396, -451.1050327969436, -639.8853471535848, -613.6158467170687, -442.5310256551338, -553.3169841451179, -158.1904948743385, -477.0621178973344, -519.1753511093923, -346.5025359877866, -233.34528496718738, -634.6062561004713, -685.1164735472889, -612.3886984921133, -508.6593031108889, -441.46713949797316, 130.4520445394014, -537.0867945952433, -460.39836204232444, -16.645079319103058, -55.70644147828146, 19.820000000000285, -52.80713520695755, -440.82820546471453, -136.4340210593959, -652.3207095157508, -669.3165803438134, -103.40597973677328, -126.00696018067548, -591.6903794004697, -350.0988694070733, -617.2135490350217, -593.859323891586, -706.8249166362941, -361.98143368252175, -606.2053989815477, -534.3417683873556, -283.2697411124998, -658.47701440824, -570.0750280594982, -207.57784761282218, -28.064371469609593, 47.035795915757184, -461.4410730447154, -488.22668892849, -450.36456586979097, -560.7919673231173, -685.5567883005539, -426.6683090781995, -531.8493320496555, -601.1501292032543, -604.7597211590705, -565.0343077462013, -603.1614017540593, -71.75627410057741, -594.1579620324155, -46.1670560117182, 28.374323414870428, -253.4717928353606, -128.60589780279108, -582.1921553560403, -19.054338895739836, -515.3319491950391, -370.74897731101447, 6.958193275358491, -530.0849903079516, -530.3994783483547, -424.6488977354095, -554.7666737237123, -277.614339485389, -615.1154705185311, -570.0227127348762, 104.80418591823229, -108.15466113143229, -163.26080677251952, -62.79048592367548, -50.394638472329916, -495.45550862530155, -22.722186036533497, -37.55819779152979, -265.41143519702706, -696.4153220266766, -511.77357383804446, -597.1878222848645, -538.8221648935432, 2.0000000000000013, 16.476746569308276, -503.46021330022614, -620.4809395680637], "policy_predator_policy_reward": [637.8272139309552, 603.4495493491178, 229.66261266956224, 573.944750497046, 609.0873755590627, 420.0959156573758, 78.46366726224136, 0.0, 78.32435403883994, 277.4050028304279, 27.488020443506485, 444.6792653702676, 29.001999120579317, 11.218849600518338, 634.9419618065617, 348.24117277306317, 612.2011047524215, 60.995373198906044, 48.5916713865905, 494.2722635244788, 146.96782406244563, 42.54240914838161, 667.1825350813269, 595.7699207484815, 0.0, 3.2172462252203977, 10.981688733325871, 581.9079965237788, 113.4373003917132, 614.6856210033914, 383.92110669969185, 375.40263979190206, 13.400210821742371, 605.7787909962924, 2.6095182158016286, 289.30566287807653, 47.68148628208417, 6.145198734254607, 15.734514709512345, 618.6120891438143, 8.365036359556886, 24.138719591195095, 85.57327835835682, 53.96645128477829, 661.0458794701492, 542.2338980432645, 406.5877189407711, 12.653074138346517, 125.84644168739447, 72.51746443159269, 46.739949154185304, 37.66798236739792, 280.66371900825243, 720.2526283615438, 683.0513766109757, 461.3341892846251, 300.17185232889244, 490.61793098153896, 19.95429403116063, 507.6110836779838, 19.773355771371197, 692.81304947665, 616.7807552638764, 547.9516249215313, 138.25859597235072, 476.25137970832907, 607.7656795870184, 7.087868660357492, 618.4194428234416, 666.9245897342114, 75.75964395739241, 600.8040267733885, 401.6625959776498, 320.0627372752894, 653.3708825573365, 6.345835945317784, 5.062383121851816, 112.53238155671009, 35.4755841896849, 125.45426678974786, 627.3657610682334, 4.717194143984143, 4.772180557038961, 565.9507779550413, 10.988454980805388, 19.058766014974115, 44.78212943414529, 156.15090909936947, 667.3329479745919, 66.51943704026382, 399.9895349755143, 655.6886539739012, 0.0, 29.16533088434523, 541.3148293210854, 60.148176661824806, 57.31881093888973, 14.564335620759968, 397.3597489685196, 318.15558669404965, 509.8863363430332, 141.38672730336245, 556.9661853869069, 609.8858414803288, 3.405078628572307, 371.49536781196565, 44.75902873251533, 0.0, 429.91868709796853, 336.02755976623257, 67.12917554205465, 576.9375619214785, 57.42058499202699, 669.5521687383506, 655.5300524261394, 3.952492888858959, 601.6647522488466, 28.84072595468881, 571.0293809479542, 447.65938830226645, 163.97662352789953, 245.00212603536514, 691.5802965215183, 662.8346234393995, 658.5559879209179, 196.00813381029596, 189.50970761939695, 381.8448193205956, 635.4946061937397, 50.89172942437833, 71.95007635112671, 4.211444446257756, 57.506756834362115, 49.58762134962358, 477.62283600588637, 48.988598740913865, 701.2707213285695, 484.6799160662668, 212.51198407053653, 12.26767944252118, 582.6764476545069, 510.748562554687, 610.8981416568561, 627.1113817189216, 727.7660336225844, 20.813621933045184, 637.2209455330585, 390.5893271670808, 9.426830397075664, 696.4859486675001, 572.2077007988472, 260.57995176570887, 51.80164380412419, 6.316931749728431, 531.3527871907578, 486.75845189664784, 600.0832571619403, 619.283334426596, 596.398680960776, 650.4258701735272, 567.0706522167615, 621.196601999525, 579.6614230662109, 584.692935932544, 580.7225951642231, 325.8109270410726, 584.1371836617898, 406.8693490085584, 271.3773934313943, 220.452129366319, 148.70553866341982, 582.2821553560404, 425.8322573866618, 456.5450148125495, 7.597902235412346, 443.3840971406979, 495.55560285854364, 559.1773083875266, 299.0014620807045, 594.013081346647, 3.9967947494222718, 698.9187354224149, 378.311525905823, 477.2947311662652, 184.64505019455333, 4.511214497359855, 105.70978981834092, 11.32359665250358, 502.77550862530154, 34.57218603653313, 225.36711875769427, 299.7556706436058, 713.3906635063664, 313.0908075960123, 666.8590180952833, 366.49788408163505, 0.0, 59.583253430691556, 11.012736822703172, 726.2035674271168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.544303865173629, "mean_inference_ms": 1.5355745352619508, "mean_action_processing_ms": 0.2683838308941927, "mean_env_wait_ms": 0.18506125250901626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687262535095215, "StateBufferConnector_ms": 0.0029834508895874023, "ViewRequirementAgentConnector_ms": 0.09604918956756592}, "num_episodes": 22, "episode_return_max": 390.3877302554436, "episode_return_min": -489.3824988618237, "episode_return_mean": -53.74410256540023, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.7927064676649, "num_env_steps_trained_throughput_per_sec": 361.7927064676649, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 10809.293, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10809.251, "sample_time_ms": 1337.696, "learn_time_ms": 9456.263, "learn_throughput": 423.0, "synch_weights_time_ms": 14.198}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "74486_00000", "date": "2024-08-16_15-01-44", "timestamp": 1723800704, "time_this_iter_s": 11.061326742172241, "time_total_s": 373.2576427459717, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39736f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 373.2576427459717, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 28.1125, "ram_util_percent": 78.60624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7874296347773264, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.816600088089231, "policy_loss": -0.007659435118228276, "vf_loss": 7.823339343701721, "vf_explained_var": 0.08786107333248885, "kl": 0.00920166679886708, "entropy": 1.308056177979424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2782482899686016, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.947559155358208, "policy_loss": -0.005421528627199156, "vf_loss": 7.952089773157917, "vf_explained_var": 0.0632414404361967, "kl": 0.008908924206145643, "entropy": 0.8813394110038798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 460.48229168185605, "episode_reward_min": -489.3824988618237, "episode_reward_mean": -12.414148656040915, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -706.8249166362941, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 130.4520445394014, "predator_policy": 727.7660336225844}, "policy_reward_mean": {"prey_policy": -358.3661143241118, "predator_policy": 352.15903999609145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.899999999999665, 118.52415123650076, 75.88000000000059, -262.56183139916715, -15.61014317365835, -146.70652034958533, -67.54688201875557, -431.97436066690324, 19.716068940041346, -336.1469072822485, -445.3538186828292, 111.01628528707708, -338.547984055231, -36.33776714256391, -489.3824988618237, 121.4400000000006, -35.33145918581874, -294.836652058897, -448.2336739199402, 3.8999999999999613, 74.76999999999974, -339.08409887413166, -142.40106614647698, 61.57997913298091, -294.7448672620211, 183.89000000000013, 376.1431509515317, -249.61257823027947, -19.247351064315655, -8.526791864336534, 127.64000000000078, -28.21336960826468, -408.3201870327622, -364.0176262201512, -396.66432705720416, -81.00200081592129, 22.451300243493968, -170.86907139170884, 34.692190313157596, -266.4838798717904, 260.3394319814206, -311.09882101945055, 3.8099999999999627, 74.10724297703008, -50.65079177731054, -135.6866524647281, -4.6332764043909105, 151.63576140165088, 26.936650449170145, -320.22669476318663, -112.73689466876411, -235.8339764561646, 55.134776892234996, 77.08999999999969, 68.44347711420087, 208.21005839562767, 134.59945375554958, 55.26779296337678, -5.439669906516193, 231.61584635065816, 350.68151462621427, 266.73205337722294, 20.189640860630305, 347.9909841084318, 87.19121534045411, -5.751557410236721, -86.40102803177092, -189.81427983208292, 390.3877302554436, -82.25920321203814, 3.848262074839352, 19.169999999999966, 222.15315641274367, -181.70742476234187, -102.65308500149047, 78.06000000000006, -386.7248486184698, 248.42139724166884, 235.13852887487693, 340.0097944775927, 3.6799999999999646, 219.81482992923412, 460.48229168185605, 45.851157536474844, -21.8625841178659, 432.88460524733193, 202.65688969464483, 3.6699999999999635, -69.77916011617218, 42.86000000000004, 42.98666465312115, 175.418643711793, 145.47000000000048, 2.2499999999999893, -273.7875110828899, -170.47143354434036, 419.77522038374497, 44.04859403731555, 4.267933383787366, 39.03701552777886], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-397.23771894077134, 27.896925861653724, -80.05900920999294, 0.2192543275058529, -38.999949154185614, 30.47201763260211, -568.0009185536143, -695.4772602153474, -653.0547514619285, -506.9409576073303, -435.9020116050126, -501.59429205500305, -131.58499489360958, -463.52726483429046, -576.4316428250278, -568.1291230898959, -584.2779458852161, -560.7383653601503, -535.5302312822855, -415.1266516806428, -569.006559758234, -491.20080717197146, -589.6417444061907, -584.686002864384, -490.29850684126666, -524.8131479447442, -406.57959627182146, -351.4835041236815, -584.4623066435333, -564.6369107209448, -3.0823831218518585, 6.927618443289925, -86.08603925055233, -110.1752709146967, -561.2620425890443, -365.657564682069, -489.58057426082365, -529.3760581711963, -9.03845498080543, -17.10876601497381, 28.32787056585469, -154.49090909937098, -620.1469670561398, -452.7895168328482, -594.0524081491849, -604.0268469467075, 12.627254274504079, 19.7873939741324, -405.76587715394595, -490.44199609098507, 18.681189061110167, 93.32566437924005, -278.1907804704946, -61.18140424054275, -436.9790300567721, -463.9066118199026, -571.7475964650698, -614.3517814664816, -283.5006121301396, -99.92662617473485, 80.88097126748484, 2.0000000000000013, -411.955427980231, -382.20418849223483, -528.7537073323346, -523.63321716396, -451.1050327969436, -639.8853471535848, -613.6158467170687, -442.5310256551338, -553.3169841451179, -158.1904948743385, -477.0621178973344, -519.1753511093923, -346.5025359877866, -233.34528496718738, -634.6062561004713, -685.1164735472889, -612.3886984921133, -508.6593031108889, -441.46713949797316, 130.4520445394014, -537.0867945952433, -460.39836204232444, -16.645079319103058, -55.70644147828146, 19.820000000000285, -52.80713520695755, -440.82820546471453, -136.4340210593959, -652.3207095157508, -669.3165803438134, -103.40597973677328, -126.00696018067548, -591.6903794004697, -350.0988694070733, -617.2135490350217, -593.859323891586, -706.8249166362941, -361.98143368252175, -606.2053989815477, -534.3417683873556, -283.2697411124998, -658.47701440824, -570.0750280594982, -207.57784761282218, -28.064371469609593, 47.035795915757184, -461.4410730447154, -488.22668892849, -450.36456586979097, -560.7919673231173, -685.5567883005539, -426.6683090781995, -531.8493320496555, -601.1501292032543, -604.7597211590705, -565.0343077462013, -603.1614017540593, -71.75627410057741, -594.1579620324155, -46.1670560117182, 28.374323414870428, -253.4717928353606, -128.60589780279108, -582.1921553560403, -19.054338895739836, -515.3319491950391, -370.74897731101447, 6.958193275358491, -530.0849903079516, -530.3994783483547, -424.6488977354095, -554.7666737237123, -277.614339485389, -615.1154705185311, -570.0227127348762, 104.80418591823229, -108.15466113143229, -163.26080677251952, -62.79048592367548, -50.394638472329916, -495.45550862530155, -22.722186036533497, -37.55819779152979, -265.41143519702706, -696.4153220266766, -511.77357383804446, -597.1878222848645, -538.8221648935432, 2.0000000000000013, 16.476746569308276, -503.46021330022614, -620.4809395680637, -130.15079888637538, -596.4540368308776, -592.9914804262011, -20.997752667180144, -554.5531295729772, -57.60385273048407, -90.29889085529707, -52.888849924003196, -596.4128535055053, -258.534438698599, -581.9169701170201, 61.37360197949812, -532.5188679959995, -440.4976143299421, -447.1607657995611, -596.2554679657361, 24.22699836641755, -558.633903075481, -394.7577911022328, -129.80032414184046, -47.74331710433591, -131.0633264961487, -640.5730842023751, -498.9823751371172, 11.764128541854387, -452.94984758138116, -65.98746452100661, 7.717209230701115, -499.2536570327842, -646.9151502303571, 22.976160268831563, 98.03000000000037, -459.5155556858621, -78.42797142355832, -381.5480060800557, -501.87368935990935, -414.82898689386633, -649.928046784454, -661.3766141823684, -36.50258774016792, -629.1839182875367, -460.0617899159315, -621.2294148831634, -601.1923702647185, -536.7878528086914, -494.55575308569894], "policy_predator_policy_reward": [406.5877189407711, 12.653074138346517, 125.84644168739447, 72.51746443159269, 46.739949154185304, 37.66798236739792, 280.66371900825243, 720.2526283615438, 683.0513766109757, 461.3341892846251, 300.17185232889244, 490.61793098153896, 19.95429403116063, 507.6110836779838, 19.773355771371197, 692.81304947665, 616.7807552638764, 547.9516249215313, 138.25859597235072, 476.25137970832907, 607.7656795870184, 7.087868660357492, 618.4194428234416, 666.9245897342114, 75.75964395739241, 600.8040267733885, 401.6625959776498, 320.0627372752894, 653.3708825573365, 6.345835945317784, 5.062383121851816, 112.53238155671009, 35.4755841896849, 125.45426678974786, 627.3657610682334, 4.717194143984143, 4.772180557038961, 565.9507779550413, 10.988454980805388, 19.058766014974115, 44.78212943414529, 156.15090909936947, 667.3329479745919, 66.51943704026382, 399.9895349755143, 655.6886539739012, 0.0, 29.16533088434523, 541.3148293210854, 60.148176661824806, 57.31881093888973, 14.564335620759968, 397.3597489685196, 318.15558669404965, 509.8863363430332, 141.38672730336245, 556.9661853869069, 609.8858414803288, 3.405078628572307, 371.49536781196565, 44.75902873251533, 0.0, 429.91868709796853, 336.02755976623257, 67.12917554205465, 576.9375619214785, 57.42058499202699, 669.5521687383506, 655.5300524261394, 3.952492888858959, 601.6647522488466, 28.84072595468881, 571.0293809479542, 447.65938830226645, 163.97662352789953, 245.00212603536514, 691.5802965215183, 662.8346234393995, 658.5559879209179, 196.00813381029596, 189.50970761939695, 381.8448193205956, 635.4946061937397, 50.89172942437833, 71.95007635112671, 4.211444446257756, 57.506756834362115, 49.58762134962358, 477.62283600588637, 48.988598740913865, 701.2707213285695, 484.6799160662668, 212.51198407053653, 12.26767944252118, 582.6764476545069, 510.748562554687, 610.8981416568561, 627.1113817189216, 727.7660336225844, 20.813621933045184, 637.2209455330585, 390.5893271670808, 9.426830397075664, 696.4859486675001, 572.2077007988472, 260.57995176570887, 51.80164380412419, 6.316931749728431, 531.3527871907578, 486.75845189664784, 600.0832571619403, 619.283334426596, 596.398680960776, 650.4258701735272, 567.0706522167615, 621.196601999525, 579.6614230662109, 584.692935932544, 580.7225951642231, 325.8109270410726, 584.1371836617898, 406.8693490085584, 271.3773934313943, 220.452129366319, 148.70553866341982, 582.2821553560404, 425.8322573866618, 456.5450148125495, 7.597902235412346, 443.3840971406979, 495.55560285854364, 559.1773083875266, 299.0014620807045, 594.013081346647, 3.9967947494222718, 698.9187354224149, 378.311525905823, 477.2947311662652, 184.64505019455333, 4.511214497359855, 105.70978981834092, 11.32359665250358, 502.77550862530154, 34.57218603653313, 225.36711875769427, 299.7556706436058, 713.3906635063664, 313.0908075960123, 666.8590180952833, 366.49788408163505, 0.0, 59.583253430691556, 11.012736822703172, 726.2035674271168, 361.86023533664184, 613.1659976222793, 590.0726265121496, 259.0551354561093, 513.3085828368463, 438.85819394420827, 50.46591993997665, 96.4018208393241, 617.204400715267, 457.55772141807165, 540.4534426581329, 440.5722171612445, 565.6994035596773, 453.1682363027402, 487.94484911890083, 533.6088005285309, 426.4781012868956, 540.8134086695, 362.28470176726535, 364.93030317145184, 96.85590266005394, 85.62074094042872, 459.98133645331745, 609.7949627700025, 29.72587145814579, 454.31984758138117, 70.58460102985339, 30.672318913574728, 644.1640520112926, 677.4233989636427, 5.648116179487955, 18.81572355168069, 459.87555568586214, 80.31797142355929, 73.02791936232582, 536.6062649947506, 222.71998846957686, 671.5656116644038, 630.1052353927415, 487.5491869135396, 512.5532695271005, 620.7410327136831, 636.0536183033784, 590.6361002282911, 523.6630811086889, 546.7175403134805]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5446492958959817, "mean_inference_ms": 1.5437936450248049, "mean_action_processing_ms": 0.267544665986613, "mean_env_wait_ms": 0.18559909827654264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037984848022460938, "StateBufferConnector_ms": 0.003064870834350586, "ViewRequirementAgentConnector_ms": 0.10046648979187012}, "num_episodes": 23, "episode_return_max": 460.48229168185605, "episode_return_min": -489.3824988618237, "episode_return_mean": -12.414148656040915, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.57712833693995, "num_env_steps_trained_throughput_per_sec": 353.57712833693995, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 10823.71, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10823.676, "sample_time_ms": 1322.436, "learn_time_ms": 9485.997, "learn_throughput": 421.674, "synch_weights_time_ms": 14.108}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "74486_00000", "date": "2024-08-16_15-01-55", "timestamp": 1723800715, "time_this_iter_s": 11.31894326210022, "time_total_s": 384.5765860080719, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397328280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 384.5765860080719, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 30.825, "ram_util_percent": 78.7375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0803483935260267, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.482277720315116, "policy_loss": -0.008454047601113204, "vf_loss": 8.489735137596332, "vf_explained_var": 0.140856961598472, "kl": 0.009966208197079201, "entropy": 1.303607494112045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1854415966720178, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.638691332479002, "policy_loss": -0.014938831071876896, "vf_loss": 8.651582656335579, "vf_explained_var": 0.05351684585450187, "kl": 0.020474775777156614, "entropy": 0.8712014315620301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 460.48229168185605, "episode_reward_min": -448.2336739199402, "episode_reward_mean": 49.24005462538506, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -706.8249166362941, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 130.4520445394014, "predator_policy": 727.7660336225844}, "policy_reward_mean": {"prey_policy": -347.0412527060327, "predator_policy": 371.6612800187253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-448.2336739199402, 3.8999999999999613, 74.76999999999974, -339.08409887413166, -142.40106614647698, 61.57997913298091, -294.7448672620211, 183.89000000000013, 376.1431509515317, -249.61257823027947, -19.247351064315655, -8.526791864336534, 127.64000000000078, -28.21336960826468, -408.3201870327622, -364.0176262201512, -396.66432705720416, -81.00200081592129, 22.451300243493968, -170.86907139170884, 34.692190313157596, -266.4838798717904, 260.3394319814206, -311.09882101945055, 3.8099999999999627, 74.10724297703008, -50.65079177731054, -135.6866524647281, -4.6332764043909105, 151.63576140165088, 26.936650449170145, -320.22669476318663, -112.73689466876411, -235.8339764561646, 55.134776892234996, 77.08999999999969, 68.44347711420087, 208.21005839562767, 134.59945375554958, 55.26779296337678, -5.439669906516193, 231.61584635065816, 350.68151462621427, 266.73205337722294, 20.189640860630305, 347.9909841084318, 87.19121534045411, -5.751557410236721, -86.40102803177092, -189.81427983208292, 390.3877302554436, -82.25920321203814, 3.848262074839352, 19.169999999999966, 222.15315641274367, -181.70742476234187, -102.65308500149047, 78.06000000000006, -386.7248486184698, 248.42139724166884, 235.13852887487693, 340.0097944775927, 3.6799999999999646, 219.81482992923412, 460.48229168185605, 45.851157536474844, -21.8625841178659, 432.88460524733193, 202.65688969464483, 3.6699999999999635, -69.77916011617218, 42.86000000000004, 42.98666465312115, 175.418643711793, 145.47000000000048, 2.2499999999999893, -273.7875110828899, -170.47143354434036, 419.77522038374497, 44.04859403731555, 4.267933383787366, 39.03701552777886, 305.17857729491385, 201.06106579866275, 44.29843715036027, 402.09159169166674, 33.811253961120485, 328.79082218493005, 422.50618817822595, 115.0186299714365, 413.1488025785237, 154.1203683800276, 343.84330399481985, 360.312190984186, 232.17317894882046, 157.57259596810587, 2.2299999999999938, 254.28812808877575, 26.14475652960907, -35.02988297544928], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-489.58057426082365, -529.3760581711963, -9.03845498080543, -17.10876601497381, 28.32787056585469, -154.49090909937098, -620.1469670561398, -452.7895168328482, -594.0524081491849, -604.0268469467075, 12.627254274504079, 19.7873939741324, -405.76587715394595, -490.44199609098507, 18.681189061110167, 93.32566437924005, -278.1907804704946, -61.18140424054275, -436.9790300567721, -463.9066118199026, -571.7475964650698, -614.3517814664816, -283.5006121301396, -99.92662617473485, 80.88097126748484, 2.0000000000000013, -411.955427980231, -382.20418849223483, -528.7537073323346, -523.63321716396, -451.1050327969436, -639.8853471535848, -613.6158467170687, -442.5310256551338, -553.3169841451179, -158.1904948743385, -477.0621178973344, -519.1753511093923, -346.5025359877866, -233.34528496718738, -634.6062561004713, -685.1164735472889, -612.3886984921133, -508.6593031108889, -441.46713949797316, 130.4520445394014, -537.0867945952433, -460.39836204232444, -16.645079319103058, -55.70644147828146, 19.820000000000285, -52.80713520695755, -440.82820546471453, -136.4340210593959, -652.3207095157508, -669.3165803438134, -103.40597973677328, -126.00696018067548, -591.6903794004697, -350.0988694070733, -617.2135490350217, -593.859323891586, -706.8249166362941, -361.98143368252175, -606.2053989815477, -534.3417683873556, -283.2697411124998, -658.47701440824, -570.0750280594982, -207.57784761282218, -28.064371469609593, 47.035795915757184, -461.4410730447154, -488.22668892849, -450.36456586979097, -560.7919673231173, -685.5567883005539, -426.6683090781995, -531.8493320496555, -601.1501292032543, -604.7597211590705, -565.0343077462013, -603.1614017540593, -71.75627410057741, -594.1579620324155, -46.1670560117182, 28.374323414870428, -253.4717928353606, -128.60589780279108, -582.1921553560403, -19.054338895739836, -515.3319491950391, -370.74897731101447, 6.958193275358491, -530.0849903079516, -530.3994783483547, -424.6488977354095, -554.7666737237123, -277.614339485389, -615.1154705185311, -570.0227127348762, 104.80418591823229, -108.15466113143229, -163.26080677251952, -62.79048592367548, -50.394638472329916, -495.45550862530155, -22.722186036533497, -37.55819779152979, -265.41143519702706, -696.4153220266766, -511.77357383804446, -597.1878222848645, -538.8221648935432, 2.0000000000000013, 16.476746569308276, -503.46021330022614, -620.4809395680637, -130.15079888637538, -596.4540368308776, -592.9914804262011, -20.997752667180144, -554.5531295729772, -57.60385273048407, -90.29889085529707, -52.888849924003196, -596.4128535055053, -258.534438698599, -581.9169701170201, 61.37360197949812, -532.5188679959995, -440.4976143299421, -447.1607657995611, -596.2554679657361, 24.22699836641755, -558.633903075481, -394.7577911022328, -129.80032414184046, -47.74331710433591, -131.0633264961487, -640.5730842023751, -498.9823751371172, 11.764128541854387, -452.94984758138116, -65.98746452100661, 7.717209230701115, -499.2536570327842, -646.9151502303571, 22.976160268831563, 98.03000000000037, -459.5155556858621, -78.42797142355832, -381.5480060800557, -501.87368935990935, -414.82898689386633, -649.928046784454, -661.3766141823684, -36.50258774016792, -629.1839182875367, -460.0617899159315, -621.2294148831634, -601.1923702647185, -536.7878528086914, -494.55575308569894, -215.18656985086554, -593.9371892912673, 71.02823096035459, 78.92561387370552, -421.88799263088407, -546.0695085264069, -497.70040370944804, 42.225723286782625, -700.675859522649, -572.24443492505, 30.76382175508297, -444.6578609409865, -616.251809459322, 38.68668259313041, -630.1381206504273, -343.2897152172986, 129.64509673029357, -545.2901323310209, -506.86676257571895, -330.06072140095347, -627.0176183144621, 18.027902415809265, -332.2706734713277, -29.404755928547953, -530.7867634317507, -299.22188037335223, -679.7972652296612, -450.07475796230085, -74.75838555796479, -495.9420343008566, -608.9941515449209, -5.766770210046813, -99.82940545251788, -6.1967659462537785, -416.7356940447495, -453.4464048925718], "policy_predator_policy_reward": [4.772180557038961, 565.9507779550413, 10.988454980805388, 19.058766014974115, 44.78212943414529, 156.15090909936947, 667.3329479745919, 66.51943704026382, 399.9895349755143, 655.6886539739012, 0.0, 29.16533088434523, 541.3148293210854, 60.148176661824806, 57.31881093888973, 14.564335620759968, 397.3597489685196, 318.15558669404965, 509.8863363430332, 141.38672730336245, 556.9661853869069, 609.8858414803288, 3.405078628572307, 371.49536781196565, 44.75902873251533, 0.0, 429.91868709796853, 336.02755976623257, 67.12917554205465, 576.9375619214785, 57.42058499202699, 669.5521687383506, 655.5300524261394, 3.952492888858959, 601.6647522488466, 28.84072595468881, 571.0293809479542, 447.65938830226645, 163.97662352789953, 245.00212603536514, 691.5802965215183, 662.8346234393995, 658.5559879209179, 196.00813381029596, 189.50970761939695, 381.8448193205956, 635.4946061937397, 50.89172942437833, 71.95007635112671, 4.211444446257756, 57.506756834362115, 49.58762134962358, 477.62283600588637, 48.988598740913865, 701.2707213285695, 484.6799160662668, 212.51198407053653, 12.26767944252118, 582.6764476545069, 510.748562554687, 610.8981416568561, 627.1113817189216, 727.7660336225844, 20.813621933045184, 637.2209455330585, 390.5893271670808, 9.426830397075664, 696.4859486675001, 572.2077007988472, 260.57995176570887, 51.80164380412419, 6.316931749728431, 531.3527871907578, 486.75845189664784, 600.0832571619403, 619.283334426596, 596.398680960776, 650.4258701735272, 567.0706522167615, 621.196601999525, 579.6614230662109, 584.692935932544, 580.7225951642231, 325.8109270410726, 584.1371836617898, 406.8693490085584, 271.3773934313943, 220.452129366319, 148.70553866341982, 582.2821553560404, 425.8322573866618, 456.5450148125495, 7.597902235412346, 443.3840971406979, 495.55560285854364, 559.1773083875266, 299.0014620807045, 594.013081346647, 3.9967947494222718, 698.9187354224149, 378.311525905823, 477.2947311662652, 184.64505019455333, 4.511214497359855, 105.70978981834092, 11.32359665250358, 502.77550862530154, 34.57218603653313, 225.36711875769427, 299.7556706436058, 713.3906635063664, 313.0908075960123, 666.8590180952833, 366.49788408163505, 0.0, 59.583253430691556, 11.012736822703172, 726.2035674271168, 361.86023533664184, 613.1659976222793, 590.0726265121496, 259.0551354561093, 513.3085828368463, 438.85819394420827, 50.46591993997665, 96.4018208393241, 617.204400715267, 457.55772141807165, 540.4534426581329, 440.5722171612445, 565.6994035596773, 453.1682363027402, 487.94484911890083, 533.6088005285309, 426.4781012868956, 540.8134086695, 362.28470176726535, 364.93030317145184, 96.85590266005394, 85.62074094042872, 459.98133645331745, 609.7949627700025, 29.72587145814579, 454.31984758138117, 70.58460102985339, 30.672318913574728, 644.1640520112926, 677.4233989636427, 5.648116179487955, 18.81572355168069, 459.87555568586214, 80.31797142355929, 73.02791936232582, 536.6062649947506, 222.71998846957686, 671.5656116644038, 630.1052353927415, 487.5491869135396, 512.5532695271005, 620.7410327136831, 636.0536183033784, 590.6361002282911, 523.6630811086889, 546.7175403134805, 540.9886859257551, 573.313650511291, 44.754386126294385, 6.352834838309905, 389.24019808211193, 623.0157402255388, 490.1094932051275, 367.45677890920507, 707.2277203212519, 599.5038280875681, 318.736744711968, 423.948116658866, 602.9308654565968, 397.140449587821, 642.5644585835519, 445.8820072556098, 303.7360044766467, 525.0578337026043, 527.9799892189901, 463.06786313771, 601.8985515456676, 350.93446834780576, 330.70313843806343, 391.2844819459987, 546.8728878254351, 515.3089349284877, 693.8921964828485, 593.5524226772221, 76.61838555796574, 496.31203430085634, 601.5507134369623, 267.4983364067811, 25.417664049179884, 106.7532638792012, 471.73383862701326, 363.4183773348589]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5450157961515106, "mean_inference_ms": 1.5507632915054825, "mean_action_processing_ms": 0.26664167360685725, "mean_env_wait_ms": 0.1859810558318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038584470748901367, "StateBufferConnector_ms": 0.003070235252380371, "ViewRequirementAgentConnector_ms": 0.1023712158203125}, "num_episodes": 18, "episode_return_max": 460.48229168185605, "episode_return_min": -448.2336739199402, "episode_return_mean": 49.24005462538506, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.83306252914934, "num_env_steps_trained_throughput_per_sec": 349.83306252914934, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 10846.204, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10846.17, "sample_time_ms": 1328.048, "learn_time_ms": 9502.825, "learn_throughput": 420.927, "synch_weights_time_ms": 14.267}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "74486_00000", "date": "2024-08-16_15-02-07", "timestamp": 1723800727, "time_this_iter_s": 11.440234899520874, "time_total_s": 396.0168209075928, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39736eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 396.0168209075928, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.925, "ram_util_percent": 79.18125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.812656653936578, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.685533077754672, "policy_loss": -0.010347476235107967, "vf_loss": 8.69452732605909, "vf_explained_var": 0.22020959715363841, "kl": 0.01353226361662954, "entropy": 1.2920231410435268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0741627416282733, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.187946490131358, "policy_loss": -0.004102179658397165, "vf_loss": 7.190858712524333, "vf_explained_var": 0.04833720629177396, "kl": 0.00793302516406117, "entropy": 0.8386590938404124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 650.7748610812644, "episode_reward_min": -386.7248486184698, "episode_reward_mean": 102.80665588909477, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.5073656438351, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 130.4520445394014, "predator_policy": 727.7660336225844}, "policy_reward_mean": {"prey_policy": -327.91375150817663, "predator_policy": 379.31707945272416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.451300243493968, -170.86907139170884, 34.692190313157596, -266.4838798717904, 260.3394319814206, -311.09882101945055, 3.8099999999999627, 74.10724297703008, -50.65079177731054, -135.6866524647281, -4.6332764043909105, 151.63576140165088, 26.936650449170145, -320.22669476318663, -112.73689466876411, -235.8339764561646, 55.134776892234996, 77.08999999999969, 68.44347711420087, 208.21005839562767, 134.59945375554958, 55.26779296337678, -5.439669906516193, 231.61584635065816, 350.68151462621427, 266.73205337722294, 20.189640860630305, 347.9909841084318, 87.19121534045411, -5.751557410236721, -86.40102803177092, -189.81427983208292, 390.3877302554436, -82.25920321203814, 3.848262074839352, 19.169999999999966, 222.15315641274367, -181.70742476234187, -102.65308500149047, 78.06000000000006, -386.7248486184698, 248.42139724166884, 235.13852887487693, 340.0097944775927, 3.6799999999999646, 219.81482992923412, 460.48229168185605, 45.851157536474844, -21.8625841178659, 432.88460524733193, 202.65688969464483, 3.6699999999999635, -69.77916011617218, 42.86000000000004, 42.98666465312115, 175.418643711793, 145.47000000000048, 2.2499999999999893, -273.7875110828899, -170.47143354434036, 419.77522038374497, 44.04859403731555, 4.267933383787366, 39.03701552777886, 305.17857729491385, 201.06106579866275, 44.29843715036027, 402.09159169166674, 33.811253961120485, 328.79082218493005, 422.50618817822595, 115.0186299714365, 413.1488025785237, 154.1203683800276, 343.84330399481985, 360.312190984186, 232.17317894882046, 157.57259596810587, 2.2299999999999938, 254.28812808877575, 26.14475652960907, -35.02988297544928, 132.79000000000013, 203.7356081798803, 41.359999999999985, 132.54000000000028, 194.15932416679766, 268.1599999999997, 365.5360150544415, 46.44999999999986, 386.3147058646476, 77.94279725484895, 12.252804803432488, 340.54653884565937, 650.7748610812644, 146.94539895039526, 142.44726415830797, 113.810000000001, 3.4599999999999724, 145.2900000000002], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-477.0621178973344, -519.1753511093923, -346.5025359877866, -233.34528496718738, -634.6062561004713, -685.1164735472889, -612.3886984921133, -508.6593031108889, -441.46713949797316, 130.4520445394014, -537.0867945952433, -460.39836204232444, -16.645079319103058, -55.70644147828146, 19.820000000000285, -52.80713520695755, -440.82820546471453, -136.4340210593959, -652.3207095157508, -669.3165803438134, -103.40597973677328, -126.00696018067548, -591.6903794004697, -350.0988694070733, -617.2135490350217, -593.859323891586, -706.8249166362941, -361.98143368252175, -606.2053989815477, -534.3417683873556, -283.2697411124998, -658.47701440824, -570.0750280594982, -207.57784761282218, -28.064371469609593, 47.035795915757184, -461.4410730447154, -488.22668892849, -450.36456586979097, -560.7919673231173, -685.5567883005539, -426.6683090781995, -531.8493320496555, -601.1501292032543, -604.7597211590705, -565.0343077462013, -603.1614017540593, -71.75627410057741, -594.1579620324155, -46.1670560117182, 28.374323414870428, -253.4717928353606, -128.60589780279108, -582.1921553560403, -19.054338895739836, -515.3319491950391, -370.74897731101447, 6.958193275358491, -530.0849903079516, -530.3994783483547, -424.6488977354095, -554.7666737237123, -277.614339485389, -615.1154705185311, -570.0227127348762, 104.80418591823229, -108.15466113143229, -163.26080677251952, -62.79048592367548, -50.394638472329916, -495.45550862530155, -22.722186036533497, -37.55819779152979, -265.41143519702706, -696.4153220266766, -511.77357383804446, -597.1878222848645, -538.8221648935432, 2.0000000000000013, 16.476746569308276, -503.46021330022614, -620.4809395680637, -130.15079888637538, -596.4540368308776, -592.9914804262011, -20.997752667180144, -554.5531295729772, -57.60385273048407, -90.29889085529707, -52.888849924003196, -596.4128535055053, -258.534438698599, -581.9169701170201, 61.37360197949812, -532.5188679959995, -440.4976143299421, -447.1607657995611, -596.2554679657361, 24.22699836641755, -558.633903075481, -394.7577911022328, -129.80032414184046, -47.74331710433591, -131.0633264961487, -640.5730842023751, -498.9823751371172, 11.764128541854387, -452.94984758138116, -65.98746452100661, 7.717209230701115, -499.2536570327842, -646.9151502303571, 22.976160268831563, 98.03000000000037, -459.5155556858621, -78.42797142355832, -381.5480060800557, -501.87368935990935, -414.82898689386633, -649.928046784454, -661.3766141823684, -36.50258774016792, -629.1839182875367, -460.0617899159315, -621.2294148831634, -601.1923702647185, -536.7878528086914, -494.55575308569894, -215.18656985086554, -593.9371892912673, 71.02823096035459, 78.92561387370552, -421.88799263088407, -546.0695085264069, -497.70040370944804, 42.225723286782625, -700.675859522649, -572.24443492505, 30.76382175508297, -444.6578609409865, -616.251809459322, 38.68668259313041, -630.1381206504273, -343.2897152172986, 129.64509673029357, -545.2901323310209, -506.86676257571895, -330.06072140095347, -627.0176183144621, 18.027902415809265, -332.2706734713277, -29.404755928547953, -530.7867634317507, -299.22188037335223, -679.7972652296612, -450.07475796230085, -74.75838555796479, -495.9420343008566, -608.9941515449209, -5.766770210046813, -99.82940545251788, -6.1967659462537785, -416.7356940447495, -453.4464048925718, -183.97047201895603, 73.01835136566444, -583.2462094865407, -322.88424057235807, -609.66898390558, -10.247215845952313, 100.93752515438817, -5.808156089745554, -583.8686067907566, -358.8128837789346, 123.36115438986123, 99.9232629352481, -548.7316108941492, -29.04922849112585, -5.133787492650686, -292.1379420001663, -370.70907769403664, -67.14869523592459, -491.4750185746416, -454.85154362181373, -600.6074035330066, -621.1992154799738, -704.0308627604734, -333.2505747613405, -714.5073656438351, 130.20882135277958, -65.60195198574417, -20.50012916617449, -69.81670471481584, -5.726159274103296, 12.625902711737943, 78.64698632118427, -45.66419111447731, -93.4687053049464, 54.577277007605495, -281.8458518047843], "policy_predator_policy_reward": [571.0293809479542, 447.65938830226645, 163.97662352789953, 245.00212603536514, 691.5802965215183, 662.8346234393995, 658.5559879209179, 196.00813381029596, 189.50970761939695, 381.8448193205956, 635.4946061937397, 50.89172942437833, 71.95007635112671, 4.211444446257756, 57.506756834362115, 49.58762134962358, 477.62283600588637, 48.988598740913865, 701.2707213285695, 484.6799160662668, 212.51198407053653, 12.26767944252118, 582.6764476545069, 510.748562554687, 610.8981416568561, 627.1113817189216, 727.7660336225844, 20.813621933045184, 637.2209455330585, 390.5893271670808, 9.426830397075664, 696.4859486675001, 572.2077007988472, 260.57995176570887, 51.80164380412419, 6.316931749728431, 531.3527871907578, 486.75845189664784, 600.0832571619403, 619.283334426596, 596.398680960776, 650.4258701735272, 567.0706522167615, 621.196601999525, 579.6614230662109, 584.692935932544, 580.7225951642231, 325.8109270410726, 584.1371836617898, 406.8693490085584, 271.3773934313943, 220.452129366319, 148.70553866341982, 582.2821553560404, 425.8322573866618, 456.5450148125495, 7.597902235412346, 443.3840971406979, 495.55560285854364, 559.1773083875266, 299.0014620807045, 594.013081346647, 3.9967947494222718, 698.9187354224149, 378.311525905823, 477.2947311662652, 184.64505019455333, 4.511214497359855, 105.70978981834092, 11.32359665250358, 502.77550862530154, 34.57218603653313, 225.36711875769427, 299.7556706436058, 713.3906635063664, 313.0908075960123, 666.8590180952833, 366.49788408163505, 0.0, 59.583253430691556, 11.012736822703172, 726.2035674271168, 361.86023533664184, 613.1659976222793, 590.0726265121496, 259.0551354561093, 513.3085828368463, 438.85819394420827, 50.46591993997665, 96.4018208393241, 617.204400715267, 457.55772141807165, 540.4534426581329, 440.5722171612445, 565.6994035596773, 453.1682363027402, 487.94484911890083, 533.6088005285309, 426.4781012868956, 540.8134086695, 362.28470176726535, 364.93030317145184, 96.85590266005394, 85.62074094042872, 459.98133645331745, 609.7949627700025, 29.72587145814579, 454.31984758138117, 70.58460102985339, 30.672318913574728, 644.1640520112926, 677.4233989636427, 5.648116179487955, 18.81572355168069, 459.87555568586214, 80.31797142355929, 73.02791936232582, 536.6062649947506, 222.71998846957686, 671.5656116644038, 630.1052353927415, 487.5491869135396, 512.5532695271005, 620.7410327136831, 636.0536183033784, 590.6361002282911, 523.6630811086889, 546.7175403134805, 540.9886859257551, 573.313650511291, 44.754386126294385, 6.352834838309905, 389.24019808211193, 623.0157402255388, 490.1094932051275, 367.45677890920507, 707.2277203212519, 599.5038280875681, 318.736744711968, 423.948116658866, 602.9308654565968, 397.140449587821, 642.5644585835519, 445.8820072556098, 303.7360044766467, 525.0578337026043, 527.9799892189901, 463.06786313771, 601.8985515456676, 350.93446834780576, 330.70313843806343, 391.2844819459987, 546.8728878254351, 515.3089349284877, 693.8921964828485, 593.5524226772221, 76.61838555796574, 496.31203430085634, 601.5507134369623, 267.4983364067811, 25.417664049179884, 106.7532638792012, 471.73383862701326, 363.4183773348589, 36.039617219528296, 207.70250343376307, 578.081044709728, 531.7850135290504, 609.67898390558, 51.597215845952086, 29.642474845611876, 7.768156089745513, 548.915699785992, 587.9251149504964, 24.0588456101389, 20.81673706475199, 545.5984683025963, 397.71838613712, 50.4937874926505, 293.22794200016625, 388.3624710614264, 435.8100077331823, 520.5761415897643, 503.6932178615389, 596.7453482064665, 637.3140756099476, 675.3895088180716, 702.4384675494024, 645.7484269261798, 589.3249784461411, 122.56015806917091, 110.48732203314285, 55.545667755610566, 162.44446039161718, 8.154097288262019, 14.383013678816226, 32.698632663868445, 109.89426375555523, 49.22272299239447, 323.33585180478417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5455384056311348, "mean_inference_ms": 1.558196345286438, "mean_action_processing_ms": 0.2658755676283519, "mean_env_wait_ms": 0.18642311847343718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040531158447265625, "StateBufferConnector_ms": 0.003100275993347168, "ViewRequirementAgentConnector_ms": 0.10430145263671875}, "num_episodes": 18, "episode_return_max": 650.7748610812644, "episode_return_min": -386.7248486184698, "episode_return_mean": 102.80665588909477, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.7966936337064, "num_env_steps_trained_throughput_per_sec": 350.7966936337064, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 10858.752, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10858.719, "sample_time_ms": 1331.598, "learn_time_ms": 9511.646, "learn_throughput": 420.537, "synch_weights_time_ms": 14.441}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "74486_00000", "date": "2024-08-16_15-02-18", "timestamp": 1723800738, "time_this_iter_s": 11.408014059066772, "time_total_s": 407.42483496665955, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39736edc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 407.42483496665955, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 30.8875, "ram_util_percent": 79.09375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4141700748413326, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.070985488538389, "policy_loss": -0.008698406956582356, "vf_loss": 7.078120967572328, "vf_explained_var": 0.26795659724366727, "kl": 0.015629298446960694, "entropy": 1.274539923604834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.605938508239373, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.939698609094771, "policy_loss": -0.0015430513845766506, "vf_loss": 4.939989421733473, "vf_explained_var": 0.018307202612912212, "kl": 0.008348275142123258, "entropy": 0.8978892690290219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 650.7748610812644, "episode_reward_min": -386.7248486184698, "episode_reward_mean": 148.64829455076168, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.5073656438351, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 142.83370705615187, "predator_policy": 726.2035674271168}, "policy_reward_mean": {"prey_policy": -250.57360471102047, "predator_policy": 324.89775198640143}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.439669906516193, 231.61584635065816, 350.68151462621427, 266.73205337722294, 20.189640860630305, 347.9909841084318, 87.19121534045411, -5.751557410236721, -86.40102803177092, -189.81427983208292, 390.3877302554436, -82.25920321203814, 3.848262074839352, 19.169999999999966, 222.15315641274367, -181.70742476234187, -102.65308500149047, 78.06000000000006, -386.7248486184698, 248.42139724166884, 235.13852887487693, 340.0097944775927, 3.6799999999999646, 219.81482992923412, 460.48229168185605, 45.851157536474844, -21.8625841178659, 432.88460524733193, 202.65688969464483, 3.6699999999999635, -69.77916011617218, 42.86000000000004, 42.98666465312115, 175.418643711793, 145.47000000000048, 2.2499999999999893, -273.7875110828899, -170.47143354434036, 419.77522038374497, 44.04859403731555, 4.267933383787366, 39.03701552777886, 305.17857729491385, 201.06106579866275, 44.29843715036027, 402.09159169166674, 33.811253961120485, 328.79082218493005, 422.50618817822595, 115.0186299714365, 413.1488025785237, 154.1203683800276, 343.84330399481985, 360.312190984186, 232.17317894882046, 157.57259596810587, 2.2299999999999938, 254.28812808877575, 26.14475652960907, -35.02988297544928, 132.79000000000013, 203.7356081798803, 41.359999999999985, 132.54000000000028, 194.15932416679766, 268.1599999999997, 365.5360150544415, 46.44999999999986, 386.3147058646476, 77.94279725484895, 12.252804803432488, 340.54653884565937, 650.7748610812644, 146.94539895039526, 142.44726415830797, 113.810000000001, 3.4599999999999724, 145.2900000000002, 197.4599999999993, 305.5199999999997, 6.659999999999923, 163.95762274857864, 292.7699999999996, 15.519999999999968, 63.40999999999961, 134.46000000000038, 155.39999999999998, 56.09446652304201, 1.2258198977898354, 233.55999999999906, 452.70663975272356, 271.247272856387, 365.9207830416658, 91.98000000000025, 131.61999999999998, 202.45110417668494, 99.68999999999994, 290.8899999999997, 389.50823483924313, 226.60999999999916], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-604.7597211590705, -565.0343077462013, -603.1614017540593, -71.75627410057741, -594.1579620324155, -46.1670560117182, 28.374323414870428, -253.4717928353606, -128.60589780279108, -582.1921553560403, -19.054338895739836, -515.3319491950391, -370.74897731101447, 6.958193275358491, -530.0849903079516, -530.3994783483547, -424.6488977354095, -554.7666737237123, -277.614339485389, -615.1154705185311, -570.0227127348762, 104.80418591823229, -108.15466113143229, -163.26080677251952, -62.79048592367548, -50.394638472329916, -495.45550862530155, -22.722186036533497, -37.55819779152979, -265.41143519702706, -696.4153220266766, -511.77357383804446, -597.1878222848645, -538.8221648935432, 2.0000000000000013, 16.476746569308276, -503.46021330022614, -620.4809395680637, -130.15079888637538, -596.4540368308776, -592.9914804262011, -20.997752667180144, -554.5531295729772, -57.60385273048407, -90.29889085529707, -52.888849924003196, -596.4128535055053, -258.534438698599, -581.9169701170201, 61.37360197949812, -532.5188679959995, -440.4976143299421, -447.1607657995611, -596.2554679657361, 24.22699836641755, -558.633903075481, -394.7577911022328, -129.80032414184046, -47.74331710433591, -131.0633264961487, -640.5730842023751, -498.9823751371172, 11.764128541854387, -452.94984758138116, -65.98746452100661, 7.717209230701115, -499.2536570327842, -646.9151502303571, 22.976160268831563, 98.03000000000037, -459.5155556858621, -78.42797142355832, -381.5480060800557, -501.87368935990935, -414.82898689386633, -649.928046784454, -661.3766141823684, -36.50258774016792, -629.1839182875367, -460.0617899159315, -621.2294148831634, -601.1923702647185, -536.7878528086914, -494.55575308569894, -215.18656985086554, -593.9371892912673, 71.02823096035459, 78.92561387370552, -421.88799263088407, -546.0695085264069, -497.70040370944804, 42.225723286782625, -700.675859522649, -572.24443492505, 30.76382175508297, -444.6578609409865, -616.251809459322, 38.68668259313041, -630.1381206504273, -343.2897152172986, 129.64509673029357, -545.2901323310209, -506.86676257571895, -330.06072140095347, -627.0176183144621, 18.027902415809265, -332.2706734713277, -29.404755928547953, -530.7867634317507, -299.22188037335223, -679.7972652296612, -450.07475796230085, -74.75838555796479, -495.9420343008566, -608.9941515449209, -5.766770210046813, -99.82940545251788, -6.1967659462537785, -416.7356940447495, -453.4464048925718, -183.97047201895603, 73.01835136566444, -583.2462094865407, -322.88424057235807, -609.66898390558, -10.247215845952313, 100.93752515438817, -5.808156089745554, -583.8686067907566, -358.8128837789346, 123.36115438986123, 99.9232629352481, -548.7316108941492, -29.04922849112585, -5.133787492650686, -292.1379420001663, -370.70907769403664, -67.14869523592459, -491.4750185746416, -454.85154362181373, -600.6074035330066, -621.1992154799738, -704.0308627604734, -333.2505747613405, -714.5073656438351, 130.20882135277958, -65.60195198574417, -20.50012916617449, -69.81670471481584, -5.726159274103296, 12.625902711737943, 78.64698632118427, -45.66419111447731, -93.4687053049464, 54.577277007605495, -281.8458518047843, 113.11156350780371, -133.65078884725966, 120.37453785044215, 69.42240943070476, -46.98394346539802, -31.37779684348298, 118.25919618764121, -31.10516672911171, 139.67032223865485, 69.52693691548286, -37.31817510244953, -54.15224668706167, 14.936615264593948, -280.9279588222411, -10.266477791660193, 92.0962580798402, -3.6515317027746033, 142.83370705615187, -641.3391530612445, -582.2109739065338, -42.33552053789553, -65.72422123307511, 134.93288986112958, 66.35720469813896, 127.67459506240773, -578.3464003660631, 73.74462055222455, 95.51243706576528, -595.3408136935907, 21.06537753309435, 2.0000000000000013, 62.267565376338716, 120.06054694714335, -6.74856093767859, -420.43076238078936, 32.46465212790256, 58.719371541680296, -78.01925617829458, 110.68476986078015, 137.48032893118267, -172.91327301855586, -660.8247286595954, 106.3790238119485, 84.4220944143184], "policy_predator_policy_reward": [579.6614230662109, 584.692935932544, 580.7225951642231, 325.8109270410726, 584.1371836617898, 406.8693490085584, 271.3773934313943, 220.452129366319, 148.70553866341982, 582.2821553560404, 425.8322573866618, 456.5450148125495, 7.597902235412346, 443.3840971406979, 495.55560285854364, 559.1773083875266, 299.0014620807045, 594.013081346647, 3.9967947494222718, 698.9187354224149, 378.311525905823, 477.2947311662652, 184.64505019455333, 4.511214497359855, 105.70978981834092, 11.32359665250358, 502.77550862530154, 34.57218603653313, 225.36711875769427, 299.7556706436058, 713.3906635063664, 313.0908075960123, 666.8590180952833, 366.49788408163505, 0.0, 59.583253430691556, 11.012736822703172, 726.2035674271168, 361.86023533664184, 613.1659976222793, 590.0726265121496, 259.0551354561093, 513.3085828368463, 438.85819394420827, 50.46591993997665, 96.4018208393241, 617.204400715267, 457.55772141807165, 540.4534426581329, 440.5722171612445, 565.6994035596773, 453.1682363027402, 487.94484911890083, 533.6088005285309, 426.4781012868956, 540.8134086695, 362.28470176726535, 364.93030317145184, 96.85590266005394, 85.62074094042872, 459.98133645331745, 609.7949627700025, 29.72587145814579, 454.31984758138117, 70.58460102985339, 30.672318913574728, 644.1640520112926, 677.4233989636427, 5.648116179487955, 18.81572355168069, 459.87555568586214, 80.31797142355929, 73.02791936232582, 536.6062649947506, 222.71998846957686, 671.5656116644038, 630.1052353927415, 487.5491869135396, 512.5532695271005, 620.7410327136831, 636.0536183033784, 590.6361002282911, 523.6630811086889, 546.7175403134805, 540.9886859257551, 573.313650511291, 44.754386126294385, 6.352834838309905, 389.24019808211193, 623.0157402255388, 490.1094932051275, 367.45677890920507, 707.2277203212519, 599.5038280875681, 318.736744711968, 423.948116658866, 602.9308654565968, 397.140449587821, 642.5644585835519, 445.8820072556098, 303.7360044766467, 525.0578337026043, 527.9799892189901, 463.06786313771, 601.8985515456676, 350.93446834780576, 330.70313843806343, 391.2844819459987, 546.8728878254351, 515.3089349284877, 693.8921964828485, 593.5524226772221, 76.61838555796574, 496.31203430085634, 601.5507134369623, 267.4983364067811, 25.417664049179884, 106.7532638792012, 471.73383862701326, 363.4183773348589, 36.039617219528296, 207.70250343376307, 578.081044709728, 531.7850135290504, 609.67898390558, 51.597215845952086, 29.642474845611876, 7.768156089745513, 548.915699785992, 587.9251149504964, 24.0588456101389, 20.81673706475199, 545.5984683025963, 397.71838613712, 50.4937874926505, 293.22794200016625, 388.3624710614264, 435.8100077331823, 520.5761415897643, 503.6932178615389, 596.7453482064665, 637.3140756099476, 675.3895088180716, 702.4384675494024, 645.7484269261798, 589.3249784461411, 122.56015806917091, 110.48732203314285, 55.545667755610566, 162.44446039161718, 8.154097288262019, 14.383013678816226, 32.698632663868445, 109.89426375555523, 49.22272299239447, 323.33585180478417, 28.368436492196427, 189.63078884725888, 45.85546214955788, 69.8675905692953, 11.235809021055266, 73.7859312878252, 43.8084265609373, 32.995166729111915, 10.779677761345203, 72.79306308451712, 39.20817510244921, 67.7822466870625, 12.753384735406016, 316.6479588222409, 12.206477791660152, 40.42374192015982, 5.621531702774561, 10.596292943848102, 611.0815099497872, 668.563083541033, 52.92973890789868, 56.35582276086218, 15.53711013887041, 16.73279530186158, 352.5017467071642, 550.876698349215, 75.87041178741305, 26.119803450984453, 590.4116346403737, 349.78458456178873, 0.0, 27.712434623661302, 15.085500474639675, 3.2225135158957237, 408.6403908362621, 181.77682359330998, 2.439730291013153, 116.55015434560183, 10.107960925306907, 32.61694028273028, 535.3066534376007, 687.9395830797939, 11.703931722272726, 24.104950051460847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5459119263179387, "mean_inference_ms": 1.5660323886419518, "mean_action_processing_ms": 0.26461346373983213, "mean_env_wait_ms": 0.18664542248182514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040624141693115234, "StateBufferConnector_ms": 0.0030862092971801758, "ViewRequirementAgentConnector_ms": 0.10343241691589355}, "num_episodes": 22, "episode_return_max": 650.7748610812644, "episode_return_min": -386.7248486184698, "episode_return_mean": 148.64829455076168, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.391116915952, "num_env_steps_trained_throughput_per_sec": 382.391116915952, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 10856.605, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10856.572, "sample_time_ms": 1339.176, "learn_time_ms": 9502.251, "learn_throughput": 420.953, "synch_weights_time_ms": 14.22}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "74486_00000", "date": "2024-08-16_15-02-29", "timestamp": 1723800749, "time_this_iter_s": 10.465272188186646, "time_total_s": 417.8901071548462, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39734faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 417.8901071548462, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 28.606666666666666, "ram_util_percent": 78.98666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8260098902006, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.32319146110898, "policy_loss": -0.010356483222958608, "vf_loss": 6.331699873404528, "vf_explained_var": 0.3773719539087285, "kl": 0.018480723944630413, "entropy": 1.2770977857882384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2994288728350685, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6015617769231243, "policy_loss": -0.0030450061126242552, "vf_loss": 2.603551692369754, "vf_explained_var": 0.006863837740408681, "kl": 0.007033916407765771, "entropy": 0.9089545223132643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 650.7748610812644, "episode_reward_min": -273.7875110828899, "episode_reward_mean": 170.79643135434833, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.5073656438351, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.42142226086375, "predator_policy": 707.2277203212519}, "policy_reward_mean": {"prey_policy": -181.5674728539402, "predator_policy": 266.96568853111455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.81482992923412, 460.48229168185605, 45.851157536474844, -21.8625841178659, 432.88460524733193, 202.65688969464483, 3.6699999999999635, -69.77916011617218, 42.86000000000004, 42.98666465312115, 175.418643711793, 145.47000000000048, 2.2499999999999893, -273.7875110828899, -170.47143354434036, 419.77522038374497, 44.04859403731555, 4.267933383787366, 39.03701552777886, 305.17857729491385, 201.06106579866275, 44.29843715036027, 402.09159169166674, 33.811253961120485, 328.79082218493005, 422.50618817822595, 115.0186299714365, 413.1488025785237, 154.1203683800276, 343.84330399481985, 360.312190984186, 232.17317894882046, 157.57259596810587, 2.2299999999999938, 254.28812808877575, 26.14475652960907, -35.02988297544928, 132.79000000000013, 203.7356081798803, 41.359999999999985, 132.54000000000028, 194.15932416679766, 268.1599999999997, 365.5360150544415, 46.44999999999986, 386.3147058646476, 77.94279725484895, 12.252804803432488, 340.54653884565937, 650.7748610812644, 146.94539895039526, 142.44726415830797, 113.810000000001, 3.4599999999999724, 145.2900000000002, 197.4599999999993, 305.5199999999997, 6.659999999999923, 163.95762274857864, 292.7699999999996, 15.519999999999968, 63.40999999999961, 134.46000000000038, 155.39999999999998, 56.09446652304201, 1.2258198977898354, 233.55999999999906, 452.70663975272356, 271.247272856387, 365.9207830416658, 91.98000000000025, 131.61999999999998, 202.45110417668494, 99.68999999999994, 290.8899999999997, 389.50823483924313, 226.60999999999916, 143.34000000000017, 200.2314582964157, 262.2299999999996, 308.8499999999998, 160.94, 156.2899999999998, 168.38364639524121, 136.4300000000003, 40.95999999999985, 21.233837688274427, 3.899999999999961, 212.5825004373993, 200.7799999999992, 177.0099999999996, 30.23351620279076, 163.71951416097997, 90.98000000000017, 274.9199999999993, 586.2560154315262, 3.5499999999999616, 395.60221897187324, 110.74000000000021, 170.1699999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-596.4128535055053, -258.534438698599, -581.9169701170201, 61.37360197949812, -532.5188679959995, -440.4976143299421, -447.1607657995611, -596.2554679657361, 24.22699836641755, -558.633903075481, -394.7577911022328, -129.80032414184046, -47.74331710433591, -131.0633264961487, -640.5730842023751, -498.9823751371172, 11.764128541854387, -452.94984758138116, -65.98746452100661, 7.717209230701115, -499.2536570327842, -646.9151502303571, 22.976160268831563, 98.03000000000037, -459.5155556858621, -78.42797142355832, -381.5480060800557, -501.87368935990935, -414.82898689386633, -649.928046784454, -661.3766141823684, -36.50258774016792, -629.1839182875367, -460.0617899159315, -621.2294148831634, -601.1923702647185, -536.7878528086914, -494.55575308569894, -215.18656985086554, -593.9371892912673, 71.02823096035459, 78.92561387370552, -421.88799263088407, -546.0695085264069, -497.70040370944804, 42.225723286782625, -700.675859522649, -572.24443492505, 30.76382175508297, -444.6578609409865, -616.251809459322, 38.68668259313041, -630.1381206504273, -343.2897152172986, 129.64509673029357, -545.2901323310209, -506.86676257571895, -330.06072140095347, -627.0176183144621, 18.027902415809265, -332.2706734713277, -29.404755928547953, -530.7867634317507, -299.22188037335223, -679.7972652296612, -450.07475796230085, -74.75838555796479, -495.9420343008566, -608.9941515449209, -5.766770210046813, -99.82940545251788, -6.1967659462537785, -416.7356940447495, -453.4464048925718, -183.97047201895603, 73.01835136566444, -583.2462094865407, -322.88424057235807, -609.66898390558, -10.247215845952313, 100.93752515438817, -5.808156089745554, -583.8686067907566, -358.8128837789346, 123.36115438986123, 99.9232629352481, -548.7316108941492, -29.04922849112585, -5.133787492650686, -292.1379420001663, -370.70907769403664, -67.14869523592459, -491.4750185746416, -454.85154362181373, -600.6074035330066, -621.1992154799738, -704.0308627604734, -333.2505747613405, -714.5073656438351, 130.20882135277958, -65.60195198574417, -20.50012916617449, -69.81670471481584, -5.726159274103296, 12.625902711737943, 78.64698632118427, -45.66419111447731, -93.4687053049464, 54.577277007605495, -281.8458518047843, 113.11156350780371, -133.65078884725966, 120.37453785044215, 69.42240943070476, -46.98394346539802, -31.37779684348298, 118.25919618764121, -31.10516672911171, 139.67032223865485, 69.52693691548286, -37.31817510244953, -54.15224668706167, 14.936615264593948, -280.9279588222411, -10.266477791660193, 92.0962580798402, -3.6515317027746033, 142.83370705615187, -641.3391530612445, -582.2109739065338, -42.33552053789553, -65.72422123307511, 134.93288986112958, 66.35720469813896, 127.67459506240773, -578.3464003660631, 73.74462055222455, 95.51243706576528, -595.3408136935907, 21.06537753309435, 2.0000000000000013, 62.267565376338716, 120.06054694714335, -6.74856093767859, -420.43076238078936, 32.46465212790256, 58.719371541680296, -78.01925617829458, 110.68476986078015, 137.48032893118267, -172.91327301855586, -660.8247286595954, 106.3790238119485, 84.4220944143184, 90.30934037970829, -13.883818353133648, -18.65296099966497, 25.594779385316443, 147.50812968048112, 48.41971603982398, 136.66404361686915, 156.43999999999988, -81.71843355806946, 100.0503881421508, -1.42406525594595, 123.5653518306048, -89.04169344778703, 111.07028922407002, 11.230636475318402, 0.4418003939225101, 16.530404049786554, -455.2546654880343, -39.5994472305045, -123.56587019781232, -8.19417101788913, -28.764107309810715, 28.20108341933479, -98.87091582010007, 77.68064990820972, 68.39635098042672, 158.91280277471435, -28.70638105665191, -124.84440249313704, -30.21153691586048, -86.7319585152212, 17.510535673308183, 46.561904596438424, -2.0575172704116214, 120.98642811960123, 54.37712194266115, 191.42142226086375, -583.7168661440963, -146.39841010937286, -24.13176362270842, -2.519524601985255, -611.4818856999132, 68.09485970216033, 2.0000000000000013, -23.402714172033793, 154.12374646877925], "policy_predator_policy_reward": [617.204400715267, 457.55772141807165, 540.4534426581329, 440.5722171612445, 565.6994035596773, 453.1682363027402, 487.94484911890083, 533.6088005285309, 426.4781012868956, 540.8134086695, 362.28470176726535, 364.93030317145184, 96.85590266005394, 85.62074094042872, 459.98133645331745, 609.7949627700025, 29.72587145814579, 454.31984758138117, 70.58460102985339, 30.672318913574728, 644.1640520112926, 677.4233989636427, 5.648116179487955, 18.81572355168069, 459.87555568586214, 80.31797142355929, 73.02791936232582, 536.6062649947506, 222.71998846957686, 671.5656116644038, 630.1052353927415, 487.5491869135396, 512.5532695271005, 620.7410327136831, 636.0536183033784, 590.6361002282911, 523.6630811086889, 546.7175403134805, 540.9886859257551, 573.313650511291, 44.754386126294385, 6.352834838309905, 389.24019808211193, 623.0157402255388, 490.1094932051275, 367.45677890920507, 707.2277203212519, 599.5038280875681, 318.736744711968, 423.948116658866, 602.9308654565968, 397.140449587821, 642.5644585835519, 445.8820072556098, 303.7360044766467, 525.0578337026043, 527.9799892189901, 463.06786313771, 601.8985515456676, 350.93446834780576, 330.70313843806343, 391.2844819459987, 546.8728878254351, 515.3089349284877, 693.8921964828485, 593.5524226772221, 76.61838555796574, 496.31203430085634, 601.5507134369623, 267.4983364067811, 25.417664049179884, 106.7532638792012, 471.73383862701326, 363.4183773348589, 36.039617219528296, 207.70250343376307, 578.081044709728, 531.7850135290504, 609.67898390558, 51.597215845952086, 29.642474845611876, 7.768156089745513, 548.915699785992, 587.9251149504964, 24.0588456101389, 20.81673706475199, 545.5984683025963, 397.71838613712, 50.4937874926505, 293.22794200016625, 388.3624710614264, 435.8100077331823, 520.5761415897643, 503.6932178615389, 596.7453482064665, 637.3140756099476, 675.3895088180716, 702.4384675494024, 645.7484269261798, 589.3249784461411, 122.56015806917091, 110.48732203314285, 55.545667755610566, 162.44446039161718, 8.154097288262019, 14.383013678816226, 32.698632663868445, 109.89426375555523, 49.22272299239447, 323.33585180478417, 28.368436492196427, 189.63078884725888, 45.85546214955788, 69.8675905692953, 11.235809021055266, 73.7859312878252, 43.8084265609373, 32.995166729111915, 10.779677761345203, 72.79306308451712, 39.20817510244921, 67.7822466870625, 12.753384735406016, 316.6479588222409, 12.206477791660152, 40.42374192015982, 5.621531702774561, 10.596292943848102, 611.0815099497872, 668.563083541033, 52.92973890789868, 56.35582276086218, 15.53711013887041, 16.73279530186158, 352.5017467071642, 550.876698349215, 75.87041178741305, 26.119803450984453, 590.4116346403737, 349.78458456178873, 0.0, 27.712434623661302, 15.085500474639675, 3.2225135158957237, 408.6403908362621, 181.77682359330998, 2.439730291013153, 116.55015434560183, 10.107960925306907, 32.61694028273028, 535.3066534376007, 687.9395830797939, 11.703931722272726, 24.104950051460847, 51.1006596202917, 15.813818353133607, 186.51221192566368, 6.777427985100604, 5.93187031951879, 60.37028396017589, 15.745956383130938, 0.0, 83.48843355807037, 59.11961185784918, 3.4040652559459215, 30.744648169395262, 94.79169344778789, 51.56335717117112, 123.20936352468173, 1.5481996060774914, 23.98959595021364, 455.6946654880342, 50.05859531019483, 134.34055980639636, 10.154171017889087, 30.704107309811018, 251.63587472473395, 31.616458113430582, 7.439350091790851, 47.26364901957327, 16.247197225285635, 30.5563810566522, 155.7471892936729, 29.542266318116265, 121.58701688911941, 111.35392011377506, 42.4380954035614, 4.037517270411579, 29.373571880398902, 70.1828780573389, 419.84320907314196, 558.7082502416168, 148.04841010937136, 26.031763622708716, 420.32428939423164, 589.2793398795412, 40.645140297839646, 0.0, 25.30271417203409, 14.146253531220708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5440000951637687, "mean_inference_ms": 1.567259877646884, "mean_action_processing_ms": 0.262685527046567, "mean_env_wait_ms": 0.18640333454302221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003960847854614258, "StateBufferConnector_ms": 0.0030164718627929688, "ViewRequirementAgentConnector_ms": 0.09412992000579834}, "num_episodes": 23, "episode_return_max": 650.7748610812644, "episode_return_min": -273.7875110828899, "episode_return_mean": 170.79643135434833, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.26376831459106, "num_env_steps_trained_throughput_per_sec": 375.26376831459106, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 10875.501, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10875.468, "sample_time_ms": 1326.593, "learn_time_ms": 9533.56, "learn_throughput": 419.57, "synch_weights_time_ms": 14.342}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "74486_00000", "date": "2024-08-16_15-02-39", "timestamp": 1723800759, "time_this_iter_s": 10.665115118026733, "time_total_s": 428.5552222728729, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397746790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 428.5552222728729, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 29.833333333333332, "ram_util_percent": 79.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9144319972979327, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.777307205982309, "policy_loss": -0.005342162346033744, "vf_loss": 4.781511338173397, "vf_explained_var": 0.3315229755230051, "kl": 0.011380257524506566, "entropy": 1.2840106345358349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.467606363504652, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.088007940943279, "policy_loss": -0.0036837060337087937, "vf_loss": 2.0907725285600733, "vf_explained_var": 0.0033565413699578987, "kl": 0.006127455956714942, "entropy": 0.9668385546043436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 650.7748610812644, "episode_reward_min": -35.02988297544928, "episode_reward_mean": 184.92360854156868, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.5073656438351, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 707.2277203212519}, "policy_reward_mean": {"prey_policy": -122.37506077324907, "predator_policy": 214.83686504403352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.03701552777886, 305.17857729491385, 201.06106579866275, 44.29843715036027, 402.09159169166674, 33.811253961120485, 328.79082218493005, 422.50618817822595, 115.0186299714365, 413.1488025785237, 154.1203683800276, 343.84330399481985, 360.312190984186, 232.17317894882046, 157.57259596810587, 2.2299999999999938, 254.28812808877575, 26.14475652960907, -35.02988297544928, 132.79000000000013, 203.7356081798803, 41.359999999999985, 132.54000000000028, 194.15932416679766, 268.1599999999997, 365.5360150544415, 46.44999999999986, 386.3147058646476, 77.94279725484895, 12.252804803432488, 340.54653884565937, 650.7748610812644, 146.94539895039526, 142.44726415830797, 113.810000000001, 3.4599999999999724, 145.2900000000002, 197.4599999999993, 305.5199999999997, 6.659999999999923, 163.95762274857864, 292.7699999999996, 15.519999999999968, 63.40999999999961, 134.46000000000038, 155.39999999999998, 56.09446652304201, 1.2258198977898354, 233.55999999999906, 452.70663975272356, 271.247272856387, 365.9207830416658, 91.98000000000025, 131.61999999999998, 202.45110417668494, 99.68999999999994, 290.8899999999997, 389.50823483924313, 226.60999999999916, 143.34000000000017, 200.2314582964157, 262.2299999999996, 308.8499999999998, 160.94, 156.2899999999998, 168.38364639524121, 136.4300000000003, 40.95999999999985, 21.233837688274427, 3.899999999999961, 212.5825004373993, 200.7799999999992, 177.0099999999996, 30.23351620279076, 163.71951416097997, 90.98000000000017, 274.9199999999993, 586.2560154315262, 3.5499999999999616, 395.60221897187324, 110.74000000000021, 170.1699999999998, 199.9999999999996, 3.6699999999999617, 308.0964524288636, 150.13000000000017, 182.1599999999998, 184.13999999999953, 303.46, 403.5662609796483, 19.59139218262589, 169.01999999999992, 95.35000000000043, 193.54999999999967, 217.5699999999991, 115.5900000000002, 34.26999999999966, 139.57, 354.98975452893006, 44.52999999999939], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-536.7878528086914, -494.55575308569894, -215.18656985086554, -593.9371892912673, 71.02823096035459, 78.92561387370552, -421.88799263088407, -546.0695085264069, -497.70040370944804, 42.225723286782625, -700.675859522649, -572.24443492505, 30.76382175508297, -444.6578609409865, -616.251809459322, 38.68668259313041, -630.1381206504273, -343.2897152172986, 129.64509673029357, -545.2901323310209, -506.86676257571895, -330.06072140095347, -627.0176183144621, 18.027902415809265, -332.2706734713277, -29.404755928547953, -530.7867634317507, -299.22188037335223, -679.7972652296612, -450.07475796230085, -74.75838555796479, -495.9420343008566, -608.9941515449209, -5.766770210046813, -99.82940545251788, -6.1967659462537785, -416.7356940447495, -453.4464048925718, -183.97047201895603, 73.01835136566444, -583.2462094865407, -322.88424057235807, -609.66898390558, -10.247215845952313, 100.93752515438817, -5.808156089745554, -583.8686067907566, -358.8128837789346, 123.36115438986123, 99.9232629352481, -548.7316108941492, -29.04922849112585, -5.133787492650686, -292.1379420001663, -370.70907769403664, -67.14869523592459, -491.4750185746416, -454.85154362181373, -600.6074035330066, -621.1992154799738, -704.0308627604734, -333.2505747613405, -714.5073656438351, 130.20882135277958, -65.60195198574417, -20.50012916617449, -69.81670471481584, -5.726159274103296, 12.625902711737943, 78.64698632118427, -45.66419111447731, -93.4687053049464, 54.577277007605495, -281.8458518047843, 113.11156350780371, -133.65078884725966, 120.37453785044215, 69.42240943070476, -46.98394346539802, -31.37779684348298, 118.25919618764121, -31.10516672911171, 139.67032223865485, 69.52693691548286, -37.31817510244953, -54.15224668706167, 14.936615264593948, -280.9279588222411, -10.266477791660193, 92.0962580798402, -3.6515317027746033, 142.83370705615187, -641.3391530612445, -582.2109739065338, -42.33552053789553, -65.72422123307511, 134.93288986112958, 66.35720469813896, 127.67459506240773, -578.3464003660631, 73.74462055222455, 95.51243706576528, -595.3408136935907, 21.06537753309435, 2.0000000000000013, 62.267565376338716, 120.06054694714335, -6.74856093767859, -420.43076238078936, 32.46465212790256, 58.719371541680296, -78.01925617829458, 110.68476986078015, 137.48032893118267, -172.91327301855586, -660.8247286595954, 106.3790238119485, 84.4220944143184, 90.30934037970829, -13.883818353133648, -18.65296099966497, 25.594779385316443, 147.50812968048112, 48.41971603982398, 136.66404361686915, 156.43999999999988, -81.71843355806946, 100.0503881421508, -1.42406525594595, 123.5653518306048, -89.04169344778703, 111.07028922407002, 11.230636475318402, 0.4418003939225101, 16.530404049786554, -455.2546654880343, -39.5994472305045, -123.56587019781232, -8.19417101788913, -28.764107309810715, 28.20108341933479, -98.87091582010007, 77.68064990820972, 68.39635098042672, 158.91280277471435, -28.70638105665191, -124.84440249313704, -30.21153691586048, -86.7319585152212, 17.510535673308183, 46.561904596438424, -2.0575172704116214, 120.98642811960123, 54.37712194266115, 191.42142226086375, -583.7168661440963, -146.39841010937286, -24.13176362270842, -2.519524601985255, -611.4818856999132, 68.09485970216033, 2.0000000000000013, -23.402714172033793, 154.12374646877925, 198.01999999999998, -1.4772801208195199, -62.38204642473663, -47.93197516954538, 160.1837151605242, -315.80917225607027, 75.01895731924333, -27.23135591758942, 170.33478104361254, 2.0000000000000013, 5.959999999999958, 170.77445805544545, 23.97046716863642, -16.837392571065024, 37.79508825801412, -560.35617607868, -157.23939302973292, -13.674159494745815, 98.90614158550626, -1.6697492403677936, -0.4911507918871465, -219.26645457023676, -163.70104014482814, 185.33164145555418, 4.249410963173542, 93.56205004001468, 28.191454326148985, 6.911690802038821, 23.858052036691312, -187.1539903754568, -3.2187424597108762, 123.95984350039262, 2.0000000000000013, -612.8070044900659, 28.938170334020896, 0.2255050730374703], "policy_predator_policy_reward": [523.6630811086889, 546.7175403134805, 540.9886859257551, 573.313650511291, 44.754386126294385, 6.352834838309905, 389.24019808211193, 623.0157402255388, 490.1094932051275, 367.45677890920507, 707.2277203212519, 599.5038280875681, 318.736744711968, 423.948116658866, 602.9308654565968, 397.140449587821, 642.5644585835519, 445.8820072556098, 303.7360044766467, 525.0578337026043, 527.9799892189901, 463.06786313771, 601.8985515456676, 350.93446834780576, 330.70313843806343, 391.2844819459987, 546.8728878254351, 515.3089349284877, 693.8921964828485, 593.5524226772221, 76.61838555796574, 496.31203430085634, 601.5507134369623, 267.4983364067811, 25.417664049179884, 106.7532638792012, 471.73383862701326, 363.4183773348589, 36.039617219528296, 207.70250343376307, 578.081044709728, 531.7850135290504, 609.67898390558, 51.597215845952086, 29.642474845611876, 7.768156089745513, 548.915699785992, 587.9251149504964, 24.0588456101389, 20.81673706475199, 545.5984683025963, 397.71838613712, 50.4937874926505, 293.22794200016625, 388.3624710614264, 435.8100077331823, 520.5761415897643, 503.6932178615389, 596.7453482064665, 637.3140756099476, 675.3895088180716, 702.4384675494024, 645.7484269261798, 589.3249784461411, 122.56015806917091, 110.48732203314285, 55.545667755610566, 162.44446039161718, 8.154097288262019, 14.383013678816226, 32.698632663868445, 109.89426375555523, 49.22272299239447, 323.33585180478417, 28.368436492196427, 189.63078884725888, 45.85546214955788, 69.8675905692953, 11.235809021055266, 73.7859312878252, 43.8084265609373, 32.995166729111915, 10.779677761345203, 72.79306308451712, 39.20817510244921, 67.7822466870625, 12.753384735406016, 316.6479588222409, 12.206477791660152, 40.42374192015982, 5.621531702774561, 10.596292943848102, 611.0815099497872, 668.563083541033, 52.92973890789868, 56.35582276086218, 15.53711013887041, 16.73279530186158, 352.5017467071642, 550.876698349215, 75.87041178741305, 26.119803450984453, 590.4116346403737, 349.78458456178873, 0.0, 27.712434623661302, 15.085500474639675, 3.2225135158957237, 408.6403908362621, 181.77682359330998, 2.439730291013153, 116.55015434560183, 10.107960925306907, 32.61694028273028, 535.3066534376007, 687.9395830797939, 11.703931722272726, 24.104950051460847, 51.1006596202917, 15.813818353133607, 186.51221192566368, 6.777427985100604, 5.93187031951879, 60.37028396017589, 15.745956383130938, 0.0, 83.48843355807037, 59.11961185784918, 3.4040652559459215, 30.744648169395262, 94.79169344778789, 51.56335717117112, 123.20936352468173, 1.5481996060774914, 23.98959595021364, 455.6946654880342, 50.05859531019483, 134.34055980639636, 10.154171017889087, 30.704107309811018, 251.63587472473395, 31.616458113430582, 7.439350091790851, 47.26364901957327, 16.247197225285635, 30.5563810566522, 155.7471892936729, 29.542266318116265, 121.58701688911941, 111.35392011377506, 42.4380954035614, 4.037517270411579, 29.373571880398902, 70.1828780573389, 419.84320907314196, 558.7082502416168, 148.04841010937136, 26.031763622708716, 420.32428939423164, 589.2793398795412, 40.645140297839646, 0.0, 25.30271417203409, 14.146253531220708, 0.0, 3.4572801208194894, 64.15204642473633, 49.831975169545004, 212.78679352919565, 250.93511599521452, 72.26104268075667, 30.08135591758969, 9.825218956387465, 0.0, 0.0, 7.405541944554438, 134.91872266333934, 161.40820273908906, 389.72868635534843, 536.3986624449666, 155.1585202914739, 35.34642441562865, 68.1338584144937, 3.649749240367759, 2.4811507918871376, 312.6264545702364, 37.077383006281366, 134.8420156829913, 46.110589036826326, 73.64794995998534, 72.56854567385139, 7.918309197961141, 8.801947963308908, 188.76399037545534, 5.198742459710834, 13.63015649960758, 393.1527853807831, 572.6439736382124, 0.0, 15.366324592941874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.546271281122559, "mean_inference_ms": 1.5771908887262873, "mean_action_processing_ms": 0.26321687008833927, "mean_env_wait_ms": 0.18704854685295763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004349827766418457, "StateBufferConnector_ms": 0.003102540969848633, "ViewRequirementAgentConnector_ms": 0.10378146171569824}, "num_episodes": 18, "episode_return_max": 650.7748610812644, "episode_return_min": -35.02988297544928, "episode_return_mean": 184.92360854156868, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.9577951325201, "num_env_steps_trained_throughput_per_sec": 359.9577951325201, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 10905.359, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10905.326, "sample_time_ms": 1348.785, "learn_time_ms": 9541.248, "learn_throughput": 419.232, "synch_weights_time_ms": 14.284}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "74486_00000", "date": "2024-08-16_15-02-51", "timestamp": 1723800771, "time_this_iter_s": 11.118124008178711, "time_total_s": 439.67334628105164, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397328af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 439.67334628105164, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 33.56875, "ram_util_percent": 79.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4888999196272046, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.001278605662956, "policy_loss": -0.002817440953687149, "vf_loss": 5.003643753415062, "vf_explained_var": 0.28977914733230753, "kl": 0.004523062621887348, "entropy": 1.266347087249554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4241155603417643, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2487890176829837, "policy_loss": -0.008257943359154361, "vf_loss": 1.2561453599936117, "vf_explained_var": 0.003702917080076914, "kl": 0.006010697729485285, "entropy": 0.8923162243353626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 650.7748610812644, "episode_reward_min": -35.02988297544928, "episode_reward_mean": 172.7515474074958, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.5073656438351, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 702.4384675494024}, "policy_reward_mean": {"prey_policy": -60.41032994073387, "predator_policy": 146.7861036444818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.02988297544928, 132.79000000000013, 203.7356081798803, 41.359999999999985, 132.54000000000028, 194.15932416679766, 268.1599999999997, 365.5360150544415, 46.44999999999986, 386.3147058646476, 77.94279725484895, 12.252804803432488, 340.54653884565937, 650.7748610812644, 146.94539895039526, 142.44726415830797, 113.810000000001, 3.4599999999999724, 145.2900000000002, 197.4599999999993, 305.5199999999997, 6.659999999999923, 163.95762274857864, 292.7699999999996, 15.519999999999968, 63.40999999999961, 134.46000000000038, 155.39999999999998, 56.09446652304201, 1.2258198977898354, 233.55999999999906, 452.70663975272356, 271.247272856387, 365.9207830416658, 91.98000000000025, 131.61999999999998, 202.45110417668494, 99.68999999999994, 290.8899999999997, 389.50823483924313, 226.60999999999916, 143.34000000000017, 200.2314582964157, 262.2299999999996, 308.8499999999998, 160.94, 156.2899999999998, 168.38364639524121, 136.4300000000003, 40.95999999999985, 21.233837688274427, 3.899999999999961, 212.5825004373993, 200.7799999999992, 177.0099999999996, 30.23351620279076, 163.71951416097997, 90.98000000000017, 274.9199999999993, 586.2560154315262, 3.5499999999999616, 395.60221897187324, 110.74000000000021, 170.1699999999998, 199.9999999999996, 3.6699999999999617, 308.0964524288636, 150.13000000000017, 182.1599999999998, 184.13999999999953, 303.46, 403.5662609796483, 19.59139218262589, 169.01999999999992, 95.35000000000043, 193.54999999999967, 217.5699999999991, 115.5900000000002, 34.26999999999966, 139.57, 354.98975452893006, 44.52999999999939, 154.3699999999999, 13.032484060683982, 249.34138974891965, 197.0299999999997, 188.88999999999973, 141.49000000000012, 3.799999999999962, 5.841085871115809, 194.33647186662657, 275.5528367243095, 209.43084882509498, 302.7099999999998, 10.918305113657041, 186.77999999999952, 202.66301218034323, 125.08000000000034, 5.874359433924755, 151.28000000000014], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-416.7356940447495, -453.4464048925718, -183.97047201895603, 73.01835136566444, -583.2462094865407, -322.88424057235807, -609.66898390558, -10.247215845952313, 100.93752515438817, -5.808156089745554, -583.8686067907566, -358.8128837789346, 123.36115438986123, 99.9232629352481, -548.7316108941492, -29.04922849112585, -5.133787492650686, -292.1379420001663, -370.70907769403664, -67.14869523592459, -491.4750185746416, -454.85154362181373, -600.6074035330066, -621.1992154799738, -704.0308627604734, -333.2505747613405, -714.5073656438351, 130.20882135277958, -65.60195198574417, -20.50012916617449, -69.81670471481584, -5.726159274103296, 12.625902711737943, 78.64698632118427, -45.66419111447731, -93.4687053049464, 54.577277007605495, -281.8458518047843, 113.11156350780371, -133.65078884725966, 120.37453785044215, 69.42240943070476, -46.98394346539802, -31.37779684348298, 118.25919618764121, -31.10516672911171, 139.67032223865485, 69.52693691548286, -37.31817510244953, -54.15224668706167, 14.936615264593948, -280.9279588222411, -10.266477791660193, 92.0962580798402, -3.6515317027746033, 142.83370705615187, -641.3391530612445, -582.2109739065338, -42.33552053789553, -65.72422123307511, 134.93288986112958, 66.35720469813896, 127.67459506240773, -578.3464003660631, 73.74462055222455, 95.51243706576528, -595.3408136935907, 21.06537753309435, 2.0000000000000013, 62.267565376338716, 120.06054694714335, -6.74856093767859, -420.43076238078936, 32.46465212790256, 58.719371541680296, -78.01925617829458, 110.68476986078015, 137.48032893118267, -172.91327301855586, -660.8247286595954, 106.3790238119485, 84.4220944143184, 90.30934037970829, -13.883818353133648, -18.65296099966497, 25.594779385316443, 147.50812968048112, 48.41971603982398, 136.66404361686915, 156.43999999999988, -81.71843355806946, 100.0503881421508, -1.42406525594595, 123.5653518306048, -89.04169344778703, 111.07028922407002, 11.230636475318402, 0.4418003939225101, 16.530404049786554, -455.2546654880343, -39.5994472305045, -123.56587019781232, -8.19417101788913, -28.764107309810715, 28.20108341933479, -98.87091582010007, 77.68064990820972, 68.39635098042672, 158.91280277471435, -28.70638105665191, -124.84440249313704, -30.21153691586048, -86.7319585152212, 17.510535673308183, 46.561904596438424, -2.0575172704116214, 120.98642811960123, 54.37712194266115, 191.42142226086375, -583.7168661440963, -146.39841010937286, -24.13176362270842, -2.519524601985255, -611.4818856999132, 68.09485970216033, 2.0000000000000013, -23.402714172033793, 154.12374646877925, 198.01999999999998, -1.4772801208195199, -62.38204642473663, -47.93197516954538, 160.1837151605242, -315.80917225607027, 75.01895731924333, -27.23135591758942, 170.33478104361254, 2.0000000000000013, 5.959999999999958, 170.77445805544545, 23.97046716863642, -16.837392571065024, 37.79508825801412, -560.35617607868, -157.23939302973292, -13.674159494745815, 98.90614158550626, -1.6697492403677936, -0.4911507918871465, -219.26645457023676, -163.70104014482814, 185.33164145555418, 4.249410963173542, 93.56205004001468, 28.191454326148985, 6.911690802038821, 23.858052036691312, -187.1539903754568, -3.2187424597108762, 123.95984350039262, 2.0000000000000013, -612.8070044900659, 28.938170334020896, 0.2255050730374703, 150.8115347571657, -33.773595869585165, -13.977862707340808, -69.7151178307172, -71.39512422306714, -9.347611600324655, 0.08296403395231212, 192.92644605669994, 148.19724100971104, -36.315252006927324, -14.784847388128163, 124.24501344119486, -38.91184730958196, -3.6958460580337436, 2.0000000000000013, -49.01600618776661, 175.4336489499773, -12.075036567731502, -17.942865212148142, 98.38305608634069, 160.2542323848387, -509.4376400671789, 129.85145477377094, 96.08610831535987, -48.866158308547924, -5.99397970788943, 135.70121045292743, -67.53299774007647, -43.32327444872282, 167.33036278174401, -20.863416656451214, -9.64291180442029, 2.0000000000000013, -3.5462432548423157, 2.0000000000000013, 61.441685373349365], "policy_predator_policy_reward": [471.73383862701326, 363.4183773348589, 36.039617219528296, 207.70250343376307, 578.081044709728, 531.7850135290504, 609.67898390558, 51.597215845952086, 29.642474845611876, 7.768156089745513, 548.915699785992, 587.9251149504964, 24.0588456101389, 20.81673706475199, 545.5984683025963, 397.71838613712, 50.4937874926505, 293.22794200016625, 388.3624710614264, 435.8100077331823, 520.5761415897643, 503.6932178615389, 596.7453482064665, 637.3140756099476, 675.3895088180716, 702.4384675494024, 645.7484269261798, 589.3249784461411, 122.56015806917091, 110.48732203314285, 55.545667755610566, 162.44446039161718, 8.154097288262019, 14.383013678816226, 32.698632663868445, 109.89426375555523, 49.22272299239447, 323.33585180478417, 28.368436492196427, 189.63078884725888, 45.85546214955788, 69.8675905692953, 11.235809021055266, 73.7859312878252, 43.8084265609373, 32.995166729111915, 10.779677761345203, 72.79306308451712, 39.20817510244921, 67.7822466870625, 12.753384735406016, 316.6479588222409, 12.206477791660152, 40.42374192015982, 5.621531702774561, 10.596292943848102, 611.0815099497872, 668.563083541033, 52.92973890789868, 56.35582276086218, 15.53711013887041, 16.73279530186158, 352.5017467071642, 550.876698349215, 75.87041178741305, 26.119803450984453, 590.4116346403737, 349.78458456178873, 0.0, 27.712434623661302, 15.085500474639675, 3.2225135158957237, 408.6403908362621, 181.77682359330998, 2.439730291013153, 116.55015434560183, 10.107960925306907, 32.61694028273028, 535.3066534376007, 687.9395830797939, 11.703931722272726, 24.104950051460847, 51.1006596202917, 15.813818353133607, 186.51221192566368, 6.777427985100604, 5.93187031951879, 60.37028396017589, 15.745956383130938, 0.0, 83.48843355807037, 59.11961185784918, 3.4040652559459215, 30.744648169395262, 94.79169344778789, 51.56335717117112, 123.20936352468173, 1.5481996060774914, 23.98959595021364, 455.6946654880342, 50.05859531019483, 134.34055980639636, 10.154171017889087, 30.704107309811018, 251.63587472473395, 31.616458113430582, 7.439350091790851, 47.26364901957327, 16.247197225285635, 30.5563810566522, 155.7471892936729, 29.542266318116265, 121.58701688911941, 111.35392011377506, 42.4380954035614, 4.037517270411579, 29.373571880398902, 70.1828780573389, 419.84320907314196, 558.7082502416168, 148.04841010937136, 26.031763622708716, 420.32428939423164, 589.2793398795412, 40.645140297839646, 0.0, 25.30271417203409, 14.146253531220708, 0.0, 3.4572801208194894, 64.15204642473633, 49.831975169545004, 212.78679352919565, 250.93511599521452, 72.26104268075667, 30.08135591758969, 9.825218956387465, 0.0, 0.0, 7.405541944554438, 134.91872266333934, 161.40820273908906, 389.72868635534843, 536.3986624449666, 155.1585202914739, 35.34642441562865, 68.1338584144937, 3.649749240367759, 2.4811507918871376, 312.6264545702364, 37.077383006281366, 134.8420156829913, 46.110589036826326, 73.64794995998534, 72.56854567385139, 7.918309197961141, 8.801947963308908, 188.76399037545534, 5.198742459710834, 13.63015649960758, 393.1527853807831, 572.6439736382124, 0.0, 15.366324592941874, 1.6584652428342286, 35.67359586958479, 54.38412841052144, 42.34133618822156, 215.51060264747204, 114.57352292483968, 1.9070359660476894, 2.1135539433000745, 38.80275899028898, 38.20525200692695, 16.73484738812825, 15.29498655880525, 40.741847309581594, 5.665846058033702, 23.16324274296476, 29.693849315917397, 3.5042978509961724, 27.473561633384843, 127.46653077113986, 67.64611507897837, 8.85661644025642, 549.7576400671787, 36.32854522622911, 40.44389168464006, 25.017083421120795, 40.76135970897328, 95.79530637058762, 22.816480916562252, 47.01357345157155, 31.642350395750622, 143.98341665645123, 11.602911804420248, 2.0816251492215003, 5.33897753954561, 0.0, 87.83831462665066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5464059259845024, "mean_inference_ms": 1.5819930827124165, "mean_action_processing_ms": 0.2625587193418164, "mean_env_wait_ms": 0.18708455284181075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044171810150146484, "StateBufferConnector_ms": 0.0030966997146606445, "ViewRequirementAgentConnector_ms": 0.10154902935028076}, "num_episodes": 18, "episode_return_max": 650.7748610812644, "episode_return_min": -35.02988297544928, "episode_return_mean": 172.7515474074958, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.7892578659939, "num_env_steps_trained_throughput_per_sec": 356.7892578659939, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 10976.683, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10976.65, "sample_time_ms": 1361.277, "learn_time_ms": 9600.042, "learn_throughput": 416.665, "synch_weights_time_ms": 14.349}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "74486_00000", "date": "2024-08-16_15-03-02", "timestamp": 1723800782, "time_this_iter_s": 11.218305110931396, "time_total_s": 450.89165139198303, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39800b430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 450.89165139198303, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 31.35, "ram_util_percent": 80.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4164021972310605, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.952802464823243, "policy_loss": -0.0053258148386024886, "vf_loss": 5.957400156455066, "vf_explained_var": 0.15505653231862992, "kl": 0.014562290055162528, "entropy": 1.1929641460615492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.260959481152277, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0619293898028672, "policy_loss": -0.007853696772350718, "vf_loss": 1.069126682290955, "vf_explained_var": 0.0034865532602582658, "kl": 0.0043760127696695576, "entropy": 0.9362217548347654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 586.2560154315262, "episode_reward_min": 1.2258198977898354, "episode_reward_mean": 171.15753018933094, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -660.8247286595954, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 687.9395830797939}, "policy_reward_mean": {"prey_policy": -14.11444688346677, "predator_policy": 99.69321197813233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.2900000000002, 197.4599999999993, 305.5199999999997, 6.659999999999923, 163.95762274857864, 292.7699999999996, 15.519999999999968, 63.40999999999961, 134.46000000000038, 155.39999999999998, 56.09446652304201, 1.2258198977898354, 233.55999999999906, 452.70663975272356, 271.247272856387, 365.9207830416658, 91.98000000000025, 131.61999999999998, 202.45110417668494, 99.68999999999994, 290.8899999999997, 389.50823483924313, 226.60999999999916, 143.34000000000017, 200.2314582964157, 262.2299999999996, 308.8499999999998, 160.94, 156.2899999999998, 168.38364639524121, 136.4300000000003, 40.95999999999985, 21.233837688274427, 3.899999999999961, 212.5825004373993, 200.7799999999992, 177.0099999999996, 30.23351620279076, 163.71951416097997, 90.98000000000017, 274.9199999999993, 586.2560154315262, 3.5499999999999616, 395.60221897187324, 110.74000000000021, 170.1699999999998, 199.9999999999996, 3.6699999999999617, 308.0964524288636, 150.13000000000017, 182.1599999999998, 184.13999999999953, 303.46, 403.5662609796483, 19.59139218262589, 169.01999999999992, 95.35000000000043, 193.54999999999967, 217.5699999999991, 115.5900000000002, 34.26999999999966, 139.57, 354.98975452893006, 44.52999999999939, 154.3699999999999, 13.032484060683982, 249.34138974891965, 197.0299999999997, 188.88999999999973, 141.49000000000012, 3.799999999999962, 5.841085871115809, 194.33647186662657, 275.5528367243095, 209.43084882509498, 302.7099999999998, 10.918305113657041, 186.77999999999952, 202.66301218034323, 125.08000000000034, 5.874359433924755, 151.28000000000014, 350.3099999999999, 172.10999999999987, 70.15000000000008, 196.81999999999965, 138.01890268800378, 142.45154454572562, 331.4799999999999, 16.837597453442402, 118.58334284839937, 184.03999999999974, 212.7299999999995, 182.52797333668934, 169.9099999999999, 183.07940889571523, 158.60494379977098, 182.0499999999999, 3.839999999999962, 251.2499999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [54.577277007605495, -281.8458518047843, 113.11156350780371, -133.65078884725966, 120.37453785044215, 69.42240943070476, -46.98394346539802, -31.37779684348298, 118.25919618764121, -31.10516672911171, 139.67032223865485, 69.52693691548286, -37.31817510244953, -54.15224668706167, 14.936615264593948, -280.9279588222411, -10.266477791660193, 92.0962580798402, -3.6515317027746033, 142.83370705615187, -641.3391530612445, -582.2109739065338, -42.33552053789553, -65.72422123307511, 134.93288986112958, 66.35720469813896, 127.67459506240773, -578.3464003660631, 73.74462055222455, 95.51243706576528, -595.3408136935907, 21.06537753309435, 2.0000000000000013, 62.267565376338716, 120.06054694714335, -6.74856093767859, -420.43076238078936, 32.46465212790256, 58.719371541680296, -78.01925617829458, 110.68476986078015, 137.48032893118267, -172.91327301855586, -660.8247286595954, 106.3790238119485, 84.4220944143184, 90.30934037970829, -13.883818353133648, -18.65296099966497, 25.594779385316443, 147.50812968048112, 48.41971603982398, 136.66404361686915, 156.43999999999988, -81.71843355806946, 100.0503881421508, -1.42406525594595, 123.5653518306048, -89.04169344778703, 111.07028922407002, 11.230636475318402, 0.4418003939225101, 16.530404049786554, -455.2546654880343, -39.5994472305045, -123.56587019781232, -8.19417101788913, -28.764107309810715, 28.20108341933479, -98.87091582010007, 77.68064990820972, 68.39635098042672, 158.91280277471435, -28.70638105665191, -124.84440249313704, -30.21153691586048, -86.7319585152212, 17.510535673308183, 46.561904596438424, -2.0575172704116214, 120.98642811960123, 54.37712194266115, 191.42142226086375, -583.7168661440963, -146.39841010937286, -24.13176362270842, -2.519524601985255, -611.4818856999132, 68.09485970216033, 2.0000000000000013, -23.402714172033793, 154.12374646877925, 198.01999999999998, -1.4772801208195199, -62.38204642473663, -47.93197516954538, 160.1837151605242, -315.80917225607027, 75.01895731924333, -27.23135591758942, 170.33478104361254, 2.0000000000000013, 5.959999999999958, 170.77445805544545, 23.97046716863642, -16.837392571065024, 37.79508825801412, -560.35617607868, -157.23939302973292, -13.674159494745815, 98.90614158550626, -1.6697492403677936, -0.4911507918871465, -219.26645457023676, -163.70104014482814, 185.33164145555418, 4.249410963173542, 93.56205004001468, 28.191454326148985, 6.911690802038821, 23.858052036691312, -187.1539903754568, -3.2187424597108762, 123.95984350039262, 2.0000000000000013, -612.8070044900659, 28.938170334020896, 0.2255050730374703, 150.8115347571657, -33.773595869585165, -13.977862707340808, -69.7151178307172, -71.39512422306714, -9.347611600324655, 0.08296403395231212, 192.92644605669994, 148.19724100971104, -36.315252006927324, -14.784847388128163, 124.24501344119486, -38.91184730958196, -3.6958460580337436, 2.0000000000000013, -49.01600618776661, 175.4336489499773, -12.075036567731502, -17.942865212148142, 98.38305608634069, 160.2542323848387, -509.4376400671789, 129.85145477377094, 96.08610831535987, -48.866158308547924, -5.99397970788943, 135.70121045292743, -67.53299774007647, -43.32327444872282, 167.33036278174401, -20.863416656451214, -9.64291180442029, 2.0000000000000013, -3.5462432548423157, 2.0000000000000013, 61.441685373349365, 185.23232914534373, 109.56119134050408, 7.486375547892232, 122.26252757134485, -276.6402197875031, 0.4619910403058484, -54.488420155541085, 169.39479557960323, -12.270606323731254, 82.03275650446339, -0.5977083075762835, -491.97244918668525, 129.33796183596908, 153.90006950640975, 2.0000000000000013, -21.24490875486225, -79.76671986516835, 2.0000000000000013, 151.29780184414858, -6.618262740073087, 178.22898462101762, -1.479537022251791, 160.12947066614686, 0.8362408380893415, 97.96259540920508, -38.2663120050321, -1.8183672937810844, 75.83259189042164, -66.07544222754134, 47.68607724258094, 164.40569950164007, -48.73632413625807, -17.161003203833754, -18.6243661668948, 8.33902937767985, 102.97173822870596], "policy_predator_policy_reward": [49.22272299239447, 323.33585180478417, 28.368436492196427, 189.63078884725888, 45.85546214955788, 69.8675905692953, 11.235809021055266, 73.7859312878252, 43.8084265609373, 32.995166729111915, 10.779677761345203, 72.79306308451712, 39.20817510244921, 67.7822466870625, 12.753384735406016, 316.6479588222409, 12.206477791660152, 40.42374192015982, 5.621531702774561, 10.596292943848102, 611.0815099497872, 668.563083541033, 52.92973890789868, 56.35582276086218, 15.53711013887041, 16.73279530186158, 352.5017467071642, 550.876698349215, 75.87041178741305, 26.119803450984453, 590.4116346403737, 349.78458456178873, 0.0, 27.712434623661302, 15.085500474639675, 3.2225135158957237, 408.6403908362621, 181.77682359330998, 2.439730291013153, 116.55015434560183, 10.107960925306907, 32.61694028273028, 535.3066534376007, 687.9395830797939, 11.703931722272726, 24.104950051460847, 51.1006596202917, 15.813818353133607, 186.51221192566368, 6.777427985100604, 5.93187031951879, 60.37028396017589, 15.745956383130938, 0.0, 83.48843355807037, 59.11961185784918, 3.4040652559459215, 30.744648169395262, 94.79169344778789, 51.56335717117112, 123.20936352468173, 1.5481996060774914, 23.98959595021364, 455.6946654880342, 50.05859531019483, 134.34055980639636, 10.154171017889087, 30.704107309811018, 251.63587472473395, 31.616458113430582, 7.439350091790851, 47.26364901957327, 16.247197225285635, 30.5563810566522, 155.7471892936729, 29.542266318116265, 121.58701688911941, 111.35392011377506, 42.4380954035614, 4.037517270411579, 29.373571880398902, 70.1828780573389, 419.84320907314196, 558.7082502416168, 148.04841010937136, 26.031763622708716, 420.32428939423164, 589.2793398795412, 40.645140297839646, 0.0, 25.30271417203409, 14.146253531220708, 0.0, 3.4572801208194894, 64.15204642473633, 49.831975169545004, 212.78679352919565, 250.93511599521452, 72.26104268075667, 30.08135591758969, 9.825218956387465, 0.0, 0.0, 7.405541944554438, 134.91872266333934, 161.40820273908906, 389.72868635534843, 536.3986624449666, 155.1585202914739, 35.34642441562865, 68.1338584144937, 3.649749240367759, 2.4811507918871376, 312.6264545702364, 37.077383006281366, 134.8420156829913, 46.110589036826326, 73.64794995998534, 72.56854567385139, 7.918309197961141, 8.801947963308908, 188.76399037545534, 5.198742459710834, 13.63015649960758, 393.1527853807831, 572.6439736382124, 0.0, 15.366324592941874, 1.6584652428342286, 35.67359586958479, 54.38412841052144, 42.34133618822156, 215.51060264747204, 114.57352292483968, 1.9070359660476894, 2.1135539433000745, 38.80275899028898, 38.20525200692695, 16.73484738812825, 15.29498655880525, 40.741847309581594, 5.665846058033702, 23.16324274296476, 29.693849315917397, 3.5042978509961724, 27.473561633384843, 127.46653077113986, 67.64611507897837, 8.85661644025642, 549.7576400671787, 36.32854522622911, 40.44389168464006, 25.017083421120795, 40.76135970897328, 95.79530637058762, 22.816480916562252, 47.01357345157155, 31.642350395750622, 143.98341665645123, 11.602911804420248, 2.0816251492215003, 5.33897753954561, 0.0, 87.83831462665066, 9.777670854656273, 45.73880865949589, 12.27362445210773, 30.08747242865517, 344.80021978750295, 1.528008959694153, 22.859451396786096, 59.054173179151434, 12.759509011734824, 55.49724349553652, 39.02343352263186, 595.9982685173553, 27.962038164030975, 20.279930493590257, 16.02345681178622, 20.059049396518667, 190.0367198651684, 6.313342848398901, 30.782198155851425, 8.578262740073045, 14.771015378982367, 21.209537022251766, 15.080529333853093, 6.481732498600519, 70.03740459079492, 40.17631200503172, 47.80345039926301, 61.261733899811894, 14.388608133917558, 162.60570065081367, 15.714300498359984, 50.666324136257685, 19.081003203834054, 20.544366166895095, 94.48097062232057, 45.45826177129403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5465851508011375, "mean_inference_ms": 1.5868770148252316, "mean_action_processing_ms": 0.26197934030220027, "mean_env_wait_ms": 0.18717011927379168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045261383056640625, "StateBufferConnector_ms": 0.003062725067138672, "ViewRequirementAgentConnector_ms": 0.10057246685028076}, "num_episodes": 18, "episode_return_max": 586.2560154315262, "episode_return_min": 1.2258198977898354, "episode_return_mean": 171.15753018933094, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.3219713895952, "num_env_steps_trained_throughput_per_sec": 382.3219713895952, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 10983.341, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10983.308, "sample_time_ms": 1371.651, "learn_time_ms": 9596.247, "learn_throughput": 416.83, "synch_weights_time_ms": 14.459}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "74486_00000", "date": "2024-08-16_15-03-12", "timestamp": 1723800792, "time_this_iter_s": 10.46718692779541, "time_total_s": 461.35883831977844, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39800bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 461.35883831977844, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 29.206666666666663, "ram_util_percent": 80.02666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.41076558497217, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.758406391850224, "policy_loss": -0.005200033549837788, "vf_loss": 4.763243974201263, "vf_explained_var": 0.05648318428211111, "kl": 0.007248809259513269, "entropy": 1.2577160164161965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3492636462841083, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3903738865145931, "policy_loss": -0.00839870255194092, "vf_loss": 1.3982431772682402, "vf_explained_var": 0.013865537145150401, "kl": 0.0070587820932232525, "entropy": 0.9041473002030105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 586.2560154315262, "episode_reward_min": -26.626011272817568, "episode_reward_mean": 160.36649256966328, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -639.8512944748826, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 604.2164308407054}, "policy_reward_mean": {"prey_policy": -3.8458695236350864, "predator_policy": 84.02911580846681}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.60999999999916, 143.34000000000017, 200.2314582964157, 262.2299999999996, 308.8499999999998, 160.94, 156.2899999999998, 168.38364639524121, 136.4300000000003, 40.95999999999985, 21.233837688274427, 3.899999999999961, 212.5825004373993, 200.7799999999992, 177.0099999999996, 30.23351620279076, 163.71951416097997, 90.98000000000017, 274.9199999999993, 586.2560154315262, 3.5499999999999616, 395.60221897187324, 110.74000000000021, 170.1699999999998, 199.9999999999996, 3.6699999999999617, 308.0964524288636, 150.13000000000017, 182.1599999999998, 184.13999999999953, 303.46, 403.5662609796483, 19.59139218262589, 169.01999999999992, 95.35000000000043, 193.54999999999967, 217.5699999999991, 115.5900000000002, 34.26999999999966, 139.57, 354.98975452893006, 44.52999999999939, 154.3699999999999, 13.032484060683982, 249.34138974891965, 197.0299999999997, 188.88999999999973, 141.49000000000012, 3.799999999999962, 5.841085871115809, 194.33647186662657, 275.5528367243095, 209.43084882509498, 302.7099999999998, 10.918305113657041, 186.77999999999952, 202.66301218034323, 125.08000000000034, 5.874359433924755, 151.28000000000014, 350.3099999999999, 172.10999999999987, 70.15000000000008, 196.81999999999965, 138.01890268800378, 142.45154454572562, 331.4799999999999, 16.837597453442402, 118.58334284839937, 184.03999999999974, 212.7299999999995, 182.52797333668934, 169.9099999999999, 183.07940889571523, 158.60494379977098, 182.0499999999999, 3.839999999999962, 251.2499999999999, 314.46999999999997, 195.72999999999962, 54.519999999999904, 23.333115767896093, -26.626011272817568, 3.8899999999999624, 134.24460085890036, 3.82999999999996, 121.72000000000024, 362.1199999999999, -5.144554763844198, 5.889999999999917, 160.46910141461575, 306.6999999999999, 337.36999999999966, 94.92000000000012, 169.05661387474314, 62.189999999999905, 300.72999999999973, 3.879999999999959, 192.88531598985315, 172.05999999999986], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [106.3790238119485, 84.4220944143184, 90.30934037970829, -13.883818353133648, -18.65296099966497, 25.594779385316443, 147.50812968048112, 48.41971603982398, 136.66404361686915, 156.43999999999988, -81.71843355806946, 100.0503881421508, -1.42406525594595, 123.5653518306048, -89.04169344778703, 111.07028922407002, 11.230636475318402, 0.4418003939225101, 16.530404049786554, -455.2546654880343, -39.5994472305045, -123.56587019781232, -8.19417101788913, -28.764107309810715, 28.20108341933479, -98.87091582010007, 77.68064990820972, 68.39635098042672, 158.91280277471435, -28.70638105665191, -124.84440249313704, -30.21153691586048, -86.7319585152212, 17.510535673308183, 46.561904596438424, -2.0575172704116214, 120.98642811960123, 54.37712194266115, 191.42142226086375, -583.7168661440963, -146.39841010937286, -24.13176362270842, -2.519524601985255, -611.4818856999132, 68.09485970216033, 2.0000000000000013, -23.402714172033793, 154.12374646877925, 198.01999999999998, -1.4772801208195199, -62.38204642473663, -47.93197516954538, 160.1837151605242, -315.80917225607027, 75.01895731924333, -27.23135591758942, 170.33478104361254, 2.0000000000000013, 5.959999999999958, 170.77445805544545, 23.97046716863642, -16.837392571065024, 37.79508825801412, -560.35617607868, -157.23939302973292, -13.674159494745815, 98.90614158550626, -1.6697492403677936, -0.4911507918871465, -219.26645457023676, -163.70104014482814, 185.33164145555418, 4.249410963173542, 93.56205004001468, 28.191454326148985, 6.911690802038821, 23.858052036691312, -187.1539903754568, -3.2187424597108762, 123.95984350039262, 2.0000000000000013, -612.8070044900659, 28.938170334020896, 0.2255050730374703, 150.8115347571657, -33.773595869585165, -13.977862707340808, -69.7151178307172, -71.39512422306714, -9.347611600324655, 0.08296403395231212, 192.92644605669994, 148.19724100971104, -36.315252006927324, -14.784847388128163, 124.24501344119486, -38.91184730958196, -3.6958460580337436, 2.0000000000000013, -49.01600618776661, 175.4336489499773, -12.075036567731502, -17.942865212148142, 98.38305608634069, 160.2542323848387, -509.4376400671789, 129.85145477377094, 96.08610831535987, -48.866158308547924, -5.99397970788943, 135.70121045292743, -67.53299774007647, -43.32327444872282, 167.33036278174401, -20.863416656451214, -9.64291180442029, 2.0000000000000013, -3.5462432548423157, 2.0000000000000013, 61.441685373349365, 185.23232914534373, 109.56119134050408, 7.486375547892232, 122.26252757134485, -276.6402197875031, 0.4619910403058484, -54.488420155541085, 169.39479557960323, -12.270606323731254, 82.03275650446339, -0.5977083075762835, -491.97244918668525, 129.33796183596908, 153.90006950640975, 2.0000000000000013, -21.24490875486225, -79.76671986516835, 2.0000000000000013, 151.29780184414858, -6.618262740073087, 178.22898462101762, -1.479537022251791, 160.12947066614686, 0.8362408380893415, 97.96259540920508, -38.2663120050321, -1.8183672937810844, 75.83259189042164, -66.07544222754134, 47.68607724258094, 164.40569950164007, -48.73632413625807, -17.161003203833754, -18.6243661668948, 8.33902937767985, 102.97173822870596, 168.06871162458316, 46.6706631588245, -80.69925249607105, 190.75155231177658, -459.2033896461047, 3.66561551061577, -82.9020910506849, -10.657079417855586, -75.00566128988343, -61.8231641651482, -46.68227785019035, 2.0000000000000013, -294.2559942040643, -639.8512944748826, -2.653118412289504, -88.17660111699136, 2.0000000000000013, 83.10960293614833, 132.9689578377819, 177.53568995621214, -80.7906095254839, -23.56928852350234, -4.313588571678322, -14.134526704243145, 120.98182734731165, -45.23504022289336, 126.11247450750326, 112.32078184910823, 141.86662358254307, 88.6293598332943, -21.39696441516685, 76.85101798611078, -16.02016424711599, 79.43404115624972, -4.503410917361682, -542.3549611993337, 72.18278705285638, 165.421839780325, -7.195815573743907, -45.32155820844197, 2.0000000000000013, 38.86304840736518, 96.73777836637908, -5.451467678352714], "policy_predator_policy_reward": [11.703931722272726, 24.104950051460847, 51.1006596202917, 15.813818353133607, 186.51221192566368, 6.777427985100604, 5.93187031951879, 60.37028396017589, 15.745956383130938, 0.0, 83.48843355807037, 59.11961185784918, 3.4040652559459215, 30.744648169395262, 94.79169344778789, 51.56335717117112, 123.20936352468173, 1.5481996060774914, 23.98959595021364, 455.6946654880342, 50.05859531019483, 134.34055980639636, 10.154171017889087, 30.704107309811018, 251.63587472473395, 31.616458113430582, 7.439350091790851, 47.26364901957327, 16.247197225285635, 30.5563810566522, 155.7471892936729, 29.542266318116265, 121.58701688911941, 111.35392011377506, 42.4380954035614, 4.037517270411579, 29.373571880398902, 70.1828780573389, 419.84320907314196, 558.7082502416168, 148.04841010937136, 26.031763622708716, 420.32428939423164, 589.2793398795412, 40.645140297839646, 0.0, 25.30271417203409, 14.146253531220708, 0.0, 3.4572801208194894, 64.15204642473633, 49.831975169545004, 212.78679352919565, 250.93511599521452, 72.26104268075667, 30.08135591758969, 9.825218956387465, 0.0, 0.0, 7.405541944554438, 134.91872266333934, 161.40820273908906, 389.72868635534843, 536.3986624449666, 155.1585202914739, 35.34642441562865, 68.1338584144937, 3.649749240367759, 2.4811507918871376, 312.6264545702364, 37.077383006281366, 134.8420156829913, 46.110589036826326, 73.64794995998534, 72.56854567385139, 7.918309197961141, 8.801947963308908, 188.76399037545534, 5.198742459710834, 13.63015649960758, 393.1527853807831, 572.6439736382124, 0.0, 15.366324592941874, 1.6584652428342286, 35.67359586958479, 54.38412841052144, 42.34133618822156, 215.51060264747204, 114.57352292483968, 1.9070359660476894, 2.1135539433000745, 38.80275899028898, 38.20525200692695, 16.73484738812825, 15.29498655880525, 40.741847309581594, 5.665846058033702, 23.16324274296476, 29.693849315917397, 3.5042978509961724, 27.473561633384843, 127.46653077113986, 67.64611507897837, 8.85661644025642, 549.7576400671787, 36.32854522622911, 40.44389168464006, 25.017083421120795, 40.76135970897328, 95.79530637058762, 22.816480916562252, 47.01357345157155, 31.642350395750622, 143.98341665645123, 11.602911804420248, 2.0816251492215003, 5.33897753954561, 0.0, 87.83831462665066, 9.777670854656273, 45.73880865949589, 12.27362445210773, 30.08747242865517, 344.80021978750295, 1.528008959694153, 22.859451396786096, 59.054173179151434, 12.759509011734824, 55.49724349553652, 39.02343352263186, 595.9982685173553, 27.962038164030975, 20.279930493590257, 16.02345681178622, 20.059049396518667, 190.0367198651684, 6.313342848398901, 30.782198155851425, 8.578262740073045, 14.771015378982367, 21.209537022251766, 15.080529333853093, 6.481732498600519, 70.03740459079492, 40.17631200503172, 47.80345039926301, 61.261733899811894, 14.388608133917558, 162.60570065081367, 15.714300498359984, 50.666324136257685, 19.081003203834054, 20.544366166895095, 94.48097062232057, 45.45826177129403, 20.981288375416856, 78.74933684117565, 53.25302938653224, 32.42467079776303, 504.81338964610455, 5.244384489384195, 33.332510377396765, 83.55977585904012, 20.006780438489486, 90.19603374372457, 0.0, 48.57227785018998, 597.0098755220198, 471.342014015827, 4.633118412289462, 90.02660111699231, 0.0, 36.61039706385152, 42.07104216221812, 9.544310043787794, 82.51060952548478, 16.704733759658495, 16.074526704243112, 8.26358857167828, 76.5227229006825, 8.199591389514554, 35.17752549249668, 33.089218150891895, 16.503376417457105, 90.3706401667057, 23.306964415167144, 16.158982013889233, 97.47762072222675, 8.165116243383046, 4.831941275990081, 604.2164308407054, 49.38721294714357, 13.738160219675086, 9.155815573743865, 47.24155820844159, 29.366813827301492, 122.65545375518668, 73.35222163362097, 7.421467678352672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.546801012607507, "mean_inference_ms": 1.5925699901121348, "mean_action_processing_ms": 0.26139368685669867, "mean_env_wait_ms": 0.18727576483693562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004542946815490723, "StateBufferConnector_ms": 0.0030918121337890625, "ViewRequirementAgentConnector_ms": 0.10432934761047363}, "num_episodes": 22, "episode_return_max": 586.2560154315262, "episode_return_min": -26.626011272817568, "episode_return_mean": 160.36649256966328, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.3056715297563, "num_env_steps_trained_throughput_per_sec": 388.3056715297563, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 10941.244, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10941.21, "sample_time_ms": 1373.436, "learn_time_ms": 9552.771, "learn_throughput": 418.727, "synch_weights_time_ms": 14.048}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "74486_00000", "date": "2024-08-16_15-03-23", "timestamp": 1723800803, "time_this_iter_s": 10.307153940200806, "time_total_s": 471.66599225997925, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397328430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 471.66599225997925, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 28.36666666666667, "ram_util_percent": 79.47333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.066723889900894, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.192253530214703, "policy_loss": -0.00976383802678101, "vf_loss": 5.201372721586278, "vf_explained_var": 0.06327627380058248, "kl": 0.012893053878694142, "entropy": 1.2680223357109797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2141795270972782, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.721840987319038, "policy_loss": -0.007608318793533183, "vf_loss": 2.7288786210080302, "vf_explained_var": 0.01116461334405122, "kl": 0.007609144252081382, "entropy": 0.9217374207166137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 553.7007149155752, "episode_reward_min": -171.84566379371043, "episode_reward_mean": 146.8847153329858, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.1721732192615, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 730.7796844702046}, "policy_reward_mean": {"prey_policy": -24.43821738466443, "predator_policy": 97.88057505115735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.1699999999998, 199.9999999999996, 3.6699999999999617, 308.0964524288636, 150.13000000000017, 182.1599999999998, 184.13999999999953, 303.46, 403.5662609796483, 19.59139218262589, 169.01999999999992, 95.35000000000043, 193.54999999999967, 217.5699999999991, 115.5900000000002, 34.26999999999966, 139.57, 354.98975452893006, 44.52999999999939, 154.3699999999999, 13.032484060683982, 249.34138974891965, 197.0299999999997, 188.88999999999973, 141.49000000000012, 3.799999999999962, 5.841085871115809, 194.33647186662657, 275.5528367243095, 209.43084882509498, 302.7099999999998, 10.918305113657041, 186.77999999999952, 202.66301218034323, 125.08000000000034, 5.874359433924755, 151.28000000000014, 350.3099999999999, 172.10999999999987, 70.15000000000008, 196.81999999999965, 138.01890268800378, 142.45154454572562, 331.4799999999999, 16.837597453442402, 118.58334284839937, 184.03999999999974, 212.7299999999995, 182.52797333668934, 169.9099999999999, 183.07940889571523, 158.60494379977098, 182.0499999999999, 3.839999999999962, 251.2499999999999, 314.46999999999997, 195.72999999999962, 54.519999999999904, 23.333115767896093, -26.626011272817568, 3.8899999999999624, 134.24460085890036, 3.82999999999996, 121.72000000000024, 362.1199999999999, -5.144554763844198, 5.889999999999917, 160.46910141461575, 306.6999999999999, 337.36999999999966, 94.92000000000012, 169.05661387474314, 62.189999999999905, 300.72999999999973, 3.879999999999959, 192.88531598985315, 172.05999999999986, 133.15453851807453, 83.93000000000012, 36.079999999999956, 229.81994849374865, -138.50598696672853, 62.69332978048092, 553.7007149155752, 307.76149781034525, 180.8099999999998, 14.508447340767482, 11.82021996897471, 368.29994190531033, 186.18981618088617, 6.887819873944835, -171.84566379371043, 169.7894432499964, 24.46896970909524, 95.0952170397944, 3.8699999999999597, 155.28999999999968, 166.14999999999958, 24.570000000000515, 223.05672989019598], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.402714172033793, 154.12374646877925, 198.01999999999998, -1.4772801208195199, -62.38204642473663, -47.93197516954538, 160.1837151605242, -315.80917225607027, 75.01895731924333, -27.23135591758942, 170.33478104361254, 2.0000000000000013, 5.959999999999958, 170.77445805544545, 23.97046716863642, -16.837392571065024, 37.79508825801412, -560.35617607868, -157.23939302973292, -13.674159494745815, 98.90614158550626, -1.6697492403677936, -0.4911507918871465, -219.26645457023676, -163.70104014482814, 185.33164145555418, 4.249410963173542, 93.56205004001468, 28.191454326148985, 6.911690802038821, 23.858052036691312, -187.1539903754568, -3.2187424597108762, 123.95984350039262, 2.0000000000000013, -612.8070044900659, 28.938170334020896, 0.2255050730374703, 150.8115347571657, -33.773595869585165, -13.977862707340808, -69.7151178307172, -71.39512422306714, -9.347611600324655, 0.08296403395231212, 192.92644605669994, 148.19724100971104, -36.315252006927324, -14.784847388128163, 124.24501344119486, -38.91184730958196, -3.6958460580337436, 2.0000000000000013, -49.01600618776661, 175.4336489499773, -12.075036567731502, -17.942865212148142, 98.38305608634069, 160.2542323848387, -509.4376400671789, 129.85145477377094, 96.08610831535987, -48.866158308547924, -5.99397970788943, 135.70121045292743, -67.53299774007647, -43.32327444872282, 167.33036278174401, -20.863416656451214, -9.64291180442029, 2.0000000000000013, -3.5462432548423157, 2.0000000000000013, 61.441685373349365, 185.23232914534373, 109.56119134050408, 7.486375547892232, 122.26252757134485, -276.6402197875031, 0.4619910403058484, -54.488420155541085, 169.39479557960323, -12.270606323731254, 82.03275650446339, -0.5977083075762835, -491.97244918668525, 129.33796183596908, 153.90006950640975, 2.0000000000000013, -21.24490875486225, -79.76671986516835, 2.0000000000000013, 151.29780184414858, -6.618262740073087, 178.22898462101762, -1.479537022251791, 160.12947066614686, 0.8362408380893415, 97.96259540920508, -38.2663120050321, -1.8183672937810844, 75.83259189042164, -66.07544222754134, 47.68607724258094, 164.40569950164007, -48.73632413625807, -17.161003203833754, -18.6243661668948, 8.33902937767985, 102.97173822870596, 168.06871162458316, 46.6706631588245, -80.69925249607105, 190.75155231177658, -459.2033896461047, 3.66561551061577, -82.9020910506849, -10.657079417855586, -75.00566128988343, -61.8231641651482, -46.68227785019035, 2.0000000000000013, -294.2559942040643, -639.8512944748826, -2.653118412289504, -88.17660111699136, 2.0000000000000013, 83.10960293614833, 132.9689578377819, 177.53568995621214, -80.7906095254839, -23.56928852350234, -4.313588571678322, -14.134526704243145, 120.98182734731165, -45.23504022289336, 126.11247450750326, 112.32078184910823, 141.86662358254307, 88.6293598332943, -21.39696441516685, 76.85101798611078, -16.02016424711599, 79.43404115624972, -4.503410917361682, -542.3549611993337, 72.18278705285638, 165.421839780325, -7.195815573743907, -45.32155820844197, 2.0000000000000013, 38.86304840736518, 96.73777836637908, -5.451467678352714, -100.21628830938317, -72.5493504399067, -338.01531455994456, -64.51614234059535, -467.63524954189035, -672.2310896699126, -5.693262475506362, -343.7949240483402, -606.0316865533497, -272.6559959613564, -120.24734970628089, -198.85192727959225, -717.1721732192615, 193.35504326215346, 111.23314504647473, 91.59103919036752, 139.42558886536358, -57.1641964417731, 7.551354485717198, -59.59204843922764, -4.139830350690339, -31.54638851372313, 188.97270966217292, 151.80596553073423, -172.86416403482787, 132.5080265006588, -33.313273259487545, -38.94254172453718, -377.74874598357826, -508.81950280955107, 2.0000000000000013, 121.03258227193749, -5.651243881120822, -392.2149767390447, -379.4494927945176, -50.25671114709261, -0.1634618125430536, -29.245315381281635, -31.899374845916046, 135.6872062717742, 117.7987908775977, -9.600723997714567, -15.317321964200739, -11.367730393953483, -94.3453482431183, 164.82088440632646], "policy_predator_policy_reward": [25.30271417203409, 14.146253531220708, 0.0, 3.4572801208194894, 64.15204642473633, 49.831975169545004, 212.78679352919565, 250.93511599521452, 72.26104268075667, 30.08135591758969, 9.825218956387465, 0.0, 0.0, 7.405541944554438, 134.91872266333934, 161.40820273908906, 389.72868635534843, 536.3986624449666, 155.1585202914739, 35.34642441562865, 68.1338584144937, 3.649749240367759, 2.4811507918871376, 312.6264545702364, 37.077383006281366, 134.8420156829913, 46.110589036826326, 73.64794995998534, 72.56854567385139, 7.918309197961141, 8.801947963308908, 188.76399037545534, 5.198742459710834, 13.63015649960758, 393.1527853807831, 572.6439736382124, 0.0, 15.366324592941874, 1.6584652428342286, 35.67359586958479, 54.38412841052144, 42.34133618822156, 215.51060264747204, 114.57352292483968, 1.9070359660476894, 2.1135539433000745, 38.80275899028898, 38.20525200692695, 16.73484738812825, 15.29498655880525, 40.741847309581594, 5.665846058033702, 23.16324274296476, 29.693849315917397, 3.5042978509961724, 27.473561633384843, 127.46653077113986, 67.64611507897837, 8.85661644025642, 549.7576400671787, 36.32854522622911, 40.44389168464006, 25.017083421120795, 40.76135970897328, 95.79530637058762, 22.816480916562252, 47.01357345157155, 31.642350395750622, 143.98341665645123, 11.602911804420248, 2.0816251492215003, 5.33897753954561, 0.0, 87.83831462665066, 9.777670854656273, 45.73880865949589, 12.27362445210773, 30.08747242865517, 344.80021978750295, 1.528008959694153, 22.859451396786096, 59.054173179151434, 12.759509011734824, 55.49724349553652, 39.02343352263186, 595.9982685173553, 27.962038164030975, 20.279930493590257, 16.02345681178622, 20.059049396518667, 190.0367198651684, 6.313342848398901, 30.782198155851425, 8.578262740073045, 14.771015378982367, 21.209537022251766, 15.080529333853093, 6.481732498600519, 70.03740459079492, 40.17631200503172, 47.80345039926301, 61.261733899811894, 14.388608133917558, 162.60570065081367, 15.714300498359984, 50.666324136257685, 19.081003203834054, 20.544366166895095, 94.48097062232057, 45.45826177129403, 20.981288375416856, 78.74933684117565, 53.25302938653224, 32.42467079776303, 504.81338964610455, 5.244384489384195, 33.332510377396765, 83.55977585904012, 20.006780438489486, 90.19603374372457, 0.0, 48.57227785018998, 597.0098755220198, 471.342014015827, 4.633118412289462, 90.02660111699231, 0.0, 36.61039706385152, 42.07104216221812, 9.544310043787794, 82.51060952548478, 16.704733759658495, 16.074526704243112, 8.26358857167828, 76.5227229006825, 8.199591389514554, 35.17752549249668, 33.089218150891895, 16.503376417457105, 90.3706401667057, 23.306964415167144, 16.158982013889233, 97.47762072222675, 8.165116243383046, 4.831941275990081, 604.2164308407054, 49.38721294714357, 13.738160219675086, 9.155815573743865, 47.24155820844159, 29.366813827301492, 122.65545375518668, 73.35222163362097, 7.421467678352672, 305.9201772673642, 0.0, 420.1753145599443, 66.28614234059626, 468.5352495418895, 707.4110896699125, 208.99865623213674, 370.30947878545913, 9.402011077771299, 730.7796844702046, 379.99396956264883, 1.7986372037050444, 658.8152948778315, 418.70254999485184, 19.743436417949205, 85.19387715555376, 60.50816641428874, 38.04044116212044, 5.057092855050327, 61.49204843922726, 33.35899390650617, 14.147444926881835, 9.107232243137576, 18.414034469265697, 119.51072559663523, 107.0352281184191, 38.341093133432096, 40.80254172453681, 671.1764844348932, 43.54610056452554, 1.629443249996335, 45.12741772806253, 145.52604567620716, 276.80914465305233, 522.9916873190195, 1.8097336623850455, 2.153461812543052, 31.12531538128193, 33.79937484591571, 17.702793728225622, 46.4012091224024, 11.550723997714526, 17.247321964200918, 34.007730393953445, 67.68768707958996, 84.89350664739936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5471751683086815, "mean_inference_ms": 1.5994085889385723, "mean_action_processing_ms": 0.2608842061755437, "mean_env_wait_ms": 0.18744443650136153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005006670951843262, "StateBufferConnector_ms": 0.003100872039794922, "ViewRequirementAgentConnector_ms": 0.10525214672088623}, "num_episodes": 23, "episode_return_max": 553.7007149155752, "episode_return_min": -171.84566379371043, "episode_return_mean": 146.8847153329858, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.0348516658389, "num_env_steps_trained_throughput_per_sec": 385.0348516658389, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 10874.505, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10874.472, "sample_time_ms": 1359.599, "learn_time_ms": 9499.948, "learn_throughput": 421.055, "synch_weights_time_ms": 13.948}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "74486_00000", "date": "2024-08-16_15-03-33", "timestamp": 1723800813, "time_this_iter_s": 10.39376187324524, "time_total_s": 482.0597541332245, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397746f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 482.0597541332245, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 29.007142857142863, "ram_util_percent": 79.22142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8961881534132377, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.015885108236283, "policy_loss": -0.0035211163269917643, "vf_loss": 5.01883047144249, "vf_explained_var": 0.030846701507215146, "kl": 0.011514884255075665, "entropy": 1.2389661198570614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0105776705754497, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9177400586150941, "policy_loss": -0.008934964392230743, "vf_loss": 1.9261106726984498, "vf_explained_var": 0.012905822702185817, "kl": 0.0075247095534657325, "entropy": 0.8973069726474702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 553.7007149155752, "episode_reward_min": -171.84566379371043, "episode_reward_mean": 140.75025932436472, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.1721732192615, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.35504326215346, "predator_policy": 787.1751712232018}, "policy_reward_mean": {"prey_policy": -21.69967100505893, "predator_policy": 92.07480066724136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.52999999999939, 154.3699999999999, 13.032484060683982, 249.34138974891965, 197.0299999999997, 188.88999999999973, 141.49000000000012, 3.799999999999962, 5.841085871115809, 194.33647186662657, 275.5528367243095, 209.43084882509498, 302.7099999999998, 10.918305113657041, 186.77999999999952, 202.66301218034323, 125.08000000000034, 5.874359433924755, 151.28000000000014, 350.3099999999999, 172.10999999999987, 70.15000000000008, 196.81999999999965, 138.01890268800378, 142.45154454572562, 331.4799999999999, 16.837597453442402, 118.58334284839937, 184.03999999999974, 212.7299999999995, 182.52797333668934, 169.9099999999999, 183.07940889571523, 158.60494379977098, 182.0499999999999, 3.839999999999962, 251.2499999999999, 314.46999999999997, 195.72999999999962, 54.519999999999904, 23.333115767896093, -26.626011272817568, 3.8899999999999624, 134.24460085890036, 3.82999999999996, 121.72000000000024, 362.1199999999999, -5.144554763844198, 5.889999999999917, 160.46910141461575, 306.6999999999999, 337.36999999999966, 94.92000000000012, 169.05661387474314, 62.189999999999905, 300.72999999999973, 3.879999999999959, 192.88531598985315, 172.05999999999986, 133.15453851807453, 83.93000000000012, 36.079999999999956, 229.81994849374865, -138.50598696672853, 62.69332978048092, 553.7007149155752, 307.76149781034525, 180.8099999999998, 14.508447340767482, 11.82021996897471, 368.29994190531033, 186.18981618088617, 6.887819873944835, -171.84566379371043, 169.7894432499964, 24.46896970909524, 95.0952170397944, 3.8699999999999597, 155.28999999999968, 166.14999999999958, 24.570000000000515, 223.05672989019598, 182.99999999999957, 242.09999999999994, 327.38100030262865, 159.9999999999999, 330.2909988865946, 3.93999999999996, 161.12, 31.49733853735178, -126.51510279245164, 4.6599999999999415, 380.08979161937674, 275.6700000000002, 216.80999999999938, 118.1800000000005, 214.93423270445982, 10.78999999999992, 93.7800000000003, 3.7199999999999593], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [28.938170334020896, 0.2255050730374703, 150.8115347571657, -33.773595869585165, -13.977862707340808, -69.7151178307172, -71.39512422306714, -9.347611600324655, 0.08296403395231212, 192.92644605669994, 148.19724100971104, -36.315252006927324, -14.784847388128163, 124.24501344119486, -38.91184730958196, -3.6958460580337436, 2.0000000000000013, -49.01600618776661, 175.4336489499773, -12.075036567731502, -17.942865212148142, 98.38305608634069, 160.2542323848387, -509.4376400671789, 129.85145477377094, 96.08610831535987, -48.866158308547924, -5.99397970788943, 135.70121045292743, -67.53299774007647, -43.32327444872282, 167.33036278174401, -20.863416656451214, -9.64291180442029, 2.0000000000000013, -3.5462432548423157, 2.0000000000000013, 61.441685373349365, 185.23232914534373, 109.56119134050408, 7.486375547892232, 122.26252757134485, -276.6402197875031, 0.4619910403058484, -54.488420155541085, 169.39479557960323, -12.270606323731254, 82.03275650446339, -0.5977083075762835, -491.97244918668525, 129.33796183596908, 153.90006950640975, 2.0000000000000013, -21.24490875486225, -79.76671986516835, 2.0000000000000013, 151.29780184414858, -6.618262740073087, 178.22898462101762, -1.479537022251791, 160.12947066614686, 0.8362408380893415, 97.96259540920508, -38.2663120050321, -1.8183672937810844, 75.83259189042164, -66.07544222754134, 47.68607724258094, 164.40569950164007, -48.73632413625807, -17.161003203833754, -18.6243661668948, 8.33902937767985, 102.97173822870596, 168.06871162458316, 46.6706631588245, -80.69925249607105, 190.75155231177658, -459.2033896461047, 3.66561551061577, -82.9020910506849, -10.657079417855586, -75.00566128988343, -61.8231641651482, -46.68227785019035, 2.0000000000000013, -294.2559942040643, -639.8512944748826, -2.653118412289504, -88.17660111699136, 2.0000000000000013, 83.10960293614833, 132.9689578377819, 177.53568995621214, -80.7906095254839, -23.56928852350234, -4.313588571678322, -14.134526704243145, 120.98182734731165, -45.23504022289336, 126.11247450750326, 112.32078184910823, 141.86662358254307, 88.6293598332943, -21.39696441516685, 76.85101798611078, -16.02016424711599, 79.43404115624972, -4.503410917361682, -542.3549611993337, 72.18278705285638, 165.421839780325, -7.195815573743907, -45.32155820844197, 2.0000000000000013, 38.86304840736518, 96.73777836637908, -5.451467678352714, -100.21628830938317, -72.5493504399067, -338.01531455994456, -64.51614234059535, -467.63524954189035, -672.2310896699126, -5.693262475506362, -343.7949240483402, -606.0316865533497, -272.6559959613564, -120.24734970628089, -198.85192727959225, -717.1721732192615, 193.35504326215346, 111.23314504647473, 91.59103919036752, 139.42558886536358, -57.1641964417731, 7.551354485717198, -59.59204843922764, -4.139830350690339, -31.54638851372313, 188.97270966217292, 151.80596553073423, -172.86416403482787, 132.5080265006588, -33.313273259487545, -38.94254172453718, -377.74874598357826, -508.81950280955107, 2.0000000000000013, 121.03258227193749, -5.651243881120822, -392.2149767390447, -379.4494927945176, -50.25671114709261, -0.1634618125430536, -29.245315381281635, -31.899374845916046, 135.6872062717742, 117.7987908775977, -9.600723997714567, -15.317321964200739, -11.367730393953483, -94.3453482431183, 164.82088440632646, -26.68652690816927, 160.0493257602809, 67.47741469500698, 12.472747166829398, 135.2740664110276, 107.27504955169088, 81.6998533385094, -43.09115048087469, 165.52690181671795, 126.4357000987334, -1.6365321416445509, -7.899081027584701, 64.25285538580748, -15.424827394207572, -61.83388304027552, 2.0000000000000013, -359.8404430422044, -650.9828039158435, -72.94540857228176, -7.7355186119307096, 182.2546058596508, 177.20597691278672, -93.7539180559408, 190.28923893580395, 28.90380748841775, 180.0784851112945, -81.59285619668312, -2.724669611022362, -107.80035034767836, -315.2009955679755, -33.992420573195375, 2.0000000000000013, -16.86485365292658, 28.00260192530354, -114.98141452011997, 2.0000000000000013], "policy_predator_policy_reward": [0.0, 15.366324592941874, 1.6584652428342286, 35.67359586958479, 54.38412841052144, 42.34133618822156, 215.51060264747204, 114.57352292483968, 1.9070359660476894, 2.1135539433000745, 38.80275899028898, 38.20525200692695, 16.73484738812825, 15.29498655880525, 40.741847309581594, 5.665846058033702, 23.16324274296476, 29.693849315917397, 3.5042978509961724, 27.473561633384843, 127.46653077113986, 67.64611507897837, 8.85661644025642, 549.7576400671787, 36.32854522622911, 40.44389168464006, 25.017083421120795, 40.76135970897328, 95.79530637058762, 22.816480916562252, 47.01357345157155, 31.642350395750622, 143.98341665645123, 11.602911804420248, 2.0816251492215003, 5.33897753954561, 0.0, 87.83831462665066, 9.777670854656273, 45.73880865949589, 12.27362445210773, 30.08747242865517, 344.80021978750295, 1.528008959694153, 22.859451396786096, 59.054173179151434, 12.759509011734824, 55.49724349553652, 39.02343352263186, 595.9982685173553, 27.962038164030975, 20.279930493590257, 16.02345681178622, 20.059049396518667, 190.0367198651684, 6.313342848398901, 30.782198155851425, 8.578262740073045, 14.771015378982367, 21.209537022251766, 15.080529333853093, 6.481732498600519, 70.03740459079492, 40.17631200503172, 47.80345039926301, 61.261733899811894, 14.388608133917558, 162.60570065081367, 15.714300498359984, 50.666324136257685, 19.081003203834054, 20.544366166895095, 94.48097062232057, 45.45826177129403, 20.981288375416856, 78.74933684117565, 53.25302938653224, 32.42467079776303, 504.81338964610455, 5.244384489384195, 33.332510377396765, 83.55977585904012, 20.006780438489486, 90.19603374372457, 0.0, 48.57227785018998, 597.0098755220198, 471.342014015827, 4.633118412289462, 90.02660111699231, 0.0, 36.61039706385152, 42.07104216221812, 9.544310043787794, 82.51060952548478, 16.704733759658495, 16.074526704243112, 8.26358857167828, 76.5227229006825, 8.199591389514554, 35.17752549249668, 33.089218150891895, 16.503376417457105, 90.3706401667057, 23.306964415167144, 16.158982013889233, 97.47762072222675, 8.165116243383046, 4.831941275990081, 604.2164308407054, 49.38721294714357, 13.738160219675086, 9.155815573743865, 47.24155820844159, 29.366813827301492, 122.65545375518668, 73.35222163362097, 7.421467678352672, 305.9201772673642, 0.0, 420.1753145599443, 66.28614234059626, 468.5352495418895, 707.4110896699125, 208.99865623213674, 370.30947878545913, 9.402011077771299, 730.7796844702046, 379.99396956264883, 1.7986372037050444, 658.8152948778315, 418.70254999485184, 19.743436417949205, 85.19387715555376, 60.50816641428874, 38.04044116212044, 5.057092855050327, 61.49204843922726, 33.35899390650617, 14.147444926881835, 9.107232243137576, 18.414034469265697, 119.51072559663523, 107.0352281184191, 38.341093133432096, 40.80254172453681, 671.1764844348932, 43.54610056452554, 1.629443249996335, 45.12741772806253, 145.52604567620716, 276.80914465305233, 522.9916873190195, 1.8097336623850455, 2.153461812543052, 31.12531538128193, 33.79937484591571, 17.702793728225622, 46.4012091224024, 11.550723997714526, 17.247321964200918, 34.007730393953445, 67.68768707958996, 84.89350664739936, 28.566526908169564, 21.070674239718997, 83.72258530499303, 78.42725283317091, 50.62067504024163, 34.211209299668944, 76.49014666149061, 44.90115048087433, 27.42596891344031, 10.902428057703563, 3.616532141644517, 9.859081027584672, 94.9371446141926, 17.35482739420777, 55.881403824274535, 35.44981775335181, 97.13297294239507, 787.1751712232018, 32.26710522399047, 53.073821960222844, 10.092208986635807, 10.536999860303435, 174.39391805594022, 4.740761064196008, 5.736192511582492, 2.091514888705499, 83.42285619668405, 119.07466961102241, 229.6036522848529, 408.33192633526136, 0.0, 42.78242057319501, 18.78485365292688, 63.85739807469637, 33.545024991726706, 83.15638952839404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5471377086153016, "mean_inference_ms": 1.6036433105003978, "mean_action_processing_ms": 0.2603507846790761, "mean_env_wait_ms": 0.18743107634692785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004994869232177734, "StateBufferConnector_ms": 0.002983689308166504, "ViewRequirementAgentConnector_ms": 0.09281182289123535}, "num_episodes": 18, "episode_return_max": 553.7007149155752, "episode_return_min": -171.84566379371043, "episode_return_mean": 140.75025932436472, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.772461204921, "num_env_steps_trained_throughput_per_sec": 398.772461204921, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 10746.288, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10746.255, "sample_time_ms": 1351.754, "learn_time_ms": 9379.599, "learn_throughput": 426.457, "synch_weights_time_ms": 13.982}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "74486_00000", "date": "2024-08-16_15-03-43", "timestamp": 1723800823, "time_this_iter_s": 10.036571025848389, "time_total_s": 492.0963251590729, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39737f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 492.0963251590729, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 25.380000000000003, "ram_util_percent": 78.94666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9866405994803817, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.919448321710819, "policy_loss": -0.006145389695410375, "vf_loss": 4.925061902293453, "vf_explained_var": -0.18039529556950565, "kl": 0.010635865216741881, "entropy": 1.2491370429437627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9852648581619616, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9729644673211233, "policy_loss": -0.007366469038266038, "vf_loss": 2.979699201369412, "vf_explained_var": 0.007728473408512337, "kl": 0.008423105611408485, "entropy": 0.9388253369028606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 553.7007149155752, "episode_reward_min": -331.3095924383861, "episode_reward_mean": 121.57549745200947, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1359.5286756697283, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.35504326215346, "predator_policy": 1143.0418558198828}, "policy_reward_mean": {"prey_policy": -66.48004637759912, "predator_policy": 127.26779510360389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.28000000000014, 350.3099999999999, 172.10999999999987, 70.15000000000008, 196.81999999999965, 138.01890268800378, 142.45154454572562, 331.4799999999999, 16.837597453442402, 118.58334284839937, 184.03999999999974, 212.7299999999995, 182.52797333668934, 169.9099999999999, 183.07940889571523, 158.60494379977098, 182.0499999999999, 3.839999999999962, 251.2499999999999, 314.46999999999997, 195.72999999999962, 54.519999999999904, 23.333115767896093, -26.626011272817568, 3.8899999999999624, 134.24460085890036, 3.82999999999996, 121.72000000000024, 362.1199999999999, -5.144554763844198, 5.889999999999917, 160.46910141461575, 306.6999999999999, 337.36999999999966, 94.92000000000012, 169.05661387474314, 62.189999999999905, 300.72999999999973, 3.879999999999959, 192.88531598985315, 172.05999999999986, 133.15453851807453, 83.93000000000012, 36.079999999999956, 229.81994849374865, -138.50598696672853, 62.69332978048092, 553.7007149155752, 307.76149781034525, 180.8099999999998, 14.508447340767482, 11.82021996897471, 368.29994190531033, 186.18981618088617, 6.887819873944835, -171.84566379371043, 169.7894432499964, 24.46896970909524, 95.0952170397944, 3.8699999999999597, 155.28999999999968, 166.14999999999958, 24.570000000000515, 223.05672989019598, 182.99999999999957, 242.09999999999994, 327.38100030262865, 159.9999999999999, 330.2909988865946, 3.93999999999996, 161.12, 31.49733853735178, -126.51510279245164, 4.6599999999999415, 380.08979161937674, 275.6700000000002, 216.80999999999938, 118.1800000000005, 214.93423270445982, 10.78999999999992, 93.7800000000003, 3.7199999999999593, 117.95000000000041, 95.27000000000021, 170.09999999999982, 287.7799999999998, 3.9499999999999593, -252.82315996474696, 5.774786398531064, 172.1499999999998, 3.639999999999967, 18.71929090440816, 11.959708519585352, 20.085437809310804, -331.3095924383861, -154.30764419917463, 179.48260209439388, 138.83051184960206, 90.0726656156199, 16.870000000000072], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, 61.441685373349365, 185.23232914534373, 109.56119134050408, 7.486375547892232, 122.26252757134485, -276.6402197875031, 0.4619910403058484, -54.488420155541085, 169.39479557960323, -12.270606323731254, 82.03275650446339, -0.5977083075762835, -491.97244918668525, 129.33796183596908, 153.90006950640975, 2.0000000000000013, -21.24490875486225, -79.76671986516835, 2.0000000000000013, 151.29780184414858, -6.618262740073087, 178.22898462101762, -1.479537022251791, 160.12947066614686, 0.8362408380893415, 97.96259540920508, -38.2663120050321, -1.8183672937810844, 75.83259189042164, -66.07544222754134, 47.68607724258094, 164.40569950164007, -48.73632413625807, -17.161003203833754, -18.6243661668948, 8.33902937767985, 102.97173822870596, 168.06871162458316, 46.6706631588245, -80.69925249607105, 190.75155231177658, -459.2033896461047, 3.66561551061577, -82.9020910506849, -10.657079417855586, -75.00566128988343, -61.8231641651482, -46.68227785019035, 2.0000000000000013, -294.2559942040643, -639.8512944748826, -2.653118412289504, -88.17660111699136, 2.0000000000000013, 83.10960293614833, 132.9689578377819, 177.53568995621214, -80.7906095254839, -23.56928852350234, -4.313588571678322, -14.134526704243145, 120.98182734731165, -45.23504022289336, 126.11247450750326, 112.32078184910823, 141.86662358254307, 88.6293598332943, -21.39696441516685, 76.85101798611078, -16.02016424711599, 79.43404115624972, -4.503410917361682, -542.3549611993337, 72.18278705285638, 165.421839780325, -7.195815573743907, -45.32155820844197, 2.0000000000000013, 38.86304840736518, 96.73777836637908, -5.451467678352714, -100.21628830938317, -72.5493504399067, -338.01531455994456, -64.51614234059535, -467.63524954189035, -672.2310896699126, -5.693262475506362, -343.7949240483402, -606.0316865533497, -272.6559959613564, -120.24734970628089, -198.85192727959225, -717.1721732192615, 193.35504326215346, 111.23314504647473, 91.59103919036752, 139.42558886536358, -57.1641964417731, 7.551354485717198, -59.59204843922764, -4.139830350690339, -31.54638851372313, 188.97270966217292, 151.80596553073423, -172.86416403482787, 132.5080265006588, -33.313273259487545, -38.94254172453718, -377.74874598357826, -508.81950280955107, 2.0000000000000013, 121.03258227193749, -5.651243881120822, -392.2149767390447, -379.4494927945176, -50.25671114709261, -0.1634618125430536, -29.245315381281635, -31.899374845916046, 135.6872062717742, 117.7987908775977, -9.600723997714567, -15.317321964200739, -11.367730393953483, -94.3453482431183, 164.82088440632646, -26.68652690816927, 160.0493257602809, 67.47741469500698, 12.472747166829398, 135.2740664110276, 107.27504955169088, 81.6998533385094, -43.09115048087469, 165.52690181671795, 126.4357000987334, -1.6365321416445509, -7.899081027584701, 64.25285538580748, -15.424827394207572, -61.83388304027552, 2.0000000000000013, -359.8404430422044, -650.9828039158435, -72.94540857228176, -7.7355186119307096, 182.2546058596508, 177.20597691278672, -93.7539180559408, 190.28923893580395, 28.90380748841775, 180.0784851112945, -81.59285619668312, -2.724669611022362, -107.80035034767836, -315.2009955679755, -33.992420573195375, 2.0000000000000013, -16.86485365292658, 28.00260192530354, -114.98141452011997, 2.0000000000000013, 11.499162059503425, -372.9927839928054, -104.70693622645388, 2.0000000000000013, 73.99692752410901, 2.0000000000000013, 102.91038363742406, 59.460927954194, -22.21505428787386, 4.081855691459926e-05, -476.84817756877703, -518.6547716462701, 2.0000000000000013, -6.021661877813809, -10.075229159003047, 130.86951134830298, -68.49296547817859, -21.944228604509973, -43.32477023034932, -11.516886715738979, -126.34353694534298, -14.775321416268676, -10.187708227001897, -105.48689674145238, -775.2362734694583, -790.1275091385586, -508.00101170862956, -827.8250548215188, -1359.5286756697283, -704.6014779404766, -855.096181862459, -817.8939934834946, -72.78353717856842, -200.69206995813573, 8.929999999999959, 7.93999999999996], "policy_predator_policy_reward": [0.0, 87.83831462665066, 9.777670854656273, 45.73880865949589, 12.27362445210773, 30.08747242865517, 344.80021978750295, 1.528008959694153, 22.859451396786096, 59.054173179151434, 12.759509011734824, 55.49724349553652, 39.02343352263186, 595.9982685173553, 27.962038164030975, 20.279930493590257, 16.02345681178622, 20.059049396518667, 190.0367198651684, 6.313342848398901, 30.782198155851425, 8.578262740073045, 14.771015378982367, 21.209537022251766, 15.080529333853093, 6.481732498600519, 70.03740459079492, 40.17631200503172, 47.80345039926301, 61.261733899811894, 14.388608133917558, 162.60570065081367, 15.714300498359984, 50.666324136257685, 19.081003203834054, 20.544366166895095, 94.48097062232057, 45.45826177129403, 20.981288375416856, 78.74933684117565, 53.25302938653224, 32.42467079776303, 504.81338964610455, 5.244384489384195, 33.332510377396765, 83.55977585904012, 20.006780438489486, 90.19603374372457, 0.0, 48.57227785018998, 597.0098755220198, 471.342014015827, 4.633118412289462, 90.02660111699231, 0.0, 36.61039706385152, 42.07104216221812, 9.544310043787794, 82.51060952548478, 16.704733759658495, 16.074526704243112, 8.26358857167828, 76.5227229006825, 8.199591389514554, 35.17752549249668, 33.089218150891895, 16.503376417457105, 90.3706401667057, 23.306964415167144, 16.158982013889233, 97.47762072222675, 8.165116243383046, 4.831941275990081, 604.2164308407054, 49.38721294714357, 13.738160219675086, 9.155815573743865, 47.24155820844159, 29.366813827301492, 122.65545375518668, 73.35222163362097, 7.421467678352672, 305.9201772673642, 0.0, 420.1753145599443, 66.28614234059626, 468.5352495418895, 707.4110896699125, 208.99865623213674, 370.30947878545913, 9.402011077771299, 730.7796844702046, 379.99396956264883, 1.7986372037050444, 658.8152948778315, 418.70254999485184, 19.743436417949205, 85.19387715555376, 60.50816641428874, 38.04044116212044, 5.057092855050327, 61.49204843922726, 33.35899390650617, 14.147444926881835, 9.107232243137576, 18.414034469265697, 119.51072559663523, 107.0352281184191, 38.341093133432096, 40.80254172453681, 671.1764844348932, 43.54610056452554, 1.629443249996335, 45.12741772806253, 145.52604567620716, 276.80914465305233, 522.9916873190195, 1.8097336623850455, 2.153461812543052, 31.12531538128193, 33.79937484591571, 17.702793728225622, 46.4012091224024, 11.550723997714526, 17.247321964200918, 34.007730393953445, 67.68768707958996, 84.89350664739936, 28.566526908169564, 21.070674239718997, 83.72258530499303, 78.42725283317091, 50.62067504024163, 34.211209299668944, 76.49014666149061, 44.90115048087433, 27.42596891344031, 10.902428057703563, 3.616532141644517, 9.859081027584672, 94.9371446141926, 17.35482739420777, 55.881403824274535, 35.44981775335181, 97.13297294239507, 787.1751712232018, 32.26710522399047, 53.073821960222844, 10.092208986635807, 10.536999860303435, 174.39391805594022, 4.740761064196008, 5.736192511582492, 2.091514888705499, 83.42285619668405, 119.07466961102241, 229.6036522848529, 408.33192633526136, 0.0, 42.78242057319501, 18.78485365292688, 63.85739807469637, 33.545024991726706, 83.15638952839404, 2.370837940496536, 477.07278399280534, 197.9769362264539, 0.0, 94.10307247589103, 0.0, 30.609616362575988, 94.79907204580599, 24.175054287874165, 1.989959181443087, 16.708653345050127, 725.9711359052513, 1.804786398531144, 7.991661877813767, 12.035229159003006, 39.32048865169706, 44.14369886466353, 49.933495218026046, 34.1095629939061, 39.45138485658956, 63.622053340929895, 89.45651354026809, 68.16711997170017, 67.59292280606522, 145.60576835657852, 1088.448421813053, 148.10047858322088, 1033.4179437477512, 1143.0418558198828, 1100.570899884719, 927.597546808581, 884.2231403869754, 17.840644142420896, 345.7076286099029, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5468053204114413, "mean_inference_ms": 1.6066990810347521, "mean_action_processing_ms": 0.25970947857588994, "mean_env_wait_ms": 0.18731332573653872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005378127098083496, "StateBufferConnector_ms": 0.0029516220092773438, "ViewRequirementAgentConnector_ms": 0.09281611442565918}, "num_episodes": 18, "episode_return_max": 553.7007149155752, "episode_return_min": -331.3095924383861, "episode_return_mean": 121.57549745200947, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.70160813888356, "num_env_steps_trained_throughput_per_sec": 391.70160813888356, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 10624.071, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10624.038, "sample_time_ms": 1336.215, "learn_time_ms": 9273.182, "learn_throughput": 431.351, "synch_weights_time_ms": 13.769}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "74486_00000", "date": "2024-08-16_15-03-53", "timestamp": 1723800833, "time_this_iter_s": 10.219462871551514, "time_total_s": 502.3157880306244, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39802d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 502.3157880306244, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 33.35, "ram_util_percent": 78.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7928473658977992, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5877868691449444, "policy_loss": -0.00984864318423052, "vf_loss": 3.5971205223174323, "vf_explained_var": 0.05780999537498232, "kl": 0.01029992361688262, "entropy": 1.2695509439422972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0156045254260775, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9372545151483445, "policy_loss": -0.00892107548640558, "vf_loss": 1.9456606196978736, "vf_explained_var": 0.009176374522466509, "kl": 0.0068662227383865255, "entropy": 0.9914570145506076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 553.7007149155752, "episode_reward_min": -331.3095924383861, "episode_reward_mean": 95.84253018669312, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1359.5286756697283, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.35504326215346, "predator_policy": 1143.0418558198828}, "policy_reward_mean": {"prey_policy": -93.12995157798832, "predator_policy": 141.05121667133494}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.333115767896093, -26.626011272817568, 3.8899999999999624, 134.24460085890036, 3.82999999999996, 121.72000000000024, 362.1199999999999, -5.144554763844198, 5.889999999999917, 160.46910141461575, 306.6999999999999, 337.36999999999966, 94.92000000000012, 169.05661387474314, 62.189999999999905, 300.72999999999973, 3.879999999999959, 192.88531598985315, 172.05999999999986, 133.15453851807453, 83.93000000000012, 36.079999999999956, 229.81994849374865, -138.50598696672853, 62.69332978048092, 553.7007149155752, 307.76149781034525, 180.8099999999998, 14.508447340767482, 11.82021996897471, 368.29994190531033, 186.18981618088617, 6.887819873944835, -171.84566379371043, 169.7894432499964, 24.46896970909524, 95.0952170397944, 3.8699999999999597, 155.28999999999968, 166.14999999999958, 24.570000000000515, 223.05672989019598, 182.99999999999957, 242.09999999999994, 327.38100030262865, 159.9999999999999, 330.2909988865946, 3.93999999999996, 161.12, 31.49733853735178, -126.51510279245164, 4.6599999999999415, 380.08979161937674, 275.6700000000002, 216.80999999999938, 118.1800000000005, 214.93423270445982, 10.78999999999992, 93.7800000000003, 3.7199999999999593, 117.95000000000041, 95.27000000000021, 170.09999999999982, 287.7799999999998, 3.9499999999999593, -252.82315996474696, 5.774786398531064, 172.1499999999998, 3.639999999999967, 18.71929090440816, 11.959708519585352, 20.085437809310804, -331.3095924383861, -154.30764419917463, 179.48260209439388, 138.83051184960206, 90.0726656156199, 16.870000000000072, 3.989999999999959, 167.34000000000006, 174.01999999999975, 3.9399999999999595, 24.190000000000005, 144.19000000000037, -287.06351957625543, 131.51000000000028, 15.181333928393899, -1.2625531048974277, 325.695288360015, 55.189999999999706, 118.06000000000064, 3.7999999999999625, 171.22076484354653, -19.96432741469045, 85.97000000000011, 11.109999999999971, 64.0199999999999, 8.619999999999932, 3.8899999999999597, 3.8499999999999615], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-82.9020910506849, -10.657079417855586, -75.00566128988343, -61.8231641651482, -46.68227785019035, 2.0000000000000013, -294.2559942040643, -639.8512944748826, -2.653118412289504, -88.17660111699136, 2.0000000000000013, 83.10960293614833, 132.9689578377819, 177.53568995621214, -80.7906095254839, -23.56928852350234, -4.313588571678322, -14.134526704243145, 120.98182734731165, -45.23504022289336, 126.11247450750326, 112.32078184910823, 141.86662358254307, 88.6293598332943, -21.39696441516685, 76.85101798611078, -16.02016424711599, 79.43404115624972, -4.503410917361682, -542.3549611993337, 72.18278705285638, 165.421839780325, -7.195815573743907, -45.32155820844197, 2.0000000000000013, 38.86304840736518, 96.73777836637908, -5.451467678352714, -100.21628830938317, -72.5493504399067, -338.01531455994456, -64.51614234059535, -467.63524954189035, -672.2310896699126, -5.693262475506362, -343.7949240483402, -606.0316865533497, -272.6559959613564, -120.24734970628089, -198.85192727959225, -717.1721732192615, 193.35504326215346, 111.23314504647473, 91.59103919036752, 139.42558886536358, -57.1641964417731, 7.551354485717198, -59.59204843922764, -4.139830350690339, -31.54638851372313, 188.97270966217292, 151.80596553073423, -172.86416403482787, 132.5080265006588, -33.313273259487545, -38.94254172453718, -377.74874598357826, -508.81950280955107, 2.0000000000000013, 121.03258227193749, -5.651243881120822, -392.2149767390447, -379.4494927945176, -50.25671114709261, -0.1634618125430536, -29.245315381281635, -31.899374845916046, 135.6872062717742, 117.7987908775977, -9.600723997714567, -15.317321964200739, -11.367730393953483, -94.3453482431183, 164.82088440632646, -26.68652690816927, 160.0493257602809, 67.47741469500698, 12.472747166829398, 135.2740664110276, 107.27504955169088, 81.6998533385094, -43.09115048087469, 165.52690181671795, 126.4357000987334, -1.6365321416445509, -7.899081027584701, 64.25285538580748, -15.424827394207572, -61.83388304027552, 2.0000000000000013, -359.8404430422044, -650.9828039158435, -72.94540857228176, -7.7355186119307096, 182.2546058596508, 177.20597691278672, -93.7539180559408, 190.28923893580395, 28.90380748841775, 180.0784851112945, -81.59285619668312, -2.724669611022362, -107.80035034767836, -315.2009955679755, -33.992420573195375, 2.0000000000000013, -16.86485365292658, 28.00260192530354, -114.98141452011997, 2.0000000000000013, 11.499162059503425, -372.9927839928054, -104.70693622645388, 2.0000000000000013, 73.99692752410901, 2.0000000000000013, 102.91038363742406, 59.460927954194, -22.21505428787386, 4.081855691459926e-05, -476.84817756877703, -518.6547716462701, 2.0000000000000013, -6.021661877813809, -10.075229159003047, 130.86951134830298, -68.49296547817859, -21.944228604509973, -43.32477023034932, -11.516886715738979, -126.34353694534298, -14.775321416268676, -10.187708227001897, -105.48689674145238, -775.2362734694583, -790.1275091385586, -508.00101170862956, -827.8250548215188, -1359.5286756697283, -704.6014779404766, -855.096181862459, -817.8939934834946, -72.78353717856842, -200.69206995813573, 8.929999999999959, 7.93999999999996, -0.26745689974918196, 2.0000000000000013, 163.13416224437577, 2.0000000000000013, 115.5800576365066, -6.194248796055165, -4.781091910117556, -4.462768972794164, -663.1195883723723, -7.5184690497418245, -26.55640772294552, 18.00164740693682, -451.1311673161328, -727.5040902515337, 2.0000000000000013, 9.619310013111578, -70.4743892682627, -10.726709030816751, -814.7045976333987, -15.967723561990546, -88.09591597169208, 173.4188485264366, -13.849856666089563, -242.84465928085334, -18.537388746942415, -50.12187716453431, -54.708701857602804, -20.848731837568184, -205.58618650339176, 13.054481705221663, -36.951056029433424, -28.30583232363379, 5.959999999999958, -250.3985174574509, -535.5466339590865, -27.84536279745171, -27.024029987654565, -469.35489666034005, -99.55249364758028, -13.881196851134906, -3.614777358772306, -60.00721931639528, -28.06112652477996, -7.909211530419695], "policy_predator_policy_reward": [33.332510377396765, 83.55977585904012, 20.006780438489486, 90.19603374372457, 0.0, 48.57227785018998, 597.0098755220198, 471.342014015827, 4.633118412289462, 90.02660111699231, 0.0, 36.61039706385152, 42.07104216221812, 9.544310043787794, 82.51060952548478, 16.704733759658495, 16.074526704243112, 8.26358857167828, 76.5227229006825, 8.199591389514554, 35.17752549249668, 33.089218150891895, 16.503376417457105, 90.3706401667057, 23.306964415167144, 16.158982013889233, 97.47762072222675, 8.165116243383046, 4.831941275990081, 604.2164308407054, 49.38721294714357, 13.738160219675086, 9.155815573743865, 47.24155820844159, 29.366813827301492, 122.65545375518668, 73.35222163362097, 7.421467678352672, 305.9201772673642, 0.0, 420.1753145599443, 66.28614234059626, 468.5352495418895, 707.4110896699125, 208.99865623213674, 370.30947878545913, 9.402011077771299, 730.7796844702046, 379.99396956264883, 1.7986372037050444, 658.8152948778315, 418.70254999485184, 19.743436417949205, 85.19387715555376, 60.50816641428874, 38.04044116212044, 5.057092855050327, 61.49204843922726, 33.35899390650617, 14.147444926881835, 9.107232243137576, 18.414034469265697, 119.51072559663523, 107.0352281184191, 38.341093133432096, 40.80254172453681, 671.1764844348932, 43.54610056452554, 1.629443249996335, 45.12741772806253, 145.52604567620716, 276.80914465305233, 522.9916873190195, 1.8097336623850455, 2.153461812543052, 31.12531538128193, 33.79937484591571, 17.702793728225622, 46.4012091224024, 11.550723997714526, 17.247321964200918, 34.007730393953445, 67.68768707958996, 84.89350664739936, 28.566526908169564, 21.070674239718997, 83.72258530499303, 78.42725283317091, 50.62067504024163, 34.211209299668944, 76.49014666149061, 44.90115048087433, 27.42596891344031, 10.902428057703563, 3.616532141644517, 9.859081027584672, 94.9371446141926, 17.35482739420777, 55.881403824274535, 35.44981775335181, 97.13297294239507, 787.1751712232018, 32.26710522399047, 53.073821960222844, 10.092208986635807, 10.536999860303435, 174.39391805594022, 4.740761064196008, 5.736192511582492, 2.091514888705499, 83.42285619668405, 119.07466961102241, 229.6036522848529, 408.33192633526136, 0.0, 42.78242057319501, 18.78485365292688, 63.85739807469637, 33.545024991726706, 83.15638952839404, 2.370837940496536, 477.07278399280534, 197.9769362264539, 0.0, 94.10307247589103, 0.0, 30.609616362575988, 94.79907204580599, 24.175054287874165, 1.989959181443087, 16.708653345050127, 725.9711359052513, 1.804786398531144, 7.991661877813767, 12.035229159003006, 39.32048865169706, 44.14369886466353, 49.933495218026046, 34.1095629939061, 39.45138485658956, 63.622053340929895, 89.45651354026809, 68.16711997170017, 67.59292280606522, 145.60576835657852, 1088.448421813053, 148.10047858322088, 1033.4179437477512, 1143.0418558198828, 1100.570899884719, 927.597546808581, 884.2231403869754, 17.840644142420896, 345.7076286099029, 0.0, 0.0, 2.257456899749178, 0.0, 2.2058377556242954, 0.0, 56.48994236349343, 8.144248796055125, 6.751091910117514, 6.432768972794122, 685.3595883723721, 9.468469049741783, 28.496407722945822, 124.2483525930632, 21.480117660954118, 870.0916203304565, 0.0, 119.89068998688865, 47.02827245013015, 49.35415977734414, 48.98735715097825, 780.4224109395142, 225.13591597169204, 15.236439833578467, 15.789856666089522, 296.09465928085325, 20.457388746942716, 166.26187716453438, 56.568701857602434, 22.788731837568488, 7.342323713810324, 356.41014592790646, 38.97350781793526, 6.319053120440826, 0.0, 330.4085174574509, 544.7166339590864, 29.785362797452013, 28.89402998765485, 531.5048966603399, 96.74428627663056, 25.30940422208544, 5.594777358772264, 61.9172193163949, 29.96112652478026, 9.859211530419653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5459990605909707, "mean_inference_ms": 1.6090117995746342, "mean_action_processing_ms": 0.2585088268654125, "mean_env_wait_ms": 0.1868637156920314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005480766296386719, "StateBufferConnector_ms": 0.003087282180786133, "ViewRequirementAgentConnector_ms": 0.09834551811218262}, "num_episodes": 22, "episode_return_max": 553.7007149155752, "episode_return_min": -331.3095924383861, "episode_return_mean": 95.84253018669312, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.44494476809433, "num_env_steps_trained_throughput_per_sec": 400.44494476809433, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 10482.699, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10482.665, "sample_time_ms": 1332.581, "learn_time_ms": 9135.411, "learn_throughput": 437.857, "synch_weights_time_ms": 13.804}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "74486_00000", "date": "2024-08-16_15-04-03", "timestamp": 1723800843, "time_this_iter_s": 9.995013952255249, "time_total_s": 512.3108019828796, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39802d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 512.3108019828796, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 38.65, "ram_util_percent": 78.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.95485604957298, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.153955208687555, "policy_loss": -0.0054692006693344815, "vf_loss": 4.158855631490233, "vf_explained_var": -0.17058750425697003, "kl": 0.011375753909546716, "entropy": 1.2662439503997722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0763335455504675, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1009170886700748, "policy_loss": -0.006378089087625975, "vf_loss": 3.1066791067678463, "vf_explained_var": 0.006951241549991426, "kl": 0.008214172492132393, "entropy": 0.8328534795809044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 553.7007149155752, "episode_reward_min": -331.3095924383861, "episode_reward_mean": 93.37381103357055, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1359.5286756697283, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.35504326215346, "predator_policy": 1143.0418558198828}, "policy_reward_mean": {"prey_policy": -93.6638210084271, "predator_policy": 140.35072652521242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.50598696672853, 62.69332978048092, 553.7007149155752, 307.76149781034525, 180.8099999999998, 14.508447340767482, 11.82021996897471, 368.29994190531033, 186.18981618088617, 6.887819873944835, -171.84566379371043, 169.7894432499964, 24.46896970909524, 95.0952170397944, 3.8699999999999597, 155.28999999999968, 166.14999999999958, 24.570000000000515, 223.05672989019598, 182.99999999999957, 242.09999999999994, 327.38100030262865, 159.9999999999999, 330.2909988865946, 3.93999999999996, 161.12, 31.49733853735178, -126.51510279245164, 4.6599999999999415, 380.08979161937674, 275.6700000000002, 216.80999999999938, 118.1800000000005, 214.93423270445982, 10.78999999999992, 93.7800000000003, 3.7199999999999593, 117.95000000000041, 95.27000000000021, 170.09999999999982, 287.7799999999998, 3.9499999999999593, -252.82315996474696, 5.774786398531064, 172.1499999999998, 3.639999999999967, 18.71929090440816, 11.959708519585352, 20.085437809310804, -331.3095924383861, -154.30764419917463, 179.48260209439388, 138.83051184960206, 90.0726656156199, 16.870000000000072, 3.989999999999959, 167.34000000000006, 174.01999999999975, 3.9399999999999595, 24.190000000000005, 144.19000000000037, -287.06351957625543, 131.51000000000028, 15.181333928393899, -1.2625531048974277, 325.695288360015, 55.189999999999706, 118.06000000000064, 3.7999999999999625, 171.22076484354653, -19.96432741469045, 85.97000000000011, 11.109999999999971, 64.0199999999999, 8.619999999999932, 3.8899999999999597, 3.8499999999999615, 389.7009955630939, 27.600000000000545, 304.6844061420805, 78.16877783101147, 3.546472714112088, 170.83999999999997, 3.809999999999961, -7.224863031380975, 154.03000000000003, 3.9099999999999593, 3.979999999999959, 6.240066630802838, 273.23, 100.06000000000031, 150.76999999999998, 34.261494429201974, 286.97328423614437, 63.18999999999976, 136.6748514788442, 141.95900664250695, -11.173501580803965, 150.40976251329855, 193.98999999999967], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-606.0316865533497, -272.6559959613564, -120.24734970628089, -198.85192727959225, -717.1721732192615, 193.35504326215346, 111.23314504647473, 91.59103919036752, 139.42558886536358, -57.1641964417731, 7.551354485717198, -59.59204843922764, -4.139830350690339, -31.54638851372313, 188.97270966217292, 151.80596553073423, -172.86416403482787, 132.5080265006588, -33.313273259487545, -38.94254172453718, -377.74874598357826, -508.81950280955107, 2.0000000000000013, 121.03258227193749, -5.651243881120822, -392.2149767390447, -379.4494927945176, -50.25671114709261, -0.1634618125430536, -29.245315381281635, -31.899374845916046, 135.6872062717742, 117.7987908775977, -9.600723997714567, -15.317321964200739, -11.367730393953483, -94.3453482431183, 164.82088440632646, -26.68652690816927, 160.0493257602809, 67.47741469500698, 12.472747166829398, 135.2740664110276, 107.27504955169088, 81.6998533385094, -43.09115048087469, 165.52690181671795, 126.4357000987334, -1.6365321416445509, -7.899081027584701, 64.25285538580748, -15.424827394207572, -61.83388304027552, 2.0000000000000013, -359.8404430422044, -650.9828039158435, -72.94540857228176, -7.7355186119307096, 182.2546058596508, 177.20597691278672, -93.7539180559408, 190.28923893580395, 28.90380748841775, 180.0784851112945, -81.59285619668312, -2.724669611022362, -107.80035034767836, -315.2009955679755, -33.992420573195375, 2.0000000000000013, -16.86485365292658, 28.00260192530354, -114.98141452011997, 2.0000000000000013, 11.499162059503425, -372.9927839928054, -104.70693622645388, 2.0000000000000013, 73.99692752410901, 2.0000000000000013, 102.91038363742406, 59.460927954194, -22.21505428787386, 4.081855691459926e-05, -476.84817756877703, -518.6547716462701, 2.0000000000000013, -6.021661877813809, -10.075229159003047, 130.86951134830298, -68.49296547817859, -21.944228604509973, -43.32477023034932, -11.516886715738979, -126.34353694534298, -14.775321416268676, -10.187708227001897, -105.48689674145238, -775.2362734694583, -790.1275091385586, -508.00101170862956, -827.8250548215188, -1359.5286756697283, -704.6014779404766, -855.096181862459, -817.8939934834946, -72.78353717856842, -200.69206995813573, 8.929999999999959, 7.93999999999996, -0.26745689974918196, 2.0000000000000013, 163.13416224437577, 2.0000000000000013, 115.5800576365066, -6.194248796055165, -4.781091910117556, -4.462768972794164, -663.1195883723723, -7.5184690497418245, -26.55640772294552, 18.00164740693682, -451.1311673161328, -727.5040902515337, 2.0000000000000013, 9.619310013111578, -70.4743892682627, -10.726709030816751, -814.7045976333987, -15.967723561990546, -88.09591597169208, 173.4188485264366, -13.849856666089563, -242.84465928085334, -18.537388746942415, -50.12187716453431, -54.708701857602804, -20.848731837568184, -205.58618650339176, 13.054481705221663, -36.951056029433424, -28.30583232363379, 5.959999999999958, -250.3985174574509, -535.5466339590865, -27.84536279745171, -27.024029987654565, -469.35489666034005, -99.55249364758028, -13.881196851134906, -3.614777358772306, -60.00721931639528, -28.06112652477996, -7.909211530419695, 116.0331442791108, 147.04920775019337, -21.257356579349757, 10.65760253100801, 2.0000000000000013, -861.1961050664177, 28.98877783101041, -16.607451881175876, -8.480759269126466, -14.393995585647938, -127.36546890991565, 134.27255514028107, -8.021673703981737, -90.186176637329, -19.795530890894337, -72.09308743293465, 21.01995443199438, -10.857439373695662, -39.56442210488008, 2.0000000000000013, -1.2892524016623073, 2.0000000000000013, -23.00980562065114, -105.29130789391596, -189.99776898158365, 180.82132526292378, -147.76224920086278, 14.3085260796815, -44.129453147335795, -125.1596203723813, -41.545165464894524, 2.75009115692621, -26.065511168905253, -160.96051682903962, -294.77429690021023, -0.9514599489018207, -92.17214161805589, -171.6131916267833, -465.91277193697647, -36.321276681928495, -34.55563331290351, -15.504062701827298, -260.18364785897245, -73.60484595803806, 175.0934700398952, -1.0755620852008858], "policy_predator_policy_reward": [9.402011077771299, 730.7796844702046, 379.99396956264883, 1.7986372037050444, 658.8152948778315, 418.70254999485184, 19.743436417949205, 85.19387715555376, 60.50816641428874, 38.04044116212044, 5.057092855050327, 61.49204843922726, 33.35899390650617, 14.147444926881835, 9.107232243137576, 18.414034469265697, 119.51072559663523, 107.0352281184191, 38.341093133432096, 40.80254172453681, 671.1764844348932, 43.54610056452554, 1.629443249996335, 45.12741772806253, 145.52604567620716, 276.80914465305233, 522.9916873190195, 1.8097336623850455, 2.153461812543052, 31.12531538128193, 33.79937484591571, 17.702793728225622, 46.4012091224024, 11.550723997714526, 17.247321964200918, 34.007730393953445, 67.68768707958996, 84.89350664739936, 28.566526908169564, 21.070674239718997, 83.72258530499303, 78.42725283317091, 50.62067504024163, 34.211209299668944, 76.49014666149061, 44.90115048087433, 27.42596891344031, 10.902428057703563, 3.616532141644517, 9.859081027584672, 94.9371446141926, 17.35482739420777, 55.881403824274535, 35.44981775335181, 97.13297294239507, 787.1751712232018, 32.26710522399047, 53.073821960222844, 10.092208986635807, 10.536999860303435, 174.39391805594022, 4.740761064196008, 5.736192511582492, 2.091514888705499, 83.42285619668405, 119.07466961102241, 229.6036522848529, 408.33192633526136, 0.0, 42.78242057319501, 18.78485365292688, 63.85739807469637, 33.545024991726706, 83.15638952839404, 2.370837940496536, 477.07278399280534, 197.9769362264539, 0.0, 94.10307247589103, 0.0, 30.609616362575988, 94.79907204580599, 24.175054287874165, 1.989959181443087, 16.708653345050127, 725.9711359052513, 1.804786398531144, 7.991661877813767, 12.035229159003006, 39.32048865169706, 44.14369886466353, 49.933495218026046, 34.1095629939061, 39.45138485658956, 63.622053340929895, 89.45651354026809, 68.16711997170017, 67.59292280606522, 145.60576835657852, 1088.448421813053, 148.10047858322088, 1033.4179437477512, 1143.0418558198828, 1100.570899884719, 927.597546808581, 884.2231403869754, 17.840644142420896, 345.7076286099029, 0.0, 0.0, 2.257456899749178, 0.0, 2.2058377556242954, 0.0, 56.48994236349343, 8.144248796055125, 6.751091910117514, 6.432768972794122, 685.3595883723721, 9.468469049741783, 28.496407722945822, 124.2483525930632, 21.480117660954118, 870.0916203304565, 0.0, 119.89068998688865, 47.02827245013015, 49.35415977734414, 48.98735715097825, 780.4224109395142, 225.13591597169204, 15.236439833578467, 15.789856666089522, 296.09465928085325, 20.457388746942716, 166.26187716453438, 56.568701857602434, 22.788731837568488, 7.342323713810324, 356.41014592790646, 38.97350781793526, 6.319053120440826, 0.0, 330.4085174574509, 544.7166339590864, 29.785362797452013, 28.89402998765485, 531.5048966603399, 96.74428627663056, 25.30940422208544, 5.594777358772264, 61.9172193163949, 29.96112652478026, 9.859211530419653, 63.809612839773465, 62.80903069401629, 23.14735657935005, 15.052397468991954, 458.0816042764884, 705.7989069320097, 59.26176825987334, 6.525683621302719, 10.037249496512679, 16.383978072373814, 129.0354689099151, 34.89744485971899, 9.981673703981695, 92.03617663732994, 10.710667859513741, 73.9530874329356, 131.06004556800565, 12.80743937369562, 41.4744221048797, 0.0, 3.269252401662281, 0.0, 105.51557608050263, 29.025604064868567, 280.18615150376905, 2.220292214890757, 230.00224920086254, 3.511473920318463, 193.22945314733573, 126.82962037238215, 43.29082574863569, 29.765742988534434, 267.2850116264179, 206.71430060767213, 354.9942969002099, 3.921459948901802, 164.04708680432051, 236.4130979193615, 493.1131495128632, 151.0799057485485, 4.224486577999617, 34.66170785592714, 4.019817360746252, 480.1784389695629, 16.906529960104784, 3.065562085200864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5435793198372565, "mean_inference_ms": 1.6064101752742062, "mean_action_processing_ms": 0.2566645748070803, "mean_env_wait_ms": 0.18624360228248313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006571292877197266, "StateBufferConnector_ms": 0.003031492233276367, "ViewRequirementAgentConnector_ms": 0.09328651428222656}, "num_episodes": 23, "episode_return_max": 553.7007149155752, "episode_return_min": -331.3095924383861, "episode_return_mean": 93.37381103357055, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.34778096645994, "num_env_steps_trained_throughput_per_sec": 374.34778096645994, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 10505.175, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10505.141, "sample_time_ms": 1321.081, "learn_time_ms": 9169.49, "learn_throughput": 436.229, "synch_weights_time_ms": 13.7}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "74486_00000", "date": "2024-08-16_15-04-14", "timestamp": 1723800854, "time_this_iter_s": 10.689759016036987, "time_total_s": 523.0005609989166, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39736f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 523.0005609989166, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 39.681250000000006, "ram_util_percent": 78.83125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.256344245760529, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.335309668445083, "policy_loss": -0.005047150739473562, "vf_loss": 6.339922837605552, "vf_explained_var": -0.22370491317971042, "kl": 0.00867977239100876, "entropy": 1.226554910657267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9710450461459539, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.110557257056867, "policy_loss": -0.005357215914224821, "vf_loss": 4.115225009943442, "vf_explained_var": 0.013977915111672942, "kl": 0.009192904136498639, "entropy": 0.8705216292351011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 389.7009955630939, "episode_reward_min": -331.3095924383861, "episode_reward_mean": 79.26024273787998, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1359.5286756697283, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.28923893580395, "predator_policy": 1347.2821065309097}, "policy_reward_mean": {"prey_policy": -124.17062775841475, "predator_policy": 163.8007491273548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [223.05672989019598, 182.99999999999957, 242.09999999999994, 327.38100030262865, 159.9999999999999, 330.2909988865946, 3.93999999999996, 161.12, 31.49733853735178, -126.51510279245164, 4.6599999999999415, 380.08979161937674, 275.6700000000002, 216.80999999999938, 118.1800000000005, 214.93423270445982, 10.78999999999992, 93.7800000000003, 3.7199999999999593, 117.95000000000041, 95.27000000000021, 170.09999999999982, 287.7799999999998, 3.9499999999999593, -252.82315996474696, 5.774786398531064, 172.1499999999998, 3.639999999999967, 18.71929090440816, 11.959708519585352, 20.085437809310804, -331.3095924383861, -154.30764419917463, 179.48260209439388, 138.83051184960206, 90.0726656156199, 16.870000000000072, 3.989999999999959, 167.34000000000006, 174.01999999999975, 3.9399999999999595, 24.190000000000005, 144.19000000000037, -287.06351957625543, 131.51000000000028, 15.181333928393899, -1.2625531048974277, 325.695288360015, 55.189999999999706, 118.06000000000064, 3.7999999999999625, 171.22076484354653, -19.96432741469045, 85.97000000000011, 11.109999999999971, 64.0199999999999, 8.619999999999932, 3.8899999999999597, 3.8499999999999615, 389.7009955630939, 27.600000000000545, 304.6844061420805, 78.16877783101147, 3.546472714112088, 170.83999999999997, 3.809999999999961, -7.224863031380975, 154.03000000000003, 3.9099999999999593, 3.979999999999959, 6.240066630802838, 273.23, 100.06000000000031, 150.76999999999998, 34.261494429201974, 286.97328423614437, 63.18999999999976, 136.6748514788442, 141.95900664250695, -11.173501580803965, 150.40976251329855, 193.98999999999967, 7.659999999999923, -26.361578614625962, 61.079999999999686, 2.0117485644479878, 187.04999999999973, 81.96999999999994, 133.62071381927166, 143.94000000000017, -34.396889408811155, -99.10784127510755, 4.109999999999963, 196.0199999999997, 1.979999999999988, 21.830000000000286, -73.30031611082767, 76.92988728074657, 7.8599999999999675, -82.69878680942001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-94.3453482431183, 164.82088440632646, -26.68652690816927, 160.0493257602809, 67.47741469500698, 12.472747166829398, 135.2740664110276, 107.27504955169088, 81.6998533385094, -43.09115048087469, 165.52690181671795, 126.4357000987334, -1.6365321416445509, -7.899081027584701, 64.25285538580748, -15.424827394207572, -61.83388304027552, 2.0000000000000013, -359.8404430422044, -650.9828039158435, -72.94540857228176, -7.7355186119307096, 182.2546058596508, 177.20597691278672, -93.7539180559408, 190.28923893580395, 28.90380748841775, 180.0784851112945, -81.59285619668312, -2.724669611022362, -107.80035034767836, -315.2009955679755, -33.992420573195375, 2.0000000000000013, -16.86485365292658, 28.00260192530354, -114.98141452011997, 2.0000000000000013, 11.499162059503425, -372.9927839928054, -104.70693622645388, 2.0000000000000013, 73.99692752410901, 2.0000000000000013, 102.91038363742406, 59.460927954194, -22.21505428787386, 4.081855691459926e-05, -476.84817756877703, -518.6547716462701, 2.0000000000000013, -6.021661877813809, -10.075229159003047, 130.86951134830298, -68.49296547817859, -21.944228604509973, -43.32477023034932, -11.516886715738979, -126.34353694534298, -14.775321416268676, -10.187708227001897, -105.48689674145238, -775.2362734694583, -790.1275091385586, -508.00101170862956, -827.8250548215188, -1359.5286756697283, -704.6014779404766, -855.096181862459, -817.8939934834946, -72.78353717856842, -200.69206995813573, 8.929999999999959, 7.93999999999996, -0.26745689974918196, 2.0000000000000013, 163.13416224437577, 2.0000000000000013, 115.5800576365066, -6.194248796055165, -4.781091910117556, -4.462768972794164, -663.1195883723723, -7.5184690497418245, -26.55640772294552, 18.00164740693682, -451.1311673161328, -727.5040902515337, 2.0000000000000013, 9.619310013111578, -70.4743892682627, -10.726709030816751, -814.7045976333987, -15.967723561990546, -88.09591597169208, 173.4188485264366, -13.849856666089563, -242.84465928085334, -18.537388746942415, -50.12187716453431, -54.708701857602804, -20.848731837568184, -205.58618650339176, 13.054481705221663, -36.951056029433424, -28.30583232363379, 5.959999999999958, -250.3985174574509, -535.5466339590865, -27.84536279745171, -27.024029987654565, -469.35489666034005, -99.55249364758028, -13.881196851134906, -3.614777358772306, -60.00721931639528, -28.06112652477996, -7.909211530419695, 116.0331442791108, 147.04920775019337, -21.257356579349757, 10.65760253100801, 2.0000000000000013, -861.1961050664177, 28.98877783101041, -16.607451881175876, -8.480759269126466, -14.393995585647938, -127.36546890991565, 134.27255514028107, -8.021673703981737, -90.186176637329, -19.795530890894337, -72.09308743293465, 21.01995443199438, -10.857439373695662, -39.56442210488008, 2.0000000000000013, -1.2892524016623073, 2.0000000000000013, -23.00980562065114, -105.29130789391596, -189.99776898158365, 180.82132526292378, -147.76224920086278, 14.3085260796815, -44.129453147335795, -125.1596203723813, -41.545165464894524, 2.75009115692621, -26.065511168905253, -160.96051682903962, -294.77429690021023, -0.9514599489018207, -92.17214161805589, -171.6131916267833, -465.91277193697647, -36.321276681928495, -34.55563331290351, -15.504062701827298, -260.18364785897245, -73.60484595803806, 175.0934700398952, -1.0755620852008858, -64.3148106444672, -36.89948160382421, -706.4888758375217, -206.79222154494258, -445.3500750546812, 5.558701632933587, -30.072203546141814, -10.225536184397917, 2.0000000000000013, 162.92843664612974, -343.94707406934236, -9.190278326320978, -30.05962612644155, -414.3387756294769, -37.34902344994647, 4.49410064392638, -551.9115712676868, -86.51121853498469, -519.282093722252, -194.71031184138553, -0.3042583556648504, -624.0437059381227, -2.745744349069418, 189.99046381711435, -1.7454723923773448, -1347.2821065309097, 18.830000000000286, -802.2588344296925, -153.24939833322262, -518.8942080942184, -34.998433808856085, -417.92820386674777, -540.8087238073177, -42.589783115880955, -920.5536914942816, -121.61203610712765], "policy_predator_policy_reward": [67.68768707958996, 84.89350664739936, 28.566526908169564, 21.070674239718997, 83.72258530499303, 78.42725283317091, 50.62067504024163, 34.211209299668944, 76.49014666149061, 44.90115048087433, 27.42596891344031, 10.902428057703563, 3.616532141644517, 9.859081027584672, 94.9371446141926, 17.35482739420777, 55.881403824274535, 35.44981775335181, 97.13297294239507, 787.1751712232018, 32.26710522399047, 53.073821960222844, 10.092208986635807, 10.536999860303435, 174.39391805594022, 4.740761064196008, 5.736192511582492, 2.091514888705499, 83.42285619668405, 119.07466961102241, 229.6036522848529, 408.33192633526136, 0.0, 42.78242057319501, 18.78485365292688, 63.85739807469637, 33.545024991726706, 83.15638952839404, 2.370837940496536, 477.07278399280534, 197.9769362264539, 0.0, 94.10307247589103, 0.0, 30.609616362575988, 94.79907204580599, 24.175054287874165, 1.989959181443087, 16.708653345050127, 725.9711359052513, 1.804786398531144, 7.991661877813767, 12.035229159003006, 39.32048865169706, 44.14369886466353, 49.933495218026046, 34.1095629939061, 39.45138485658956, 63.622053340929895, 89.45651354026809, 68.16711997170017, 67.59292280606522, 145.60576835657852, 1088.448421813053, 148.10047858322088, 1033.4179437477512, 1143.0418558198828, 1100.570899884719, 927.597546808581, 884.2231403869754, 17.840644142420896, 345.7076286099029, 0.0, 0.0, 2.257456899749178, 0.0, 2.2058377556242954, 0.0, 56.48994236349343, 8.144248796055125, 6.751091910117514, 6.432768972794122, 685.3595883723721, 9.468469049741783, 28.496407722945822, 124.2483525930632, 21.480117660954118, 870.0916203304565, 0.0, 119.89068998688865, 47.02827245013015, 49.35415977734414, 48.98735715097825, 780.4224109395142, 225.13591597169204, 15.236439833578467, 15.789856666089522, 296.09465928085325, 20.457388746942716, 166.26187716453438, 56.568701857602434, 22.788731837568488, 7.342323713810324, 356.41014592790646, 38.97350781793526, 6.319053120440826, 0.0, 330.4085174574509, 544.7166339590864, 29.785362797452013, 28.89402998765485, 531.5048966603399, 96.74428627663056, 25.30940422208544, 5.594777358772264, 61.9172193163949, 29.96112652478026, 9.859211530419653, 63.809612839773465, 62.80903069401629, 23.14735657935005, 15.052397468991954, 458.0816042764884, 705.7989069320097, 59.26176825987334, 6.525683621302719, 10.037249496512679, 16.383978072373814, 129.0354689099151, 34.89744485971899, 9.981673703981695, 92.03617663732994, 10.710667859513741, 73.9530874329356, 131.06004556800565, 12.80743937369562, 41.4744221048797, 0.0, 3.269252401662281, 0.0, 105.51557608050263, 29.025604064868567, 280.18615150376905, 2.220292214890757, 230.00224920086254, 3.511473920318463, 193.22945314733573, 126.82962037238215, 43.29082574863569, 29.765742988534434, 267.2850116264179, 206.71430060767213, 354.9942969002099, 3.921459948901802, 164.04708680432051, 236.4130979193615, 493.1131495128632, 151.0799057485485, 4.224486577999617, 34.66170785592714, 4.019817360746252, 480.1784389695629, 16.906529960104784, 3.065562085200864, 66.17481064446815, 42.699481603823855, 863.7585359526973, 23.160982815141008, 493.5800750546813, 7.291298367066373, 0.0, 42.30948829498798, 0.0, 22.12156335387025, 423.9570740693424, 11.150278326320937, 0.0, 578.0191155751907, 39.25902344994609, 137.53589935607363, 604.02590039386, 0.0, 560.7206182756037, 54.1639460129265, 2.2942583556648466, 626.1637059381226, 4.725744349069377, 4.049536182885639, 3.7254723923773083, 1347.2821065309097, 0.0, 805.2588344296925, 84.15788420450949, 514.6854061121037, 43.251889140064044, 486.60463581628585, 546.8087238073177, 44.449783115880585, 954.5740484377795, 4.892892354209336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5453384270084437, "mean_inference_ms": 1.613475817401961, "mean_action_processing_ms": 0.2572943527582725, "mean_env_wait_ms": 0.18664355690493672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006409287452697754, "StateBufferConnector_ms": 0.0030611753463745117, "ViewRequirementAgentConnector_ms": 0.09377479553222656}, "num_episodes": 18, "episode_return_max": 389.7009955630939, "episode_return_min": -331.3095924383861, "episode_return_mean": 79.26024273787998, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.3048510407167, "num_env_steps_trained_throughput_per_sec": 377.3048510407167, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 10499.409, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10499.374, "sample_time_ms": 1347.806, "learn_time_ms": 9137.107, "learn_throughput": 437.775, "synch_weights_time_ms": 13.681}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "74486_00000", "date": "2024-08-16_15-04-25", "timestamp": 1723800865, "time_this_iter_s": 10.607483148574829, "time_total_s": 533.6080441474915, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39736f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 533.6080441474915, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 34.766666666666666, "ram_util_percent": 79.56666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5108468513640148, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.9170918072342245, "policy_loss": -0.008632116074668903, "vf_loss": 4.925097537419153, "vf_explained_var": -0.18748437651881464, "kl": 0.012527967535028432, "entropy": 1.2502996582833548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.047374637574746, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5765309570958377, "policy_loss": -0.004604718750145622, "vf_loss": 3.5804197826082746, "vf_explained_var": 0.011498187931757125, "kl": 0.009545171686086564, "entropy": 0.7145673666050825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 422.13887899696164, "episode_reward_min": -331.3095924383861, "episode_reward_mean": 71.84839132092715, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1359.5286756697283, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.89847076477926, "predator_policy": 1347.2821065309097}, "policy_reward_mean": {"prey_policy": -154.83828433614005, "predator_policy": 190.76247999660364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.7199999999999593, 117.95000000000041, 95.27000000000021, 170.09999999999982, 287.7799999999998, 3.9499999999999593, -252.82315996474696, 5.774786398531064, 172.1499999999998, 3.639999999999967, 18.71929090440816, 11.959708519585352, 20.085437809310804, -331.3095924383861, -154.30764419917463, 179.48260209439388, 138.83051184960206, 90.0726656156199, 16.870000000000072, 3.989999999999959, 167.34000000000006, 174.01999999999975, 3.9399999999999595, 24.190000000000005, 144.19000000000037, -287.06351957625543, 131.51000000000028, 15.181333928393899, -1.2625531048974277, 325.695288360015, 55.189999999999706, 118.06000000000064, 3.7999999999999625, 171.22076484354653, -19.96432741469045, 85.97000000000011, 11.109999999999971, 64.0199999999999, 8.619999999999932, 3.8899999999999597, 3.8499999999999615, 389.7009955630939, 27.600000000000545, 304.6844061420805, 78.16877783101147, 3.546472714112088, 170.83999999999997, 3.809999999999961, -7.224863031380975, 154.03000000000003, 3.9099999999999593, 3.979999999999959, 6.240066630802838, 273.23, 100.06000000000031, 150.76999999999998, 34.261494429201974, 286.97328423614437, 63.18999999999976, 136.6748514788442, 141.95900664250695, -11.173501580803965, 150.40976251329855, 193.98999999999967, 7.659999999999923, -26.361578614625962, 61.079999999999686, 2.0117485644479878, 187.04999999999973, 81.96999999999994, 133.62071381927166, 143.94000000000017, -34.396889408811155, -99.10784127510755, 4.109999999999963, 196.0199999999997, 1.979999999999988, 21.830000000000286, -73.30031611082767, 76.92988728074657, 7.8599999999999675, -82.69878680942001, 150.8800000000003, 4.648076374185916, 84.96000000000006, 138.9200000000004, 34.32366579933951, 160.26999999999995, -123.60878615763905, 341.03027298140927, 45.99999999999998, 52.05999999999995, 72.9699999999999, 23.02000000000023, 221.48124806127032, 216.75999999999948, 199.85999999999962, 24.18649139734527, 39.700000000000294, 422.13887899696164], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-114.98141452011997, 2.0000000000000013, 11.499162059503425, -372.9927839928054, -104.70693622645388, 2.0000000000000013, 73.99692752410901, 2.0000000000000013, 102.91038363742406, 59.460927954194, -22.21505428787386, 4.081855691459926e-05, -476.84817756877703, -518.6547716462701, 2.0000000000000013, -6.021661877813809, -10.075229159003047, 130.86951134830298, -68.49296547817859, -21.944228604509973, -43.32477023034932, -11.516886715738979, -126.34353694534298, -14.775321416268676, -10.187708227001897, -105.48689674145238, -775.2362734694583, -790.1275091385586, -508.00101170862956, -827.8250548215188, -1359.5286756697283, -704.6014779404766, -855.096181862459, -817.8939934834946, -72.78353717856842, -200.69206995813573, 8.929999999999959, 7.93999999999996, -0.26745689974918196, 2.0000000000000013, 163.13416224437577, 2.0000000000000013, 115.5800576365066, -6.194248796055165, -4.781091910117556, -4.462768972794164, -663.1195883723723, -7.5184690497418245, -26.55640772294552, 18.00164740693682, -451.1311673161328, -727.5040902515337, 2.0000000000000013, 9.619310013111578, -70.4743892682627, -10.726709030816751, -814.7045976333987, -15.967723561990546, -88.09591597169208, 173.4188485264366, -13.849856666089563, -242.84465928085334, -18.537388746942415, -50.12187716453431, -54.708701857602804, -20.848731837568184, -205.58618650339176, 13.054481705221663, -36.951056029433424, -28.30583232363379, 5.959999999999958, -250.3985174574509, -535.5466339590865, -27.84536279745171, -27.024029987654565, -469.35489666034005, -99.55249364758028, -13.881196851134906, -3.614777358772306, -60.00721931639528, -28.06112652477996, -7.909211530419695, 116.0331442791108, 147.04920775019337, -21.257356579349757, 10.65760253100801, 2.0000000000000013, -861.1961050664177, 28.98877783101041, -16.607451881175876, -8.480759269126466, -14.393995585647938, -127.36546890991565, 134.27255514028107, -8.021673703981737, -90.186176637329, -19.795530890894337, -72.09308743293465, 21.01995443199438, -10.857439373695662, -39.56442210488008, 2.0000000000000013, -1.2892524016623073, 2.0000000000000013, -23.00980562065114, -105.29130789391596, -189.99776898158365, 180.82132526292378, -147.76224920086278, 14.3085260796815, -44.129453147335795, -125.1596203723813, -41.545165464894524, 2.75009115692621, -26.065511168905253, -160.96051682903962, -294.77429690021023, -0.9514599489018207, -92.17214161805589, -171.6131916267833, -465.91277193697647, -36.321276681928495, -34.55563331290351, -15.504062701827298, -260.18364785897245, -73.60484595803806, 175.0934700398952, -1.0755620852008858, -64.3148106444672, -36.89948160382421, -706.4888758375217, -206.79222154494258, -445.3500750546812, 5.558701632933587, -30.072203546141814, -10.225536184397917, 2.0000000000000013, 162.92843664612974, -343.94707406934236, -9.190278326320978, -30.05962612644155, -414.3387756294769, -37.34902344994647, 4.49410064392638, -551.9115712676868, -86.51121853498469, -519.282093722252, -194.71031184138553, -0.3042583556648504, -624.0437059381227, -2.745744349069418, 189.99046381711435, -1.7454723923773448, -1347.2821065309097, 18.830000000000286, -802.2588344296925, -153.24939833322262, -518.8942080942184, -34.998433808856085, -417.92820386674777, -540.8087238073177, -42.589783115880955, -920.5536914942816, -121.61203610712765, 34.723703374394425, -65.1761212264347, -17.61153090103011, -20.349547641519855, -202.59234968048605, -4.102296486767349, -23.77959138129766, -31.799615205639974, -798.536698860772, -582.7940545330921, 128.9078280984646, 2.0000000000000013, -747.3998647249603, -163.6439568861043, -181.52623688158394, -368.86243433533565, 2.0000000000000013, -559.9511202107368, 2.0000000000000013, -446.4478104271926, -353.7478696116708, -3.394815312673945, 9.919999999999963, -810.9144873696881, -22.961965330215946, 179.21, 189.02840382677886, 5.349533404389515, 193.89847076477926, -41.19045735454997, -35.98406632689637, 0.6448564568867198, 18.390091064568033, -996.2743262571515, -564.2030951494216, 25.30803704053217], "policy_predator_policy_reward": [33.545024991726706, 83.15638952839404, 2.370837940496536, 477.07278399280534, 197.9769362264539, 0.0, 94.10307247589103, 0.0, 30.609616362575988, 94.79907204580599, 24.175054287874165, 1.989959181443087, 16.708653345050127, 725.9711359052513, 1.804786398531144, 7.991661877813767, 12.035229159003006, 39.32048865169706, 44.14369886466353, 49.933495218026046, 34.1095629939061, 39.45138485658956, 63.622053340929895, 89.45651354026809, 68.16711997170017, 67.59292280606522, 145.60576835657852, 1088.448421813053, 148.10047858322088, 1033.4179437477512, 1143.0418558198828, 1100.570899884719, 927.597546808581, 884.2231403869754, 17.840644142420896, 345.7076286099029, 0.0, 0.0, 2.257456899749178, 0.0, 2.2058377556242954, 0.0, 56.48994236349343, 8.144248796055125, 6.751091910117514, 6.432768972794122, 685.3595883723721, 9.468469049741783, 28.496407722945822, 124.2483525930632, 21.480117660954118, 870.0916203304565, 0.0, 119.89068998688865, 47.02827245013015, 49.35415977734414, 48.98735715097825, 780.4224109395142, 225.13591597169204, 15.236439833578467, 15.789856666089522, 296.09465928085325, 20.457388746942716, 166.26187716453438, 56.568701857602434, 22.788731837568488, 7.342323713810324, 356.41014592790646, 38.97350781793526, 6.319053120440826, 0.0, 330.4085174574509, 544.7166339590864, 29.785362797452013, 28.89402998765485, 531.5048966603399, 96.74428627663056, 25.30940422208544, 5.594777358772264, 61.9172193163949, 29.96112652478026, 9.859211530419653, 63.809612839773465, 62.80903069401629, 23.14735657935005, 15.052397468991954, 458.0816042764884, 705.7989069320097, 59.26176825987334, 6.525683621302719, 10.037249496512679, 16.383978072373814, 129.0354689099151, 34.89744485971899, 9.981673703981695, 92.03617663732994, 10.710667859513741, 73.9530874329356, 131.06004556800565, 12.80743937369562, 41.4744221048797, 0.0, 3.269252401662281, 0.0, 105.51557608050263, 29.025604064868567, 280.18615150376905, 2.220292214890757, 230.00224920086254, 3.511473920318463, 193.22945314733573, 126.82962037238215, 43.29082574863569, 29.765742988534434, 267.2850116264179, 206.71430060767213, 354.9942969002099, 3.921459948901802, 164.04708680432051, 236.4130979193615, 493.1131495128632, 151.0799057485485, 4.224486577999617, 34.66170785592714, 4.019817360746252, 480.1784389695629, 16.906529960104784, 3.065562085200864, 66.17481064446815, 42.699481603823855, 863.7585359526973, 23.160982815141008, 493.5800750546813, 7.291298367066373, 0.0, 42.30948829498798, 0.0, 22.12156335387025, 423.9570740693424, 11.150278326320937, 0.0, 578.0191155751907, 39.25902344994609, 137.53589935607363, 604.02590039386, 0.0, 560.7206182756037, 54.1639460129265, 2.2942583556648466, 626.1637059381226, 4.725744349069377, 4.049536182885639, 3.7254723923773083, 1347.2821065309097, 0.0, 805.2588344296925, 84.15788420450949, 514.6854061121037, 43.251889140064044, 486.60463581628585, 546.8087238073177, 44.449783115880585, 954.5740484377795, 4.892892354209336, 114.27629662560558, 67.05612122643566, 0.0, 42.60915491673651, 284.59234968048617, 7.062296486767307, 25.69959138129796, 168.79961520564, 836.628804320134, 579.0256148730696, 29.362171901535433, 0.0, 765.2835140668865, 22.151521386539223, 467.66859997435756, 423.7503442239705, 0.0, 603.9511202107369, 0.0, 496.5078104271926, 424.7478696116708, 5.364815312673903, 0.0, 824.014487369688, 8.628634640496346, 56.60457875099076, 7.971596173221128, 14.410466595610448, 4.1015292352207355, 43.0504573545496, 37.92406632689598, 21.601634940458013, 10.289908935432228, 1007.2943262571515, 605.971441694753, 355.06249541109753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5451260175432935, "mean_inference_ms": 1.6157834691361421, "mean_action_processing_ms": 0.2567049289541287, "mean_env_wait_ms": 0.1865544026443332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005997776985168457, "StateBufferConnector_ms": 0.0030602216720581055, "ViewRequirementAgentConnector_ms": 0.09579586982727051}, "num_episodes": 18, "episode_return_max": 422.13887899696164, "episode_return_min": -331.3095924383861, "episode_return_mean": 71.84839132092715, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.22118923879066, "num_env_steps_trained_throughput_per_sec": 398.22118923879066, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 10392.634, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10392.6, "sample_time_ms": 1339.776, "learn_time_ms": 9038.326, "learn_throughput": 442.56, "synch_weights_time_ms": 13.768}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "74486_00000", "date": "2024-08-16_15-04-35", "timestamp": 1723800875, "time_this_iter_s": 10.050037860870361, "time_total_s": 543.6580820083618, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3972ebaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 543.6580820083618, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 30.228571428571424, "ram_util_percent": 79.83571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8106341565727555, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.614673675178851, "policy_loss": -0.008100027020062227, "vf_loss": 2.6221367948269716, "vf_explained_var": 0.05778959059210682, "kl": 0.012738081392547769, "entropy": 1.3154594657913088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.21781814990851, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5065707344857473, "policy_loss": -0.005692549496051417, "vf_loss": 1.511811688274303, "vf_explained_var": 0.015456999767394293, "kl": 0.006021271721526015, "entropy": 0.717734640552884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 422.13887899696164, "episode_reward_min": -287.06351957625543, "episode_reward_mean": 81.17224700398526, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1347.2821065309097, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.89847076477926, "predator_policy": 1347.2821065309097}, "policy_reward_mean": {"prey_policy": -122.89464954858659, "predator_policy": 163.48077305057922}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.870000000000072, 3.989999999999959, 167.34000000000006, 174.01999999999975, 3.9399999999999595, 24.190000000000005, 144.19000000000037, -287.06351957625543, 131.51000000000028, 15.181333928393899, -1.2625531048974277, 325.695288360015, 55.189999999999706, 118.06000000000064, 3.7999999999999625, 171.22076484354653, -19.96432741469045, 85.97000000000011, 11.109999999999971, 64.0199999999999, 8.619999999999932, 3.8899999999999597, 3.8499999999999615, 389.7009955630939, 27.600000000000545, 304.6844061420805, 78.16877783101147, 3.546472714112088, 170.83999999999997, 3.809999999999961, -7.224863031380975, 154.03000000000003, 3.9099999999999593, 3.979999999999959, 6.240066630802838, 273.23, 100.06000000000031, 150.76999999999998, 34.261494429201974, 286.97328423614437, 63.18999999999976, 136.6748514788442, 141.95900664250695, -11.173501580803965, 150.40976251329855, 193.98999999999967, 7.659999999999923, -26.361578614625962, 61.079999999999686, 2.0117485644479878, 187.04999999999973, 81.96999999999994, 133.62071381927166, 143.94000000000017, -34.396889408811155, -99.10784127510755, 4.109999999999963, 196.0199999999997, 1.979999999999988, 21.830000000000286, -73.30031611082767, 76.92988728074657, 7.8599999999999675, -82.69878680942001, 150.8800000000003, 4.648076374185916, 84.96000000000006, 138.9200000000004, 34.32366579933951, 160.26999999999995, -123.60878615763905, 341.03027298140927, 45.99999999999998, 52.05999999999995, 72.9699999999999, 23.02000000000023, 221.48124806127032, 216.75999999999948, 199.85999999999962, 24.18649139734527, 39.700000000000294, 422.13887899696164, 43.673874602211654, 122.18000000000066, 23.60000000000051, 22.082295760791258, 10.838385626436976, 12.869999999999923, 355.25694490605997, 74.96000000000107, 89.28745968888224, 99.90000000000106, 148.30999999999943, 50.471935885603294, 69.24999999999997, 98.90000000000036, 3.8099999999999614, 137.8800000000002, 146.18927842496612, 3.96999999999996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.929999999999959, 7.93999999999996, -0.26745689974918196, 2.0000000000000013, 163.13416224437577, 2.0000000000000013, 115.5800576365066, -6.194248796055165, -4.781091910117556, -4.462768972794164, -663.1195883723723, -7.5184690497418245, -26.55640772294552, 18.00164740693682, -451.1311673161328, -727.5040902515337, 2.0000000000000013, 9.619310013111578, -70.4743892682627, -10.726709030816751, -814.7045976333987, -15.967723561990546, -88.09591597169208, 173.4188485264366, -13.849856666089563, -242.84465928085334, -18.537388746942415, -50.12187716453431, -54.708701857602804, -20.848731837568184, -205.58618650339176, 13.054481705221663, -36.951056029433424, -28.30583232363379, 5.959999999999958, -250.3985174574509, -535.5466339590865, -27.84536279745171, -27.024029987654565, -469.35489666034005, -99.55249364758028, -13.881196851134906, -3.614777358772306, -60.00721931639528, -28.06112652477996, -7.909211530419695, 116.0331442791108, 147.04920775019337, -21.257356579349757, 10.65760253100801, 2.0000000000000013, -861.1961050664177, 28.98877783101041, -16.607451881175876, -8.480759269126466, -14.393995585647938, -127.36546890991565, 134.27255514028107, -8.021673703981737, -90.186176637329, -19.795530890894337, -72.09308743293465, 21.01995443199438, -10.857439373695662, -39.56442210488008, 2.0000000000000013, -1.2892524016623073, 2.0000000000000013, -23.00980562065114, -105.29130789391596, -189.99776898158365, 180.82132526292378, -147.76224920086278, 14.3085260796815, -44.129453147335795, -125.1596203723813, -41.545165464894524, 2.75009115692621, -26.065511168905253, -160.96051682903962, -294.77429690021023, -0.9514599489018207, -92.17214161805589, -171.6131916267833, -465.91277193697647, -36.321276681928495, -34.55563331290351, -15.504062701827298, -260.18364785897245, -73.60484595803806, 175.0934700398952, -1.0755620852008858, -64.3148106444672, -36.89948160382421, -706.4888758375217, -206.79222154494258, -445.3500750546812, 5.558701632933587, -30.072203546141814, -10.225536184397917, 2.0000000000000013, 162.92843664612974, -343.94707406934236, -9.190278326320978, -30.05962612644155, -414.3387756294769, -37.34902344994647, 4.49410064392638, -551.9115712676868, -86.51121853498469, -519.282093722252, -194.71031184138553, -0.3042583556648504, -624.0437059381227, -2.745744349069418, 189.99046381711435, -1.7454723923773448, -1347.2821065309097, 18.830000000000286, -802.2588344296925, -153.24939833322262, -518.8942080942184, -34.998433808856085, -417.92820386674777, -540.8087238073177, -42.589783115880955, -920.5536914942816, -121.61203610712765, 34.723703374394425, -65.1761212264347, -17.61153090103011, -20.349547641519855, -202.59234968048605, -4.102296486767349, -23.77959138129766, -31.799615205639974, -798.536698860772, -582.7940545330921, 128.9078280984646, 2.0000000000000013, -747.3998647249603, -163.6439568861043, -181.52623688158394, -368.86243433533565, 2.0000000000000013, -559.9511202107368, 2.0000000000000013, -446.4478104271926, -353.7478696116708, -3.394815312673945, 9.919999999999963, -810.9144873696881, -22.961965330215946, 179.21, 189.02840382677886, 5.349533404389515, 193.89847076477926, -41.19045735454997, -35.98406632689637, 0.6448564568867198, 18.390091064568033, -996.2743262571515, -564.2030951494216, 25.30803704053217, -856.9274518995675, -798.2613715869161, -43.88962510913321, -23.208389028374672, -43.33241734419753, 3.979999999999958, -56.93264274024803, -108.5545026045296, 2.0000000000000013, -15.17046677581167, 7.57032146270426, -2.5165996630894485, -0.8860189208541271, 165.9818441170426, -34.40871489127954, -0.8497635765489919, -30.639525861460275, 73.37545228355303, 77.91886231148311, -3.969148680357023, -23.551828201436454, 107.6447299157133, -9.688355775659502, -64.19353697527183, 0.2564197510881882, -313.24546778053826, 75.15777084847657, -14.097807793972889, -27.9498584557901, -19.19187170984478, -43.75440701979956, -40.59885306358592, 18.119278424966726, -119.64203788940493, -3.434233783560474, 2.0000000000000013], "policy_predator_policy_reward": [0.0, 0.0, 2.257456899749178, 0.0, 2.2058377556242954, 0.0, 56.48994236349343, 8.144248796055125, 6.751091910117514, 6.432768972794122, 685.3595883723721, 9.468469049741783, 28.496407722945822, 124.2483525930632, 21.480117660954118, 870.0916203304565, 0.0, 119.89068998688865, 47.02827245013015, 49.35415977734414, 48.98735715097825, 780.4224109395142, 225.13591597169204, 15.236439833578467, 15.789856666089522, 296.09465928085325, 20.457388746942716, 166.26187716453438, 56.568701857602434, 22.788731837568488, 7.342323713810324, 356.41014592790646, 38.97350781793526, 6.319053120440826, 0.0, 330.4085174574509, 544.7166339590864, 29.785362797452013, 28.89402998765485, 531.5048966603399, 96.74428627663056, 25.30940422208544, 5.594777358772264, 61.9172193163949, 29.96112652478026, 9.859211530419653, 63.809612839773465, 62.80903069401629, 23.14735657935005, 15.052397468991954, 458.0816042764884, 705.7989069320097, 59.26176825987334, 6.525683621302719, 10.037249496512679, 16.383978072373814, 129.0354689099151, 34.89744485971899, 9.981673703981695, 92.03617663732994, 10.710667859513741, 73.9530874329356, 131.06004556800565, 12.80743937369562, 41.4744221048797, 0.0, 3.269252401662281, 0.0, 105.51557608050263, 29.025604064868567, 280.18615150376905, 2.220292214890757, 230.00224920086254, 3.511473920318463, 193.22945314733573, 126.82962037238215, 43.29082574863569, 29.765742988534434, 267.2850116264179, 206.71430060767213, 354.9942969002099, 3.921459948901802, 164.04708680432051, 236.4130979193615, 493.1131495128632, 151.0799057485485, 4.224486577999617, 34.66170785592714, 4.019817360746252, 480.1784389695629, 16.906529960104784, 3.065562085200864, 66.17481064446815, 42.699481603823855, 863.7585359526973, 23.160982815141008, 493.5800750546813, 7.291298367066373, 0.0, 42.30948829498798, 0.0, 22.12156335387025, 423.9570740693424, 11.150278326320937, 0.0, 578.0191155751907, 39.25902344994609, 137.53589935607363, 604.02590039386, 0.0, 560.7206182756037, 54.1639460129265, 2.2942583556648466, 626.1637059381226, 4.725744349069377, 4.049536182885639, 3.7254723923773083, 1347.2821065309097, 0.0, 805.2588344296925, 84.15788420450949, 514.6854061121037, 43.251889140064044, 486.60463581628585, 546.8087238073177, 44.449783115880585, 954.5740484377795, 4.892892354209336, 114.27629662560558, 67.05612122643566, 0.0, 42.60915491673651, 284.59234968048617, 7.062296486767307, 25.69959138129796, 168.79961520564, 836.628804320134, 579.0256148730696, 29.362171901535433, 0.0, 765.2835140668865, 22.151521386539223, 467.66859997435756, 423.7503442239705, 0.0, 603.9511202107369, 0.0, 496.5078104271926, 424.7478696116708, 5.364815312673903, 0.0, 824.014487369688, 8.628634640496346, 56.60457875099076, 7.971596173221128, 14.410466595610448, 4.1015292352207355, 43.0504573545496, 37.92406632689598, 21.601634940458013, 10.289908935432228, 1007.2943262571515, 605.971441694753, 355.06249541109753, 753.6434975597383, 945.2192005289584, 154.27962510913318, 34.99838902837495, 33.17000586834113, 29.782411475856083, 110.04111490009701, 77.52832620547184, 20.07046677581182, 3.938385626437059, 3.3196785372957, 4.496599663089406, 127.9850935102807, 62.17602619959083, 100.47871489127934, 9.739763576548977, 44.55836306915411, 1.9931701976347913, 17.05113768851735, 8.899148680356982, 25.491828201436757, 38.72527008428688, 75.98417080700003, 48.369657829536145, 1.7335802489118133, 380.50546778053825, 4.244990077872629, 33.59504686762375, 29.819858455790392, 21.131871709845083, 144.08777310805326, 78.14548697533185, 162.34205705086305, 85.36998083854176, 5.404233783560433, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5450822538778104, "mean_inference_ms": 1.6184529133024455, "mean_action_processing_ms": 0.2561853221246264, "mean_env_wait_ms": 0.1865083166863394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005566239356994629, "StateBufferConnector_ms": 0.003090381622314453, "ViewRequirementAgentConnector_ms": 0.09644675254821777}, "num_episodes": 18, "episode_return_max": 422.13887899696164, "episode_return_min": -287.06351957625543, "episode_return_mean": 81.17224700398526, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.6022635921121, "num_env_steps_trained_throughput_per_sec": 390.6022635921121, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 10295.583, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10295.55, "sample_time_ms": 1330.956, "learn_time_ms": 8950.121, "learn_throughput": 446.921, "synch_weights_time_ms": 13.745}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "74486_00000", "date": "2024-08-16_15-04-45", "timestamp": 1723800885, "time_this_iter_s": 10.246196031570435, "time_total_s": 553.9042780399323, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3973283a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 553.9042780399323, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 25.613333333333337, "ram_util_percent": 79.59333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8227138971840895, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.451849974778594, "policy_loss": -0.007592071443007737, "vf_loss": 3.4587105927643953, "vf_explained_var": 0.4602615463985968, "kl": 0.014628981674063556, "entropy": 1.2869338574232878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2286194707193072, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0416744276802377, "policy_loss": -0.006485751421910233, "vf_loss": 1.0476766135642137, "vf_explained_var": 0.010716297607573252, "kl": 0.0064475392218471235, "entropy": 0.7949482839574259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 422.13887899696164, "episode_reward_min": -123.60878615763905, "episode_reward_mean": 88.26040282900749, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1347.2821065309097, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.89847076477926, "predator_policy": 1347.2821065309097}, "policy_reward_mean": {"prey_policy": -100.47363252527936, "predator_policy": 144.6038339397831}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8499999999999615, 389.7009955630939, 27.600000000000545, 304.6844061420805, 78.16877783101147, 3.546472714112088, 170.83999999999997, 3.809999999999961, -7.224863031380975, 154.03000000000003, 3.9099999999999593, 3.979999999999959, 6.240066630802838, 273.23, 100.06000000000031, 150.76999999999998, 34.261494429201974, 286.97328423614437, 63.18999999999976, 136.6748514788442, 141.95900664250695, -11.173501580803965, 150.40976251329855, 193.98999999999967, 7.659999999999923, -26.361578614625962, 61.079999999999686, 2.0117485644479878, 187.04999999999973, 81.96999999999994, 133.62071381927166, 143.94000000000017, -34.396889408811155, -99.10784127510755, 4.109999999999963, 196.0199999999997, 1.979999999999988, 21.830000000000286, -73.30031611082767, 76.92988728074657, 7.8599999999999675, -82.69878680942001, 150.8800000000003, 4.648076374185916, 84.96000000000006, 138.9200000000004, 34.32366579933951, 160.26999999999995, -123.60878615763905, 341.03027298140927, 45.99999999999998, 52.05999999999995, 72.9699999999999, 23.02000000000023, 221.48124806127032, 216.75999999999948, 199.85999999999962, 24.18649139734527, 39.700000000000294, 422.13887899696164, 43.673874602211654, 122.18000000000066, 23.60000000000051, 22.082295760791258, 10.838385626436976, 12.869999999999923, 355.25694490605997, 74.96000000000107, 89.28745968888224, 99.90000000000106, 148.30999999999943, 50.471935885603294, 69.24999999999997, 98.90000000000036, 3.8099999999999614, 137.8800000000002, 146.18927842496612, 3.96999999999996, 102.09000000000015, 185.07999999999976, 11.290212267430615, 3.7699999999999605, 165.0900000000001, 142.25000000000048, 121.98000000000025, 3.989999999999959, 15.391258810992815, 11.578630817961736, 164.28999999999942, 102.50480323144892, 19.689608758757966, 186.03999999999968, 3.8299999999999597, 253.3528636492209, 114.09245209028462, 3.839999999999962, 110.63000000000078, 184.0199999999998, 8.782739912238403, 15.74999999999992], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.06112652477996, -7.909211530419695, 116.0331442791108, 147.04920775019337, -21.257356579349757, 10.65760253100801, 2.0000000000000013, -861.1961050664177, 28.98877783101041, -16.607451881175876, -8.480759269126466, -14.393995585647938, -127.36546890991565, 134.27255514028107, -8.021673703981737, -90.186176637329, -19.795530890894337, -72.09308743293465, 21.01995443199438, -10.857439373695662, -39.56442210488008, 2.0000000000000013, -1.2892524016623073, 2.0000000000000013, -23.00980562065114, -105.29130789391596, -189.99776898158365, 180.82132526292378, -147.76224920086278, 14.3085260796815, -44.129453147335795, -125.1596203723813, -41.545165464894524, 2.75009115692621, -26.065511168905253, -160.96051682903962, -294.77429690021023, -0.9514599489018207, -92.17214161805589, -171.6131916267833, -465.91277193697647, -36.321276681928495, -34.55563331290351, -15.504062701827298, -260.18364785897245, -73.60484595803806, 175.0934700398952, -1.0755620852008858, -64.3148106444672, -36.89948160382421, -706.4888758375217, -206.79222154494258, -445.3500750546812, 5.558701632933587, -30.072203546141814, -10.225536184397917, 2.0000000000000013, 162.92843664612974, -343.94707406934236, -9.190278326320978, -30.05962612644155, -414.3387756294769, -37.34902344994647, 4.49410064392638, -551.9115712676868, -86.51121853498469, -519.282093722252, -194.71031184138553, -0.3042583556648504, -624.0437059381227, -2.745744349069418, 189.99046381711435, -1.7454723923773448, -1347.2821065309097, 18.830000000000286, -802.2588344296925, -153.24939833322262, -518.8942080942184, -34.998433808856085, -417.92820386674777, -540.8087238073177, -42.589783115880955, -920.5536914942816, -121.61203610712765, 34.723703374394425, -65.1761212264347, -17.61153090103011, -20.349547641519855, -202.59234968048605, -4.102296486767349, -23.77959138129766, -31.799615205639974, -798.536698860772, -582.7940545330921, 128.9078280984646, 2.0000000000000013, -747.3998647249603, -163.6439568861043, -181.52623688158394, -368.86243433533565, 2.0000000000000013, -559.9511202107368, 2.0000000000000013, -446.4478104271926, -353.7478696116708, -3.394815312673945, 9.919999999999963, -810.9144873696881, -22.961965330215946, 179.21, 189.02840382677886, 5.349533404389515, 193.89847076477926, -41.19045735454997, -35.98406632689637, 0.6448564568867198, 18.390091064568033, -996.2743262571515, -564.2030951494216, 25.30803704053217, -856.9274518995675, -798.2613715869161, -43.88962510913321, -23.208389028374672, -43.33241734419753, 3.979999999999958, -56.93264274024803, -108.5545026045296, 2.0000000000000013, -15.17046677581167, 7.57032146270426, -2.5165996630894485, -0.8860189208541271, 165.9818441170426, -34.40871489127954, -0.8497635765489919, -30.639525861460275, 73.37545228355303, 77.91886231148311, -3.969148680357023, -23.551828201436454, 107.6447299157133, -9.688355775659502, -64.19353697527183, 0.2564197510881882, -313.24546778053826, 75.15777084847657, -14.097807793972889, -27.9498584557901, -19.19187170984478, -43.75440701979956, -40.59885306358592, 18.119278424966726, -119.64203788940493, -3.434233783560474, 2.0000000000000013, -181.4175378658448, -4.141078863641367, -64.42029115399038, 183.17000000000002, -23.414920562765698, 2.0000000000000013, -64.34393196539075, 2.0000000000000013, 2.0000000000000013, 91.40472882889398, 74.4562562089046, -18.90854726627551, -15.079780230276201, -148.3036763339214, 2.0000000000000013, -0.1794306286616616, 2.0000000000000013, -82.23971032836323, 2.0000000000000013, -10.719678931239425, 135.71414522415137, 2.0000000000000013, 0.37202831795676133, -94.99566301110355, -6.865139482257405, -53.010280022257945, 156.55883224015847, 2.0000000000000013, 2.0000000000000013, -79.82684266687025, -44.612853123835265, 0.846667131878627, -15.278340803732798, 106.39899795943519, -21.970702339447712, -19.02941242176929, -7.083159846094706, 52.72679995917589, 172.6629573738167, -34.69608990030458, -4.788525086700125, -26.960223323973487, 10.008559247564133, -24.67628734270134], "policy_predator_policy_reward": [29.96112652478026, 9.859211530419653, 63.809612839773465, 62.80903069401629, 23.14735657935005, 15.052397468991954, 458.0816042764884, 705.7989069320097, 59.26176825987334, 6.525683621302719, 10.037249496512679, 16.383978072373814, 129.0354689099151, 34.89744485971899, 9.981673703981695, 92.03617663732994, 10.710667859513741, 73.9530874329356, 131.06004556800565, 12.80743937369562, 41.4744221048797, 0.0, 3.269252401662281, 0.0, 105.51557608050263, 29.025604064868567, 280.18615150376905, 2.220292214890757, 230.00224920086254, 3.511473920318463, 193.22945314733573, 126.82962037238215, 43.29082574863569, 29.765742988534434, 267.2850116264179, 206.71430060767213, 354.9942969002099, 3.921459948901802, 164.04708680432051, 236.4130979193615, 493.1131495128632, 151.0799057485485, 4.224486577999617, 34.66170785592714, 4.019817360746252, 480.1784389695629, 16.906529960104784, 3.065562085200864, 66.17481064446815, 42.699481603823855, 863.7585359526973, 23.160982815141008, 493.5800750546813, 7.291298367066373, 0.0, 42.30948829498798, 0.0, 22.12156335387025, 423.9570740693424, 11.150278326320937, 0.0, 578.0191155751907, 39.25902344994609, 137.53589935607363, 604.02590039386, 0.0, 560.7206182756037, 54.1639460129265, 2.2942583556648466, 626.1637059381226, 4.725744349069377, 4.049536182885639, 3.7254723923773083, 1347.2821065309097, 0.0, 805.2588344296925, 84.15788420450949, 514.6854061121037, 43.251889140064044, 486.60463581628585, 546.8087238073177, 44.449783115880585, 954.5740484377795, 4.892892354209336, 114.27629662560558, 67.05612122643566, 0.0, 42.60915491673651, 284.59234968048617, 7.062296486767307, 25.69959138129796, 168.79961520564, 836.628804320134, 579.0256148730696, 29.362171901535433, 0.0, 765.2835140668865, 22.151521386539223, 467.66859997435756, 423.7503442239705, 0.0, 603.9511202107369, 0.0, 496.5078104271926, 424.7478696116708, 5.364815312673903, 0.0, 824.014487369688, 8.628634640496346, 56.60457875099076, 7.971596173221128, 14.410466595610448, 4.1015292352207355, 43.0504573545496, 37.92406632689598, 21.601634940458013, 10.289908935432228, 1007.2943262571515, 605.971441694753, 355.06249541109753, 753.6434975597383, 945.2192005289584, 154.27962510913318, 34.99838902837495, 33.17000586834113, 29.782411475856083, 110.04111490009701, 77.52832620547184, 20.07046677581182, 3.938385626437059, 3.3196785372957, 4.496599663089406, 127.9850935102807, 62.17602619959083, 100.47871489127934, 9.739763576548977, 44.55836306915411, 1.9931701976347913, 17.05113768851735, 8.899148680356982, 25.491828201436757, 38.72527008428688, 75.98417080700003, 48.369657829536145, 1.7335802489118133, 380.50546778053825, 4.244990077872629, 33.59504686762375, 29.819858455790392, 21.131871709845083, 144.08777310805326, 78.14548697533185, 162.34205705086305, 85.36998083854176, 5.404233783560433, 0.0, 281.5375378658446, 6.111078863641325, 66.33029115399135, 0.0, 10.905219720665738, 21.799913109530962, 66.11393196539157, 0.0, 62.69413682138782, 8.991134349718182, 65.88374379109538, 20.818547266275807, 269.0602734386812, 16.303183125516533, 0.0, 2.1694306286616603, 79.59184795858349, 16.03912118077356, 12.659678931239384, 7.638630817961818, 26.575854775848388, 0.0, 73.97170939544277, 123.15672852915212, 32.95802539876229, 46.60700286451004, 27.48116775984149, 0.0, 0.0, 81.65684266687119, 125.92324309765542, 171.19580654352308, 17.228340803732973, 5.743454130848774, 23.900702339448014, 20.939412421769582, 50.922142535457894, 14.064217351460751, 6.517042626183334, 39.53608990030421, 11.64126499893857, 28.89022332397379, 3.8514407524358276, 26.566287342701635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5449704696458112, "mean_inference_ms": 1.6213613018417958, "mean_action_processing_ms": 0.2555609042464699, "mean_env_wait_ms": 0.1864208427416738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005116939544677734, "StateBufferConnector_ms": 0.0029337406158447266, "ViewRequirementAgentConnector_ms": 0.08914411067962646}, "num_episodes": 22, "episode_return_max": 422.13887899696164, "episode_return_min": -123.60878615763905, "episode_return_mean": 88.26040282900749, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.119901453831, "num_env_steps_trained_throughput_per_sec": 406.119901453831, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 10234.276, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10234.241, "sample_time_ms": 1314.513, "learn_time_ms": 8905.2, "learn_throughput": 449.176, "synch_weights_time_ms": 13.79}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "74486_00000", "date": "2024-08-16_15-04-55", "timestamp": 1723800895, "time_this_iter_s": 9.856842041015625, "time_total_s": 563.7611200809479, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39800b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 563.7611200809479, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 25.264285714285716, "ram_util_percent": 79.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.425417356705539, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.8151085568483545, "policy_loss": -0.009377077102005757, "vf_loss": 5.823891733310841, "vf_explained_var": 0.20312874090103877, "kl": 0.011877987900789498, "entropy": 1.280694820199694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0914314227917838, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.351025757587776, "policy_loss": -0.011093602604454472, "vf_loss": 2.3614319498576815, "vf_explained_var": 0.004508698585802916, "kl": 0.009165456230744204, "entropy": 0.7590577303101776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 422.13887899696164, "episode_reward_min": -123.60878615763905, "episode_reward_mean": 99.55342171083619, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1347.2821065309097, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.89847076477926, "predator_policy": 1347.2821065309097}, "policy_reward_mean": {"prey_policy": -86.95466790740821, "predator_policy": 136.73137876282632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.98999999999967, 7.659999999999923, -26.361578614625962, 61.079999999999686, 2.0117485644479878, 187.04999999999973, 81.96999999999994, 133.62071381927166, 143.94000000000017, -34.396889408811155, -99.10784127510755, 4.109999999999963, 196.0199999999997, 1.979999999999988, 21.830000000000286, -73.30031611082767, 76.92988728074657, 7.8599999999999675, -82.69878680942001, 150.8800000000003, 4.648076374185916, 84.96000000000006, 138.9200000000004, 34.32366579933951, 160.26999999999995, -123.60878615763905, 341.03027298140927, 45.99999999999998, 52.05999999999995, 72.9699999999999, 23.02000000000023, 221.48124806127032, 216.75999999999948, 199.85999999999962, 24.18649139734527, 39.700000000000294, 422.13887899696164, 43.673874602211654, 122.18000000000066, 23.60000000000051, 22.082295760791258, 10.838385626436976, 12.869999999999923, 355.25694490605997, 74.96000000000107, 89.28745968888224, 99.90000000000106, 148.30999999999943, 50.471935885603294, 69.24999999999997, 98.90000000000036, 3.8099999999999614, 137.8800000000002, 146.18927842496612, 3.96999999999996, 102.09000000000015, 185.07999999999976, 11.290212267430615, 3.7699999999999605, 165.0900000000001, 142.25000000000048, 121.98000000000025, 3.989999999999959, 15.391258810992815, 11.578630817961736, 164.28999999999942, 102.50480323144892, 19.689608758757966, 186.03999999999968, 3.8299999999999597, 253.3528636492209, 114.09245209028462, 3.839999999999962, 110.63000000000078, 184.0199999999998, 8.782739912238403, 15.74999999999992, 141.55999999999995, 89.8000000000001, 92.3200000000005, 175.11999999999978, 186.96999999999974, 216.16999999999928, 147.40109534044961, 5.361186054264359, 3.8099999999999605, 134.49000000000024, 383.01, 379.7134376514887, 285.8366809847142, 252.69620429069008, 279.1295788576924, -14.373941188701577, 32.66919084823606, 151.0399999999999, 243.5799999999997, 43.70000000000022, 192.8799999999997, 134.4892089129491, 41.41999999999954], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [175.0934700398952, -1.0755620852008858, -64.3148106444672, -36.89948160382421, -706.4888758375217, -206.79222154494258, -445.3500750546812, 5.558701632933587, -30.072203546141814, -10.225536184397917, 2.0000000000000013, 162.92843664612974, -343.94707406934236, -9.190278326320978, -30.05962612644155, -414.3387756294769, -37.34902344994647, 4.49410064392638, -551.9115712676868, -86.51121853498469, -519.282093722252, -194.71031184138553, -0.3042583556648504, -624.0437059381227, -2.745744349069418, 189.99046381711435, -1.7454723923773448, -1347.2821065309097, 18.830000000000286, -802.2588344296925, -153.24939833322262, -518.8942080942184, -34.998433808856085, -417.92820386674777, -540.8087238073177, -42.589783115880955, -920.5536914942816, -121.61203610712765, 34.723703374394425, -65.1761212264347, -17.61153090103011, -20.349547641519855, -202.59234968048605, -4.102296486767349, -23.77959138129766, -31.799615205639974, -798.536698860772, -582.7940545330921, 128.9078280984646, 2.0000000000000013, -747.3998647249603, -163.6439568861043, -181.52623688158394, -368.86243433533565, 2.0000000000000013, -559.9511202107368, 2.0000000000000013, -446.4478104271926, -353.7478696116708, -3.394815312673945, 9.919999999999963, -810.9144873696881, -22.961965330215946, 179.21, 189.02840382677886, 5.349533404389515, 193.89847076477926, -41.19045735454997, -35.98406632689637, 0.6448564568867198, 18.390091064568033, -996.2743262571515, -564.2030951494216, 25.30803704053217, -856.9274518995675, -798.2613715869161, -43.88962510913321, -23.208389028374672, -43.33241734419753, 3.979999999999958, -56.93264274024803, -108.5545026045296, 2.0000000000000013, -15.17046677581167, 7.57032146270426, -2.5165996630894485, -0.8860189208541271, 165.9818441170426, -34.40871489127954, -0.8497635765489919, -30.639525861460275, 73.37545228355303, 77.91886231148311, -3.969148680357023, -23.551828201436454, 107.6447299157133, -9.688355775659502, -64.19353697527183, 0.2564197510881882, -313.24546778053826, 75.15777084847657, -14.097807793972889, -27.9498584557901, -19.19187170984478, -43.75440701979956, -40.59885306358592, 18.119278424966726, -119.64203788940493, -3.434233783560474, 2.0000000000000013, -181.4175378658448, -4.141078863641367, -64.42029115399038, 183.17000000000002, -23.414920562765698, 2.0000000000000013, -64.34393196539075, 2.0000000000000013, 2.0000000000000013, 91.40472882889398, 74.4562562089046, -18.90854726627551, -15.079780230276201, -148.3036763339214, 2.0000000000000013, -0.1794306286616616, 2.0000000000000013, -82.23971032836323, 2.0000000000000013, -10.719678931239425, 135.71414522415137, 2.0000000000000013, 0.37202831795676133, -94.99566301110355, -6.865139482257405, -53.010280022257945, 156.55883224015847, 2.0000000000000013, 2.0000000000000013, -79.82684266687025, -44.612853123835265, 0.846667131878627, -15.278340803732798, 106.39899795943519, -21.970702339447712, -19.02941242176929, -7.083159846094706, 52.72679995917589, 172.6629573738167, -34.69608990030458, -4.788525086700125, -26.960223323973487, 10.008559247564133, -24.67628734270134, -269.61293834436253, 45.50757833722919, -354.4569227967336, -14.566423519364967, -69.3117512212729, -54.22532017044881, -36.45351846539797, 173.26999999999998, 143.69478845449768, -2.973619378322189, 89.12000000000057, -240.99115756600781, -9.541605095285636, -161.90470441366315, -30.256817417884125, -14.197402423856893, -44.096028323808206, -6.929271894460012, 93.98980349975798, 2.0000000000000013, 158.99880446880698, 193.59552536971717, 177.1255947016898, 176.855192987077, 140.07812316826391, -25.48158831192403, -9.621571701547168, 46.2669779181586, 82.0958440842244, 190.31622596734144, -45.51935965401792, -62.565754652733034, 2.0000000000000013, -50.97909884822281, -14.605923490448447, 31.56447129729333, 177.3539910073306, -248.79872072659828, -134.6254780255693, -12.387043662318087, 165.3208590407086, -51.02868567057512, -226.0440375629032, -163.0952281553777, 8.53886738687056, -14.32235327488728], "policy_predator_policy_reward": [16.906529960104784, 3.065562085200864, 66.17481064446815, 42.699481603823855, 863.7585359526973, 23.160982815141008, 493.5800750546813, 7.291298367066373, 0.0, 42.30948829498798, 0.0, 22.12156335387025, 423.9570740693424, 11.150278326320937, 0.0, 578.0191155751907, 39.25902344994609, 137.53589935607363, 604.02590039386, 0.0, 560.7206182756037, 54.1639460129265, 2.2942583556648466, 626.1637059381226, 4.725744349069377, 4.049536182885639, 3.7254723923773083, 1347.2821065309097, 0.0, 805.2588344296925, 84.15788420450949, 514.6854061121037, 43.251889140064044, 486.60463581628585, 546.8087238073177, 44.449783115880585, 954.5740484377795, 4.892892354209336, 114.27629662560558, 67.05612122643566, 0.0, 42.60915491673651, 284.59234968048617, 7.062296486767307, 25.69959138129796, 168.79961520564, 836.628804320134, 579.0256148730696, 29.362171901535433, 0.0, 765.2835140668865, 22.151521386539223, 467.66859997435756, 423.7503442239705, 0.0, 603.9511202107369, 0.0, 496.5078104271926, 424.7478696116708, 5.364815312673903, 0.0, 824.014487369688, 8.628634640496346, 56.60457875099076, 7.971596173221128, 14.410466595610448, 4.1015292352207355, 43.0504573545496, 37.92406632689598, 21.601634940458013, 10.289908935432228, 1007.2943262571515, 605.971441694753, 355.06249541109753, 753.6434975597383, 945.2192005289584, 154.27962510913318, 34.99838902837495, 33.17000586834113, 29.782411475856083, 110.04111490009701, 77.52832620547184, 20.07046677581182, 3.938385626437059, 3.3196785372957, 4.496599663089406, 127.9850935102807, 62.17602619959083, 100.47871489127934, 9.739763576548977, 44.55836306915411, 1.9931701976347913, 17.05113768851735, 8.899148680356982, 25.491828201436757, 38.72527008428688, 75.98417080700003, 48.369657829536145, 1.7335802489118133, 380.50546778053825, 4.244990077872629, 33.59504686762375, 29.819858455790392, 21.131871709845083, 144.08777310805326, 78.14548697533185, 162.34205705086305, 85.36998083854176, 5.404233783560433, 0.0, 281.5375378658446, 6.111078863641325, 66.33029115399135, 0.0, 10.905219720665738, 21.799913109530962, 66.11393196539157, 0.0, 62.69413682138782, 8.991134349718182, 65.88374379109538, 20.818547266275807, 269.0602734386812, 16.303183125516533, 0.0, 2.1694306286616603, 79.59184795858349, 16.03912118077356, 12.659678931239384, 7.638630817961818, 26.575854775848388, 0.0, 73.97170939544277, 123.15672852915212, 32.95802539876229, 46.60700286451004, 27.48116775984149, 0.0, 0.0, 81.65684266687119, 125.92324309765542, 171.19580654352308, 17.228340803732973, 5.743454130848774, 23.900702339448014, 20.939412421769582, 50.922142535457894, 14.064217351460751, 6.517042626183334, 39.53608990030421, 11.64126499893857, 28.89022332397379, 3.8514407524358276, 26.566287342701635, 133.95688799829148, 231.7084720088421, 431.4569227967336, 27.366423519364993, 159.7217512212731, 56.13532017044843, 38.3035184653976, 0.0, 26.710778605627095, 19.538052318197366, 0.0, 368.04115756600777, 243.8498956056292, 74.99750924376907, 40.776230320036646, 9.039175575969217, 13.016437856178285, 41.81886236208955, 38.500196500242076, 0.0, 26.011195531193035, 4.404474630282824, 15.50393250820193, 10.22871745451991, 6.083173454161399, 165.1569726742132, 173.89035962363582, 42.1604384504428, 6.717508806128221, 0.0, 91.66518938477634, 2.0459837332721773, 44.45015880776843, 37.19813088868972, 92.08291332592907, 41.99853886722609, 16.646008992669408, 298.37872072659775, 176.3854780255686, 14.327043662318045, 25.6791409592914, 52.90868567057475, 201.45005718336947, 322.17841744786006, 16.808085073957802, 30.39540081405893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5449974598670344, "mean_inference_ms": 1.624647464731119, "mean_action_processing_ms": 0.2549850794717406, "mean_env_wait_ms": 0.18634873653984066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038976669311523438, "StateBufferConnector_ms": 0.00302886962890625, "ViewRequirementAgentConnector_ms": 0.09345602989196777}, "num_episodes": 23, "episode_return_max": 422.13887899696164, "episode_return_min": -123.60878615763905, "episode_return_mean": 99.55342171083619, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.9337903515061, "num_env_steps_trained_throughput_per_sec": 388.9337903515061, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 10232.612, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10232.578, "sample_time_ms": 1308.937, "learn_time_ms": 8908.711, "learn_throughput": 448.999, "synch_weights_time_ms": 14.2}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "74486_00000", "date": "2024-08-16_15-05-05", "timestamp": 1723800905, "time_this_iter_s": 10.289040803909302, "time_total_s": 574.0501608848572, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397740940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 574.0501608848572, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 29.935714285714283, "ram_util_percent": 79.35714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.388719061411247, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7970464587842345, "policy_loss": -0.0038026418758644945, "vf_loss": 6.800400917113773, "vf_explained_var": -0.10263432951831312, "kl": 0.008963804087935973, "entropy": 1.2726032863849055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3128750525454365, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8790337326665405, "policy_loss": -0.009646534852230201, "vf_loss": 3.887858941567638, "vf_explained_var": 0.00925231314210034, "kl": 0.010950978006496555, "entropy": 0.6580744547503335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 422.13887899696164, "episode_reward_min": -123.60878615763905, "episode_reward_mean": 118.53017555285163, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -996.2743262571515, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1007.2943262571515}, "policy_reward_mean": {"prey_policy": -60.46555850617711, "predator_policy": 119.73064628260293}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.69878680942001, 150.8800000000003, 4.648076374185916, 84.96000000000006, 138.9200000000004, 34.32366579933951, 160.26999999999995, -123.60878615763905, 341.03027298140927, 45.99999999999998, 52.05999999999995, 72.9699999999999, 23.02000000000023, 221.48124806127032, 216.75999999999948, 199.85999999999962, 24.18649139734527, 39.700000000000294, 422.13887899696164, 43.673874602211654, 122.18000000000066, 23.60000000000051, 22.082295760791258, 10.838385626436976, 12.869999999999923, 355.25694490605997, 74.96000000000107, 89.28745968888224, 99.90000000000106, 148.30999999999943, 50.471935885603294, 69.24999999999997, 98.90000000000036, 3.8099999999999614, 137.8800000000002, 146.18927842496612, 3.96999999999996, 102.09000000000015, 185.07999999999976, 11.290212267430615, 3.7699999999999605, 165.0900000000001, 142.25000000000048, 121.98000000000025, 3.989999999999959, 15.391258810992815, 11.578630817961736, 164.28999999999942, 102.50480323144892, 19.689608758757966, 186.03999999999968, 3.8299999999999597, 253.3528636492209, 114.09245209028462, 3.839999999999962, 110.63000000000078, 184.0199999999998, 8.782739912238403, 15.74999999999992, 141.55999999999995, 89.8000000000001, 92.3200000000005, 175.11999999999978, 186.96999999999974, 216.16999999999928, 147.40109534044961, 5.361186054264359, 3.8099999999999605, 134.49000000000024, 383.01, 379.7134376514887, 285.8366809847142, 252.69620429069008, 279.1295788576924, -14.373941188701577, 32.66919084823606, 151.0399999999999, 243.5799999999997, 43.70000000000022, 192.8799999999997, 134.4892089129491, 41.41999999999954, 190.80999999999966, 89.16257871189715, 199.88999999999965, 269.00883714229866, 349.3294192586899, -112.7211219220166, 96.05000000000037, 3.7699999999999663, 128.0000000000002, -51.250718676109585, 177.99999999999983, 163.92644289165924, 77.30741667789482, 295.53952150613515, 348.31, 353.92873286618794, 201.9999999999996, 3.4999999999999676], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-920.5536914942816, -121.61203610712765, 34.723703374394425, -65.1761212264347, -17.61153090103011, -20.349547641519855, -202.59234968048605, -4.102296486767349, -23.77959138129766, -31.799615205639974, -798.536698860772, -582.7940545330921, 128.9078280984646, 2.0000000000000013, -747.3998647249603, -163.6439568861043, -181.52623688158394, -368.86243433533565, 2.0000000000000013, -559.9511202107368, 2.0000000000000013, -446.4478104271926, -353.7478696116708, -3.394815312673945, 9.919999999999963, -810.9144873696881, -22.961965330215946, 179.21, 189.02840382677886, 5.349533404389515, 193.89847076477926, -41.19045735454997, -35.98406632689637, 0.6448564568867198, 18.390091064568033, -996.2743262571515, -564.2030951494216, 25.30803704053217, -856.9274518995675, -798.2613715869161, -43.88962510913321, -23.208389028374672, -43.33241734419753, 3.979999999999958, -56.93264274024803, -108.5545026045296, 2.0000000000000013, -15.17046677581167, 7.57032146270426, -2.5165996630894485, -0.8860189208541271, 165.9818441170426, -34.40871489127954, -0.8497635765489919, -30.639525861460275, 73.37545228355303, 77.91886231148311, -3.969148680357023, -23.551828201436454, 107.6447299157133, -9.688355775659502, -64.19353697527183, 0.2564197510881882, -313.24546778053826, 75.15777084847657, -14.097807793972889, -27.9498584557901, -19.19187170984478, -43.75440701979956, -40.59885306358592, 18.119278424966726, -119.64203788940493, -3.434233783560474, 2.0000000000000013, -181.4175378658448, -4.141078863641367, -64.42029115399038, 183.17000000000002, -23.414920562765698, 2.0000000000000013, -64.34393196539075, 2.0000000000000013, 2.0000000000000013, 91.40472882889398, 74.4562562089046, -18.90854726627551, -15.079780230276201, -148.3036763339214, 2.0000000000000013, -0.1794306286616616, 2.0000000000000013, -82.23971032836323, 2.0000000000000013, -10.719678931239425, 135.71414522415137, 2.0000000000000013, 0.37202831795676133, -94.99566301110355, -6.865139482257405, -53.010280022257945, 156.55883224015847, 2.0000000000000013, 2.0000000000000013, -79.82684266687025, -44.612853123835265, 0.846667131878627, -15.278340803732798, 106.39899795943519, -21.970702339447712, -19.02941242176929, -7.083159846094706, 52.72679995917589, 172.6629573738167, -34.69608990030458, -4.788525086700125, -26.960223323973487, 10.008559247564133, -24.67628734270134, -269.61293834436253, 45.50757833722919, -354.4569227967336, -14.566423519364967, -69.3117512212729, -54.22532017044881, -36.45351846539797, 173.26999999999998, 143.69478845449768, -2.973619378322189, 89.12000000000057, -240.99115756600781, -9.541605095285636, -161.90470441366315, -30.256817417884125, -14.197402423856893, -44.096028323808206, -6.929271894460012, 93.98980349975798, 2.0000000000000013, 158.99880446880698, 193.59552536971717, 177.1255947016898, 176.855192987077, 140.07812316826391, -25.48158831192403, -9.621571701547168, 46.2669779181586, 82.0958440842244, 190.31622596734144, -45.51935965401792, -62.565754652733034, 2.0000000000000013, -50.97909884822281, -14.605923490448447, 31.56447129729333, 177.3539910073306, -248.79872072659828, -134.6254780255693, -12.387043662318087, 165.3208590407086, -51.02868567057512, -226.0440375629032, -163.0952281553777, 8.53886738687056, -14.32235327488728, -74.59755099032631, 183.68634892132502, -287.2717354854439, -360.11369973162147, -61.027584312151134, 198.01999999999998, -438.4984124339495, -362.33134822211673, 176.63438190026244, 153.94208080652317, -574.7048023468029, -181.83648563538117, -2.558462080208331, -153.3344793072285, -21.935314658307462, -51.74228312622295, -30.359278537963306, 2.0000000000000013, -236.60548363096217, -360.3193168488228, 148.84073591359424, -36.44142811191038, 10.832934694110307, -6.125284219343609, -312.98758644898464, -84.18413013721431, -125.71483473352356, 121.35898520945769, 127.07460785303184, 130.92894177030988, 115.93403829885713, 57.6702136689752, 2.0000000000000013, 200.0, -16.872124825050605, -168.01220267778453], "policy_predator_policy_reward": [954.5740484377795, 4.892892354209336, 114.27629662560558, 67.05612122643566, 0.0, 42.60915491673651, 284.59234968048617, 7.062296486767307, 25.69959138129796, 168.79961520564, 836.628804320134, 579.0256148730696, 29.362171901535433, 0.0, 765.2835140668865, 22.151521386539223, 467.66859997435756, 423.7503442239705, 0.0, 603.9511202107369, 0.0, 496.5078104271926, 424.7478696116708, 5.364815312673903, 0.0, 824.014487369688, 8.628634640496346, 56.60457875099076, 7.971596173221128, 14.410466595610448, 4.1015292352207355, 43.0504573545496, 37.92406632689598, 21.601634940458013, 10.289908935432228, 1007.2943262571515, 605.971441694753, 355.06249541109753, 753.6434975597383, 945.2192005289584, 154.27962510913318, 34.99838902837495, 33.17000586834113, 29.782411475856083, 110.04111490009701, 77.52832620547184, 20.07046677581182, 3.938385626437059, 3.3196785372957, 4.496599663089406, 127.9850935102807, 62.17602619959083, 100.47871489127934, 9.739763576548977, 44.55836306915411, 1.9931701976347913, 17.05113768851735, 8.899148680356982, 25.491828201436757, 38.72527008428688, 75.98417080700003, 48.369657829536145, 1.7335802489118133, 380.50546778053825, 4.244990077872629, 33.59504686762375, 29.819858455790392, 21.131871709845083, 144.08777310805326, 78.14548697533185, 162.34205705086305, 85.36998083854176, 5.404233783560433, 0.0, 281.5375378658446, 6.111078863641325, 66.33029115399135, 0.0, 10.905219720665738, 21.799913109530962, 66.11393196539157, 0.0, 62.69413682138782, 8.991134349718182, 65.88374379109538, 20.818547266275807, 269.0602734386812, 16.303183125516533, 0.0, 2.1694306286616603, 79.59184795858349, 16.03912118077356, 12.659678931239384, 7.638630817961818, 26.575854775848388, 0.0, 73.97170939544277, 123.15672852915212, 32.95802539876229, 46.60700286451004, 27.48116775984149, 0.0, 0.0, 81.65684266687119, 125.92324309765542, 171.19580654352308, 17.228340803732973, 5.743454130848774, 23.900702339448014, 20.939412421769582, 50.922142535457894, 14.064217351460751, 6.517042626183334, 39.53608990030421, 11.64126499893857, 28.89022332397379, 3.8514407524358276, 26.566287342701635, 133.95688799829148, 231.7084720088421, 431.4569227967336, 27.366423519364993, 159.7217512212731, 56.13532017044843, 38.3035184653976, 0.0, 26.710778605627095, 19.538052318197366, 0.0, 368.04115756600777, 243.8498956056292, 74.99750924376907, 40.776230320036646, 9.039175575969217, 13.016437856178285, 41.81886236208955, 38.500196500242076, 0.0, 26.011195531193035, 4.404474630282824, 15.50393250820193, 10.22871745451991, 6.083173454161399, 165.1569726742132, 173.89035962363582, 42.1604384504428, 6.717508806128221, 0.0, 91.66518938477634, 2.0459837332721773, 44.45015880776843, 37.19813088868972, 92.08291332592907, 41.99853886722609, 16.646008992669408, 298.37872072659775, 176.3854780255686, 14.327043662318045, 25.6791409592914, 52.90868567057475, 201.45005718336947, 322.17841744786006, 16.808085073957802, 30.39540081405893, 76.3275509903272, 5.393651078674973, 512.9081963382907, 223.63981759067184, 62.89758431215076, 0.0, 520.9816995721037, 548.8568982262617, 15.401659177129085, 3.3512973747751866, 45.44391573246236, 598.3762503277048, 229.24104540505076, 22.701895982385857, 23.825314658307757, 53.622283126222584, 156.35927853796335, 0.0, 429.8386460545702, 115.83543574910557, 27.269264086405755, 38.33142811191001, 80.41568932617287, 78.8031030907197, 0.0, 474.47913326409457, 41.42486183049806, 258.470509199703, 59.93539214696817, 30.37105822969017, 141.86975138223934, 38.45472951611629, 0.0, 0.0, 18.802124825050907, 169.58220267778321]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.544946457688594, "mean_inference_ms": 1.626922716838447, "mean_action_processing_ms": 0.2545300217017393, "mean_env_wait_ms": 0.18627053922771264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037647485733032227, "StateBufferConnector_ms": 0.0030204057693481445, "ViewRequirementAgentConnector_ms": 0.09217453002929688}, "num_episodes": 18, "episode_return_max": 422.13887899696164, "episode_return_min": -123.60878615763905, "episode_return_mean": 118.53017555285163, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 392.59490872010934, "num_env_steps_trained_throughput_per_sec": 392.59490872010934, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 10212.607, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10212.573, "sample_time_ms": 1304.091, "learn_time_ms": 8893.662, "learn_throughput": 449.758, "synch_weights_time_ms": 14.096}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "74486_00000", "date": "2024-08-16_15-05-15", "timestamp": 1723800915, "time_this_iter_s": 10.1939537525177, "time_total_s": 584.2441146373749, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39800bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 584.2441146373749, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 27.04666666666667, "ram_util_percent": 78.88666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.622398432285067, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.275020968977105, "policy_loss": -0.0061739581140625496, "vf_loss": 6.280707666609023, "vf_explained_var": -0.17341237465540568, "kl": 0.009744860137780462, "entropy": 1.2832937884583044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3329277780636277, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0284695210910977, "policy_loss": -0.006207177270987322, "vf_loss": 3.0342142158715184, "vf_explained_var": 0.009100416633817885, "kl": 0.0061662710828218024, "entropy": 0.7006244882389351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 422.13887899696164, "episode_reward_min": -156.72473612708524, "episode_reward_mean": 122.97990540451804, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -856.9274518995675, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.2192005289584}, "policy_reward_mean": {"prey_policy": -38.2072162098739, "predator_policy": 99.69716891213295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [422.13887899696164, 43.673874602211654, 122.18000000000066, 23.60000000000051, 22.082295760791258, 10.838385626436976, 12.869999999999923, 355.25694490605997, 74.96000000000107, 89.28745968888224, 99.90000000000106, 148.30999999999943, 50.471935885603294, 69.24999999999997, 98.90000000000036, 3.8099999999999614, 137.8800000000002, 146.18927842496612, 3.96999999999996, 102.09000000000015, 185.07999999999976, 11.290212267430615, 3.7699999999999605, 165.0900000000001, 142.25000000000048, 121.98000000000025, 3.989999999999959, 15.391258810992815, 11.578630817961736, 164.28999999999942, 102.50480323144892, 19.689608758757966, 186.03999999999968, 3.8299999999999597, 253.3528636492209, 114.09245209028462, 3.839999999999962, 110.63000000000078, 184.0199999999998, 8.782739912238403, 15.74999999999992, 141.55999999999995, 89.8000000000001, 92.3200000000005, 175.11999999999978, 186.96999999999974, 216.16999999999928, 147.40109534044961, 5.361186054264359, 3.8099999999999605, 134.49000000000024, 383.01, 379.7134376514887, 285.8366809847142, 252.69620429069008, 279.1295788576924, -14.373941188701577, 32.66919084823606, 151.0399999999999, 243.5799999999997, 43.70000000000022, 192.8799999999997, 134.4892089129491, 41.41999999999954, 190.80999999999966, 89.16257871189715, 199.88999999999965, 269.00883714229866, 349.3294192586899, -112.7211219220166, 96.05000000000037, 3.7699999999999663, 128.0000000000002, -51.250718676109585, 177.99999999999983, 163.92644289165924, 77.30741667789482, 295.53952150613515, 348.31, 353.92873286618794, 201.9999999999996, 3.4999999999999676, 45.979999999999905, 145.98000000000013, 267.2832157179395, 3.7299999999999645, 221.53884440355785, 3.5799999999999663, -32.17599299886409, 138.0000000000001, 379.07, 366.19, -60.10142097413949, -156.72473612708524, 136.07000000000025, 176.98999999999984, 160.98999999999998, -35.006945484029934, 193.92999999999967, 94.41220227575555], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-564.2030951494216, 25.30803704053217, -856.9274518995675, -798.2613715869161, -43.88962510913321, -23.208389028374672, -43.33241734419753, 3.979999999999958, -56.93264274024803, -108.5545026045296, 2.0000000000000013, -15.17046677581167, 7.57032146270426, -2.5165996630894485, -0.8860189208541271, 165.9818441170426, -34.40871489127954, -0.8497635765489919, -30.639525861460275, 73.37545228355303, 77.91886231148311, -3.969148680357023, -23.551828201436454, 107.6447299157133, -9.688355775659502, -64.19353697527183, 0.2564197510881882, -313.24546778053826, 75.15777084847657, -14.097807793972889, -27.9498584557901, -19.19187170984478, -43.75440701979956, -40.59885306358592, 18.119278424966726, -119.64203788940493, -3.434233783560474, 2.0000000000000013, -181.4175378658448, -4.141078863641367, -64.42029115399038, 183.17000000000002, -23.414920562765698, 2.0000000000000013, -64.34393196539075, 2.0000000000000013, 2.0000000000000013, 91.40472882889398, 74.4562562089046, -18.90854726627551, -15.079780230276201, -148.3036763339214, 2.0000000000000013, -0.1794306286616616, 2.0000000000000013, -82.23971032836323, 2.0000000000000013, -10.719678931239425, 135.71414522415137, 2.0000000000000013, 0.37202831795676133, -94.99566301110355, -6.865139482257405, -53.010280022257945, 156.55883224015847, 2.0000000000000013, 2.0000000000000013, -79.82684266687025, -44.612853123835265, 0.846667131878627, -15.278340803732798, 106.39899795943519, -21.970702339447712, -19.02941242176929, -7.083159846094706, 52.72679995917589, 172.6629573738167, -34.69608990030458, -4.788525086700125, -26.960223323973487, 10.008559247564133, -24.67628734270134, -269.61293834436253, 45.50757833722919, -354.4569227967336, -14.566423519364967, -69.3117512212729, -54.22532017044881, -36.45351846539797, 173.26999999999998, 143.69478845449768, -2.973619378322189, 89.12000000000057, -240.99115756600781, -9.541605095285636, -161.90470441366315, -30.256817417884125, -14.197402423856893, -44.096028323808206, -6.929271894460012, 93.98980349975798, 2.0000000000000013, 158.99880446880698, 193.59552536971717, 177.1255947016898, 176.855192987077, 140.07812316826391, -25.48158831192403, -9.621571701547168, 46.2669779181586, 82.0958440842244, 190.31622596734144, -45.51935965401792, -62.565754652733034, 2.0000000000000013, -50.97909884822281, -14.605923490448447, 31.56447129729333, 177.3539910073306, -248.79872072659828, -134.6254780255693, -12.387043662318087, 165.3208590407086, -51.02868567057512, -226.0440375629032, -163.0952281553777, 8.53886738687056, -14.32235327488728, -74.59755099032631, 183.68634892132502, -287.2717354854439, -360.11369973162147, -61.027584312151134, 198.01999999999998, -438.4984124339495, -362.33134822211673, 176.63438190026244, 153.94208080652317, -574.7048023468029, -181.83648563538117, -2.558462080208331, -153.3344793072285, -21.935314658307462, -51.74228312622295, -30.359278537963306, 2.0000000000000013, -236.60548363096217, -360.3193168488228, 148.84073591359424, -36.44142811191038, 10.832934694110307, -6.125284219343609, -312.98758644898464, -84.18413013721431, -125.71483473352356, 121.35898520945769, 127.07460785303184, 130.92894177030988, 115.93403829885713, 57.6702136689752, 2.0000000000000013, 200.0, -16.872124825050605, -168.01220267778453, -276.7846879319537, -37.958017181215354, -42.928820538621785, -73.71983332833864, 136.8869513809376, -141.1096388373439, -59.019972404511414, -65.9906429937956, 33.63205282225309, -99.33608316583991, -60.398499845484295, -124.2622442503653, -180.89704874090117, -284.4642992582893, 2.0000000000000013, -8.423414681433023, 155.93379418717407, 192.3551379434365, 156.07784012316316, 166.4626002826528, -312.2679529054917, -289.66967162312557, -371.9664347916815, -380.18160459467424, -11.264048742128876, 7.925230343718638, 0.3489846568282248, 98.79664393584225, 66.67806711450244, -8.150455418352397, -132.38120055426384, -90.52300514311483, 175.41026987700988, -14.850566106454695, -240.87250526224727, -188.55252266419527], "policy_predator_policy_reward": [605.971441694753, 355.06249541109753, 753.6434975597383, 945.2192005289584, 154.27962510913318, 34.99838902837495, 33.17000586834113, 29.782411475856083, 110.04111490009701, 77.52832620547184, 20.07046677581182, 3.938385626437059, 3.3196785372957, 4.496599663089406, 127.9850935102807, 62.17602619959083, 100.47871489127934, 9.739763576548977, 44.55836306915411, 1.9931701976347913, 17.05113768851735, 8.899148680356982, 25.491828201436757, 38.72527008428688, 75.98417080700003, 48.369657829536145, 1.7335802489118133, 380.50546778053825, 4.244990077872629, 33.59504686762375, 29.819858455790392, 21.131871709845083, 144.08777310805326, 78.14548697533185, 162.34205705086305, 85.36998083854176, 5.404233783560433, 0.0, 281.5375378658446, 6.111078863641325, 66.33029115399135, 0.0, 10.905219720665738, 21.799913109530962, 66.11393196539157, 0.0, 62.69413682138782, 8.991134349718182, 65.88374379109538, 20.818547266275807, 269.0602734386812, 16.303183125516533, 0.0, 2.1694306286616603, 79.59184795858349, 16.03912118077356, 12.659678931239384, 7.638630817961818, 26.575854775848388, 0.0, 73.97170939544277, 123.15672852915212, 32.95802539876229, 46.60700286451004, 27.48116775984149, 0.0, 0.0, 81.65684266687119, 125.92324309765542, 171.19580654352308, 17.228340803732973, 5.743454130848774, 23.900702339448014, 20.939412421769582, 50.922142535457894, 14.064217351460751, 6.517042626183334, 39.53608990030421, 11.64126499893857, 28.89022332397379, 3.8514407524358276, 26.566287342701635, 133.95688799829148, 231.7084720088421, 431.4569227967336, 27.366423519364993, 159.7217512212731, 56.13532017044843, 38.3035184653976, 0.0, 26.710778605627095, 19.538052318197366, 0.0, 368.04115756600777, 243.8498956056292, 74.99750924376907, 40.776230320036646, 9.039175575969217, 13.016437856178285, 41.81886236208955, 38.500196500242076, 0.0, 26.011195531193035, 4.404474630282824, 15.50393250820193, 10.22871745451991, 6.083173454161399, 165.1569726742132, 173.89035962363582, 42.1604384504428, 6.717508806128221, 0.0, 91.66518938477634, 2.0459837332721773, 44.45015880776843, 37.19813088868972, 92.08291332592907, 41.99853886722609, 16.646008992669408, 298.37872072659775, 176.3854780255686, 14.327043662318045, 25.6791409592914, 52.90868567057475, 201.45005718336947, 322.17841744786006, 16.808085073957802, 30.39540081405893, 76.3275509903272, 5.393651078674973, 512.9081963382907, 223.63981759067184, 62.89758431215076, 0.0, 520.9816995721037, 548.8568982262617, 15.401659177129085, 3.3512973747751866, 45.44391573246236, 598.3762503277048, 229.24104540505076, 22.701895982385857, 23.825314658307757, 53.622283126222584, 156.35927853796335, 0.0, 429.8386460545702, 115.83543574910557, 27.269264086405755, 38.33142811191001, 80.41568932617287, 78.8031030907197, 0.0, 474.47913326409457, 41.42486183049806, 258.470509199703, 59.93539214696817, 30.37105822969017, 141.86975138223934, 38.45472951611629, 0.0, 0.0, 18.802124825050907, 169.58220267778321, 320.8446879319538, 39.87801718121497, 44.78882053862142, 217.83983332833864, 13.815615509686967, 257.6902876646589, 60.85997240451105, 67.88064299379657, 26.894422186012292, 260.3484525611324, 119.12361568793895, 69.11712840791114, 19.515118192989057, 413.6702368073366, 0.0, 144.423414681433, 16.6618692862403, 14.119198583149142, 32.922159876836844, 10.727399717347197, 511.013160788033, 30.823042766444868, 55.446900934737116, 539.9764023245334, 13.194048742128837, 126.21476965628135, 1.6410153431717767, 76.20335606415775, 92.36193288549755, 10.100455418352356, 0.0, 187.89726021334855, 16.589730122990126, 16.780566106454792, 394.9550847169082, 128.88214548529]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5447926539486027, "mean_inference_ms": 1.6286196902399626, "mean_action_processing_ms": 0.2540386196659486, "mean_env_wait_ms": 0.18617474941925088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038330554962158203, "StateBufferConnector_ms": 0.0030275583267211914, "ViewRequirementAgentConnector_ms": 0.09991228580474854}, "num_episodes": 18, "episode_return_max": 422.13887899696164, "episode_return_min": -156.72473612708524, "episode_return_mean": 122.97990540451804, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 395.54860886069815, "num_env_steps_trained_throughput_per_sec": 395.54860886069815, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 10220.783, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10220.748, "sample_time_ms": 1303.766, "learn_time_ms": 8901.974, "learn_throughput": 449.339, "synch_weights_time_ms": 14.23}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "74486_00000", "date": "2024-08-16_15-05-26", "timestamp": 1723800926, "time_this_iter_s": 10.117438077926636, "time_total_s": 594.3615527153015, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39800b160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 594.3615527153015, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 29.292857142857144, "ram_util_percent": 78.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.819045580095715, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.0285795456517945, "policy_loss": -0.0061819275409949045, "vf_loss": 7.034261188305244, "vf_explained_var": -0.10258772042062547, "kl": 0.010005811007620111, "entropy": 1.2440794179679224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0770242837686388, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.180012272022388, "policy_loss": -0.010403987032326836, "vf_loss": 4.189221497313686, "vf_explained_var": 0.007378300346394695, "kl": 0.01593012464322371, "entropy": 0.6385424619786954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 390.3886750572253, "episode_reward_min": -156.72473612708524, "episode_reward_mean": 131.01088622550844, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -574.7048023468029, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 598.3762503277048}, "policy_reward_mean": {"prey_policy": -46.716546943547925, "predator_policy": 112.22199005630216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.7699999999999605, 165.0900000000001, 142.25000000000048, 121.98000000000025, 3.989999999999959, 15.391258810992815, 11.578630817961736, 164.28999999999942, 102.50480323144892, 19.689608758757966, 186.03999999999968, 3.8299999999999597, 253.3528636492209, 114.09245209028462, 3.839999999999962, 110.63000000000078, 184.0199999999998, 8.782739912238403, 15.74999999999992, 141.55999999999995, 89.8000000000001, 92.3200000000005, 175.11999999999978, 186.96999999999974, 216.16999999999928, 147.40109534044961, 5.361186054264359, 3.8099999999999605, 134.49000000000024, 383.01, 379.7134376514887, 285.8366809847142, 252.69620429069008, 279.1295788576924, -14.373941188701577, 32.66919084823606, 151.0399999999999, 243.5799999999997, 43.70000000000022, 192.8799999999997, 134.4892089129491, 41.41999999999954, 190.80999999999966, 89.16257871189715, 199.88999999999965, 269.00883714229866, 349.3294192586899, -112.7211219220166, 96.05000000000037, 3.7699999999999663, 128.0000000000002, -51.250718676109585, 177.99999999999983, 163.92644289165924, 77.30741667789482, 295.53952150613515, 348.31, 353.92873286618794, 201.9999999999996, 3.4999999999999676, 45.979999999999905, 145.98000000000013, 267.2832157179395, 3.7299999999999645, 221.53884440355785, 3.5799999999999663, -32.17599299886409, 138.0000000000001, 379.07, 366.19, -60.10142097413949, -156.72473612708524, 136.07000000000025, 176.98999999999984, 160.98999999999998, -35.006945484029934, 193.92999999999967, 94.41220227575555, -64.63345172413581, -8.176655582776036, 157.82559981959326, 183.7275804573949, 53.5173553023404, 145.38321754346273, 199.93999999999966, 140.64937281448692, 269.237862766594, 91.4537540381447, 229.32478448838782, 201.9999999999996, 201.63999999999962, -53.94742385323503, 199.02999999999963, 52.77629675186617, 128.97000000000028, 3.669999999999963, 99.89000000000016, 390.3886750572253, 218.51038037903834, 195.94999999999965], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-64.34393196539075, 2.0000000000000013, 2.0000000000000013, 91.40472882889398, 74.4562562089046, -18.90854726627551, -15.079780230276201, -148.3036763339214, 2.0000000000000013, -0.1794306286616616, 2.0000000000000013, -82.23971032836323, 2.0000000000000013, -10.719678931239425, 135.71414522415137, 2.0000000000000013, 0.37202831795676133, -94.99566301110355, -6.865139482257405, -53.010280022257945, 156.55883224015847, 2.0000000000000013, 2.0000000000000013, -79.82684266687025, -44.612853123835265, 0.846667131878627, -15.278340803732798, 106.39899795943519, -21.970702339447712, -19.02941242176929, -7.083159846094706, 52.72679995917589, 172.6629573738167, -34.69608990030458, -4.788525086700125, -26.960223323973487, 10.008559247564133, -24.67628734270134, -269.61293834436253, 45.50757833722919, -354.4569227967336, -14.566423519364967, -69.3117512212729, -54.22532017044881, -36.45351846539797, 173.26999999999998, 143.69478845449768, -2.973619378322189, 89.12000000000057, -240.99115756600781, -9.541605095285636, -161.90470441366315, -30.256817417884125, -14.197402423856893, -44.096028323808206, -6.929271894460012, 93.98980349975798, 2.0000000000000013, 158.99880446880698, 193.59552536971717, 177.1255947016898, 176.855192987077, 140.07812316826391, -25.48158831192403, -9.621571701547168, 46.2669779181586, 82.0958440842244, 190.31622596734144, -45.51935965401792, -62.565754652733034, 2.0000000000000013, -50.97909884822281, -14.605923490448447, 31.56447129729333, 177.3539910073306, -248.79872072659828, -134.6254780255693, -12.387043662318087, 165.3208590407086, -51.02868567057512, -226.0440375629032, -163.0952281553777, 8.53886738687056, -14.32235327488728, -74.59755099032631, 183.68634892132502, -287.2717354854439, -360.11369973162147, -61.027584312151134, 198.01999999999998, -438.4984124339495, -362.33134822211673, 176.63438190026244, 153.94208080652317, -574.7048023468029, -181.83648563538117, -2.558462080208331, -153.3344793072285, -21.935314658307462, -51.74228312622295, -30.359278537963306, 2.0000000000000013, -236.60548363096217, -360.3193168488228, 148.84073591359424, -36.44142811191038, 10.832934694110307, -6.125284219343609, -312.98758644898464, -84.18413013721431, -125.71483473352356, 121.35898520945769, 127.07460785303184, 130.92894177030988, 115.93403829885713, 57.6702136689752, 2.0000000000000013, 200.0, -16.872124825050605, -168.01220267778453, -276.7846879319537, -37.958017181215354, -42.928820538621785, -73.71983332833864, 136.8869513809376, -141.1096388373439, -59.019972404511414, -65.9906429937956, 33.63205282225309, -99.33608316583991, -60.398499845484295, -124.2622442503653, -180.89704874090117, -284.4642992582893, 2.0000000000000013, -8.423414681433023, 155.93379418717407, 192.3551379434365, 156.07784012316316, 166.4626002826528, -312.2679529054917, -289.66967162312557, -371.9664347916815, -380.18160459467424, -11.264048742128876, 7.925230343718638, 0.3489846568282248, 98.79664393584225, 66.67806711450244, -8.150455418352397, -132.38120055426384, -90.52300514311483, 175.41026987700988, -14.850566106454695, -240.87250526224727, -188.55252266419527, -301.69920661895816, -380.43072546276795, -126.26311580547281, -324.6867200895111, 0.27072784393271077, -232.50349646947524, -213.13427096261216, -100.83271178902322, -154.9984942104365, -170.77588532998496, -111.26346717823698, -124.13092312852474, -19.842184590245694, 198.01999999999998, -151.40486350939165, -121.09897824609959, -292.00975914977516, -319.5404400266362, -64.34945422289645, -435.7350451357044, -37.45811279896019, -329.7434210071288, 2.0000000000000013, 200.0, -168.5956907286822, 200.0, -296.3333796020323, -163.65389518622538, 197.03, 2.0000000000000013, -146.90073442696522, -303.7134873180751, -3.8970295529383936, -199.2994166663819, -17.34896123238861, -105.85563227733623, -25.93903242643452, -189.54882587399788, 190.31717280579616, 192.96910767301347, 2.0000000000000013, -213.64812360028355, 178.93558511354308, -10.78236011884451], "policy_predator_policy_reward": [66.11393196539157, 0.0, 62.69413682138782, 8.991134349718182, 65.88374379109538, 20.818547266275807, 269.0602734386812, 16.303183125516533, 0.0, 2.1694306286616603, 79.59184795858349, 16.03912118077356, 12.659678931239384, 7.638630817961818, 26.575854775848388, 0.0, 73.97170939544277, 123.15672852915212, 32.95802539876229, 46.60700286451004, 27.48116775984149, 0.0, 0.0, 81.65684266687119, 125.92324309765542, 171.19580654352308, 17.228340803732973, 5.743454130848774, 23.900702339448014, 20.939412421769582, 50.922142535457894, 14.064217351460751, 6.517042626183334, 39.53608990030421, 11.64126499893857, 28.89022332397379, 3.8514407524358276, 26.566287342701635, 133.95688799829148, 231.7084720088421, 431.4569227967336, 27.366423519364993, 159.7217512212731, 56.13532017044843, 38.3035184653976, 0.0, 26.710778605627095, 19.538052318197366, 0.0, 368.04115756600777, 243.8498956056292, 74.99750924376907, 40.776230320036646, 9.039175575969217, 13.016437856178285, 41.81886236208955, 38.500196500242076, 0.0, 26.011195531193035, 4.404474630282824, 15.50393250820193, 10.22871745451991, 6.083173454161399, 165.1569726742132, 173.89035962363582, 42.1604384504428, 6.717508806128221, 0.0, 91.66518938477634, 2.0459837332721773, 44.45015880776843, 37.19813088868972, 92.08291332592907, 41.99853886722609, 16.646008992669408, 298.37872072659775, 176.3854780255686, 14.327043662318045, 25.6791409592914, 52.90868567057475, 201.45005718336947, 322.17841744786006, 16.808085073957802, 30.39540081405893, 76.3275509903272, 5.393651078674973, 512.9081963382907, 223.63981759067184, 62.89758431215076, 0.0, 520.9816995721037, 548.8568982262617, 15.401659177129085, 3.3512973747751866, 45.44391573246236, 598.3762503277048, 229.24104540505076, 22.701895982385857, 23.825314658307757, 53.622283126222584, 156.35927853796335, 0.0, 429.8386460545702, 115.83543574910557, 27.269264086405755, 38.33142811191001, 80.41568932617287, 78.8031030907197, 0.0, 474.47913326409457, 41.42486183049806, 258.470509199703, 59.93539214696817, 30.37105822969017, 141.86975138223934, 38.45472951611629, 0.0, 0.0, 18.802124825050907, 169.58220267778321, 320.8446879319538, 39.87801718121497, 44.78882053862142, 217.83983332833864, 13.815615509686967, 257.6902876646589, 60.85997240451105, 67.88064299379657, 26.894422186012292, 260.3484525611324, 119.12361568793895, 69.11712840791114, 19.515118192989057, 413.6702368073366, 0.0, 144.423414681433, 16.6618692862403, 14.119198583149142, 32.922159876836844, 10.727399717347197, 511.013160788033, 30.823042766444868, 55.446900934737116, 539.9764023245334, 13.194048742128837, 126.21476965628135, 1.6410153431717767, 76.20335606415775, 92.36193288549755, 10.100455418352356, 0.0, 187.89726021334855, 16.589730122990126, 16.780566106454792, 394.9550847169082, 128.88214548529, 20.229864113220167, 597.2666162443701, 416.9435985023294, 25.829581809878345, 11.815235058817555, 378.2431333863187, 145.08437403504647, 352.61018917398377, 17.055413229298164, 362.23632161346364, 54.1109001194517, 326.66670773077203, 21.762184590245994, 0.0, 65.38284242542314, 347.7703721445549, 479.4990595327511, 401.2890024102536, 41.0474944612761, 550.4907589354691, 225.40349647877954, 371.12282181569714, 0.0, 0.0, 170.2356907286807, 0.0, 5.632805033794934, 400.40704590122823, 0.0, 0.0, 11.347396835943359, 492.04312166096327, 5.867029552938353, 326.2994166663819, 19.288961232388914, 107.58563227733711, 306.8698010049295, 8.508057295503225, 7.1023945784157245, 0.0, 214.65063803198785, 215.5078659473345, 15.064414886456934, 12.732360118844468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5441536123086342, "mean_inference_ms": 1.6294718283489338, "mean_action_processing_ms": 0.25311915921800415, "mean_env_wait_ms": 0.18582136480452746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00371396541595459, "StateBufferConnector_ms": 0.0029529333114624023, "ViewRequirementAgentConnector_ms": 0.09746050834655762}, "num_episodes": 22, "episode_return_max": 390.3886750572253, "episode_return_min": -156.72473612708524, "episode_return_mean": 131.01088622550844, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.56560434780255, "num_env_steps_trained_throughput_per_sec": 388.56560434780255, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 10229.024, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10228.99, "sample_time_ms": 1308.926, "learn_time_ms": 8904.92, "learn_throughput": 449.19, "synch_weights_time_ms": 14.378}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "74486_00000", "date": "2024-08-16_15-05-36", "timestamp": 1723800936, "time_this_iter_s": 10.299559116363525, "time_total_s": 604.661111831665, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397746820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 604.661111831665, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 26.626666666666665, "ram_util_percent": 79.18666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.675403111037754, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.976592325911951, "policy_loss": -0.007074283380012112, "vf_loss": 4.982981380709895, "vf_explained_var": -0.264405394830401, "kl": 0.01370466962509038, "entropy": 1.2813546544660337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2442720347295992, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.67667362008776, "policy_loss": -0.006170772399418253, "vf_loss": 4.682409807361623, "vf_explained_var": 0.005247386422737566, "kl": 0.005794462114348623, "entropy": 0.6039177715462982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 402.37762704665744, "episode_reward_min": -156.72473612708524, "episode_reward_mean": 137.73623469260792, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -574.7048023468029, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 598.3762503277048}, "policy_reward_mean": {"prey_policy": -63.63388557898188, "predator_policy": 132.50200292528586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.74999999999992, 141.55999999999995, 89.8000000000001, 92.3200000000005, 175.11999999999978, 186.96999999999974, 216.16999999999928, 147.40109534044961, 5.361186054264359, 3.8099999999999605, 134.49000000000024, 383.01, 379.7134376514887, 285.8366809847142, 252.69620429069008, 279.1295788576924, -14.373941188701577, 32.66919084823606, 151.0399999999999, 243.5799999999997, 43.70000000000022, 192.8799999999997, 134.4892089129491, 41.41999999999954, 190.80999999999966, 89.16257871189715, 199.88999999999965, 269.00883714229866, 349.3294192586899, -112.7211219220166, 96.05000000000037, 3.7699999999999663, 128.0000000000002, -51.250718676109585, 177.99999999999983, 163.92644289165924, 77.30741667789482, 295.53952150613515, 348.31, 353.92873286618794, 201.9999999999996, 3.4999999999999676, 45.979999999999905, 145.98000000000013, 267.2832157179395, 3.7299999999999645, 221.53884440355785, 3.5799999999999663, -32.17599299886409, 138.0000000000001, 379.07, 366.19, -60.10142097413949, -156.72473612708524, 136.07000000000025, 176.98999999999984, 160.98999999999998, -35.006945484029934, 193.92999999999967, 94.41220227575555, -64.63345172413581, -8.176655582776036, 157.82559981959326, 183.7275804573949, 53.5173553023404, 145.38321754346273, 199.93999999999966, 140.64937281448692, 269.237862766594, 91.4537540381447, 229.32478448838782, 201.9999999999996, 201.63999999999962, -53.94742385323503, 199.02999999999963, 52.77629675186617, 128.97000000000028, 3.669999999999963, 99.89000000000016, 390.3886750572253, 218.51038037903834, 195.94999999999965, 174.1250361568085, -35.63374455905352, 135.08611545723298, 244.48926315883165, 3.789999999999962, 34.984027359006326, 87.97211554793978, 114.31540094678934, 91.51000000000016, 271.4329299331907, 61.25999999999999, 3.7199999999999633, 3.84999999999996, 27.50000000000051, 383.0, 402.37762704665744, 88.67174557763603, 195.20668735581538], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.008559247564133, -24.67628734270134, -269.61293834436253, 45.50757833722919, -354.4569227967336, -14.566423519364967, -69.3117512212729, -54.22532017044881, -36.45351846539797, 173.26999999999998, 143.69478845449768, -2.973619378322189, 89.12000000000057, -240.99115756600781, -9.541605095285636, -161.90470441366315, -30.256817417884125, -14.197402423856893, -44.096028323808206, -6.929271894460012, 93.98980349975798, 2.0000000000000013, 158.99880446880698, 193.59552536971717, 177.1255947016898, 176.855192987077, 140.07812316826391, -25.48158831192403, -9.621571701547168, 46.2669779181586, 82.0958440842244, 190.31622596734144, -45.51935965401792, -62.565754652733034, 2.0000000000000013, -50.97909884822281, -14.605923490448447, 31.56447129729333, 177.3539910073306, -248.79872072659828, -134.6254780255693, -12.387043662318087, 165.3208590407086, -51.02868567057512, -226.0440375629032, -163.0952281553777, 8.53886738687056, -14.32235327488728, -74.59755099032631, 183.68634892132502, -287.2717354854439, -360.11369973162147, -61.027584312151134, 198.01999999999998, -438.4984124339495, -362.33134822211673, 176.63438190026244, 153.94208080652317, -574.7048023468029, -181.83648563538117, -2.558462080208331, -153.3344793072285, -21.935314658307462, -51.74228312622295, -30.359278537963306, 2.0000000000000013, -236.60548363096217, -360.3193168488228, 148.84073591359424, -36.44142811191038, 10.832934694110307, -6.125284219343609, -312.98758644898464, -84.18413013721431, -125.71483473352356, 121.35898520945769, 127.07460785303184, 130.92894177030988, 115.93403829885713, 57.6702136689752, 2.0000000000000013, 200.0, -16.872124825050605, -168.01220267778453, -276.7846879319537, -37.958017181215354, -42.928820538621785, -73.71983332833864, 136.8869513809376, -141.1096388373439, -59.019972404511414, -65.9906429937956, 33.63205282225309, -99.33608316583991, -60.398499845484295, -124.2622442503653, -180.89704874090117, -284.4642992582893, 2.0000000000000013, -8.423414681433023, 155.93379418717407, 192.3551379434365, 156.07784012316316, 166.4626002826528, -312.2679529054917, -289.66967162312557, -371.9664347916815, -380.18160459467424, -11.264048742128876, 7.925230343718638, 0.3489846568282248, 98.79664393584225, 66.67806711450244, -8.150455418352397, -132.38120055426384, -90.52300514311483, 175.41026987700988, -14.850566106454695, -240.87250526224727, -188.55252266419527, -301.69920661895816, -380.43072546276795, -126.26311580547281, -324.6867200895111, 0.27072784393271077, -232.50349646947524, -213.13427096261216, -100.83271178902322, -154.9984942104365, -170.77588532998496, -111.26346717823698, -124.13092312852474, -19.842184590245694, 198.01999999999998, -151.40486350939165, -121.09897824609959, -292.00975914977516, -319.5404400266362, -64.34945422289645, -435.7350451357044, -37.45811279896019, -329.7434210071288, 2.0000000000000013, 200.0, -168.5956907286822, 200.0, -296.3333796020323, -163.65389518622538, 197.03, 2.0000000000000013, -146.90073442696522, -303.7134873180751, -3.8970295529383936, -199.2994166663819, -17.34896123238861, -105.85563227733623, -25.93903242643452, -189.54882587399788, 190.31717280579616, 192.96910767301347, 2.0000000000000013, -213.64812360028355, 178.93558511354308, -10.78236011884451, -110.22844445606722, -36.09345093315074, -500.4540838122298, -387.38013902419607, -213.45512683357597, -22.184650416102905, -359.42557147020904, -351.8189350760924, 2.0000000000000013, -62.266707922701066, -63.89326199987963, -2.4098248451699877, -174.8824728541457, -57.253856305336214, -156.15409172636225, -0.02402873506939586, -41.117704612963514, -0.09580428799140676, 2.0000000000000013, -230.04680352967617, -13.573398651401714, -234.4890475233753, -18.636634962008603, -45.990953228109255, 0.2694852342918103, -33.86030270873135, -40.80065828907249, -68.54762416331735, 170.4059127598628, 175.07527269524618, 200.0, 117.37033021888308, -215.42526187075563, -20.72454593897101, -533.105916286517, 2.0000000000000013], "policy_predator_policy_reward": [3.8514407524358276, 26.566287342701635, 133.95688799829148, 231.7084720088421, 431.4569227967336, 27.366423519364993, 159.7217512212731, 56.13532017044843, 38.3035184653976, 0.0, 26.710778605627095, 19.538052318197366, 0.0, 368.04115756600777, 243.8498956056292, 74.99750924376907, 40.776230320036646, 9.039175575969217, 13.016437856178285, 41.81886236208955, 38.500196500242076, 0.0, 26.011195531193035, 4.404474630282824, 15.50393250820193, 10.22871745451991, 6.083173454161399, 165.1569726742132, 173.89035962363582, 42.1604384504428, 6.717508806128221, 0.0, 91.66518938477634, 2.0459837332721773, 44.45015880776843, 37.19813088868972, 92.08291332592907, 41.99853886722609, 16.646008992669408, 298.37872072659775, 176.3854780255686, 14.327043662318045, 25.6791409592914, 52.90868567057475, 201.45005718336947, 322.17841744786006, 16.808085073957802, 30.39540081405893, 76.3275509903272, 5.393651078674973, 512.9081963382907, 223.63981759067184, 62.89758431215076, 0.0, 520.9816995721037, 548.8568982262617, 15.401659177129085, 3.3512973747751866, 45.44391573246236, 598.3762503277048, 229.24104540505076, 22.701895982385857, 23.825314658307757, 53.622283126222584, 156.35927853796335, 0.0, 429.8386460545702, 115.83543574910557, 27.269264086405755, 38.33142811191001, 80.41568932617287, 78.8031030907197, 0.0, 474.47913326409457, 41.42486183049806, 258.470509199703, 59.93539214696817, 30.37105822969017, 141.86975138223934, 38.45472951611629, 0.0, 0.0, 18.802124825050907, 169.58220267778321, 320.8446879319538, 39.87801718121497, 44.78882053862142, 217.83983332833864, 13.815615509686967, 257.6902876646589, 60.85997240451105, 67.88064299379657, 26.894422186012292, 260.3484525611324, 119.12361568793895, 69.11712840791114, 19.515118192989057, 413.6702368073366, 0.0, 144.423414681433, 16.6618692862403, 14.119198583149142, 32.922159876836844, 10.727399717347197, 511.013160788033, 30.823042766444868, 55.446900934737116, 539.9764023245334, 13.194048742128837, 126.21476965628135, 1.6410153431717767, 76.20335606415775, 92.36193288549755, 10.100455418352356, 0.0, 187.89726021334855, 16.589730122990126, 16.780566106454792, 394.9550847169082, 128.88214548529, 20.229864113220167, 597.2666162443701, 416.9435985023294, 25.829581809878345, 11.815235058817555, 378.2431333863187, 145.08437403504647, 352.61018917398377, 17.055413229298164, 362.23632161346364, 54.1109001194517, 326.66670773077203, 21.762184590245994, 0.0, 65.38284242542314, 347.7703721445549, 479.4990595327511, 401.2890024102536, 41.0474944612761, 550.4907589354691, 225.40349647877954, 371.12282181569714, 0.0, 0.0, 170.2356907286807, 0.0, 5.632805033794934, 400.40704590122823, 0.0, 0.0, 11.347396835943359, 492.04312166096327, 5.867029552938353, 326.2994166663819, 19.288961232388914, 107.58563227733711, 306.8698010049295, 8.508057295503225, 7.1023945784157245, 0.0, 214.65063803198785, 215.5078659473345, 15.064414886456934, 12.732360118844468, 280.49012149038106, 39.95681005564538, 340.362283648185, 511.83819462918655, 354.2909635935249, 16.43492911338754, 471.88942783571594, 483.84434186941706, 0.0, 64.05670792270071, 56.99768917503411, 44.28942502902158, 70.76390477383643, 249.34453993358488, 22.04212991346091, 248.4513914947598, 0.0, 132.72350890095487, 236.585212218951, 262.8945212439164, 15.503398651401675, 293.81904752337533, 20.546634962008902, 47.800953228108895, 1.7205147657081912, 35.72030270873098, 66.40065828907217, 70.44762416331832, 19.594087240137217, 17.92472730475381, 32.822435890202875, 52.1848609375715, 0.0, 324.82155338736277, 336.4052830435873, 389.90732059874597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.544261471009077, "mean_inference_ms": 1.6312170718783567, "mean_action_processing_ms": 0.25299086349567196, "mean_env_wait_ms": 0.18596551042439813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701329231262207, "StateBufferConnector_ms": 0.0030231475830078125, "ViewRequirementAgentConnector_ms": 0.0974348783493042}, "num_episodes": 18, "episode_return_max": 402.37762704665744, "episode_return_min": -156.72473612708524, "episode_return_mean": 137.73623469260792, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.4258214745834, "num_env_steps_trained_throughput_per_sec": 385.4258214745834, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 10267.949, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10267.914, "sample_time_ms": 1302.226, "learn_time_ms": 8950.503, "learn_throughput": 446.902, "synch_weights_time_ms": 14.418}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "74486_00000", "date": "2024-08-16_15-05-46", "timestamp": 1723800946, "time_this_iter_s": 10.384219884872437, "time_total_s": 615.0453317165375, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39736f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 615.0453317165375, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 26.87142857142857, "ram_util_percent": 78.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.788844995176981, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.511299792042485, "policy_loss": -0.005354339798922261, "vf_loss": 6.5161194473347335, "vf_explained_var": -0.1312651288887811, "kl": 0.01069374534636344, "entropy": 1.2531650956345615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4965569522488054, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.0911915380487995, "policy_loss": -0.004548320186536306, "vf_loss": 5.095357130948829, "vf_explained_var": 0.01265708807284239, "kl": 0.005102847974466164, "entropy": 0.6444655937177164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 421.2356391689929, "episode_reward_min": -156.72473612708524, "episode_reward_mean": 137.61204650243218, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -574.7048023468029, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 598.3762503277048}, "policy_reward_mean": {"prey_policy": -73.90430152906451, "predator_policy": 142.71032478028062}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.41999999999954, 190.80999999999966, 89.16257871189715, 199.88999999999965, 269.00883714229866, 349.3294192586899, -112.7211219220166, 96.05000000000037, 3.7699999999999663, 128.0000000000002, -51.250718676109585, 177.99999999999983, 163.92644289165924, 77.30741667789482, 295.53952150613515, 348.31, 353.92873286618794, 201.9999999999996, 3.4999999999999676, 45.979999999999905, 145.98000000000013, 267.2832157179395, 3.7299999999999645, 221.53884440355785, 3.5799999999999663, -32.17599299886409, 138.0000000000001, 379.07, 366.19, -60.10142097413949, -156.72473612708524, 136.07000000000025, 176.98999999999984, 160.98999999999998, -35.006945484029934, 193.92999999999967, 94.41220227575555, -64.63345172413581, -8.176655582776036, 157.82559981959326, 183.7275804573949, 53.5173553023404, 145.38321754346273, 199.93999999999966, 140.64937281448692, 269.237862766594, 91.4537540381447, 229.32478448838782, 201.9999999999996, 201.63999999999962, -53.94742385323503, 199.02999999999963, 52.77629675186617, 128.97000000000028, 3.669999999999963, 99.89000000000016, 390.3886750572253, 218.51038037903834, 195.94999999999965, 174.1250361568085, -35.63374455905352, 135.08611545723298, 244.48926315883165, 3.789999999999962, 34.984027359006326, 87.97211554793978, 114.31540094678934, 91.51000000000016, 271.4329299331907, 61.25999999999999, 3.7199999999999633, 3.84999999999996, 27.50000000000051, 383.0, 402.37762704665744, 88.67174557763603, 195.20668735581538, 342.7113209838627, 199.89999999999964, 40.30000000000001, 237.8590826074513, 89.93000000000019, -9.130969614168961, 3.909999999999961, 366.06066686401095, 192.97999999999968, 89.80000000000089, 421.2356391689929, 7.225441320826501, 285.95669145175884, 90.92019052500955, 163.9599999999997, 155.0000000000002, 105.92000000000071, 155.40000000000003, 207.64640914253215, 137.63509807339673, 75.37000000000015, 102.17425221053355, 97.94000000000017], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.53886738687056, -14.32235327488728, -74.59755099032631, 183.68634892132502, -287.2717354854439, -360.11369973162147, -61.027584312151134, 198.01999999999998, -438.4984124339495, -362.33134822211673, 176.63438190026244, 153.94208080652317, -574.7048023468029, -181.83648563538117, -2.558462080208331, -153.3344793072285, -21.935314658307462, -51.74228312622295, -30.359278537963306, 2.0000000000000013, -236.60548363096217, -360.3193168488228, 148.84073591359424, -36.44142811191038, 10.832934694110307, -6.125284219343609, -312.98758644898464, -84.18413013721431, -125.71483473352356, 121.35898520945769, 127.07460785303184, 130.92894177030988, 115.93403829885713, 57.6702136689752, 2.0000000000000013, 200.0, -16.872124825050605, -168.01220267778453, -276.7846879319537, -37.958017181215354, -42.928820538621785, -73.71983332833864, 136.8869513809376, -141.1096388373439, -59.019972404511414, -65.9906429937956, 33.63205282225309, -99.33608316583991, -60.398499845484295, -124.2622442503653, -180.89704874090117, -284.4642992582893, 2.0000000000000013, -8.423414681433023, 155.93379418717407, 192.3551379434365, 156.07784012316316, 166.4626002826528, -312.2679529054917, -289.66967162312557, -371.9664347916815, -380.18160459467424, -11.264048742128876, 7.925230343718638, 0.3489846568282248, 98.79664393584225, 66.67806711450244, -8.150455418352397, -132.38120055426384, -90.52300514311483, 175.41026987700988, -14.850566106454695, -240.87250526224727, -188.55252266419527, -301.69920661895816, -380.43072546276795, -126.26311580547281, -324.6867200895111, 0.27072784393271077, -232.50349646947524, -213.13427096261216, -100.83271178902322, -154.9984942104365, -170.77588532998496, -111.26346717823698, -124.13092312852474, -19.842184590245694, 198.01999999999998, -151.40486350939165, -121.09897824609959, -292.00975914977516, -319.5404400266362, -64.34945422289645, -435.7350451357044, -37.45811279896019, -329.7434210071288, 2.0000000000000013, 200.0, -168.5956907286822, 200.0, -296.3333796020323, -163.65389518622538, 197.03, 2.0000000000000013, -146.90073442696522, -303.7134873180751, -3.8970295529383936, -199.2994166663819, -17.34896123238861, -105.85563227733623, -25.93903242643452, -189.54882587399788, 190.31717280579616, 192.96910767301347, 2.0000000000000013, -213.64812360028355, 178.93558511354308, -10.78236011884451, -110.22844445606722, -36.09345093315074, -500.4540838122298, -387.38013902419607, -213.45512683357597, -22.184650416102905, -359.42557147020904, -351.8189350760924, 2.0000000000000013, -62.266707922701066, -63.89326199987963, -2.4098248451699877, -174.8824728541457, -57.253856305336214, -156.15409172636225, -0.02402873506939586, -41.117704612963514, -0.09580428799140676, 2.0000000000000013, -230.04680352967617, -13.573398651401714, -234.4890475233753, -18.636634962008603, -45.990953228109255, 0.2694852342918103, -33.86030270873135, -40.80065828907249, -68.54762416331735, 170.4059127598628, 175.07527269524618, 200.0, 117.37033021888308, -215.42526187075563, -20.72454593897101, -533.105916286517, 2.0000000000000013, 60.99574224872505, -254.84483424947584, 2.2053929867903728, 167.7837354454825, -63.073107937248515, -406.0507540873007, -175.90533194042322, 141.11215486902924, -327.59756285431354, -14.216473934846162, -73.8374723137082, -134.7003274458489, -10.172140713861575, -6.18726663097863, 128.80707503823368, 117.98471977585073, -22.16532907682484, 191.09, -59.912963980283706, 2.0000000000000013, 197.03, 163.57125665557678, -10.324956752223173, -114.38744466542879, 46.79611445038311, -121.26015279262867, -321.70117110330136, -343.10412100859827, 82.70803534096414, -56.58725349265222, 55.93250206210804, 2.0000000000000013, -166.0271357918885, -14.95928668978271, -15.357266227166422, 153.47, -41.85568813579288, -34.69048103021387, -154.64720730296642, -240.16123403028706, -198.67076449489534, 2.0000000000000013, -200.73119294994058, 2.98999999999998, -10.704115964045862, -258.5108005788851], "policy_predator_policy_reward": [16.808085073957802, 30.39540081405893, 76.3275509903272, 5.393651078674973, 512.9081963382907, 223.63981759067184, 62.89758431215076, 0.0, 520.9816995721037, 548.8568982262617, 15.401659177129085, 3.3512973747751866, 45.44391573246236, 598.3762503277048, 229.24104540505076, 22.701895982385857, 23.825314658307757, 53.622283126222584, 156.35927853796335, 0.0, 429.8386460545702, 115.83543574910557, 27.269264086405755, 38.33142811191001, 80.41568932617287, 78.8031030907197, 0.0, 474.47913326409457, 41.42486183049806, 258.470509199703, 59.93539214696817, 30.37105822969017, 141.86975138223934, 38.45472951611629, 0.0, 0.0, 18.802124825050907, 169.58220267778321, 320.8446879319538, 39.87801718121497, 44.78882053862142, 217.83983332833864, 13.815615509686967, 257.6902876646589, 60.85997240451105, 67.88064299379657, 26.894422186012292, 260.3484525611324, 119.12361568793895, 69.11712840791114, 19.515118192989057, 413.6702368073366, 0.0, 144.423414681433, 16.6618692862403, 14.119198583149142, 32.922159876836844, 10.727399717347197, 511.013160788033, 30.823042766444868, 55.446900934737116, 539.9764023245334, 13.194048742128837, 126.21476965628135, 1.6410153431717767, 76.20335606415775, 92.36193288549755, 10.100455418352356, 0.0, 187.89726021334855, 16.589730122990126, 16.780566106454792, 394.9550847169082, 128.88214548529, 20.229864113220167, 597.2666162443701, 416.9435985023294, 25.829581809878345, 11.815235058817555, 378.2431333863187, 145.08437403504647, 352.61018917398377, 17.055413229298164, 362.23632161346364, 54.1109001194517, 326.66670773077203, 21.762184590245994, 0.0, 65.38284242542314, 347.7703721445549, 479.4990595327511, 401.2890024102536, 41.0474944612761, 550.4907589354691, 225.40349647877954, 371.12282181569714, 0.0, 0.0, 170.2356907286807, 0.0, 5.632805033794934, 400.40704590122823, 0.0, 0.0, 11.347396835943359, 492.04312166096327, 5.867029552938353, 326.2994166663819, 19.288961232388914, 107.58563227733711, 306.8698010049295, 8.508057295503225, 7.1023945784157245, 0.0, 214.65063803198785, 215.5078659473345, 15.064414886456934, 12.732360118844468, 280.49012149038106, 39.95681005564538, 340.362283648185, 511.83819462918655, 354.2909635935249, 16.43492911338754, 471.88942783571594, 483.84434186941706, 0.0, 64.05670792270071, 56.99768917503411, 44.28942502902158, 70.76390477383643, 249.34453993358488, 22.04212991346091, 248.4513914947598, 0.0, 132.72350890095487, 236.585212218951, 262.8945212439164, 15.503398651401675, 293.81904752337533, 20.546634962008902, 47.800953228108895, 1.7205147657081912, 35.72030270873098, 66.40065828907217, 70.44762416331832, 19.594087240137217, 17.92472730475381, 32.822435890202875, 52.1848609375715, 0.0, 324.82155338736277, 336.4052830435873, 389.90732059874597, 315.115248242226, 221.44516474238736, 6.694607013209624, 23.216264554517494, 64.9131079372488, 444.5107540873004, 272.6522596788452, 0.0, 415.5975628543133, 16.146473934846135, 193.4902502671548, 5.91657987823312, 12.122140713861533, 8.147266630978589, 58.19292496176632, 61.07594708816017, 24.055329076825135, 0.0, 147.71296398028355, 0.0, 30.428743344423225, 30.205639168992924, 13.878987890443813, 118.05885484803554, 221.53335903994648, 138.88737075405882, 381.7341259531829, 373.991356683727, 0.0, 137.8392181516877, 6.891650593402958, 90.175847344489, 0.0, 286.9064224816714, 17.28726622716659, 0.0, 11.695507402679713, 272.49707090585923, 417.4780612239901, 114.96547818266005, 60.563139740301686, 211.4776247545936, 15.43963895573312, 284.47580620474093, 5.066075303307221, 362.088841239624]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5439984889823801, "mean_inference_ms": 1.6324668490284282, "mean_action_processing_ms": 0.252388725064257, "mean_env_wait_ms": 0.18586622065538289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036780834197998047, "StateBufferConnector_ms": 0.0029767751693725586, "ViewRequirementAgentConnector_ms": 0.09605872631072998}, "num_episodes": 23, "episode_return_max": 421.2356391689929, "episode_return_min": -156.72473612708524, "episode_return_mean": 137.61204650243218, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.43589622532625, "num_env_steps_trained_throughput_per_sec": 398.43589622532625, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 10203.349, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10203.314, "sample_time_ms": 1307.382, "learn_time_ms": 8880.568, "learn_throughput": 450.422, "synch_weights_time_ms": 14.595}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "74486_00000", "date": "2024-08-16_15-05-56", "timestamp": 1723800956, "time_this_iter_s": 10.04413104057312, "time_total_s": 625.0894627571106, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39802dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 625.0894627571106, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 25.973333333333336, "ram_util_percent": 79.03333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.407364032382056, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.83487943215345, "policy_loss": -0.012108056688750231, "vf_loss": 5.846074340457008, "vf_explained_var": -0.13786369896439649, "kl": 0.01826312427570497, "entropy": 1.2582157816205706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2939209458216157, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.537537590410343, "policy_loss": -0.0060820704969089655, "vf_loss": 5.543074545153865, "vf_explained_var": 0.008258234760748646, "kl": 0.0072682101546898215, "entropy": 0.5881431449342657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 425.6239817730616, "episode_reward_min": -156.72473612708524, "episode_reward_mean": 141.21147594261936, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -533.105916286517, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 597.2666162443701}, "policy_reward_mean": {"prey_policy": -72.47260989661275, "predator_policy": 143.07834786792245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.4999999999999676, 45.979999999999905, 145.98000000000013, 267.2832157179395, 3.7299999999999645, 221.53884440355785, 3.5799999999999663, -32.17599299886409, 138.0000000000001, 379.07, 366.19, -60.10142097413949, -156.72473612708524, 136.07000000000025, 176.98999999999984, 160.98999999999998, -35.006945484029934, 193.92999999999967, 94.41220227575555, -64.63345172413581, -8.176655582776036, 157.82559981959326, 183.7275804573949, 53.5173553023404, 145.38321754346273, 199.93999999999966, 140.64937281448692, 269.237862766594, 91.4537540381447, 229.32478448838782, 201.9999999999996, 201.63999999999962, -53.94742385323503, 199.02999999999963, 52.77629675186617, 128.97000000000028, 3.669999999999963, 99.89000000000016, 390.3886750572253, 218.51038037903834, 195.94999999999965, 174.1250361568085, -35.63374455905352, 135.08611545723298, 244.48926315883165, 3.789999999999962, 34.984027359006326, 87.97211554793978, 114.31540094678934, 91.51000000000016, 271.4329299331907, 61.25999999999999, 3.7199999999999633, 3.84999999999996, 27.50000000000051, 383.0, 402.37762704665744, 88.67174557763603, 195.20668735581538, 342.7113209838627, 199.89999999999964, 40.30000000000001, 237.8590826074513, 89.93000000000019, -9.130969614168961, 3.909999999999961, 366.06066686401095, 192.97999999999968, 89.80000000000089, 421.2356391689929, 7.225441320826501, 285.95669145175884, 90.92019052500955, 163.9599999999997, 155.0000000000002, 105.92000000000071, 155.40000000000003, 207.64640914253215, 137.63509807339673, 75.37000000000015, 102.17425221053355, 97.94000000000017, 139.00000000000028, 180.9056749718317, 140.00648738224263, 180.74999999999972, 234.26494435397962, 119.89246733839471, 118.9400000000003, 332.1621326710983, 8.779999999999928, 425.6239817730616, 265.5707763817184, 176.26212739992604, 273.58360531508833, 289.64451558289545, 285.34733930511567, 3.839999999999961, 3.9999999999999587, 3.8499999999999606], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.872124825050605, -168.01220267778453, -276.7846879319537, -37.958017181215354, -42.928820538621785, -73.71983332833864, 136.8869513809376, -141.1096388373439, -59.019972404511414, -65.9906429937956, 33.63205282225309, -99.33608316583991, -60.398499845484295, -124.2622442503653, -180.89704874090117, -284.4642992582893, 2.0000000000000013, -8.423414681433023, 155.93379418717407, 192.3551379434365, 156.07784012316316, 166.4626002826528, -312.2679529054917, -289.66967162312557, -371.9664347916815, -380.18160459467424, -11.264048742128876, 7.925230343718638, 0.3489846568282248, 98.79664393584225, 66.67806711450244, -8.150455418352397, -132.38120055426384, -90.52300514311483, 175.41026987700988, -14.850566106454695, -240.87250526224727, -188.55252266419527, -301.69920661895816, -380.43072546276795, -126.26311580547281, -324.6867200895111, 0.27072784393271077, -232.50349646947524, -213.13427096261216, -100.83271178902322, -154.9984942104365, -170.77588532998496, -111.26346717823698, -124.13092312852474, -19.842184590245694, 198.01999999999998, -151.40486350939165, -121.09897824609959, -292.00975914977516, -319.5404400266362, -64.34945422289645, -435.7350451357044, -37.45811279896019, -329.7434210071288, 2.0000000000000013, 200.0, -168.5956907286822, 200.0, -296.3333796020323, -163.65389518622538, 197.03, 2.0000000000000013, -146.90073442696522, -303.7134873180751, -3.8970295529383936, -199.2994166663819, -17.34896123238861, -105.85563227733623, -25.93903242643452, -189.54882587399788, 190.31717280579616, 192.96910767301347, 2.0000000000000013, -213.64812360028355, 178.93558511354308, -10.78236011884451, -110.22844445606722, -36.09345093315074, -500.4540838122298, -387.38013902419607, -213.45512683357597, -22.184650416102905, -359.42557147020904, -351.8189350760924, 2.0000000000000013, -62.266707922701066, -63.89326199987963, -2.4098248451699877, -174.8824728541457, -57.253856305336214, -156.15409172636225, -0.02402873506939586, -41.117704612963514, -0.09580428799140676, 2.0000000000000013, -230.04680352967617, -13.573398651401714, -234.4890475233753, -18.636634962008603, -45.990953228109255, 0.2694852342918103, -33.86030270873135, -40.80065828907249, -68.54762416331735, 170.4059127598628, 175.07527269524618, 200.0, 117.37033021888308, -215.42526187075563, -20.72454593897101, -533.105916286517, 2.0000000000000013, 60.99574224872505, -254.84483424947584, 2.2053929867903728, 167.7837354454825, -63.073107937248515, -406.0507540873007, -175.90533194042322, 141.11215486902924, -327.59756285431354, -14.216473934846162, -73.8374723137082, -134.7003274458489, -10.172140713861575, -6.18726663097863, 128.80707503823368, 117.98471977585073, -22.16532907682484, 191.09, -59.912963980283706, 2.0000000000000013, 197.03, 163.57125665557678, -10.324956752223173, -114.38744466542879, 46.79611445038311, -121.26015279262867, -321.70117110330136, -343.10412100859827, 82.70803534096414, -56.58725349265222, 55.93250206210804, 2.0000000000000013, -166.0271357918885, -14.95928668978271, -15.357266227166422, 153.47, -41.85568813579288, -34.69048103021387, -154.64720730296642, -240.16123403028706, -198.67076449489534, 2.0000000000000013, -200.73119294994058, 2.98999999999998, -10.704115964045862, -258.5108005788851, -58.615170128052526, 2.0000000000000013, -237.9961127343461, -69.4042665767477, 25.897159399590354, -168.02980112184096, -48.38667846716447, 137.68887793823745, -0.9070797039681264, -242.57716332733744, -56.6781707274648, -272.8618485951978, -164.94523629834455, -29.40246657038265, 74.17032702814636, 147.42843628414988, -8.73961542310057, -29.83254077455427, -413.30189876754173, -44.9861896845147, 82.53395922112456, -129.36892815975366, -127.09520652393076, 40.68693394946449, 3.090891332177255, -15.959416453466408, -221.8946258522425, -82.44462905732402, 49.77464945199449, 66.58631458788864, -28.029592773223925, -5.817155705055759, 2.0000000000000013, 2.0000000000000013, 2.0000000000000013, -31.79514712692458], "policy_predator_policy_reward": [18.802124825050907, 169.58220267778321, 320.8446879319538, 39.87801718121497, 44.78882053862142, 217.83983332833864, 13.815615509686967, 257.6902876646589, 60.85997240451105, 67.88064299379657, 26.894422186012292, 260.3484525611324, 119.12361568793895, 69.11712840791114, 19.515118192989057, 413.6702368073366, 0.0, 144.423414681433, 16.6618692862403, 14.119198583149142, 32.922159876836844, 10.727399717347197, 511.013160788033, 30.823042766444868, 55.446900934737116, 539.9764023245334, 13.194048742128837, 126.21476965628135, 1.6410153431717767, 76.20335606415775, 92.36193288549755, 10.100455418352356, 0.0, 187.89726021334855, 16.589730122990126, 16.780566106454792, 394.9550847169082, 128.88214548529, 20.229864113220167, 597.2666162443701, 416.9435985023294, 25.829581809878345, 11.815235058817555, 378.2431333863187, 145.08437403504647, 352.61018917398377, 17.055413229298164, 362.23632161346364, 54.1109001194517, 326.66670773077203, 21.762184590245994, 0.0, 65.38284242542314, 347.7703721445549, 479.4990595327511, 401.2890024102536, 41.0474944612761, 550.4907589354691, 225.40349647877954, 371.12282181569714, 0.0, 0.0, 170.2356907286807, 0.0, 5.632805033794934, 400.40704590122823, 0.0, 0.0, 11.347396835943359, 492.04312166096327, 5.867029552938353, 326.2994166663819, 19.288961232388914, 107.58563227733711, 306.8698010049295, 8.508057295503225, 7.1023945784157245, 0.0, 214.65063803198785, 215.5078659473345, 15.064414886456934, 12.732360118844468, 280.49012149038106, 39.95681005564538, 340.362283648185, 511.83819462918655, 354.2909635935249, 16.43492911338754, 471.88942783571594, 483.84434186941706, 0.0, 64.05670792270071, 56.99768917503411, 44.28942502902158, 70.76390477383643, 249.34453993358488, 22.04212991346091, 248.4513914947598, 0.0, 132.72350890095487, 236.585212218951, 262.8945212439164, 15.503398651401675, 293.81904752337533, 20.546634962008902, 47.800953228108895, 1.7205147657081912, 35.72030270873098, 66.40065828907217, 70.44762416331832, 19.594087240137217, 17.92472730475381, 32.822435890202875, 52.1848609375715, 0.0, 324.82155338736277, 336.4052830435873, 389.90732059874597, 315.115248242226, 221.44516474238736, 6.694607013209624, 23.216264554517494, 64.9131079372488, 444.5107540873004, 272.6522596788452, 0.0, 415.5975628543133, 16.146473934846135, 193.4902502671548, 5.91657987823312, 12.122140713861533, 8.147266630978589, 58.19292496176632, 61.07594708816017, 24.055329076825135, 0.0, 147.71296398028355, 0.0, 30.428743344423225, 30.205639168992924, 13.878987890443813, 118.05885484803554, 221.53335903994648, 138.88737075405882, 381.7341259531829, 373.991356683727, 0.0, 137.8392181516877, 6.891650593402958, 90.175847344489, 0.0, 286.9064224816714, 17.28726622716659, 0.0, 11.695507402679713, 272.49707090585923, 417.4780612239901, 114.96547818266005, 60.563139740301686, 211.4776247545936, 15.43963895573312, 284.47580620474093, 5.066075303307221, 362.088841239624, 43.28072326307588, 152.33444686497663, 420.6303235669131, 67.67573071601278, 10.151992268948543, 271.9871368355444, 91.44780052892666, 0.0, 304.52872463261025, 173.22046275267536, 216.89364052747354, 232.53884613358298, 281.9452362983448, 31.342466570382953, 30.51363747024592, 80.0497318885562, 10.679615423100529, 36.672540774554506, 538.6043646583508, 345.30770556676714, 88.48646938536274, 223.91927593498508, 262.67039997439247, 0.0, 129.06606173475467, 157.38606870162366, 338.41142084880045, 255.5723496436613, 168.9863752652325, 0.0, 1.7099101973471662, 35.97683828093275, 0.0, 0.0, 0.0, 33.64514712692429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5437360504063219, "mean_inference_ms": 1.6332187044451802, "mean_action_processing_ms": 0.2518771272111794, "mean_env_wait_ms": 0.18575671509334582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003725767135620117, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.09542417526245117}, "num_episodes": 18, "episode_return_max": 425.6239817730616, "episode_return_min": -156.72473612708524, "episode_return_mean": 141.21147594261936, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.0253905471551, "num_env_steps_trained_throughput_per_sec": 398.0253905471551, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 10148.16, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10148.125, "sample_time_ms": 1288.407, "learn_time_ms": 8844.539, "learn_throughput": 452.256, "synch_weights_time_ms": 14.361}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "74486_00000", "date": "2024-08-16_15-06-06", "timestamp": 1723800966, "time_this_iter_s": 10.05767297744751, "time_total_s": 635.1471357345581, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397741b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 635.1471357345581, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 26.321428571428566, "ram_util_percent": 78.97857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.692723739620239, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5841861109254225, "policy_loss": -0.005648855429398951, "vf_loss": 5.589184459050497, "vf_explained_var": -0.07813893130847387, "kl": 0.013010088924603277, "entropy": 1.2767675760561827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.021296397088066, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.103025470461164, "policy_loss": -0.008059011169009542, "vf_loss": 5.110345175909617, "vf_explained_var": 0.0029734437112455014, "kl": 0.009857476076474815, "entropy": 0.614289753509577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 425.6239817730616, "episode_reward_min": -64.63345172413581, "episode_reward_mean": 146.61519581381444, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -533.105916286517, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 729.3077325525121}, "policy_reward_mean": {"prey_policy": -79.70501844770575, "predator_policy": 153.01261635461302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.41220227575555, -64.63345172413581, -8.176655582776036, 157.82559981959326, 183.7275804573949, 53.5173553023404, 145.38321754346273, 199.93999999999966, 140.64937281448692, 269.237862766594, 91.4537540381447, 229.32478448838782, 201.9999999999996, 201.63999999999962, -53.94742385323503, 199.02999999999963, 52.77629675186617, 128.97000000000028, 3.669999999999963, 99.89000000000016, 390.3886750572253, 218.51038037903834, 195.94999999999965, 174.1250361568085, -35.63374455905352, 135.08611545723298, 244.48926315883165, 3.789999999999962, 34.984027359006326, 87.97211554793978, 114.31540094678934, 91.51000000000016, 271.4329299331907, 61.25999999999999, 3.7199999999999633, 3.84999999999996, 27.50000000000051, 383.0, 402.37762704665744, 88.67174557763603, 195.20668735581538, 342.7113209838627, 199.89999999999964, 40.30000000000001, 237.8590826074513, 89.93000000000019, -9.130969614168961, 3.909999999999961, 366.06066686401095, 192.97999999999968, 89.80000000000089, 421.2356391689929, 7.225441320826501, 285.95669145175884, 90.92019052500955, 163.9599999999997, 155.0000000000002, 105.92000000000071, 155.40000000000003, 207.64640914253215, 137.63509807339673, 75.37000000000015, 102.17425221053355, 97.94000000000017, 139.00000000000028, 180.9056749718317, 140.00648738224263, 180.74999999999972, 234.26494435397962, 119.89246733839471, 118.9400000000003, 332.1621326710983, 8.779999999999928, 425.6239817730616, 265.5707763817184, 176.26212739992604, 273.58360531508833, 289.64451558289545, 285.34733930511567, 3.839999999999961, 3.9999999999999587, 3.8499999999999606, 158.17060308237615, 365.1409879140581, 177.90999999999988, 152.12944092507163, -33.89821486475788, 101.62704974100527, 157.8665295620769, 174.99999999999983, 3.929999999999959, 125.22000000000057, 315.4745990520726, 58.28271655359256, 150.18629013355488, 3.8199999999999625, 297.9302671053112, 3.8199999999999603, 155.44628504280854, 131.13839740971596], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-240.87250526224727, -188.55252266419527, -301.69920661895816, -380.43072546276795, -126.26311580547281, -324.6867200895111, 0.27072784393271077, -232.50349646947524, -213.13427096261216, -100.83271178902322, -154.9984942104365, -170.77588532998496, -111.26346717823698, -124.13092312852474, -19.842184590245694, 198.01999999999998, -151.40486350939165, -121.09897824609959, -292.00975914977516, -319.5404400266362, -64.34945422289645, -435.7350451357044, -37.45811279896019, -329.7434210071288, 2.0000000000000013, 200.0, -168.5956907286822, 200.0, -296.3333796020323, -163.65389518622538, 197.03, 2.0000000000000013, -146.90073442696522, -303.7134873180751, -3.8970295529383936, -199.2994166663819, -17.34896123238861, -105.85563227733623, -25.93903242643452, -189.54882587399788, 190.31717280579616, 192.96910767301347, 2.0000000000000013, -213.64812360028355, 178.93558511354308, -10.78236011884451, -110.22844445606722, -36.09345093315074, -500.4540838122298, -387.38013902419607, -213.45512683357597, -22.184650416102905, -359.42557147020904, -351.8189350760924, 2.0000000000000013, -62.266707922701066, -63.89326199987963, -2.4098248451699877, -174.8824728541457, -57.253856305336214, -156.15409172636225, -0.02402873506939586, -41.117704612963514, -0.09580428799140676, 2.0000000000000013, -230.04680352967617, -13.573398651401714, -234.4890475233753, -18.636634962008603, -45.990953228109255, 0.2694852342918103, -33.86030270873135, -40.80065828907249, -68.54762416331735, 170.4059127598628, 175.07527269524618, 200.0, 117.37033021888308, -215.42526187075563, -20.72454593897101, -533.105916286517, 2.0000000000000013, 60.99574224872505, -254.84483424947584, 2.2053929867903728, 167.7837354454825, -63.073107937248515, -406.0507540873007, -175.90533194042322, 141.11215486902924, -327.59756285431354, -14.216473934846162, -73.8374723137082, -134.7003274458489, -10.172140713861575, -6.18726663097863, 128.80707503823368, 117.98471977585073, -22.16532907682484, 191.09, -59.912963980283706, 2.0000000000000013, 197.03, 163.57125665557678, -10.324956752223173, -114.38744466542879, 46.79611445038311, -121.26015279262867, -321.70117110330136, -343.10412100859827, 82.70803534096414, -56.58725349265222, 55.93250206210804, 2.0000000000000013, -166.0271357918885, -14.95928668978271, -15.357266227166422, 153.47, -41.85568813579288, -34.69048103021387, -154.64720730296642, -240.16123403028706, -198.67076449489534, 2.0000000000000013, -200.73119294994058, 2.98999999999998, -10.704115964045862, -258.5108005788851, -58.615170128052526, 2.0000000000000013, -237.9961127343461, -69.4042665767477, 25.897159399590354, -168.02980112184096, -48.38667846716447, 137.68887793823745, -0.9070797039681264, -242.57716332733744, -56.6781707274648, -272.8618485951978, -164.94523629834455, -29.40246657038265, 74.17032702814636, 147.42843628414988, -8.73961542310057, -29.83254077455427, -413.30189876754173, -44.9861896845147, 82.53395922112456, -129.36892815975366, -127.09520652393076, 40.68693394946449, 3.090891332177255, -15.959416453466408, -221.8946258522425, -82.44462905732402, 49.77464945199449, 66.58631458788864, -28.029592773223925, -5.817155705055759, 2.0000000000000013, 2.0000000000000013, 2.0000000000000013, -31.79514712692458, -200.5048210135842, -8.767856582821054, -224.10257640702338, 81.57795216551258, -19.265783369837703, 121.08461363274633, -43.02307874535226, -147.9124997003065, -100.8440813388588, -52.470717189933865, -466.7023640017286, -432.4381863864998, -5.3360327205862355, -184.93346973226474, 118.4785667954114, 2.0000000000000013, 2.0000000000000013, -21.929365223905346, -31.63544422839212, -17.727388407868464, 52.128298765438274, 18.213241177029477, -277.19302632859626, -268.6495113926092, -315.221858491256, -86.41659374852692, -91.48077425054869, -14.379815798634427, -289.94814716189006, -67.67752564593508, -45.08920856839326, -9.36747998931275, -223.6272325233639, -251.4962020946457, -4.482359299679421, 1.7341197149204517], "policy_predator_policy_reward": [394.9550847169082, 128.88214548529, 20.229864113220167, 597.2666162443701, 416.9435985023294, 25.829581809878345, 11.815235058817555, 378.2431333863187, 145.08437403504647, 352.61018917398377, 17.055413229298164, 362.23632161346364, 54.1109001194517, 326.66670773077203, 21.762184590245994, 0.0, 65.38284242542314, 347.7703721445549, 479.4990595327511, 401.2890024102536, 41.0474944612761, 550.4907589354691, 225.40349647877954, 371.12282181569714, 0.0, 0.0, 170.2356907286807, 0.0, 5.632805033794934, 400.40704590122823, 0.0, 0.0, 11.347396835943359, 492.04312166096327, 5.867029552938353, 326.2994166663819, 19.288961232388914, 107.58563227733711, 306.8698010049295, 8.508057295503225, 7.1023945784157245, 0.0, 214.65063803198785, 215.5078659473345, 15.064414886456934, 12.732360118844468, 280.49012149038106, 39.95681005564538, 340.362283648185, 511.83819462918655, 354.2909635935249, 16.43492911338754, 471.88942783571594, 483.84434186941706, 0.0, 64.05670792270071, 56.99768917503411, 44.28942502902158, 70.76390477383643, 249.34453993358488, 22.04212991346091, 248.4513914947598, 0.0, 132.72350890095487, 236.585212218951, 262.8945212439164, 15.503398651401675, 293.81904752337533, 20.546634962008902, 47.800953228108895, 1.7205147657081912, 35.72030270873098, 66.40065828907217, 70.44762416331832, 19.594087240137217, 17.92472730475381, 32.822435890202875, 52.1848609375715, 0.0, 324.82155338736277, 336.4052830435873, 389.90732059874597, 315.115248242226, 221.44516474238736, 6.694607013209624, 23.216264554517494, 64.9131079372488, 444.5107540873004, 272.6522596788452, 0.0, 415.5975628543133, 16.146473934846135, 193.4902502671548, 5.91657987823312, 12.122140713861533, 8.147266630978589, 58.19292496176632, 61.07594708816017, 24.055329076825135, 0.0, 147.71296398028355, 0.0, 30.428743344423225, 30.205639168992924, 13.878987890443813, 118.05885484803554, 221.53335903994648, 138.88737075405882, 381.7341259531829, 373.991356683727, 0.0, 137.8392181516877, 6.891650593402958, 90.175847344489, 0.0, 286.9064224816714, 17.28726622716659, 0.0, 11.695507402679713, 272.49707090585923, 417.4780612239901, 114.96547818266005, 60.563139740301686, 211.4776247545936, 15.43963895573312, 284.47580620474093, 5.066075303307221, 362.088841239624, 43.28072326307588, 152.33444686497663, 420.6303235669131, 67.67573071601278, 10.151992268948543, 271.9871368355444, 91.44780052892666, 0.0, 304.52872463261025, 173.22046275267536, 216.89364052747354, 232.53884613358298, 281.9452362983448, 31.342466570382953, 30.51363747024592, 80.0497318885562, 10.679615423100529, 36.672540774554506, 538.6043646583508, 345.30770556676714, 88.48646938536274, 223.91927593498508, 262.67039997439247, 0.0, 129.06606173475467, 157.38606870162366, 338.41142084880045, 255.5723496436613, 168.9863752652325, 0.0, 1.7099101973471662, 35.97683828093275, 0.0, 0.0, 0.0, 33.64514712692429, 100.70966637974094, 266.7336142990404, 153.50532945506555, 354.1602827005034, 61.36043361476985, 14.730736122321852, 99.75108701466368, 243.31393235606583, 113.47180387380787, 5.944779790228035, 729.3077325525121, 271.4598675767212, 299.28778758599304, 48.8482444289347, 54.521433204588604, 0.0, 0.0, 23.859365223905648, 33.56544422839187, 141.01738840786842, 113.969243038458, 131.16381607114693, 522.3280046091324, 81.79724966566545, 269.4504231113605, 282.37431926197814, 93.35077425054965, 16.329815798634442, 324.847924893717, 330.70801501942185, 46.95920856839289, 11.317479989312709, 262.60766485284046, 367.9620548079777, 126.87300721342268, 7.013629781051948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5434389563775435, "mean_inference_ms": 1.6342017643713058, "mean_action_processing_ms": 0.25138669302986677, "mean_env_wait_ms": 0.1856479359700829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003698110580444336, "StateBufferConnector_ms": 0.003088831901550293, "ViewRequirementAgentConnector_ms": 0.08609724044799805}, "num_episodes": 18, "episode_return_max": 425.6239817730616, "episode_return_min": -64.63345172413581, "episode_return_mean": 146.61519581381444, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.62520981696593, "num_env_steps_trained_throughput_per_sec": 401.62520981696593, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 10139.647, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10139.611, "sample_time_ms": 1281.129, "learn_time_ms": 8843.262, "learn_throughput": 452.322, "synch_weights_time_ms": 14.412}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "74486_00000", "date": "2024-08-16_15-06-16", "timestamp": 1723800976, "time_this_iter_s": 9.964129209518433, "time_total_s": 645.1112649440765, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39802df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 645.1112649440765, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 24.842857142857145, "ram_util_percent": 78.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.387555260065372, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8914328782016, "policy_loss": -0.004980447594317849, "vf_loss": 6.895776919460801, "vf_explained_var": -0.0728879589883108, "kl": 0.012728182929526679, "entropy": 1.2534174322451233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8841897190090209, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.382692593241495, "policy_loss": -0.0062152734806110695, "vf_loss": 4.387985194297064, "vf_explained_var": 0.001714447061851542, "kl": 0.012301979211205117, "entropy": 0.6421790443715595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 430.1874295340255, "episode_reward_min": -225.0855301360308, "episode_reward_mean": 151.67619241633412, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -762.254217394327, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 730.5549136111251}, "policy_reward_mean": {"prey_policy": -69.42162383996556, "predator_policy": 145.25972004813264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [195.94999999999965, 174.1250361568085, -35.63374455905352, 135.08611545723298, 244.48926315883165, 3.789999999999962, 34.984027359006326, 87.97211554793978, 114.31540094678934, 91.51000000000016, 271.4329299331907, 61.25999999999999, 3.7199999999999633, 3.84999999999996, 27.50000000000051, 383.0, 402.37762704665744, 88.67174557763603, 195.20668735581538, 342.7113209838627, 199.89999999999964, 40.30000000000001, 237.8590826074513, 89.93000000000019, -9.130969614168961, 3.909999999999961, 366.06066686401095, 192.97999999999968, 89.80000000000089, 421.2356391689929, 7.225441320826501, 285.95669145175884, 90.92019052500955, 163.9599999999997, 155.0000000000002, 105.92000000000071, 155.40000000000003, 207.64640914253215, 137.63509807339673, 75.37000000000015, 102.17425221053355, 97.94000000000017, 139.00000000000028, 180.9056749718317, 140.00648738224263, 180.74999999999972, 234.26494435397962, 119.89246733839471, 118.9400000000003, 332.1621326710983, 8.779999999999928, 425.6239817730616, 265.5707763817184, 176.26212739992604, 273.58360531508833, 289.64451558289545, 285.34733930511567, 3.839999999999961, 3.9999999999999587, 3.8499999999999606, 158.17060308237615, 365.1409879140581, 177.90999999999988, 152.12944092507163, -33.89821486475788, 101.62704974100527, 157.8665295620769, 174.99999999999983, 3.929999999999959, 125.22000000000057, 315.4745990520726, 58.28271655359256, 150.18629013355488, 3.8199999999999625, 297.9302671053112, 3.8199999999999603, 155.44628504280854, 131.13839740971596, 69.80305143995625, 209.6890983580181, 167.13999999999993, 374.2491644590152, -225.0855301360308, 179.07999999999987, 194.9699999999997, 3.84999999999996, -107.14890537992954, 321.3918416102897, -70.48861288744199, 430.1874295340255, 174.68999999999997, 217.90558759126642, 3.8099999999999645, 402.7914846952477, 172.42180230117947, 102.5600000000008, 192.31875447977905, 185.9399999999998, 266.55404472073474, 175.05999999999983], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.93558511354308, -10.78236011884451, -110.22844445606722, -36.09345093315074, -500.4540838122298, -387.38013902419607, -213.45512683357597, -22.184650416102905, -359.42557147020904, -351.8189350760924, 2.0000000000000013, -62.266707922701066, -63.89326199987963, -2.4098248451699877, -174.8824728541457, -57.253856305336214, -156.15409172636225, -0.02402873506939586, -41.117704612963514, -0.09580428799140676, 2.0000000000000013, -230.04680352967617, -13.573398651401714, -234.4890475233753, -18.636634962008603, -45.990953228109255, 0.2694852342918103, -33.86030270873135, -40.80065828907249, -68.54762416331735, 170.4059127598628, 175.07527269524618, 200.0, 117.37033021888308, -215.42526187075563, -20.72454593897101, -533.105916286517, 2.0000000000000013, 60.99574224872505, -254.84483424947584, 2.2053929867903728, 167.7837354454825, -63.073107937248515, -406.0507540873007, -175.90533194042322, 141.11215486902924, -327.59756285431354, -14.216473934846162, -73.8374723137082, -134.7003274458489, -10.172140713861575, -6.18726663097863, 128.80707503823368, 117.98471977585073, -22.16532907682484, 191.09, -59.912963980283706, 2.0000000000000013, 197.03, 163.57125665557678, -10.324956752223173, -114.38744466542879, 46.79611445038311, -121.26015279262867, -321.70117110330136, -343.10412100859827, 82.70803534096414, -56.58725349265222, 55.93250206210804, 2.0000000000000013, -166.0271357918885, -14.95928668978271, -15.357266227166422, 153.47, -41.85568813579288, -34.69048103021387, -154.64720730296642, -240.16123403028706, -198.67076449489534, 2.0000000000000013, -200.73119294994058, 2.98999999999998, -10.704115964045862, -258.5108005788851, -58.615170128052526, 2.0000000000000013, -237.9961127343461, -69.4042665767477, 25.897159399590354, -168.02980112184096, -48.38667846716447, 137.68887793823745, -0.9070797039681264, -242.57716332733744, -56.6781707274648, -272.8618485951978, -164.94523629834455, -29.40246657038265, 74.17032702814636, 147.42843628414988, -8.73961542310057, -29.83254077455427, -413.30189876754173, -44.9861896845147, 82.53395922112456, -129.36892815975366, -127.09520652393076, 40.68693394946449, 3.090891332177255, -15.959416453466408, -221.8946258522425, -82.44462905732402, 49.77464945199449, 66.58631458788864, -28.029592773223925, -5.817155705055759, 2.0000000000000013, 2.0000000000000013, 2.0000000000000013, -31.79514712692458, -200.5048210135842, -8.767856582821054, -224.10257640702338, 81.57795216551258, -19.265783369837703, 121.08461363274633, -43.02307874535226, -147.9124997003065, -100.8440813388588, -52.470717189933865, -466.7023640017286, -432.4381863864998, -5.3360327205862355, -184.93346973226474, 118.4785667954114, 2.0000000000000013, 2.0000000000000013, -21.929365223905346, -31.63544422839212, -17.727388407868464, 52.128298765438274, 18.213241177029477, -277.19302632859626, -268.6495113926092, -315.221858491256, -86.41659374852692, -91.48077425054869, -14.379815798634427, -289.94814716189006, -67.67752564593508, -45.08920856839326, -9.36747998931275, -223.6272325233639, -251.4962020946457, -4.482359299679421, 1.7341197149204517, 16.85000000000011, -430.3979285812612, -22.418655862796868, -45.717780936909065, -59.82463893583027, 141.30958945441276, -11.231943521856493, 49.718444724215516, -643.7210496075079, -762.254217394327, -21.24065092195143, 168.06218676278314, 168.88149287433163, -5.619782284624867, -4.538740711490194, -62.16667210242542, -365.33103471141783, -466.99543912651893, -60.698088333902824, -182.28994854255362, -365.526019523151, -340.61194506646825, 32.42767622780237, -129.22825372534058, 76.1034311691364, -85.99356872756908, 40.69155148007761, -62.614525294761386, -30.36920136392667, -57.821579425396145, 37.4815236872021, 154.73932821419498, 2.0000000000000013, -20.91830857242823, -10.700594069707284, -14.665623505074997, -11.817264719704104, 134.04590458957114, -34.52385193605491, 141.8330709693645, -61.814876300506356, 47.754742825501744, 124.3523441127249, 0.026314034897991168], "policy_predator_policy_reward": [15.064414886456934, 12.732360118844468, 280.49012149038106, 39.95681005564538, 340.362283648185, 511.83819462918655, 354.2909635935249, 16.43492911338754, 471.88942783571594, 483.84434186941706, 0.0, 64.05670792270071, 56.99768917503411, 44.28942502902158, 70.76390477383643, 249.34453993358488, 22.04212991346091, 248.4513914947598, 0.0, 132.72350890095487, 236.585212218951, 262.8945212439164, 15.503398651401675, 293.81904752337533, 20.546634962008902, 47.800953228108895, 1.7205147657081912, 35.72030270873098, 66.40065828907217, 70.44762416331832, 19.594087240137217, 17.92472730475381, 32.822435890202875, 52.1848609375715, 0.0, 324.82155338736277, 336.4052830435873, 389.90732059874597, 315.115248242226, 221.44516474238736, 6.694607013209624, 23.216264554517494, 64.9131079372488, 444.5107540873004, 272.6522596788452, 0.0, 415.5975628543133, 16.146473934846135, 193.4902502671548, 5.91657987823312, 12.122140713861533, 8.147266630978589, 58.19292496176632, 61.07594708816017, 24.055329076825135, 0.0, 147.71296398028355, 0.0, 30.428743344423225, 30.205639168992924, 13.878987890443813, 118.05885484803554, 221.53335903994648, 138.88737075405882, 381.7341259531829, 373.991356683727, 0.0, 137.8392181516877, 6.891650593402958, 90.175847344489, 0.0, 286.9064224816714, 17.28726622716659, 0.0, 11.695507402679713, 272.49707090585923, 417.4780612239901, 114.96547818266005, 60.563139740301686, 211.4776247545936, 15.43963895573312, 284.47580620474093, 5.066075303307221, 362.088841239624, 43.28072326307588, 152.33444686497663, 420.6303235669131, 67.67573071601278, 10.151992268948543, 271.9871368355444, 91.44780052892666, 0.0, 304.52872463261025, 173.22046275267536, 216.89364052747354, 232.53884613358298, 281.9452362983448, 31.342466570382953, 30.51363747024592, 80.0497318885562, 10.679615423100529, 36.672540774554506, 538.6043646583508, 345.30770556676714, 88.48646938536274, 223.91927593498508, 262.67039997439247, 0.0, 129.06606173475467, 157.38606870162366, 338.41142084880045, 255.5723496436613, 168.9863752652325, 0.0, 1.7099101973471662, 35.97683828093275, 0.0, 0.0, 0.0, 33.64514712692429, 100.70966637974094, 266.7336142990404, 153.50532945506555, 354.1602827005034, 61.36043361476985, 14.730736122321852, 99.75108701466368, 243.31393235606583, 113.47180387380787, 5.944779790228035, 729.3077325525121, 271.4598675767212, 299.28778758599304, 48.8482444289347, 54.521433204588604, 0.0, 0.0, 23.859365223905648, 33.56544422839187, 141.01738840786842, 113.969243038458, 131.16381607114693, 522.3280046091324, 81.79724966566545, 269.4504231113605, 282.37431926197814, 93.35077425054965, 16.329815798634442, 324.847924893717, 330.70801501942185, 46.95920856839289, 11.317479989312709, 262.60766485284046, 367.9620548079777, 126.87300721342268, 7.013629781051948, 379.6373484591555, 103.71363156206228, 26.39504400789914, 251.430491149825, 74.55050597450678, 11.104543506910328, 178.44041189476576, 157.3222513618905, 730.5549136111251, 450.3348232546794, 25.467695166852174, 6.790768992316089, 24.11850712566838, 7.589782284624825, 6.508740711490152, 64.04667210242508, 583.4796042094315, 141.69796424857572, 263.11906129851354, 301.2608171882326, 563.8221869204765, 71.82716478170084, 274.4073126348381, 252.58069439672568, 96.8965688308636, 87.68356872756884, 225.64376081873976, 14.18480058721038, 32.25920136392688, 59.74157942539576, 113.1414014604247, 97.42923133342593, 99.07630859686742, 92.26380227674082, 19.05495933848748, 108.87125823629476, 38.61533674181971, 31.474777868092513, 36.463851936054525, 42.166929030635465, 180.92210994342, 99.69206825231933, 1.7002959530624657, 48.98104589931465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5430806298580265, "mean_inference_ms": 1.6352724847979367, "mean_action_processing_ms": 0.25079036226519474, "mean_env_wait_ms": 0.18549825177201157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038366317749023438, "StateBufferConnector_ms": 0.0034093856811523438, "ViewRequirementAgentConnector_ms": 0.08923304080963135}, "num_episodes": 22, "episode_return_max": 430.1874295340255, "episode_return_min": -225.0855301360308, "episode_return_mean": 151.67619241633412, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.2933496752752, "num_env_steps_trained_throughput_per_sec": 383.2933496752752, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 10159.174, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10159.134, "sample_time_ms": 1272.082, "learn_time_ms": 8871.679, "learn_throughput": 450.873, "synch_weights_time_ms": 14.551}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "74486_00000", "date": "2024-08-16_15-06-27", "timestamp": 1723800987, "time_this_iter_s": 10.443609952926636, "time_total_s": 655.5548748970032, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39802d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 655.5548748970032, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 24.006666666666668, "ram_util_percent": 78.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.921883917327911, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.9720169382751305, "policy_loss": -0.004226805789460226, "vf_loss": 5.975372821313363, "vf_explained_var": -0.1799378720540849, "kl": 0.017418333679397522, "entropy": 1.246951150515723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4950763672432572, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.26195715268453, "policy_loss": -0.004931736804505505, "vf_loss": 6.2664540215144084, "vf_explained_var": -0.0013469515023408112, "kl": 0.005798430461716999, "entropy": 0.44408806644419513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 430.1874295340255, "episode_reward_min": -478.74299440816907, "episode_reward_mean": 158.0877896148601, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -872.3129720818803, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.03, "predator_policy": 861.6236685550552}, "policy_reward_mean": {"prey_policy": -75.56671645715693, "predator_policy": 154.61061126458705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.93000000000019, -9.130969614168961, 3.909999999999961, 366.06066686401095, 192.97999999999968, 89.80000000000089, 421.2356391689929, 7.225441320826501, 285.95669145175884, 90.92019052500955, 163.9599999999997, 155.0000000000002, 105.92000000000071, 155.40000000000003, 207.64640914253215, 137.63509807339673, 75.37000000000015, 102.17425221053355, 97.94000000000017, 139.00000000000028, 180.9056749718317, 140.00648738224263, 180.74999999999972, 234.26494435397962, 119.89246733839471, 118.9400000000003, 332.1621326710983, 8.779999999999928, 425.6239817730616, 265.5707763817184, 176.26212739992604, 273.58360531508833, 289.64451558289545, 285.34733930511567, 3.839999999999961, 3.9999999999999587, 3.8499999999999606, 158.17060308237615, 365.1409879140581, 177.90999999999988, 152.12944092507163, -33.89821486475788, 101.62704974100527, 157.8665295620769, 174.99999999999983, 3.929999999999959, 125.22000000000057, 315.4745990520726, 58.28271655359256, 150.18629013355488, 3.8199999999999625, 297.9302671053112, 3.8199999999999603, 155.44628504280854, 131.13839740971596, 69.80305143995625, 209.6890983580181, 167.13999999999993, 374.2491644590152, -225.0855301360308, 179.07999999999987, 194.9699999999997, 3.84999999999996, -107.14890537992954, 321.3918416102897, -70.48861288744199, 430.1874295340255, 174.68999999999997, 217.90558759126642, 3.8099999999999645, 402.7914846952477, 172.42180230117947, 102.5600000000008, 192.31875447977905, 185.9399999999998, 266.55404472073474, 175.05999999999983, -8.05974386695054, 23.06406110698394, 180.1400803575225, 365.2387422735348, -2.160277323935089, 374.17643445193454, 331.7278223760935, 381.41701758749144, 195.92999999999967, 322.0904927137945, 379.5516075306741, 184.67057773391008, 14.103133618980724, 127.97000000000044, 184.36, -478.74299440816907, 213.8212842161182, 195.44449200114803, 192.76039815932762, 148.97000000000003, 305.88688054200577, 134.7073183543046, 178.46999999999963], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-327.59756285431354, -14.216473934846162, -73.8374723137082, -134.7003274458489, -10.172140713861575, -6.18726663097863, 128.80707503823368, 117.98471977585073, -22.16532907682484, 191.09, -59.912963980283706, 2.0000000000000013, 197.03, 163.57125665557678, -10.324956752223173, -114.38744466542879, 46.79611445038311, -121.26015279262867, -321.70117110330136, -343.10412100859827, 82.70803534096414, -56.58725349265222, 55.93250206210804, 2.0000000000000013, -166.0271357918885, -14.95928668978271, -15.357266227166422, 153.47, -41.85568813579288, -34.69048103021387, -154.64720730296642, -240.16123403028706, -198.67076449489534, 2.0000000000000013, -200.73119294994058, 2.98999999999998, -10.704115964045862, -258.5108005788851, -58.615170128052526, 2.0000000000000013, -237.9961127343461, -69.4042665767477, 25.897159399590354, -168.02980112184096, -48.38667846716447, 137.68887793823745, -0.9070797039681264, -242.57716332733744, -56.6781707274648, -272.8618485951978, -164.94523629834455, -29.40246657038265, 74.17032702814636, 147.42843628414988, -8.73961542310057, -29.83254077455427, -413.30189876754173, -44.9861896845147, 82.53395922112456, -129.36892815975366, -127.09520652393076, 40.68693394946449, 3.090891332177255, -15.959416453466408, -221.8946258522425, -82.44462905732402, 49.77464945199449, 66.58631458788864, -28.029592773223925, -5.817155705055759, 2.0000000000000013, 2.0000000000000013, 2.0000000000000013, -31.79514712692458, -200.5048210135842, -8.767856582821054, -224.10257640702338, 81.57795216551258, -19.265783369837703, 121.08461363274633, -43.02307874535226, -147.9124997003065, -100.8440813388588, -52.470717189933865, -466.7023640017286, -432.4381863864998, -5.3360327205862355, -184.93346973226474, 118.4785667954114, 2.0000000000000013, 2.0000000000000013, -21.929365223905346, -31.63544422839212, -17.727388407868464, 52.128298765438274, 18.213241177029477, -277.19302632859626, -268.6495113926092, -315.221858491256, -86.41659374852692, -91.48077425054869, -14.379815798634427, -289.94814716189006, -67.67752564593508, -45.08920856839326, -9.36747998931275, -223.6272325233639, -251.4962020946457, -4.482359299679421, 1.7341197149204517, 16.85000000000011, -430.3979285812612, -22.418655862796868, -45.717780936909065, -59.82463893583027, 141.30958945441276, -11.231943521856493, 49.718444724215516, -643.7210496075079, -762.254217394327, -21.24065092195143, 168.06218676278314, 168.88149287433163, -5.619782284624867, -4.538740711490194, -62.16667210242542, -365.33103471141783, -466.99543912651893, -60.698088333902824, -182.28994854255362, -365.526019523151, -340.61194506646825, 32.42767622780237, -129.22825372534058, 76.1034311691364, -85.99356872756908, 40.69155148007761, -62.614525294761386, -30.36920136392667, -57.821579425396145, 37.4815236872021, 154.73932821419498, 2.0000000000000013, -20.91830857242823, -10.700594069707284, -14.665623505074997, -11.817264719704104, 134.04590458957114, -34.52385193605491, 141.8330709693645, -61.814876300506356, 47.754742825501744, 124.3523441127249, 0.026314034897991168, -103.75426096939738, -15.081639383721786, -737.3528326112068, 2.0000000000000013, -9.440875883236725, 13.9369806970135, 36.33862524199532, 113.72156054130333, -44.77880412577292, -116.78739056248013, 128.80512011685897, 170.40096861925952, 120.19936580003898, 72.32830573075773, -721.1791789125245, -26.160112583111594, -19.004159662221515, 181.49112276100692, -718.4906413855823, -52.543252597170415, 115.47841238810393, 161.97596044547117, -24.505771237893494, 176.40061298597666, -350.25781336001097, -655.8314906552249, -32.80684812467644, -6.003046070526134, -153.3013618591513, 106.8743652948268, -672.1226286512899, -759.9329936076707, -872.3129720818803, -24.97060941764978, -292.5158394538679, -0.75084833214539, -7.343009376452695, 151.2131487049009, 3.168386442041097, -22.491410098868528, 72.36224727843161, 116.53299175023918, -159.01322514553715, 0.21274764621960268, 71.60854484199119, -130.17705380005674], "policy_predator_policy_reward": [415.5975628543133, 16.146473934846135, 193.4902502671548, 5.91657987823312, 12.122140713861533, 8.147266630978589, 58.19292496176632, 61.07594708816017, 24.055329076825135, 0.0, 147.71296398028355, 0.0, 30.428743344423225, 30.205639168992924, 13.878987890443813, 118.05885484803554, 221.53335903994648, 138.88737075405882, 381.7341259531829, 373.991356683727, 0.0, 137.8392181516877, 6.891650593402958, 90.175847344489, 0.0, 286.9064224816714, 17.28726622716659, 0.0, 11.695507402679713, 272.49707090585923, 417.4780612239901, 114.96547818266005, 60.563139740301686, 211.4776247545936, 15.43963895573312, 284.47580620474093, 5.066075303307221, 362.088841239624, 43.28072326307588, 152.33444686497663, 420.6303235669131, 67.67573071601278, 10.151992268948543, 271.9871368355444, 91.44780052892666, 0.0, 304.52872463261025, 173.22046275267536, 216.89364052747354, 232.53884613358298, 281.9452362983448, 31.342466570382953, 30.51363747024592, 80.0497318885562, 10.679615423100529, 36.672540774554506, 538.6043646583508, 345.30770556676714, 88.48646938536274, 223.91927593498508, 262.67039997439247, 0.0, 129.06606173475467, 157.38606870162366, 338.41142084880045, 255.5723496436613, 168.9863752652325, 0.0, 1.7099101973471662, 35.97683828093275, 0.0, 0.0, 0.0, 33.64514712692429, 100.70966637974094, 266.7336142990404, 153.50532945506555, 354.1602827005034, 61.36043361476985, 14.730736122321852, 99.75108701466368, 243.31393235606583, 113.47180387380787, 5.944779790228035, 729.3077325525121, 271.4598675767212, 299.28778758599304, 48.8482444289347, 54.521433204588604, 0.0, 0.0, 23.859365223905648, 33.56544422839187, 141.01738840786842, 113.969243038458, 131.16381607114693, 522.3280046091324, 81.79724966566545, 269.4504231113605, 282.37431926197814, 93.35077425054965, 16.329815798634442, 324.847924893717, 330.70801501942185, 46.95920856839289, 11.317479989312709, 262.60766485284046, 367.9620548079777, 126.87300721342268, 7.013629781051948, 379.6373484591555, 103.71363156206228, 26.39504400789914, 251.430491149825, 74.55050597450678, 11.104543506910328, 178.44041189476576, 157.3222513618905, 730.5549136111251, 450.3348232546794, 25.467695166852174, 6.790768992316089, 24.11850712566838, 7.589782284624825, 6.508740711490152, 64.04667210242508, 583.4796042094315, 141.69796424857572, 263.11906129851354, 301.2608171882326, 563.8221869204765, 71.82716478170084, 274.4073126348381, 252.58069439672568, 96.8965688308636, 87.68356872756884, 225.64376081873976, 14.18480058721038, 32.25920136392688, 59.74157942539576, 113.1414014604247, 97.42923133342593, 99.07630859686742, 92.26380227674082, 19.05495933848748, 108.87125823629476, 38.61533674181971, 31.474777868092513, 36.463851936054525, 42.166929030635465, 180.92210994342, 99.69206825231933, 1.7002959530624657, 48.98104589931465, 1.7103542905275613, 109.06580219564223, 63.78787266919252, 694.6290210489983, 55.37258557807071, 120.27138996567516, 117.30636186933175, 97.87219462090437, 36.708408103227676, 122.6975092610909, 60.958573488956816, 14.01177222685924, 105.04339145356907, 34.15675939172779, 375.7513475919273, 753.0049614912011, 20.934159662221816, 12.508877238993069, 420.49358958803896, 672.630797108509, 46.10982907144354, 55.98740562565546, 24.66559470290961, 8.110141282917793, 509.7692078577575, 510.4232297764584, 158.80684812467638, 7.973046070526092, 154.66136185915155, 76.1256347051732, 816.4977327973112, 136.81489505348105, 249.48119716059375, 861.6236685550552, 200.267114121491, 288.44406566567085, 27.93685129509913, 20.95340753578058, 0.0, 168.29302365682778, 104.4756742806284, 12.515967232706577, 20.10892615083109, 273.3988697027909, 14.979811655694737, 222.05869730237015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5405876014656738, "mean_inference_ms": 1.6312204219002988, "mean_action_processing_ms": 0.24898333954294988, "mean_env_wait_ms": 0.1847207796598229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038913488388061523, "StateBufferConnector_ms": 0.0033568143844604492, "ViewRequirementAgentConnector_ms": 0.0896683931350708}, "num_episodes": 23, "episode_return_max": 430.1874295340255, "episode_return_min": -478.74299440816907, "episode_return_mean": 158.0877896148601, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.04767132894074, "num_env_steps_trained_throughput_per_sec": 397.04767132894074, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 10181.679, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10181.639, "sample_time_ms": 1271.789, "learn_time_ms": 8894.373, "learn_throughput": 449.723, "synch_weights_time_ms": 14.612}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "74486_00000", "date": "2024-08-16_15-06-37", "timestamp": 1723800997, "time_this_iter_s": 10.080313920974731, "time_total_s": 665.6351888179779, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397746820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 665.6351888179779, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 26.38571428571429, "ram_util_percent": 78.59285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.927454497637572, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.360240299739535, "policy_loss": 0.00035174098136839726, "vf_loss": 6.35932316603484, "vf_explained_var": -0.11716271150049079, "kl": 0.011307724232930822, "entropy": 1.259287118533301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9422223223895623, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.073151262727364, "policy_loss": -0.004834691465403589, "vf_loss": 6.077533638161957, "vf_explained_var": -0.004770380857760314, "kl": 0.006031212457695387, "entropy": 0.5118939557561168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 430.1874295340255, "episode_reward_min": -478.74299440816907, "episode_reward_mean": 156.40607733244806, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -872.3129720818803, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 181.49112276100692, "predator_policy": 861.6236685550552}, "policy_reward_mean": {"prey_policy": -89.97537776292089, "predator_policy": 168.178416429145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.94000000000017, 139.00000000000028, 180.9056749718317, 140.00648738224263, 180.74999999999972, 234.26494435397962, 119.89246733839471, 118.9400000000003, 332.1621326710983, 8.779999999999928, 425.6239817730616, 265.5707763817184, 176.26212739992604, 273.58360531508833, 289.64451558289545, 285.34733930511567, 3.839999999999961, 3.9999999999999587, 3.8499999999999606, 158.17060308237615, 365.1409879140581, 177.90999999999988, 152.12944092507163, -33.89821486475788, 101.62704974100527, 157.8665295620769, 174.99999999999983, 3.929999999999959, 125.22000000000057, 315.4745990520726, 58.28271655359256, 150.18629013355488, 3.8199999999999625, 297.9302671053112, 3.8199999999999603, 155.44628504280854, 131.13839740971596, 69.80305143995625, 209.6890983580181, 167.13999999999993, 374.2491644590152, -225.0855301360308, 179.07999999999987, 194.9699999999997, 3.84999999999996, -107.14890537992954, 321.3918416102897, -70.48861288744199, 430.1874295340255, 174.68999999999997, 217.90558759126642, 3.8099999999999645, 402.7914846952477, 172.42180230117947, 102.5600000000008, 192.31875447977905, 185.9399999999998, 266.55404472073474, 175.05999999999983, -8.05974386695054, 23.06406110698394, 180.1400803575225, 365.2387422735348, -2.160277323935089, 374.17643445193454, 331.7278223760935, 381.41701758749144, 195.92999999999967, 322.0904927137945, 379.5516075306741, 184.67057773391008, 14.103133618980724, 127.97000000000044, 184.36, -478.74299440816907, 213.8212842161182, 195.44449200114803, 192.76039815932762, 148.97000000000003, 305.88688054200577, 134.7073183543046, 178.46999999999963, 384.05546111299515, 37.010000000000176, 28.898244382134713, 321.9064454449854, 183.02417968232552, -8.355432104279302, 14.621395797902046, 333.50796398265436, 290.6951350840006, 173.4945716184954, -402.8821911521599, 49.28296195126658, 330.0547211367314, 38.16267705685884, 370.9313649528837, 202.44722674942705, 3.579999999999966, 123.38746520546968], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.704115964045862, -258.5108005788851, -58.615170128052526, 2.0000000000000013, -237.9961127343461, -69.4042665767477, 25.897159399590354, -168.02980112184096, -48.38667846716447, 137.68887793823745, -0.9070797039681264, -242.57716332733744, -56.6781707274648, -272.8618485951978, -164.94523629834455, -29.40246657038265, 74.17032702814636, 147.42843628414988, -8.73961542310057, -29.83254077455427, -413.30189876754173, -44.9861896845147, 82.53395922112456, -129.36892815975366, -127.09520652393076, 40.68693394946449, 3.090891332177255, -15.959416453466408, -221.8946258522425, -82.44462905732402, 49.77464945199449, 66.58631458788864, -28.029592773223925, -5.817155705055759, 2.0000000000000013, 2.0000000000000013, 2.0000000000000013, -31.79514712692458, -200.5048210135842, -8.767856582821054, -224.10257640702338, 81.57795216551258, -19.265783369837703, 121.08461363274633, -43.02307874535226, -147.9124997003065, -100.8440813388588, -52.470717189933865, -466.7023640017286, -432.4381863864998, -5.3360327205862355, -184.93346973226474, 118.4785667954114, 2.0000000000000013, 2.0000000000000013, -21.929365223905346, -31.63544422839212, -17.727388407868464, 52.128298765438274, 18.213241177029477, -277.19302632859626, -268.6495113926092, -315.221858491256, -86.41659374852692, -91.48077425054869, -14.379815798634427, -289.94814716189006, -67.67752564593508, -45.08920856839326, -9.36747998931275, -223.6272325233639, -251.4962020946457, -4.482359299679421, 1.7341197149204517, 16.85000000000011, -430.3979285812612, -22.418655862796868, -45.717780936909065, -59.82463893583027, 141.30958945441276, -11.231943521856493, 49.718444724215516, -643.7210496075079, -762.254217394327, -21.24065092195143, 168.06218676278314, 168.88149287433163, -5.619782284624867, -4.538740711490194, -62.16667210242542, -365.33103471141783, -466.99543912651893, -60.698088333902824, -182.28994854255362, -365.526019523151, -340.61194506646825, 32.42767622780237, -129.22825372534058, 76.1034311691364, -85.99356872756908, 40.69155148007761, -62.614525294761386, -30.36920136392667, -57.821579425396145, 37.4815236872021, 154.73932821419498, 2.0000000000000013, -20.91830857242823, -10.700594069707284, -14.665623505074997, -11.817264719704104, 134.04590458957114, -34.52385193605491, 141.8330709693645, -61.814876300506356, 47.754742825501744, 124.3523441127249, 0.026314034897991168, -103.75426096939738, -15.081639383721786, -737.3528326112068, 2.0000000000000013, -9.440875883236725, 13.9369806970135, 36.33862524199532, 113.72156054130333, -44.77880412577292, -116.78739056248013, 128.80512011685897, 170.40096861925952, 120.19936580003898, 72.32830573075773, -721.1791789125245, -26.160112583111594, -19.004159662221515, 181.49112276100692, -718.4906413855823, -52.543252597170415, 115.47841238810393, 161.97596044547117, -24.505771237893494, 176.40061298597666, -350.25781336001097, -655.8314906552249, -32.80684812467644, -6.003046070526134, -153.3013618591513, 106.8743652948268, -672.1226286512899, -759.9329936076707, -872.3129720818803, -24.97060941764978, -292.5158394538679, -0.75084833214539, -7.343009376452695, 151.2131487049009, 3.168386442041097, -22.491410098868528, 72.36224727843161, 116.53299175023918, -159.01322514553715, 0.21274764621960268, 71.60854484199119, -130.17705380005674, 175.6347478908538, 110.76010955640528, -538.7204463715223, -2.6200415543110154, -7.169647983138052, -778.3193205304842, -81.69234284697359, -22.632067041681978, 2.0000000000000013, 104.28656526205174, -25.019447167716848, -64.68885356255174, -423.8128069251402, -403.97748293673703, 124.11365033416087, 131.09612567728806, 22.34102980442347, 76.08134278665167, 17.313026157943085, -51.48206496405747, -684.0451424359402, -616.9080099861275, -23.62271035739445, -622.9338040257516, -9.079047845132024, 103.59032579718584, -682.2559035107085, -36.899892050949404, 143.8481324370417, 81.64135884125574, -45.37169371778356, 2.0000000000000013, -99.48945994867681, -11.192570196521592, -221.93673044940272, -59.444379384663364], "policy_predator_policy_reward": [5.066075303307221, 362.088841239624, 43.28072326307588, 152.33444686497663, 420.6303235669131, 67.67573071601278, 10.151992268948543, 271.9871368355444, 91.44780052892666, 0.0, 304.52872463261025, 173.22046275267536, 216.89364052747354, 232.53884613358298, 281.9452362983448, 31.342466570382953, 30.51363747024592, 80.0497318885562, 10.679615423100529, 36.672540774554506, 538.6043646583508, 345.30770556676714, 88.48646938536274, 223.91927593498508, 262.67039997439247, 0.0, 129.06606173475467, 157.38606870162366, 338.41142084880045, 255.5723496436613, 168.9863752652325, 0.0, 1.7099101973471662, 35.97683828093275, 0.0, 0.0, 0.0, 33.64514712692429, 100.70966637974094, 266.7336142990404, 153.50532945506555, 354.1602827005034, 61.36043361476985, 14.730736122321852, 99.75108701466368, 243.31393235606583, 113.47180387380787, 5.944779790228035, 729.3077325525121, 271.4598675767212, 299.28778758599304, 48.8482444289347, 54.521433204588604, 0.0, 0.0, 23.859365223905648, 33.56544422839187, 141.01738840786842, 113.969243038458, 131.16381607114693, 522.3280046091324, 81.79724966566545, 269.4504231113605, 282.37431926197814, 93.35077425054965, 16.329815798634442, 324.847924893717, 330.70801501942185, 46.95920856839289, 11.317479989312709, 262.60766485284046, 367.9620548079777, 126.87300721342268, 7.013629781051948, 379.6373484591555, 103.71363156206228, 26.39504400789914, 251.430491149825, 74.55050597450678, 11.104543506910328, 178.44041189476576, 157.3222513618905, 730.5549136111251, 450.3348232546794, 25.467695166852174, 6.790768992316089, 24.11850712566838, 7.589782284624825, 6.508740711490152, 64.04667210242508, 583.4796042094315, 141.69796424857572, 263.11906129851354, 301.2608171882326, 563.8221869204765, 71.82716478170084, 274.4073126348381, 252.58069439672568, 96.8965688308636, 87.68356872756884, 225.64376081873976, 14.18480058721038, 32.25920136392688, 59.74157942539576, 113.1414014604247, 97.42923133342593, 99.07630859686742, 92.26380227674082, 19.05495933848748, 108.87125823629476, 38.61533674181971, 31.474777868092513, 36.463851936054525, 42.166929030635465, 180.92210994342, 99.69206825231933, 1.7002959530624657, 48.98104589931465, 1.7103542905275613, 109.06580219564223, 63.78787266919252, 694.6290210489983, 55.37258557807071, 120.27138996567516, 117.30636186933175, 97.87219462090437, 36.708408103227676, 122.6975092610909, 60.958573488956816, 14.01177222685924, 105.04339145356907, 34.15675939172779, 375.7513475919273, 753.0049614912011, 20.934159662221816, 12.508877238993069, 420.49358958803896, 672.630797108509, 46.10982907144354, 55.98740562565546, 24.66559470290961, 8.110141282917793, 509.7692078577575, 510.4232297764584, 158.80684812467638, 7.973046070526092, 154.66136185915155, 76.1256347051732, 816.4977327973112, 136.81489505348105, 249.48119716059375, 861.6236685550552, 200.267114121491, 288.44406566567085, 27.93685129509913, 20.95340753578058, 0.0, 168.29302365682778, 104.4756742806284, 12.515967232706577, 20.10892615083109, 273.3988697027909, 14.979811655694737, 222.05869730237015, 63.15802700451191, 34.50257666122417, 75.28547973366649, 503.06500819216666, 760.6677356681572, 53.719477227599434, 286.0981476242442, 140.13270770939684, 63.889036998229116, 12.848577422044912, 4.646445516972049, 76.70642310901837, 446.767947892353, 395.6437377674266, 66.97370649419464, 11.324481477010746, 15.87045273798225, 176.40230975494316, 76.1182218326455, 131.54538859196404, 85.40860425204477, 812.662357017863, 613.9128963065236, 81.92658002788917, 167.1857769912284, 68.35766619344916, 164.8668113172677, 592.451661301249, 85.75775456347937, 59.68411911110702, 155.18098200772621, 90.63793845948504, 11.925365085765765, 102.33666505943339, 34.87920199681351, 369.88937304272133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5424247707420299, "mean_inference_ms": 1.6374386372844865, "mean_action_processing_ms": 0.2498265860518484, "mean_env_wait_ms": 0.18525665019028664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038460493087768555, "StateBufferConnector_ms": 0.0033593177795410156, "ViewRequirementAgentConnector_ms": 0.09065449237823486}, "num_episodes": 18, "episode_return_max": 430.1874295340255, "episode_return_min": -478.74299440816907, "episode_return_mean": 156.40607733244806, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.4151017303391, "num_env_steps_trained_throughput_per_sec": 389.4151017303391, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 10180.408, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10180.368, "sample_time_ms": 1275.724, "learn_time_ms": 8889.234, "learn_throughput": 449.983, "synch_weights_time_ms": 14.512}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "74486_00000", "date": "2024-08-16_15-06-47", "timestamp": 1723801007, "time_this_iter_s": 10.277607202529907, "time_total_s": 675.9127960205078, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39800bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 675.9127960205078, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 26.253333333333337, "ram_util_percent": 78.45333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.01106451535351, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.750859893314422, "policy_loss": -0.0058122049551457165, "vf_loss": 5.755916994337052, "vf_explained_var": -0.21879082836171307, "kl": 0.015102105372970244, "entropy": 1.2088393143875888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5623174240034092, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.350883163220037, "policy_loss": -0.004652952407511375, "vf_loss": 6.3549007107971835, "vf_explained_var": -0.0037626954928907767, "kl": 0.008472214150790249, "entropy": 0.5435046372117189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 430.1874295340255, "episode_reward_min": -478.74299440816907, "episode_reward_mean": 151.731587613475, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -872.3129720818803, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 861.6236685550552}, "policy_reward_mean": {"prey_policy": -100.94389027049618, "predator_policy": 176.8096840772337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8499999999999606, 158.17060308237615, 365.1409879140581, 177.90999999999988, 152.12944092507163, -33.89821486475788, 101.62704974100527, 157.8665295620769, 174.99999999999983, 3.929999999999959, 125.22000000000057, 315.4745990520726, 58.28271655359256, 150.18629013355488, 3.8199999999999625, 297.9302671053112, 3.8199999999999603, 155.44628504280854, 131.13839740971596, 69.80305143995625, 209.6890983580181, 167.13999999999993, 374.2491644590152, -225.0855301360308, 179.07999999999987, 194.9699999999997, 3.84999999999996, -107.14890537992954, 321.3918416102897, -70.48861288744199, 430.1874295340255, 174.68999999999997, 217.90558759126642, 3.8099999999999645, 402.7914846952477, 172.42180230117947, 102.5600000000008, 192.31875447977905, 185.9399999999998, 266.55404472073474, 175.05999999999983, -8.05974386695054, 23.06406110698394, 180.1400803575225, 365.2387422735348, -2.160277323935089, 374.17643445193454, 331.7278223760935, 381.41701758749144, 195.92999999999967, 322.0904927137945, 379.5516075306741, 184.67057773391008, 14.103133618980724, 127.97000000000044, 184.36, -478.74299440816907, 213.8212842161182, 195.44449200114803, 192.76039815932762, 148.97000000000003, 305.88688054200577, 134.7073183543046, 178.46999999999963, 384.05546111299515, 37.010000000000176, 28.898244382134713, 321.9064454449854, 183.02417968232552, -8.355432104279302, 14.621395797902046, 333.50796398265436, 290.6951350840006, 173.4945716184954, -402.8821911521599, 49.28296195126658, 330.0547211367314, 38.16267705685884, 370.9313649528837, 202.44722674942705, 3.579999999999966, 123.38746520546968, 182.53880993217496, 167.3003807561762, 355.8464376649308, 219.4171552836243, 201.66999999999962, 48.909999999999975, 75.31627534167635, 1.1855282655747017, 423.35684255868233, 13.611867545632995, 68.89384926585252, 368.0342748075057, 96.00920262401704, 242.24486683648286, 346.16716893699675, -38.52218427960796, -64.51590558312313, 101.60051062144652], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -31.79514712692458, -200.5048210135842, -8.767856582821054, -224.10257640702338, 81.57795216551258, -19.265783369837703, 121.08461363274633, -43.02307874535226, -147.9124997003065, -100.8440813388588, -52.470717189933865, -466.7023640017286, -432.4381863864998, -5.3360327205862355, -184.93346973226474, 118.4785667954114, 2.0000000000000013, 2.0000000000000013, -21.929365223905346, -31.63544422839212, -17.727388407868464, 52.128298765438274, 18.213241177029477, -277.19302632859626, -268.6495113926092, -315.221858491256, -86.41659374852692, -91.48077425054869, -14.379815798634427, -289.94814716189006, -67.67752564593508, -45.08920856839326, -9.36747998931275, -223.6272325233639, -251.4962020946457, -4.482359299679421, 1.7341197149204517, 16.85000000000011, -430.3979285812612, -22.418655862796868, -45.717780936909065, -59.82463893583027, 141.30958945441276, -11.231943521856493, 49.718444724215516, -643.7210496075079, -762.254217394327, -21.24065092195143, 168.06218676278314, 168.88149287433163, -5.619782284624867, -4.538740711490194, -62.16667210242542, -365.33103471141783, -466.99543912651893, -60.698088333902824, -182.28994854255362, -365.526019523151, -340.61194506646825, 32.42767622780237, -129.22825372534058, 76.1034311691364, -85.99356872756908, 40.69155148007761, -62.614525294761386, -30.36920136392667, -57.821579425396145, 37.4815236872021, 154.73932821419498, 2.0000000000000013, -20.91830857242823, -10.700594069707284, -14.665623505074997, -11.817264719704104, 134.04590458957114, -34.52385193605491, 141.8330709693645, -61.814876300506356, 47.754742825501744, 124.3523441127249, 0.026314034897991168, -103.75426096939738, -15.081639383721786, -737.3528326112068, 2.0000000000000013, -9.440875883236725, 13.9369806970135, 36.33862524199532, 113.72156054130333, -44.77880412577292, -116.78739056248013, 128.80512011685897, 170.40096861925952, 120.19936580003898, 72.32830573075773, -721.1791789125245, -26.160112583111594, -19.004159662221515, 181.49112276100692, -718.4906413855823, -52.543252597170415, 115.47841238810393, 161.97596044547117, -24.505771237893494, 176.40061298597666, -350.25781336001097, -655.8314906552249, -32.80684812467644, -6.003046070526134, -153.3013618591513, 106.8743652948268, -672.1226286512899, -759.9329936076707, -872.3129720818803, -24.97060941764978, -292.5158394538679, -0.75084833214539, -7.343009376452695, 151.2131487049009, 3.168386442041097, -22.491410098868528, 72.36224727843161, 116.53299175023918, -159.01322514553715, 0.21274764621960268, 71.60854484199119, -130.17705380005674, 175.6347478908538, 110.76010955640528, -538.7204463715223, -2.6200415543110154, -7.169647983138052, -778.3193205304842, -81.69234284697359, -22.632067041681978, 2.0000000000000013, 104.28656526205174, -25.019447167716848, -64.68885356255174, -423.8128069251402, -403.97748293673703, 124.11365033416087, 131.09612567728806, 22.34102980442347, 76.08134278665167, 17.313026157943085, -51.48206496405747, -684.0451424359402, -616.9080099861275, -23.62271035739445, -622.9338040257516, -9.079047845132024, 103.59032579718584, -682.2559035107085, -36.899892050949404, 143.8481324370417, 81.64135884125574, -45.37169371778356, 2.0000000000000013, -99.48945994867681, -11.192570196521592, -221.93673044940272, -59.444379384663364, 115.62630311202903, -22.948783024493963, 30.441228775507934, -12.055327221622111, 133.13165580201752, 95.00532917512851, 78.1362009844067, -10.97533977306659, 200.0, -102.0987793966101, -496.4601069651448, -22.27611820510341, 2.0000000000000013, -233.20904964787405, -42.86385648480712, -21.82151846860783, 140.52639475982792, -49.90315445730833, -5.919673263640769, -671.2526293800221, -569.4122254046732, -27.819644129138528, 55.05894268110848, -99.63264678107575, -8.407736505198706, -579.450194396628, 41.0412019493602, -83.24818909539295, 2.0000000000000013, -559.045482040592, -196.49392489764392, -223.97033526882058, -213.44849675904507, -657.2254593349252, -226.99622440471998, -42.36602422400379], "policy_predator_policy_reward": [0.0, 33.64514712692429, 100.70966637974094, 266.7336142990404, 153.50532945506555, 354.1602827005034, 61.36043361476985, 14.730736122321852, 99.75108701466368, 243.31393235606583, 113.47180387380787, 5.944779790228035, 729.3077325525121, 271.4598675767212, 299.28778758599304, 48.8482444289347, 54.521433204588604, 0.0, 0.0, 23.859365223905648, 33.56544422839187, 141.01738840786842, 113.969243038458, 131.16381607114693, 522.3280046091324, 81.79724966566545, 269.4504231113605, 282.37431926197814, 93.35077425054965, 16.329815798634442, 324.847924893717, 330.70801501942185, 46.95920856839289, 11.317479989312709, 262.60766485284046, 367.9620548079777, 126.87300721342268, 7.013629781051948, 379.6373484591555, 103.71363156206228, 26.39504400789914, 251.430491149825, 74.55050597450678, 11.104543506910328, 178.44041189476576, 157.3222513618905, 730.5549136111251, 450.3348232546794, 25.467695166852174, 6.790768992316089, 24.11850712566838, 7.589782284624825, 6.508740711490152, 64.04667210242508, 583.4796042094315, 141.69796424857572, 263.11906129851354, 301.2608171882326, 563.8221869204765, 71.82716478170084, 274.4073126348381, 252.58069439672568, 96.8965688308636, 87.68356872756884, 225.64376081873976, 14.18480058721038, 32.25920136392688, 59.74157942539576, 113.1414014604247, 97.42923133342593, 99.07630859686742, 92.26380227674082, 19.05495933848748, 108.87125823629476, 38.61533674181971, 31.474777868092513, 36.463851936054525, 42.166929030635465, 180.92210994342, 99.69206825231933, 1.7002959530624657, 48.98104589931465, 1.7103542905275613, 109.06580219564223, 63.78787266919252, 694.6290210489983, 55.37258557807071, 120.27138996567516, 117.30636186933175, 97.87219462090437, 36.708408103227676, 122.6975092610909, 60.958573488956816, 14.01177222685924, 105.04339145356907, 34.15675939172779, 375.7513475919273, 753.0049614912011, 20.934159662221816, 12.508877238993069, 420.49358958803896, 672.630797108509, 46.10982907144354, 55.98740562565546, 24.66559470290961, 8.110141282917793, 509.7692078577575, 510.4232297764584, 158.80684812467638, 7.973046070526092, 154.66136185915155, 76.1256347051732, 816.4977327973112, 136.81489505348105, 249.48119716059375, 861.6236685550552, 200.267114121491, 288.44406566567085, 27.93685129509913, 20.95340753578058, 0.0, 168.29302365682778, 104.4756742806284, 12.515967232706577, 20.10892615083109, 273.3988697027909, 14.979811655694737, 222.05869730237015, 63.15802700451191, 34.50257666122417, 75.28547973366649, 503.06500819216666, 760.6677356681572, 53.719477227599434, 286.0981476242442, 140.13270770939684, 63.889036998229116, 12.848577422044912, 4.646445516972049, 76.70642310901837, 446.767947892353, 395.6437377674266, 66.97370649419464, 11.324481477010746, 15.87045273798225, 176.40230975494316, 76.1182218326455, 131.54538859196404, 85.40860425204477, 812.662357017863, 613.9128963065236, 81.92658002788917, 167.1857769912284, 68.35766619344916, 164.8668113172677, 592.451661301249, 85.75775456347937, 59.68411911110702, 155.18098200772621, 90.63793845948504, 11.925365085765765, 102.33666505943339, 34.87920199681351, 369.88937304272133, 17.4567699217604, 72.40451992288006, 95.79336285821184, 53.12111634407855, 91.80835195791704, 35.90110072986781, 75.8221363074885, 76.43415776479624, 0.0, 103.76877939661095, 60.2474789971683, 507.39874617308004, 194.07713081956726, 112.44819416998241, 44.763856484806745, 21.107046734182838, 172.3263794435026, 160.40722281265997, 554.8671914447152, 135.91697874458137, 110.86520223413028, 555.2605165655343, 220.74401060709863, 191.86396830037452, 340.4515918298914, 343.41554169595304, 213.68158625071231, 70.77026773180336, 496.67315410273113, 406.5394968748584, 240.5685978569839, 141.3734780298707, 705.6721788767518, 100.48587163409401, 67.75080995002803, 303.2119493001414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5421124198908066, "mean_inference_ms": 1.6382495988108616, "mean_action_processing_ms": 0.24942135541257834, "mean_env_wait_ms": 0.18513833001140612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038346052169799805, "StateBufferConnector_ms": 0.0033698081970214844, "ViewRequirementAgentConnector_ms": 0.0903635025024414}, "num_episodes": 18, "episode_return_max": 430.1874295340255, "episode_return_min": -478.74299440816907, "episode_return_mean": 151.731587613475, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.9745010799865, "num_env_steps_trained_throughput_per_sec": 404.9745010799865, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 10149.263, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10149.222, "sample_time_ms": 1270.27, "learn_time_ms": 8863.486, "learn_throughput": 451.29, "synch_weights_time_ms": 14.537}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "74486_00000", "date": "2024-08-16_15-06-57", "timestamp": 1723801017, "time_this_iter_s": 9.881967067718506, "time_total_s": 685.7947630882263, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3973a6550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 685.7947630882263, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 28.085714285714282, "ram_util_percent": 78.42142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.08509114636946, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.939536343680488, "policy_loss": -0.005096282899532486, "vf_loss": 5.943860162250579, "vf_explained_var": -0.2853759025139783, "kl": 0.015449822492150503, "entropy": 1.1325413309707844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6101831861273952, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.627944445483899, "policy_loss": -0.0033973216798609844, "vf_loss": 6.630924492285996, "vf_explained_var": 0.0008231684644386251, "kl": 0.0055637878597583875, "entropy": 0.5550911907481137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 535.1717120466265, "episode_reward_min": -478.74299440816907, "episode_reward_mean": 150.47268871668203, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -872.3129720818803, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 861.6236685550552}, "policy_reward_mean": {"prey_policy": -118.59103901796965, "predator_policy": 193.82738337631076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [374.2491644590152, -225.0855301360308, 179.07999999999987, 194.9699999999997, 3.84999999999996, -107.14890537992954, 321.3918416102897, -70.48861288744199, 430.1874295340255, 174.68999999999997, 217.90558759126642, 3.8099999999999645, 402.7914846952477, 172.42180230117947, 102.5600000000008, 192.31875447977905, 185.9399999999998, 266.55404472073474, 175.05999999999983, -8.05974386695054, 23.06406110698394, 180.1400803575225, 365.2387422735348, -2.160277323935089, 374.17643445193454, 331.7278223760935, 381.41701758749144, 195.92999999999967, 322.0904927137945, 379.5516075306741, 184.67057773391008, 14.103133618980724, 127.97000000000044, 184.36, -478.74299440816907, 213.8212842161182, 195.44449200114803, 192.76039815932762, 148.97000000000003, 305.88688054200577, 134.7073183543046, 178.46999999999963, 384.05546111299515, 37.010000000000176, 28.898244382134713, 321.9064454449854, 183.02417968232552, -8.355432104279302, 14.621395797902046, 333.50796398265436, 290.6951350840006, 173.4945716184954, -402.8821911521599, 49.28296195126658, 330.0547211367314, 38.16267705685884, 370.9313649528837, 202.44722674942705, 3.579999999999966, 123.38746520546968, 182.53880993217496, 167.3003807561762, 355.8464376649308, 219.4171552836243, 201.66999999999962, 48.909999999999975, 75.31627534167635, 1.1855282655747017, 423.35684255868233, 13.611867545632995, 68.89384926585252, 368.0342748075057, 96.00920262401704, 242.24486683648286, 346.16716893699675, -38.52218427960796, -64.51590558312313, 101.60051062144652, 430.69172574814877, 3.9199999999999604, -435.2149418133162, 376.2570003477549, 17.97000000000002, -243.42862017226113, 123.76751988629711, 326.50664918381017, 189.6599999999997, -250.0046012662925, 242.89829648327444, 57.07267694467712, 359.69838722807225, 112.05000000000084, 183.4749079683213, 26.98053873579264, 53.969999999999764, 216.0902845519558, 10.951246194701152, 535.1717120466265, 78.00000000000064, 407.30442970800317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.231943521856493, 49.718444724215516, -643.7210496075079, -762.254217394327, -21.24065092195143, 168.06218676278314, 168.88149287433163, -5.619782284624867, -4.538740711490194, -62.16667210242542, -365.33103471141783, -466.99543912651893, -60.698088333902824, -182.28994854255362, -365.526019523151, -340.61194506646825, 32.42767622780237, -129.22825372534058, 76.1034311691364, -85.99356872756908, 40.69155148007761, -62.614525294761386, -30.36920136392667, -57.821579425396145, 37.4815236872021, 154.73932821419498, 2.0000000000000013, -20.91830857242823, -10.700594069707284, -14.665623505074997, -11.817264719704104, 134.04590458957114, -34.52385193605491, 141.8330709693645, -61.814876300506356, 47.754742825501744, 124.3523441127249, 0.026314034897991168, -103.75426096939738, -15.081639383721786, -737.3528326112068, 2.0000000000000013, -9.440875883236725, 13.9369806970135, 36.33862524199532, 113.72156054130333, -44.77880412577292, -116.78739056248013, 128.80512011685897, 170.40096861925952, 120.19936580003898, 72.32830573075773, -721.1791789125245, -26.160112583111594, -19.004159662221515, 181.49112276100692, -718.4906413855823, -52.543252597170415, 115.47841238810393, 161.97596044547117, -24.505771237893494, 176.40061298597666, -350.25781336001097, -655.8314906552249, -32.80684812467644, -6.003046070526134, -153.3013618591513, 106.8743652948268, -672.1226286512899, -759.9329936076707, -872.3129720818803, -24.97060941764978, -292.5158394538679, -0.75084833214539, -7.343009376452695, 151.2131487049009, 3.168386442041097, -22.491410098868528, 72.36224727843161, 116.53299175023918, -159.01322514553715, 0.21274764621960268, 71.60854484199119, -130.17705380005674, 175.6347478908538, 110.76010955640528, -538.7204463715223, -2.6200415543110154, -7.169647983138052, -778.3193205304842, -81.69234284697359, -22.632067041681978, 2.0000000000000013, 104.28656526205174, -25.019447167716848, -64.68885356255174, -423.8128069251402, -403.97748293673703, 124.11365033416087, 131.09612567728806, 22.34102980442347, 76.08134278665167, 17.313026157943085, -51.48206496405747, -684.0451424359402, -616.9080099861275, -23.62271035739445, -622.9338040257516, -9.079047845132024, 103.59032579718584, -682.2559035107085, -36.899892050949404, 143.8481324370417, 81.64135884125574, -45.37169371778356, 2.0000000000000013, -99.48945994867681, -11.192570196521592, -221.93673044940272, -59.444379384663364, 115.62630311202903, -22.948783024493963, 30.441228775507934, -12.055327221622111, 133.13165580201752, 95.00532917512851, 78.1362009844067, -10.97533977306659, 200.0, -102.0987793966101, -496.4601069651448, -22.27611820510341, 2.0000000000000013, -233.20904964787405, -42.86385648480712, -21.82151846860783, 140.52639475982792, -49.90315445730833, -5.919673263640769, -671.2526293800221, -569.4122254046732, -27.819644129138528, 55.05894268110848, -99.63264678107575, -8.407736505198706, -579.450194396628, 41.0412019493602, -83.24818909539295, 2.0000000000000013, -559.045482040592, -196.49392489764392, -223.97033526882058, -213.44849675904507, -657.2254593349252, -226.99622440471998, -42.36602422400379, 145.06479862896123, -9.73849854819224, -3.832018212593516, -14.315377392178673, -623.0093912112872, -674.584272368683, 168.28477630728597, 82.30504437983696, -5.081918692319584, -649.8631931028957, -682.5309510122328, -492.8090970705214, -22.885289453007957, -90.56640007531664, 121.18579679741396, 95.46944309637693, 163.73662424282054, -120.22664089432874, -504.4815971766689, -609.6947469577693, 2.0000000000000013, -222.48092838757614, 2.0000000000000013, -466.3728481249748, 79.05318545282778, 84.68042436040078, -192.02081255930486, 15.85999999999996, -12.250862426409494, -658.9467093729436, -76.15356922498728, -775.6141563212252, -561.6215044361531, -5.2818291904044905, -32.73792019095797, 12.72830919107592, -14.774264610137907, -152.0192497313046, -565.6762894241224, -27.27957145358293, 2.0000000000000013, -483.8143573120188, 161.52427194391134, 149.9406709578877], "policy_predator_policy_reward": [178.44041189476576, 157.3222513618905, 730.5549136111251, 450.3348232546794, 25.467695166852174, 6.790768992316089, 24.11850712566838, 7.589782284624825, 6.508740711490152, 64.04667210242508, 583.4796042094315, 141.69796424857572, 263.11906129851354, 301.2608171882326, 563.8221869204765, 71.82716478170084, 274.4073126348381, 252.58069439672568, 96.8965688308636, 87.68356872756884, 225.64376081873976, 14.18480058721038, 32.25920136392688, 59.74157942539576, 113.1414014604247, 97.42923133342593, 99.07630859686742, 92.26380227674082, 19.05495933848748, 108.87125823629476, 38.61533674181971, 31.474777868092513, 36.463851936054525, 42.166929030635465, 180.92210994342, 99.69206825231933, 1.7002959530624657, 48.98104589931465, 1.7103542905275613, 109.06580219564223, 63.78787266919252, 694.6290210489983, 55.37258557807071, 120.27138996567516, 117.30636186933175, 97.87219462090437, 36.708408103227676, 122.6975092610909, 60.958573488956816, 14.01177222685924, 105.04339145356907, 34.15675939172779, 375.7513475919273, 753.0049614912011, 20.934159662221816, 12.508877238993069, 420.49358958803896, 672.630797108509, 46.10982907144354, 55.98740562565546, 24.66559470290961, 8.110141282917793, 509.7692078577575, 510.4232297764584, 158.80684812467638, 7.973046070526092, 154.66136185915155, 76.1256347051732, 816.4977327973112, 136.81489505348105, 249.48119716059375, 861.6236685550552, 200.267114121491, 288.44406566567085, 27.93685129509913, 20.95340753578058, 0.0, 168.29302365682778, 104.4756742806284, 12.515967232706577, 20.10892615083109, 273.3988697027909, 14.979811655694737, 222.05869730237015, 63.15802700451191, 34.50257666122417, 75.28547973366649, 503.06500819216666, 760.6677356681572, 53.719477227599434, 286.0981476242442, 140.13270770939684, 63.889036998229116, 12.848577422044912, 4.646445516972049, 76.70642310901837, 446.767947892353, 395.6437377674266, 66.97370649419464, 11.324481477010746, 15.87045273798225, 176.40230975494316, 76.1182218326455, 131.54538859196404, 85.40860425204477, 812.662357017863, 613.9128963065236, 81.92658002788917, 167.1857769912284, 68.35766619344916, 164.8668113172677, 592.451661301249, 85.75775456347937, 59.68411911110702, 155.18098200772621, 90.63793845948504, 11.925365085765765, 102.33666505943339, 34.87920199681351, 369.88937304272133, 17.4567699217604, 72.40451992288006, 95.79336285821184, 53.12111634407855, 91.80835195791704, 35.90110072986781, 75.8221363074885, 76.43415776479624, 0.0, 103.76877939661095, 60.2474789971683, 507.39874617308004, 194.07713081956726, 112.44819416998241, 44.763856484806745, 21.107046734182838, 172.3263794435026, 160.40722281265997, 554.8671914447152, 135.91697874458137, 110.86520223413028, 555.2605165655343, 220.74401060709863, 191.86396830037452, 340.4515918298914, 343.41554169595304, 213.68158625071231, 70.77026773180336, 496.67315410273113, 406.5394968748584, 240.5685978569839, 141.3734780298707, 705.6721788767518, 100.48587163409401, 67.75080995002803, 303.2119493001414, 138.31951459179382, 157.045911075586, 5.802018212593474, 16.265377392178678, 820.7244429364653, 41.654278830188154, 33.83770360334425, 91.82947605728775, 613.3263355304684, 59.5887762647467, 89.3916692958214, 842.5197586146719, 229.51068347512393, 7.708525939497855, 54.93650028057387, 54.91490900944557, 24.263375757179446, 121.88664089432957, 711.7611996513474, 152.41054321679724, 199.80218955168135, 263.5770353191697, 394.61368589890753, 126.8318391707444, 83.39084495631957, 112.57393245852423, 242.7133220228787, 45.49749053642629, 313.4245296150141, 541.2479501526614, 860.7703528368855, 17.977911445120593, 155.55028730807956, 465.32304631847836, 65.58027120802683, 170.51962434381173, 74.2666461817641, 103.47811435437814, 522.0369478374245, 606.0906250869089, 551.9803335552235, 7.834023756795406, 44.95145375157039, 50.88803305463368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5412595779774517, "mean_inference_ms": 1.6383561798240596, "mean_action_processing_ms": 0.24862742827078968, "mean_env_wait_ms": 0.18470906425052064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003711104393005371, "StateBufferConnector_ms": 0.003006458282470703, "ViewRequirementAgentConnector_ms": 0.08873677253723145}, "num_episodes": 22, "episode_return_max": 535.1717120466265, "episode_return_min": -478.74299440816907, "episode_return_mean": 150.47268871668203, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.6018621049056, "num_env_steps_trained_throughput_per_sec": 400.6018621049056, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 10136.506, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10136.467, "sample_time_ms": 1261.789, "learn_time_ms": 8859.366, "learn_throughput": 451.5, "synch_weights_time_ms": 14.437}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "74486_00000", "date": "2024-08-16_15-07-07", "timestamp": 1723801027, "time_this_iter_s": 9.990467071533203, "time_total_s": 695.7852301597595, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3973a6d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 695.7852301597595, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.07857142857143, "ram_util_percent": 78.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.545847586349205, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.753899793145518, "policy_loss": -0.003874082615963681, "vf_loss": 4.75741929503345, "vf_explained_var": -0.41463255907492663, "kl": 0.0070915944140265835, "entropy": 1.1039961565108527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4232369341547526, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.20810485441218, "policy_loss": -0.004896351523702304, "vf_loss": 6.212230501225386, "vf_explained_var": -0.0033073052212044046, "kl": 0.010275887465671813, "entropy": 0.5178065291788212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 535.1717120466265, "episode_reward_min": -478.74299440816907, "episode_reward_mean": 136.9236811411775, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -872.3129720818803, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 861.6236685550552}, "policy_reward_mean": {"prey_policy": -125.01429533045905, "predator_policy": 193.47613590104783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.05999999999983, -8.05974386695054, 23.06406110698394, 180.1400803575225, 365.2387422735348, -2.160277323935089, 374.17643445193454, 331.7278223760935, 381.41701758749144, 195.92999999999967, 322.0904927137945, 379.5516075306741, 184.67057773391008, 14.103133618980724, 127.97000000000044, 184.36, -478.74299440816907, 213.8212842161182, 195.44449200114803, 192.76039815932762, 148.97000000000003, 305.88688054200577, 134.7073183543046, 178.46999999999963, 384.05546111299515, 37.010000000000176, 28.898244382134713, 321.9064454449854, 183.02417968232552, -8.355432104279302, 14.621395797902046, 333.50796398265436, 290.6951350840006, 173.4945716184954, -402.8821911521599, 49.28296195126658, 330.0547211367314, 38.16267705685884, 370.9313649528837, 202.44722674942705, 3.579999999999966, 123.38746520546968, 182.53880993217496, 167.3003807561762, 355.8464376649308, 219.4171552836243, 201.66999999999962, 48.909999999999975, 75.31627534167635, 1.1855282655747017, 423.35684255868233, 13.611867545632995, 68.89384926585252, 368.0342748075057, 96.00920262401704, 242.24486683648286, 346.16716893699675, -38.52218427960796, -64.51590558312313, 101.60051062144652, 430.69172574814877, 3.9199999999999604, -435.2149418133162, 376.2570003477549, 17.97000000000002, -243.42862017226113, 123.76751988629711, 326.50664918381017, 189.6599999999997, -250.0046012662925, 242.89829648327444, 57.07267694467712, 359.69838722807225, 112.05000000000084, 183.4749079683213, 26.98053873579264, 53.969999999999764, 216.0902845519558, 10.951246194701152, 535.1717120466265, 78.00000000000064, 407.30442970800317, 3.929999999999959, -343.4217526485713, 258.59362178537015, 182.9419539751034, -115.13338400705518, 167.22267070942314, 184.9603437628486, 145.8499999999998, 43.26999999999947, 182.9793177713508, 19.193562404808635, 116.98763644214893, 174.94999999999976, 35.90895730239995, 82.79179517709463, 8.141894581066728, 306.21262787482897, 9.71705830686125], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [124.3523441127249, 0.026314034897991168, -103.75426096939738, -15.081639383721786, -737.3528326112068, 2.0000000000000013, -9.440875883236725, 13.9369806970135, 36.33862524199532, 113.72156054130333, -44.77880412577292, -116.78739056248013, 128.80512011685897, 170.40096861925952, 120.19936580003898, 72.32830573075773, -721.1791789125245, -26.160112583111594, -19.004159662221515, 181.49112276100692, -718.4906413855823, -52.543252597170415, 115.47841238810393, 161.97596044547117, -24.505771237893494, 176.40061298597666, -350.25781336001097, -655.8314906552249, -32.80684812467644, -6.003046070526134, -153.3013618591513, 106.8743652948268, -672.1226286512899, -759.9329936076707, -872.3129720818803, -24.97060941764978, -292.5158394538679, -0.75084833214539, -7.343009376452695, 151.2131487049009, 3.168386442041097, -22.491410098868528, 72.36224727843161, 116.53299175023918, -159.01322514553715, 0.21274764621960268, 71.60854484199119, -130.17705380005674, 175.6347478908538, 110.76010955640528, -538.7204463715223, -2.6200415543110154, -7.169647983138052, -778.3193205304842, -81.69234284697359, -22.632067041681978, 2.0000000000000013, 104.28656526205174, -25.019447167716848, -64.68885356255174, -423.8128069251402, -403.97748293673703, 124.11365033416087, 131.09612567728806, 22.34102980442347, 76.08134278665167, 17.313026157943085, -51.48206496405747, -684.0451424359402, -616.9080099861275, -23.62271035739445, -622.9338040257516, -9.079047845132024, 103.59032579718584, -682.2559035107085, -36.899892050949404, 143.8481324370417, 81.64135884125574, -45.37169371778356, 2.0000000000000013, -99.48945994867681, -11.192570196521592, -221.93673044940272, -59.444379384663364, 115.62630311202903, -22.948783024493963, 30.441228775507934, -12.055327221622111, 133.13165580201752, 95.00532917512851, 78.1362009844067, -10.97533977306659, 200.0, -102.0987793966101, -496.4601069651448, -22.27611820510341, 2.0000000000000013, -233.20904964787405, -42.86385648480712, -21.82151846860783, 140.52639475982792, -49.90315445730833, -5.919673263640769, -671.2526293800221, -569.4122254046732, -27.819644129138528, 55.05894268110848, -99.63264678107575, -8.407736505198706, -579.450194396628, 41.0412019493602, -83.24818909539295, 2.0000000000000013, -559.045482040592, -196.49392489764392, -223.97033526882058, -213.44849675904507, -657.2254593349252, -226.99622440471998, -42.36602422400379, 145.06479862896123, -9.73849854819224, -3.832018212593516, -14.315377392178673, -623.0093912112872, -674.584272368683, 168.28477630728597, 82.30504437983696, -5.081918692319584, -649.8631931028957, -682.5309510122328, -492.8090970705214, -22.885289453007957, -90.56640007531664, 121.18579679741396, 95.46944309637693, 163.73662424282054, -120.22664089432874, -504.4815971766689, -609.6947469577693, 2.0000000000000013, -222.48092838757614, 2.0000000000000013, -466.3728481249748, 79.05318545282778, 84.68042436040078, -192.02081255930486, 15.85999999999996, -12.250862426409494, -658.9467093729436, -76.15356922498728, -775.6141563212252, -561.6215044361531, -5.2818291904044905, -32.73792019095797, 12.72830919107592, -14.774264610137907, -152.0192497313046, -565.6762894241224, -27.27957145358293, 2.0000000000000013, -483.8143573120188, 161.52427194391134, 149.9406709578877, -40.85151866344527, 2.0000000000000013, -551.4634769808482, -626.1308399623875, -37.95456413548903, 73.11591523336578, 100.02556045929595, 2.0000000000000013, -655.6460861624918, -212.30666968988106, -6.322324167712935, 25.366857002978666, -204.52244947631502, 2.0000000000000013, -27.004721749419346, -3.665624881343977, 2.0000000000000013, -56.13424670719295, -47.56333709249109, 124.21312254988541, -33.46387444126461, -167.1994085457413, -174.82394531519054, -73.95654557863678, -257.7991054912881, 120.36491686882096, -362.7506906042278, -13.558332719788769, -7.158185997407884, -309.9442564142469, -39.82201204755213, -16.694244148811897, 137.6282159700762, 6.840501315574221, -626.0920690012217, -86.33164788796442], "policy_predator_policy_reward": [1.7002959530624657, 48.98104589931465, 1.7103542905275613, 109.06580219564223, 63.78787266919252, 694.6290210489983, 55.37258557807071, 120.27138996567516, 117.30636186933175, 97.87219462090437, 36.708408103227676, 122.6975092610909, 60.958573488956816, 14.01177222685924, 105.04339145356907, 34.15675939172779, 375.7513475919273, 753.0049614912011, 20.934159662221816, 12.508877238993069, 420.49358958803896, 672.630797108509, 46.10982907144354, 55.98740562565546, 24.66559470290961, 8.110141282917793, 509.7692078577575, 510.4232297764584, 158.80684812467638, 7.973046070526092, 154.66136185915155, 76.1256347051732, 816.4977327973112, 136.81489505348105, 249.48119716059375, 861.6236685550552, 200.267114121491, 288.44406566567085, 27.93685129509913, 20.95340753578058, 0.0, 168.29302365682778, 104.4756742806284, 12.515967232706577, 20.10892615083109, 273.3988697027909, 14.979811655694737, 222.05869730237015, 63.15802700451191, 34.50257666122417, 75.28547973366649, 503.06500819216666, 760.6677356681572, 53.719477227599434, 286.0981476242442, 140.13270770939684, 63.889036998229116, 12.848577422044912, 4.646445516972049, 76.70642310901837, 446.767947892353, 395.6437377674266, 66.97370649419464, 11.324481477010746, 15.87045273798225, 176.40230975494316, 76.1182218326455, 131.54538859196404, 85.40860425204477, 812.662357017863, 613.9128963065236, 81.92658002788917, 167.1857769912284, 68.35766619344916, 164.8668113172677, 592.451661301249, 85.75775456347937, 59.68411911110702, 155.18098200772621, 90.63793845948504, 11.925365085765765, 102.33666505943339, 34.87920199681351, 369.88937304272133, 17.4567699217604, 72.40451992288006, 95.79336285821184, 53.12111634407855, 91.80835195791704, 35.90110072986781, 75.8221363074885, 76.43415776479624, 0.0, 103.76877939661095, 60.2474789971683, 507.39874617308004, 194.07713081956726, 112.44819416998241, 44.763856484806745, 21.107046734182838, 172.3263794435026, 160.40722281265997, 554.8671914447152, 135.91697874458137, 110.86520223413028, 555.2605165655343, 220.74401060709863, 191.86396830037452, 340.4515918298914, 343.41554169595304, 213.68158625071231, 70.77026773180336, 496.67315410273113, 406.5394968748584, 240.5685978569839, 141.3734780298707, 705.6721788767518, 100.48587163409401, 67.75080995002803, 303.2119493001414, 138.31951459179382, 157.045911075586, 5.802018212593474, 16.265377392178678, 820.7244429364653, 41.654278830188154, 33.83770360334425, 91.82947605728775, 613.3263355304684, 59.5887762647467, 89.3916692958214, 842.5197586146719, 229.51068347512393, 7.708525939497855, 54.93650028057387, 54.91490900944557, 24.263375757179446, 121.88664089432957, 711.7611996513474, 152.41054321679724, 199.80218955168135, 263.5770353191697, 394.61368589890753, 126.8318391707444, 83.39084495631957, 112.57393245852423, 242.7133220228787, 45.49749053642629, 313.4245296150141, 541.2479501526614, 860.7703528368855, 17.977911445120593, 155.55028730807956, 465.32304631847836, 65.58027120802683, 170.51962434381173, 74.2666461817641, 103.47811435437814, 522.0369478374245, 606.0906250869089, 551.9803335552235, 7.834023756795406, 44.95145375157039, 50.88803305463368, 42.781518663444885, 0.0, 97.6596429687765, 736.5129213258879, 156.06654347534592, 67.36572721214817, 62.23983287245357, 18.676560643354012, 706.5126869869209, 46.306684858394554, 45.39826057734042, 102.77987729681725, 171.39329107418848, 216.0895021649755, 150.452707410624, 26.067639220139696, 0.0, 97.4042467071927, 18.168589752325424, 88.16094256163112, 180.54189159178347, 39.31495380002869, 154.14081667239626, 211.62731066357912, 258.74910549128737, 53.635083131179044, 26.387757053938856, 385.83022357247745, 333.8087953792343, 66.08544220951495, 4.9451030034825605, 59.713047773948226, 86.15424584566334, 75.58966474351577, 140.93357590999923, 581.2071992860491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.54133074302364, "mean_inference_ms": 1.639535631619491, "mean_action_processing_ms": 0.24858437604210099, "mean_env_wait_ms": 0.18483410174567702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038427114486694336, "StateBufferConnector_ms": 0.0029832124710083008, "ViewRequirementAgentConnector_ms": 0.08960926532745361}, "num_episodes": 18, "episode_return_max": 535.1717120466265, "episode_return_min": -478.74299440816907, "episode_return_mean": 136.9236811411775, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.33192274636474, "num_env_steps_trained_throughput_per_sec": 387.33192274636474, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 10139.785, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10139.745, "sample_time_ms": 1263.025, "learn_time_ms": 8861.374, "learn_throughput": 451.397, "synch_weights_time_ms": 14.429}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "74486_00000", "date": "2024-08-16_15-07-18", "timestamp": 1723801038, "time_this_iter_s": 10.332125902175903, "time_total_s": 706.1173560619354, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397740b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 706.1173560619354, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 34.8, "ram_util_percent": 78.67333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7948588193409027, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.580039393460309, "policy_loss": -0.0059979904521867715, "vf_loss": 4.58560156998811, "vf_explained_var": -0.4555618212967323, "kl": 0.008716573129218867, "entropy": 1.1200426711607232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6178934441830115, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.15754542401228, "policy_loss": -0.008370662758018448, "vf_loss": 5.165370878845295, "vf_explained_var": 0.0008266657117813352, "kl": 0.007269397230399754, "entropy": 0.4873293860248788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 535.1717120466265, "episode_reward_min": -435.2149418133162, "episode_reward_mean": 123.8543625427278, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -778.3193205304842, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 860.7703528368855}, "policy_reward_mean": {"prey_policy": -119.8614849313, "predator_policy": 181.78866620266388}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.46999999999963, 384.05546111299515, 37.010000000000176, 28.898244382134713, 321.9064454449854, 183.02417968232552, -8.355432104279302, 14.621395797902046, 333.50796398265436, 290.6951350840006, 173.4945716184954, -402.8821911521599, 49.28296195126658, 330.0547211367314, 38.16267705685884, 370.9313649528837, 202.44722674942705, 3.579999999999966, 123.38746520546968, 182.53880993217496, 167.3003807561762, 355.8464376649308, 219.4171552836243, 201.66999999999962, 48.909999999999975, 75.31627534167635, 1.1855282655747017, 423.35684255868233, 13.611867545632995, 68.89384926585252, 368.0342748075057, 96.00920262401704, 242.24486683648286, 346.16716893699675, -38.52218427960796, -64.51590558312313, 101.60051062144652, 430.69172574814877, 3.9199999999999604, -435.2149418133162, 376.2570003477549, 17.97000000000002, -243.42862017226113, 123.76751988629711, 326.50664918381017, 189.6599999999997, -250.0046012662925, 242.89829648327444, 57.07267694467712, 359.69838722807225, 112.05000000000084, 183.4749079683213, 26.98053873579264, 53.969999999999764, 216.0902845519558, 10.951246194701152, 535.1717120466265, 78.00000000000064, 407.30442970800317, 3.929999999999959, -343.4217526485713, 258.59362178537015, 182.9419539751034, -115.13338400705518, 167.22267070942314, 184.9603437628486, 145.8499999999998, 43.26999999999947, 182.9793177713508, 19.193562404808635, 116.98763644214893, 174.94999999999976, 35.90895730239995, 82.79179517709463, 8.141894581066728, 306.21262787482897, 9.71705830686125, 3.7999999999999603, 66.69978475626145, 122.28606687451246, 219.6223561356456, 78.32732207017854, 242.85885667507458, 7.9281238474988704, 5.422227251092446, 306.0173348468208, 49.31999999999993, 311.69984346168746, 249.62715052001698, 186.218312594807, 34.89999999999997, 75.99929953935636, 12.857201390086566, 84.09000000000134, 3.7599999999999634, 74.82983643491472, 175.36698106871287, 7.999999999999957, 6.4247701131336825, 309.14000000000004], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [71.60854484199119, -130.17705380005674, 175.6347478908538, 110.76010955640528, -538.7204463715223, -2.6200415543110154, -7.169647983138052, -778.3193205304842, -81.69234284697359, -22.632067041681978, 2.0000000000000013, 104.28656526205174, -25.019447167716848, -64.68885356255174, -423.8128069251402, -403.97748293673703, 124.11365033416087, 131.09612567728806, 22.34102980442347, 76.08134278665167, 17.313026157943085, -51.48206496405747, -684.0451424359402, -616.9080099861275, -23.62271035739445, -622.9338040257516, -9.079047845132024, 103.59032579718584, -682.2559035107085, -36.899892050949404, 143.8481324370417, 81.64135884125574, -45.37169371778356, 2.0000000000000013, -99.48945994867681, -11.192570196521592, -221.93673044940272, -59.444379384663364, 115.62630311202903, -22.948783024493963, 30.441228775507934, -12.055327221622111, 133.13165580201752, 95.00532917512851, 78.1362009844067, -10.97533977306659, 200.0, -102.0987793966101, -496.4601069651448, -22.27611820510341, 2.0000000000000013, -233.20904964787405, -42.86385648480712, -21.82151846860783, 140.52639475982792, -49.90315445730833, -5.919673263640769, -671.2526293800221, -569.4122254046732, -27.819644129138528, 55.05894268110848, -99.63264678107575, -8.407736505198706, -579.450194396628, 41.0412019493602, -83.24818909539295, 2.0000000000000013, -559.045482040592, -196.49392489764392, -223.97033526882058, -213.44849675904507, -657.2254593349252, -226.99622440471998, -42.36602422400379, 145.06479862896123, -9.73849854819224, -3.832018212593516, -14.315377392178673, -623.0093912112872, -674.584272368683, 168.28477630728597, 82.30504437983696, -5.081918692319584, -649.8631931028957, -682.5309510122328, -492.8090970705214, -22.885289453007957, -90.56640007531664, 121.18579679741396, 95.46944309637693, 163.73662424282054, -120.22664089432874, -504.4815971766689, -609.6947469577693, 2.0000000000000013, -222.48092838757614, 2.0000000000000013, -466.3728481249748, 79.05318545282778, 84.68042436040078, -192.02081255930486, 15.85999999999996, -12.250862426409494, -658.9467093729436, -76.15356922498728, -775.6141563212252, -561.6215044361531, -5.2818291904044905, -32.73792019095797, 12.72830919107592, -14.774264610137907, -152.0192497313046, -565.6762894241224, -27.27957145358293, 2.0000000000000013, -483.8143573120188, 161.52427194391134, 149.9406709578877, -40.85151866344527, 2.0000000000000013, -551.4634769808482, -626.1308399623875, -37.95456413548903, 73.11591523336578, 100.02556045929595, 2.0000000000000013, -655.6460861624918, -212.30666968988106, -6.322324167712935, 25.366857002978666, -204.52244947631502, 2.0000000000000013, -27.004721749419346, -3.665624881343977, 2.0000000000000013, -56.13424670719295, -47.56333709249109, 124.21312254988541, -33.46387444126461, -167.1994085457413, -174.82394531519054, -73.95654557863678, -257.7991054912881, 120.36491686882096, -362.7506906042278, -13.558332719788769, -7.158185997407884, -309.9442564142469, -39.82201204755213, -16.694244148811897, 137.6282159700762, 6.840501315574221, -626.0920690012217, -86.33164788796442, -60.703404390207275, -37.034196982863044, -1.5760392174199336, 4.220837466938187, -12.707550852503259, -280.18097542357305, -8.573846644216832, -50.63811375665983, -10.601848248759733, -153.16882622935069, -23.037169791446345, -24.391063554110445, -117.31771911661718, -1.7102437244992992, 2.0000000000000013, -16.76772507055269, 21.060013910792613, 116.24314407058075, -203.95453364790643, -41.18293927844396, 52.18508787075241, 95.97112977098588, -244.4950689234211, 2.0000000000000013, -131.3459314141372, 34.04988962372068, -518.7924868196433, -22.52333316567271, -601.8855559956443, 2.0000000000000013, -609.7250701743875, -110.25793084604062, 61.66305673502282, 3.5417137992182384, -16.270887897036502, -53.28415922291527, -183.51283459586895, 2.0000000000000013, -19.4117458287031, 93.00347317013393, -650.3995590473186, 2.0000000000000013, -84.98630555714925, -41.80513924534458, 50.58177904033034, 89.37072347854475], "policy_predator_policy_reward": [14.979811655694737, 222.05869730237015, 63.15802700451191, 34.50257666122417, 75.28547973366649, 503.06500819216666, 760.6677356681572, 53.719477227599434, 286.0981476242442, 140.13270770939684, 63.889036998229116, 12.848577422044912, 4.646445516972049, 76.70642310901837, 446.767947892353, 395.6437377674266, 66.97370649419464, 11.324481477010746, 15.87045273798225, 176.40230975494316, 76.1182218326455, 131.54538859196404, 85.40860425204477, 812.662357017863, 613.9128963065236, 81.92658002788917, 167.1857769912284, 68.35766619344916, 164.8668113172677, 592.451661301249, 85.75775456347937, 59.68411911110702, 155.18098200772621, 90.63793845948504, 11.925365085765765, 102.33666505943339, 34.87920199681351, 369.88937304272133, 17.4567699217604, 72.40451992288006, 95.79336285821184, 53.12111634407855, 91.80835195791704, 35.90110072986781, 75.8221363074885, 76.43415776479624, 0.0, 103.76877939661095, 60.2474789971683, 507.39874617308004, 194.07713081956726, 112.44819416998241, 44.763856484806745, 21.107046734182838, 172.3263794435026, 160.40722281265997, 554.8671914447152, 135.91697874458137, 110.86520223413028, 555.2605165655343, 220.74401060709863, 191.86396830037452, 340.4515918298914, 343.41554169595304, 213.68158625071231, 70.77026773180336, 496.67315410273113, 406.5394968748584, 240.5685978569839, 141.3734780298707, 705.6721788767518, 100.48587163409401, 67.75080995002803, 303.2119493001414, 138.31951459179382, 157.045911075586, 5.802018212593474, 16.265377392178678, 820.7244429364653, 41.654278830188154, 33.83770360334425, 91.82947605728775, 613.3263355304684, 59.5887762647467, 89.3916692958214, 842.5197586146719, 229.51068347512393, 7.708525939497855, 54.93650028057387, 54.91490900944557, 24.263375757179446, 121.88664089432957, 711.7611996513474, 152.41054321679724, 199.80218955168135, 263.5770353191697, 394.61368589890753, 126.8318391707444, 83.39084495631957, 112.57393245852423, 242.7133220228787, 45.49749053642629, 313.4245296150141, 541.2479501526614, 860.7703528368855, 17.977911445120593, 155.55028730807956, 465.32304631847836, 65.58027120802683, 170.51962434381173, 74.2666461817641, 103.47811435437814, 522.0369478374245, 606.0906250869089, 551.9803335552235, 7.834023756795406, 44.95145375157039, 50.88803305463368, 42.781518663444885, 0.0, 97.6596429687765, 736.5129213258879, 156.06654347534592, 67.36572721214817, 62.23983287245357, 18.676560643354012, 706.5126869869209, 46.306684858394554, 45.39826057734042, 102.77987729681725, 171.39329107418848, 216.0895021649755, 150.452707410624, 26.067639220139696, 0.0, 97.4042467071927, 18.168589752325424, 88.16094256163112, 180.54189159178347, 39.31495380002869, 154.14081667239626, 211.62731066357912, 258.74910549128737, 53.635083131179044, 26.387757053938856, 385.83022357247745, 333.8087953792343, 66.08544220951495, 4.9451030034825605, 59.713047773948226, 86.15424584566334, 75.58966474351577, 140.93357590999923, 581.2071992860491, 62.5834043902069, 38.95419698286266, 57.14299446470294, 6.911992042038856, 71.84663123779669, 343.3279619127916, 99.50567601197245, 179.32864052455034, 147.24150119774444, 94.85649535054145, 109.30630897576816, 180.98078104486365, 41.14151831658384, 85.81456837203247, 1.4922272510925183, 18.69772507055299, 82.39575761805892, 86.31841924738859, 145.09255162205338, 149.36492130429622, 34.687265490950885, 128.85636032899828, 244.59744471860677, 247.52477472483235, 67.92158334442817, 215.59277104079553, 532.4437846218004, 43.77203536351582, 48.15758921727864, 627.7272663177223, 201.82016308077797, 531.020039329737, 6.626943264976921, 12.258286200781729, 18.210887897036805, 55.10415922291491, 84.85762512770054, 171.4850459030805, 59.977282099275776, 41.797971628006735, 6.075232720958235, 650.3243263263604, 59.723664920976454, 73.4925499946517, 154.16648669727718, 15.021010783847851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.540946296612047, "mean_inference_ms": 1.6403164925478944, "mean_action_processing_ms": 0.24813187461924927, "mean_env_wait_ms": 0.18465676569589726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004433870315551758, "StateBufferConnector_ms": 0.0029920339584350586, "ViewRequirementAgentConnector_ms": 0.09007084369659424}, "num_episodes": 23, "episode_return_max": 535.1717120466265, "episode_return_min": -435.2149418133162, "episode_return_mean": 123.8543625427278, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.9516591395914, "num_env_steps_trained_throughput_per_sec": 403.9516591395914, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 10092.189, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10092.149, "sample_time_ms": 1258.896, "learn_time_ms": 8818.14, "learn_throughput": 453.61, "synch_weights_time_ms": 14.177}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "74486_00000", "date": "2024-08-16_15-07-28", "timestamp": 1723801048, "time_this_iter_s": 9.907399892807007, "time_total_s": 716.0247559547424, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3977409d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 716.0247559547424, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 42.800000000000004, "ram_util_percent": 79.88571428571431}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4633641371335933, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.158911853366428, "policy_loss": -0.005404489385777168, "vf_loss": 5.163585332209471, "vf_explained_var": -0.4476162596985146, "kl": 0.01462034175255499, "entropy": 1.119149020172301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2823334687443637, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.692525519265069, "policy_loss": -0.0048535205300641125, "vf_loss": 5.696885632207154, "vf_explained_var": -0.00091410238276083, "kl": 0.006578886275997902, "entropy": 0.5634677111156403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 535.1717120466265, "episode_reward_min": -435.2149418133162, "episode_reward_mean": 116.1301035858885, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -834.4727626956671, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 860.7703528368855}, "policy_reward_mean": {"prey_policy": -129.51615165917133, "predator_policy": 187.58120345211557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.38746520546968, 182.53880993217496, 167.3003807561762, 355.8464376649308, 219.4171552836243, 201.66999999999962, 48.909999999999975, 75.31627534167635, 1.1855282655747017, 423.35684255868233, 13.611867545632995, 68.89384926585252, 368.0342748075057, 96.00920262401704, 242.24486683648286, 346.16716893699675, -38.52218427960796, -64.51590558312313, 101.60051062144652, 430.69172574814877, 3.9199999999999604, -435.2149418133162, 376.2570003477549, 17.97000000000002, -243.42862017226113, 123.76751988629711, 326.50664918381017, 189.6599999999997, -250.0046012662925, 242.89829648327444, 57.07267694467712, 359.69838722807225, 112.05000000000084, 183.4749079683213, 26.98053873579264, 53.969999999999764, 216.0902845519558, 10.951246194701152, 535.1717120466265, 78.00000000000064, 407.30442970800317, 3.929999999999959, -343.4217526485713, 258.59362178537015, 182.9419539751034, -115.13338400705518, 167.22267070942314, 184.9603437628486, 145.8499999999998, 43.26999999999947, 182.9793177713508, 19.193562404808635, 116.98763644214893, 174.94999999999976, 35.90895730239995, 82.79179517709463, 8.141894581066728, 306.21262787482897, 9.71705830686125, 3.7999999999999603, 66.69978475626145, 122.28606687451246, 219.6223561356456, 78.32732207017854, 242.85885667507458, 7.9281238474988704, 5.422227251092446, 306.0173348468208, 49.31999999999993, 311.69984346168746, 249.62715052001698, 186.218312594807, 34.89999999999997, 75.99929953935636, 12.857201390086566, 84.09000000000134, 3.7599999999999634, 74.82983643491472, 175.36698106871287, 7.999999999999957, 6.4247701131336825, 309.14000000000004, 71.46220239576962, 116.76701179167729, 3.989999999999959, 2.29999999999999, 341.29702961282567, 3.749999999999961, -76.66637591167506, 302.1026637009766, -47.16988384783941, 33.70448217919404, 267.83373625674784, 3.9099999999999597, 65.99241261649435, 169.53612096412786, 26.42601920801885, 330.95204558763186, 50.84999999999987, 89.44136545834266], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-221.93673044940272, -59.444379384663364, 115.62630311202903, -22.948783024493963, 30.441228775507934, -12.055327221622111, 133.13165580201752, 95.00532917512851, 78.1362009844067, -10.97533977306659, 200.0, -102.0987793966101, -496.4601069651448, -22.27611820510341, 2.0000000000000013, -233.20904964787405, -42.86385648480712, -21.82151846860783, 140.52639475982792, -49.90315445730833, -5.919673263640769, -671.2526293800221, -569.4122254046732, -27.819644129138528, 55.05894268110848, -99.63264678107575, -8.407736505198706, -579.450194396628, 41.0412019493602, -83.24818909539295, 2.0000000000000013, -559.045482040592, -196.49392489764392, -223.97033526882058, -213.44849675904507, -657.2254593349252, -226.99622440471998, -42.36602422400379, 145.06479862896123, -9.73849854819224, -3.832018212593516, -14.315377392178673, -623.0093912112872, -674.584272368683, 168.28477630728597, 82.30504437983696, -5.081918692319584, -649.8631931028957, -682.5309510122328, -492.8090970705214, -22.885289453007957, -90.56640007531664, 121.18579679741396, 95.46944309637693, 163.73662424282054, -120.22664089432874, -504.4815971766689, -609.6947469577693, 2.0000000000000013, -222.48092838757614, 2.0000000000000013, -466.3728481249748, 79.05318545282778, 84.68042436040078, -192.02081255930486, 15.85999999999996, -12.250862426409494, -658.9467093729436, -76.15356922498728, -775.6141563212252, -561.6215044361531, -5.2818291904044905, -32.73792019095797, 12.72830919107592, -14.774264610137907, -152.0192497313046, -565.6762894241224, -27.27957145358293, 2.0000000000000013, -483.8143573120188, 161.52427194391134, 149.9406709578877, -40.85151866344527, 2.0000000000000013, -551.4634769808482, -626.1308399623875, -37.95456413548903, 73.11591523336578, 100.02556045929595, 2.0000000000000013, -655.6460861624918, -212.30666968988106, -6.322324167712935, 25.366857002978666, -204.52244947631502, 2.0000000000000013, -27.004721749419346, -3.665624881343977, 2.0000000000000013, -56.13424670719295, -47.56333709249109, 124.21312254988541, -33.46387444126461, -167.1994085457413, -174.82394531519054, -73.95654557863678, -257.7991054912881, 120.36491686882096, -362.7506906042278, -13.558332719788769, -7.158185997407884, -309.9442564142469, -39.82201204755213, -16.694244148811897, 137.6282159700762, 6.840501315574221, -626.0920690012217, -86.33164788796442, -60.703404390207275, -37.034196982863044, -1.5760392174199336, 4.220837466938187, -12.707550852503259, -280.18097542357305, -8.573846644216832, -50.63811375665983, -10.601848248759733, -153.16882622935069, -23.037169791446345, -24.391063554110445, -117.31771911661718, -1.7102437244992992, 2.0000000000000013, -16.76772507055269, 21.060013910792613, 116.24314407058075, -203.95453364790643, -41.18293927844396, 52.18508787075241, 95.97112977098588, -244.4950689234211, 2.0000000000000013, -131.3459314141372, 34.04988962372068, -518.7924868196433, -22.52333316567271, -601.8855559956443, 2.0000000000000013, -609.7250701743875, -110.25793084604062, 61.66305673502282, 3.5417137992182384, -16.270887897036502, -53.28415922291527, -183.51283459586895, 2.0000000000000013, -19.4117458287031, 93.00347317013393, -650.3995590473186, 2.0000000000000013, -84.98630555714925, -41.80513924534458, 50.58177904033034, 89.37072347854475, -559.0053172215576, -42.60957902676211, -26.51564596938385, -93.22539244562567, 2.0000000000000013, -0.2694349366798483, -667.1420902637602, -542.6483203552744, -17.53360224585301, -400.902740173734, -53.017186844812805, -14.442055406483398, -101.75747835739854, -297.4882557078532, -252.98244760392828, 198.01999999999998, -186.8603193009655, -104.2288235015507, -48.350244018294, -220.21171187991374, -215.3226870909136, 38.60571847460334, -3.782662914569464, -11.896478437579386, -5.727750112065414, -834.4727626956671, 11.15400070674345, -45.02302035874236, -106.21098949335136, -57.47358366683079, 73.290204662997, -33.642242111361085, -377.097357954363, -600.9338861940971, -365.29421770850433, -163.72983579284318], "policy_predator_policy_reward": [34.87920199681351, 369.88937304272133, 17.4567699217604, 72.40451992288006, 95.79336285821184, 53.12111634407855, 91.80835195791704, 35.90110072986781, 75.8221363074885, 76.43415776479624, 0.0, 103.76877939661095, 60.2474789971683, 507.39874617308004, 194.07713081956726, 112.44819416998241, 44.763856484806745, 21.107046734182838, 172.3263794435026, 160.40722281265997, 554.8671914447152, 135.91697874458137, 110.86520223413028, 555.2605165655343, 220.74401060709863, 191.86396830037452, 340.4515918298914, 343.41554169595304, 213.68158625071231, 70.77026773180336, 496.67315410273113, 406.5394968748584, 240.5685978569839, 141.3734780298707, 705.6721788767518, 100.48587163409401, 67.75080995002803, 303.2119493001414, 138.31951459179382, 157.045911075586, 5.802018212593474, 16.265377392178678, 820.7244429364653, 41.654278830188154, 33.83770360334425, 91.82947605728775, 613.3263355304684, 59.5887762647467, 89.3916692958214, 842.5197586146719, 229.51068347512393, 7.708525939497855, 54.93650028057387, 54.91490900944557, 24.263375757179446, 121.88664089432957, 711.7611996513474, 152.41054321679724, 199.80218955168135, 263.5770353191697, 394.61368589890753, 126.8318391707444, 83.39084495631957, 112.57393245852423, 242.7133220228787, 45.49749053642629, 313.4245296150141, 541.2479501526614, 860.7703528368855, 17.977911445120593, 155.55028730807956, 465.32304631847836, 65.58027120802683, 170.51962434381173, 74.2666461817641, 103.47811435437814, 522.0369478374245, 606.0906250869089, 551.9803335552235, 7.834023756795406, 44.95145375157039, 50.88803305463368, 42.781518663444885, 0.0, 97.6596429687765, 736.5129213258879, 156.06654347534592, 67.36572721214817, 62.23983287245357, 18.676560643354012, 706.5126869869209, 46.306684858394554, 45.39826057734042, 102.77987729681725, 171.39329107418848, 216.0895021649755, 150.452707410624, 26.067639220139696, 0.0, 97.4042467071927, 18.168589752325424, 88.16094256163112, 180.54189159178347, 39.31495380002869, 154.14081667239626, 211.62731066357912, 258.74910549128737, 53.635083131179044, 26.387757053938856, 385.83022357247745, 333.8087953792343, 66.08544220951495, 4.9451030034825605, 59.713047773948226, 86.15424584566334, 75.58966474351577, 140.93357590999923, 581.2071992860491, 62.5834043902069, 38.95419698286266, 57.14299446470294, 6.911992042038856, 71.84663123779669, 343.3279619127916, 99.50567601197245, 179.32864052455034, 147.24150119774444, 94.85649535054145, 109.30630897576816, 180.98078104486365, 41.14151831658384, 85.81456837203247, 1.4922272510925183, 18.69772507055299, 82.39575761805892, 86.31841924738859, 145.09255162205338, 149.36492130429622, 34.687265490950885, 128.85636032899828, 244.59744471860677, 247.52477472483235, 67.92158334442817, 215.59277104079553, 532.4437846218004, 43.77203536351582, 48.15758921727864, 627.7272663177223, 201.82016308077797, 531.020039329737, 6.626943264976921, 12.258286200781729, 18.210887897036805, 55.10415922291491, 84.85762512770054, 171.4850459030805, 59.977282099275776, 41.797971628006735, 6.075232720958235, 650.3243263263604, 59.723664920976454, 73.4925499946517, 154.16648669727718, 15.021010783847851, 113.62750440258162, 559.4495942415073, 155.58875986924545, 80.91929033744121, 0.0, 2.2594349366798445, 669.1420902637602, 542.9483203552743, 334.40982899201254, 425.32354304040126, 4.360543460814115, 66.84869879048178, 7.1860303680582405, 315.39332778551744, 170.24138390764114, 186.82372739726367, 54.26278022912883, 189.65647872554794, 261.8180138170403, 40.44842426036031, 239.35348287656967, 205.1972219964889, 5.752662914569422, 13.836478437579345, 750.3661917380521, 155.826733686175, 113.80122229254941, 89.6039183235776, 18.17616321280718, 171.9344291553939, 194.84918867738077, 96.45489435861631, 733.3589066869031, 295.52233746155684, 107.5191386052896, 510.9462803544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5405989072530368, "mean_inference_ms": 1.640895071082621, "mean_action_processing_ms": 0.24775796804006084, "mean_env_wait_ms": 0.184510651148394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005081057548522949, "StateBufferConnector_ms": 0.0033669471740722656, "ViewRequirementAgentConnector_ms": 0.08980298042297363}, "num_episodes": 18, "episode_return_max": 535.1717120466265, "episode_return_min": -435.2149418133162, "episode_return_mean": 116.1301035858885, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.9431542945849, "num_env_steps_trained_throughput_per_sec": 394.9431542945849, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 10101.068, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10101.027, "sample_time_ms": 1257.604, "learn_time_ms": 8828.602, "learn_throughput": 453.073, "synch_weights_time_ms": 13.79}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "74486_00000", "date": "2024-08-16_15-07-38", "timestamp": 1723801058, "time_this_iter_s": 10.135102987289429, "time_total_s": 726.1598589420319, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397746e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 726.1598589420319, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 41.72, "ram_util_percent": 80.75999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1778952781170133, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2642825192244596, "policy_loss": -0.008179886990458404, "vf_loss": 3.2717314305128875, "vf_explained_var": -0.8054019823276176, "kl": 0.014619314251402279, "entropy": 1.104483848337143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4709723840314874, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.158136711171064, "policy_loss": -0.004245449211349879, "vf_loss": 4.161960076781177, "vf_explained_var": 5.848480280114229e-05, "kl": 0.005627807825259792, "entropy": 0.5330884991972534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 535.1717120466265, "episode_reward_min": -435.2149418133162, "episode_reward_mean": 99.9190754885311, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -834.4727626956671, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 860.7703528368855}, "policy_reward_mean": {"prey_policy": -122.0762861967448, "predator_policy": 172.03582394101025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.60051062144652, 430.69172574814877, 3.9199999999999604, -435.2149418133162, 376.2570003477549, 17.97000000000002, -243.42862017226113, 123.76751988629711, 326.50664918381017, 189.6599999999997, -250.0046012662925, 242.89829648327444, 57.07267694467712, 359.69838722807225, 112.05000000000084, 183.4749079683213, 26.98053873579264, 53.969999999999764, 216.0902845519558, 10.951246194701152, 535.1717120466265, 78.00000000000064, 407.30442970800317, 3.929999999999959, -343.4217526485713, 258.59362178537015, 182.9419539751034, -115.13338400705518, 167.22267070942314, 184.9603437628486, 145.8499999999998, 43.26999999999947, 182.9793177713508, 19.193562404808635, 116.98763644214893, 174.94999999999976, 35.90895730239995, 82.79179517709463, 8.141894581066728, 306.21262787482897, 9.71705830686125, 3.7999999999999603, 66.69978475626145, 122.28606687451246, 219.6223561356456, 78.32732207017854, 242.85885667507458, 7.9281238474988704, 5.422227251092446, 306.0173348468208, 49.31999999999993, 311.69984346168746, 249.62715052001698, 186.218312594807, 34.89999999999997, 75.99929953935636, 12.857201390086566, 84.09000000000134, 3.7599999999999634, 74.82983643491472, 175.36698106871287, 7.999999999999957, 6.4247701131336825, 309.14000000000004, 71.46220239576962, 116.76701179167729, 3.989999999999959, 2.29999999999999, 341.29702961282567, 3.749999999999961, -76.66637591167506, 302.1026637009766, -47.16988384783941, 33.70448217919404, 267.83373625674784, 3.9099999999999597, 65.99241261649435, 169.53612096412786, 26.42601920801885, 330.95204558763186, 50.84999999999987, 89.44136545834266, -5.734128987600025, 127.69556343934413, 3.8399999999999626, 9.495405961343367, 105.67480048402197, 18.550000000000125, 173.8499999999995, 3.90999999999996, 40.5630754129349, 23.871705801003888, 253.7566262861237, 117.31772799620849, 97.74209325824195, 75.31148742400725, 18.861555803427407, 109.20331254726786, 3.8699999999999624, 31.97000000000027], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-226.99622440471998, -42.36602422400379, 145.06479862896123, -9.73849854819224, -3.832018212593516, -14.315377392178673, -623.0093912112872, -674.584272368683, 168.28477630728597, 82.30504437983696, -5.081918692319584, -649.8631931028957, -682.5309510122328, -492.8090970705214, -22.885289453007957, -90.56640007531664, 121.18579679741396, 95.46944309637693, 163.73662424282054, -120.22664089432874, -504.4815971766689, -609.6947469577693, 2.0000000000000013, -222.48092838757614, 2.0000000000000013, -466.3728481249748, 79.05318545282778, 84.68042436040078, -192.02081255930486, 15.85999999999996, -12.250862426409494, -658.9467093729436, -76.15356922498728, -775.6141563212252, -561.6215044361531, -5.2818291904044905, -32.73792019095797, 12.72830919107592, -14.774264610137907, -152.0192497313046, -565.6762894241224, -27.27957145358293, 2.0000000000000013, -483.8143573120188, 161.52427194391134, 149.9406709578877, -40.85151866344527, 2.0000000000000013, -551.4634769808482, -626.1308399623875, -37.95456413548903, 73.11591523336578, 100.02556045929595, 2.0000000000000013, -655.6460861624918, -212.30666968988106, -6.322324167712935, 25.366857002978666, -204.52244947631502, 2.0000000000000013, -27.004721749419346, -3.665624881343977, 2.0000000000000013, -56.13424670719295, -47.56333709249109, 124.21312254988541, -33.46387444126461, -167.1994085457413, -174.82394531519054, -73.95654557863678, -257.7991054912881, 120.36491686882096, -362.7506906042278, -13.558332719788769, -7.158185997407884, -309.9442564142469, -39.82201204755213, -16.694244148811897, 137.6282159700762, 6.840501315574221, -626.0920690012217, -86.33164788796442, -60.703404390207275, -37.034196982863044, -1.5760392174199336, 4.220837466938187, -12.707550852503259, -280.18097542357305, -8.573846644216832, -50.63811375665983, -10.601848248759733, -153.16882622935069, -23.037169791446345, -24.391063554110445, -117.31771911661718, -1.7102437244992992, 2.0000000000000013, -16.76772507055269, 21.060013910792613, 116.24314407058075, -203.95453364790643, -41.18293927844396, 52.18508787075241, 95.97112977098588, -244.4950689234211, 2.0000000000000013, -131.3459314141372, 34.04988962372068, -518.7924868196433, -22.52333316567271, -601.8855559956443, 2.0000000000000013, -609.7250701743875, -110.25793084604062, 61.66305673502282, 3.5417137992182384, -16.270887897036502, -53.28415922291527, -183.51283459586895, 2.0000000000000013, -19.4117458287031, 93.00347317013393, -650.3995590473186, 2.0000000000000013, -84.98630555714925, -41.80513924534458, 50.58177904033034, 89.37072347854475, -559.0053172215576, -42.60957902676211, -26.51564596938385, -93.22539244562567, 2.0000000000000013, -0.2694349366798483, -667.1420902637602, -542.6483203552744, -17.53360224585301, -400.902740173734, -53.017186844812805, -14.442055406483398, -101.75747835739854, -297.4882557078532, -252.98244760392828, 198.01999999999998, -186.8603193009655, -104.2288235015507, -48.350244018294, -220.21171187991374, -215.3226870909136, 38.60571847460334, -3.782662914569464, -11.896478437579386, -5.727750112065414, -834.4727626956671, 11.15400070674345, -45.02302035874236, -106.21098949335136, -57.47358366683079, 73.290204662997, -33.642242111361085, -377.097357954363, -600.9338861940971, -365.29421770850433, -163.72983579284318, -56.37751734161857, -54.39950008268631, 27.031942071605123, -5.910847341114988, -17.927059761064008, -10.876623615484931, -17.019698822891534, -35.56633250065201, -75.22208693119946, -25.250786685459747, -371.2910147792638, 2.0000000000000013, 87.67497280006842, -15.834709740640514, -8.354007842402972, -16.5825866731257, -45.813501459687934, -236.27219360721762, -32.425588747667, -184.02912256675086, -146.91287988126425, -261.77192719926575, -78.78180969514884, -33.12162964331406, -272.90172151430295, -33.40304857852373, -70.24224913787477, -4.17359098341307, -176.95090285887701, -1.866311390777541, -68.84939695587569, -42.59061347059172, -16.567566678965658, -11.975649476150103, -494.87816083061927, -2.9457090885874644], "policy_predator_policy_reward": [67.75080995002803, 303.2119493001414, 138.31951459179382, 157.045911075586, 5.802018212593474, 16.265377392178678, 820.7244429364653, 41.654278830188154, 33.83770360334425, 91.82947605728775, 613.3263355304684, 59.5887762647467, 89.3916692958214, 842.5197586146719, 229.51068347512393, 7.708525939497855, 54.93650028057387, 54.91490900944557, 24.263375757179446, 121.88664089432957, 711.7611996513474, 152.41054321679724, 199.80218955168135, 263.5770353191697, 394.61368589890753, 126.8318391707444, 83.39084495631957, 112.57393245852423, 242.7133220228787, 45.49749053642629, 313.4245296150141, 541.2479501526614, 860.7703528368855, 17.977911445120593, 155.55028730807956, 465.32304631847836, 65.58027120802683, 170.51962434381173, 74.2666461817641, 103.47811435437814, 522.0369478374245, 606.0906250869089, 551.9803335552235, 7.834023756795406, 44.95145375157039, 50.88803305463368, 42.781518663444885, 0.0, 97.6596429687765, 736.5129213258879, 156.06654347534592, 67.36572721214817, 62.23983287245357, 18.676560643354012, 706.5126869869209, 46.306684858394554, 45.39826057734042, 102.77987729681725, 171.39329107418848, 216.0895021649755, 150.452707410624, 26.067639220139696, 0.0, 97.4042467071927, 18.168589752325424, 88.16094256163112, 180.54189159178347, 39.31495380002869, 154.14081667239626, 211.62731066357912, 258.74910549128737, 53.635083131179044, 26.387757053938856, 385.83022357247745, 333.8087953792343, 66.08544220951495, 4.9451030034825605, 59.713047773948226, 86.15424584566334, 75.58966474351577, 140.93357590999923, 581.2071992860491, 62.5834043902069, 38.95419698286266, 57.14299446470294, 6.911992042038856, 71.84663123779669, 343.3279619127916, 99.50567601197245, 179.32864052455034, 147.24150119774444, 94.85649535054145, 109.30630897576816, 180.98078104486365, 41.14151831658384, 85.81456837203247, 1.4922272510925183, 18.69772507055299, 82.39575761805892, 86.31841924738859, 145.09255162205338, 149.36492130429622, 34.687265490950885, 128.85636032899828, 244.59744471860677, 247.52477472483235, 67.92158334442817, 215.59277104079553, 532.4437846218004, 43.77203536351582, 48.15758921727864, 627.7272663177223, 201.82016308077797, 531.020039329737, 6.626943264976921, 12.258286200781729, 18.210887897036805, 55.10415922291491, 84.85762512770054, 171.4850459030805, 59.977282099275776, 41.797971628006735, 6.075232720958235, 650.3243263263604, 59.723664920976454, 73.4925499946517, 154.16648669727718, 15.021010783847851, 113.62750440258162, 559.4495942415073, 155.58875986924545, 80.91929033744121, 0.0, 2.2594349366798445, 669.1420902637602, 542.9483203552743, 334.40982899201254, 425.32354304040126, 4.360543460814115, 66.84869879048178, 7.1860303680582405, 315.39332778551744, 170.24138390764114, 186.82372739726367, 54.26278022912883, 189.65647872554794, 261.8180138170403, 40.44842426036031, 239.35348287656967, 205.1972219964889, 5.752662914569422, 13.836478437579345, 750.3661917380521, 155.826733686175, 113.80122229254941, 89.6039183235776, 18.17616321280718, 171.9344291553939, 194.84918867738077, 96.45489435861631, 733.3589066869031, 295.52233746155684, 107.5191386052896, 510.9462803544, 82.15111004740925, 22.891778389294988, 46.125655854438804, 60.4488128544141, 19.837059761064307, 12.80662361548489, 11.699864246894562, 50.381573037992304, 32.204909552595375, 173.94276454808534, 302.6948697265012, 85.14614505276202, 55.55501180029614, 46.45472514027628, 10.31400784240293, 18.532586673126005, 231.22710407978974, 91.42166640005003, 173.0346616050446, 67.29175551037513, 358.08773913416195, 304.35369423249153, 174.616314882199, 54.60485245247172, 82.8037736585994, 321.24308969246755, 49.91412263405872, 99.81320491123603, 42.89519334442683, 154.78357670865353, 103.40774381449732, 117.2355791592368, 18.49756667896596, 13.915649476150062, 63.076549093836064, 466.71732082537056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5402810796203815, "mean_inference_ms": 1.6414298085116539, "mean_action_processing_ms": 0.24739454172613407, "mean_env_wait_ms": 0.18437137175437873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005562901496887207, "StateBufferConnector_ms": 0.003305673599243164, "ViewRequirementAgentConnector_ms": 0.08891534805297852}, "num_episodes": 18, "episode_return_max": 535.1717120466265, "episode_return_min": -435.2149418133162, "episode_return_mean": 99.9190754885311, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.6390258682697, "num_env_steps_trained_throughput_per_sec": 397.6390258682697, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 10102.044, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10102.002, "sample_time_ms": 1254.643, "learn_time_ms": 8832.569, "learn_throughput": 452.869, "synch_weights_time_ms": 13.803}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "74486_00000", "date": "2024-08-16_15-07-48", "timestamp": 1723801068, "time_this_iter_s": 10.064125776290894, "time_total_s": 736.2239847183228, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3977411f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 736.2239847183228, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 44.7, "ram_util_percent": 80.74285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.209462125402279, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8844336254256113, "policy_loss": -0.006749520467707601, "vf_loss": 2.8905708410752515, "vf_explained_var": -0.5939619303065002, "kl": 0.01224621357281807, "entropy": 1.0715943359824085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3969225402073886, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.002914367781745, "policy_loss": -0.01006188726252211, "vf_loss": 3.012434523446219, "vf_explained_var": 0.011422122502453112, "kl": 0.007223009435349535, "entropy": 0.49489889660524944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 407.30442970800317, "episode_reward_min": -343.4217526485713, "episode_reward_mean": 84.04565345328075, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -834.4727626956671, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 750.3661917380521}, "policy_reward_mean": {"prey_policy": -101.45822166368912, "predator_policy": 143.4810483903294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [407.30442970800317, 3.929999999999959, -343.4217526485713, 258.59362178537015, 182.9419539751034, -115.13338400705518, 167.22267070942314, 184.9603437628486, 145.8499999999998, 43.26999999999947, 182.9793177713508, 19.193562404808635, 116.98763644214893, 174.94999999999976, 35.90895730239995, 82.79179517709463, 8.141894581066728, 306.21262787482897, 9.71705830686125, 3.7999999999999603, 66.69978475626145, 122.28606687451246, 219.6223561356456, 78.32732207017854, 242.85885667507458, 7.9281238474988704, 5.422227251092446, 306.0173348468208, 49.31999999999993, 311.69984346168746, 249.62715052001698, 186.218312594807, 34.89999999999997, 75.99929953935636, 12.857201390086566, 84.09000000000134, 3.7599999999999634, 74.82983643491472, 175.36698106871287, 7.999999999999957, 6.4247701131336825, 309.14000000000004, 71.46220239576962, 116.76701179167729, 3.989999999999959, 2.29999999999999, 341.29702961282567, 3.749999999999961, -76.66637591167506, 302.1026637009766, -47.16988384783941, 33.70448217919404, 267.83373625674784, 3.9099999999999597, 65.99241261649435, 169.53612096412786, 26.42601920801885, 330.95204558763186, 50.84999999999987, 89.44136545834266, -5.734128987600025, 127.69556343934413, 3.8399999999999626, 9.495405961343367, 105.67480048402197, 18.550000000000125, 173.8499999999995, 3.90999999999996, 40.5630754129349, 23.871705801003888, 253.7566262861237, 117.31772799620849, 97.74209325824195, 75.31148742400725, 18.861555803427407, 109.20331254726786, 3.8699999999999624, 31.97000000000027, 53.92920207763131, 33.593617154807106, 53.631037916096005, 174.4246714207507, -36.58899461568704, -139.21176244060823, 54.00089652564322, 34.75999999999968, -61.4485321145467, 152.7468853340103, 37.26109745103768, 38.4971188053552, 86.90000000000141, 59.67999999999959, 3.87999999999996, 27.560000000000517, 28.4500000000005, 23.002969814729177, 284.716087266158, 8.094563689084573, 4.5122308795134805, 8.34999999999993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [161.52427194391134, 149.9406709578877, -40.85151866344527, 2.0000000000000013, -551.4634769808482, -626.1308399623875, -37.95456413548903, 73.11591523336578, 100.02556045929595, 2.0000000000000013, -655.6460861624918, -212.30666968988106, -6.322324167712935, 25.366857002978666, -204.52244947631502, 2.0000000000000013, -27.004721749419346, -3.665624881343977, 2.0000000000000013, -56.13424670719295, -47.56333709249109, 124.21312254988541, -33.46387444126461, -167.1994085457413, -174.82394531519054, -73.95654557863678, -257.7991054912881, 120.36491686882096, -362.7506906042278, -13.558332719788769, -7.158185997407884, -309.9442564142469, -39.82201204755213, -16.694244148811897, 137.6282159700762, 6.840501315574221, -626.0920690012217, -86.33164788796442, -60.703404390207275, -37.034196982863044, -1.5760392174199336, 4.220837466938187, -12.707550852503259, -280.18097542357305, -8.573846644216832, -50.63811375665983, -10.601848248759733, -153.16882622935069, -23.037169791446345, -24.391063554110445, -117.31771911661718, -1.7102437244992992, 2.0000000000000013, -16.76772507055269, 21.060013910792613, 116.24314407058075, -203.95453364790643, -41.18293927844396, 52.18508787075241, 95.97112977098588, -244.4950689234211, 2.0000000000000013, -131.3459314141372, 34.04988962372068, -518.7924868196433, -22.52333316567271, -601.8855559956443, 2.0000000000000013, -609.7250701743875, -110.25793084604062, 61.66305673502282, 3.5417137992182384, -16.270887897036502, -53.28415922291527, -183.51283459586895, 2.0000000000000013, -19.4117458287031, 93.00347317013393, -650.3995590473186, 2.0000000000000013, -84.98630555714925, -41.80513924534458, 50.58177904033034, 89.37072347854475, -559.0053172215576, -42.60957902676211, -26.51564596938385, -93.22539244562567, 2.0000000000000013, -0.2694349366798483, -667.1420902637602, -542.6483203552744, -17.53360224585301, -400.902740173734, -53.017186844812805, -14.442055406483398, -101.75747835739854, -297.4882557078532, -252.98244760392828, 198.01999999999998, -186.8603193009655, -104.2288235015507, -48.350244018294, -220.21171187991374, -215.3226870909136, 38.60571847460334, -3.782662914569464, -11.896478437579386, -5.727750112065414, -834.4727626956671, 11.15400070674345, -45.02302035874236, -106.21098949335136, -57.47358366683079, 73.290204662997, -33.642242111361085, -377.097357954363, -600.9338861940971, -365.29421770850433, -163.72983579284318, -56.37751734161857, -54.39950008268631, 27.031942071605123, -5.910847341114988, -17.927059761064008, -10.876623615484931, -17.019698822891534, -35.56633250065201, -75.22208693119946, -25.250786685459747, -371.2910147792638, 2.0000000000000013, 87.67497280006842, -15.834709740640514, -8.354007842402972, -16.5825866731257, -45.813501459687934, -236.27219360721762, -32.425588747667, -184.02912256675086, -146.91287988126425, -261.77192719926575, -78.78180969514884, -33.12162964331406, -272.90172151430295, -33.40304857852373, -70.24224913787477, -4.17359098341307, -176.95090285887701, -1.866311390777541, -68.84939695587569, -42.59061347059172, -16.567566678965658, -11.975649476150103, -494.87816083061927, -2.9457090885874644, -200.44711369602734, -18.293511654857014, -164.8528981305077, -60.52461653771292, -8.423422872184375, 21.417394624470358, 5.1755807903682065, 32.061307129343355, -64.27004901286169, -107.65449153431628, -348.74338782073954, -188.37789704044926, -15.025684637019292, -499.4569270689087, -182.8708134315685, -177.0526377464545, -161.4337386668127, -342.1787836788608, -341.09517236648435, 2.0000000000000013, -131.90296444686132, -11.70070958652122, -257.66070711827257, -52.7108297280523, 22.136870678577193, 5.1843597793174325, -24.606301622514838, -102.38269191410373, -30.074978296749062, 2.0000000000000013, -6.017766848478679, -14.203390279267229, -69.40384227205588, -13.947430219761124, 2.0000000000000013, -125.08550812911743, -118.43990830703622, 123.10954408620819, -64.16397941692792, -0.5992155874572964, -26.676281366078257, -8.562788103418514, -184.96115215702136, -13.328670287504911], "policy_predator_policy_reward": [44.95145375157039, 50.88803305463368, 42.781518663444885, 0.0, 97.6596429687765, 736.5129213258879, 156.06654347534592, 67.36572721214817, 62.23983287245357, 18.676560643354012, 706.5126869869209, 46.306684858394554, 45.39826057734042, 102.77987729681725, 171.39329107418848, 216.0895021649755, 150.452707410624, 26.067639220139696, 0.0, 97.4042467071927, 18.168589752325424, 88.16094256163112, 180.54189159178347, 39.31495380002869, 154.14081667239626, 211.62731066357912, 258.74910549128737, 53.635083131179044, 26.387757053938856, 385.83022357247745, 333.8087953792343, 66.08544220951495, 4.9451030034825605, 59.713047773948226, 86.15424584566334, 75.58966474351577, 140.93357590999923, 581.2071992860491, 62.5834043902069, 38.95419698286266, 57.14299446470294, 6.911992042038856, 71.84663123779669, 343.3279619127916, 99.50567601197245, 179.32864052455034, 147.24150119774444, 94.85649535054145, 109.30630897576816, 180.98078104486365, 41.14151831658384, 85.81456837203247, 1.4922272510925183, 18.69772507055299, 82.39575761805892, 86.31841924738859, 145.09255162205338, 149.36492130429622, 34.687265490950885, 128.85636032899828, 244.59744471860677, 247.52477472483235, 67.92158334442817, 215.59277104079553, 532.4437846218004, 43.77203536351582, 48.15758921727864, 627.7272663177223, 201.82016308077797, 531.020039329737, 6.626943264976921, 12.258286200781729, 18.210887897036805, 55.10415922291491, 84.85762512770054, 171.4850459030805, 59.977282099275776, 41.797971628006735, 6.075232720958235, 650.3243263263604, 59.723664920976454, 73.4925499946517, 154.16648669727718, 15.021010783847851, 113.62750440258162, 559.4495942415073, 155.58875986924545, 80.91929033744121, 0.0, 2.2594349366798445, 669.1420902637602, 542.9483203552743, 334.40982899201254, 425.32354304040126, 4.360543460814115, 66.84869879048178, 7.1860303680582405, 315.39332778551744, 170.24138390764114, 186.82372739726367, 54.26278022912883, 189.65647872554794, 261.8180138170403, 40.44842426036031, 239.35348287656967, 205.1972219964889, 5.752662914569422, 13.836478437579345, 750.3661917380521, 155.826733686175, 113.80122229254941, 89.6039183235776, 18.17616321280718, 171.9344291553939, 194.84918867738077, 96.45489435861631, 733.3589066869031, 295.52233746155684, 107.5191386052896, 510.9462803544, 82.15111004740925, 22.891778389294988, 46.125655854438804, 60.4488128544141, 19.837059761064307, 12.80662361548489, 11.699864246894562, 50.381573037992304, 32.204909552595375, 173.94276454808534, 302.6948697265012, 85.14614505276202, 55.55501180029614, 46.45472514027628, 10.31400784240293, 18.532586673126005, 231.22710407978974, 91.42166640005003, 173.0346616050446, 67.29175551037513, 358.08773913416195, 304.35369423249153, 174.616314882199, 54.60485245247172, 82.8037736585994, 321.24308969246755, 49.91412263405872, 99.81320491123603, 42.89519334442683, 154.78357670865353, 103.40774381449732, 117.2355791592368, 18.49756667896596, 13.915649476150062, 63.076549093836064, 466.71732082537056, 203.01056781605814, 69.65925961245783, 16.444906790999458, 242.52622503202727, 22.81689334415448, 17.820172819656346, 119.10736250545256, 18.080420995586966, 10.886735618770397, 124.44881031272261, 383.5312335024009, 14.378288918178537, 371.3256449384739, 197.1578632930974, 274.046913520045, 120.63653765797548, 351.89653012836465, 90.2674601027623, 276.4141701084874, 215.42788759200712, 78.41826692825664, 102.4465045561627, 225.70191743294964, 123.1667382187296, 18.63938806741325, 40.93938147469234, 94.87027951493013, 91.79871402168921, 31.954978296749356, 0.0, 37.23964917207593, 10.541507955669909, 14.29855203369302, 97.5027204581247, 110.52079078347121, 35.567687160375655, 234.2273357291072, 45.81911575787974, 32.2931471451681, 40.56461154830272, 27.871799547714147, 11.879500801296402, 171.14154566556252, 35.498276778962406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5400357639338909, "mean_inference_ms": 1.6424293901760436, "mean_action_processing_ms": 0.24701178269909313, "mean_env_wait_ms": 0.18425620812715165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006041884422302246, "StateBufferConnector_ms": 0.0033339262008666992, "ViewRequirementAgentConnector_ms": 0.08990609645843506}, "num_episodes": 22, "episode_return_max": 407.30442970800317, "episode_return_min": -343.4217526485713, "episode_return_mean": 84.04565345328075, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.41746988256625, "num_env_steps_trained_throughput_per_sec": 389.41746988256625, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 10133.266, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10133.224, "sample_time_ms": 1262.177, "learn_time_ms": 8856.491, "learn_throughput": 451.646, "synch_weights_time_ms": 13.575}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "74486_00000", "date": "2024-08-16_15-07-58", "timestamp": 1723801078, "time_this_iter_s": 10.27699613571167, "time_total_s": 746.5009808540344, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39802b4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 746.5009808540344, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 43.733333333333334, "ram_util_percent": 80.62000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.91735271904519, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.531044151007183, "policy_loss": -0.007866962652200113, "vf_loss": 2.5385557085433335, "vf_explained_var": -0.23352253594726483, "kl": 0.007108181610212784, "entropy": 1.0768294909643747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.257640000625893, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.795660738307963, "policy_loss": -0.006106713680777127, "vf_loss": 1.801364355900931, "vf_explained_var": 0.013378554897964317, "kl": 0.005374535075515517, "entropy": 0.40057196268644285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 341.29702961282567, "episode_reward_min": -178.12042391814057, "episode_reward_mean": 65.16956034211127, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -834.4727626956671, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 750.3661917380521}, "policy_reward_mean": {"prey_policy": -99.27648068318521, "predator_policy": 131.86126085424073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.32732207017854, 242.85885667507458, 7.9281238474988704, 5.422227251092446, 306.0173348468208, 49.31999999999993, 311.69984346168746, 249.62715052001698, 186.218312594807, 34.89999999999997, 75.99929953935636, 12.857201390086566, 84.09000000000134, 3.7599999999999634, 74.82983643491472, 175.36698106871287, 7.999999999999957, 6.4247701131336825, 309.14000000000004, 71.46220239576962, 116.76701179167729, 3.989999999999959, 2.29999999999999, 341.29702961282567, 3.749999999999961, -76.66637591167506, 302.1026637009766, -47.16988384783941, 33.70448217919404, 267.83373625674784, 3.9099999999999597, 65.99241261649435, 169.53612096412786, 26.42601920801885, 330.95204558763186, 50.84999999999987, 89.44136545834266, -5.734128987600025, 127.69556343934413, 3.8399999999999626, 9.495405961343367, 105.67480048402197, 18.550000000000125, 173.8499999999995, 3.90999999999996, 40.5630754129349, 23.871705801003888, 253.7566262861237, 117.31772799620849, 97.74209325824195, 75.31148742400725, 18.861555803427407, 109.20331254726786, 3.8699999999999624, 31.97000000000027, 53.92920207763131, 33.593617154807106, 53.631037916096005, 174.4246714207507, -36.58899461568704, -139.21176244060823, 54.00089652564322, 34.75999999999968, -61.4485321145467, 152.7468853340103, 37.26109745103768, 38.4971188053552, 86.90000000000141, 59.67999999999959, 3.87999999999996, 27.560000000000517, 28.4500000000005, 23.002969814729177, 284.716087266158, 8.094563689084573, 4.5122308795134805, 8.34999999999993, 47.46999999999939, 67.50045899416472, 37.30999999999947, 82.7200000000013, 13.290807153316607, 29.550000000000537, 24.407544645587297, 24.210000000000484, 1.6176208313163323, 10.139999999999935, -178.12042391814057, 74.14955800212888, -19.86405845125471, 49.55160131592149, 42.29999999999949, 47.55183210443655, 13.289999999999928, 25.450000000000465, 62.27999999999935, -148.79071932054916, 77.66480544408158, 3.8799999999999604, 9.640602994142098], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.601848248759733, -153.16882622935069, -23.037169791446345, -24.391063554110445, -117.31771911661718, -1.7102437244992992, 2.0000000000000013, -16.76772507055269, 21.060013910792613, 116.24314407058075, -203.95453364790643, -41.18293927844396, 52.18508787075241, 95.97112977098588, -244.4950689234211, 2.0000000000000013, -131.3459314141372, 34.04988962372068, -518.7924868196433, -22.52333316567271, -601.8855559956443, 2.0000000000000013, -609.7250701743875, -110.25793084604062, 61.66305673502282, 3.5417137992182384, -16.270887897036502, -53.28415922291527, -183.51283459586895, 2.0000000000000013, -19.4117458287031, 93.00347317013393, -650.3995590473186, 2.0000000000000013, -84.98630555714925, -41.80513924534458, 50.58177904033034, 89.37072347854475, -559.0053172215576, -42.60957902676211, -26.51564596938385, -93.22539244562567, 2.0000000000000013, -0.2694349366798483, -667.1420902637602, -542.6483203552744, -17.53360224585301, -400.902740173734, -53.017186844812805, -14.442055406483398, -101.75747835739854, -297.4882557078532, -252.98244760392828, 198.01999999999998, -186.8603193009655, -104.2288235015507, -48.350244018294, -220.21171187991374, -215.3226870909136, 38.60571847460334, -3.782662914569464, -11.896478437579386, -5.727750112065414, -834.4727626956671, 11.15400070674345, -45.02302035874236, -106.21098949335136, -57.47358366683079, 73.290204662997, -33.642242111361085, -377.097357954363, -600.9338861940971, -365.29421770850433, -163.72983579284318, -56.37751734161857, -54.39950008268631, 27.031942071605123, -5.910847341114988, -17.927059761064008, -10.876623615484931, -17.019698822891534, -35.56633250065201, -75.22208693119946, -25.250786685459747, -371.2910147792638, 2.0000000000000013, 87.67497280006842, -15.834709740640514, -8.354007842402972, -16.5825866731257, -45.813501459687934, -236.27219360721762, -32.425588747667, -184.02912256675086, -146.91287988126425, -261.77192719926575, -78.78180969514884, -33.12162964331406, -272.90172151430295, -33.40304857852373, -70.24224913787477, -4.17359098341307, -176.95090285887701, -1.866311390777541, -68.84939695587569, -42.59061347059172, -16.567566678965658, -11.975649476150103, -494.87816083061927, -2.9457090885874644, -200.44711369602734, -18.293511654857014, -164.8528981305077, -60.52461653771292, -8.423422872184375, 21.417394624470358, 5.1755807903682065, 32.061307129343355, -64.27004901286169, -107.65449153431628, -348.74338782073954, -188.37789704044926, -15.025684637019292, -499.4569270689087, -182.8708134315685, -177.0526377464545, -161.4337386668127, -342.1787836788608, -341.09517236648435, 2.0000000000000013, -131.90296444686132, -11.70070958652122, -257.66070711827257, -52.7108297280523, 22.136870678577193, 5.1843597793174325, -24.606301622514838, -102.38269191410373, -30.074978296749062, 2.0000000000000013, -6.017766848478679, -14.203390279267229, -69.40384227205588, -13.947430219761124, 2.0000000000000013, -125.08550812911743, -118.43990830703622, 123.10954408620819, -64.16397941692792, -0.5992155874572964, -26.676281366078257, -8.562788103418514, -184.96115215702136, -13.328670287504911, -15.266467297807019, 39.84037436593202, -144.6786647963936, 33.85947127592397, 1.8513037021544398, -70.0107991380606, -14.557646958116544, -38.703294466866005, -36.569384972032815, -185.09061574402523, -61.01200944961096, 14.363969341395661, -26.272626289492223, -62.5161731567909, -2.340942113009703, -122.30057033853369, -21.42194668545835, -38.10640662776602, -312.3101409782597, -0.06889174026845621, -257.37938362537705, -340.40746655397953, -15.538475226963667, -305.76902673349923, -25.54034799579661, -31.842498421190477, 2.163900736106023, -73.77932200374288, 2.0000000000000013, -37.64750092049593, 14.346211106016245, -25.117320093394714, -186.37029384885207, -71.90971228028782, 2.0000000000000013, -99.21858440505302, 34.29779559247883, -5.581478251121899, -290.75913838253535, -518.521858614902, -1.9765769712274033, -261.01242297508145, -18.438487997437853, -1.9448580854964184, -152.27270826226612, -15.45422297910559], "policy_predator_policy_reward": [147.24150119774444, 94.85649535054145, 109.30630897576816, 180.98078104486365, 41.14151831658384, 85.81456837203247, 1.4922272510925183, 18.69772507055299, 82.39575761805892, 86.31841924738859, 145.09255162205338, 149.36492130429622, 34.687265490950885, 128.85636032899828, 244.59744471860677, 247.52477472483235, 67.92158334442817, 215.59277104079553, 532.4437846218004, 43.77203536351582, 48.15758921727864, 627.7272663177223, 201.82016308077797, 531.020039329737, 6.626943264976921, 12.258286200781729, 18.210887897036805, 55.10415922291491, 84.85762512770054, 171.4850459030805, 59.977282099275776, 41.797971628006735, 6.075232720958235, 650.3243263263604, 59.723664920976454, 73.4925499946517, 154.16648669727718, 15.021010783847851, 113.62750440258162, 559.4495942415073, 155.58875986924545, 80.91929033744121, 0.0, 2.2594349366798445, 669.1420902637602, 542.9483203552743, 334.40982899201254, 425.32354304040126, 4.360543460814115, 66.84869879048178, 7.1860303680582405, 315.39332778551744, 170.24138390764114, 186.82372739726367, 54.26278022912883, 189.65647872554794, 261.8180138170403, 40.44842426036031, 239.35348287656967, 205.1972219964889, 5.752662914569422, 13.836478437579345, 750.3661917380521, 155.826733686175, 113.80122229254941, 89.6039183235776, 18.17616321280718, 171.9344291553939, 194.84918867738077, 96.45489435861631, 733.3589066869031, 295.52233746155684, 107.5191386052896, 510.9462803544, 82.15111004740925, 22.891778389294988, 46.125655854438804, 60.4488128544141, 19.837059761064307, 12.80662361548489, 11.699864246894562, 50.381573037992304, 32.204909552595375, 173.94276454808534, 302.6948697265012, 85.14614505276202, 55.55501180029614, 46.45472514027628, 10.31400784240293, 18.532586673126005, 231.22710407978974, 91.42166640005003, 173.0346616050446, 67.29175551037513, 358.08773913416195, 304.35369423249153, 174.616314882199, 54.60485245247172, 82.8037736585994, 321.24308969246755, 49.91412263405872, 99.81320491123603, 42.89519334442683, 154.78357670865353, 103.40774381449732, 117.2355791592368, 18.49756667896596, 13.915649476150062, 63.076549093836064, 466.71732082537056, 203.01056781605814, 69.65925961245783, 16.444906790999458, 242.52622503202727, 22.81689334415448, 17.820172819656346, 119.10736250545256, 18.080420995586966, 10.886735618770397, 124.44881031272261, 383.5312335024009, 14.378288918178537, 371.3256449384739, 197.1578632930974, 274.046913520045, 120.63653765797548, 351.89653012836465, 90.2674601027623, 276.4141701084874, 215.42788759200712, 78.41826692825664, 102.4465045561627, 225.70191743294964, 123.1667382187296, 18.63938806741325, 40.93938147469234, 94.87027951493013, 91.79871402168921, 31.954978296749356, 0.0, 37.23964917207593, 10.541507955669909, 14.29855203369302, 97.5027204581247, 110.52079078347121, 35.567687160375655, 234.2273357291072, 45.81911575787974, 32.2931471451681, 40.56461154830272, 27.871799547714147, 11.879500801296402, 171.14154566556252, 35.498276778962406, 17.20646729780719, 5.6896256340676725, 49.008876754964916, 129.31077575966668, 5.068696297845559, 100.40079913806132, 43.05575764535828, 92.925183779624, 114.08063530027678, 120.87017256909627, 62.89200944961058, 13.306030658604303, 69.84785886317556, 43.348485228694905, 107.99875623558093, 40.85275621596317, 43.25202013034318, 17.89395401419746, 184.1534544310635, 138.36557828746342, 4.901787853841103, 414.76463840737495, 291.6705761289807, 103.78648383360935, 0.0, 37.51878796573177, 25.000981995215575, 96.16604058834412, 13.159163389328047, 64.78833753116763, 5.594471729502735, 52.72846936231317, 41.03649631697799, 230.53350981216155, 16.2806230355314, 106.38796136952237, 3.3222044075208537, 30.241478251121862, 93.80659954399268, 566.6836781328957, 199.9783540879647, 140.6754513024228, 20.33848799743815, 3.9248580854963775, 70.06822794801336, 107.29930628749926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5377384175125005, "mean_inference_ms": 1.637963801130192, "mean_action_processing_ms": 0.24546257784843206, "mean_env_wait_ms": 0.18349700825167134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005840301513671875, "StateBufferConnector_ms": 0.0032922029495239258, "ViewRequirementAgentConnector_ms": 0.08765363693237305}, "num_episodes": 23, "episode_return_max": 341.29702961282567, "episode_return_min": -178.12042391814057, "episode_return_mean": 65.16956034211127, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.84834683262, "num_env_steps_trained_throughput_per_sec": 389.84834683262, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 10115.718, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10115.682, "sample_time_ms": 1256.255, "learn_time_ms": 8845.173, "learn_throughput": 452.224, "synch_weights_time_ms": 13.288}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "74486_00000", "date": "2024-08-16_15-08-08", "timestamp": 1723801088, "time_this_iter_s": 10.275192975997925, "time_total_s": 756.7761738300323, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3980b7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 756.7761738300323, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 38.76428571428571, "ram_util_percent": 80.53571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6845769073281969, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9612220597014858, "policy_loss": -0.008664586400445649, "vf_loss": 2.969250710805257, "vf_explained_var": -0.21556387445914052, "kl": 0.01271891044344488, "entropy": 1.0676651911760764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0744806260028212, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2751600521582143, "policy_loss": -0.005448102001002226, "vf_loss": 2.280240449009749, "vf_explained_var": 0.025923994325456164, "kl": 0.004902714097625388, "entropy": 0.47395196897642955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 341.29702961282567, "episode_reward_min": -178.12042391814057, "episode_reward_mean": 46.13724414777026, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -834.4727626956671, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 750.3661917380521}, "policy_reward_mean": {"prey_policy": -95.3516980135698, "predator_policy": 118.42032008745483}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.14000000000004, 71.46220239576962, 116.76701179167729, 3.989999999999959, 2.29999999999999, 341.29702961282567, 3.749999999999961, -76.66637591167506, 302.1026637009766, -47.16988384783941, 33.70448217919404, 267.83373625674784, 3.9099999999999597, 65.99241261649435, 169.53612096412786, 26.42601920801885, 330.95204558763186, 50.84999999999987, 89.44136545834266, -5.734128987600025, 127.69556343934413, 3.8399999999999626, 9.495405961343367, 105.67480048402197, 18.550000000000125, 173.8499999999995, 3.90999999999996, 40.5630754129349, 23.871705801003888, 253.7566262861237, 117.31772799620849, 97.74209325824195, 75.31148742400725, 18.861555803427407, 109.20331254726786, 3.8699999999999624, 31.97000000000027, 53.92920207763131, 33.593617154807106, 53.631037916096005, 174.4246714207507, -36.58899461568704, -139.21176244060823, 54.00089652564322, 34.75999999999968, -61.4485321145467, 152.7468853340103, 37.26109745103768, 38.4971188053552, 86.90000000000141, 59.67999999999959, 3.87999999999996, 27.560000000000517, 28.4500000000005, 23.002969814729177, 284.716087266158, 8.094563689084573, 4.5122308795134805, 8.34999999999993, 47.46999999999939, 67.50045899416472, 37.30999999999947, 82.7200000000013, 13.290807153316607, 29.550000000000537, 24.407544645587297, 24.210000000000484, 1.6176208313163323, 10.139999999999935, -178.12042391814057, 74.14955800212888, -19.86405845125471, 49.55160131592149, 42.29999999999949, 47.55183210443655, 13.289999999999928, 25.450000000000465, 62.27999999999935, -148.79071932054916, 77.66480544408158, 3.8799999999999604, 9.640602994142098, 3.9299999999999606, 75.63816843343294, 37.163764099504036, 48.27831567651826, 41.09478017847188, 11.679999999999923, 29.650000000000556, 3.919999999999961, -165.91139621792104, 3.7099999999999627, 8.369999999999951, 13.112078366675545, 3.989999999999959, -81.51291963758838, 3.9399999999999586, -61.33707552988685, 13.706789072655164, 20.993135937420817], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [50.58177904033034, 89.37072347854475, -559.0053172215576, -42.60957902676211, -26.51564596938385, -93.22539244562567, 2.0000000000000013, -0.2694349366798483, -667.1420902637602, -542.6483203552744, -17.53360224585301, -400.902740173734, -53.017186844812805, -14.442055406483398, -101.75747835739854, -297.4882557078532, -252.98244760392828, 198.01999999999998, -186.8603193009655, -104.2288235015507, -48.350244018294, -220.21171187991374, -215.3226870909136, 38.60571847460334, -3.782662914569464, -11.896478437579386, -5.727750112065414, -834.4727626956671, 11.15400070674345, -45.02302035874236, -106.21098949335136, -57.47358366683079, 73.290204662997, -33.642242111361085, -377.097357954363, -600.9338861940971, -365.29421770850433, -163.72983579284318, -56.37751734161857, -54.39950008268631, 27.031942071605123, -5.910847341114988, -17.927059761064008, -10.876623615484931, -17.019698822891534, -35.56633250065201, -75.22208693119946, -25.250786685459747, -371.2910147792638, 2.0000000000000013, 87.67497280006842, -15.834709740640514, -8.354007842402972, -16.5825866731257, -45.813501459687934, -236.27219360721762, -32.425588747667, -184.02912256675086, -146.91287988126425, -261.77192719926575, -78.78180969514884, -33.12162964331406, -272.90172151430295, -33.40304857852373, -70.24224913787477, -4.17359098341307, -176.95090285887701, -1.866311390777541, -68.84939695587569, -42.59061347059172, -16.567566678965658, -11.975649476150103, -494.87816083061927, -2.9457090885874644, -200.44711369602734, -18.293511654857014, -164.8528981305077, -60.52461653771292, -8.423422872184375, 21.417394624470358, 5.1755807903682065, 32.061307129343355, -64.27004901286169, -107.65449153431628, -348.74338782073954, -188.37789704044926, -15.025684637019292, -499.4569270689087, -182.8708134315685, -177.0526377464545, -161.4337386668127, -342.1787836788608, -341.09517236648435, 2.0000000000000013, -131.90296444686132, -11.70070958652122, -257.66070711827257, -52.7108297280523, 22.136870678577193, 5.1843597793174325, -24.606301622514838, -102.38269191410373, -30.074978296749062, 2.0000000000000013, -6.017766848478679, -14.203390279267229, -69.40384227205588, -13.947430219761124, 2.0000000000000013, -125.08550812911743, -118.43990830703622, 123.10954408620819, -64.16397941692792, -0.5992155874572964, -26.676281366078257, -8.562788103418514, -184.96115215702136, -13.328670287504911, -15.266467297807019, 39.84037436593202, -144.6786647963936, 33.85947127592397, 1.8513037021544398, -70.0107991380606, -14.557646958116544, -38.703294466866005, -36.569384972032815, -185.09061574402523, -61.01200944961096, 14.363969341395661, -26.272626289492223, -62.5161731567909, -2.340942113009703, -122.30057033853369, -21.42194668545835, -38.10640662776602, -312.3101409782597, -0.06889174026845621, -257.37938362537705, -340.40746655397953, -15.538475226963667, -305.76902673349923, -25.54034799579661, -31.842498421190477, 2.163900736106023, -73.77932200374288, 2.0000000000000013, -37.64750092049593, 14.346211106016245, -25.117320093394714, -186.37029384885207, -71.90971228028782, 2.0000000000000013, -99.21858440505302, 34.29779559247883, -5.581478251121899, -290.75913838253535, -518.521858614902, -1.9765769712274033, -261.01242297508145, -18.438487997437853, -1.9448580854964184, -152.27270826226612, -15.45422297910559, -19.03830759618168, -2.9679075320114547, 4.506698357595771, -16.539643972596622, -9.328736396663771, -50.19211382437913, -7.5980233721245565, -49.11911789051527, 23.78000000000028, -19.078094247716052, -63.14080557389721, -5.216674418128359, -34.966014779509614, 25.699226262934186, -9.236225662049948, -8.494251179235514, -246.79042905264882, -308.7138562427019, -4.217379547600421, -85.76125102508105, -133.80352899208233, -312.0630724400549, -181.62617721415978, -119.8001591065057, 0.004101783544406688, 2.0000000000000013, -207.40728003385254, -137.61665724632206, -0.19716844497997532, -11.876575473289607, -91.5488930821106, -84.87911084089956, -322.1985270001203, -84.14885268802607, 2.0000000000000013, -38.57922604931005], "policy_predator_policy_reward": [154.16648669727718, 15.021010783847851, 113.62750440258162, 559.4495942415073, 155.58875986924545, 80.91929033744121, 0.0, 2.2594349366798445, 669.1420902637602, 542.9483203552743, 334.40982899201254, 425.32354304040126, 4.360543460814115, 66.84869879048178, 7.1860303680582405, 315.39332778551744, 170.24138390764114, 186.82372739726367, 54.26278022912883, 189.65647872554794, 261.8180138170403, 40.44842426036031, 239.35348287656967, 205.1972219964889, 5.752662914569422, 13.836478437579345, 750.3661917380521, 155.826733686175, 113.80122229254941, 89.6039183235776, 18.17616321280718, 171.9344291553939, 194.84918867738077, 96.45489435861631, 733.3589066869031, 295.52233746155684, 107.5191386052896, 510.9462803544, 82.15111004740925, 22.891778389294988, 46.125655854438804, 60.4488128544141, 19.837059761064307, 12.80662361548489, 11.699864246894562, 50.381573037992304, 32.204909552595375, 173.94276454808534, 302.6948697265012, 85.14614505276202, 55.55501180029614, 46.45472514027628, 10.31400784240293, 18.532586673126005, 231.22710407978974, 91.42166640005003, 173.0346616050446, 67.29175551037513, 358.08773913416195, 304.35369423249153, 174.616314882199, 54.60485245247172, 82.8037736585994, 321.24308969246755, 49.91412263405872, 99.81320491123603, 42.89519334442683, 154.78357670865353, 103.40774381449732, 117.2355791592368, 18.49756667896596, 13.915649476150062, 63.076549093836064, 466.71732082537056, 203.01056781605814, 69.65925961245783, 16.444906790999458, 242.52622503202727, 22.81689334415448, 17.820172819656346, 119.10736250545256, 18.080420995586966, 10.886735618770397, 124.44881031272261, 383.5312335024009, 14.378288918178537, 371.3256449384739, 197.1578632930974, 274.046913520045, 120.63653765797548, 351.89653012836465, 90.2674601027623, 276.4141701084874, 215.42788759200712, 78.41826692825664, 102.4465045561627, 225.70191743294964, 123.1667382187296, 18.63938806741325, 40.93938147469234, 94.87027951493013, 91.79871402168921, 31.954978296749356, 0.0, 37.23964917207593, 10.541507955669909, 14.29855203369302, 97.5027204581247, 110.52079078347121, 35.567687160375655, 234.2273357291072, 45.81911575787974, 32.2931471451681, 40.56461154830272, 27.871799547714147, 11.879500801296402, 171.14154566556252, 35.498276778962406, 17.20646729780719, 5.6896256340676725, 49.008876754964916, 129.31077575966668, 5.068696297845559, 100.40079913806132, 43.05575764535828, 92.925183779624, 114.08063530027678, 120.87017256909627, 62.89200944961058, 13.306030658604303, 69.84785886317556, 43.348485228694905, 107.99875623558093, 40.85275621596317, 43.25202013034318, 17.89395401419746, 184.1534544310635, 138.36557828746342, 4.901787853841103, 414.76463840737495, 291.6705761289807, 103.78648383360935, 0.0, 37.51878796573177, 25.000981995215575, 96.16604058834412, 13.159163389328047, 64.78833753116763, 5.594471729502735, 52.72846936231317, 41.03649631697799, 230.53350981216155, 16.2806230355314, 106.38796136952237, 3.3222044075208537, 30.241478251121862, 93.80659954399268, 566.6836781328957, 199.9783540879647, 140.6754513024228, 20.33848799743815, 3.9248580854963775, 70.06822794801336, 107.29930628749926, 20.988307596181986, 4.9479075320114125, 54.081508476825555, 33.589605571606896, 23.606700175316174, 73.07791414523103, 11.539337664301296, 93.45611927485703, 16.518413544222966, 19.874460881965923, 0.0, 80.03747999202577, 38.916788516575316, 0.0, 11.196225662049907, 10.454251179235472, 325.60600579392076, 63.98688328350885, 6.187379547600379, 87.50125102508194, 132.1212581919174, 322.11534324021835, 184.40421384653152, 130.1342008408092, 1.985898216455595, 0.0, 263.5110176425848, 0.0, 2.187168444979973, 13.826575473289566, 115.0909283931253, 0.0, 326.6914168828155, 93.3627518779863, 18.394695109766168, 39.17766687696378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5397348005893108, "mean_inference_ms": 1.643794194142955, "mean_action_processing_ms": 0.24644669854973228, "mean_env_wait_ms": 0.1840083667796921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005381107330322266, "StateBufferConnector_ms": 0.004839539527893066, "ViewRequirementAgentConnector_ms": 0.0894695520401001}, "num_episodes": 18, "episode_return_max": 341.29702961282567, "episode_return_min": -178.12042391814057, "episode_return_mean": 46.13724414777026, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.79451101958193, "num_env_steps_trained_throughput_per_sec": 352.79451101958193, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 10242.088, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10242.049, "sample_time_ms": 1269.777, "learn_time_ms": 8957.485, "learn_throughput": 446.554, "synch_weights_time_ms": 13.888}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "74486_00000", "date": "2024-08-16_15-08-20", "timestamp": 1723801100, "time_this_iter_s": 11.37099003791809, "time_total_s": 768.1471638679504, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3980b7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 768.1471638679504, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 57.4125, "ram_util_percent": 80.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6153110901357004, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.404286743030346, "policy_loss": -0.013032750287167136, "vf_loss": 2.4166760994013026, "vf_explained_var": -0.417808903808947, "kl": 0.012867912330002083, "entropy": 1.123494409821021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.159568573321615, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0959665281432014, "policy_loss": -0.0036191430872936966, "vf_loss": 2.099430385058519, "vf_explained_var": 0.04688439656186987, "kl": 0.0041410391846583815, "entropy": 0.3854606884339499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 290.6206236786923, "episode_reward_min": -178.12042391814057, "episode_reward_mean": 31.423177355523386, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -518.521858614902, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 123.10954408620819, "predator_policy": 566.6836781328957}, "policy_reward_mean": {"prey_policy": -80.21101500523453, "predator_policy": 95.92260368299613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.44136545834266, -5.734128987600025, 127.69556343934413, 3.8399999999999626, 9.495405961343367, 105.67480048402197, 18.550000000000125, 173.8499999999995, 3.90999999999996, 40.5630754129349, 23.871705801003888, 253.7566262861237, 117.31772799620849, 97.74209325824195, 75.31148742400725, 18.861555803427407, 109.20331254726786, 3.8699999999999624, 31.97000000000027, 53.92920207763131, 33.593617154807106, 53.631037916096005, 174.4246714207507, -36.58899461568704, -139.21176244060823, 54.00089652564322, 34.75999999999968, -61.4485321145467, 152.7468853340103, 37.26109745103768, 38.4971188053552, 86.90000000000141, 59.67999999999959, 3.87999999999996, 27.560000000000517, 28.4500000000005, 23.002969814729177, 284.716087266158, 8.094563689084573, 4.5122308795134805, 8.34999999999993, 47.46999999999939, 67.50045899416472, 37.30999999999947, 82.7200000000013, 13.290807153316607, 29.550000000000537, 24.407544645587297, 24.210000000000484, 1.6176208313163323, 10.139999999999935, -178.12042391814057, 74.14955800212888, -19.86405845125471, 49.55160131592149, 42.29999999999949, 47.55183210443655, 13.289999999999928, 25.450000000000465, 62.27999999999935, -148.79071932054916, 77.66480544408158, 3.8799999999999604, 9.640602994142098, 3.9299999999999606, 75.63816843343294, 37.163764099504036, 48.27831567651826, 41.09478017847188, 11.679999999999923, 29.650000000000556, 3.919999999999961, -165.91139621792104, 3.7099999999999627, 8.369999999999951, 13.112078366675545, 3.989999999999959, -81.51291963758838, 3.9399999999999586, -61.33707552988685, 13.706789072655164, 20.993135937420817, 3.5399999999999667, 72.20000000000121, 36.319999999999396, 2.8699999999999815, 93.29950172808468, 290.6206236786923, 19.172324940857738, 7.2828420451045135, 8.359999999999928, 48.439999999999365, 20.997048970924613, 35.679982953909835, 3.7999999999999603, 6.539999999999925, -173.46153898831227, 3.9499999999999593, 19.590000000000515, 5.5699999999999275], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-365.29421770850433, -163.72983579284318, -56.37751734161857, -54.39950008268631, 27.031942071605123, -5.910847341114988, -17.927059761064008, -10.876623615484931, -17.019698822891534, -35.56633250065201, -75.22208693119946, -25.250786685459747, -371.2910147792638, 2.0000000000000013, 87.67497280006842, -15.834709740640514, -8.354007842402972, -16.5825866731257, -45.813501459687934, -236.27219360721762, -32.425588747667, -184.02912256675086, -146.91287988126425, -261.77192719926575, -78.78180969514884, -33.12162964331406, -272.90172151430295, -33.40304857852373, -70.24224913787477, -4.17359098341307, -176.95090285887701, -1.866311390777541, -68.84939695587569, -42.59061347059172, -16.567566678965658, -11.975649476150103, -494.87816083061927, -2.9457090885874644, -200.44711369602734, -18.293511654857014, -164.8528981305077, -60.52461653771292, -8.423422872184375, 21.417394624470358, 5.1755807903682065, 32.061307129343355, -64.27004901286169, -107.65449153431628, -348.74338782073954, -188.37789704044926, -15.025684637019292, -499.4569270689087, -182.8708134315685, -177.0526377464545, -161.4337386668127, -342.1787836788608, -341.09517236648435, 2.0000000000000013, -131.90296444686132, -11.70070958652122, -257.66070711827257, -52.7108297280523, 22.136870678577193, 5.1843597793174325, -24.606301622514838, -102.38269191410373, -30.074978296749062, 2.0000000000000013, -6.017766848478679, -14.203390279267229, -69.40384227205588, -13.947430219761124, 2.0000000000000013, -125.08550812911743, -118.43990830703622, 123.10954408620819, -64.16397941692792, -0.5992155874572964, -26.676281366078257, -8.562788103418514, -184.96115215702136, -13.328670287504911, -15.266467297807019, 39.84037436593202, -144.6786647963936, 33.85947127592397, 1.8513037021544398, -70.0107991380606, -14.557646958116544, -38.703294466866005, -36.569384972032815, -185.09061574402523, -61.01200944961096, 14.363969341395661, -26.272626289492223, -62.5161731567909, -2.340942113009703, -122.30057033853369, -21.42194668545835, -38.10640662776602, -312.3101409782597, -0.06889174026845621, -257.37938362537705, -340.40746655397953, -15.538475226963667, -305.76902673349923, -25.54034799579661, -31.842498421190477, 2.163900736106023, -73.77932200374288, 2.0000000000000013, -37.64750092049593, 14.346211106016245, -25.117320093394714, -186.37029384885207, -71.90971228028782, 2.0000000000000013, -99.21858440505302, 34.29779559247883, -5.581478251121899, -290.75913838253535, -518.521858614902, -1.9765769712274033, -261.01242297508145, -18.438487997437853, -1.9448580854964184, -152.27270826226612, -15.45422297910559, -19.03830759618168, -2.9679075320114547, 4.506698357595771, -16.539643972596622, -9.328736396663771, -50.19211382437913, -7.5980233721245565, -49.11911789051527, 23.78000000000028, -19.078094247716052, -63.14080557389721, -5.216674418128359, -34.966014779509614, 25.699226262934186, -9.236225662049948, -8.494251179235514, -246.79042905264882, -308.7138562427019, -4.217379547600421, -85.76125102508105, -133.80352899208233, -312.0630724400549, -181.62617721415978, -119.8001591065057, 0.004101783544406688, 2.0000000000000013, -207.40728003385254, -137.61665724632206, -0.19716844497997532, -11.876575473289607, -91.5488930821106, -84.87911084089956, -322.1985270001203, -84.14885268802607, 2.0000000000000013, -38.57922604931005, -49.98766841489035, -116.86228077876478, 2.0000000000000013, 47.807342742085595, -29.13732457107509, -30.99257619088699, -280.71830043479065, 2.0000000000000013, -152.57105595123244, -33.93748938086478, 26.59201823468352, -212.94705524165167, -10.901430511113507, -60.20475252297271, -22.02102317802892, -80.16837778264976, -32.10623762242873, -131.44177446767725, 13.879999999999962, 9.496952626549096, -72.88481755871514, -56.18298461563263, -85.64616182779427, -100.1148404196197, -53.2369758250451, -7.196025570714385, -25.172069004962534, -116.3066628340129, -235.97093413263119, -383.3707759679478, 2.0000000000000013, -8.604877526157525, 12.88999999999996, -64.74937206166832, -5.481599920105026, -87.36590754838475], "policy_predator_policy_reward": [107.5191386052896, 510.9462803544, 82.15111004740925, 22.891778389294988, 46.125655854438804, 60.4488128544141, 19.837059761064307, 12.80662361548489, 11.699864246894562, 50.381573037992304, 32.204909552595375, 173.94276454808534, 302.6948697265012, 85.14614505276202, 55.55501180029614, 46.45472514027628, 10.31400784240293, 18.532586673126005, 231.22710407978974, 91.42166640005003, 173.0346616050446, 67.29175551037513, 358.08773913416195, 304.35369423249153, 174.616314882199, 54.60485245247172, 82.8037736585994, 321.24308969246755, 49.91412263405872, 99.81320491123603, 42.89519334442683, 154.78357670865353, 103.40774381449732, 117.2355791592368, 18.49756667896596, 13.915649476150062, 63.076549093836064, 466.71732082537056, 203.01056781605814, 69.65925961245783, 16.444906790999458, 242.52622503202727, 22.81689334415448, 17.820172819656346, 119.10736250545256, 18.080420995586966, 10.886735618770397, 124.44881031272261, 383.5312335024009, 14.378288918178537, 371.3256449384739, 197.1578632930974, 274.046913520045, 120.63653765797548, 351.89653012836465, 90.2674601027623, 276.4141701084874, 215.42788759200712, 78.41826692825664, 102.4465045561627, 225.70191743294964, 123.1667382187296, 18.63938806741325, 40.93938147469234, 94.87027951493013, 91.79871402168921, 31.954978296749356, 0.0, 37.23964917207593, 10.541507955669909, 14.29855203369302, 97.5027204581247, 110.52079078347121, 35.567687160375655, 234.2273357291072, 45.81911575787974, 32.2931471451681, 40.56461154830272, 27.871799547714147, 11.879500801296402, 171.14154566556252, 35.498276778962406, 17.20646729780719, 5.6896256340676725, 49.008876754964916, 129.31077575966668, 5.068696297845559, 100.40079913806132, 43.05575764535828, 92.925183779624, 114.08063530027678, 120.87017256909627, 62.89200944961058, 13.306030658604303, 69.84785886317556, 43.348485228694905, 107.99875623558093, 40.85275621596317, 43.25202013034318, 17.89395401419746, 184.1534544310635, 138.36557828746342, 4.901787853841103, 414.76463840737495, 291.6705761289807, 103.78648383360935, 0.0, 37.51878796573177, 25.000981995215575, 96.16604058834412, 13.159163389328047, 64.78833753116763, 5.594471729502735, 52.72846936231317, 41.03649631697799, 230.53350981216155, 16.2806230355314, 106.38796136952237, 3.3222044075208537, 30.241478251121862, 93.80659954399268, 566.6836781328957, 199.9783540879647, 140.6754513024228, 20.33848799743815, 3.9248580854963775, 70.06822794801336, 107.29930628749926, 20.988307596181986, 4.9479075320114125, 54.081508476825555, 33.589605571606896, 23.606700175316174, 73.07791414523103, 11.539337664301296, 93.45611927485703, 16.518413544222966, 19.874460881965923, 0.0, 80.03747999202577, 38.916788516575316, 0.0, 11.196225662049907, 10.454251179235472, 325.60600579392076, 63.98688328350885, 6.187379547600379, 87.50125102508194, 132.1212581919174, 322.11534324021835, 184.40421384653152, 130.1342008408092, 1.985898216455595, 0.0, 263.5110176425848, 0.0, 2.187168444979973, 13.826575473289566, 115.0909283931253, 0.0, 326.6914168828155, 93.3627518779863, 18.394695109766168, 39.17766687696378, 53.504891984579096, 116.88505720907656, 0.0, 22.39265725791416, 3.3331179494640004, 93.11678281249833, 281.58830043479037, 0.0, 155.64787274865188, 124.16017431152733, 245.92852197326403, 231.0471387123971, 31.312017423356384, 58.966490551586716, 62.36841391872235, 47.10382908706211, 35.936237622428365, 135.97177446767603, 0.0, 25.06304737345087, 76.98858360332784, 73.07626754194449, 157.54421577556147, 63.89676942576435, 55.076975825044734, 9.156025570714343, 133.87962222219664, 14.139109616779889, 12.495083385058757, 433.3850877272073, 0.0, 10.554877526157483, 71.44937206166918, 0.0, 60.35817230081446, 38.059335167676096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5396478791333124, "mean_inference_ms": 1.6446218839545919, "mean_action_processing_ms": 0.24619818706109847, "mean_env_wait_ms": 0.1839112508010027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047206878662109375, "StateBufferConnector_ms": 0.004468798637390137, "ViewRequirementAgentConnector_ms": 0.0905841588973999}, "num_episodes": 18, "episode_return_max": 290.6206236786923, "episode_return_min": -178.12042391814057, "episode_return_mean": 31.423177355523386, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.5858569383547, "num_env_steps_trained_throughput_per_sec": 380.5858569383547, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 10265.918, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10265.879, "sample_time_ms": 1279.149, "learn_time_ms": 8971.991, "learn_throughput": 445.832, "synch_weights_time_ms": 13.828}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "74486_00000", "date": "2024-08-16_15-08-30", "timestamp": 1723801110, "time_this_iter_s": 10.5144681930542, "time_total_s": 778.6616320610046, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39802b670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 778.6616320610046, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 47.72, "ram_util_percent": 80.81333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5261308060909706, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.823230108192989, "policy_loss": -0.013250274174457425, "vf_loss": 2.835937792535812, "vf_explained_var": -0.7052233900973406, "kl": 0.010851612456383513, "entropy": 1.099671223933104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1436719561222368, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7357402047782977, "policy_loss": -0.005937761171085258, "vf_loss": 2.7415607511051117, "vf_explained_var": 0.021551879846229756, "kl": 0.0062517349907726125, "entropy": 0.3840553804995522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 290.6206236786923, "episode_reward_min": -266.3770482187065, "episode_reward_mean": 20.757301902134053, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -518.521858614902, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 123.10954408620819, "predator_policy": 566.6836781328957}, "policy_reward_mean": {"prey_policy": -84.68671823007058, "predator_policy": 95.0653691811375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.4246714207507, -36.58899461568704, -139.21176244060823, 54.00089652564322, 34.75999999999968, -61.4485321145467, 152.7468853340103, 37.26109745103768, 38.4971188053552, 86.90000000000141, 59.67999999999959, 3.87999999999996, 27.560000000000517, 28.4500000000005, 23.002969814729177, 284.716087266158, 8.094563689084573, 4.5122308795134805, 8.34999999999993, 47.46999999999939, 67.50045899416472, 37.30999999999947, 82.7200000000013, 13.290807153316607, 29.550000000000537, 24.407544645587297, 24.210000000000484, 1.6176208313163323, 10.139999999999935, -178.12042391814057, 74.14955800212888, -19.86405845125471, 49.55160131592149, 42.29999999999949, 47.55183210443655, 13.289999999999928, 25.450000000000465, 62.27999999999935, -148.79071932054916, 77.66480544408158, 3.8799999999999604, 9.640602994142098, 3.9299999999999606, 75.63816843343294, 37.163764099504036, 48.27831567651826, 41.09478017847188, 11.679999999999923, 29.650000000000556, 3.919999999999961, -165.91139621792104, 3.7099999999999627, 8.369999999999951, 13.112078366675545, 3.989999999999959, -81.51291963758838, 3.9399999999999586, -61.33707552988685, 13.706789072655164, 20.993135937420817, 3.5399999999999667, 72.20000000000121, 36.319999999999396, 2.8699999999999815, 93.29950172808468, 290.6206236786923, 19.172324940857738, 7.2828420451045135, 8.359999999999928, 48.439999999999365, 20.997048970924613, 35.679982953909835, 3.7999999999999603, 6.539999999999925, -173.46153898831227, 3.9499999999999593, 19.590000000000515, 5.5699999999999275, -20.8463794395469, 3.969999999999959, 31.92287071306938, 3.8699999999999615, 52.809999999999704, 46.776344494629846, 12.219999999999931, 44.73302210665973, 73.3842978329946, 27.710000000000555, -14.717293001679112, 3.759999999999962, 37.419999999999455, 12.19118235033829, 13.409999999999929, 99.59430362302845, -266.3770482187065, 12.069999999999936, 45.841011370244395, 88.1798236851416, 61.96476717809482, 3.86999999999996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.1755807903682065, 32.061307129343355, -64.27004901286169, -107.65449153431628, -348.74338782073954, -188.37789704044926, -15.025684637019292, -499.4569270689087, -182.8708134315685, -177.0526377464545, -161.4337386668127, -342.1787836788608, -341.09517236648435, 2.0000000000000013, -131.90296444686132, -11.70070958652122, -257.66070711827257, -52.7108297280523, 22.136870678577193, 5.1843597793174325, -24.606301622514838, -102.38269191410373, -30.074978296749062, 2.0000000000000013, -6.017766848478679, -14.203390279267229, -69.40384227205588, -13.947430219761124, 2.0000000000000013, -125.08550812911743, -118.43990830703622, 123.10954408620819, -64.16397941692792, -0.5992155874572964, -26.676281366078257, -8.562788103418514, -184.96115215702136, -13.328670287504911, -15.266467297807019, 39.84037436593202, -144.6786647963936, 33.85947127592397, 1.8513037021544398, -70.0107991380606, -14.557646958116544, -38.703294466866005, -36.569384972032815, -185.09061574402523, -61.01200944961096, 14.363969341395661, -26.272626289492223, -62.5161731567909, -2.340942113009703, -122.30057033853369, -21.42194668545835, -38.10640662776602, -312.3101409782597, -0.06889174026845621, -257.37938362537705, -340.40746655397953, -15.538475226963667, -305.76902673349923, -25.54034799579661, -31.842498421190477, 2.163900736106023, -73.77932200374288, 2.0000000000000013, -37.64750092049593, 14.346211106016245, -25.117320093394714, -186.37029384885207, -71.90971228028782, 2.0000000000000013, -99.21858440505302, 34.29779559247883, -5.581478251121899, -290.75913838253535, -518.521858614902, -1.9765769712274033, -261.01242297508145, -18.438487997437853, -1.9448580854964184, -152.27270826226612, -15.45422297910559, -19.03830759618168, -2.9679075320114547, 4.506698357595771, -16.539643972596622, -9.328736396663771, -50.19211382437913, -7.5980233721245565, -49.11911789051527, 23.78000000000028, -19.078094247716052, -63.14080557389721, -5.216674418128359, -34.966014779509614, 25.699226262934186, -9.236225662049948, -8.494251179235514, -246.79042905264882, -308.7138562427019, -4.217379547600421, -85.76125102508105, -133.80352899208233, -312.0630724400549, -181.62617721415978, -119.8001591065057, 0.004101783544406688, 2.0000000000000013, -207.40728003385254, -137.61665724632206, -0.19716844497997532, -11.876575473289607, -91.5488930821106, -84.87911084089956, -322.1985270001203, -84.14885268802607, 2.0000000000000013, -38.57922604931005, -49.98766841489035, -116.86228077876478, 2.0000000000000013, 47.807342742085595, -29.13732457107509, -30.99257619088699, -280.71830043479065, 2.0000000000000013, -152.57105595123244, -33.93748938086478, 26.59201823468352, -212.94705524165167, -10.901430511113507, -60.20475252297271, -22.02102317802892, -80.16837778264976, -32.10623762242873, -131.44177446767725, 13.879999999999962, 9.496952626549096, -72.88481755871514, -56.18298461563263, -85.64616182779427, -100.1148404196197, -53.2369758250451, -7.196025570714385, -25.172069004962534, -116.3066628340129, -235.97093413263119, -383.3707759679478, 2.0000000000000013, -8.604877526157525, 12.88999999999996, -64.74937206166832, -5.481599920105026, -87.36590754838475, -68.4979996356913, -42.21071584905848, -9.293683405559628, 2.0000000000000013, -199.22045198040112, -130.82137903233408, -6.78160697364399, -16.937872473213197, -283.93298240926987, -168.43858102132646, -197.10955282630067, -71.31942584864763, -1.246788479380215, -205.08973215920156, -95.86591345716629, 35.09303987492461, -110.3700781804205, -298.71903170596397, 2.0000000000000013, 16.387867275268796, -40.50899829509259, -73.0864606972052, -9.843505681588912, -47.12715335107017, -13.568615008890768, 0.48598464712908046, -68.93063801203292, -23.322725663481936, -95.8108247542587, -75.28474736220946, -177.27938017122707, -283.5806503760796, -383.8503466818158, -328.3572072953803, -378.4522029560265, 2.0000000000000013, 6.409477513820827, -69.8126061308062, -391.616816953678, -170.85050244243507, -166.8489752586073, 1.0677396326028188, -24.145958921685107, -2.9782952387758304], "policy_predator_policy_reward": [119.10736250545256, 18.080420995586966, 10.886735618770397, 124.44881031272261, 383.5312335024009, 14.378288918178537, 371.3256449384739, 197.1578632930974, 274.046913520045, 120.63653765797548, 351.89653012836465, 90.2674601027623, 276.4141701084874, 215.42788759200712, 78.41826692825664, 102.4465045561627, 225.70191743294964, 123.1667382187296, 18.63938806741325, 40.93938147469234, 94.87027951493013, 91.79871402168921, 31.954978296749356, 0.0, 37.23964917207593, 10.541507955669909, 14.29855203369302, 97.5027204581247, 110.52079078347121, 35.567687160375655, 234.2273357291072, 45.81911575787974, 32.2931471451681, 40.56461154830272, 27.871799547714147, 11.879500801296402, 171.14154566556252, 35.498276778962406, 17.20646729780719, 5.6896256340676725, 49.008876754964916, 129.31077575966668, 5.068696297845559, 100.40079913806132, 43.05575764535828, 92.925183779624, 114.08063530027678, 120.87017256909627, 62.89200944961058, 13.306030658604303, 69.84785886317556, 43.348485228694905, 107.99875623558093, 40.85275621596317, 43.25202013034318, 17.89395401419746, 184.1534544310635, 138.36557828746342, 4.901787853841103, 414.76463840737495, 291.6705761289807, 103.78648383360935, 0.0, 37.51878796573177, 25.000981995215575, 96.16604058834412, 13.159163389328047, 64.78833753116763, 5.594471729502735, 52.72846936231317, 41.03649631697799, 230.53350981216155, 16.2806230355314, 106.38796136952237, 3.3222044075208537, 30.241478251121862, 93.80659954399268, 566.6836781328957, 199.9783540879647, 140.6754513024228, 20.33848799743815, 3.9248580854963775, 70.06822794801336, 107.29930628749926, 20.988307596181986, 4.9479075320114125, 54.081508476825555, 33.589605571606896, 23.606700175316174, 73.07791414523103, 11.539337664301296, 93.45611927485703, 16.518413544222966, 19.874460881965923, 0.0, 80.03747999202577, 38.916788516575316, 0.0, 11.196225662049907, 10.454251179235472, 325.60600579392076, 63.98688328350885, 6.187379547600379, 87.50125102508194, 132.1212581919174, 322.11534324021835, 184.40421384653152, 130.1342008408092, 1.985898216455595, 0.0, 263.5110176425848, 0.0, 2.187168444979973, 13.826575473289566, 115.0909283931253, 0.0, 326.6914168828155, 93.3627518779863, 18.394695109766168, 39.17766687696378, 53.504891984579096, 116.88505720907656, 0.0, 22.39265725791416, 3.3331179494640004, 93.11678281249833, 281.58830043479037, 0.0, 155.64787274865188, 124.16017431152733, 245.92852197326403, 231.0471387123971, 31.312017423356384, 58.966490551586716, 62.36841391872235, 47.10382908706211, 35.936237622428365, 135.97177446767603, 0.0, 25.06304737345087, 76.98858360332784, 73.07626754194449, 157.54421577556147, 63.89676942576435, 55.076975825044734, 9.156025570714343, 133.87962222219664, 14.139109616779889, 12.495083385058757, 433.3850877272073, 0.0, 10.554877526157483, 71.44937206166918, 0.0, 60.35817230081446, 38.059335167676096, 10.450779003112318, 79.41155704209051, 11.263683405559586, 0.0, 260.2650290611409, 101.69967266466078, 12.657960908652939, 14.931518538204493, 332.70834405026545, 172.47321938032928, 137.05404746290938, 178.15127570666868, 209.48706640231265, 9.069454236267951, 11.505649244148309, 94.00024644475336, 191.84082219822503, 290.63258552115263, 9.322132724731238, 0.0, 95.65564405878763, 3.2225219318312903, 11.79350568158887, 48.93715335106981, 21.352984872131536, 29.149645489630128, 59.360162307313175, 45.08438371854132, 68.06247873712444, 116.44309337934541, 308.5775942188087, 251.8767399515231, 384.6432705632539, 61.18723519523671, 360.8854265453051, 27.63677641072039, 70.78777038853787, 38.45636959869353, 390.2708797189344, 260.3762633623176, 107.76430062763161, 119.981702176467, 22.38223329427126, 8.612020866189933]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392436372312475, "mean_inference_ms": 1.6453717110598616, "mean_action_processing_ms": 0.24572456274714785, "mean_env_wait_ms": 0.18355698825949354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049741268157958984, "StateBufferConnector_ms": 0.004497647285461426, "ViewRequirementAgentConnector_ms": 0.09224092960357666}, "num_episodes": 22, "episode_return_max": 290.6206236786923, "episode_return_min": -266.3770482187065, "episode_return_mean": 20.757301902134053, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.8399534520259, "num_env_steps_trained_throughput_per_sec": 383.8399534520259, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 10320.302, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10320.263, "sample_time_ms": 1291.494, "learn_time_ms": 9014.154, "learn_throughput": 443.747, "synch_weights_time_ms": 13.587}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "74486_00000", "date": "2024-08-16_15-08-41", "timestamp": 1723801121, "time_this_iter_s": 10.429501056671143, "time_total_s": 789.0911331176758, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39802d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 789.0911331176758, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 45.92, "ram_util_percent": 80.85333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4782057624645333, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.020770857069228, "policy_loss": -0.008621547928094745, "vf_loss": 4.028913407855564, "vf_explained_var": -0.3671139754315533, "kl": 0.009579849272615825, "entropy": 1.127374280129791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4544756494186544, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9033110850702517, "policy_loss": -0.008495975385306689, "vf_loss": 3.911613403930866, "vf_explained_var": 0.0020976043252087144, "kl": 0.01032866118028434, "entropy": 0.38021327167276353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 290.6206236786923, "episode_reward_min": -367.4362838744529, "episode_reward_mean": 12.84730648071924, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1053.5206702325404, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 47.807342742085595, "predator_policy": 1121.7845492185386}, "policy_reward_mean": {"prey_policy": -93.88440462846265, "predator_policy": 100.30805786882215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.34999999999993, 47.46999999999939, 67.50045899416472, 37.30999999999947, 82.7200000000013, 13.290807153316607, 29.550000000000537, 24.407544645587297, 24.210000000000484, 1.6176208313163323, 10.139999999999935, -178.12042391814057, 74.14955800212888, -19.86405845125471, 49.55160131592149, 42.29999999999949, 47.55183210443655, 13.289999999999928, 25.450000000000465, 62.27999999999935, -148.79071932054916, 77.66480544408158, 3.8799999999999604, 9.640602994142098, 3.9299999999999606, 75.63816843343294, 37.163764099504036, 48.27831567651826, 41.09478017847188, 11.679999999999923, 29.650000000000556, 3.919999999999961, -165.91139621792104, 3.7099999999999627, 8.369999999999951, 13.112078366675545, 3.989999999999959, -81.51291963758838, 3.9399999999999586, -61.33707552988685, 13.706789072655164, 20.993135937420817, 3.5399999999999667, 72.20000000000121, 36.319999999999396, 2.8699999999999815, 93.29950172808468, 290.6206236786923, 19.172324940857738, 7.2828420451045135, 8.359999999999928, 48.439999999999365, 20.997048970924613, 35.679982953909835, 3.7999999999999603, 6.539999999999925, -173.46153898831227, 3.9499999999999593, 19.590000000000515, 5.5699999999999275, -20.8463794395469, 3.969999999999959, 31.92287071306938, 3.8699999999999615, 52.809999999999704, 46.776344494629846, 12.219999999999931, 44.73302210665973, 73.3842978329946, 27.710000000000555, -14.717293001679112, 3.759999999999962, 37.419999999999455, 12.19118235033829, 13.409999999999929, 99.59430362302845, -266.3770482187065, 12.069999999999936, 45.841011370244395, 88.1798236851416, 61.96476717809482, 3.86999999999996, 18.205955677329463, 53.15999999999944, 76.17000000000014, 91.79000000000063, 7.969999999999937, 40.05915139230078, -367.4362838744529, -10.651618167257187, 3.7199999999999647, 80.7000000000008, 4.173213524280657, 9.108209051677289, 5.282453403851189, 19.79000000000056, 3.669999999999962, -43.57782470243353, -5.615566431336669, 3.7199999999999633], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-184.96115215702136, -13.328670287504911, -15.266467297807019, 39.84037436593202, -144.6786647963936, 33.85947127592397, 1.8513037021544398, -70.0107991380606, -14.557646958116544, -38.703294466866005, -36.569384972032815, -185.09061574402523, -61.01200944961096, 14.363969341395661, -26.272626289492223, -62.5161731567909, -2.340942113009703, -122.30057033853369, -21.42194668545835, -38.10640662776602, -312.3101409782597, -0.06889174026845621, -257.37938362537705, -340.40746655397953, -15.538475226963667, -305.76902673349923, -25.54034799579661, -31.842498421190477, 2.163900736106023, -73.77932200374288, 2.0000000000000013, -37.64750092049593, 14.346211106016245, -25.117320093394714, -186.37029384885207, -71.90971228028782, 2.0000000000000013, -99.21858440505302, 34.29779559247883, -5.581478251121899, -290.75913838253535, -518.521858614902, -1.9765769712274033, -261.01242297508145, -18.438487997437853, -1.9448580854964184, -152.27270826226612, -15.45422297910559, -19.03830759618168, -2.9679075320114547, 4.506698357595771, -16.539643972596622, -9.328736396663771, -50.19211382437913, -7.5980233721245565, -49.11911789051527, 23.78000000000028, -19.078094247716052, -63.14080557389721, -5.216674418128359, -34.966014779509614, 25.699226262934186, -9.236225662049948, -8.494251179235514, -246.79042905264882, -308.7138562427019, -4.217379547600421, -85.76125102508105, -133.80352899208233, -312.0630724400549, -181.62617721415978, -119.8001591065057, 0.004101783544406688, 2.0000000000000013, -207.40728003385254, -137.61665724632206, -0.19716844497997532, -11.876575473289607, -91.5488930821106, -84.87911084089956, -322.1985270001203, -84.14885268802607, 2.0000000000000013, -38.57922604931005, -49.98766841489035, -116.86228077876478, 2.0000000000000013, 47.807342742085595, -29.13732457107509, -30.99257619088699, -280.71830043479065, 2.0000000000000013, -152.57105595123244, -33.93748938086478, 26.59201823468352, -212.94705524165167, -10.901430511113507, -60.20475252297271, -22.02102317802892, -80.16837778264976, -32.10623762242873, -131.44177446767725, 13.879999999999962, 9.496952626549096, -72.88481755871514, -56.18298461563263, -85.64616182779427, -100.1148404196197, -53.2369758250451, -7.196025570714385, -25.172069004962534, -116.3066628340129, -235.97093413263119, -383.3707759679478, 2.0000000000000013, -8.604877526157525, 12.88999999999996, -64.74937206166832, -5.481599920105026, -87.36590754838475, -68.4979996356913, -42.21071584905848, -9.293683405559628, 2.0000000000000013, -199.22045198040112, -130.82137903233408, -6.78160697364399, -16.937872473213197, -283.93298240926987, -168.43858102132646, -197.10955282630067, -71.31942584864763, -1.246788479380215, -205.08973215920156, -95.86591345716629, 35.09303987492461, -110.3700781804205, -298.71903170596397, 2.0000000000000013, 16.387867275268796, -40.50899829509259, -73.0864606972052, -9.843505681588912, -47.12715335107017, -13.568615008890768, 0.48598464712908046, -68.93063801203292, -23.322725663481936, -95.8108247542587, -75.28474736220946, -177.27938017122707, -283.5806503760796, -383.8503466818158, -328.3572072953803, -378.4522029560265, 2.0000000000000013, 6.409477513820827, -69.8126061308062, -391.616816953678, -170.85050244243507, -166.8489752586073, 1.0677396326028188, -24.145958921685107, -2.9782952387758304, -14.652280195293498, 9.792800048568246, 3.2384565620694854, -25.213050767375137, -3.1689432450405697, -227.81738252714536, -192.8879895901205, -125.00632102837018, -108.26706775427259, -102.39188879177213, 2.0000000000000013, -91.78643972744499, -573.8847822220567, -538.9155494979253, -505.8868819495416, -137.34295000839796, -63.63032830066866, -15.86712144729723, -42.53646378343862, -3.5692250856477568, -25.377387882546508, -18.578112265888038, -129.0369519156567, -2.5298977037669355, 2.0000000000000013, -144.257058978198, -9.294926155062166, 14.342538298807467, -45.386569695811446, -44.53507469709487, -711.365128465094, -1053.5206702325404, -7.065566431336638, -127.57078004303105, -63.42312841009273, -8.77636957326645], "policy_predator_policy_reward": [171.14154566556252, 35.498276778962406, 17.20646729780719, 5.6896256340676725, 49.008876754964916, 129.31077575966668, 5.068696297845559, 100.40079913806132, 43.05575764535828, 92.925183779624, 114.08063530027678, 120.87017256909627, 62.89200944961058, 13.306030658604303, 69.84785886317556, 43.348485228694905, 107.99875623558093, 40.85275621596317, 43.25202013034318, 17.89395401419746, 184.1534544310635, 138.36557828746342, 4.901787853841103, 414.76463840737495, 291.6705761289807, 103.78648383360935, 0.0, 37.51878796573177, 25.000981995215575, 96.16604058834412, 13.159163389328047, 64.78833753116763, 5.594471729502735, 52.72846936231317, 41.03649631697799, 230.53350981216155, 16.2806230355314, 106.38796136952237, 3.3222044075208537, 30.241478251121862, 93.80659954399268, 566.6836781328957, 199.9783540879647, 140.6754513024228, 20.33848799743815, 3.9248580854963775, 70.06822794801336, 107.29930628749926, 20.988307596181986, 4.9479075320114125, 54.081508476825555, 33.589605571606896, 23.606700175316174, 73.07791414523103, 11.539337664301296, 93.45611927485703, 16.518413544222966, 19.874460881965923, 0.0, 80.03747999202577, 38.916788516575316, 0.0, 11.196225662049907, 10.454251179235472, 325.60600579392076, 63.98688328350885, 6.187379547600379, 87.50125102508194, 132.1212581919174, 322.11534324021835, 184.40421384653152, 130.1342008408092, 1.985898216455595, 0.0, 263.5110176425848, 0.0, 2.187168444979973, 13.826575473289566, 115.0909283931253, 0.0, 326.6914168828155, 93.3627518779863, 18.394695109766168, 39.17766687696378, 53.504891984579096, 116.88505720907656, 0.0, 22.39265725791416, 3.3331179494640004, 93.11678281249833, 281.58830043479037, 0.0, 155.64787274865188, 124.16017431152733, 245.92852197326403, 231.0471387123971, 31.312017423356384, 58.966490551586716, 62.36841391872235, 47.10382908706211, 35.936237622428365, 135.97177446767603, 0.0, 25.06304737345087, 76.98858360332784, 73.07626754194449, 157.54421577556147, 63.89676942576435, 55.076975825044734, 9.156025570714343, 133.87962222219664, 14.139109616779889, 12.495083385058757, 433.3850877272073, 0.0, 10.554877526157483, 71.44937206166918, 0.0, 60.35817230081446, 38.059335167676096, 10.450779003112318, 79.41155704209051, 11.263683405559586, 0.0, 260.2650290611409, 101.69967266466078, 12.657960908652939, 14.931518538204493, 332.70834405026545, 172.47321938032928, 137.05404746290938, 178.15127570666868, 209.48706640231265, 9.069454236267951, 11.505649244148309, 94.00024644475336, 191.84082219822503, 290.63258552115263, 9.322132724731238, 0.0, 95.65564405878763, 3.2225219318312903, 11.79350568158887, 48.93715335106981, 21.352984872131536, 29.149645489630128, 59.360162307313175, 45.08438371854132, 68.06247873712444, 116.44309337934541, 308.5775942188087, 251.8767399515231, 384.6432705632539, 61.18723519523671, 360.8854265453051, 27.63677641072039, 70.78777038853787, 38.45636959869353, 390.2708797189344, 260.3762633623176, 107.76430062763161, 119.981702176467, 22.38223329427126, 8.612020866189933, 5.953553996065877, 17.111881827988526, 37.37890416034848, 37.75569004495741, 6.580344206485349, 300.57598156570066, 194.16798959011942, 215.51632102837036, 73.35077624845773, 145.27818029758842, 80.80052027987425, 49.04507083987317, 714.9453313144724, 30.418716531057115, 478.0762882892798, 154.50192550140193, 65.45032830066933, 17.767121447297495, 112.44210808979312, 14.363580779292942, 0.0, 48.12871367271585, 29.68290391659358, 110.99215475450589, 1.742453403851262, 145.7970589781966, 14.742387856254616, 0.0, 23.93522456526239, 69.65641982764335, 1121.7845492185386, 599.5234247766615, 0.0, 129.02078004303127, 65.1831284100924, 10.736369573266408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5396168223151612, "mean_inference_ms": 1.6463000356144624, "mean_action_processing_ms": 0.24583810951944854, "mean_env_wait_ms": 0.1836872379399898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004588723182678223, "StateBufferConnector_ms": 0.0044820308685302734, "ViewRequirementAgentConnector_ms": 0.09196984767913818}, "num_episodes": 18, "episode_return_max": 290.6206236786923, "episode_return_min": -367.4362838744529, "episode_return_mean": 12.84730648071924, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.56923274957524, "num_env_steps_trained_throughput_per_sec": 382.56923274957524, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 10367.367, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10367.328, "sample_time_ms": 1286.025, "learn_time_ms": 9066.976, "learn_throughput": 441.161, "synch_weights_time_ms": 13.205}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "74486_00000", "date": "2024-08-16_15-08-51", "timestamp": 1723801131, "time_this_iter_s": 10.462820768356323, "time_total_s": 799.5539538860321, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39800bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 799.5539538860321, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 43.693333333333335, "ram_util_percent": 81.19333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.195428186087381, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.814435209168328, "policy_loss": -0.010159759345789632, "vf_loss": 3.8238776309149607, "vf_explained_var": -0.6105676709659515, "kl": 0.014346650839938128, "entropy": 1.0852391920392475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6841554188223742, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6274482352393016, "policy_loss": -0.006044328671747021, "vf_loss": 3.633397863655494, "vf_explained_var": 0.03426543830563782, "kl": 0.005050722146058744, "entropy": 0.4165887488574578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 290.6206236786923, "episode_reward_min": -367.4362838744529, "episode_reward_mean": 18.722018177403935, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1053.5206702325404, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.7082449333138, "predator_policy": 1121.7845492185386}, "policy_reward_mean": {"prey_policy": -90.54644532610128, "predator_policy": 99.90745441480314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.640602994142098, 3.9299999999999606, 75.63816843343294, 37.163764099504036, 48.27831567651826, 41.09478017847188, 11.679999999999923, 29.650000000000556, 3.919999999999961, -165.91139621792104, 3.7099999999999627, 8.369999999999951, 13.112078366675545, 3.989999999999959, -81.51291963758838, 3.9399999999999586, -61.33707552988685, 13.706789072655164, 20.993135937420817, 3.5399999999999667, 72.20000000000121, 36.319999999999396, 2.8699999999999815, 93.29950172808468, 290.6206236786923, 19.172324940857738, 7.2828420451045135, 8.359999999999928, 48.439999999999365, 20.997048970924613, 35.679982953909835, 3.7999999999999603, 6.539999999999925, -173.46153898831227, 3.9499999999999593, 19.590000000000515, 5.5699999999999275, -20.8463794395469, 3.969999999999959, 31.92287071306938, 3.8699999999999615, 52.809999999999704, 46.776344494629846, 12.219999999999931, 44.73302210665973, 73.3842978329946, 27.710000000000555, -14.717293001679112, 3.759999999999962, 37.419999999999455, 12.19118235033829, 13.409999999999929, 99.59430362302845, -266.3770482187065, 12.069999999999936, 45.841011370244395, 88.1798236851416, 61.96476717809482, 3.86999999999996, 18.205955677329463, 53.15999999999944, 76.17000000000014, 91.79000000000063, 7.969999999999937, 40.05915139230078, -367.4362838744529, -10.651618167257187, 3.7199999999999647, 80.7000000000008, 4.173213524280657, 9.108209051677289, 5.282453403851189, 19.79000000000056, 3.669999999999962, -43.57782470243353, -5.615566431336669, 3.7199999999999633, 22.67443011416433, 19.467098953435805, 3.0799999999999774, 73.75000000000082, -15.063610235231916, 58.94999999999954, -32.67052938292043, 125.00638517924003, 3.8899999999999597, 67.82000000000099, 3.7699999999999614, 151.79953281472757, 14.157253404588387, 44.58718324353996, 17.130000000000138, 10.28206625199035, 9.03927971825931, 169.30891692470405, 74.18012250469187, 4.199999999999954, 148.8583271172768, 0.2944660940672545, 8.869273766943904], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-152.27270826226612, -15.45422297910559, -19.03830759618168, -2.9679075320114547, 4.506698357595771, -16.539643972596622, -9.328736396663771, -50.19211382437913, -7.5980233721245565, -49.11911789051527, 23.78000000000028, -19.078094247716052, -63.14080557389721, -5.216674418128359, -34.966014779509614, 25.699226262934186, -9.236225662049948, -8.494251179235514, -246.79042905264882, -308.7138562427019, -4.217379547600421, -85.76125102508105, -133.80352899208233, -312.0630724400549, -181.62617721415978, -119.8001591065057, 0.004101783544406688, 2.0000000000000013, -207.40728003385254, -137.61665724632206, -0.19716844497997532, -11.876575473289607, -91.5488930821106, -84.87911084089956, -322.1985270001203, -84.14885268802607, 2.0000000000000013, -38.57922604931005, -49.98766841489035, -116.86228077876478, 2.0000000000000013, 47.807342742085595, -29.13732457107509, -30.99257619088699, -280.71830043479065, 2.0000000000000013, -152.57105595123244, -33.93748938086478, 26.59201823468352, -212.94705524165167, -10.901430511113507, -60.20475252297271, -22.02102317802892, -80.16837778264976, -32.10623762242873, -131.44177446767725, 13.879999999999962, 9.496952626549096, -72.88481755871514, -56.18298461563263, -85.64616182779427, -100.1148404196197, -53.2369758250451, -7.196025570714385, -25.172069004962534, -116.3066628340129, -235.97093413263119, -383.3707759679478, 2.0000000000000013, -8.604877526157525, 12.88999999999996, -64.74937206166832, -5.481599920105026, -87.36590754838475, -68.4979996356913, -42.21071584905848, -9.293683405559628, 2.0000000000000013, -199.22045198040112, -130.82137903233408, -6.78160697364399, -16.937872473213197, -283.93298240926987, -168.43858102132646, -197.10955282630067, -71.31942584864763, -1.246788479380215, -205.08973215920156, -95.86591345716629, 35.09303987492461, -110.3700781804205, -298.71903170596397, 2.0000000000000013, 16.387867275268796, -40.50899829509259, -73.0864606972052, -9.843505681588912, -47.12715335107017, -13.568615008890768, 0.48598464712908046, -68.93063801203292, -23.322725663481936, -95.8108247542587, -75.28474736220946, -177.27938017122707, -283.5806503760796, -383.8503466818158, -328.3572072953803, -378.4522029560265, 2.0000000000000013, 6.409477513820827, -69.8126061308062, -391.616816953678, -170.85050244243507, -166.8489752586073, 1.0677396326028188, -24.145958921685107, -2.9782952387758304, -14.652280195293498, 9.792800048568246, 3.2384565620694854, -25.213050767375137, -3.1689432450405697, -227.81738252714536, -192.8879895901205, -125.00632102837018, -108.26706775427259, -102.39188879177213, 2.0000000000000013, -91.78643972744499, -573.8847822220567, -538.9155494979253, -505.8868819495416, -137.34295000839796, -63.63032830066866, -15.86712144729723, -42.53646378343862, -3.5692250856477568, -25.377387882546508, -18.578112265888038, -129.0369519156567, -2.5298977037669355, 2.0000000000000013, -144.257058978198, -9.294926155062166, 14.342538298807467, -45.386569695811446, -44.53507469709487, -711.365128465094, -1053.5206702325404, -7.065566431336638, -127.57078004303105, -63.42312841009273, -8.77636957326645, -7.174532315647985, -80.78125728020107, 16.743415280607508, -120.48663288180124, 2.0000000000000013, -229.5852778572348, -23.66402822393831, -54.5052229649674, -72.37557871604147, -103.9205923099953, 0.056191182358571935, -55.851928151745206, -110.97704683988914, -64.8126593145738, -139.57706302044218, 50.7082449333138, -22.90118208048411, 2.0000000000000013, -41.26760688445933, -7.7530868868556375, -57.72261330060938, 2.0000000000000013, -0.2923280315850718, 2.0000000000000013, -60.13143337039323, 2.0000000000000013, -170.68488318710047, -462.835970531305, -7.913328969437734, -217.74390281725564, -115.79231693207127, -47.369285670314675, -35.318377616474756, -2.978012429249307, -200.42330886607738, 16.85000000000011, -137.3879384881804, -153.5955628820953, -32.1992630935749, -138.45586282108883, -44.0807017019889, -1.1273885073264318, -3.7631269338114537, -38.39532807401707, -15.450426493047116, -121.01906494217204], "policy_predator_policy_reward": [70.06822794801336, 107.29930628749926, 20.988307596181986, 4.9479075320114125, 54.081508476825555, 33.589605571606896, 23.606700175316174, 73.07791414523103, 11.539337664301296, 93.45611927485703, 16.518413544222966, 19.874460881965923, 0.0, 80.03747999202577, 38.916788516575316, 0.0, 11.196225662049907, 10.454251179235472, 325.60600579392076, 63.98688328350885, 6.187379547600379, 87.50125102508194, 132.1212581919174, 322.11534324021835, 184.40421384653152, 130.1342008408092, 1.985898216455595, 0.0, 263.5110176425848, 0.0, 2.187168444979973, 13.826575473289566, 115.0909283931253, 0.0, 326.6914168828155, 93.3627518779863, 18.394695109766168, 39.17766687696378, 53.504891984579096, 116.88505720907656, 0.0, 22.39265725791416, 3.3331179494640004, 93.11678281249833, 281.58830043479037, 0.0, 155.64787274865188, 124.16017431152733, 245.92852197326403, 231.0471387123971, 31.312017423356384, 58.966490551586716, 62.36841391872235, 47.10382908706211, 35.936237622428365, 135.97177446767603, 0.0, 25.06304737345087, 76.98858360332784, 73.07626754194449, 157.54421577556147, 63.89676942576435, 55.076975825044734, 9.156025570714343, 133.87962222219664, 14.139109616779889, 12.495083385058757, 433.3850877272073, 0.0, 10.554877526157483, 71.44937206166918, 0.0, 60.35817230081446, 38.059335167676096, 10.450779003112318, 79.41155704209051, 11.263683405559586, 0.0, 260.2650290611409, 101.69967266466078, 12.657960908652939, 14.931518538204493, 332.70834405026545, 172.47321938032928, 137.05404746290938, 178.15127570666868, 209.48706640231265, 9.069454236267951, 11.505649244148309, 94.00024644475336, 191.84082219822503, 290.63258552115263, 9.322132724731238, 0.0, 95.65564405878763, 3.2225219318312903, 11.79350568158887, 48.93715335106981, 21.352984872131536, 29.149645489630128, 59.360162307313175, 45.08438371854132, 68.06247873712444, 116.44309337934541, 308.5775942188087, 251.8767399515231, 384.6432705632539, 61.18723519523671, 360.8854265453051, 27.63677641072039, 70.78777038853787, 38.45636959869353, 390.2708797189344, 260.3762633623176, 107.76430062763161, 119.981702176467, 22.38223329427126, 8.612020866189933, 5.953553996065877, 17.111881827988526, 37.37890416034848, 37.75569004495741, 6.580344206485349, 300.57598156570066, 194.16798959011942, 215.51632102837036, 73.35077624845773, 145.27818029758842, 80.80052027987425, 49.04507083987317, 714.9453313144724, 30.418716531057115, 478.0762882892798, 154.50192550140193, 65.45032830066933, 17.767121447297495, 112.44210808979312, 14.363580779292942, 0.0, 48.12871367271585, 29.68290391659358, 110.99215475450589, 1.742453403851262, 145.7970589781966, 14.742387856254616, 0.0, 23.93522456526239, 69.65641982764335, 1121.7845492185386, 599.5234247766615, 0.0, 129.02078004303127, 65.1831284100924, 10.736369573266408, 39.98176601002818, 70.6484536999854, 0.0, 123.21031655462987, 0.0, 230.6652778572346, 64.18122642879376, 87.7380247601117, 21.504708193573812, 139.72785259723207, 84.84944086057796, 29.8962961088085, 140.7900065231363, 2.329170248407966, 181.46783875292394, 32.407364513442566, 24.791182080484404, 0.0, 60.94390384256598, 55.896789928748795, 7.163005111253288, 52.32960818935576, 72.76985655630776, 77.32200429000477, 68.96143337039287, 3.327253404588469, 566.5900251867791, 111.51801177516514, 47.69396606853235, 195.09326571816, 119.546281086474, 53.897387767902615, 25.289493121961073, 22.04617664202195, 207.97377687553745, 144.9084489152445, 244.38222292291456, 120.7814009520504, 34.07926309357457, 140.77586282108857, 154.37253051501645, 39.6938868115754, 40.487188433490175, 1.9657326684053067, 107.29586970304486, 38.0428954991189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5397722759549639, "mean_inference_ms": 1.6475331443427956, "mean_action_processing_ms": 0.24560229101576767, "mean_env_wait_ms": 0.18359849048449065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046645402908325195, "StateBufferConnector_ms": 0.004544973373413086, "ViewRequirementAgentConnector_ms": 0.09564173221588135}, "num_episodes": 23, "episode_return_max": 290.6206236786923, "episode_return_min": -367.4362838744529, "episode_return_mean": 18.722018177403935, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.61402820871695, "num_env_steps_trained_throughput_per_sec": 370.61402820871695, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 10413.951, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10413.912, "sample_time_ms": 1307.191, "learn_time_ms": 9092.568, "learn_throughput": 439.92, "synch_weights_time_ms": 13.003}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "74486_00000", "date": "2024-08-16_15-09-02", "timestamp": 1723801142, "time_this_iter_s": 10.798166036605835, "time_total_s": 810.3521199226379, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3973a6ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 810.3521199226379, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 44.18666666666668, "ram_util_percent": 81.12666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8195120385084202, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.98030477074719, "policy_loss": -0.010688628148405798, "vf_loss": 3.9905044665412297, "vf_explained_var": -0.2064249250623915, "kl": 0.009778730470034927, "entropy": 1.0403022890999203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9903014285539193, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4046011161551903, "policy_loss": -0.0060518559583379004, "vf_loss": 3.4105284063904375, "vf_explained_var": 0.04526210925566456, "kl": 0.006643315095248384, "entropy": 0.48878923347071995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 390.57876323489916, "episode_reward_min": -367.4362838744529, "episode_reward_mean": 25.3909328996059, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1053.5206702325404, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 69.4956270404173, "predator_policy": 1121.7845492185386}, "policy_reward_mean": {"prey_policy": -95.64662163305948, "predator_policy": 108.34208808286233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.993135937420817, 3.5399999999999667, 72.20000000000121, 36.319999999999396, 2.8699999999999815, 93.29950172808468, 290.6206236786923, 19.172324940857738, 7.2828420451045135, 8.359999999999928, 48.439999999999365, 20.997048970924613, 35.679982953909835, 3.7999999999999603, 6.539999999999925, -173.46153898831227, 3.9499999999999593, 19.590000000000515, 5.5699999999999275, -20.8463794395469, 3.969999999999959, 31.92287071306938, 3.8699999999999615, 52.809999999999704, 46.776344494629846, 12.219999999999931, 44.73302210665973, 73.3842978329946, 27.710000000000555, -14.717293001679112, 3.759999999999962, 37.419999999999455, 12.19118235033829, 13.409999999999929, 99.59430362302845, -266.3770482187065, 12.069999999999936, 45.841011370244395, 88.1798236851416, 61.96476717809482, 3.86999999999996, 18.205955677329463, 53.15999999999944, 76.17000000000014, 91.79000000000063, 7.969999999999937, 40.05915139230078, -367.4362838744529, -10.651618167257187, 3.7199999999999647, 80.7000000000008, 4.173213524280657, 9.108209051677289, 5.282453403851189, 19.79000000000056, 3.669999999999962, -43.57782470243353, -5.615566431336669, 3.7199999999999633, 22.67443011416433, 19.467098953435805, 3.0799999999999774, 73.75000000000082, -15.063610235231916, 58.94999999999954, -32.67052938292043, 125.00638517924003, 3.8899999999999597, 67.82000000000099, 3.7699999999999614, 151.79953281472757, 14.157253404588387, 44.58718324353996, 17.130000000000138, 10.28206625199035, 9.03927971825931, 169.30891692470405, 74.18012250469187, 4.199999999999954, 148.8583271172768, 0.2944660940672545, 8.869273766943904, 57.03773887941871, 20.810000000000418, 17.390000000000175, 17.10000000000014, -4.3962108426889674, -55.51924673090011, 3.9299999999999593, 62.0119744037456, 183.82045816108007, 32.49000000000034, 3.249999999999974, 6.959999999999937, 16.239999999999974, -184.7317903530103, 390.57876323489916, 3.9299999999999593, 91.55289290365566, 3.4999999999999654], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -38.57922604931005, -49.98766841489035, -116.86228077876478, 2.0000000000000013, 47.807342742085595, -29.13732457107509, -30.99257619088699, -280.71830043479065, 2.0000000000000013, -152.57105595123244, -33.93748938086478, 26.59201823468352, -212.94705524165167, -10.901430511113507, -60.20475252297271, -22.02102317802892, -80.16837778264976, -32.10623762242873, -131.44177446767725, 13.879999999999962, 9.496952626549096, -72.88481755871514, -56.18298461563263, -85.64616182779427, -100.1148404196197, -53.2369758250451, -7.196025570714385, -25.172069004962534, -116.3066628340129, -235.97093413263119, -383.3707759679478, 2.0000000000000013, -8.604877526157525, 12.88999999999996, -64.74937206166832, -5.481599920105026, -87.36590754838475, -68.4979996356913, -42.21071584905848, -9.293683405559628, 2.0000000000000013, -199.22045198040112, -130.82137903233408, -6.78160697364399, -16.937872473213197, -283.93298240926987, -168.43858102132646, -197.10955282630067, -71.31942584864763, -1.246788479380215, -205.08973215920156, -95.86591345716629, 35.09303987492461, -110.3700781804205, -298.71903170596397, 2.0000000000000013, 16.387867275268796, -40.50899829509259, -73.0864606972052, -9.843505681588912, -47.12715335107017, -13.568615008890768, 0.48598464712908046, -68.93063801203292, -23.322725663481936, -95.8108247542587, -75.28474736220946, -177.27938017122707, -283.5806503760796, -383.8503466818158, -328.3572072953803, -378.4522029560265, 2.0000000000000013, 6.409477513820827, -69.8126061308062, -391.616816953678, -170.85050244243507, -166.8489752586073, 1.0677396326028188, -24.145958921685107, -2.9782952387758304, -14.652280195293498, 9.792800048568246, 3.2384565620694854, -25.213050767375137, -3.1689432450405697, -227.81738252714536, -192.8879895901205, -125.00632102837018, -108.26706775427259, -102.39188879177213, 2.0000000000000013, -91.78643972744499, -573.8847822220567, -538.9155494979253, -505.8868819495416, -137.34295000839796, -63.63032830066866, -15.86712144729723, -42.53646378343862, -3.5692250856477568, -25.377387882546508, -18.578112265888038, -129.0369519156567, -2.5298977037669355, 2.0000000000000013, -144.257058978198, -9.294926155062166, 14.342538298807467, -45.386569695811446, -44.53507469709487, -711.365128465094, -1053.5206702325404, -7.065566431336638, -127.57078004303105, -63.42312841009273, -8.77636957326645, -7.174532315647985, -80.78125728020107, 16.743415280607508, -120.48663288180124, 2.0000000000000013, -229.5852778572348, -23.66402822393831, -54.5052229649674, -72.37557871604147, -103.9205923099953, 0.056191182358571935, -55.851928151745206, -110.97704683988914, -64.8126593145738, -139.57706302044218, 50.7082449333138, -22.90118208048411, 2.0000000000000013, -41.26760688445933, -7.7530868868556375, -57.72261330060938, 2.0000000000000013, -0.2923280315850718, 2.0000000000000013, -60.13143337039323, 2.0000000000000013, -170.68488318710047, -462.835970531305, -7.913328969437734, -217.74390281725564, -115.79231693207127, -47.369285670314675, -35.318377616474756, -2.978012429249307, -200.42330886607738, 16.85000000000011, -137.3879384881804, -153.5955628820953, -32.1992630935749, -138.45586282108883, -44.0807017019889, -1.1273885073264318, -3.7631269338114537, -38.39532807401707, -15.450426493047116, -121.01906494217204, -217.74282345618616, 4.055452773325263, -132.00686815514644, -88.41298411294744, -121.36229697584973, -18.61789047394262, -150.77680228752462, -81.58843888336183, -7.56200376863565, -133.08964281243638, -236.17166929514548, -130.2663291680269, 2.0000000000000013, -16.4021211687344, -104.85919817927953, -163.8761176071887, 56.912486635110675, -65.37352879526863, -10.070783726666383, -62.00654142419802, -23.475773589126916, -295.11520293477963, -157.24980615513013, -149.93393363673266, 3.2989349629572735, -194.46081347024995, -317.1802518177058, -318.38677133562516, 69.4956270404173, -346.66725830168883, -1.7202720107066058, -12.258874426059831, -87.69132617235627, -122.49088088235274, -116.55497248481997, -11.727325008319468], "policy_predator_policy_reward": [18.394695109766168, 39.17766687696378, 53.504891984579096, 116.88505720907656, 0.0, 22.39265725791416, 3.3331179494640004, 93.11678281249833, 281.58830043479037, 0.0, 155.64787274865188, 124.16017431152733, 245.92852197326403, 231.0471387123971, 31.312017423356384, 58.966490551586716, 62.36841391872235, 47.10382908706211, 35.936237622428365, 135.97177446767603, 0.0, 25.06304737345087, 76.98858360332784, 73.07626754194449, 157.54421577556147, 63.89676942576435, 55.076975825044734, 9.156025570714343, 133.87962222219664, 14.139109616779889, 12.495083385058757, 433.3850877272073, 0.0, 10.554877526157483, 71.44937206166918, 0.0, 60.35817230081446, 38.059335167676096, 10.450779003112318, 79.41155704209051, 11.263683405559586, 0.0, 260.2650290611409, 101.69967266466078, 12.657960908652939, 14.931518538204493, 332.70834405026545, 172.47321938032928, 137.05404746290938, 178.15127570666868, 209.48706640231265, 9.069454236267951, 11.505649244148309, 94.00024644475336, 191.84082219822503, 290.63258552115263, 9.322132724731238, 0.0, 95.65564405878763, 3.2225219318312903, 11.79350568158887, 48.93715335106981, 21.352984872131536, 29.149645489630128, 59.360162307313175, 45.08438371854132, 68.06247873712444, 116.44309337934541, 308.5775942188087, 251.8767399515231, 384.6432705632539, 61.18723519523671, 360.8854265453051, 27.63677641072039, 70.78777038853787, 38.45636959869353, 390.2708797189344, 260.3762633623176, 107.76430062763161, 119.981702176467, 22.38223329427126, 8.612020866189933, 5.953553996065877, 17.111881827988526, 37.37890416034848, 37.75569004495741, 6.580344206485349, 300.57598156570066, 194.16798959011942, 215.51632102837036, 73.35077624845773, 145.27818029758842, 80.80052027987425, 49.04507083987317, 714.9453313144724, 30.418716531057115, 478.0762882892798, 154.50192550140193, 65.45032830066933, 17.767121447297495, 112.44210808979312, 14.363580779292942, 0.0, 48.12871367271585, 29.68290391659358, 110.99215475450589, 1.742453403851262, 145.7970589781966, 14.742387856254616, 0.0, 23.93522456526239, 69.65641982764335, 1121.7845492185386, 599.5234247766615, 0.0, 129.02078004303127, 65.1831284100924, 10.736369573266408, 39.98176601002818, 70.6484536999854, 0.0, 123.21031655462987, 0.0, 230.6652778572346, 64.18122642879376, 87.7380247601117, 21.504708193573812, 139.72785259723207, 84.84944086057796, 29.8962961088085, 140.7900065231363, 2.329170248407966, 181.46783875292394, 32.407364513442566, 24.791182080484404, 0.0, 60.94390384256598, 55.896789928748795, 7.163005111253288, 52.32960818935576, 72.76985655630776, 77.32200429000477, 68.96143337039287, 3.327253404588469, 566.5900251867791, 111.51801177516514, 47.69396606853235, 195.09326571816, 119.546281086474, 53.897387767902615, 25.289493121961073, 22.04617664202195, 207.97377687553745, 144.9084489152445, 244.38222292291456, 120.7814009520504, 34.07926309357457, 140.77586282108857, 154.37253051501645, 39.6938868115754, 40.487188433490175, 1.9657326684053067, 107.29586970304486, 38.0428954991189, 102.0843488878966, 168.64076067438313, 146.34675704586525, 94.8830952222282, 57.40522183964989, 99.96496561014351, 152.35680228752332, 97.10843888336261, 1.6357929259467119, 134.61964281243516, 238.63526217964596, 72.28348955262655, 0.0, 18.332121168734698, 183.60712045212637, 147.1401697380874, 94.55683395410874, 97.72466636713138, 40.67078372666635, 63.89654142419764, 25.35577358912721, 296.4852029347784, 69.86842781407991, 244.27531197778092, 11.5310650370427, 195.87081347024866, 407.1908603844136, 43.644372415906986, 307.078810544506, 360.6715839516654, 3.7002720107065716, 14.20887442605979, 122.57568886106031, 179.15941109730417, 118.09497248482076, 13.687325008319426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5397349570423623, "mean_inference_ms": 1.648283588897305, "mean_action_processing_ms": 0.24540969750854444, "mean_env_wait_ms": 0.18349447391579232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00456082820892334, "StateBufferConnector_ms": 0.002960801124572754, "ViewRequirementAgentConnector_ms": 0.09207069873809814}, "num_episodes": 18, "episode_return_max": 390.57876323489916, "episode_return_min": -367.4362838744529, "episode_return_mean": 25.3909328996059, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.8837965613484, "num_env_steps_trained_throughput_per_sec": 358.8837965613484, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 10538.301, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10538.261, "sample_time_ms": 1303.622, "learn_time_ms": 9220.248, "learn_throughput": 433.828, "synch_weights_time_ms": 13.207}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "74486_00000", "date": "2024-08-16_15-09-13", "timestamp": 1723801153, "time_this_iter_s": 11.212350845336914, "time_total_s": 821.5644707679749, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39738f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 821.5644707679749, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 42.33125, "ram_util_percent": 80.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.034177042788299, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6341749000170873, "policy_loss": -0.008048876495194182, "vf_loss": 3.6417349604071765, "vf_explained_var": -0.054891919522058394, "kl": 0.009776200056135947, "entropy": 1.0549921390556154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.120572881692301, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.692026517063222, "policy_loss": -0.004660312442118844, "vf_loss": 2.69651281890415, "vf_explained_var": 0.00990543633541733, "kl": 0.009280624155115965, "entropy": 0.48576989159697576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 390.57876323489916, "episode_reward_min": -367.4362838744529, "episode_reward_mean": 26.190404553897665, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1053.5206702325404, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 76.61719208820193, "predator_policy": 1121.7845492185386}, "policy_reward_mean": {"prey_policy": -97.38328314063706, "predator_policy": 110.47848541758583}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8699999999999615, 52.809999999999704, 46.776344494629846, 12.219999999999931, 44.73302210665973, 73.3842978329946, 27.710000000000555, -14.717293001679112, 3.759999999999962, 37.419999999999455, 12.19118235033829, 13.409999999999929, 99.59430362302845, -266.3770482187065, 12.069999999999936, 45.841011370244395, 88.1798236851416, 61.96476717809482, 3.86999999999996, 18.205955677329463, 53.15999999999944, 76.17000000000014, 91.79000000000063, 7.969999999999937, 40.05915139230078, -367.4362838744529, -10.651618167257187, 3.7199999999999647, 80.7000000000008, 4.173213524280657, 9.108209051677289, 5.282453403851189, 19.79000000000056, 3.669999999999962, -43.57782470243353, -5.615566431336669, 3.7199999999999633, 22.67443011416433, 19.467098953435805, 3.0799999999999774, 73.75000000000082, -15.063610235231916, 58.94999999999954, -32.67052938292043, 125.00638517924003, 3.8899999999999597, 67.82000000000099, 3.7699999999999614, 151.79953281472757, 14.157253404588387, 44.58718324353996, 17.130000000000138, 10.28206625199035, 9.03927971825931, 169.30891692470405, 74.18012250469187, 4.199999999999954, 148.8583271172768, 0.2944660940672545, 8.869273766943904, 57.03773887941871, 20.810000000000418, 17.390000000000175, 17.10000000000014, -4.3962108426889674, -55.51924673090011, 3.9299999999999593, 62.0119744037456, 183.82045816108007, 32.49000000000034, 3.249999999999974, 6.959999999999937, 16.239999999999974, -184.7317903530103, 390.57876323489916, 3.9299999999999593, 91.55289290365566, 3.4999999999999654, 8.186383451570213, -225.8111431419444, 5.699999999999921, 129.3735153462528, 50.88999999999953, 57.27999999999988, -56.77542300800535, 6.527791743328387, 30.770000000000405, 93.35767982353312, 105.86000000000021, 6.349912817599886, 12.139999999999935, 186.77999999999986, -27.897210301335164, 14.153013649368106, -0.5993680517206064, 81.44000000000035, 16.780000000000058, 7.839999999999918, 105.53000000000071, 12.882425640732952], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.78160697364399, -16.937872473213197, -283.93298240926987, -168.43858102132646, -197.10955282630067, -71.31942584864763, -1.246788479380215, -205.08973215920156, -95.86591345716629, 35.09303987492461, -110.3700781804205, -298.71903170596397, 2.0000000000000013, 16.387867275268796, -40.50899829509259, -73.0864606972052, -9.843505681588912, -47.12715335107017, -13.568615008890768, 0.48598464712908046, -68.93063801203292, -23.322725663481936, -95.8108247542587, -75.28474736220946, -177.27938017122707, -283.5806503760796, -383.8503466818158, -328.3572072953803, -378.4522029560265, 2.0000000000000013, 6.409477513820827, -69.8126061308062, -391.616816953678, -170.85050244243507, -166.8489752586073, 1.0677396326028188, -24.145958921685107, -2.9782952387758304, -14.652280195293498, 9.792800048568246, 3.2384565620694854, -25.213050767375137, -3.1689432450405697, -227.81738252714536, -192.8879895901205, -125.00632102837018, -108.26706775427259, -102.39188879177213, 2.0000000000000013, -91.78643972744499, -573.8847822220567, -538.9155494979253, -505.8868819495416, -137.34295000839796, -63.63032830066866, -15.86712144729723, -42.53646378343862, -3.5692250856477568, -25.377387882546508, -18.578112265888038, -129.0369519156567, -2.5298977037669355, 2.0000000000000013, -144.257058978198, -9.294926155062166, 14.342538298807467, -45.386569695811446, -44.53507469709487, -711.365128465094, -1053.5206702325404, -7.065566431336638, -127.57078004303105, -63.42312841009273, -8.77636957326645, -7.174532315647985, -80.78125728020107, 16.743415280607508, -120.48663288180124, 2.0000000000000013, -229.5852778572348, -23.66402822393831, -54.5052229649674, -72.37557871604147, -103.9205923099953, 0.056191182358571935, -55.851928151745206, -110.97704683988914, -64.8126593145738, -139.57706302044218, 50.7082449333138, -22.90118208048411, 2.0000000000000013, -41.26760688445933, -7.7530868868556375, -57.72261330060938, 2.0000000000000013, -0.2923280315850718, 2.0000000000000013, -60.13143337039323, 2.0000000000000013, -170.68488318710047, -462.835970531305, -7.913328969437734, -217.74390281725564, -115.79231693207127, -47.369285670314675, -35.318377616474756, -2.978012429249307, -200.42330886607738, 16.85000000000011, -137.3879384881804, -153.5955628820953, -32.1992630935749, -138.45586282108883, -44.0807017019889, -1.1273885073264318, -3.7631269338114537, -38.39532807401707, -15.450426493047116, -121.01906494217204, -217.74282345618616, 4.055452773325263, -132.00686815514644, -88.41298411294744, -121.36229697584973, -18.61789047394262, -150.77680228752462, -81.58843888336183, -7.56200376863565, -133.08964281243638, -236.17166929514548, -130.2663291680269, 2.0000000000000013, -16.4021211687344, -104.85919817927953, -163.8761176071887, 56.912486635110675, -65.37352879526863, -10.070783726666383, -62.00654142419802, -23.475773589126916, -295.11520293477963, -157.24980615513013, -149.93393363673266, 3.2989349629572735, -194.46081347024995, -317.1802518177058, -318.38677133562516, 69.4956270404173, -346.66725830168883, -1.7202720107066058, -12.258874426059831, -87.69132617235627, -122.49088088235274, -116.55497248481997, -11.727325008319468, -29.046987675235236, -2.8675112892399737, -413.4298747264314, -351.48021627347083, -128.7025369631889, -0.008036024896454068, 66.9379216481026, -139.73206815980953, -44.391094933248, -60.14450434622846, -9.501361908233688, 0.7118270931209305, -87.5693770246323, -110.85272081259438, -89.0958527180288, -41.77891813113689, -80.70580411494284, -278.5937745330732, 33.74000992550919, 33.913204346975505, 76.61719208820193, -17.81027443743915, -7.197994190688297, -17.03016904410322, -160.33967845182727, -44.28785518368408, 10.70580852557855, 72.72929095148251, -145.89898582895202, -393.7741853327625, -95.50641731322321, 0.31013377303465645, -42.73984255029559, -121.20099044708819, -420.94316780359634, -69.01080668604364, -17.245690329796112, 2.0000000000000013, -32.56918007322073, 2.0000000000000013, -7.020950862858488, -7.8395359127017485, 2.0000000000000013, -94.91981999630798], "policy_predator_policy_reward": [12.657960908652939, 14.931518538204493, 332.70834405026545, 172.47321938032928, 137.05404746290938, 178.15127570666868, 209.48706640231265, 9.069454236267951, 11.505649244148309, 94.00024644475336, 191.84082219822503, 290.63258552115263, 9.322132724731238, 0.0, 95.65564405878763, 3.2225219318312903, 11.79350568158887, 48.93715335106981, 21.352984872131536, 29.149645489630128, 59.360162307313175, 45.08438371854132, 68.06247873712444, 116.44309337934541, 308.5775942188087, 251.8767399515231, 384.6432705632539, 61.18723519523671, 360.8854265453051, 27.63677641072039, 70.78777038853787, 38.45636959869353, 390.2708797189344, 260.3762633623176, 107.76430062763161, 119.981702176467, 22.38223329427126, 8.612020866189933, 5.953553996065877, 17.111881827988526, 37.37890416034848, 37.75569004495741, 6.580344206485349, 300.57598156570066, 194.16798959011942, 215.51632102837036, 73.35077624845773, 145.27818029758842, 80.80052027987425, 49.04507083987317, 714.9453313144724, 30.418716531057115, 478.0762882892798, 154.50192550140193, 65.45032830066933, 17.767121447297495, 112.44210808979312, 14.363580779292942, 0.0, 48.12871367271585, 29.68290391659358, 110.99215475450589, 1.742453403851262, 145.7970589781966, 14.742387856254616, 0.0, 23.93522456526239, 69.65641982764335, 1121.7845492185386, 599.5234247766615, 0.0, 129.02078004303127, 65.1831284100924, 10.736369573266408, 39.98176601002818, 70.6484536999854, 0.0, 123.21031655462987, 0.0, 230.6652778572346, 64.18122642879376, 87.7380247601117, 21.504708193573812, 139.72785259723207, 84.84944086057796, 29.8962961088085, 140.7900065231363, 2.329170248407966, 181.46783875292394, 32.407364513442566, 24.791182080484404, 0.0, 60.94390384256598, 55.896789928748795, 7.163005111253288, 52.32960818935576, 72.76985655630776, 77.32200429000477, 68.96143337039287, 3.327253404588469, 566.5900251867791, 111.51801177516514, 47.69396606853235, 195.09326571816, 119.546281086474, 53.897387767902615, 25.289493121961073, 22.04617664202195, 207.97377687553745, 144.9084489152445, 244.38222292291456, 120.7814009520504, 34.07926309357457, 140.77586282108857, 154.37253051501645, 39.6938868115754, 40.487188433490175, 1.9657326684053067, 107.29586970304486, 38.0428954991189, 102.0843488878966, 168.64076067438313, 146.34675704586525, 94.8830952222282, 57.40522183964989, 99.96496561014351, 152.35680228752332, 97.10843888336261, 1.6357929259467119, 134.61964281243516, 238.63526217964596, 72.28348955262655, 0.0, 18.332121168734698, 183.60712045212637, 147.1401697380874, 94.55683395410874, 97.72466636713138, 40.67078372666635, 63.89654142419764, 25.35577358912721, 296.4852029347784, 69.86842781407991, 244.27531197778092, 11.5310650370427, 195.87081347024866, 407.1908603844136, 43.644372415906986, 307.078810544506, 360.6715839516654, 3.7002720107065716, 14.20887442605979, 122.57568886106031, 179.15941109730417, 118.09497248482076, 13.687325008319426, 9.615526932349702, 30.485355483696047, 168.71289898752832, 370.3860488704298, 0.0, 134.4105729880838, 51.0890956961587, 151.0785661618009, 69.84042644736276, 85.58517283211322, 11.461361908233647, 54.60817290687916, 141.64667482922354, 0.0, 106.987312741078, 30.415249851416732, 118.27359782645311, 271.7959808215628, 11.282734465313021, 14.421731085733374, 27.29280791179816, 19.760274437439456, 12.404692425505464, 18.17338362688628, 161.80967845182593, 54.95785518368375, 73.18419147442154, 30.16070904851769, 433.18459897492664, 78.59136188545284, 34.96661761556033, 74.38267957399728, 128.74364102616582, 34.59782391949774, 339.80621878038636, 231.5877557092544, 32.02569032979639, 0.0, 0.0, 38.409180073220355, 8.970950862858446, 111.41953591270178, 7.342425640733028, 98.45981999630877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5398254495521431, "mean_inference_ms": 1.6504302573063458, "mean_action_processing_ms": 0.24526698981601147, "mean_env_wait_ms": 0.18340180464400305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00533139705657959, "StateBufferConnector_ms": 0.0031005144119262695, "ViewRequirementAgentConnector_ms": 0.1005089282989502}, "num_episodes": 22, "episode_return_max": 390.57876323489916, "episode_return_min": -367.4362838744529, "episode_return_mean": 26.190404553897665, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.1540357918, "num_env_steps_trained_throughput_per_sec": 366.1540357918, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 10617.934, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10617.894, "sample_time_ms": 1359.587, "learn_time_ms": 9243.68, "learn_throughput": 432.728, "synch_weights_time_ms": 13.531}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "74486_00000", "date": "2024-08-16_15-09-24", "timestamp": 1723801164, "time_this_iter_s": 10.92914628982544, "time_total_s": 832.4936170578003, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39738f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 832.4936170578003, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 44.98000000000001, "ram_util_percent": 81.15333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.071947344238796, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.317244367624717, "policy_loss": -0.012609840975335193, "vf_loss": 4.328833277263339, "vf_explained_var": -0.14610264916268606, "kl": 0.020418632787123345, "entropy": 1.0566539428221486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3425865467894014, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6620708074519244, "policy_loss": -0.00529982000182841, "vf_loss": 3.667230998397504, "vf_explained_var": 0.0017150817094025788, "kl": 0.007447434686749648, "entropy": 0.5228163631189437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 390.57876323489916, "episode_reward_min": -367.4362838744529, "episode_reward_mean": 28.576126619552994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1053.5206702325404, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 132.58099180885392, "predator_policy": 1121.7845492185386}, "policy_reward_mean": {"prey_policy": -95.21649466163606, "predator_policy": 109.50455797141247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.86999999999996, 18.205955677329463, 53.15999999999944, 76.17000000000014, 91.79000000000063, 7.969999999999937, 40.05915139230078, -367.4362838744529, -10.651618167257187, 3.7199999999999647, 80.7000000000008, 4.173213524280657, 9.108209051677289, 5.282453403851189, 19.79000000000056, 3.669999999999962, -43.57782470243353, -5.615566431336669, 3.7199999999999633, 22.67443011416433, 19.467098953435805, 3.0799999999999774, 73.75000000000082, -15.063610235231916, 58.94999999999954, -32.67052938292043, 125.00638517924003, 3.8899999999999597, 67.82000000000099, 3.7699999999999614, 151.79953281472757, 14.157253404588387, 44.58718324353996, 17.130000000000138, 10.28206625199035, 9.03927971825931, 169.30891692470405, 74.18012250469187, 4.199999999999954, 148.8583271172768, 0.2944660940672545, 8.869273766943904, 57.03773887941871, 20.810000000000418, 17.390000000000175, 17.10000000000014, -4.3962108426889674, -55.51924673090011, 3.9299999999999593, 62.0119744037456, 183.82045816108007, 32.49000000000034, 3.249999999999974, 6.959999999999937, 16.239999999999974, -184.7317903530103, 390.57876323489916, 3.9299999999999593, 91.55289290365566, 3.4999999999999654, 8.186383451570213, -225.8111431419444, 5.699999999999921, 129.3735153462528, 50.88999999999953, 57.27999999999988, -56.77542300800535, 6.527791743328387, 30.770000000000405, 93.35767982353312, 105.86000000000021, 6.349912817599886, 12.139999999999935, 186.77999999999986, -27.897210301335164, 14.153013649368106, -0.5993680517206064, 81.44000000000035, 16.780000000000058, 7.839999999999918, 105.53000000000071, 12.882425640732952, 157.56452537990532, 0.16124092863486833, 102.64000000000017, 2.0604889001823468, 14.799999999999919, 107.97000000000034, 9.69443842213199, 198.90451419920905, 33.33000000000012, 99.57000000000018, 21.980000000000352, -221.15097591945104, 95.78000000000027, 70.09961439089335, 7.653131687104564, 24.536989844947943, -130.90877810153378, -1.2725717457472203], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.145958921685107, -2.9782952387758304, -14.652280195293498, 9.792800048568246, 3.2384565620694854, -25.213050767375137, -3.1689432450405697, -227.81738252714536, -192.8879895901205, -125.00632102837018, -108.26706775427259, -102.39188879177213, 2.0000000000000013, -91.78643972744499, -573.8847822220567, -538.9155494979253, -505.8868819495416, -137.34295000839796, -63.63032830066866, -15.86712144729723, -42.53646378343862, -3.5692250856477568, -25.377387882546508, -18.578112265888038, -129.0369519156567, -2.5298977037669355, 2.0000000000000013, -144.257058978198, -9.294926155062166, 14.342538298807467, -45.386569695811446, -44.53507469709487, -711.365128465094, -1053.5206702325404, -7.065566431336638, -127.57078004303105, -63.42312841009273, -8.77636957326645, -7.174532315647985, -80.78125728020107, 16.743415280607508, -120.48663288180124, 2.0000000000000013, -229.5852778572348, -23.66402822393831, -54.5052229649674, -72.37557871604147, -103.9205923099953, 0.056191182358571935, -55.851928151745206, -110.97704683988914, -64.8126593145738, -139.57706302044218, 50.7082449333138, -22.90118208048411, 2.0000000000000013, -41.26760688445933, -7.7530868868556375, -57.72261330060938, 2.0000000000000013, -0.2923280315850718, 2.0000000000000013, -60.13143337039323, 2.0000000000000013, -170.68488318710047, -462.835970531305, -7.913328969437734, -217.74390281725564, -115.79231693207127, -47.369285670314675, -35.318377616474756, -2.978012429249307, -200.42330886607738, 16.85000000000011, -137.3879384881804, -153.5955628820953, -32.1992630935749, -138.45586282108883, -44.0807017019889, -1.1273885073264318, -3.7631269338114537, -38.39532807401707, -15.450426493047116, -121.01906494217204, -217.74282345618616, 4.055452773325263, -132.00686815514644, -88.41298411294744, -121.36229697584973, -18.61789047394262, -150.77680228752462, -81.58843888336183, -7.56200376863565, -133.08964281243638, -236.17166929514548, -130.2663291680269, 2.0000000000000013, -16.4021211687344, -104.85919817927953, -163.8761176071887, 56.912486635110675, -65.37352879526863, -10.070783726666383, -62.00654142419802, -23.475773589126916, -295.11520293477963, -157.24980615513013, -149.93393363673266, 3.2989349629572735, -194.46081347024995, -317.1802518177058, -318.38677133562516, 69.4956270404173, -346.66725830168883, -1.7202720107066058, -12.258874426059831, -87.69132617235627, -122.49088088235274, -116.55497248481997, -11.727325008319468, -29.046987675235236, -2.8675112892399737, -413.4298747264314, -351.48021627347083, -128.7025369631889, -0.008036024896454068, 66.9379216481026, -139.73206815980953, -44.391094933248, -60.14450434622846, -9.501361908233688, 0.7118270931209305, -87.5693770246323, -110.85272081259438, -89.0958527180288, -41.77891813113689, -80.70580411494284, -278.5937745330732, 33.74000992550919, 33.913204346975505, 76.61719208820193, -17.81027443743915, -7.197994190688297, -17.03016904410322, -160.33967845182727, -44.28785518368408, 10.70580852557855, 72.72929095148251, -145.89898582895202, -393.7741853327625, -95.50641731322321, 0.31013377303465645, -42.73984255029559, -121.20099044708819, -420.94316780359634, -69.01080668604364, -17.245690329796112, 2.0000000000000013, -32.56918007322073, 2.0000000000000013, -7.020950862858488, -7.8395359127017485, 2.0000000000000013, -94.91981999630798, 0.11984993520654248, -339.69291402011754, -21.82911942774557, -3.7433610175703658, 33.63911120056379, -49.10879947362264, -0.020738976255146764, -6.475638700175374, 12.88999999999996, -15.585838050684767, -212.9332583265144, 78.01279209109408, -677.3495914085596, 2.0000000000000013, 45.054063583365775, 132.58099180885392, -164.01912002254107, -49.45576143640557, -52.745256231634784, 55.34475503630929, -196.08371681113107, -45.46162538399307, -388.60506369348593, -332.7263913135862, -31.777366297393716, 36.376601979897465, -243.73377195192268, -24.976685097797613, -22.608319981606478, 2.0000000000000013, -333.5399548434879, -63.40280775825153, -198.4978488354971, -419.9735020900891, -115.62715259658543, -145.18667977110775], "policy_predator_policy_reward": [22.38223329427126, 8.612020866189933, 5.953553996065877, 17.111881827988526, 37.37890416034848, 37.75569004495741, 6.580344206485349, 300.57598156570066, 194.16798959011942, 215.51632102837036, 73.35077624845773, 145.27818029758842, 80.80052027987425, 49.04507083987317, 714.9453313144724, 30.418716531057115, 478.0762882892798, 154.50192550140193, 65.45032830066933, 17.767121447297495, 112.44210808979312, 14.363580779292942, 0.0, 48.12871367271585, 29.68290391659358, 110.99215475450589, 1.742453403851262, 145.7970589781966, 14.742387856254616, 0.0, 23.93522456526239, 69.65641982764335, 1121.7845492185386, 599.5234247766615, 0.0, 129.02078004303127, 65.1831284100924, 10.736369573266408, 39.98176601002818, 70.6484536999854, 0.0, 123.21031655462987, 0.0, 230.6652778572346, 64.18122642879376, 87.7380247601117, 21.504708193573812, 139.72785259723207, 84.84944086057796, 29.8962961088085, 140.7900065231363, 2.329170248407966, 181.46783875292394, 32.407364513442566, 24.791182080484404, 0.0, 60.94390384256598, 55.896789928748795, 7.163005111253288, 52.32960818935576, 72.76985655630776, 77.32200429000477, 68.96143337039287, 3.327253404588469, 566.5900251867791, 111.51801177516514, 47.69396606853235, 195.09326571816, 119.546281086474, 53.897387767902615, 25.289493121961073, 22.04617664202195, 207.97377687553745, 144.9084489152445, 244.38222292291456, 120.7814009520504, 34.07926309357457, 140.77586282108857, 154.37253051501645, 39.6938868115754, 40.487188433490175, 1.9657326684053067, 107.29586970304486, 38.0428954991189, 102.0843488878966, 168.64076067438313, 146.34675704586525, 94.8830952222282, 57.40522183964989, 99.96496561014351, 152.35680228752332, 97.10843888336261, 1.6357929259467119, 134.61964281243516, 238.63526217964596, 72.28348955262655, 0.0, 18.332121168734698, 183.60712045212637, 147.1401697380874, 94.55683395410874, 97.72466636713138, 40.67078372666635, 63.89654142419764, 25.35577358912721, 296.4852029347784, 69.86842781407991, 244.27531197778092, 11.5310650370427, 195.87081347024866, 407.1908603844136, 43.644372415906986, 307.078810544506, 360.6715839516654, 3.7002720107065716, 14.20887442605979, 122.57568886106031, 179.15941109730417, 118.09497248482076, 13.687325008319426, 9.615526932349702, 30.485355483696047, 168.71289898752832, 370.3860488704298, 0.0, 134.4105729880838, 51.0890956961587, 151.0785661618009, 69.84042644736276, 85.58517283211322, 11.461361908233647, 54.60817290687916, 141.64667482922354, 0.0, 106.987312741078, 30.415249851416732, 118.27359782645311, 271.7959808215628, 11.282734465313021, 14.421731085733374, 27.29280791179816, 19.760274437439456, 12.404692425505464, 18.17338362688628, 161.80967845182593, 54.95785518368375, 73.18419147442154, 30.16070904851769, 433.18459897492664, 78.59136188545284, 34.96661761556033, 74.38267957399728, 128.74364102616582, 34.59782391949774, 339.80621878038636, 231.5877557092544, 32.02569032979639, 0.0, 0.0, 38.409180073220355, 8.970950862858446, 111.41953591270178, 7.342425640733028, 98.45981999630877, 386.49313482386293, 110.64445464095364, 1.944601946205228, 23.789119427745877, 7.475897992161504, 110.63379028089696, 8.556866576612826, 0.0, 0.0, 17.495838050684988, 62.02450250941967, 180.8659637260006, 680.1795914085588, 4.86443842213205, 7.943522390355266, 13.325936416634157, 165.78912002253946, 81.01576143640615, 54.495256231634684, 42.475244963690784, 172.70691562082277, 90.81842657429995, 406.2396342071642, 93.94084488045795, 45.99683760111602, 45.183926716379894, 182.1266933880186, 156.68337805259253, 24.29282158330157, 3.9686300854098473, 209.98845162348874, 211.49130082319812, 40.975794608001294, 446.5867782160515, 224.32000101637803, 35.22125960556751]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.540589193224831, "mean_inference_ms": 1.6530874503399213, "mean_action_processing_ms": 0.2455750664502045, "mean_env_wait_ms": 0.1837772671171197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435896873474121, "StateBufferConnector_ms": 0.003068685531616211, "ViewRequirementAgentConnector_ms": 0.10005080699920654}, "num_episodes": 18, "episode_return_max": 390.57876323489916, "episode_return_min": -367.4362838744529, "episode_return_mean": 28.576126619552994, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.3165176934112, "num_env_steps_trained_throughput_per_sec": 398.3165176934112, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 10616.222, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10616.184, "sample_time_ms": 1364.724, "learn_time_ms": 9236.575, "learn_throughput": 433.061, "synch_weights_time_ms": 13.775}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "74486_00000", "date": "2024-08-16_15-09-34", "timestamp": 1723801174, "time_this_iter_s": 10.064972877502441, "time_total_s": 842.5585899353027, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39738f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 842.5585899353027, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 38.957142857142856, "ram_util_percent": 82.52857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2234667266172075, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.827101339360394, "policy_loss": -0.00964955352505462, "vf_loss": 4.83560952938423, "vf_explained_var": 0.34689960199058373, "kl": 0.015218219748238806, "entropy": 0.9802789226410881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2713055582273574, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2636920440764654, "policy_loss": -0.006168098024600161, "vf_loss": 3.2692112162630393, "vf_explained_var": 0.01162145525690109, "kl": 0.03460978059581919, "entropy": 0.5611259356062248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 390.57876323489916, "episode_reward_min": -225.8111431419444, "episode_reward_mean": 41.8740274064223, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -677.3495914085596, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 132.58099180885392, "predator_policy": 680.1795914085588}, "policy_reward_mean": {"prey_policy": -83.32086472563645, "predator_policy": 104.2578784288475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.063610235231916, 58.94999999999954, -32.67052938292043, 125.00638517924003, 3.8899999999999597, 67.82000000000099, 3.7699999999999614, 151.79953281472757, 14.157253404588387, 44.58718324353996, 17.130000000000138, 10.28206625199035, 9.03927971825931, 169.30891692470405, 74.18012250469187, 4.199999999999954, 148.8583271172768, 0.2944660940672545, 8.869273766943904, 57.03773887941871, 20.810000000000418, 17.390000000000175, 17.10000000000014, -4.3962108426889674, -55.51924673090011, 3.9299999999999593, 62.0119744037456, 183.82045816108007, 32.49000000000034, 3.249999999999974, 6.959999999999937, 16.239999999999974, -184.7317903530103, 390.57876323489916, 3.9299999999999593, 91.55289290365566, 3.4999999999999654, 8.186383451570213, -225.8111431419444, 5.699999999999921, 129.3735153462528, 50.88999999999953, 57.27999999999988, -56.77542300800535, 6.527791743328387, 30.770000000000405, 93.35767982353312, 105.86000000000021, 6.349912817599886, 12.139999999999935, 186.77999999999986, -27.897210301335164, 14.153013649368106, -0.5993680517206064, 81.44000000000035, 16.780000000000058, 7.839999999999918, 105.53000000000071, 12.882425640732952, 157.56452537990532, 0.16124092863486833, 102.64000000000017, 2.0604889001823468, 14.799999999999919, 107.97000000000034, 9.69443842213199, 198.90451419920905, 33.33000000000012, 99.57000000000018, 21.980000000000352, -221.15097591945104, 95.78000000000027, 70.09961439089335, 7.653131687104564, 24.536989844947943, -130.90877810153378, -1.2725717457472203, 201.06999999999954, 59.83999999999976, 3.829999999999962, 3.7599999999999634, 21.783090253260788, 128.21000000000032, 78.19097133198485, 63.90999999999994, 93.35000000000062, 104.65, 143.45000000000016, 27.01000000000028, 71.05000000000035, 3.9299999999999597, 2.6035029645750907, 90.77999999999996, -207.1501702942228, 23.370728383662755, 20.25000000000042, 92.43266702682801, 282.5585079624024, 5.9099999999999175, 128.08000000000024], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-72.37557871604147, -103.9205923099953, 0.056191182358571935, -55.851928151745206, -110.97704683988914, -64.8126593145738, -139.57706302044218, 50.7082449333138, -22.90118208048411, 2.0000000000000013, -41.26760688445933, -7.7530868868556375, -57.72261330060938, 2.0000000000000013, -0.2923280315850718, 2.0000000000000013, -60.13143337039323, 2.0000000000000013, -170.68488318710047, -462.835970531305, -7.913328969437734, -217.74390281725564, -115.79231693207127, -47.369285670314675, -35.318377616474756, -2.978012429249307, -200.42330886607738, 16.85000000000011, -137.3879384881804, -153.5955628820953, -32.1992630935749, -138.45586282108883, -44.0807017019889, -1.1273885073264318, -3.7631269338114537, -38.39532807401707, -15.450426493047116, -121.01906494217204, -217.74282345618616, 4.055452773325263, -132.00686815514644, -88.41298411294744, -121.36229697584973, -18.61789047394262, -150.77680228752462, -81.58843888336183, -7.56200376863565, -133.08964281243638, -236.17166929514548, -130.2663291680269, 2.0000000000000013, -16.4021211687344, -104.85919817927953, -163.8761176071887, 56.912486635110675, -65.37352879526863, -10.070783726666383, -62.00654142419802, -23.475773589126916, -295.11520293477963, -157.24980615513013, -149.93393363673266, 3.2989349629572735, -194.46081347024995, -317.1802518177058, -318.38677133562516, 69.4956270404173, -346.66725830168883, -1.7202720107066058, -12.258874426059831, -87.69132617235627, -122.49088088235274, -116.55497248481997, -11.727325008319468, -29.046987675235236, -2.8675112892399737, -413.4298747264314, -351.48021627347083, -128.7025369631889, -0.008036024896454068, 66.9379216481026, -139.73206815980953, -44.391094933248, -60.14450434622846, -9.501361908233688, 0.7118270931209305, -87.5693770246323, -110.85272081259438, -89.0958527180288, -41.77891813113689, -80.70580411494284, -278.5937745330732, 33.74000992550919, 33.913204346975505, 76.61719208820193, -17.81027443743915, -7.197994190688297, -17.03016904410322, -160.33967845182727, -44.28785518368408, 10.70580852557855, 72.72929095148251, -145.89898582895202, -393.7741853327625, -95.50641731322321, 0.31013377303465645, -42.73984255029559, -121.20099044708819, -420.94316780359634, -69.01080668604364, -17.245690329796112, 2.0000000000000013, -32.56918007322073, 2.0000000000000013, -7.020950862858488, -7.8395359127017485, 2.0000000000000013, -94.91981999630798, 0.11984993520654248, -339.69291402011754, -21.82911942774557, -3.7433610175703658, 33.63911120056379, -49.10879947362264, -0.020738976255146764, -6.475638700175374, 12.88999999999996, -15.585838050684767, -212.9332583265144, 78.01279209109408, -677.3495914085596, 2.0000000000000013, 45.054063583365775, 132.58099180885392, -164.01912002254107, -49.45576143640557, -52.745256231634784, 55.34475503630929, -196.08371681113107, -45.46162538399307, -388.60506369348593, -332.7263913135862, -31.777366297393716, 36.376601979897465, -243.73377195192268, -24.976685097797613, -22.608319981606478, 2.0000000000000013, -333.5399548434879, -63.40280775825153, -198.4978488354971, -419.9735020900891, -115.62715259658543, -145.18667977110775, -198.0643635703875, -17.517632869906887, -68.75002464245857, -62.49859514488247, 2.0000000000000013, -31.222291290878267, -71.52974332527717, -35.013320720489496, -33.62605874587565, -52.16658411125741, 7.992095773465929, -114.6459699212164, -45.299941208269786, -4.628053437177683, 49.581865875766745, -90.33901569299643, -196.28446556854527, -18.497554508590078, -312.429372160263, 48.161943443684436, 0.02423166468529654, 104.92793785331381, -41.95040009272144, -175.076443111114, 53.278216055686855, -307.6571338374493, -12.00308996297431, 2.0000000000000013, -43.14759881665055, -20.681386162985692, -45.12378030546138, 55.64777212670624, -240.66889060103617, -346.3996130256679, -107.60620400329056, -266.53162545052373, -71.50492803245109, -147.2183159959869, -165.6138142456335, -123.56948131557024, -145.92331541690038, 80.99726047397336, -0.8007790899105123, -7.8862044427077365, -11.814087469483198, -48.541541635763686], "policy_predator_policy_reward": [21.504708193573812, 139.72785259723207, 84.84944086057796, 29.8962961088085, 140.7900065231363, 2.329170248407966, 181.46783875292394, 32.407364513442566, 24.791182080484404, 0.0, 60.94390384256598, 55.896789928748795, 7.163005111253288, 52.32960818935576, 72.76985655630776, 77.32200429000477, 68.96143337039287, 3.327253404588469, 566.5900251867791, 111.51801177516514, 47.69396606853235, 195.09326571816, 119.546281086474, 53.897387767902615, 25.289493121961073, 22.04617664202195, 207.97377687553745, 144.9084489152445, 244.38222292291456, 120.7814009520504, 34.07926309357457, 140.77586282108857, 154.37253051501645, 39.6938868115754, 40.487188433490175, 1.9657326684053067, 107.29586970304486, 38.0428954991189, 102.0843488878966, 168.64076067438313, 146.34675704586525, 94.8830952222282, 57.40522183964989, 99.96496561014351, 152.35680228752332, 97.10843888336261, 1.6357929259467119, 134.61964281243516, 238.63526217964596, 72.28348955262655, 0.0, 18.332121168734698, 183.60712045212637, 147.1401697380874, 94.55683395410874, 97.72466636713138, 40.67078372666635, 63.89654142419764, 25.35577358912721, 296.4852029347784, 69.86842781407991, 244.27531197778092, 11.5310650370427, 195.87081347024866, 407.1908603844136, 43.644372415906986, 307.078810544506, 360.6715839516654, 3.7002720107065716, 14.20887442605979, 122.57568886106031, 179.15941109730417, 118.09497248482076, 13.687325008319426, 9.615526932349702, 30.485355483696047, 168.71289898752832, 370.3860488704298, 0.0, 134.4105729880838, 51.0890956961587, 151.0785661618009, 69.84042644736276, 85.58517283211322, 11.461361908233647, 54.60817290687916, 141.64667482922354, 0.0, 106.987312741078, 30.415249851416732, 118.27359782645311, 271.7959808215628, 11.282734465313021, 14.421731085733374, 27.29280791179816, 19.760274437439456, 12.404692425505464, 18.17338362688628, 161.80967845182593, 54.95785518368375, 73.18419147442154, 30.16070904851769, 433.18459897492664, 78.59136188545284, 34.96661761556033, 74.38267957399728, 128.74364102616582, 34.59782391949774, 339.80621878038636, 231.5877557092544, 32.02569032979639, 0.0, 0.0, 38.409180073220355, 8.970950862858446, 111.41953591270178, 7.342425640733028, 98.45981999630877, 386.49313482386293, 110.64445464095364, 1.944601946205228, 23.789119427745877, 7.475897992161504, 110.63379028089696, 8.556866576612826, 0.0, 0.0, 17.495838050684988, 62.02450250941967, 180.8659637260006, 680.1795914085588, 4.86443842213205, 7.943522390355266, 13.325936416634157, 165.78912002253946, 81.01576143640615, 54.495256231634684, 42.475244963690784, 172.70691562082277, 90.81842657429995, 406.2396342071642, 93.94084488045795, 45.99683760111602, 45.183926716379894, 182.1266933880186, 156.68337805259253, 24.29282158330157, 3.9686300854098473, 209.98845162348874, 211.49130082319812, 40.975794608001294, 446.5867782160515, 224.32000101637803, 35.22125960556751, 253.8947728781766, 162.75722356211722, 102.63386976557572, 88.45475002176516, 0.0, 33.0522912908782, 73.41974332527813, 36.883320720489124, 87.85478645647224, 19.720946653920386, 118.40790422653421, 116.45596992121733, 109.66075623561505, 18.45820974181711, 12.738134124233175, 91.92901569299701, 164.97348409675004, 143.1585359803854, 5.168838248814683, 363.74859046776356, 1.965768335314705, 36.53206214668623, 43.84040009272106, 200.19644311111344, 16.951783944312993, 308.47713383744906, 13.933089962974268, 0.0, 61.51073985918698, 4.92174808502431, 46.913780305461174, 33.342227873293766, 252.23774968258851, 127.68058364989234, 113.85693238695355, 283.6516254505228, 58.92766273518544, 180.04558129325142, 193.75148158032263, 187.86448100770673, 175.97289171189226, 171.51167119343776, 2.7907790899104965, 11.806204442707696, 79.96408746948303, 108.471541635764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5389697194239891, "mean_inference_ms": 1.6506746359252842, "mean_action_processing_ms": 0.24445587435688257, "mean_env_wait_ms": 0.1833002302473663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004557251930236816, "StateBufferConnector_ms": 0.0032434463500976562, "ViewRequirementAgentConnector_ms": 0.10565781593322754}, "num_episodes": 23, "episode_return_max": 390.57876323489916, "episode_return_min": -225.8111431419444, "episode_return_mean": 41.8740274064223, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 395.22598970008676, "num_env_steps_trained_throughput_per_sec": 395.22598970008676, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 10601.127, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10601.088, "sample_time_ms": 1353.213, "learn_time_ms": 9233.051, "learn_throughput": 433.226, "synch_weights_time_ms": 13.594}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "74486_00000", "date": "2024-08-16_15-09-45", "timestamp": 1723801185, "time_this_iter_s": 10.124686002731323, "time_total_s": 852.6832759380341, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3980b7790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 852.6832759380341, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 35.79333333333333, "ram_util_percent": 81.84666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.607492109013613, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.552009347759227, "policy_loss": -0.010050986261875738, "vf_loss": 4.56127961905545, "vf_explained_var": 0.4187555446826592, "kl": 0.010409344631501366, "entropy": 1.014924698752701, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.494870876477509, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6474766589346386, "policy_loss": -0.0053252285585379, "vf_loss": 2.652355914582651, "vf_explained_var": 0.023254880860999777, "kl": 0.015856298615521514, "entropy": 0.7565413376957021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 390.57876323489916, "episode_reward_min": -225.8111431419444, "episode_reward_mean": 50.56060773477906, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -677.3495914085596, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.57087710605464, "predator_policy": 680.1795914085588}, "policy_reward_mean": {"prey_policy": -77.18044749522453, "predator_policy": 102.46075136261399}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.869273766943904, 57.03773887941871, 20.810000000000418, 17.390000000000175, 17.10000000000014, -4.3962108426889674, -55.51924673090011, 3.9299999999999593, 62.0119744037456, 183.82045816108007, 32.49000000000034, 3.249999999999974, 6.959999999999937, 16.239999999999974, -184.7317903530103, 390.57876323489916, 3.9299999999999593, 91.55289290365566, 3.4999999999999654, 8.186383451570213, -225.8111431419444, 5.699999999999921, 129.3735153462528, 50.88999999999953, 57.27999999999988, -56.77542300800535, 6.527791743328387, 30.770000000000405, 93.35767982353312, 105.86000000000021, 6.349912817599886, 12.139999999999935, 186.77999999999986, -27.897210301335164, 14.153013649368106, -0.5993680517206064, 81.44000000000035, 16.780000000000058, 7.839999999999918, 105.53000000000071, 12.882425640732952, 157.56452537990532, 0.16124092863486833, 102.64000000000017, 2.0604889001823468, 14.799999999999919, 107.97000000000034, 9.69443842213199, 198.90451419920905, 33.33000000000012, 99.57000000000018, 21.980000000000352, -221.15097591945104, 95.78000000000027, 70.09961439089335, 7.653131687104564, 24.536989844947943, -130.90877810153378, -1.2725717457472203, 201.06999999999954, 59.83999999999976, 3.829999999999962, 3.7599999999999634, 21.783090253260788, 128.21000000000032, 78.19097133198485, 63.90999999999994, 93.35000000000062, 104.65, 143.45000000000016, 27.01000000000028, 71.05000000000035, 3.9299999999999597, 2.6035029645750907, 90.77999999999996, -207.1501702942228, 23.370728383662755, 20.25000000000042, 92.43266702682801, 282.5585079624024, 5.9099999999999175, 128.08000000000024, 152.76000000000002, 3.639999999999963, 3.729999999999964, 3.4599999999999644, 98.36000000000065, 251.23567593493138, 128.78000000000011, 176.30000000000004, 158.13000000000005, 166.25000000000006, -8.783556188315256, 116.73000000000027, 119.46000000000053, 144.72999999999996, 138.01616092548647, 57.97999999999961, 3.8799999999999617, 9.539145798505192], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.450426493047116, -121.01906494217204, -217.74282345618616, 4.055452773325263, -132.00686815514644, -88.41298411294744, -121.36229697584973, -18.61789047394262, -150.77680228752462, -81.58843888336183, -7.56200376863565, -133.08964281243638, -236.17166929514548, -130.2663291680269, 2.0000000000000013, -16.4021211687344, -104.85919817927953, -163.8761176071887, 56.912486635110675, -65.37352879526863, -10.070783726666383, -62.00654142419802, -23.475773589126916, -295.11520293477963, -157.24980615513013, -149.93393363673266, 3.2989349629572735, -194.46081347024995, -317.1802518177058, -318.38677133562516, 69.4956270404173, -346.66725830168883, -1.7202720107066058, -12.258874426059831, -87.69132617235627, -122.49088088235274, -116.55497248481997, -11.727325008319468, -29.046987675235236, -2.8675112892399737, -413.4298747264314, -351.48021627347083, -128.7025369631889, -0.008036024896454068, 66.9379216481026, -139.73206815980953, -44.391094933248, -60.14450434622846, -9.501361908233688, 0.7118270931209305, -87.5693770246323, -110.85272081259438, -89.0958527180288, -41.77891813113689, -80.70580411494284, -278.5937745330732, 33.74000992550919, 33.913204346975505, 76.61719208820193, -17.81027443743915, -7.197994190688297, -17.03016904410322, -160.33967845182727, -44.28785518368408, 10.70580852557855, 72.72929095148251, -145.89898582895202, -393.7741853327625, -95.50641731322321, 0.31013377303465645, -42.73984255029559, -121.20099044708819, -420.94316780359634, -69.01080668604364, -17.245690329796112, 2.0000000000000013, -32.56918007322073, 2.0000000000000013, -7.020950862858488, -7.8395359127017485, 2.0000000000000013, -94.91981999630798, 0.11984993520654248, -339.69291402011754, -21.82911942774557, -3.7433610175703658, 33.63911120056379, -49.10879947362264, -0.020738976255146764, -6.475638700175374, 12.88999999999996, -15.585838050684767, -212.9332583265144, 78.01279209109408, -677.3495914085596, 2.0000000000000013, 45.054063583365775, 132.58099180885392, -164.01912002254107, -49.45576143640557, -52.745256231634784, 55.34475503630929, -196.08371681113107, -45.46162538399307, -388.60506369348593, -332.7263913135862, -31.777366297393716, 36.376601979897465, -243.73377195192268, -24.976685097797613, -22.608319981606478, 2.0000000000000013, -333.5399548434879, -63.40280775825153, -198.4978488354971, -419.9735020900891, -115.62715259658543, -145.18667977110775, -198.0643635703875, -17.517632869906887, -68.75002464245857, -62.49859514488247, 2.0000000000000013, -31.222291290878267, -71.52974332527717, -35.013320720489496, -33.62605874587565, -52.16658411125741, 7.992095773465929, -114.6459699212164, -45.299941208269786, -4.628053437177683, 49.581865875766745, -90.33901569299643, -196.28446556854527, -18.497554508590078, -312.429372160263, 48.161943443684436, 0.02423166468529654, 104.92793785331381, -41.95040009272144, -175.076443111114, 53.278216055686855, -307.6571338374493, -12.00308996297431, 2.0000000000000013, -43.14759881665055, -20.681386162985692, -45.12378030546138, 55.64777212670624, -240.66889060103617, -346.3996130256679, -107.60620400329056, -266.53162545052373, -71.50492803245109, -147.2183159959869, -165.6138142456335, -123.56948131557024, -145.92331541690038, 80.99726047397336, -0.8007790899105123, -7.8862044427077365, -11.814087469483198, -48.541541635763686, -88.16660138558905, 56.74345771269813, -81.32385232913396, -1.4652121591688512, -14.89935783207106, -45.903055459742404, -149.63081154115466, -26.610845196344233, -120.67666937149394, 11.940049312774317, 70.28825389164867, 110.46625352846648, 117.66010456636495, -499.83480251137325, -467.56794555272785, 157.57087710605464, 79.68629492242619, -25.09149380656096, 138.86283775001442, 2.0000000000000013, -15.391800560515962, -19.191240508602746, -21.589079537163474, 108.59360361668945, -21.56502143502262, 0.30462088336227294, -130.07180730714313, 9.046309823620255, -141.94421382771094, 35.28275336319105, -112.98560017316146, -9.53430424702612, -10.525181331478528, -17.565426324931547, -87.06798856675573, -33.79290174282645], "policy_predator_policy_reward": [107.29586970304486, 38.0428954991189, 102.0843488878966, 168.64076067438313, 146.34675704586525, 94.8830952222282, 57.40522183964989, 99.96496561014351, 152.35680228752332, 97.10843888336261, 1.6357929259467119, 134.61964281243516, 238.63526217964596, 72.28348955262655, 0.0, 18.332121168734698, 183.60712045212637, 147.1401697380874, 94.55683395410874, 97.72466636713138, 40.67078372666635, 63.89654142419764, 25.35577358912721, 296.4852029347784, 69.86842781407991, 244.27531197778092, 11.5310650370427, 195.87081347024866, 407.1908603844136, 43.644372415906986, 307.078810544506, 360.6715839516654, 3.7002720107065716, 14.20887442605979, 122.57568886106031, 179.15941109730417, 118.09497248482076, 13.687325008319426, 9.615526932349702, 30.485355483696047, 168.71289898752832, 370.3860488704298, 0.0, 134.4105729880838, 51.0890956961587, 151.0785661618009, 69.84042644736276, 85.58517283211322, 11.461361908233647, 54.60817290687916, 141.64667482922354, 0.0, 106.987312741078, 30.415249851416732, 118.27359782645311, 271.7959808215628, 11.282734465313021, 14.421731085733374, 27.29280791179816, 19.760274437439456, 12.404692425505464, 18.17338362688628, 161.80967845182593, 54.95785518368375, 73.18419147442154, 30.16070904851769, 433.18459897492664, 78.59136188545284, 34.96661761556033, 74.38267957399728, 128.74364102616582, 34.59782391949774, 339.80621878038636, 231.5877557092544, 32.02569032979639, 0.0, 0.0, 38.409180073220355, 8.970950862858446, 111.41953591270178, 7.342425640733028, 98.45981999630877, 386.49313482386293, 110.64445464095364, 1.944601946205228, 23.789119427745877, 7.475897992161504, 110.63379028089696, 8.556866576612826, 0.0, 0.0, 17.495838050684988, 62.02450250941967, 180.8659637260006, 680.1795914085588, 4.86443842213205, 7.943522390355266, 13.325936416634157, 165.78912002253946, 81.01576143640615, 54.495256231634684, 42.475244963690784, 172.70691562082277, 90.81842657429995, 406.2396342071642, 93.94084488045795, 45.99683760111602, 45.183926716379894, 182.1266933880186, 156.68337805259253, 24.29282158330157, 3.9686300854098473, 209.98845162348874, 211.49130082319812, 40.975794608001294, 446.5867782160515, 224.32000101637803, 35.22125960556751, 253.8947728781766, 162.75722356211722, 102.63386976557572, 88.45475002176516, 0.0, 33.0522912908782, 73.41974332527813, 36.883320720489124, 87.85478645647224, 19.720946653920386, 118.40790422653421, 116.45596992121733, 109.66075623561505, 18.45820974181711, 12.738134124233175, 91.92901569299701, 164.97348409675004, 143.1585359803854, 5.168838248814683, 363.74859046776356, 1.965768335314705, 36.53206214668623, 43.84040009272106, 200.19644311111344, 16.951783944312993, 308.47713383744906, 13.933089962974268, 0.0, 61.51073985918698, 4.92174808502431, 46.913780305461174, 33.342227873293766, 252.23774968258851, 127.68058364989234, 113.85693238695355, 283.6516254505228, 58.92766273518544, 180.04558129325142, 193.75148158032263, 187.86448100770673, 175.97289171189226, 171.51167119343776, 2.7907790899104965, 11.806204442707696, 79.96408746948303, 108.471541635764, 161.50058737702403, 22.682556295867297, 82.98385232913478, 3.445212159168821, 16.829357832071164, 47.70305545974213, 151.17081154115326, 28.530845196344533, 141.71834271879982, 65.37827733992057, 16.584330472389663, 53.896838042427134, 47.36007889239984, 463.5946190526087, 467.7279455527278, 18.569122893945323, 76.5537050775739, 26.981493806561254, 25.387162249985625, 0.0, 25.79948488080403, 0.0, 23.489079537163747, 6.236396383310534, 139.0350214350227, 1.6853791166377285, 131.5718073071418, 134.1836901763798, 101.21340756229544, 143.4642138277096, 169.01560017316189, 11.484304247026078, 12.485181331478486, 19.485426324931847, 19.57081646687986, 110.829219641208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5412118368064612, "mean_inference_ms": 1.6580224478242473, "mean_action_processing_ms": 0.24569999395241485, "mean_env_wait_ms": 0.1840628896773934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043451786041259766, "StateBufferConnector_ms": 0.0031800270080566406, "ViewRequirementAgentConnector_ms": 0.10161209106445312}, "num_episodes": 18, "episode_return_max": 390.57876323489916, "episode_return_min": -225.8111431419444, "episode_return_mean": 50.56060773477906, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.27851616161485, "num_env_steps_trained_throughput_per_sec": 401.27851616161485, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 10571.901, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10571.862, "sample_time_ms": 1360.808, "learn_time_ms": 9196.4, "learn_throughput": 434.953, "synch_weights_time_ms": 13.33}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "74486_00000", "date": "2024-08-16_15-09-55", "timestamp": 1723801195, "time_this_iter_s": 9.973185062408447, "time_total_s": 862.6564610004425, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39802b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 862.6564610004425, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 33.43571428571429, "ram_util_percent": 81.1214285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6437252707582304, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.125993933501067, "policy_loss": -0.004611243852093895, "vf_loss": 6.12944750962434, "vf_explained_var": 0.4942113721812213, "kl": 0.015435596656083959, "entropy": 1.0758106601301325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3975425586183234, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0868041027159916, "policy_loss": -0.004930329752011747, "vf_loss": 3.0912689817645562, "vf_explained_var": 0.010128227459690558, "kl": 0.016549429229501356, "entropy": 0.6419044768684125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 571.9308037349109, "episode_reward_min": -280.94339042720856, "episode_reward_mean": 72.49642039274556, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -677.3495914085596, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 166.011670281757, "predator_policy": 680.1795914085588}, "policy_reward_mean": {"prey_policy": -66.81209108663305, "predator_policy": 103.06030128300577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.4999999999999654, 8.186383451570213, -225.8111431419444, 5.699999999999921, 129.3735153462528, 50.88999999999953, 57.27999999999988, -56.77542300800535, 6.527791743328387, 30.770000000000405, 93.35767982353312, 105.86000000000021, 6.349912817599886, 12.139999999999935, 186.77999999999986, -27.897210301335164, 14.153013649368106, -0.5993680517206064, 81.44000000000035, 16.780000000000058, 7.839999999999918, 105.53000000000071, 12.882425640732952, 157.56452537990532, 0.16124092863486833, 102.64000000000017, 2.0604889001823468, 14.799999999999919, 107.97000000000034, 9.69443842213199, 198.90451419920905, 33.33000000000012, 99.57000000000018, 21.980000000000352, -221.15097591945104, 95.78000000000027, 70.09961439089335, 7.653131687104564, 24.536989844947943, -130.90877810153378, -1.2725717457472203, 201.06999999999954, 59.83999999999976, 3.829999999999962, 3.7599999999999634, 21.783090253260788, 128.21000000000032, 78.19097133198485, 63.90999999999994, 93.35000000000062, 104.65, 143.45000000000016, 27.01000000000028, 71.05000000000035, 3.9299999999999597, 2.6035029645750907, 90.77999999999996, -207.1501702942228, 23.370728383662755, 20.25000000000042, 92.43266702682801, 282.5585079624024, 5.9099999999999175, 128.08000000000024, 152.76000000000002, 3.639999999999963, 3.729999999999964, 3.4599999999999644, 98.36000000000065, 251.23567593493138, 128.78000000000011, 176.30000000000004, 158.13000000000005, 166.25000000000006, -8.783556188315256, 116.73000000000027, 119.46000000000053, 144.72999999999996, 138.01616092548647, 57.97999999999961, 3.8799999999999617, 9.539145798505192, 3.4899999999999647, 345.70660856734116, 149.0000000000003, 124.35000000000062, 140.6800000000003, 29.032681128003087, 186.32409617172084, -280.94339042720856, 277.3665897776747, 161.78999999999968, 246.49683812232536, 297.80039036289395, 5.7515143861678855, 12.622492124347165, 177.53999999999996, 571.9308037349109, 310.2964952716184, 105.67000000000023], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-116.55497248481997, -11.727325008319468, -29.046987675235236, -2.8675112892399737, -413.4298747264314, -351.48021627347083, -128.7025369631889, -0.008036024896454068, 66.9379216481026, -139.73206815980953, -44.391094933248, -60.14450434622846, -9.501361908233688, 0.7118270931209305, -87.5693770246323, -110.85272081259438, -89.0958527180288, -41.77891813113689, -80.70580411494284, -278.5937745330732, 33.74000992550919, 33.913204346975505, 76.61719208820193, -17.81027443743915, -7.197994190688297, -17.03016904410322, -160.33967845182727, -44.28785518368408, 10.70580852557855, 72.72929095148251, -145.89898582895202, -393.7741853327625, -95.50641731322321, 0.31013377303465645, -42.73984255029559, -121.20099044708819, -420.94316780359634, -69.01080668604364, -17.245690329796112, 2.0000000000000013, -32.56918007322073, 2.0000000000000013, -7.020950862858488, -7.8395359127017485, 2.0000000000000013, -94.91981999630798, 0.11984993520654248, -339.69291402011754, -21.82911942774557, -3.7433610175703658, 33.63911120056379, -49.10879947362264, -0.020738976255146764, -6.475638700175374, 12.88999999999996, -15.585838050684767, -212.9332583265144, 78.01279209109408, -677.3495914085596, 2.0000000000000013, 45.054063583365775, 132.58099180885392, -164.01912002254107, -49.45576143640557, -52.745256231634784, 55.34475503630929, -196.08371681113107, -45.46162538399307, -388.60506369348593, -332.7263913135862, -31.777366297393716, 36.376601979897465, -243.73377195192268, -24.976685097797613, -22.608319981606478, 2.0000000000000013, -333.5399548434879, -63.40280775825153, -198.4978488354971, -419.9735020900891, -115.62715259658543, -145.18667977110775, -198.0643635703875, -17.517632869906887, -68.75002464245857, -62.49859514488247, 2.0000000000000013, -31.222291290878267, -71.52974332527717, -35.013320720489496, -33.62605874587565, -52.16658411125741, 7.992095773465929, -114.6459699212164, -45.299941208269786, -4.628053437177683, 49.581865875766745, -90.33901569299643, -196.28446556854527, -18.497554508590078, -312.429372160263, 48.161943443684436, 0.02423166468529654, 104.92793785331381, -41.95040009272144, -175.076443111114, 53.278216055686855, -307.6571338374493, -12.00308996297431, 2.0000000000000013, -43.14759881665055, -20.681386162985692, -45.12378030546138, 55.64777212670624, -240.66889060103617, -346.3996130256679, -107.60620400329056, -266.53162545052373, -71.50492803245109, -147.2183159959869, -165.6138142456335, -123.56948131557024, -145.92331541690038, 80.99726047397336, -0.8007790899105123, -7.8862044427077365, -11.814087469483198, -48.541541635763686, -88.16660138558905, 56.74345771269813, -81.32385232913396, -1.4652121591688512, -14.89935783207106, -45.903055459742404, -149.63081154115466, -26.610845196344233, -120.67666937149394, 11.940049312774317, 70.28825389164867, 110.46625352846648, 117.66010456636495, -499.83480251137325, -467.56794555272785, 157.57087710605464, 79.68629492242619, -25.09149380656096, 138.86283775001442, 2.0000000000000013, -15.391800560515962, -19.191240508602746, -21.589079537163474, 108.59360361668945, -21.56502143502262, 0.30462088336227294, -130.07180730714313, 9.046309823620255, -141.94421382771094, 35.28275336319105, -112.98560017316146, -9.53430424702612, -10.525181331478528, -17.565426324931547, -87.06798856675573, -33.79290174282645, -15.396992280299036, -145.18625962937125, 117.69031144555842, 144.00488615023806, 104.5688166696337, -93.45580210090566, 121.16984159887501, -102.47837754088653, -101.03198986855948, 14.008577524320593, -75.5992784049527, -256.3860098140686, -24.77728295239345, -7.131803904228292, -404.4769925077131, -282.761176712751, 36.55685474515597, 92.48892638083453, -206.70213205958044, 110.04902736767279, 2.0000000000000013, -70.65566190063498, 19.551215303612775, 140.9733753077594, -46.248207357465255, -3.916716736348164, -72.44296053109416, -1.9852310816687377, 166.011670281757, -281.7773216078944, 134.46937760440983, -600.2738210051565, 37.76003307576434, 132.84022295720567, 56.86924464150295, -332.18127638649474], "policy_predator_policy_reward": [118.09497248482076, 13.687325008319426, 9.615526932349702, 30.485355483696047, 168.71289898752832, 370.3860488704298, 0.0, 134.4105729880838, 51.0890956961587, 151.0785661618009, 69.84042644736276, 85.58517283211322, 11.461361908233647, 54.60817290687916, 141.64667482922354, 0.0, 106.987312741078, 30.415249851416732, 118.27359782645311, 271.7959808215628, 11.282734465313021, 14.421731085733374, 27.29280791179816, 19.760274437439456, 12.404692425505464, 18.17338362688628, 161.80967845182593, 54.95785518368375, 73.18419147442154, 30.16070904851769, 433.18459897492664, 78.59136188545284, 34.96661761556033, 74.38267957399728, 128.74364102616582, 34.59782391949774, 339.80621878038636, 231.5877557092544, 32.02569032979639, 0.0, 0.0, 38.409180073220355, 8.970950862858446, 111.41953591270178, 7.342425640733028, 98.45981999630877, 386.49313482386293, 110.64445464095364, 1.944601946205228, 23.789119427745877, 7.475897992161504, 110.63379028089696, 8.556866576612826, 0.0, 0.0, 17.495838050684988, 62.02450250941967, 180.8659637260006, 680.1795914085588, 4.86443842213205, 7.943522390355266, 13.325936416634157, 165.78912002253946, 81.01576143640615, 54.495256231634684, 42.475244963690784, 172.70691562082277, 90.81842657429995, 406.2396342071642, 93.94084488045795, 45.99683760111602, 45.183926716379894, 182.1266933880186, 156.68337805259253, 24.29282158330157, 3.9686300854098473, 209.98845162348874, 211.49130082319812, 40.975794608001294, 446.5867782160515, 224.32000101637803, 35.22125960556751, 253.8947728781766, 162.75722356211722, 102.63386976557572, 88.45475002176516, 0.0, 33.0522912908782, 73.41974332527813, 36.883320720489124, 87.85478645647224, 19.720946653920386, 118.40790422653421, 116.45596992121733, 109.66075623561505, 18.45820974181711, 12.738134124233175, 91.92901569299701, 164.97348409675004, 143.1585359803854, 5.168838248814683, 363.74859046776356, 1.965768335314705, 36.53206214668623, 43.84040009272106, 200.19644311111344, 16.951783944312993, 308.47713383744906, 13.933089962974268, 0.0, 61.51073985918698, 4.92174808502431, 46.913780305461174, 33.342227873293766, 252.23774968258851, 127.68058364989234, 113.85693238695355, 283.6516254505228, 58.92766273518544, 180.04558129325142, 193.75148158032263, 187.86448100770673, 175.97289171189226, 171.51167119343776, 2.7907790899104965, 11.806204442707696, 79.96408746948303, 108.471541635764, 161.50058737702403, 22.682556295867297, 82.98385232913478, 3.445212159168821, 16.829357832071164, 47.70305545974213, 151.17081154115326, 28.530845196344533, 141.71834271879982, 65.37827733992057, 16.584330472389663, 53.896838042427134, 47.36007889239984, 463.5946190526087, 467.7279455527278, 18.569122893945323, 76.5537050775739, 26.981493806561254, 25.387162249985625, 0.0, 25.79948488080403, 0.0, 23.489079537163747, 6.236396383310534, 139.0350214350227, 1.6853791166377285, 131.5718073071418, 134.1836901763798, 101.21340756229544, 143.4642138277096, 169.01560017316189, 11.484304247026078, 12.485181331478486, 19.485426324931847, 19.57081646687986, 110.829219641208, 17.33699228029923, 146.7362596293699, 23.622366811104794, 60.389044160440164, 42.761183330366286, 95.1258021009065, 1.6001584011251573, 104.05837754088734, 102.59198986856026, 125.1114224756794, 92.20497829259457, 268.81299105442884, 94.63119993740298, 123.60198309094032, 406.29477879325543, 0.0, 29.638731705765732, 118.68207694591875, 170.69398972132203, 87.74911497058424, 201.55716823474535, 113.59533178821637, 25.050390362894326, 112.22540938862775, 48.07820735746489, 7.8382311225160874, 83.74347117398385, 3.307212563127208, 10.188329718242954, 283.1173216078932, 546.4980106039084, 491.2372365317478, 27.74822708140639, 111.94801215724225, 380.982031744992, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5414346247012097, "mean_inference_ms": 1.6600641352546657, "mean_action_processing_ms": 0.24571278199026164, "mean_env_wait_ms": 0.18418224565635138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004498839378356934, "StateBufferConnector_ms": 0.0032265186309814453, "ViewRequirementAgentConnector_ms": 0.10906863212585449}, "num_episodes": 18, "episode_return_max": 571.9308037349109, "episode_return_min": -280.94339042720856, "episode_return_mean": 72.49642039274556, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.45735969078544, "num_env_steps_trained_throughput_per_sec": 409.45735969078544, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 10414.998, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10414.961, "sample_time_ms": 1348.963, "learn_time_ms": 9052.41, "learn_throughput": 441.871, "synch_weights_time_ms": 12.27}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "74486_00000", "date": "2024-08-16_15-10-04", "timestamp": 1723801204, "time_this_iter_s": 9.774019002914429, "time_total_s": 872.4304800033569, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397740c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 872.4304800033569, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 36.107142857142854, "ram_util_percent": 80.96428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9973157125175316, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.461003790961372, "policy_loss": -0.0010410073405456922, "vf_loss": 5.460514728354399, "vf_explained_var": 0.6709555051629505, "kl": 0.020400839559459465, "entropy": 1.1521018906245155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3013634055695207, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.339901026720723, "policy_loss": -0.005649133377940093, "vf_loss": 2.345265759172894, "vf_explained_var": 0.008855319117742871, "kl": 0.010112007496739536, "entropy": 0.7024658744297331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 571.9308037349109, "episode_reward_min": -280.94339042720856, "episode_reward_mean": 110.38371173127678, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -677.3495914085596, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.3184765784232, "predator_policy": 680.1795914085588}, "policy_reward_mean": {"prey_policy": -44.41259982851263, "predator_policy": 99.604455694151}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.882425640732952, 157.56452537990532, 0.16124092863486833, 102.64000000000017, 2.0604889001823468, 14.799999999999919, 107.97000000000034, 9.69443842213199, 198.90451419920905, 33.33000000000012, 99.57000000000018, 21.980000000000352, -221.15097591945104, 95.78000000000027, 70.09961439089335, 7.653131687104564, 24.536989844947943, -130.90877810153378, -1.2725717457472203, 201.06999999999954, 59.83999999999976, 3.829999999999962, 3.7599999999999634, 21.783090253260788, 128.21000000000032, 78.19097133198485, 63.90999999999994, 93.35000000000062, 104.65, 143.45000000000016, 27.01000000000028, 71.05000000000035, 3.9299999999999597, 2.6035029645750907, 90.77999999999996, -207.1501702942228, 23.370728383662755, 20.25000000000042, 92.43266702682801, 282.5585079624024, 5.9099999999999175, 128.08000000000024, 152.76000000000002, 3.639999999999963, 3.729999999999964, 3.4599999999999644, 98.36000000000065, 251.23567593493138, 128.78000000000011, 176.30000000000004, 158.13000000000005, 166.25000000000006, -8.783556188315256, 116.73000000000027, 119.46000000000053, 144.72999999999996, 138.01616092548647, 57.97999999999961, 3.8799999999999617, 9.539145798505192, 3.4899999999999647, 345.70660856734116, 149.0000000000003, 124.35000000000062, 140.6800000000003, 29.032681128003087, 186.32409617172084, -280.94339042720856, 277.3665897776747, 161.78999999999968, 246.49683812232536, 297.80039036289395, 5.7515143861678855, 12.622492124347165, 177.53999999999996, 571.9308037349109, 310.2964952716184, 105.67000000000023, 108.6309200931868, 128.64000000000033, 332.6201279119018, 154.36000000000033, 132.21000000000038, 176.09999999999997, 357.28, 3.479999999999968, 167.95999999999987, 174.51323344215427, 319.6099999999998, 361.6972186968239, 110.05000000000038, 173.05999999999972, 151.9200000000001, 269.87233606525524, 159.76000000000002, 353.0495524708881, 353.22425157679805, 255.27972760767082, 3.679999999999962, 153.10691831708857], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -94.91981999630798, 0.11984993520654248, -339.69291402011754, -21.82911942774557, -3.7433610175703658, 33.63911120056379, -49.10879947362264, -0.020738976255146764, -6.475638700175374, 12.88999999999996, -15.585838050684767, -212.9332583265144, 78.01279209109408, -677.3495914085596, 2.0000000000000013, 45.054063583365775, 132.58099180885392, -164.01912002254107, -49.45576143640557, -52.745256231634784, 55.34475503630929, -196.08371681113107, -45.46162538399307, -388.60506369348593, -332.7263913135862, -31.777366297393716, 36.376601979897465, -243.73377195192268, -24.976685097797613, -22.608319981606478, 2.0000000000000013, -333.5399548434879, -63.40280775825153, -198.4978488354971, -419.9735020900891, -115.62715259658543, -145.18667977110775, -198.0643635703875, -17.517632869906887, -68.75002464245857, -62.49859514488247, 2.0000000000000013, -31.222291290878267, -71.52974332527717, -35.013320720489496, -33.62605874587565, -52.16658411125741, 7.992095773465929, -114.6459699212164, -45.299941208269786, -4.628053437177683, 49.581865875766745, -90.33901569299643, -196.28446556854527, -18.497554508590078, -312.429372160263, 48.161943443684436, 0.02423166468529654, 104.92793785331381, -41.95040009272144, -175.076443111114, 53.278216055686855, -307.6571338374493, -12.00308996297431, 2.0000000000000013, -43.14759881665055, -20.681386162985692, -45.12378030546138, 55.64777212670624, -240.66889060103617, -346.3996130256679, -107.60620400329056, -266.53162545052373, -71.50492803245109, -147.2183159959869, -165.6138142456335, -123.56948131557024, -145.92331541690038, 80.99726047397336, -0.8007790899105123, -7.8862044427077365, -11.814087469483198, -48.541541635763686, -88.16660138558905, 56.74345771269813, -81.32385232913396, -1.4652121591688512, -14.89935783207106, -45.903055459742404, -149.63081154115466, -26.610845196344233, -120.67666937149394, 11.940049312774317, 70.28825389164867, 110.46625352846648, 117.66010456636495, -499.83480251137325, -467.56794555272785, 157.57087710605464, 79.68629492242619, -25.09149380656096, 138.86283775001442, 2.0000000000000013, -15.391800560515962, -19.191240508602746, -21.589079537163474, 108.59360361668945, -21.56502143502262, 0.30462088336227294, -130.07180730714313, 9.046309823620255, -141.94421382771094, 35.28275336319105, -112.98560017316146, -9.53430424702612, -10.525181331478528, -17.565426324931547, -87.06798856675573, -33.79290174282645, -15.396992280299036, -145.18625962937125, 117.69031144555842, 144.00488615023806, 104.5688166696337, -93.45580210090566, 121.16984159887501, -102.47837754088653, -101.03198986855948, 14.008577524320593, -75.5992784049527, -256.3860098140686, -24.77728295239345, -7.131803904228292, -404.4769925077131, -282.761176712751, 36.55685474515597, 92.48892638083453, -206.70213205958044, 110.04902736767279, 2.0000000000000013, -70.65566190063498, 19.551215303612775, 140.9733753077594, -46.248207357465255, -3.916716736348164, -72.44296053109416, -1.9852310816687377, 166.011670281757, -281.7773216078944, 134.46937760440983, -600.2738210051565, 37.76003307576434, 132.84022295720567, 56.86924464150295, -332.18127638649474, -163.3069863228055, -78.43715999742183, 61.37372796851945, 2.0000000000000013, 13.988362963856178, 63.58470585836929, -4.936003101646444, 130.4863455563139, -22.994169268877066, 41.589122877434455, -17.56618193618603, 155.90561891301036, 159.7222222186124, 149.74638224516212, -10.550376563381965, -190.7206755047541, -87.7972297348361, 114.3777696601422, -8.335612126439258, 128.95696735449633, 139.1607122544297, 131.92666350640096, 124.69066758343963, 154.96316343165725, -10.517447120785938, -62.866262026599344, 164.16376297650243, -77.38805318359243, 34.390339713522266, -18.84439001550722, 144.80746366803288, 69.35968125982065, -474.84165467655623, 135.3104267345048, 183.3184765784232, -46.940253253638105, 114.05086202112447, 138.19446312337914, 118.87670941096812, 3.2432715053419066, -67.09027416557029, -16.594681694872147, -84.44979036423685, -51.045709925480566], "policy_predator_policy_reward": [7.342425640733028, 98.45981999630877, 386.49313482386293, 110.64445464095364, 1.944601946205228, 23.789119427745877, 7.475897992161504, 110.63379028089696, 8.556866576612826, 0.0, 0.0, 17.495838050684988, 62.02450250941967, 180.8659637260006, 680.1795914085588, 4.86443842213205, 7.943522390355266, 13.325936416634157, 165.78912002253946, 81.01576143640615, 54.495256231634684, 42.475244963690784, 172.70691562082277, 90.81842657429995, 406.2396342071642, 93.94084488045795, 45.99683760111602, 45.183926716379894, 182.1266933880186, 156.68337805259253, 24.29282158330157, 3.9686300854098473, 209.98845162348874, 211.49130082319812, 40.975794608001294, 446.5867782160515, 224.32000101637803, 35.22125960556751, 253.8947728781766, 162.75722356211722, 102.63386976557572, 88.45475002176516, 0.0, 33.0522912908782, 73.41974332527813, 36.883320720489124, 87.85478645647224, 19.720946653920386, 118.40790422653421, 116.45596992121733, 109.66075623561505, 18.45820974181711, 12.738134124233175, 91.92901569299701, 164.97348409675004, 143.1585359803854, 5.168838248814683, 363.74859046776356, 1.965768335314705, 36.53206214668623, 43.84040009272106, 200.19644311111344, 16.951783944312993, 308.47713383744906, 13.933089962974268, 0.0, 61.51073985918698, 4.92174808502431, 46.913780305461174, 33.342227873293766, 252.23774968258851, 127.68058364989234, 113.85693238695355, 283.6516254505228, 58.92766273518544, 180.04558129325142, 193.75148158032263, 187.86448100770673, 175.97289171189226, 171.51167119343776, 2.7907790899104965, 11.806204442707696, 79.96408746948303, 108.471541635764, 161.50058737702403, 22.682556295867297, 82.98385232913478, 3.445212159168821, 16.829357832071164, 47.70305545974213, 151.17081154115326, 28.530845196344533, 141.71834271879982, 65.37827733992057, 16.584330472389663, 53.896838042427134, 47.36007889239984, 463.5946190526087, 467.7279455527278, 18.569122893945323, 76.5537050775739, 26.981493806561254, 25.387162249985625, 0.0, 25.79948488080403, 0.0, 23.489079537163747, 6.236396383310534, 139.0350214350227, 1.6853791166377285, 131.5718073071418, 134.1836901763798, 101.21340756229544, 143.4642138277096, 169.01560017316189, 11.484304247026078, 12.485181331478486, 19.485426324931847, 19.57081646687986, 110.829219641208, 17.33699228029923, 146.7362596293699, 23.622366811104794, 60.389044160440164, 42.761183330366286, 95.1258021009065, 1.6001584011251573, 104.05837754088734, 102.59198986856026, 125.1114224756794, 92.20497829259457, 268.81299105442884, 94.63119993740298, 123.60198309094032, 406.29477879325543, 0.0, 29.638731705765732, 118.68207694591875, 170.69398972132203, 87.74911497058424, 201.55716823474535, 113.59533178821637, 25.050390362894326, 112.22540938862775, 48.07820735746489, 7.8382311225160874, 83.74347117398385, 3.307212563127208, 10.188329718242954, 283.1173216078932, 546.4980106039084, 491.2372365317478, 27.74822708140639, 111.94801215724225, 380.982031744992, 0.0, 141.98305805764824, 208.3920083557648, 65.26627203148045, 0.0, 74.73109663673031, 180.31596245294617, 6.906003101646402, 21.903654443686175, 24.88416926887736, 88.73087712256557, 17.35885741239815, 20.40170561077777, 16.43777778138759, 31.37361775483791, 12.500376563381923, 192.2506755047527, 89.49722973483696, 51.88223033985781, 18.89312945735562, 34.99874875674197, 27.069287745570293, 21.45333649359909, 40.93398315830192, 41.10940452342536, 84.76503032255596, 98.6686788248295, 7.086237023497516, 79.19805318359336, 103.82966028647772, 32.54439001550746, 36.437428597344905, 19.26776254005814, 43.99378115529842, 455.29744678675297, 146.92804132978122, 69.7432878163219, 56.769896673982714, 44.20902975831182, 58.15447846391526, 75.00526822744645, 12.341871385812933, 75.02308447463065, 86.18487737940345, 202.41754122740315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5411820172951751, "mean_inference_ms": 1.6604116911559268, "mean_action_processing_ms": 0.24543333610996135, "mean_env_wait_ms": 0.18405804329972367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037387609481811523, "StateBufferConnector_ms": 0.0030847787857055664, "ViewRequirementAgentConnector_ms": 0.09773612022399902}, "num_episodes": 22, "episode_return_max": 571.9308037349109, "episode_return_min": -280.94339042720856, "episode_return_mean": 110.38371173127678, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.435358352094, "num_env_steps_trained_throughput_per_sec": 400.435358352094, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 10362.9, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10362.863, "sample_time_ms": 1338.44, "learn_time_ms": 9010.766, "learn_throughput": 443.913, "synch_weights_time_ms": 12.38}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "74486_00000", "date": "2024-08-16_15-10-14", "timestamp": 1723801214, "time_this_iter_s": 9.994657039642334, "time_total_s": 882.4251370429993, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39737fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 882.4251370429993, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 37.41428571428571, "ram_util_percent": 80.77857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7848205415029375, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.559139417718958, "policy_loss": -0.0031432171796926507, "vf_loss": 5.561028689177578, "vf_explained_var": 0.49937130622762854, "kl": 0.01114640266582518, "entropy": 1.1227526324135917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3147609399582343, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.644540148689633, "policy_loss": -0.005363375560759946, "vf_loss": 2.6496541762478136, "vf_explained_var": 0.004738532613824915, "kl": 0.008866030940088566, "entropy": 0.6395742904887628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 571.9308037349109, "episode_reward_min": -384.92681323864673, "episode_reward_mean": 115.65893860074615, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -600.2738210051565, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.3184765784232, "predator_policy": 546.4980106039084}, "policy_reward_mean": {"prey_policy": -40.82376564322472, "predator_policy": 98.65323494359777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.2725717457472203, 201.06999999999954, 59.83999999999976, 3.829999999999962, 3.7599999999999634, 21.783090253260788, 128.21000000000032, 78.19097133198485, 63.90999999999994, 93.35000000000062, 104.65, 143.45000000000016, 27.01000000000028, 71.05000000000035, 3.9299999999999597, 2.6035029645750907, 90.77999999999996, -207.1501702942228, 23.370728383662755, 20.25000000000042, 92.43266702682801, 282.5585079624024, 5.9099999999999175, 128.08000000000024, 152.76000000000002, 3.639999999999963, 3.729999999999964, 3.4599999999999644, 98.36000000000065, 251.23567593493138, 128.78000000000011, 176.30000000000004, 158.13000000000005, 166.25000000000006, -8.783556188315256, 116.73000000000027, 119.46000000000053, 144.72999999999996, 138.01616092548647, 57.97999999999961, 3.8799999999999617, 9.539145798505192, 3.4899999999999647, 345.70660856734116, 149.0000000000003, 124.35000000000062, 140.6800000000003, 29.032681128003087, 186.32409617172084, -280.94339042720856, 277.3665897776747, 161.78999999999968, 246.49683812232536, 297.80039036289395, 5.7515143861678855, 12.622492124347165, 177.53999999999996, 571.9308037349109, 310.2964952716184, 105.67000000000023, 108.6309200931868, 128.64000000000033, 332.6201279119018, 154.36000000000033, 132.21000000000038, 176.09999999999997, 357.28, 3.479999999999968, 167.95999999999987, 174.51323344215427, 319.6099999999998, 361.6972186968239, 110.05000000000038, 173.05999999999972, 151.9200000000001, 269.87233606525524, 159.76000000000002, 353.0495524708881, 353.22425157679805, 255.27972760767082, 3.679999999999962, 153.10691831708857, 5.49456244906961, 181.5088374994166, 272.96999999999997, 118.68564015166984, -384.92681323864673, 322.41999999999985, 205.14999999999998, 156.67000000000002, 3.8799999999999617, 33.10324217754908, -251.06793324343147, 3.509999999999962, 166.14, -345.6433088624313, 163.97000000000014, 321.57, 19.15607538650262, 142.5000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-115.62715259658543, -145.18667977110775, -198.0643635703875, -17.517632869906887, -68.75002464245857, -62.49859514488247, 2.0000000000000013, -31.222291290878267, -71.52974332527717, -35.013320720489496, -33.62605874587565, -52.16658411125741, 7.992095773465929, -114.6459699212164, -45.299941208269786, -4.628053437177683, 49.581865875766745, -90.33901569299643, -196.28446556854527, -18.497554508590078, -312.429372160263, 48.161943443684436, 0.02423166468529654, 104.92793785331381, -41.95040009272144, -175.076443111114, 53.278216055686855, -307.6571338374493, -12.00308996297431, 2.0000000000000013, -43.14759881665055, -20.681386162985692, -45.12378030546138, 55.64777212670624, -240.66889060103617, -346.3996130256679, -107.60620400329056, -266.53162545052373, -71.50492803245109, -147.2183159959869, -165.6138142456335, -123.56948131557024, -145.92331541690038, 80.99726047397336, -0.8007790899105123, -7.8862044427077365, -11.814087469483198, -48.541541635763686, -88.16660138558905, 56.74345771269813, -81.32385232913396, -1.4652121591688512, -14.89935783207106, -45.903055459742404, -149.63081154115466, -26.610845196344233, -120.67666937149394, 11.940049312774317, 70.28825389164867, 110.46625352846648, 117.66010456636495, -499.83480251137325, -467.56794555272785, 157.57087710605464, 79.68629492242619, -25.09149380656096, 138.86283775001442, 2.0000000000000013, -15.391800560515962, -19.191240508602746, -21.589079537163474, 108.59360361668945, -21.56502143502262, 0.30462088336227294, -130.07180730714313, 9.046309823620255, -141.94421382771094, 35.28275336319105, -112.98560017316146, -9.53430424702612, -10.525181331478528, -17.565426324931547, -87.06798856675573, -33.79290174282645, -15.396992280299036, -145.18625962937125, 117.69031144555842, 144.00488615023806, 104.5688166696337, -93.45580210090566, 121.16984159887501, -102.47837754088653, -101.03198986855948, 14.008577524320593, -75.5992784049527, -256.3860098140686, -24.77728295239345, -7.131803904228292, -404.4769925077131, -282.761176712751, 36.55685474515597, 92.48892638083453, -206.70213205958044, 110.04902736767279, 2.0000000000000013, -70.65566190063498, 19.551215303612775, 140.9733753077594, -46.248207357465255, -3.916716736348164, -72.44296053109416, -1.9852310816687377, 166.011670281757, -281.7773216078944, 134.46937760440983, -600.2738210051565, 37.76003307576434, 132.84022295720567, 56.86924464150295, -332.18127638649474, -163.3069863228055, -78.43715999742183, 61.37372796851945, 2.0000000000000013, 13.988362963856178, 63.58470585836929, -4.936003101646444, 130.4863455563139, -22.994169268877066, 41.589122877434455, -17.56618193618603, 155.90561891301036, 159.7222222186124, 149.74638224516212, -10.550376563381965, -190.7206755047541, -87.7972297348361, 114.3777696601422, -8.335612126439258, 128.95696735449633, 139.1607122544297, 131.92666350640096, 124.69066758343963, 154.96316343165725, -10.517447120785938, -62.866262026599344, 164.16376297650243, -77.38805318359243, 34.390339713522266, -18.84439001550722, 144.80746366803288, 69.35968125982065, -474.84165467655623, 135.3104267345048, 183.3184765784232, -46.940253253638105, 114.05086202112447, 138.19446312337914, 118.87670941096812, 3.2432715053419066, -67.09027416557029, -16.594681694872147, -84.44979036423685, -51.045709925480566, 2.0000000000000013, -37.95634739276233, 91.54671609505982, -3.7898121861699305, 26.93984590998552, 148.254253193694, 2.0000000000000013, -39.77550029671755, -456.4042266402814, -436.3967496165254, 108.12444527471018, 127.02991910593221, -371.95458122233214, -43.5187626784372, 53.34576433086512, -205.16337288359722, -12.003780834700775, -6.0390007129640155, -305.7819913627579, -145.66335211192097, -337.06376779777275, -273.12819345112985, -201.81539730878515, 0.170743059135757, -2.4785193332900537, 83.82049898866264, -459.0201829586548, -423.81840037847934, -80.82009226790018, 116.60293624132676, 147.29027195548858, 72.00288773246953, -23.753220383365992, -97.44009929328868, -2.325111354940347, 115.50091212594123], "policy_predator_policy_reward": [224.32000101637803, 35.22125960556751, 253.8947728781766, 162.75722356211722, 102.63386976557572, 88.45475002176516, 0.0, 33.0522912908782, 73.41974332527813, 36.883320720489124, 87.85478645647224, 19.720946653920386, 118.40790422653421, 116.45596992121733, 109.66075623561505, 18.45820974181711, 12.738134124233175, 91.92901569299701, 164.97348409675004, 143.1585359803854, 5.168838248814683, 363.74859046776356, 1.965768335314705, 36.53206214668623, 43.84040009272106, 200.19644311111344, 16.951783944312993, 308.47713383744906, 13.933089962974268, 0.0, 61.51073985918698, 4.92174808502431, 46.913780305461174, 33.342227873293766, 252.23774968258851, 127.68058364989234, 113.85693238695355, 283.6516254505228, 58.92766273518544, 180.04558129325142, 193.75148158032263, 187.86448100770673, 175.97289171189226, 171.51167119343776, 2.7907790899104965, 11.806204442707696, 79.96408746948303, 108.471541635764, 161.50058737702403, 22.682556295867297, 82.98385232913478, 3.445212159168821, 16.829357832071164, 47.70305545974213, 151.17081154115326, 28.530845196344533, 141.71834271879982, 65.37827733992057, 16.584330472389663, 53.896838042427134, 47.36007889239984, 463.5946190526087, 467.7279455527278, 18.569122893945323, 76.5537050775739, 26.981493806561254, 25.387162249985625, 0.0, 25.79948488080403, 0.0, 23.489079537163747, 6.236396383310534, 139.0350214350227, 1.6853791166377285, 131.5718073071418, 134.1836901763798, 101.21340756229544, 143.4642138277096, 169.01560017316189, 11.484304247026078, 12.485181331478486, 19.485426324931847, 19.57081646687986, 110.829219641208, 17.33699228029923, 146.7362596293699, 23.622366811104794, 60.389044160440164, 42.761183330366286, 95.1258021009065, 1.6001584011251573, 104.05837754088734, 102.59198986856026, 125.1114224756794, 92.20497829259457, 268.81299105442884, 94.63119993740298, 123.60198309094032, 406.29477879325543, 0.0, 29.638731705765732, 118.68207694591875, 170.69398972132203, 87.74911497058424, 201.55716823474535, 113.59533178821637, 25.050390362894326, 112.22540938862775, 48.07820735746489, 7.8382311225160874, 83.74347117398385, 3.307212563127208, 10.188329718242954, 283.1173216078932, 546.4980106039084, 491.2372365317478, 27.74822708140639, 111.94801215724225, 380.982031744992, 0.0, 141.98305805764824, 208.3920083557648, 65.26627203148045, 0.0, 74.73109663673031, 180.31596245294617, 6.906003101646402, 21.903654443686175, 24.88416926887736, 88.73087712256557, 17.35885741239815, 20.40170561077777, 16.43777778138759, 31.37361775483791, 12.500376563381923, 192.2506755047527, 89.49722973483696, 51.88223033985781, 18.89312945735562, 34.99874875674197, 27.069287745570293, 21.45333649359909, 40.93398315830192, 41.10940452342536, 84.76503032255596, 98.6686788248295, 7.086237023497516, 79.19805318359336, 103.82966028647772, 32.54439001550746, 36.437428597344905, 19.26776254005814, 43.99378115529842, 455.29744678675297, 146.92804132978122, 69.7432878163219, 56.769896673982714, 44.20902975831182, 58.15447846391526, 75.00526822744645, 12.341871385812933, 75.02308447463065, 86.18487737940345, 202.41754122740315, 34.331619521789236, 7.119290320042435, 46.40170575235652, 47.35022783817, 69.91015409001437, 27.865746806305996, 4.496770027239062, 151.96437042114795, 2.130182286493861, 505.7439807316662, 54.06465461015385, 33.20098100920379, 361.0646667052459, 259.55867719552356, 101.78423566913494, 206.70337288359582, 6.71444985770667, 15.20833168995804, 296.0285935253816, 188.51999212684316, 349.3513599746713, 9.77266803079903, 203.3353973087838, 1.8192569408642445, 4.4485193332900135, 80.3495010113374, 1.5823052262622879, 535.6129692484409, 82.56009226790106, 45.62706375867326, 8.12972804451136, 94.14711226753053, 41.12929576986842, 99.22009929328959, 4.305111354940305, 25.0190878740588]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5409517076046875, "mean_inference_ms": 1.6603822494208682, "mean_action_processing_ms": 0.2451946109231268, "mean_env_wait_ms": 0.18393738583178745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003712773323059082, "StateBufferConnector_ms": 0.003057122230529785, "ViewRequirementAgentConnector_ms": 0.09612679481506348}, "num_episodes": 18, "episode_return_max": 571.9308037349109, "episode_return_min": -384.92681323864673, "episode_return_mean": 115.65893860074615, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.0059431621687, "num_env_steps_trained_throughput_per_sec": 403.0059431621687, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 10313.34, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10313.304, "sample_time_ms": 1327.92, "learn_time_ms": 8971.67, "learn_throughput": 445.848, "synch_weights_time_ms": 12.618}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "74486_00000", "date": "2024-08-16_15-10-24", "timestamp": 1723801224, "time_this_iter_s": 9.93152117729187, "time_total_s": 892.3566582202911, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3973a6f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 892.3566582202911, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 29.3, "ram_util_percent": 80.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.27117423815702, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.716086605743126, "policy_loss": -0.004348451668450796, "vf_loss": 4.7190437140288175, "vf_explained_var": 0.6279083780826085, "kl": 0.012367606622034937, "entropy": 1.134764960077074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.098370152727637, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2011744613369935, "policy_loss": -0.006134057747170566, "vf_loss": 2.206972396941412, "vf_explained_var": -0.0003564573784984609, "kl": 0.011950787552462433, "entropy": 0.628191007697393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 571.9308037349109, "episode_reward_min": -384.92681323864673, "episode_reward_mean": 140.18156164730678, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -600.2738210051565, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.3184765784232, "predator_policy": 546.4980106039084}, "policy_reward_mean": {"prey_policy": -21.970576398341358, "predator_policy": 92.06135722199475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.08000000000024, 152.76000000000002, 3.639999999999963, 3.729999999999964, 3.4599999999999644, 98.36000000000065, 251.23567593493138, 128.78000000000011, 176.30000000000004, 158.13000000000005, 166.25000000000006, -8.783556188315256, 116.73000000000027, 119.46000000000053, 144.72999999999996, 138.01616092548647, 57.97999999999961, 3.8799999999999617, 9.539145798505192, 3.4899999999999647, 345.70660856734116, 149.0000000000003, 124.35000000000062, 140.6800000000003, 29.032681128003087, 186.32409617172084, -280.94339042720856, 277.3665897776747, 161.78999999999968, 246.49683812232536, 297.80039036289395, 5.7515143861678855, 12.622492124347165, 177.53999999999996, 571.9308037349109, 310.2964952716184, 105.67000000000023, 108.6309200931868, 128.64000000000033, 332.6201279119018, 154.36000000000033, 132.21000000000038, 176.09999999999997, 357.28, 3.479999999999968, 167.95999999999987, 174.51323344215427, 319.6099999999998, 361.6972186968239, 110.05000000000038, 173.05999999999972, 151.9200000000001, 269.87233606525524, 159.76000000000002, 353.0495524708881, 353.22425157679805, 255.27972760767082, 3.679999999999962, 153.10691831708857, 5.49456244906961, 181.5088374994166, 272.96999999999997, 118.68564015166984, -384.92681323864673, 322.41999999999985, 205.14999999999998, 156.67000000000002, 3.8799999999999617, 33.10324217754908, -251.06793324343147, 3.509999999999962, 166.14, -345.6433088624313, 163.97000000000014, 321.57, 19.15607538650262, 142.5000000000001, 113.7700000000005, 246.08186652509448, 163.03999999999945, 131.33000000000035, 193.80999999999966, 85.53560184788246, 329.54999999999956, 220.6699999999999, 227.58290292094938, 171.0699999999997, 3.979999999999959, 127.53431958414045, 253.19999999999956, 3.589999999999965, 158.82000000000002, 182.79999999999978, 236.27134142452417, 59.37420491210455, 193.76039941826087, 130.64000000000033, 121.56000000000014, 299.97336449337723, 111.83502941247538], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.814087469483198, -48.541541635763686, -88.16660138558905, 56.74345771269813, -81.32385232913396, -1.4652121591688512, -14.89935783207106, -45.903055459742404, -149.63081154115466, -26.610845196344233, -120.67666937149394, 11.940049312774317, 70.28825389164867, 110.46625352846648, 117.66010456636495, -499.83480251137325, -467.56794555272785, 157.57087710605464, 79.68629492242619, -25.09149380656096, 138.86283775001442, 2.0000000000000013, -15.391800560515962, -19.191240508602746, -21.589079537163474, 108.59360361668945, -21.56502143502262, 0.30462088336227294, -130.07180730714313, 9.046309823620255, -141.94421382771094, 35.28275336319105, -112.98560017316146, -9.53430424702612, -10.525181331478528, -17.565426324931547, -87.06798856675573, -33.79290174282645, -15.396992280299036, -145.18625962937125, 117.69031144555842, 144.00488615023806, 104.5688166696337, -93.45580210090566, 121.16984159887501, -102.47837754088653, -101.03198986855948, 14.008577524320593, -75.5992784049527, -256.3860098140686, -24.77728295239345, -7.131803904228292, -404.4769925077131, -282.761176712751, 36.55685474515597, 92.48892638083453, -206.70213205958044, 110.04902736767279, 2.0000000000000013, -70.65566190063498, 19.551215303612775, 140.9733753077594, -46.248207357465255, -3.916716736348164, -72.44296053109416, -1.9852310816687377, 166.011670281757, -281.7773216078944, 134.46937760440983, -600.2738210051565, 37.76003307576434, 132.84022295720567, 56.86924464150295, -332.18127638649474, -163.3069863228055, -78.43715999742183, 61.37372796851945, 2.0000000000000013, 13.988362963856178, 63.58470585836929, -4.936003101646444, 130.4863455563139, -22.994169268877066, 41.589122877434455, -17.56618193618603, 155.90561891301036, 159.7222222186124, 149.74638224516212, -10.550376563381965, -190.7206755047541, -87.7972297348361, 114.3777696601422, -8.335612126439258, 128.95696735449633, 139.1607122544297, 131.92666350640096, 124.69066758343963, 154.96316343165725, -10.517447120785938, -62.866262026599344, 164.16376297650243, -77.38805318359243, 34.390339713522266, -18.84439001550722, 144.80746366803288, 69.35968125982065, -474.84165467655623, 135.3104267345048, 183.3184765784232, -46.940253253638105, 114.05086202112447, 138.19446312337914, 118.87670941096812, 3.2432715053419066, -67.09027416557029, -16.594681694872147, -84.44979036423685, -51.045709925480566, 2.0000000000000013, -37.95634739276233, 91.54671609505982, -3.7898121861699305, 26.93984590998552, 148.254253193694, 2.0000000000000013, -39.77550029671755, -456.4042266402814, -436.3967496165254, 108.12444527471018, 127.02991910593221, -371.95458122233214, -43.5187626784372, 53.34576433086512, -205.16337288359722, -12.003780834700775, -6.0390007129640155, -305.7819913627579, -145.66335211192097, -337.06376779777275, -273.12819345112985, -201.81539730878515, 0.170743059135757, -2.4785193332900537, 83.82049898866264, -459.0201829586548, -423.81840037847934, -80.82009226790018, 116.60293624132676, 147.29027195548858, 72.00288773246953, -23.753220383365992, -97.44009929328868, -2.325111354940347, 115.50091212594123, 88.60119519229006, -26.949640078436758, -194.7510110130924, 94.43365112579598, 146.28674374238895, -133.85396761024003, 39.35400344307649, -34.12990403890568, 182.50216316877876, -61.3392051985453, -153.77259277980156, 2.0000000000000013, 125.33111610192479, 152.8995723096028, 116.97117940128179, 72.22659832790595, 100.07051272214711, 59.05798703498553, 114.09865097822552, -2.78720853548349, 2.0000000000000013, -2.350645829900502, -51.23038151174758, -15.591489733971873, 112.5367846390153, 32.15279536713676, -174.83751107979916, -35.05328027495731, -78.72597905392958, -28.209952801913232, -108.39124937723804, 138.93274287203377, 14.194925402403669, -10.331852744291814, -31.1685220463061, -88.04047313540892, -7.2442050105618865, 129.24762177419075, 128.72000000000003, -17.528957430231323, 103.90047639308372, -342.35818456023384, 106.48583696635276, 117.47354510142969, -84.3843416944583, -203.8881974758416], "policy_predator_policy_reward": [79.96408746948303, 108.471541635764, 161.50058737702403, 22.682556295867297, 82.98385232913478, 3.445212159168821, 16.829357832071164, 47.70305545974213, 151.17081154115326, 28.530845196344533, 141.71834271879982, 65.37827733992057, 16.584330472389663, 53.896838042427134, 47.36007889239984, 463.5946190526087, 467.7279455527278, 18.569122893945323, 76.5537050775739, 26.981493806561254, 25.387162249985625, 0.0, 25.79948488080403, 0.0, 23.489079537163747, 6.236396383310534, 139.0350214350227, 1.6853791166377285, 131.5718073071418, 134.1836901763798, 101.21340756229544, 143.4642138277096, 169.01560017316189, 11.484304247026078, 12.485181331478486, 19.485426324931847, 19.57081646687986, 110.829219641208, 17.33699228029923, 146.7362596293699, 23.622366811104794, 60.389044160440164, 42.761183330366286, 95.1258021009065, 1.6001584011251573, 104.05837754088734, 102.59198986856026, 125.1114224756794, 92.20497829259457, 268.81299105442884, 94.63119993740298, 123.60198309094032, 406.29477879325543, 0.0, 29.638731705765732, 118.68207694591875, 170.69398972132203, 87.74911497058424, 201.55716823474535, 113.59533178821637, 25.050390362894326, 112.22540938862775, 48.07820735746489, 7.8382311225160874, 83.74347117398385, 3.307212563127208, 10.188329718242954, 283.1173216078932, 546.4980106039084, 491.2372365317478, 27.74822708140639, 111.94801215724225, 380.982031744992, 0.0, 141.98305805764824, 208.3920083557648, 65.26627203148045, 0.0, 74.73109663673031, 180.31596245294617, 6.906003101646402, 21.903654443686175, 24.88416926887736, 88.73087712256557, 17.35885741239815, 20.40170561077777, 16.43777778138759, 31.37361775483791, 12.500376563381923, 192.2506755047527, 89.49722973483696, 51.88223033985781, 18.89312945735562, 34.99874875674197, 27.069287745570293, 21.45333649359909, 40.93398315830192, 41.10940452342536, 84.76503032255596, 98.6686788248295, 7.086237023497516, 79.19805318359336, 103.82966028647772, 32.54439001550746, 36.437428597344905, 19.26776254005814, 43.99378115529842, 455.29744678675297, 146.92804132978122, 69.7432878163219, 56.769896673982714, 44.20902975831182, 58.15447846391526, 75.00526822744645, 12.341871385812933, 75.02308447463065, 86.18487737940345, 202.41754122740315, 34.331619521789236, 7.119290320042435, 46.40170575235652, 47.35022783817, 69.91015409001437, 27.865746806305996, 4.496770027239062, 151.96437042114795, 2.130182286493861, 505.7439807316662, 54.06465461015385, 33.20098100920379, 361.0646667052459, 259.55867719552356, 101.78423566913494, 206.70337288359582, 6.71444985770667, 15.20833168995804, 296.0285935253816, 188.51999212684316, 349.3513599746713, 9.77266803079903, 203.3353973087838, 1.8192569408642445, 4.4485193332900135, 80.3495010113374, 1.5823052262622879, 535.6129692484409, 82.56009226790106, 45.62706375867326, 8.12972804451136, 94.14711226753053, 41.12929576986842, 99.22009929328959, 4.305111354940305, 25.0190878740588, 23.218804807710132, 28.899640078437063, 278.30387433920936, 68.09535207318164, 15.033256257610912, 135.5739676102385, 90.13599655692371, 35.96990403890532, 9.547836831221241, 63.099205198544986, 127.54492282854864, 109.76327179913227, 38.918883898075165, 12.400427690397127, 4.593341804701019, 26.878880466111323, 6.066455497621334, 62.38794766619538, 54.99134902177454, 4.767208535483448, 0.0, 4.33064582990046, 31.517882720286842, 162.83830810957323, 1.9847989665915409, 106.52562102725665, 176.50751107979764, 36.97328027495693, 80.5159790539305, 185.23995280191323, 110.16124937723895, 42.09725712796623, 122.2395352941593, 110.16873347225393, 98.32512371563597, 80.25807637818491, 23.10584048773312, 48.65114216689916, 0.0, 19.448957430231612, 314.512518124691, 45.505190042459, 8.799830956330217, 67.21415146926462, 44.45118564657387, 355.65638293620066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5406166463420814, "mean_inference_ms": 1.6601970289435848, "mean_action_processing_ms": 0.24485716762768228, "mean_env_wait_ms": 0.1837438244146469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003648996353149414, "StateBufferConnector_ms": 0.0029387474060058594, "ViewRequirementAgentConnector_ms": 0.0918656587600708}, "num_episodes": 23, "episode_return_max": 571.9308037349109, "episode_return_min": -384.92681323864673, "episode_return_mean": 140.18156164730678, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.5816646561667, "num_env_steps_trained_throughput_per_sec": 396.5816646561667, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 10276.396, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10276.361, "sample_time_ms": 1335.488, "learn_time_ms": 8926.986, "learn_throughput": 448.08, "synch_weights_time_ms": 12.884}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "74486_00000", "date": "2024-08-16_15-10-34", "timestamp": 1723801234, "time_this_iter_s": 10.090196371078491, "time_total_s": 902.4468545913696, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3973a6ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 902.4468545913696, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 34.31428571428572, "ram_util_percent": 80.41428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.783736265210248, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.609551658579912, "policy_loss": -0.007506516281387241, "vf_loss": 5.615855763955091, "vf_explained_var": 0.2848387382963978, "kl": 0.010688140717079984, "entropy": 1.125953701942686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3643745823985054, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6850671452819985, "policy_loss": -0.003829940896796644, "vf_loss": 3.6887131379394935, "vf_explained_var": 0.00741356437799161, "kl": 0.006540198391147506, "entropy": 0.5933312910101401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 571.9308037349109, "episode_reward_min": -384.92681323864673, "episode_reward_mean": 149.87818985374835, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -740.4331090988611, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.3184765784232, "predator_policy": 737.1135592638095}, "policy_reward_mean": {"prey_policy": -23.99009926684545, "predator_policy": 98.9291941937196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.539145798505192, 3.4899999999999647, 345.70660856734116, 149.0000000000003, 124.35000000000062, 140.6800000000003, 29.032681128003087, 186.32409617172084, -280.94339042720856, 277.3665897776747, 161.78999999999968, 246.49683812232536, 297.80039036289395, 5.7515143861678855, 12.622492124347165, 177.53999999999996, 571.9308037349109, 310.2964952716184, 105.67000000000023, 108.6309200931868, 128.64000000000033, 332.6201279119018, 154.36000000000033, 132.21000000000038, 176.09999999999997, 357.28, 3.479999999999968, 167.95999999999987, 174.51323344215427, 319.6099999999998, 361.6972186968239, 110.05000000000038, 173.05999999999972, 151.9200000000001, 269.87233606525524, 159.76000000000002, 353.0495524708881, 353.22425157679805, 255.27972760767082, 3.679999999999962, 153.10691831708857, 5.49456244906961, 181.5088374994166, 272.96999999999997, 118.68564015166984, -384.92681323864673, 322.41999999999985, 205.14999999999998, 156.67000000000002, 3.8799999999999617, 33.10324217754908, -251.06793324343147, 3.509999999999962, 166.14, -345.6433088624313, 163.97000000000014, 321.57, 19.15607538650262, 142.5000000000001, 113.7700000000005, 246.08186652509448, 163.03999999999945, 131.33000000000035, 193.80999999999966, 85.53560184788246, 329.54999999999956, 220.6699999999999, 227.58290292094938, 171.0699999999997, 3.979999999999959, 127.53431958414045, 253.19999999999956, 3.589999999999965, 158.82000000000002, 182.79999999999978, 236.27134142452417, 59.37420491210455, 193.76039941826087, 130.64000000000033, 121.56000000000014, 299.97336449337723, 111.83502941247538, 187.88000000000014, 156.00000000000023, 133.20000000000005, 3.8899999999999606, 341.82961322596685, 118.88000000000044, 143.89000000000038, 291.79424943912744, 33.739999999999995, 124.1500000000001, 3.8799999999999604, 83.43000000000018, 326.64999999999964, 151.38999999999965, 164.18, 273.34, 270.9253504311572, 3.3518882200072175], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-87.06798856675573, -33.79290174282645, -15.396992280299036, -145.18625962937125, 117.69031144555842, 144.00488615023806, 104.5688166696337, -93.45580210090566, 121.16984159887501, -102.47837754088653, -101.03198986855948, 14.008577524320593, -75.5992784049527, -256.3860098140686, -24.77728295239345, -7.131803904228292, -404.4769925077131, -282.761176712751, 36.55685474515597, 92.48892638083453, -206.70213205958044, 110.04902736767279, 2.0000000000000013, -70.65566190063498, 19.551215303612775, 140.9733753077594, -46.248207357465255, -3.916716736348164, -72.44296053109416, -1.9852310816687377, 166.011670281757, -281.7773216078944, 134.46937760440983, -600.2738210051565, 37.76003307576434, 132.84022295720567, 56.86924464150295, -332.18127638649474, -163.3069863228055, -78.43715999742183, 61.37372796851945, 2.0000000000000013, 13.988362963856178, 63.58470585836929, -4.936003101646444, 130.4863455563139, -22.994169268877066, 41.589122877434455, -17.56618193618603, 155.90561891301036, 159.7222222186124, 149.74638224516212, -10.550376563381965, -190.7206755047541, -87.7972297348361, 114.3777696601422, -8.335612126439258, 128.95696735449633, 139.1607122544297, 131.92666350640096, 124.69066758343963, 154.96316343165725, -10.517447120785938, -62.866262026599344, 164.16376297650243, -77.38805318359243, 34.390339713522266, -18.84439001550722, 144.80746366803288, 69.35968125982065, -474.84165467655623, 135.3104267345048, 183.3184765784232, -46.940253253638105, 114.05086202112447, 138.19446312337914, 118.87670941096812, 3.2432715053419066, -67.09027416557029, -16.594681694872147, -84.44979036423685, -51.045709925480566, 2.0000000000000013, -37.95634739276233, 91.54671609505982, -3.7898121861699305, 26.93984590998552, 148.254253193694, 2.0000000000000013, -39.77550029671755, -456.4042266402814, -436.3967496165254, 108.12444527471018, 127.02991910593221, -371.95458122233214, -43.5187626784372, 53.34576433086512, -205.16337288359722, -12.003780834700775, -6.0390007129640155, -305.7819913627579, -145.66335211192097, -337.06376779777275, -273.12819345112985, -201.81539730878515, 0.170743059135757, -2.4785193332900537, 83.82049898866264, -459.0201829586548, -423.81840037847934, -80.82009226790018, 116.60293624132676, 147.29027195548858, 72.00288773246953, -23.753220383365992, -97.44009929328868, -2.325111354940347, 115.50091212594123, 88.60119519229006, -26.949640078436758, -194.7510110130924, 94.43365112579598, 146.28674374238895, -133.85396761024003, 39.35400344307649, -34.12990403890568, 182.50216316877876, -61.3392051985453, -153.77259277980156, 2.0000000000000013, 125.33111610192479, 152.8995723096028, 116.97117940128179, 72.22659832790595, 100.07051272214711, 59.05798703498553, 114.09865097822552, -2.78720853548349, 2.0000000000000013, -2.350645829900502, -51.23038151174758, -15.591489733971873, 112.5367846390153, 32.15279536713676, -174.83751107979916, -35.05328027495731, -78.72597905392958, -28.209952801913232, -108.39124937723804, 138.93274287203377, 14.194925402403669, -10.331852744291814, -31.1685220463061, -88.04047313540892, -7.2442050105618865, 129.24762177419075, 128.72000000000003, -17.528957430231323, 103.90047639308372, -342.35818456023384, 106.48583696635276, 117.47354510142969, -84.3843416944583, -203.8881974758416, 135.7435769742137, -27.786927657404135, 106.09133597532353, -81.96599183345458, 51.55598133709772, -41.854700460238995, -10.73701726760924, -8.427617620100415, 87.73778457508863, 45.24410527990935, -180.1253675883359, -139.18819472761146, 50.267418427842145, -108.40277051163281, -49.50102323871072, 132.87605839392478, -687.8452002106401, -373.05868223292714, -210.01465244731122, -93.76555104731591, -12.120168625211667, -10.057120849075774, 81.18189178543957, -740.4331090988611, 182.61290466352494, 123.58242684194495, -5.7882208474324415, 123.02587228006148, -15.541348473158756, 132.73431856131114, -57.32245571917305, 4.6665466713388355, 150.23850945940512, -64.78484589302458, -54.55729761787394, -21.629575986192428], "policy_predator_policy_reward": [19.57081646687986, 110.829219641208, 17.33699228029923, 146.7362596293699, 23.622366811104794, 60.389044160440164, 42.761183330366286, 95.1258021009065, 1.6001584011251573, 104.05837754088734, 102.59198986856026, 125.1114224756794, 92.20497829259457, 268.81299105442884, 94.63119993740298, 123.60198309094032, 406.29477879325543, 0.0, 29.638731705765732, 118.68207694591875, 170.69398972132203, 87.74911497058424, 201.55716823474535, 113.59533178821637, 25.050390362894326, 112.22540938862775, 48.07820735746489, 7.8382311225160874, 83.74347117398385, 3.307212563127208, 10.188329718242954, 283.1173216078932, 546.4980106039084, 491.2372365317478, 27.74822708140639, 111.94801215724225, 380.982031744992, 0.0, 141.98305805764824, 208.3920083557648, 65.26627203148045, 0.0, 74.73109663673031, 180.31596245294617, 6.906003101646402, 21.903654443686175, 24.88416926887736, 88.73087712256557, 17.35885741239815, 20.40170561077777, 16.43777778138759, 31.37361775483791, 12.500376563381923, 192.2506755047527, 89.49722973483696, 51.88223033985781, 18.89312945735562, 34.99874875674197, 27.069287745570293, 21.45333649359909, 40.93398315830192, 41.10940452342536, 84.76503032255596, 98.6686788248295, 7.086237023497516, 79.19805318359336, 103.82966028647772, 32.54439001550746, 36.437428597344905, 19.26776254005814, 43.99378115529842, 455.29744678675297, 146.92804132978122, 69.7432878163219, 56.769896673982714, 44.20902975831182, 58.15447846391526, 75.00526822744645, 12.341871385812933, 75.02308447463065, 86.18487737940345, 202.41754122740315, 34.331619521789236, 7.119290320042435, 46.40170575235652, 47.35022783817, 69.91015409001437, 27.865746806305996, 4.496770027239062, 151.96437042114795, 2.130182286493861, 505.7439807316662, 54.06465461015385, 33.20098100920379, 361.0646667052459, 259.55867719552356, 101.78423566913494, 206.70337288359582, 6.71444985770667, 15.20833168995804, 296.0285935253816, 188.51999212684316, 349.3513599746713, 9.77266803079903, 203.3353973087838, 1.8192569408642445, 4.4485193332900135, 80.3495010113374, 1.5823052262622879, 535.6129692484409, 82.56009226790106, 45.62706375867326, 8.12972804451136, 94.14711226753053, 41.12929576986842, 99.22009929328959, 4.305111354940305, 25.0190878740588, 23.218804807710132, 28.899640078437063, 278.30387433920936, 68.09535207318164, 15.033256257610912, 135.5739676102385, 90.13599655692371, 35.96990403890532, 9.547836831221241, 63.099205198544986, 127.54492282854864, 109.76327179913227, 38.918883898075165, 12.400427690397127, 4.593341804701019, 26.878880466111323, 6.066455497621334, 62.38794766619538, 54.99134902177454, 4.767208535483448, 0.0, 4.33064582990046, 31.517882720286842, 162.83830810957323, 1.9847989665915409, 106.52562102725665, 176.50751107979764, 36.97328027495693, 80.5159790539305, 185.23995280191323, 110.16124937723895, 42.09725712796623, 122.2395352941593, 110.16873347225393, 98.32512371563597, 80.25807637818491, 23.10584048773312, 48.65114216689916, 0.0, 19.448957430231612, 314.512518124691, 45.505190042459, 8.799830956330217, 67.21415146926462, 44.45118564657387, 355.65638293620066, 20.616423025786215, 59.30692765740383, 48.14866402467651, 83.72599183345548, 79.81401866290227, 43.684700460238666, 6.519610787242209, 16.53502410046736, 93.33646008989307, 115.51126328107588, 297.2453675883359, 140.94819472760986, 91.97258157215789, 110.05277051163363, 174.37098380652577, 34.048230477388124, 720.99520021064, 373.6486822329266, 211.06465244731098, 216.86555104731585, 14.050168625211626, 12.007120849075735, 737.1135592638095, 5.567658049612254, 3.507095336474959, 16.947573158055093, 7.7482208474324, 26.40412771993875, 17.481348473158974, 29.505681438688875, 160.99834549238685, 164.99756355544747, 182.98353858464137, 2.488148280135491, 59.725602545299274, 19.813159278774258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5403301902057926, "mean_inference_ms": 1.6600503914140896, "mean_action_processing_ms": 0.24461196030985705, "mean_env_wait_ms": 0.18358835936948834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036629438400268555, "StateBufferConnector_ms": 0.0029401779174804688, "ViewRequirementAgentConnector_ms": 0.09227490425109863}, "num_episodes": 18, "episode_return_max": 571.9308037349109, "episode_return_min": -384.92681323864673, "episode_return_mean": 149.87818985374835, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.8435042347544, "num_env_steps_trained_throughput_per_sec": 398.8435042347544, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 10200.006, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10199.97, "sample_time_ms": 1309.72, "learn_time_ms": 8876.322, "learn_throughput": 450.637, "synch_weights_time_ms": 13.004}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "74486_00000", "date": "2024-08-16_15-10-45", "timestamp": 1723801245, "time_this_iter_s": 10.034885168075562, "time_total_s": 912.4817397594452, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3980b7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 912.4817397594452, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 32.38, "ram_util_percent": 80.24666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9556239690099444, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.464384037098557, "policy_loss": -0.0060897650256279915, "vf_loss": 5.469130488804408, "vf_explained_var": 0.2290785096309803, "kl": 0.011940572476158335, "entropy": 1.1054447400506842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7582585927985963, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8018126088475426, "policy_loss": -0.0035601307131675262, "vf_loss": 2.8051255289208954, "vf_explained_var": 0.005813793751297805, "kl": 0.008789820442007707, "entropy": 0.6118238914580573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 365.19709235630285, "episode_reward_min": -412.8893087361584, "episode_reward_mean": 143.87613872479184, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -740.4331090988611, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.3184765784232, "predator_policy": 737.1135592638095}, "policy_reward_mean": {"prey_policy": -28.083509865456534, "predator_policy": 100.02157922785246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [154.36000000000033, 132.21000000000038, 176.09999999999997, 357.28, 3.479999999999968, 167.95999999999987, 174.51323344215427, 319.6099999999998, 361.6972186968239, 110.05000000000038, 173.05999999999972, 151.9200000000001, 269.87233606525524, 159.76000000000002, 353.0495524708881, 353.22425157679805, 255.27972760767082, 3.679999999999962, 153.10691831708857, 5.49456244906961, 181.5088374994166, 272.96999999999997, 118.68564015166984, -384.92681323864673, 322.41999999999985, 205.14999999999998, 156.67000000000002, 3.8799999999999617, 33.10324217754908, -251.06793324343147, 3.509999999999962, 166.14, -345.6433088624313, 163.97000000000014, 321.57, 19.15607538650262, 142.5000000000001, 113.7700000000005, 246.08186652509448, 163.03999999999945, 131.33000000000035, 193.80999999999966, 85.53560184788246, 329.54999999999956, 220.6699999999999, 227.58290292094938, 171.0699999999997, 3.979999999999959, 127.53431958414045, 253.19999999999956, 3.589999999999965, 158.82000000000002, 182.79999999999978, 236.27134142452417, 59.37420491210455, 193.76039941826087, 130.64000000000033, 121.56000000000014, 299.97336449337723, 111.83502941247538, 187.88000000000014, 156.00000000000023, 133.20000000000005, 3.8899999999999606, 341.82961322596685, 118.88000000000044, 143.89000000000038, 291.79424943912744, 33.739999999999995, 124.1500000000001, 3.8799999999999604, 83.43000000000018, 326.64999999999964, 151.38999999999965, 164.18, 273.34, 270.9253504311572, 3.3518882200072175, 219.95785207841712, 110.38000000000054, -155.95279165850548, 139.71000000000004, 120.58000000000042, 3.8799999999999604, 3.9199999999999613, 145.88000000000002, -412.8893087361584, 302.1550062917856, 294.0, 221.48000000000013, 242.31999999999988, 127.41965157450149, 137.43000000000004, 189.43212115445354, 322.39849253031207, 81.45346203753802, 179.1599999999998, 365.19709235630285, 3.8699999999999615, 202.34862249909253], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.936003101646444, 130.4863455563139, -22.994169268877066, 41.589122877434455, -17.56618193618603, 155.90561891301036, 159.7222222186124, 149.74638224516212, -10.550376563381965, -190.7206755047541, -87.7972297348361, 114.3777696601422, -8.335612126439258, 128.95696735449633, 139.1607122544297, 131.92666350640096, 124.69066758343963, 154.96316343165725, -10.517447120785938, -62.866262026599344, 164.16376297650243, -77.38805318359243, 34.390339713522266, -18.84439001550722, 144.80746366803288, 69.35968125982065, -474.84165467655623, 135.3104267345048, 183.3184765784232, -46.940253253638105, 114.05086202112447, 138.19446312337914, 118.87670941096812, 3.2432715053419066, -67.09027416557029, -16.594681694872147, -84.44979036423685, -51.045709925480566, 2.0000000000000013, -37.95634739276233, 91.54671609505982, -3.7898121861699305, 26.93984590998552, 148.254253193694, 2.0000000000000013, -39.77550029671755, -456.4042266402814, -436.3967496165254, 108.12444527471018, 127.02991910593221, -371.95458122233214, -43.5187626784372, 53.34576433086512, -205.16337288359722, -12.003780834700775, -6.0390007129640155, -305.7819913627579, -145.66335211192097, -337.06376779777275, -273.12819345112985, -201.81539730878515, 0.170743059135757, -2.4785193332900537, 83.82049898866264, -459.0201829586548, -423.81840037847934, -80.82009226790018, 116.60293624132676, 147.29027195548858, 72.00288773246953, -23.753220383365992, -97.44009929328868, -2.325111354940347, 115.50091212594123, 88.60119519229006, -26.949640078436758, -194.7510110130924, 94.43365112579598, 146.28674374238895, -133.85396761024003, 39.35400344307649, -34.12990403890568, 182.50216316877876, -61.3392051985453, -153.77259277980156, 2.0000000000000013, 125.33111610192479, 152.8995723096028, 116.97117940128179, 72.22659832790595, 100.07051272214711, 59.05798703498553, 114.09865097822552, -2.78720853548349, 2.0000000000000013, -2.350645829900502, -51.23038151174758, -15.591489733971873, 112.5367846390153, 32.15279536713676, -174.83751107979916, -35.05328027495731, -78.72597905392958, -28.209952801913232, -108.39124937723804, 138.93274287203377, 14.194925402403669, -10.331852744291814, -31.1685220463061, -88.04047313540892, -7.2442050105618865, 129.24762177419075, 128.72000000000003, -17.528957430231323, 103.90047639308372, -342.35818456023384, 106.48583696635276, 117.47354510142969, -84.3843416944583, -203.8881974758416, 135.7435769742137, -27.786927657404135, 106.09133597532353, -81.96599183345458, 51.55598133709772, -41.854700460238995, -10.73701726760924, -8.427617620100415, 87.73778457508863, 45.24410527990935, -180.1253675883359, -139.18819472761146, 50.267418427842145, -108.40277051163281, -49.50102323871072, 132.87605839392478, -687.8452002106401, -373.05868223292714, -210.01465244731122, -93.76555104731591, -12.120168625211667, -10.057120849075774, 81.18189178543957, -740.4331090988611, 182.61290466352494, 123.58242684194495, -5.7882208474324415, 123.02587228006148, -15.541348473158756, 132.73431856131114, -57.32245571917305, 4.6665466713388355, 150.23850945940512, -64.78484589302458, -54.55729761787394, -21.629575986192428, -6.435347677834978, -118.30207636936993, -4.410148389117907, -13.020699714731283, -555.1687342162013, -336.7325008755056, -467.8092513385305, 14.932129852420937, 65.34715678729333, 2.0000000000000013, -21.953043933657653, -6.476353813264987, -7.665851429159995, -8.954909132429075, -26.301297624489447, -20.551814297751527, -552.1532521748103, -533.865854342641, 156.7263287272636, -23.37749216593512, 111.44334445417874, 161.07181599790908, 49.70771956250937, 26.91962029693873, -398.40786851449167, 24.75196710846115, -8.983412362688036, -2.7984410930189654, -532.5531779218265, 5.186707641806265, 141.9991277836216, -4.149174056479912, 54.42770688418373, 136.4546581708202, -123.45058234457521, 2.0000000000000013, -7.225966520452676, 170.98151308179007, 52.18194536189672, 120.89685472428442, -10.747843896004287, -31.5799362233091, -230.09192534026005, 21.945086443711972], "policy_predator_policy_reward": [6.906003101646402, 21.903654443686175, 24.88416926887736, 88.73087712256557, 17.35885741239815, 20.40170561077777, 16.43777778138759, 31.37361775483791, 12.500376563381923, 192.2506755047527, 89.49722973483696, 51.88223033985781, 18.89312945735562, 34.99874875674197, 27.069287745570293, 21.45333649359909, 40.93398315830192, 41.10940452342536, 84.76503032255596, 98.6686788248295, 7.086237023497516, 79.19805318359336, 103.82966028647772, 32.54439001550746, 36.437428597344905, 19.26776254005814, 43.99378115529842, 455.29744678675297, 146.92804132978122, 69.7432878163219, 56.769896673982714, 44.20902975831182, 58.15447846391526, 75.00526822744645, 12.341871385812933, 75.02308447463065, 86.18487737940345, 202.41754122740315, 34.331619521789236, 7.119290320042435, 46.40170575235652, 47.35022783817, 69.91015409001437, 27.865746806305996, 4.496770027239062, 151.96437042114795, 2.130182286493861, 505.7439807316662, 54.06465461015385, 33.20098100920379, 361.0646667052459, 259.55867719552356, 101.78423566913494, 206.70337288359582, 6.71444985770667, 15.20833168995804, 296.0285935253816, 188.51999212684316, 349.3513599746713, 9.77266803079903, 203.3353973087838, 1.8192569408642445, 4.4485193332900135, 80.3495010113374, 1.5823052262622879, 535.6129692484409, 82.56009226790106, 45.62706375867326, 8.12972804451136, 94.14711226753053, 41.12929576986842, 99.22009929328959, 4.305111354940305, 25.0190878740588, 23.218804807710132, 28.899640078437063, 278.30387433920936, 68.09535207318164, 15.033256257610912, 135.5739676102385, 90.13599655692371, 35.96990403890532, 9.547836831221241, 63.099205198544986, 127.54492282854864, 109.76327179913227, 38.918883898075165, 12.400427690397127, 4.593341804701019, 26.878880466111323, 6.066455497621334, 62.38794766619538, 54.99134902177454, 4.767208535483448, 0.0, 4.33064582990046, 31.517882720286842, 162.83830810957323, 1.9847989665915409, 106.52562102725665, 176.50751107979764, 36.97328027495693, 80.5159790539305, 185.23995280191323, 110.16124937723895, 42.09725712796623, 122.2395352941593, 110.16873347225393, 98.32512371563597, 80.25807637818491, 23.10584048773312, 48.65114216689916, 0.0, 19.448957430231612, 314.512518124691, 45.505190042459, 8.799830956330217, 67.21415146926462, 44.45118564657387, 355.65638293620066, 20.616423025786215, 59.30692765740383, 48.14866402467651, 83.72599183345548, 79.81401866290227, 43.684700460238666, 6.519610787242209, 16.53502410046736, 93.33646008989307, 115.51126328107588, 297.2453675883359, 140.94819472760986, 91.97258157215789, 110.05277051163363, 174.37098380652577, 34.048230477388124, 720.99520021064, 373.6486822329266, 211.06465244731098, 216.86555104731585, 14.050168625211626, 12.007120849075735, 737.1135592638095, 5.567658049612254, 3.507095336474959, 16.947573158055093, 7.7482208474324, 26.40412771993875, 17.481348473158974, 29.505681438688875, 160.99834549238685, 164.99756355544747, 182.98353858464137, 2.488148280135491, 59.725602545299274, 19.813159278774258, 131.13833757509775, 213.55693855052468, 112.86014838911795, 14.950699714731241, 697.2525002855713, 38.69594314763019, 468.15925133853017, 124.42787014757907, 53.23284321270677, 0.0, 23.863043933657952, 8.446353813264945, 9.625851429159953, 10.914909132429033, 28.17129762448974, 164.56181429775157, 126.56177045145868, 546.5680273298346, 12.288677564522189, 156.51749216593518, 10.316655545821277, 11.168184002091017, 10.6522804374906, 134.20037970306132, 496.52786851449156, 119.44803289153882, 16.92306393718911, 122.27844109301908, 532.7131779218264, 132.08329235819372, 26.589114058840053, 24.993053368471976, 39.52563994957794, 91.99048752573056, 110.80611024576858, 92.09793413634372, 9.175966520452635, 6.228486918209921, 93.69137447785266, 98.42691779226922, 12.677843896004246, 33.51993622330887, 325.0988491588083, 85.39661223683231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.539593406594096, "mean_inference_ms": 1.65949387274992, "mean_action_processing_ms": 0.24408283417434626, "mean_env_wait_ms": 0.18316395551342055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035452842712402344, "StateBufferConnector_ms": 0.002910017967224121, "ViewRequirementAgentConnector_ms": 0.08641064167022705}, "num_episodes": 22, "episode_return_max": 365.19709235630285, "episode_return_min": -412.8893087361584, "episode_return_mean": 143.87613872479184, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.168772722551, "num_env_steps_trained_throughput_per_sec": 399.168772722551, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 10087.522, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10087.487, "sample_time_ms": 1319.835, "learn_time_ms": 8753.783, "learn_throughput": 456.945, "synch_weights_time_ms": 12.977}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "74486_00000", "date": "2024-08-16_15-10-55", "timestamp": 1723801255, "time_this_iter_s": 10.025458097457886, "time_total_s": 922.5071978569031, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39738f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 922.5071978569031, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 31.07857142857143, "ram_util_percent": 79.07857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.3958794033716595, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.449523996802234, "policy_loss": -0.004611722645522268, "vf_loss": 5.453223609924317, "vf_explained_var": 0.31389694437778815, "kl": 0.00810763735717822, "entropy": 1.0858455617591818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6922912207072374, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.761774883257649, "policy_loss": -0.004185721716133966, "vf_loss": 1.7657612486806495, "vf_explained_var": 0.006435427590022012, "kl": 0.007088118014103666, "entropy": 0.5775768885379116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 365.19709235630285, "episode_reward_min": -412.8893087361584, "episode_reward_mean": 137.5431093774648, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -740.4331090988611, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 182.61290466352494, "predator_policy": 737.1135592638095}, "policy_reward_mean": {"prey_policy": -39.5201214264726, "predator_policy": 108.29167611520498}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.10691831708857, 5.49456244906961, 181.5088374994166, 272.96999999999997, 118.68564015166984, -384.92681323864673, 322.41999999999985, 205.14999999999998, 156.67000000000002, 3.8799999999999617, 33.10324217754908, -251.06793324343147, 3.509999999999962, 166.14, -345.6433088624313, 163.97000000000014, 321.57, 19.15607538650262, 142.5000000000001, 113.7700000000005, 246.08186652509448, 163.03999999999945, 131.33000000000035, 193.80999999999966, 85.53560184788246, 329.54999999999956, 220.6699999999999, 227.58290292094938, 171.0699999999997, 3.979999999999959, 127.53431958414045, 253.19999999999956, 3.589999999999965, 158.82000000000002, 182.79999999999978, 236.27134142452417, 59.37420491210455, 193.76039941826087, 130.64000000000033, 121.56000000000014, 299.97336449337723, 111.83502941247538, 187.88000000000014, 156.00000000000023, 133.20000000000005, 3.8899999999999606, 341.82961322596685, 118.88000000000044, 143.89000000000038, 291.79424943912744, 33.739999999999995, 124.1500000000001, 3.8799999999999604, 83.43000000000018, 326.64999999999964, 151.38999999999965, 164.18, 273.34, 270.9253504311572, 3.3518882200072175, 219.95785207841712, 110.38000000000054, -155.95279165850548, 139.71000000000004, 120.58000000000042, 3.8799999999999604, 3.9199999999999613, 145.88000000000002, -412.8893087361584, 302.1550062917856, 294.0, 221.48000000000013, 242.31999999999988, 127.41965157450149, 137.43000000000004, 189.43212115445354, 322.39849253031207, 81.45346203753802, 179.1599999999998, 365.19709235630285, 3.8699999999999615, 202.34862249909253, 156.38000000000008, 263.48110030247835, 330.36999999999983, 229.39000000000004, 143.4300000000003, -9.651631548729, 198.22976049067933, 282.73577038222754, 43.73999999999999, 137.8441379944101, 87.87000000000008, 301.5599999999997, -128.14558140313713, 155.15626318701993, 316.3528178858578, 130.1200000000004, 292.370747836078, 112.57000000000042], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-84.44979036423685, -51.045709925480566, 2.0000000000000013, -37.95634739276233, 91.54671609505982, -3.7898121861699305, 26.93984590998552, 148.254253193694, 2.0000000000000013, -39.77550029671755, -456.4042266402814, -436.3967496165254, 108.12444527471018, 127.02991910593221, -371.95458122233214, -43.5187626784372, 53.34576433086512, -205.16337288359722, -12.003780834700775, -6.0390007129640155, -305.7819913627579, -145.66335211192097, -337.06376779777275, -273.12819345112985, -201.81539730878515, 0.170743059135757, -2.4785193332900537, 83.82049898866264, -459.0201829586548, -423.81840037847934, -80.82009226790018, 116.60293624132676, 147.29027195548858, 72.00288773246953, -23.753220383365992, -97.44009929328868, -2.325111354940347, 115.50091212594123, 88.60119519229006, -26.949640078436758, -194.7510110130924, 94.43365112579598, 146.28674374238895, -133.85396761024003, 39.35400344307649, -34.12990403890568, 182.50216316877876, -61.3392051985453, -153.77259277980156, 2.0000000000000013, 125.33111610192479, 152.8995723096028, 116.97117940128179, 72.22659832790595, 100.07051272214711, 59.05798703498553, 114.09865097822552, -2.78720853548349, 2.0000000000000013, -2.350645829900502, -51.23038151174758, -15.591489733971873, 112.5367846390153, 32.15279536713676, -174.83751107979916, -35.05328027495731, -78.72597905392958, -28.209952801913232, -108.39124937723804, 138.93274287203377, 14.194925402403669, -10.331852744291814, -31.1685220463061, -88.04047313540892, -7.2442050105618865, 129.24762177419075, 128.72000000000003, -17.528957430231323, 103.90047639308372, -342.35818456023384, 106.48583696635276, 117.47354510142969, -84.3843416944583, -203.8881974758416, 135.7435769742137, -27.786927657404135, 106.09133597532353, -81.96599183345458, 51.55598133709772, -41.854700460238995, -10.73701726760924, -8.427617620100415, 87.73778457508863, 45.24410527990935, -180.1253675883359, -139.18819472761146, 50.267418427842145, -108.40277051163281, -49.50102323871072, 132.87605839392478, -687.8452002106401, -373.05868223292714, -210.01465244731122, -93.76555104731591, -12.120168625211667, -10.057120849075774, 81.18189178543957, -740.4331090988611, 182.61290466352494, 123.58242684194495, -5.7882208474324415, 123.02587228006148, -15.541348473158756, 132.73431856131114, -57.32245571917305, 4.6665466713388355, 150.23850945940512, -64.78484589302458, -54.55729761787394, -21.629575986192428, -6.435347677834978, -118.30207636936993, -4.410148389117907, -13.020699714731283, -555.1687342162013, -336.7325008755056, -467.8092513385305, 14.932129852420937, 65.34715678729333, 2.0000000000000013, -21.953043933657653, -6.476353813264987, -7.665851429159995, -8.954909132429075, -26.301297624489447, -20.551814297751527, -552.1532521748103, -533.865854342641, 156.7263287272636, -23.37749216593512, 111.44334445417874, 161.07181599790908, 49.70771956250937, 26.91962029693873, -398.40786851449167, 24.75196710846115, -8.983412362688036, -2.7984410930189654, -532.5531779218265, 5.186707641806265, 141.9991277836216, -4.149174056479912, 54.42770688418373, 136.4546581708202, -123.45058234457521, 2.0000000000000013, -7.225966520452676, 170.98151308179007, 52.18194536189672, 120.89685472428442, -10.747843896004287, -31.5799362233091, -230.09192534026005, 21.945086443711972, 114.37282870370653, 2.0000000000000013, 121.18442605774005, -25.4005616094746, 25.9997806718912, 143.61265995296012, 96.01383579603171, 43.98569898071695, 104.7346590887221, -0.2553301200677598, -24.79586887384726, -18.194566492232546, 115.24121268661793, 2.0000000000000013, 79.76012086366529, 177.90051039174102, -138.37715073784582, -509.93584776832984, -16.58070389986201, 110.11633308851495, -18.977355278909062, -186.66495878973234, 116.32588192930723, 29.881608273211906, -311.3763949246452, -437.4390747102701, -420.7807064709909, -99.70450715957745, 162.5607036202072, 33.25932753205642, 9.332701650952615, -1.436629525519973, -27.3953265019555, -96.11332868234298, -14.645546390722455, -8.272915335455108], "policy_predator_policy_reward": [86.18487737940345, 202.41754122740315, 34.331619521789236, 7.119290320042435, 46.40170575235652, 47.35022783817, 69.91015409001437, 27.865746806305996, 4.496770027239062, 151.96437042114795, 2.130182286493861, 505.7439807316662, 54.06465461015385, 33.20098100920379, 361.0646667052459, 259.55867719552356, 101.78423566913494, 206.70337288359582, 6.71444985770667, 15.20833168995804, 296.0285935253816, 188.51999212684316, 349.3513599746713, 9.77266803079903, 203.3353973087838, 1.8192569408642445, 4.4485193332900135, 80.3495010113374, 1.5823052262622879, 535.6129692484409, 82.56009226790106, 45.62706375867326, 8.12972804451136, 94.14711226753053, 41.12929576986842, 99.22009929328959, 4.305111354940305, 25.0190878740588, 23.218804807710132, 28.899640078437063, 278.30387433920936, 68.09535207318164, 15.033256257610912, 135.5739676102385, 90.13599655692371, 35.96990403890532, 9.547836831221241, 63.099205198544986, 127.54492282854864, 109.76327179913227, 38.918883898075165, 12.400427690397127, 4.593341804701019, 26.878880466111323, 6.066455497621334, 62.38794766619538, 54.99134902177454, 4.767208535483448, 0.0, 4.33064582990046, 31.517882720286842, 162.83830810957323, 1.9847989665915409, 106.52562102725665, 176.50751107979764, 36.97328027495693, 80.5159790539305, 185.23995280191323, 110.16124937723895, 42.09725712796623, 122.2395352941593, 110.16873347225393, 98.32512371563597, 80.25807637818491, 23.10584048773312, 48.65114216689916, 0.0, 19.448957430231612, 314.512518124691, 45.505190042459, 8.799830956330217, 67.21415146926462, 44.45118564657387, 355.65638293620066, 20.616423025786215, 59.30692765740383, 48.14866402467651, 83.72599183345548, 79.81401866290227, 43.684700460238666, 6.519610787242209, 16.53502410046736, 93.33646008989307, 115.51126328107588, 297.2453675883359, 140.94819472760986, 91.97258157215789, 110.05277051163363, 174.37098380652577, 34.048230477388124, 720.99520021064, 373.6486822329266, 211.06465244731098, 216.86555104731585, 14.050168625211626, 12.007120849075735, 737.1135592638095, 5.567658049612254, 3.507095336474959, 16.947573158055093, 7.7482208474324, 26.40412771993875, 17.481348473158974, 29.505681438688875, 160.99834549238685, 164.99756355544747, 182.98353858464137, 2.488148280135491, 59.725602545299274, 19.813159278774258, 131.13833757509775, 213.55693855052468, 112.86014838911795, 14.950699714731241, 697.2525002855713, 38.69594314763019, 468.15925133853017, 124.42787014757907, 53.23284321270677, 0.0, 23.863043933657952, 8.446353813264945, 9.625851429159953, 10.914909132429033, 28.17129762448974, 164.56181429775157, 126.56177045145868, 546.5680273298346, 12.288677564522189, 156.51749216593518, 10.316655545821277, 11.168184002091017, 10.6522804374906, 134.20037970306132, 496.52786851449156, 119.44803289153882, 16.92306393718911, 122.27844109301908, 532.7131779218264, 132.08329235819372, 26.589114058840053, 24.993053368471976, 39.52563994957794, 91.99048752573056, 110.80611024576858, 92.09793413634372, 9.175966520452635, 6.228486918209921, 93.69137447785266, 98.42691779226922, 12.677843896004246, 33.51993622330887, 325.0988491588083, 85.39661223683231, 40.00717129629351, 0.0, 155.19317660626305, 12.504059247949929, 142.05021932810882, 18.7073400470397, 19.44063242774349, 69.94983279550789, 36.705340911278, 2.2453301200677562, 5.12761857806112, 28.211185239290373, 40.670297945678435, 40.31824985838323, 13.26987913633469, 11.805259990486416, 140.04715073784433, 552.0058477683298, 22.7644676370815, 21.544041168675072, 21.847355278909347, 271.66495878973234, 127.6656696552343, 27.686840142246734, 57.31739989491165, 563.3524883368663, 482.8436953885241, 192.79778142906343, 24.518331119891283, 96.01445561370338, 118.80729834904734, 3.4166295255199435, 208.09924825928843, 207.78015476108988, 125.2655463907226, 10.222915335455067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5398019375587835, "mean_inference_ms": 1.6597327493989844, "mean_action_processing_ms": 0.24411466082618635, "mean_env_wait_ms": 0.18331869418107347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034912824630737305, "StateBufferConnector_ms": 0.002901315689086914, "ViewRequirementAgentConnector_ms": 0.08524584770202637}, "num_episodes": 18, "episode_return_max": 365.19709235630285, "episode_return_min": -412.8893087361584, "episode_return_mean": 137.5431093774648, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.2144262241499, "num_env_steps_trained_throughput_per_sec": 403.2144262241499, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 9987.112, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9987.079, "sample_time_ms": 1255.849, "learn_time_ms": 8717.289, "learn_throughput": 458.858, "synch_weights_time_ms": 13.062}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "74486_00000", "date": "2024-08-16_15-11-05", "timestamp": 1723801265, "time_this_iter_s": 9.926009178161621, "time_total_s": 932.4332070350647, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3980e6940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 932.4332070350647, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 29.25, "ram_util_percent": 78.65714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.058128653726881, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.005916007864412, "policy_loss": -0.004755374875225166, "vf_loss": 6.009968231847046, "vf_explained_var": 0.45854035161790396, "kl": 0.006250212251855863, "entropy": 1.035764036418269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.394251198916839, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9314757169239105, "policy_loss": -0.0027358908218543523, "vf_loss": 1.9338125880748507, "vf_explained_var": 0.002730668852568934, "kl": 0.014187402677806276, "entropy": 0.5730937394673231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 365.19709235630285, "episode_reward_min": -412.8893087361584, "episode_reward_mean": 158.20211677347766, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -740.4331090988611, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 182.61290466352494, "predator_policy": 737.1135592638095}, "policy_reward_mean": {"prey_policy": -28.781470160628086, "predator_policy": 107.88252854736692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.80999999999966, 85.53560184788246, 329.54999999999956, 220.6699999999999, 227.58290292094938, 171.0699999999997, 3.979999999999959, 127.53431958414045, 253.19999999999956, 3.589999999999965, 158.82000000000002, 182.79999999999978, 236.27134142452417, 59.37420491210455, 193.76039941826087, 130.64000000000033, 121.56000000000014, 299.97336449337723, 111.83502941247538, 187.88000000000014, 156.00000000000023, 133.20000000000005, 3.8899999999999606, 341.82961322596685, 118.88000000000044, 143.89000000000038, 291.79424943912744, 33.739999999999995, 124.1500000000001, 3.8799999999999604, 83.43000000000018, 326.64999999999964, 151.38999999999965, 164.18, 273.34, 270.9253504311572, 3.3518882200072175, 219.95785207841712, 110.38000000000054, -155.95279165850548, 139.71000000000004, 120.58000000000042, 3.8799999999999604, 3.9199999999999613, 145.88000000000002, -412.8893087361584, 302.1550062917856, 294.0, 221.48000000000013, 242.31999999999988, 127.41965157450149, 137.43000000000004, 189.43212115445354, 322.39849253031207, 81.45346203753802, 179.1599999999998, 365.19709235630285, 3.8699999999999615, 202.34862249909253, 156.38000000000008, 263.48110030247835, 330.36999999999983, 229.39000000000004, 143.4300000000003, -9.651631548729, 198.22976049067933, 282.73577038222754, 43.73999999999999, 137.8441379944101, 87.87000000000008, 301.5599999999997, -128.14558140313713, 155.15626318701993, 316.3528178858578, 130.1200000000004, 292.370747836078, 112.57000000000042, 264.1799999999995, 139.77793178147047, 147.30999999999997, 133.63000000000068, 318.34211379299205, 138.97000000000003, 136.71037005023484, 123.86024130591731, 239.26000000000016, 159.53999999999994, 11.81935357670137, 218.95999999999975, 107.27999999999992, 5.8199999999999195, 146.28000000000003, 250.25, 271.20000000000005, -1.8126919587504287, 161.2199999999999, 275.0899999999997, 221.53703290419375, 241.21547531040767, 297.87999999999965], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.50216316877876, -61.3392051985453, -153.77259277980156, 2.0000000000000013, 125.33111610192479, 152.8995723096028, 116.97117940128179, 72.22659832790595, 100.07051272214711, 59.05798703498553, 114.09865097822552, -2.78720853548349, 2.0000000000000013, -2.350645829900502, -51.23038151174758, -15.591489733971873, 112.5367846390153, 32.15279536713676, -174.83751107979916, -35.05328027495731, -78.72597905392958, -28.209952801913232, -108.39124937723804, 138.93274287203377, 14.194925402403669, -10.331852744291814, -31.1685220463061, -88.04047313540892, -7.2442050105618865, 129.24762177419075, 128.72000000000003, -17.528957430231323, 103.90047639308372, -342.35818456023384, 106.48583696635276, 117.47354510142969, -84.3843416944583, -203.8881974758416, 135.7435769742137, -27.786927657404135, 106.09133597532353, -81.96599183345458, 51.55598133709772, -41.854700460238995, -10.73701726760924, -8.427617620100415, 87.73778457508863, 45.24410527990935, -180.1253675883359, -139.18819472761146, 50.267418427842145, -108.40277051163281, -49.50102323871072, 132.87605839392478, -687.8452002106401, -373.05868223292714, -210.01465244731122, -93.76555104731591, -12.120168625211667, -10.057120849075774, 81.18189178543957, -740.4331090988611, 182.61290466352494, 123.58242684194495, -5.7882208474324415, 123.02587228006148, -15.541348473158756, 132.73431856131114, -57.32245571917305, 4.6665466713388355, 150.23850945940512, -64.78484589302458, -54.55729761787394, -21.629575986192428, -6.435347677834978, -118.30207636936993, -4.410148389117907, -13.020699714731283, -555.1687342162013, -336.7325008755056, -467.8092513385305, 14.932129852420937, 65.34715678729333, 2.0000000000000013, -21.953043933657653, -6.476353813264987, -7.665851429159995, -8.954909132429075, -26.301297624489447, -20.551814297751527, -552.1532521748103, -533.865854342641, 156.7263287272636, -23.37749216593512, 111.44334445417874, 161.07181599790908, 49.70771956250937, 26.91962029693873, -398.40786851449167, 24.75196710846115, -8.983412362688036, -2.7984410930189654, -532.5531779218265, 5.186707641806265, 141.9991277836216, -4.149174056479912, 54.42770688418373, 136.4546581708202, -123.45058234457521, 2.0000000000000013, -7.225966520452676, 170.98151308179007, 52.18194536189672, 120.89685472428442, -10.747843896004287, -31.5799362233091, -230.09192534026005, 21.945086443711972, 114.37282870370653, 2.0000000000000013, 121.18442605774005, -25.4005616094746, 25.9997806718912, 143.61265995296012, 96.01383579603171, 43.98569898071695, 104.7346590887221, -0.2553301200677598, -24.79586887384726, -18.194566492232546, 115.24121268661793, 2.0000000000000013, 79.76012086366529, 177.90051039174102, -138.37715073784582, -509.93584776832984, -16.58070389986201, 110.11633308851495, -18.977355278909062, -186.66495878973234, 116.32588192930723, 29.881608273211906, -311.3763949246452, -437.4390747102701, -420.7807064709909, -99.70450715957745, 162.5607036202072, 33.25932753205642, 9.332701650952615, -1.436629525519973, -27.3953265019555, -96.11332868234298, -14.645546390722455, -8.272915335455108, 91.83663378960573, 84.29526722964137, -541.6103797365694, -55.476285133149574, 2.0000000000000013, -12.262624609442135, -12.115062747399303, 129.59314023657788, 127.73338722225887, -206.17356724839897, -7.708841575500671, -364.4379394669913, -120.75879072828334, -17.601469830246813, -35.52321863842816, -22.200465721090065, 34.569543815352716, 51.52406247151156, -571.2668797067254, 146.68933202344436, -3.77688151112317, -144.8222435216272, -157.99086634347773, 49.458433825203876, 86.23709413494534, -477.53568599382305, -22.253509581836873, -1.587395238241212, -42.71196337499286, 93.40272755872509, 3.6649966546525192, 154.19884424372464, 105.66418620014288, 133.0356972010054, -7.042814688673802, -5.080870925657438, 126.56092511846265, -17.14391889073325, 132.68000000000004, 104.62638852362933, -137.0824116238088, 20.531544748029262, 86.44820401666942, 110.31090054438572, 100.01373692710808, 128.83359553970428], "policy_predator_policy_reward": [9.547836831221241, 63.099205198544986, 127.54492282854864, 109.76327179913227, 38.918883898075165, 12.400427690397127, 4.593341804701019, 26.878880466111323, 6.066455497621334, 62.38794766619538, 54.99134902177454, 4.767208535483448, 0.0, 4.33064582990046, 31.517882720286842, 162.83830810957323, 1.9847989665915409, 106.52562102725665, 176.50751107979764, 36.97328027495693, 80.5159790539305, 185.23995280191323, 110.16124937723895, 42.09725712796623, 122.2395352941593, 110.16873347225393, 98.32512371563597, 80.25807637818491, 23.10584048773312, 48.65114216689916, 0.0, 19.448957430231612, 314.512518124691, 45.505190042459, 8.799830956330217, 67.21415146926462, 44.45118564657387, 355.65638293620066, 20.616423025786215, 59.30692765740383, 48.14866402467651, 83.72599183345548, 79.81401866290227, 43.684700460238666, 6.519610787242209, 16.53502410046736, 93.33646008989307, 115.51126328107588, 297.2453675883359, 140.94819472760986, 91.97258157215789, 110.05277051163363, 174.37098380652577, 34.048230477388124, 720.99520021064, 373.6486822329266, 211.06465244731098, 216.86555104731585, 14.050168625211626, 12.007120849075735, 737.1135592638095, 5.567658049612254, 3.507095336474959, 16.947573158055093, 7.7482208474324, 26.40412771993875, 17.481348473158974, 29.505681438688875, 160.99834549238685, 164.99756355544747, 182.98353858464137, 2.488148280135491, 59.725602545299274, 19.813159278774258, 131.13833757509775, 213.55693855052468, 112.86014838911795, 14.950699714731241, 697.2525002855713, 38.69594314763019, 468.15925133853017, 124.42787014757907, 53.23284321270677, 0.0, 23.863043933657952, 8.446353813264945, 9.625851429159953, 10.914909132429033, 28.17129762448974, 164.56181429775157, 126.56177045145868, 546.5680273298346, 12.288677564522189, 156.51749216593518, 10.316655545821277, 11.168184002091017, 10.6522804374906, 134.20037970306132, 496.52786851449156, 119.44803289153882, 16.92306393718911, 122.27844109301908, 532.7131779218264, 132.08329235819372, 26.589114058840053, 24.993053368471976, 39.52563994957794, 91.99048752573056, 110.80611024576858, 92.09793413634372, 9.175966520452635, 6.228486918209921, 93.69137447785266, 98.42691779226922, 12.677843896004246, 33.51993622330887, 325.0988491588083, 85.39661223683231, 40.00717129629351, 0.0, 155.19317660626305, 12.504059247949929, 142.05021932810882, 18.7073400470397, 19.44063242774349, 69.94983279550789, 36.705340911278, 2.2453301200677562, 5.12761857806112, 28.211185239290373, 40.670297945678435, 40.31824985838323, 13.26987913633469, 11.805259990486416, 140.04715073784433, 552.0058477683298, 22.7644676370815, 21.544041168675072, 21.847355278909347, 271.66495878973234, 127.6656696552343, 27.686840142246734, 57.31739989491165, 563.3524883368663, 482.8436953885241, 192.79778142906343, 24.518331119891283, 96.01445561370338, 118.80729834904734, 3.4166295255199435, 208.09924825928843, 207.78015476108988, 125.2655463907226, 10.222915335455067, 46.693366210394394, 41.35473277035872, 191.633540244314, 545.2310564068755, 0.0, 157.57262460944207, 14.065062747399262, 2.0868597634223454, 195.95480656333282, 200.82748725579984, 119.10884157550086, 392.00793946699076, 109.24594948262012, 165.8246811261447, 126.08178529481317, 55.50214037062218, 100.8104561846474, 52.3559375284884, 13.245895621109531, 570.8716520621715, 13.936235087824576, 146.4822435216257, 258.28086634347744, 69.21156617479608, 474.8870498233551, 23.69154203552269, 19.175927312049353, 10.484977508028988, 44.59196337499249, 50.99727244127496, 87.20500334534762, 5.181155756275328, 16.937361347436976, 15.562755251414822, 10.310993655580807, 0.0, 32.72907488153737, 19.07391889073355, 0.0, 37.78361147637078, 67.67201247808927, 270.4158873018849, 9.574436735562823, 34.881934013790335, 67.1762630728919, 1.8564044602958392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5373946917396952, "mean_inference_ms": 1.6538699229805818, "mean_action_processing_ms": 0.24259430021685205, "mean_env_wait_ms": 0.18245132615316492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00393521785736084, "StateBufferConnector_ms": 0.0029257535934448242, "ViewRequirementAgentConnector_ms": 0.08752751350402832}, "num_episodes": 23, "episode_return_max": 365.19709235630285, "episode_return_min": -412.8893087361584, "episode_return_mean": 158.20211677347766, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.4791416195888, "num_env_steps_trained_throughput_per_sec": 391.4791416195888, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 10004.652, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10004.619, "sample_time_ms": 1244.57, "learn_time_ms": 8746.006, "learn_throughput": 457.352, "synch_weights_time_ms": 13.12}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "74486_00000", "date": "2024-08-16_15-11-15", "timestamp": 1723801275, "time_this_iter_s": 10.223443984985352, "time_total_s": 942.65665102005, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3982055e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 942.65665102005, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 33.20714285714286, "ram_util_percent": 78.90714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.050487954212875, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.638409677132097, "policy_loss": -0.004533936499455382, "vf_loss": 5.642043999767808, "vf_explained_var": 0.2461096585112274, "kl": 0.007996518347390395, "entropy": 1.0193821559822749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8474898533846336, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0910022233529064, "policy_loss": -0.0033132046178998378, "vf_loss": 3.094085643783448, "vf_explained_var": 0.005161789674607534, "kl": 0.008170143060104036, "entropy": 0.628770908681804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 366.08265000363633, "episode_reward_min": -412.8893087361584, "episode_reward_mean": 149.30457190489142, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -740.4331090988611, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.7694123864343, "predator_policy": 737.1135592638095}, "policy_reward_mean": {"prey_policy": -41.87265136107689, "predator_policy": 116.52493731352257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.83502941247538, 187.88000000000014, 156.00000000000023, 133.20000000000005, 3.8899999999999606, 341.82961322596685, 118.88000000000044, 143.89000000000038, 291.79424943912744, 33.739999999999995, 124.1500000000001, 3.8799999999999604, 83.43000000000018, 326.64999999999964, 151.38999999999965, 164.18, 273.34, 270.9253504311572, 3.3518882200072175, 219.95785207841712, 110.38000000000054, -155.95279165850548, 139.71000000000004, 120.58000000000042, 3.8799999999999604, 3.9199999999999613, 145.88000000000002, -412.8893087361584, 302.1550062917856, 294.0, 221.48000000000013, 242.31999999999988, 127.41965157450149, 137.43000000000004, 189.43212115445354, 322.39849253031207, 81.45346203753802, 179.1599999999998, 365.19709235630285, 3.8699999999999615, 202.34862249909253, 156.38000000000008, 263.48110030247835, 330.36999999999983, 229.39000000000004, 143.4300000000003, -9.651631548729, 198.22976049067933, 282.73577038222754, 43.73999999999999, 137.8441379944101, 87.87000000000008, 301.5599999999997, -128.14558140313713, 155.15626318701993, 316.3528178858578, 130.1200000000004, 292.370747836078, 112.57000000000042, 264.1799999999995, 139.77793178147047, 147.30999999999997, 133.63000000000068, 318.34211379299205, 138.97000000000003, 136.71037005023484, 123.86024130591731, 239.26000000000016, 159.53999999999994, 11.81935357670137, 218.95999999999975, 107.27999999999992, 5.8199999999999195, 146.28000000000003, 250.25, 271.20000000000005, -1.8126919587504287, 161.2199999999999, 275.0899999999997, 221.53703290419375, 241.21547531040767, 297.87999999999965, 142.36000000000013, 108.41000000000054, 3.9199999999999595, 58.69999999999999, 238.0077527029622, 281.0799999999996, -278.51347121983963, 366.08265000363633, -79.94007906656012, 3.849999999999962, 166.68351951840924, 122.20000000000032, 182.2237221212235, 164.13999999999996, 135.63000000000034, 195.93999999999969, 223.31999999999982, 75.87355368278237], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-84.3843416944583, -203.8881974758416, 135.7435769742137, -27.786927657404135, 106.09133597532353, -81.96599183345458, 51.55598133709772, -41.854700460238995, -10.73701726760924, -8.427617620100415, 87.73778457508863, 45.24410527990935, -180.1253675883359, -139.18819472761146, 50.267418427842145, -108.40277051163281, -49.50102323871072, 132.87605839392478, -687.8452002106401, -373.05868223292714, -210.01465244731122, -93.76555104731591, -12.120168625211667, -10.057120849075774, 81.18189178543957, -740.4331090988611, 182.61290466352494, 123.58242684194495, -5.7882208474324415, 123.02587228006148, -15.541348473158756, 132.73431856131114, -57.32245571917305, 4.6665466713388355, 150.23850945940512, -64.78484589302458, -54.55729761787394, -21.629575986192428, -6.435347677834978, -118.30207636936993, -4.410148389117907, -13.020699714731283, -555.1687342162013, -336.7325008755056, -467.8092513385305, 14.932129852420937, 65.34715678729333, 2.0000000000000013, -21.953043933657653, -6.476353813264987, -7.665851429159995, -8.954909132429075, -26.301297624489447, -20.551814297751527, -552.1532521748103, -533.865854342641, 156.7263287272636, -23.37749216593512, 111.44334445417874, 161.07181599790908, 49.70771956250937, 26.91962029693873, -398.40786851449167, 24.75196710846115, -8.983412362688036, -2.7984410930189654, -532.5531779218265, 5.186707641806265, 141.9991277836216, -4.149174056479912, 54.42770688418373, 136.4546581708202, -123.45058234457521, 2.0000000000000013, -7.225966520452676, 170.98151308179007, 52.18194536189672, 120.89685472428442, -10.747843896004287, -31.5799362233091, -230.09192534026005, 21.945086443711972, 114.37282870370653, 2.0000000000000013, 121.18442605774005, -25.4005616094746, 25.9997806718912, 143.61265995296012, 96.01383579603171, 43.98569898071695, 104.7346590887221, -0.2553301200677598, -24.79586887384726, -18.194566492232546, 115.24121268661793, 2.0000000000000013, 79.76012086366529, 177.90051039174102, -138.37715073784582, -509.93584776832984, -16.58070389986201, 110.11633308851495, -18.977355278909062, -186.66495878973234, 116.32588192930723, 29.881608273211906, -311.3763949246452, -437.4390747102701, -420.7807064709909, -99.70450715957745, 162.5607036202072, 33.25932753205642, 9.332701650952615, -1.436629525519973, -27.3953265019555, -96.11332868234298, -14.645546390722455, -8.272915335455108, 91.83663378960573, 84.29526722964137, -541.6103797365694, -55.476285133149574, 2.0000000000000013, -12.262624609442135, -12.115062747399303, 129.59314023657788, 127.73338722225887, -206.17356724839897, -7.708841575500671, -364.4379394669913, -120.75879072828334, -17.601469830246813, -35.52321863842816, -22.200465721090065, 34.569543815352716, 51.52406247151156, -571.2668797067254, 146.68933202344436, -3.77688151112317, -144.8222435216272, -157.99086634347773, 49.458433825203876, 86.23709413494534, -477.53568599382305, -22.253509581836873, -1.587395238241212, -42.71196337499286, 93.40272755872509, 3.6649966546525192, 154.19884424372464, 105.66418620014288, 133.0356972010054, -7.042814688673802, -5.080870925657438, 126.56092511846265, -17.14391889073325, 132.68000000000004, 104.62638852362933, -137.0824116238088, 20.531544748029262, 86.44820401666942, 110.31090054438572, 100.01373692710808, 128.83359553970428, -5.416869161181677, 81.39443654395546, -12.75591825714013, -6.804014110809062, -3.6790931878501256, -10.408962684240258, -356.55296760865025, -430.4077201060043, -40.34193091007157, 66.34999999999997, 154.8380118803725, 95.98816918382967, -628.3916939993865, -363.7199261249894, -5.504661690801896, 175.23682828300178, -346.3017339745685, -430.1967350155714, -23.143022434659635, -2.259445108442222, 136.90769238114154, -45.31666624452647, -151.98635079647894, -18.981937438849904, 116.03379500565084, -27.440894876761806, 127.3645771459107, -44.22729521628119, 133.67000000000007, -6.501824134507949, -16.574352540357744, 185.7694123864343, -17.438452401160504, 70.66336778992529, -111.4400628385958, -254.81918237191815], "policy_predator_policy_reward": [44.45118564657387, 355.65638293620066, 20.616423025786215, 59.30692765740383, 48.14866402467651, 83.72599183345548, 79.81401866290227, 43.684700460238666, 6.519610787242209, 16.53502410046736, 93.33646008989307, 115.51126328107588, 297.2453675883359, 140.94819472760986, 91.97258157215789, 110.05277051163363, 174.37098380652577, 34.048230477388124, 720.99520021064, 373.6486822329266, 211.06465244731098, 216.86555104731585, 14.050168625211626, 12.007120849075735, 737.1135592638095, 5.567658049612254, 3.507095336474959, 16.947573158055093, 7.7482208474324, 26.40412771993875, 17.481348473158974, 29.505681438688875, 160.99834549238685, 164.99756355544747, 182.98353858464137, 2.488148280135491, 59.725602545299274, 19.813159278774258, 131.13833757509775, 213.55693855052468, 112.86014838911795, 14.950699714731241, 697.2525002855713, 38.69594314763019, 468.15925133853017, 124.42787014757907, 53.23284321270677, 0.0, 23.863043933657952, 8.446353813264945, 9.625851429159953, 10.914909132429033, 28.17129762448974, 164.56181429775157, 126.56177045145868, 546.5680273298346, 12.288677564522189, 156.51749216593518, 10.316655545821277, 11.168184002091017, 10.6522804374906, 134.20037970306132, 496.52786851449156, 119.44803289153882, 16.92306393718911, 122.27844109301908, 532.7131779218264, 132.08329235819372, 26.589114058840053, 24.993053368471976, 39.52563994957794, 91.99048752573056, 110.80611024576858, 92.09793413634372, 9.175966520452635, 6.228486918209921, 93.69137447785266, 98.42691779226922, 12.677843896004246, 33.51993622330887, 325.0988491588083, 85.39661223683231, 40.00717129629351, 0.0, 155.19317660626305, 12.504059247949929, 142.05021932810882, 18.7073400470397, 19.44063242774349, 69.94983279550789, 36.705340911278, 2.2453301200677562, 5.12761857806112, 28.211185239290373, 40.670297945678435, 40.31824985838323, 13.26987913633469, 11.805259990486416, 140.04715073784433, 552.0058477683298, 22.7644676370815, 21.544041168675072, 21.847355278909347, 271.66495878973234, 127.6656696552343, 27.686840142246734, 57.31739989491165, 563.3524883368663, 482.8436953885241, 192.79778142906343, 24.518331119891283, 96.01445561370338, 118.80729834904734, 3.4166295255199435, 208.09924825928843, 207.78015476108988, 125.2655463907226, 10.222915335455067, 46.693366210394394, 41.35473277035872, 191.633540244314, 545.2310564068755, 0.0, 157.57262460944207, 14.065062747399262, 2.0868597634223454, 195.95480656333282, 200.82748725579984, 119.10884157550086, 392.00793946699076, 109.24594948262012, 165.8246811261447, 126.08178529481317, 55.50214037062218, 100.8104561846474, 52.3559375284884, 13.245895621109531, 570.8716520621715, 13.936235087824576, 146.4822435216257, 258.28086634347744, 69.21156617479608, 474.8870498233551, 23.69154203552269, 19.175927312049353, 10.484977508028988, 44.59196337499249, 50.99727244127496, 87.20500334534762, 5.181155756275328, 16.937361347436976, 15.562755251414822, 10.310993655580807, 0.0, 32.72907488153737, 19.07391889073355, 0.0, 37.78361147637078, 67.67201247808927, 270.4158873018849, 9.574436735562823, 34.881934013790335, 67.1762630728919, 1.8564044602958392, 7.376869161181635, 59.005563456044555, 119.20591825714018, 8.76401411080902, 3.503578252343646, 14.504477619746654, 413.56296760865024, 432.09772010600403, 106.4874716923805, 105.51221192065333, 17.36198811962762, 12.891830816170351, 655.4064309581529, 58.19171794638274, 179.57731169443827, 16.773171716998238, 638.030078156076, 58.52831176750361, 15.385451414566736, 13.867016128535365, 29.91384382509951, 45.1786495566941, 153.60635079647747, 139.56193743884944, 57.07620499434917, 36.55461699798577, 34.865422854089395, 46.13729521628081, 0.0, 8.461824134507907, 18.49435254035804, 8.250587613565695, 168.46402578995475, 1.6310588212810648, 99.48935629104999, 342.643442602246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5391495914963568, "mean_inference_ms": 1.6589384469577753, "mean_action_processing_ms": 0.2435192595264079, "mean_env_wait_ms": 0.1830083423167014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004285573959350586, "StateBufferConnector_ms": 0.0029336214065551758, "ViewRequirementAgentConnector_ms": 0.08772146701812744}, "num_episodes": 18, "episode_return_max": 366.08265000363633, "episode_return_min": -412.8893087361584, "episode_return_mean": 149.30457190489142, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.41433551761037, "num_env_steps_trained_throughput_per_sec": 394.41433551761037, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 10006.734, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10006.701, "sample_time_ms": 1243.425, "learn_time_ms": 8749.173, "learn_throughput": 457.186, "synch_weights_time_ms": 13.3}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "74486_00000", "date": "2024-08-16_15-11-25", "timestamp": 1723801285, "time_this_iter_s": 10.146329879760742, "time_total_s": 952.8029808998108, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x398205f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 952.8029808998108, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 30.133333333333333, "ram_util_percent": 79.09333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7769641224038666, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.02911061206192, "policy_loss": -0.005289767966876743, "vf_loss": 6.0335037488786005, "vf_explained_var": 0.05350039544559661, "kl": 0.007969935739218963, "entropy": 0.9917536503738827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7375641288423034, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.055636626072031, "policy_loss": -0.0036031914911868555, "vf_loss": 3.0590669579606837, "vf_explained_var": 0.0071476660077534025, "kl": 0.0061458493911493075, "entropy": 0.641902215234817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 366.08265000363633, "episode_reward_min": -412.8893087361584, "episode_reward_mean": 139.49113597050538, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -628.3916939993865, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.7694123864343, "predator_policy": 803.4890676474428}, "policy_reward_mean": {"prey_policy": -43.69193204763391, "predator_policy": 113.43750003288663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.3518882200072175, 219.95785207841712, 110.38000000000054, -155.95279165850548, 139.71000000000004, 120.58000000000042, 3.8799999999999604, 3.9199999999999613, 145.88000000000002, -412.8893087361584, 302.1550062917856, 294.0, 221.48000000000013, 242.31999999999988, 127.41965157450149, 137.43000000000004, 189.43212115445354, 322.39849253031207, 81.45346203753802, 179.1599999999998, 365.19709235630285, 3.8699999999999615, 202.34862249909253, 156.38000000000008, 263.48110030247835, 330.36999999999983, 229.39000000000004, 143.4300000000003, -9.651631548729, 198.22976049067933, 282.73577038222754, 43.73999999999999, 137.8441379944101, 87.87000000000008, 301.5599999999997, -128.14558140313713, 155.15626318701993, 316.3528178858578, 130.1200000000004, 292.370747836078, 112.57000000000042, 264.1799999999995, 139.77793178147047, 147.30999999999997, 133.63000000000068, 318.34211379299205, 138.97000000000003, 136.71037005023484, 123.86024130591731, 239.26000000000016, 159.53999999999994, 11.81935357670137, 218.95999999999975, 107.27999999999992, 5.8199999999999195, 146.28000000000003, 250.25, 271.20000000000005, -1.8126919587504287, 161.2199999999999, 275.0899999999997, 221.53703290419375, 241.21547531040767, 297.87999999999965, 142.36000000000013, 108.41000000000054, 3.9199999999999595, 58.69999999999999, 238.0077527029622, 281.0799999999996, -278.51347121983963, 366.08265000363633, -79.94007906656012, 3.849999999999962, 166.68351951840924, 122.20000000000032, 182.2237221212235, 164.13999999999996, 135.63000000000034, 195.93999999999969, 223.31999999999982, 75.87355368278237, 132.90566939179192, 155.44000000000005, 122.11000000000027, 174.2437942493862, 284.9999999999998, -41.55542012291809, 175.02999999999986, 153.70000000000005, 292.2599999999999, -221.28889587893855, 190.20907485549765, 192.6525628992109, 164.28999999999965, 177.1599999999995, 47.02295338965358, -378.5104889589085, 149.75139924535574, 169.11999999999966], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.55729761787394, -21.629575986192428, -6.435347677834978, -118.30207636936993, -4.410148389117907, -13.020699714731283, -555.1687342162013, -336.7325008755056, -467.8092513385305, 14.932129852420937, 65.34715678729333, 2.0000000000000013, -21.953043933657653, -6.476353813264987, -7.665851429159995, -8.954909132429075, -26.301297624489447, -20.551814297751527, -552.1532521748103, -533.865854342641, 156.7263287272636, -23.37749216593512, 111.44334445417874, 161.07181599790908, 49.70771956250937, 26.91962029693873, -398.40786851449167, 24.75196710846115, -8.983412362688036, -2.7984410930189654, -532.5531779218265, 5.186707641806265, 141.9991277836216, -4.149174056479912, 54.42770688418373, 136.4546581708202, -123.45058234457521, 2.0000000000000013, -7.225966520452676, 170.98151308179007, 52.18194536189672, 120.89685472428442, -10.747843896004287, -31.5799362233091, -230.09192534026005, 21.945086443711972, 114.37282870370653, 2.0000000000000013, 121.18442605774005, -25.4005616094746, 25.9997806718912, 143.61265995296012, 96.01383579603171, 43.98569898071695, 104.7346590887221, -0.2553301200677598, -24.79586887384726, -18.194566492232546, 115.24121268661793, 2.0000000000000013, 79.76012086366529, 177.90051039174102, -138.37715073784582, -509.93584776832984, -16.58070389986201, 110.11633308851495, -18.977355278909062, -186.66495878973234, 116.32588192930723, 29.881608273211906, -311.3763949246452, -437.4390747102701, -420.7807064709909, -99.70450715957745, 162.5607036202072, 33.25932753205642, 9.332701650952615, -1.436629525519973, -27.3953265019555, -96.11332868234298, -14.645546390722455, -8.272915335455108, 91.83663378960573, 84.29526722964137, -541.6103797365694, -55.476285133149574, 2.0000000000000013, -12.262624609442135, -12.115062747399303, 129.59314023657788, 127.73338722225887, -206.17356724839897, -7.708841575500671, -364.4379394669913, -120.75879072828334, -17.601469830246813, -35.52321863842816, -22.200465721090065, 34.569543815352716, 51.52406247151156, -571.2668797067254, 146.68933202344436, -3.77688151112317, -144.8222435216272, -157.99086634347773, 49.458433825203876, 86.23709413494534, -477.53568599382305, -22.253509581836873, -1.587395238241212, -42.71196337499286, 93.40272755872509, 3.6649966546525192, 154.19884424372464, 105.66418620014288, 133.0356972010054, -7.042814688673802, -5.080870925657438, 126.56092511846265, -17.14391889073325, 132.68000000000004, 104.62638852362933, -137.0824116238088, 20.531544748029262, 86.44820401666942, 110.31090054438572, 100.01373692710808, 128.83359553970428, -5.416869161181677, 81.39443654395546, -12.75591825714013, -6.804014110809062, -3.6790931878501256, -10.408962684240258, -356.55296760865025, -430.4077201060043, -40.34193091007157, 66.34999999999997, 154.8380118803725, 95.98816918382967, -628.3916939993865, -363.7199261249894, -5.504661690801896, 175.23682828300178, -346.3017339745685, -430.1967350155714, -23.143022434659635, -2.259445108442222, 136.90769238114154, -45.31666624452647, -151.98635079647894, -18.981937438849904, 116.03379500565084, -27.440894876761806, 127.3645771459107, -44.22729521628119, 133.67000000000007, -6.501824134507949, -16.574352540357744, 185.7694123864343, -17.438452401160504, 70.66336778992529, -111.4400628385958, -254.81918237191815, 13.319457769882288, -532.8414225868108, 142.99014404457643, 2.0000000000000013, -78.88235348252331, -2.2135660280014218, -29.149051532536657, 18.799652821749344, 97.27365955375429, 124.75074860596011, -89.89135273520694, -140.5684639969727, -38.45434672980072, 123.43120406743313, -162.7894009570343, 54.975480559915916, 89.19184001133507, -126.60931923530813, -432.1891694332812, -399.0694405941153, 105.30954273375423, -44.9096800978524, 164.25866444299544, -58.72289755677604, 143.0414515023682, 2.0000000000000013, 154.24224495614098, -0.43704100055141315, -27.178942319379484, -113.95065549278424, -561.2318895716086, -624.1928365332919, -89.83465447476932, 83.30643382597846, 68.93504785825314, 2.0000000000000013], "policy_predator_policy_reward": [59.725602545299274, 19.813159278774258, 131.13833757509775, 213.55693855052468, 112.86014838911795, 14.950699714731241, 697.2525002855713, 38.69594314763019, 468.15925133853017, 124.42787014757907, 53.23284321270677, 0.0, 23.863043933657952, 8.446353813264945, 9.625851429159953, 10.914909132429033, 28.17129762448974, 164.56181429775157, 126.56177045145868, 546.5680273298346, 12.288677564522189, 156.51749216593518, 10.316655545821277, 11.168184002091017, 10.6522804374906, 134.20037970306132, 496.52786851449156, 119.44803289153882, 16.92306393718911, 122.27844109301908, 532.7131779218264, 132.08329235819372, 26.589114058840053, 24.993053368471976, 39.52563994957794, 91.99048752573056, 110.80611024576858, 92.09793413634372, 9.175966520452635, 6.228486918209921, 93.69137447785266, 98.42691779226922, 12.677843896004246, 33.51993622330887, 325.0988491588083, 85.39661223683231, 40.00717129629351, 0.0, 155.19317660626305, 12.504059247949929, 142.05021932810882, 18.7073400470397, 19.44063242774349, 69.94983279550789, 36.705340911278, 2.2453301200677562, 5.12761857806112, 28.211185239290373, 40.670297945678435, 40.31824985838323, 13.26987913633469, 11.805259990486416, 140.04715073784433, 552.0058477683298, 22.7644676370815, 21.544041168675072, 21.847355278909347, 271.66495878973234, 127.6656696552343, 27.686840142246734, 57.31739989491165, 563.3524883368663, 482.8436953885241, 192.79778142906343, 24.518331119891283, 96.01445561370338, 118.80729834904734, 3.4166295255199435, 208.09924825928843, 207.78015476108988, 125.2655463907226, 10.222915335455067, 46.693366210394394, 41.35473277035872, 191.633540244314, 545.2310564068755, 0.0, 157.57262460944207, 14.065062747399262, 2.0868597634223454, 195.95480656333282, 200.82748725579984, 119.10884157550086, 392.00793946699076, 109.24594948262012, 165.8246811261447, 126.08178529481317, 55.50214037062218, 100.8104561846474, 52.3559375284884, 13.245895621109531, 570.8716520621715, 13.936235087824576, 146.4822435216257, 258.28086634347744, 69.21156617479608, 474.8870498233551, 23.69154203552269, 19.175927312049353, 10.484977508028988, 44.59196337499249, 50.99727244127496, 87.20500334534762, 5.181155756275328, 16.937361347436976, 15.562755251414822, 10.310993655580807, 0.0, 32.72907488153737, 19.07391889073355, 0.0, 37.78361147637078, 67.67201247808927, 270.4158873018849, 9.574436735562823, 34.881934013790335, 67.1762630728919, 1.8564044602958392, 7.376869161181635, 59.005563456044555, 119.20591825714018, 8.76401411080902, 3.503578252343646, 14.504477619746654, 413.56296760865024, 432.09772010600403, 106.4874716923805, 105.51221192065333, 17.36198811962762, 12.891830816170351, 655.4064309581529, 58.19171794638274, 179.57731169443827, 16.773171716998238, 638.030078156076, 58.52831176750361, 15.385451414566736, 13.867016128535365, 29.91384382509951, 45.1786495566941, 153.60635079647747, 139.56193743884944, 57.07620499434917, 36.55461699798577, 34.865422854089395, 46.13729521628081, 0.0, 8.461824134507907, 18.49435254035804, 8.250587613565695, 168.46402578995475, 1.6310588212810648, 99.48935629104999, 342.643442602246, 544.1379362084441, 108.28969800027623, 10.449855955423649, 0.0, 199.0123534825233, 4.19356602800138, 144.9500621501073, 39.64313081006616, 47.19634044624577, 15.779251394039946, 102.21382323466133, 86.69057337460045, 40.35434672980034, 49.69879593256686, 164.3294009570331, 97.18451944008406, 260.1999147430683, 69.47756448090465, 7.570328742348705, 602.399385406109, 65.78045726624582, 64.02875495335014, 15.436363726712667, 71.6804322862789, 19.248548497631596, 0.0, 20.927755043858866, 2.4270410005514056, 107.41324657138883, 80.73930463043045, 803.4890676474428, 3.4251694985486916, 95.49905717413398, 60.7805627200135, 98.18495214174683, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5388392493240594, "mean_inference_ms": 1.6585343605433907, "mean_action_processing_ms": 0.24323899346116548, "mean_env_wait_ms": 0.18286865128817872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004693746566772461, "StateBufferConnector_ms": 0.0030106306076049805, "ViewRequirementAgentConnector_ms": 0.08964502811431885}, "num_episodes": 18, "episode_return_max": 366.08265000363633, "episode_return_min": -412.8893087361584, "episode_return_mean": 139.49113597050538, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.2355185969666, "num_env_steps_trained_throughput_per_sec": 407.2355185969666, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 9992.152, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9992.119, "sample_time_ms": 1235.618, "learn_time_ms": 8742.409, "learn_throughput": 457.54, "synch_weights_time_ms": 13.388}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "74486_00000", "date": "2024-08-16_15-11-35", "timestamp": 1723801295, "time_this_iter_s": 9.826884031295776, "time_total_s": 962.6298649311066, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3980e6e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 962.6298649311066, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 28.571428571428573, "ram_util_percent": 78.87142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.898701772298763, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.710674797542511, "policy_loss": -0.010832792504754647, "vf_loss": 5.719688406697026, "vf_explained_var": 0.12534419257174093, "kl": 0.016170623687489224, "entropy": 0.9883962721736342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.090211903985846, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6504760732726447, "policy_loss": -0.003024616073225699, "vf_loss": 2.653274198499306, "vf_explained_var": 0.005888446676668036, "kl": 0.00805302245905232, "entropy": 0.6238530761665768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 366.08265000363633, "episode_reward_min": -378.5104889589085, "episode_reward_mean": 149.39581351152347, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1096.3048497423347, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.7694123864343, "predator_policy": 927.5347940638969}, "policy_reward_mean": {"prey_policy": -47.221796409067196, "predator_policy": 121.91970316482897}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.34862249909253, 156.38000000000008, 263.48110030247835, 330.36999999999983, 229.39000000000004, 143.4300000000003, -9.651631548729, 198.22976049067933, 282.73577038222754, 43.73999999999999, 137.8441379944101, 87.87000000000008, 301.5599999999997, -128.14558140313713, 155.15626318701993, 316.3528178858578, 130.1200000000004, 292.370747836078, 112.57000000000042, 264.1799999999995, 139.77793178147047, 147.30999999999997, 133.63000000000068, 318.34211379299205, 138.97000000000003, 136.71037005023484, 123.86024130591731, 239.26000000000016, 159.53999999999994, 11.81935357670137, 218.95999999999975, 107.27999999999992, 5.8199999999999195, 146.28000000000003, 250.25, 271.20000000000005, -1.8126919587504287, 161.2199999999999, 275.0899999999997, 221.53703290419375, 241.21547531040767, 297.87999999999965, 142.36000000000013, 108.41000000000054, 3.9199999999999595, 58.69999999999999, 238.0077527029622, 281.0799999999996, -278.51347121983963, 366.08265000363633, -79.94007906656012, 3.849999999999962, 166.68351951840924, 122.20000000000032, 182.2237221212235, 164.13999999999996, 135.63000000000034, 195.93999999999969, 223.31999999999982, 75.87355368278237, 132.90566939179192, 155.44000000000005, 122.11000000000027, 174.2437942493862, 284.9999999999998, -41.55542012291809, 175.02999999999986, 153.70000000000005, 292.2599999999999, -221.28889587893855, 190.20907485549765, 192.6525628992109, 164.28999999999965, 177.1599999999995, 47.02295338965358, -378.5104889589085, 149.75139924535574, 169.11999999999966, 350.8739052061911, 163.04000000000002, 157.85999999999996, 295.656303588446, 192.17774366867923, 3.7699999999999623, 165.9949058048575, 113.21759850264476, 332.3699999999998, 193.23594849192818, 182.75999999999985, 361.09557777087184, -9.183355069084469, 274.94523172604784, -82.80046964532156, 175.15999999999985, 313.877829905197, 36.7000000000001, 130.35000000000002, 135.22000000000003, 89.94000000000008, 59.33999999999983], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-230.09192534026005, 21.945086443711972, 114.37282870370653, 2.0000000000000013, 121.18442605774005, -25.4005616094746, 25.9997806718912, 143.61265995296012, 96.01383579603171, 43.98569898071695, 104.7346590887221, -0.2553301200677598, -24.79586887384726, -18.194566492232546, 115.24121268661793, 2.0000000000000013, 79.76012086366529, 177.90051039174102, -138.37715073784582, -509.93584776832984, -16.58070389986201, 110.11633308851495, -18.977355278909062, -186.66495878973234, 116.32588192930723, 29.881608273211906, -311.3763949246452, -437.4390747102701, -420.7807064709909, -99.70450715957745, 162.5607036202072, 33.25932753205642, 9.332701650952615, -1.436629525519973, -27.3953265019555, -96.11332868234298, -14.645546390722455, -8.272915335455108, 91.83663378960573, 84.29526722964137, -541.6103797365694, -55.476285133149574, 2.0000000000000013, -12.262624609442135, -12.115062747399303, 129.59314023657788, 127.73338722225887, -206.17356724839897, -7.708841575500671, -364.4379394669913, -120.75879072828334, -17.601469830246813, -35.52321863842816, -22.200465721090065, 34.569543815352716, 51.52406247151156, -571.2668797067254, 146.68933202344436, -3.77688151112317, -144.8222435216272, -157.99086634347773, 49.458433825203876, 86.23709413494534, -477.53568599382305, -22.253509581836873, -1.587395238241212, -42.71196337499286, 93.40272755872509, 3.6649966546525192, 154.19884424372464, 105.66418620014288, 133.0356972010054, -7.042814688673802, -5.080870925657438, 126.56092511846265, -17.14391889073325, 132.68000000000004, 104.62638852362933, -137.0824116238088, 20.531544748029262, 86.44820401666942, 110.31090054438572, 100.01373692710808, 128.83359553970428, -5.416869161181677, 81.39443654395546, -12.75591825714013, -6.804014110809062, -3.6790931878501256, -10.408962684240258, -356.55296760865025, -430.4077201060043, -40.34193091007157, 66.34999999999997, 154.8380118803725, 95.98816918382967, -628.3916939993865, -363.7199261249894, -5.504661690801896, 175.23682828300178, -346.3017339745685, -430.1967350155714, -23.143022434659635, -2.259445108442222, 136.90769238114154, -45.31666624452647, -151.98635079647894, -18.981937438849904, 116.03379500565084, -27.440894876761806, 127.3645771459107, -44.22729521628119, 133.67000000000007, -6.501824134507949, -16.574352540357744, 185.7694123864343, -17.438452401160504, 70.66336778992529, -111.4400628385958, -254.81918237191815, 13.319457769882288, -532.8414225868108, 142.99014404457643, 2.0000000000000013, -78.88235348252331, -2.2135660280014218, -29.149051532536657, 18.799652821749344, 97.27365955375429, 124.75074860596011, -89.89135273520694, -140.5684639969727, -38.45434672980072, 123.43120406743313, -162.7894009570343, 54.975480559915916, 89.19184001133507, -126.60931923530813, -432.1891694332812, -399.0694405941153, 105.30954273375423, -44.9096800978524, 164.25866444299544, -58.72289755677604, 143.0414515023682, 2.0000000000000013, 154.24224495614098, -0.43704100055141315, -27.178942319379484, -113.95065549278424, -561.2318895716086, -624.1928365332919, -89.83465447476932, 83.30643382597846, 68.93504785825314, 2.0000000000000013, -1096.3048497423347, -230.47673516399112, -95.32748084099262, 111.17173109676604, -317.6296869786458, 129.06090217093498, 94.04606101367544, 78.2219171473782, -30.90933506504367, 111.24099639935554, -53.6338271938729, -28.289434207849848, -255.70263562854763, 150.23383948871788, 65.9383245614376, -927.5347940638969, 116.68769173905567, 107.42727593638669, 39.76911715802217, 4.687142099484914, -55.892168547930474, 134.11607612631974, 147.09369914492598, 98.21200545721756, -92.90987018898022, -264.8696139398043, 65.19979262956599, 65.76489202956378, -262.1219820602496, -734.8710718851084, -39.765432423261636, 164.86390401381547, 114.31970084655477, 136.2583064472011, -23.478769798393525, -139.30988886756901, -101.72948795023127, 13.19525016146716, 11.864054350442288, -105.10177820977555, 45.61896468486586, -18.61368968562973, -425.97451651713675, -12.750775627532956], "policy_predator_policy_reward": [325.0988491588083, 85.39661223683231, 40.00717129629351, 0.0, 155.19317660626305, 12.504059247949929, 142.05021932810882, 18.7073400470397, 19.44063242774349, 69.94983279550789, 36.705340911278, 2.2453301200677562, 5.12761857806112, 28.211185239290373, 40.670297945678435, 40.31824985838323, 13.26987913633469, 11.805259990486416, 140.04715073784433, 552.0058477683298, 22.7644676370815, 21.544041168675072, 21.847355278909347, 271.66495878973234, 127.6656696552343, 27.686840142246734, 57.31739989491165, 563.3524883368663, 482.8436953885241, 192.79778142906343, 24.518331119891283, 96.01445561370338, 118.80729834904734, 3.4166295255199435, 208.09924825928843, 207.78015476108988, 125.2655463907226, 10.222915335455067, 46.693366210394394, 41.35473277035872, 191.633540244314, 545.2310564068755, 0.0, 157.57262460944207, 14.065062747399262, 2.0868597634223454, 195.95480656333282, 200.82748725579984, 119.10884157550086, 392.00793946699076, 109.24594948262012, 165.8246811261447, 126.08178529481317, 55.50214037062218, 100.8104561846474, 52.3559375284884, 13.245895621109531, 570.8716520621715, 13.936235087824576, 146.4822435216257, 258.28086634347744, 69.21156617479608, 474.8870498233551, 23.69154203552269, 19.175927312049353, 10.484977508028988, 44.59196337499249, 50.99727244127496, 87.20500334534762, 5.181155756275328, 16.937361347436976, 15.562755251414822, 10.310993655580807, 0.0, 32.72907488153737, 19.07391889073355, 0.0, 37.78361147637078, 67.67201247808927, 270.4158873018849, 9.574436735562823, 34.881934013790335, 67.1762630728919, 1.8564044602958392, 7.376869161181635, 59.005563456044555, 119.20591825714018, 8.76401411080902, 3.503578252343646, 14.504477619746654, 413.56296760865024, 432.09772010600403, 106.4874716923805, 105.51221192065333, 17.36198811962762, 12.891830816170351, 655.4064309581529, 58.19171794638274, 179.57731169443827, 16.773171716998238, 638.030078156076, 58.52831176750361, 15.385451414566736, 13.867016128535365, 29.91384382509951, 45.1786495566941, 153.60635079647747, 139.56193743884944, 57.07620499434917, 36.55461699798577, 34.865422854089395, 46.13729521628081, 0.0, 8.461824134507907, 18.49435254035804, 8.250587613565695, 168.46402578995475, 1.6310588212810648, 99.48935629104999, 342.643442602246, 544.1379362084441, 108.28969800027623, 10.449855955423649, 0.0, 199.0123534825233, 4.19356602800138, 144.9500621501073, 39.64313081006616, 47.19634044624577, 15.779251394039946, 102.21382323466133, 86.69057337460045, 40.35434672980034, 49.69879593256686, 164.3294009570331, 97.18451944008406, 260.1999147430683, 69.47756448090465, 7.570328742348705, 602.399385406109, 65.78045726624582, 64.02875495335014, 15.436363726712667, 71.6804322862789, 19.248548497631596, 0.0, 20.927755043858866, 2.4270410005514056, 107.41324657138883, 80.73930463043045, 803.4890676474428, 3.4251694985486916, 95.49905717413398, 60.7805627200135, 98.18495214174683, 0.0, 784.8877828276078, 892.7677072849132, 97.09748084099353, 50.098268903234015, 318.22968697864525, 28.199097829065128, 72.06024257477104, 51.32808285262172, 59.893255550506616, 51.95282678386104, 55.51382719387252, 30.179434207850143, 255.00772982368863, 16.455972120998023, 47.27927394120701, 927.5347940638969, 44.58230826094448, 63.67272406361333, 20.08683133390595, 128.69285790051524, 57.652168547930124, 46.883923873680224, 61.07256354747, 54.71730962125839, 8.607225136538585, 339.9889039231616, 74.07456209586621, 69.90598497105168, 131.3554750722727, 782.8371092277632, 41.69543242326125, 8.366095986184526, 8.022801196717907, 55.27702141472355, 25.34876979839381, 174.1398888675694, 110.42948795023214, 108.45474983853313, 121.52594564955791, 106.93177820977648, 42.41103531513429, 20.52368968563003, 483.3745165171364, 14.690775627532915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5383548104238064, "mean_inference_ms": 1.657681014228546, "mean_action_processing_ms": 0.24285555078483867, "mean_env_wait_ms": 0.18263681801302126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005257844924926758, "StateBufferConnector_ms": 0.0030204057693481445, "ViewRequirementAgentConnector_ms": 0.09003472328186035}, "num_episodes": 22, "episode_return_max": 366.08265000363633, "episode_return_min": -378.5104889589085, "episode_return_mean": 149.39581351152347, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 410.24724114299664, "num_env_steps_trained_throughput_per_sec": 410.24724114299664, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 9990.272, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9990.237, "sample_time_ms": 1230.475, "learn_time_ms": 8745.727, "learn_throughput": 457.366, "synch_weights_time_ms": 13.315}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "74486_00000", "date": "2024-08-16_15-11-45", "timestamp": 1723801305, "time_this_iter_s": 9.757165908813477, "time_total_s": 972.38703083992, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39738fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 972.38703083992, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 33.43846153846154, "ram_util_percent": 78.70769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.161952412380743, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.507749092768109, "policy_loss": -0.003411058130767689, "vf_loss": 6.509900185166213, "vf_explained_var": 0.11723474390292293, "kl": 0.011199883646803563, "entropy": 1.0219291877494288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4852551881913785, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9815474684907013, "policy_loss": -0.0038622789651589105, "vf_loss": 2.9851376595320525, "vf_explained_var": 0.006339744852964209, "kl": 0.009674243924811459, "entropy": 0.6380178625936861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 366.08265000363633, "episode_reward_min": -438.66810681321266, "episode_reward_mean": 139.94313408955935, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1096.3048497423347, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.7694123864343, "predator_policy": 927.5347940638969}, "policy_reward_mean": {"prey_policy": -55.42154563647032, "predator_policy": 125.39311268125006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.57000000000042, 264.1799999999995, 139.77793178147047, 147.30999999999997, 133.63000000000068, 318.34211379299205, 138.97000000000003, 136.71037005023484, 123.86024130591731, 239.26000000000016, 159.53999999999994, 11.81935357670137, 218.95999999999975, 107.27999999999992, 5.8199999999999195, 146.28000000000003, 250.25, 271.20000000000005, -1.8126919587504287, 161.2199999999999, 275.0899999999997, 221.53703290419375, 241.21547531040767, 297.87999999999965, 142.36000000000013, 108.41000000000054, 3.9199999999999595, 58.69999999999999, 238.0077527029622, 281.0799999999996, -278.51347121983963, 366.08265000363633, -79.94007906656012, 3.849999999999962, 166.68351951840924, 122.20000000000032, 182.2237221212235, 164.13999999999996, 135.63000000000034, 195.93999999999969, 223.31999999999982, 75.87355368278237, 132.90566939179192, 155.44000000000005, 122.11000000000027, 174.2437942493862, 284.9999999999998, -41.55542012291809, 175.02999999999986, 153.70000000000005, 292.2599999999999, -221.28889587893855, 190.20907485549765, 192.6525628992109, 164.28999999999965, 177.1599999999995, 47.02295338965358, -378.5104889589085, 149.75139924535574, 169.11999999999966, 350.8739052061911, 163.04000000000002, 157.85999999999996, 295.656303588446, 192.17774366867923, 3.7699999999999623, 165.9949058048575, 113.21759850264476, 332.3699999999998, 193.23594849192818, 182.75999999999985, 361.09557777087184, -9.183355069084469, 274.94523172604784, -82.80046964532156, 175.15999999999985, 313.877829905197, 36.7000000000001, 130.35000000000002, 135.22000000000003, 89.94000000000008, 59.33999999999983, 162.59999999999982, 284.76999999999964, 24.202334229916993, 149.22198682144605, 3.8399999999999603, 19.417268499039647, 157.75000000000006, 155.25000000000023, 105.85000000000029, 303.93739232293245, 94.7229320854356, 171.00045891983538, 249.28999999999982, 158.52128929192708, 140.0000000000001, -438.66810681321266, 168.21999999999974, 278.38851007224946], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.645546390722455, -8.272915335455108, 91.83663378960573, 84.29526722964137, -541.6103797365694, -55.476285133149574, 2.0000000000000013, -12.262624609442135, -12.115062747399303, 129.59314023657788, 127.73338722225887, -206.17356724839897, -7.708841575500671, -364.4379394669913, -120.75879072828334, -17.601469830246813, -35.52321863842816, -22.200465721090065, 34.569543815352716, 51.52406247151156, -571.2668797067254, 146.68933202344436, -3.77688151112317, -144.8222435216272, -157.99086634347773, 49.458433825203876, 86.23709413494534, -477.53568599382305, -22.253509581836873, -1.587395238241212, -42.71196337499286, 93.40272755872509, 3.6649966546525192, 154.19884424372464, 105.66418620014288, 133.0356972010054, -7.042814688673802, -5.080870925657438, 126.56092511846265, -17.14391889073325, 132.68000000000004, 104.62638852362933, -137.0824116238088, 20.531544748029262, 86.44820401666942, 110.31090054438572, 100.01373692710808, 128.83359553970428, -5.416869161181677, 81.39443654395546, -12.75591825714013, -6.804014110809062, -3.6790931878501256, -10.408962684240258, -356.55296760865025, -430.4077201060043, -40.34193091007157, 66.34999999999997, 154.8380118803725, 95.98816918382967, -628.3916939993865, -363.7199261249894, -5.504661690801896, 175.23682828300178, -346.3017339745685, -430.1967350155714, -23.143022434659635, -2.259445108442222, 136.90769238114154, -45.31666624452647, -151.98635079647894, -18.981937438849904, 116.03379500565084, -27.440894876761806, 127.3645771459107, -44.22729521628119, 133.67000000000007, -6.501824134507949, -16.574352540357744, 185.7694123864343, -17.438452401160504, 70.66336778992529, -111.4400628385958, -254.81918237191815, 13.319457769882288, -532.8414225868108, 142.99014404457643, 2.0000000000000013, -78.88235348252331, -2.2135660280014218, -29.149051532536657, 18.799652821749344, 97.27365955375429, 124.75074860596011, -89.89135273520694, -140.5684639969727, -38.45434672980072, 123.43120406743313, -162.7894009570343, 54.975480559915916, 89.19184001133507, -126.60931923530813, -432.1891694332812, -399.0694405941153, 105.30954273375423, -44.9096800978524, 164.25866444299544, -58.72289755677604, 143.0414515023682, 2.0000000000000013, 154.24224495614098, -0.43704100055141315, -27.178942319379484, -113.95065549278424, -561.2318895716086, -624.1928365332919, -89.83465447476932, 83.30643382597846, 68.93504785825314, 2.0000000000000013, -1096.3048497423347, -230.47673516399112, -95.32748084099262, 111.17173109676604, -317.6296869786458, 129.06090217093498, 94.04606101367544, 78.2219171473782, -30.90933506504367, 111.24099639935554, -53.6338271938729, -28.289434207849848, -255.70263562854763, 150.23383948871788, 65.9383245614376, -927.5347940638969, 116.68769173905567, 107.42727593638669, 39.76911715802217, 4.687142099484914, -55.892168547930474, 134.11607612631974, 147.09369914492598, 98.21200545721756, -92.90987018898022, -264.8696139398043, 65.19979262956599, 65.76489202956378, -262.1219820602496, -734.8710718851084, -39.765432423261636, 164.86390401381547, 114.31970084655477, 136.2583064472011, -23.478769798393525, -139.30988886756901, -101.72948795023127, 13.19525016146716, 11.864054350442288, -105.10177820977555, 45.61896468486586, -18.61368968562973, -425.97451651713675, -12.750775627532956, -498.2629618911009, 149.8926139928584, 67.21069903074962, 43.78914661819619, -30.848426891502683, -92.24472246390826, -105.74609652807997, 42.79168520002581, -2.141255668476246, -48.37729024300437, -47.39366081212436, -7.702471287275717, 101.48789191633671, -411.8898471422646, -30.356446189605226, 136.37409578703893, -126.49527220138113, -184.21497496395756, 93.07130050888513, 131.19030033800556, 2.0000000000000013, -395.3274382521921, -166.52266372494176, -291.7396066908359, 55.784152177422406, 137.18767285406142, -0.1388268303966187, 141.5491760949783, 134.47592212428756, -445.1399670394036, -636.148426538828, -687.9955500004188, 114.06695954339453, -2.7656639954129414, 69.14888898245297, 98.18835755168635], "policy_predator_policy_reward": [125.2655463907226, 10.222915335455067, 46.693366210394394, 41.35473277035872, 191.633540244314, 545.2310564068755, 0.0, 157.57262460944207, 14.065062747399262, 2.0868597634223454, 195.95480656333282, 200.82748725579984, 119.10884157550086, 392.00793946699076, 109.24594948262012, 165.8246811261447, 126.08178529481317, 55.50214037062218, 100.8104561846474, 52.3559375284884, 13.245895621109531, 570.8716520621715, 13.936235087824576, 146.4822435216257, 258.28086634347744, 69.21156617479608, 474.8870498233551, 23.69154203552269, 19.175927312049353, 10.484977508028988, 44.59196337499249, 50.99727244127496, 87.20500334534762, 5.181155756275328, 16.937361347436976, 15.562755251414822, 10.310993655580807, 0.0, 32.72907488153737, 19.07391889073355, 0.0, 37.78361147637078, 67.67201247808927, 270.4158873018849, 9.574436735562823, 34.881934013790335, 67.1762630728919, 1.8564044602958392, 7.376869161181635, 59.005563456044555, 119.20591825714018, 8.76401411080902, 3.503578252343646, 14.504477619746654, 413.56296760865024, 432.09772010600403, 106.4874716923805, 105.51221192065333, 17.36198811962762, 12.891830816170351, 655.4064309581529, 58.19171794638274, 179.57731169443827, 16.773171716998238, 638.030078156076, 58.52831176750361, 15.385451414566736, 13.867016128535365, 29.91384382509951, 45.1786495566941, 153.60635079647747, 139.56193743884944, 57.07620499434917, 36.55461699798577, 34.865422854089395, 46.13729521628081, 0.0, 8.461824134507907, 18.49435254035804, 8.250587613565695, 168.46402578995475, 1.6310588212810648, 99.48935629104999, 342.643442602246, 544.1379362084441, 108.28969800027623, 10.449855955423649, 0.0, 199.0123534825233, 4.19356602800138, 144.9500621501073, 39.64313081006616, 47.19634044624577, 15.779251394039946, 102.21382323466133, 86.69057337460045, 40.35434672980034, 49.69879593256686, 164.3294009570331, 97.18451944008406, 260.1999147430683, 69.47756448090465, 7.570328742348705, 602.399385406109, 65.78045726624582, 64.02875495335014, 15.436363726712667, 71.6804322862789, 19.248548497631596, 0.0, 20.927755043858866, 2.4270410005514056, 107.41324657138883, 80.73930463043045, 803.4890676474428, 3.4251694985486916, 95.49905717413398, 60.7805627200135, 98.18495214174683, 0.0, 784.8877828276078, 892.7677072849132, 97.09748084099353, 50.098268903234015, 318.22968697864525, 28.199097829065128, 72.06024257477104, 51.32808285262172, 59.893255550506616, 51.95282678386104, 55.51382719387252, 30.179434207850143, 255.00772982368863, 16.455972120998023, 47.27927394120701, 927.5347940638969, 44.58230826094448, 63.67272406361333, 20.08683133390595, 128.69285790051524, 57.652168547930124, 46.883923873680224, 61.07256354747, 54.71730962125839, 8.607225136538585, 339.9889039231616, 74.07456209586621, 69.90598497105168, 131.3554750722727, 782.8371092277632, 41.69543242326125, 8.366095986184526, 8.022801196717907, 55.27702141472355, 25.34876979839381, 174.1398888675694, 110.42948795023214, 108.45474983853313, 121.52594564955791, 106.93177820977648, 42.41103531513429, 20.52368968563003, 483.3745165171364, 14.690775627532915, 99.71832449737738, 411.25202340086565, 67.26930096925045, 106.50085338180384, 51.63431357966516, 95.6611700056632, 6.2711701470567185, 205.90522800244327, 4.121255668476204, 50.237290243004, 23.348333182298532, 51.165067416140246, 412.61505716224667, 55.53689806368114, 32.226446189605454, 17.005904212961184, 128.13527220138187, 288.42497496395737, 56.122197185845444, 23.553594290196564, 27.885121627862866, 460.16524870976474, 322.76729381917727, 306.4954355164352, 0.0, 56.31817496851625, 8.739373073532747, 8.371566953812541, 5.1140778757125975, 445.54996703940367, 875.0356305652116, 10.440239160823047, 52.1730404566055, 4.745663995412899, 8.314222827879037, 102.73704071023138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5380306474091676, "mean_inference_ms": 1.6573560665522045, "mean_action_processing_ms": 0.24256268078743304, "mean_env_wait_ms": 0.18246475312732272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005605101585388184, "StateBufferConnector_ms": 0.003049015998840332, "ViewRequirementAgentConnector_ms": 0.09000849723815918}, "num_episodes": 18, "episode_return_max": 366.08265000363633, "episode_return_min": -438.66810681321266, "episode_return_mean": 139.94313408955935, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.2465410243325, "num_env_steps_trained_throughput_per_sec": 399.2465410243325, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 9993.246, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9993.211, "sample_time_ms": 1226.539, "learn_time_ms": 8752.702, "learn_throughput": 457.002, "synch_weights_time_ms": 13.188}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "74486_00000", "date": "2024-08-16_15-11-55", "timestamp": 1723801315, "time_this_iter_s": 10.024195194244385, "time_total_s": 982.4112260341644, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397330820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 982.4112260341644, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 32.47333333333334, "ram_util_percent": 78.82666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.59277914951718, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.020937905488191, "policy_loss": -0.0034667046257743127, "vf_loss": 6.023631172583848, "vf_explained_var": 0.07074653657655867, "kl": 0.006874985031414241, "entropy": 1.031460883377721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9423512352679773, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2406482792405225, "policy_loss": -0.0052710778641677095, "vf_loss": 3.2453774578987606, "vf_explained_var": 0.0046754492023003795, "kl": 0.019267690646196295, "entropy": 0.6191518057275701, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 535.9231562568024, "episode_reward_min": -438.66810681321266, "episode_reward_mean": 125.74459221452422, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1096.3048497423347, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.7694123864343, "predator_policy": 927.5347940638969}, "policy_reward_mean": {"prey_policy": -74.67731389924559, "predator_policy": 137.54961000650775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.87999999999965, 142.36000000000013, 108.41000000000054, 3.9199999999999595, 58.69999999999999, 238.0077527029622, 281.0799999999996, -278.51347121983963, 366.08265000363633, -79.94007906656012, 3.849999999999962, 166.68351951840924, 122.20000000000032, 182.2237221212235, 164.13999999999996, 135.63000000000034, 195.93999999999969, 223.31999999999982, 75.87355368278237, 132.90566939179192, 155.44000000000005, 122.11000000000027, 174.2437942493862, 284.9999999999998, -41.55542012291809, 175.02999999999986, 153.70000000000005, 292.2599999999999, -221.28889587893855, 190.20907485549765, 192.6525628992109, 164.28999999999965, 177.1599999999995, 47.02295338965358, -378.5104889589085, 149.75139924535574, 169.11999999999966, 350.8739052061911, 163.04000000000002, 157.85999999999996, 295.656303588446, 192.17774366867923, 3.7699999999999623, 165.9949058048575, 113.21759850264476, 332.3699999999998, 193.23594849192818, 182.75999999999985, 361.09557777087184, -9.183355069084469, 274.94523172604784, -82.80046964532156, 175.15999999999985, 313.877829905197, 36.7000000000001, 130.35000000000002, 135.22000000000003, 89.94000000000008, 59.33999999999983, 162.59999999999982, 284.76999999999964, 24.202334229916993, 149.22198682144605, 3.8399999999999603, 19.417268499039647, 157.75000000000006, 155.25000000000023, 105.85000000000029, 303.93739232293245, 94.7229320854356, 171.00045891983538, 249.28999999999982, 158.52128929192708, 140.0000000000001, -438.66810681321266, 168.21999999999974, 278.38851007224946, 72.97398220906744, 182.01999999999964, 535.9231562568024, 3.7099999999999596, 99.36000000000016, 3.6199999999999637, 339.39999999999975, 308.5461097659643, 5.327016709860666, 128.5100000000004, 106.68000000000029, 83.22000000000044, 138.97507079249655, 35.01000000000002, -221.81824854201957, 72.78, -89.44240283130617, 175.8699999999996, 171.08379272439413, 40.119999999999976, -154.14688067579743, 178.68999999999977, 186.7440428501868], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [100.01373692710808, 128.83359553970428, -5.416869161181677, 81.39443654395546, -12.75591825714013, -6.804014110809062, -3.6790931878501256, -10.408962684240258, -356.55296760865025, -430.4077201060043, -40.34193091007157, 66.34999999999997, 154.8380118803725, 95.98816918382967, -628.3916939993865, -363.7199261249894, -5.504661690801896, 175.23682828300178, -346.3017339745685, -430.1967350155714, -23.143022434659635, -2.259445108442222, 136.90769238114154, -45.31666624452647, -151.98635079647894, -18.981937438849904, 116.03379500565084, -27.440894876761806, 127.3645771459107, -44.22729521628119, 133.67000000000007, -6.501824134507949, -16.574352540357744, 185.7694123864343, -17.438452401160504, 70.66336778992529, -111.4400628385958, -254.81918237191815, 13.319457769882288, -532.8414225868108, 142.99014404457643, 2.0000000000000013, -78.88235348252331, -2.2135660280014218, -29.149051532536657, 18.799652821749344, 97.27365955375429, 124.75074860596011, -89.89135273520694, -140.5684639969727, -38.45434672980072, 123.43120406743313, -162.7894009570343, 54.975480559915916, 89.19184001133507, -126.60931923530813, -432.1891694332812, -399.0694405941153, 105.30954273375423, -44.9096800978524, 164.25866444299544, -58.72289755677604, 143.0414515023682, 2.0000000000000013, 154.24224495614098, -0.43704100055141315, -27.178942319379484, -113.95065549278424, -561.2318895716086, -624.1928365332919, -89.83465447476932, 83.30643382597846, 68.93504785825314, 2.0000000000000013, -1096.3048497423347, -230.47673516399112, -95.32748084099262, 111.17173109676604, -317.6296869786458, 129.06090217093498, 94.04606101367544, 78.2219171473782, -30.90933506504367, 111.24099639935554, -53.6338271938729, -28.289434207849848, -255.70263562854763, 150.23383948871788, 65.9383245614376, -927.5347940638969, 116.68769173905567, 107.42727593638669, 39.76911715802217, 4.687142099484914, -55.892168547930474, 134.11607612631974, 147.09369914492598, 98.21200545721756, -92.90987018898022, -264.8696139398043, 65.19979262956599, 65.76489202956378, -262.1219820602496, -734.8710718851084, -39.765432423261636, 164.86390401381547, 114.31970084655477, 136.2583064472011, -23.478769798393525, -139.30988886756901, -101.72948795023127, 13.19525016146716, 11.864054350442288, -105.10177820977555, 45.61896468486586, -18.61368968562973, -425.97451651713675, -12.750775627532956, -498.2629618911009, 149.8926139928584, 67.21069903074962, 43.78914661819619, -30.848426891502683, -92.24472246390826, -105.74609652807997, 42.79168520002581, -2.141255668476246, -48.37729024300437, -47.39366081212436, -7.702471287275717, 101.48789191633671, -411.8898471422646, -30.356446189605226, 136.37409578703893, -126.49527220138113, -184.21497496395756, 93.07130050888513, 131.19030033800556, 2.0000000000000013, -395.3274382521921, -166.52266372494176, -291.7396066908359, 55.784152177422406, 137.18767285406142, -0.1388268303966187, 141.5491760949783, 134.47592212428756, -445.1399670394036, -636.148426538828, -687.9955500004188, 114.06695954339453, -2.7656639954129414, 69.14888898245297, 98.18835755168635, -29.9782457316556, -128.75021125659947, 149.46322831220306, -14.43693379758817, 180.05617389057852, -445.7691218323117, -106.25089634861534, 2.0000000000000013, -444.931994314665, 81.8011489868577, -115.34068265086323, -47.20787739204784, 132.63682035444907, 159.23364921941743, 65.60889104257359, 77.86699384744466, -53.621065154318565, -621.3276472744839, 2.0000000000000013, -9.533724896822783, 54.986031473897306, -20.820881688646086, 2.0000000000000013, -112.22511379069853, -1.142767342546863, -494.63094423907427, -49.67932661463908, -81.72388275661311, -577.4626071222043, -279.6669004067882, -21.659455527104093, -90.23632536016706, -881.9539483387421, -516.920756786523, 131.50689839437086, -74.11623574800146, -1.2222698055410275, 72.83635940780161, -387.97834260625024, 28.662281662963323, -352.15948992373757, -236.25358130513962, 135.9697930802019, -106.04397657042608, 50.638806095467615, -7.396760744898595], "policy_predator_policy_reward": [67.1762630728919, 1.8564044602958392, 7.376869161181635, 59.005563456044555, 119.20591825714018, 8.76401411080902, 3.503578252343646, 14.504477619746654, 413.56296760865024, 432.09772010600403, 106.4874716923805, 105.51221192065333, 17.36198811962762, 12.891830816170351, 655.4064309581529, 58.19171794638274, 179.57731169443827, 16.773171716998238, 638.030078156076, 58.52831176750361, 15.385451414566736, 13.867016128535365, 29.91384382509951, 45.1786495566941, 153.60635079647747, 139.56193743884944, 57.07620499434917, 36.55461699798577, 34.865422854089395, 46.13729521628081, 0.0, 8.461824134507907, 18.49435254035804, 8.250587613565695, 168.46402578995475, 1.6310588212810648, 99.48935629104999, 342.643442602246, 544.1379362084441, 108.28969800027623, 10.449855955423649, 0.0, 199.0123534825233, 4.19356602800138, 144.9500621501073, 39.64313081006616, 47.19634044624577, 15.779251394039946, 102.21382323466133, 86.69057337460045, 40.35434672980034, 49.69879593256686, 164.3294009570331, 97.18451944008406, 260.1999147430683, 69.47756448090465, 7.570328742348705, 602.399385406109, 65.78045726624582, 64.02875495335014, 15.436363726712667, 71.6804322862789, 19.248548497631596, 0.0, 20.927755043858866, 2.4270410005514056, 107.41324657138883, 80.73930463043045, 803.4890676474428, 3.4251694985486916, 95.49905717413398, 60.7805627200135, 98.18495214174683, 0.0, 784.8877828276078, 892.7677072849132, 97.09748084099353, 50.098268903234015, 318.22968697864525, 28.199097829065128, 72.06024257477104, 51.32808285262172, 59.893255550506616, 51.95282678386104, 55.51382719387252, 30.179434207850143, 255.00772982368863, 16.455972120998023, 47.27927394120701, 927.5347940638969, 44.58230826094448, 63.67272406361333, 20.08683133390595, 128.69285790051524, 57.652168547930124, 46.883923873680224, 61.07256354747, 54.71730962125839, 8.607225136538585, 339.9889039231616, 74.07456209586621, 69.90598497105168, 131.3554750722727, 782.8371092277632, 41.69543242326125, 8.366095986184526, 8.022801196717907, 55.27702141472355, 25.34876979839381, 174.1398888675694, 110.42948795023214, 108.45474983853313, 121.52594564955791, 106.93177820977648, 42.41103531513429, 20.52368968563003, 483.3745165171364, 14.690775627532915, 99.71832449737738, 411.25202340086565, 67.26930096925045, 106.50085338180384, 51.63431357966516, 95.6611700056632, 6.2711701470567185, 205.90522800244327, 4.121255668476204, 50.237290243004, 23.348333182298532, 51.165067416140246, 412.61505716224667, 55.53689806368114, 32.226446189605454, 17.005904212961184, 128.13527220138187, 288.42497496395737, 56.122197185845444, 23.553594290196564, 27.885121627862866, 460.16524870976474, 322.76729381917727, 306.4954355164352, 0.0, 56.31817496851625, 8.739373073532747, 8.371566953812541, 5.1140778757125975, 445.54996703940367, 875.0356305652116, 10.440239160823047, 52.1730404566055, 4.745663995412899, 8.314222827879037, 102.73704071023138, 100.76478684885541, 130.9376523484642, 30.606771687796897, 16.386933797588195, 408.36447324405725, 393.2716309544792, 107.96089634861622, 0.0, 7.825630064248494, 454.6652152635588, 117.11068265086413, 49.05787739204747, 26.673179645551045, 20.856350780582492, 92.4880300756733, 72.58219480027319, 4.4940858815601565, 675.7816432571028, 0.0, 136.0437248968229, 49.79396852610267, 22.72088168864637, 0.0, 193.4451137906985, 137.4927673425468, 497.2560150315704, 51.50932661463872, 114.90388275661323, 610.0611238884381, 25.25013509853499, 23.599455527104396, 161.07632536016695, 923.389188644323, 386.04311364963627, 42.63310160562914, 75.84623574800234, 51.768201172778134, 47.701501949355624, 33.942271692312715, 365.49378925097415, 364.1044976077978, 70.16169294528193, 41.11020691979811, 107.6539765704268, 132.720266732247, 10.781730767370584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5376970075324176, "mean_inference_ms": 1.657131062076087, "mean_action_processing_ms": 0.24221968997588053, "mean_env_wait_ms": 0.18226212068314618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005185604095458984, "StateBufferConnector_ms": 0.0030237436294555664, "ViewRequirementAgentConnector_ms": 0.08891093730926514}, "num_episodes": 23, "episode_return_max": 535.9231562568024, "episode_return_min": -438.66810681321266, "episode_return_mean": 125.74459221452422, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.7155926120172, "num_env_steps_trained_throughput_per_sec": 409.7155926120172, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 9976.992, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9976.957, "sample_time_ms": 1228.521, "learn_time_ms": 8734.417, "learn_throughput": 457.958, "synch_weights_time_ms": 13.184}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "74486_00000", "date": "2024-08-16_15-12-04", "timestamp": 1723801324, "time_this_iter_s": 9.768809080123901, "time_total_s": 992.1800351142883, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397740940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 992.1800351142883, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 28.83846153846154, "ram_util_percent": 78.76153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.857663053589523, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.31092807981703, "policy_loss": -0.0037587099122228444, "vf_loss": 6.313805551629849, "vf_explained_var": 0.1656574826707285, "kl": 0.007833204188005843, "entropy": 1.001172514882668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7642349117016667, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.037058799607413, "policy_loss": -0.0034184354092561143, "vf_loss": 3.0400793986345724, "vf_explained_var": 0.008745120284418581, "kl": 0.014145176321294842, "entropy": 0.6878553723532056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 535.9231562568024, "episode_reward_min": -439.4552444428234, "episode_reward_mean": 124.47399006288383, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1096.3048497423347, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.05617389057852, "predator_policy": 951.9127920115313}, "policy_reward_mean": {"prey_policy": -90.89195615560558, "predator_policy": 153.12895118704762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.87355368278237, 132.90566939179192, 155.44000000000005, 122.11000000000027, 174.2437942493862, 284.9999999999998, -41.55542012291809, 175.02999999999986, 153.70000000000005, 292.2599999999999, -221.28889587893855, 190.20907485549765, 192.6525628992109, 164.28999999999965, 177.1599999999995, 47.02295338965358, -378.5104889589085, 149.75139924535574, 169.11999999999966, 350.8739052061911, 163.04000000000002, 157.85999999999996, 295.656303588446, 192.17774366867923, 3.7699999999999623, 165.9949058048575, 113.21759850264476, 332.3699999999998, 193.23594849192818, 182.75999999999985, 361.09557777087184, -9.183355069084469, 274.94523172604784, -82.80046964532156, 175.15999999999985, 313.877829905197, 36.7000000000001, 130.35000000000002, 135.22000000000003, 89.94000000000008, 59.33999999999983, 162.59999999999982, 284.76999999999964, 24.202334229916993, 149.22198682144605, 3.8399999999999603, 19.417268499039647, 157.75000000000006, 155.25000000000023, 105.85000000000029, 303.93739232293245, 94.7229320854356, 171.00045891983538, 249.28999999999982, 158.52128929192708, 140.0000000000001, -438.66810681321266, 168.21999999999974, 278.38851007224946, 72.97398220906744, 182.01999999999964, 535.9231562568024, 3.7099999999999596, 99.36000000000016, 3.6199999999999637, 339.39999999999975, 308.5461097659643, 5.327016709860666, 128.5100000000004, 106.68000000000029, 83.22000000000044, 138.97507079249655, 35.01000000000002, -221.81824854201957, 72.78, -89.44240283130617, 175.8699999999996, 171.08379272439413, 40.119999999999976, -154.14688067579743, 178.68999999999977, 186.7440428501868, 52.849295600767896, -3.550709467830684, -233.10277805182795, 527.4504338442055, 184.6292971431034, 151.50433855543508, 190.98273575121212, 260.0499999999997, 310.90103279458606, 133.65207988118897, 158.21000000000006, -439.4552444428234, 242.58413469139717, 352.93436123850955, 160.6259899219948, 88.01891143587598, 63.279999999999944, 3.34999999999997], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-111.4400628385958, -254.81918237191815, 13.319457769882288, -532.8414225868108, 142.99014404457643, 2.0000000000000013, -78.88235348252331, -2.2135660280014218, -29.149051532536657, 18.799652821749344, 97.27365955375429, 124.75074860596011, -89.89135273520694, -140.5684639969727, -38.45434672980072, 123.43120406743313, -162.7894009570343, 54.975480559915916, 89.19184001133507, -126.60931923530813, -432.1891694332812, -399.0694405941153, 105.30954273375423, -44.9096800978524, 164.25866444299544, -58.72289755677604, 143.0414515023682, 2.0000000000000013, 154.24224495614098, -0.43704100055141315, -27.178942319379484, -113.95065549278424, -561.2318895716086, -624.1928365332919, -89.83465447476932, 83.30643382597846, 68.93504785825314, 2.0000000000000013, -1096.3048497423347, -230.47673516399112, -95.32748084099262, 111.17173109676604, -317.6296869786458, 129.06090217093498, 94.04606101367544, 78.2219171473782, -30.90933506504367, 111.24099639935554, -53.6338271938729, -28.289434207849848, -255.70263562854763, 150.23383948871788, 65.9383245614376, -927.5347940638969, 116.68769173905567, 107.42727593638669, 39.76911715802217, 4.687142099484914, -55.892168547930474, 134.11607612631974, 147.09369914492598, 98.21200545721756, -92.90987018898022, -264.8696139398043, 65.19979262956599, 65.76489202956378, -262.1219820602496, -734.8710718851084, -39.765432423261636, 164.86390401381547, 114.31970084655477, 136.2583064472011, -23.478769798393525, -139.30988886756901, -101.72948795023127, 13.19525016146716, 11.864054350442288, -105.10177820977555, 45.61896468486586, -18.61368968562973, -425.97451651713675, -12.750775627532956, -498.2629618911009, 149.8926139928584, 67.21069903074962, 43.78914661819619, -30.848426891502683, -92.24472246390826, -105.74609652807997, 42.79168520002581, -2.141255668476246, -48.37729024300437, -47.39366081212436, -7.702471287275717, 101.48789191633671, -411.8898471422646, -30.356446189605226, 136.37409578703893, -126.49527220138113, -184.21497496395756, 93.07130050888513, 131.19030033800556, 2.0000000000000013, -395.3274382521921, -166.52266372494176, -291.7396066908359, 55.784152177422406, 137.18767285406142, -0.1388268303966187, 141.5491760949783, 134.47592212428756, -445.1399670394036, -636.148426538828, -687.9955500004188, 114.06695954339453, -2.7656639954129414, 69.14888898245297, 98.18835755168635, -29.9782457316556, -128.75021125659947, 149.46322831220306, -14.43693379758817, 180.05617389057852, -445.7691218323117, -106.25089634861534, 2.0000000000000013, -444.931994314665, 81.8011489868577, -115.34068265086323, -47.20787739204784, 132.63682035444907, 159.23364921941743, 65.60889104257359, 77.86699384744466, -53.621065154318565, -621.3276472744839, 2.0000000000000013, -9.533724896822783, 54.986031473897306, -20.820881688646086, 2.0000000000000013, -112.22511379069853, -1.142767342546863, -494.63094423907427, -49.67932661463908, -81.72388275661311, -577.4626071222043, -279.6669004067882, -21.659455527104093, -90.23632536016706, -881.9539483387421, -516.920756786523, 131.50689839437086, -74.11623574800146, -1.2222698055410275, 72.83635940780161, -387.97834260625024, 28.662281662963323, -352.15948992373757, -236.25358130513962, 135.9697930802019, -106.04397657042608, 50.638806095467615, -7.396760744898595, -683.6849719356057, -35.03808024866119, -12.279060968284018, -11.871852519308648, -496.9529051729613, -417.3289713805343, 47.04049621701255, -539.5275660708573, -965.9017426944398, -648.5445954545576, 125.83258637135434, -13.081881860290812, 146.11311273994886, -21.934966667129455, 38.181451378623905, 111.93816227035569, 30.32093593049875, 118.3233609429761, 72.56883652337993, -80.77330891832872, -35.19048821620092, 84.08736399237512, -693.9402527904774, -545.8238833403752, -46.61363206058443, 0.6804847740076485, 125.89343954009715, 117.27248137066971, 16.19451013564158, -46.59520119676422, -82.30571583193118, -155.77210159825646, 54.93116208344848, -27.505134634790757, -121.16516491063078, -71.76420202767393], "policy_predator_policy_reward": [99.48935629104999, 342.643442602246, 544.1379362084441, 108.28969800027623, 10.449855955423649, 0.0, 199.0123534825233, 4.19356602800138, 144.9500621501073, 39.64313081006616, 47.19634044624577, 15.779251394039946, 102.21382323466133, 86.69057337460045, 40.35434672980034, 49.69879593256686, 164.3294009570331, 97.18451944008406, 260.1999147430683, 69.47756448090465, 7.570328742348705, 602.399385406109, 65.78045726624582, 64.02875495335014, 15.436363726712667, 71.6804322862789, 19.248548497631596, 0.0, 20.927755043858866, 2.4270410005514056, 107.41324657138883, 80.73930463043045, 803.4890676474428, 3.4251694985486916, 95.49905717413398, 60.7805627200135, 98.18495214174683, 0.0, 784.8877828276078, 892.7677072849132, 97.09748084099353, 50.098268903234015, 318.22968697864525, 28.199097829065128, 72.06024257477104, 51.32808285262172, 59.893255550506616, 51.95282678386104, 55.51382719387252, 30.179434207850143, 255.00772982368863, 16.455972120998023, 47.27927394120701, 927.5347940638969, 44.58230826094448, 63.67272406361333, 20.08683133390595, 128.69285790051524, 57.652168547930124, 46.883923873680224, 61.07256354747, 54.71730962125839, 8.607225136538585, 339.9889039231616, 74.07456209586621, 69.90598497105168, 131.3554750722727, 782.8371092277632, 41.69543242326125, 8.366095986184526, 8.022801196717907, 55.27702141472355, 25.34876979839381, 174.1398888675694, 110.42948795023214, 108.45474983853313, 121.52594564955791, 106.93177820977648, 42.41103531513429, 20.52368968563003, 483.3745165171364, 14.690775627532915, 99.71832449737738, 411.25202340086565, 67.26930096925045, 106.50085338180384, 51.63431357966516, 95.6611700056632, 6.2711701470567185, 205.90522800244327, 4.121255668476204, 50.237290243004, 23.348333182298532, 51.165067416140246, 412.61505716224667, 55.53689806368114, 32.226446189605454, 17.005904212961184, 128.13527220138187, 288.42497496395737, 56.122197185845444, 23.553594290196564, 27.885121627862866, 460.16524870976474, 322.76729381917727, 306.4954355164352, 0.0, 56.31817496851625, 8.739373073532747, 8.371566953812541, 5.1140778757125975, 445.54996703940367, 875.0356305652116, 10.440239160823047, 52.1730404566055, 4.745663995412899, 8.314222827879037, 102.73704071023138, 100.76478684885541, 130.9376523484642, 30.606771687796897, 16.386933797588195, 408.36447324405725, 393.2716309544792, 107.96089634861622, 0.0, 7.825630064248494, 454.6652152635588, 117.11068265086413, 49.05787739204747, 26.673179645551045, 20.856350780582492, 92.4880300756733, 72.58219480027319, 4.4940858815601565, 675.7816432571028, 0.0, 136.0437248968229, 49.79396852610267, 22.72088168864637, 0.0, 193.4451137906985, 137.4927673425468, 497.2560150315704, 51.50932661463872, 114.90388275661323, 610.0611238884381, 25.25013509853499, 23.599455527104396, 161.07632536016695, 923.389188644323, 386.04311364963627, 42.63310160562914, 75.84623574800234, 51.768201172778134, 47.701501949355624, 33.942271692312715, 365.49378925097415, 364.1044976077978, 70.16169294528193, 41.11020691979811, 107.6539765704268, 132.720266732247, 10.781730767370584, 13.397343379999247, 758.1750044050362, 15.671058408833348, 4.929145610928635, 681.1790985016673, 0.0, 484.29833541249246, 535.6391682855584, 847.1628432805701, 951.9127920115313, 20.617413628645618, 18.136220415725504, 34.42423891707644, 32.38035076131695, 86.58696685332215, 23.343419497698413, 48.15059510362282, 114.10614081748942, 53.54228250490785, 88.31426977123047, 37.070488216200545, 72.24263600762482, 740.1860691655816, 60.122822522448004, 122.94447167421703, 165.5728103037578, 56.91092169841236, 52.85751862933023, 130.21558396293625, 60.81109702018102, 4.670326035211996, 321.4264028308514, 6.448837916551485, 29.405134634791054, 122.80516491063162, 73.47420202767475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5374377498326343, "mean_inference_ms": 1.6567762495342635, "mean_action_processing_ms": 0.2419543289620239, "mean_env_wait_ms": 0.18210493761271537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048133134841918945, "StateBufferConnector_ms": 0.0030211210250854492, "ViewRequirementAgentConnector_ms": 0.08857274055480957}, "num_episodes": 18, "episode_return_max": 535.9231562568024, "episode_return_min": -439.4552444428234, "episode_return_mean": 124.47399006288383, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.95081739667756, "num_env_steps_trained_throughput_per_sec": 400.95081739667756, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 9966.001, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9965.965, "sample_time_ms": 1222.183, "learn_time_ms": 8729.596, "learn_throughput": 458.211, "synch_weights_time_ms": 13.335}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "74486_00000", "date": "2024-08-16_15-12-14", "timestamp": 1723801334, "time_this_iter_s": 9.982318878173828, "time_total_s": 1002.1623539924622, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3973a59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1002.1623539924622, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 29.633333333333336, "ram_util_percent": 78.52000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9767551297233217, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.814198245951738, "policy_loss": -0.007380027767940962, "vf_loss": 6.820318091609491, "vf_explained_var": 0.13127478342207652, "kl": 0.01120163836870386, "entropy": 1.0224851773529458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4237052334994866, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.356075890480526, "policy_loss": -0.004760222614585132, "vf_loss": 3.3602126556729512, "vf_explained_var": 0.009716979189524575, "kl": 0.02216718331303612, "entropy": 0.7006208316043571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 535.9231562568024, "episode_reward_min": -439.4552444428234, "episode_reward_mean": 124.62585249264825, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -965.9017426944398, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.05617389057852, "predator_policy": 1092.377050904347}, "policy_reward_mean": {"prey_policy": -87.22671962070945, "predator_policy": 149.53964586703358}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.656303588446, 192.17774366867923, 3.7699999999999623, 165.9949058048575, 113.21759850264476, 332.3699999999998, 193.23594849192818, 182.75999999999985, 361.09557777087184, -9.183355069084469, 274.94523172604784, -82.80046964532156, 175.15999999999985, 313.877829905197, 36.7000000000001, 130.35000000000002, 135.22000000000003, 89.94000000000008, 59.33999999999983, 162.59999999999982, 284.76999999999964, 24.202334229916993, 149.22198682144605, 3.8399999999999603, 19.417268499039647, 157.75000000000006, 155.25000000000023, 105.85000000000029, 303.93739232293245, 94.7229320854356, 171.00045891983538, 249.28999999999982, 158.52128929192708, 140.0000000000001, -438.66810681321266, 168.21999999999974, 278.38851007224946, 72.97398220906744, 182.01999999999964, 535.9231562568024, 3.7099999999999596, 99.36000000000016, 3.6199999999999637, 339.39999999999975, 308.5461097659643, 5.327016709860666, 128.5100000000004, 106.68000000000029, 83.22000000000044, 138.97507079249655, 35.01000000000002, -221.81824854201957, 72.78, -89.44240283130617, 175.8699999999996, 171.08379272439413, 40.119999999999976, -154.14688067579743, 178.68999999999977, 186.7440428501868, 52.849295600767896, -3.550709467830684, -233.10277805182795, 527.4504338442055, 184.6292971431034, 151.50433855543508, 190.98273575121212, 260.0499999999997, 310.90103279458606, 133.65207988118897, 158.21000000000006, -439.4552444428234, 242.58413469139717, 352.93436123850955, 160.6259899219948, 88.01891143587598, 63.279999999999944, 3.34999999999997, 331.4699999999997, 129.58000000000055, 192.9530146157798, 301.5199999999997, 147.41000000000025, 23.559999999999988, 318.6099999999997, 223.4495810889904, 246.17678168695537, 3.719999999999964, -348.471342047279, 114.35000000000008, 85.32999999999988, 115.87000000000087, 125.97783534505778, 3.8199999999999634, 283.05222200124695, 63.89999999999995, -19.322131474001292, 207.04838971879545, 151.01, 1.359999999999989], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [94.04606101367544, 78.2219171473782, -30.90933506504367, 111.24099639935554, -53.6338271938729, -28.289434207849848, -255.70263562854763, 150.23383948871788, 65.9383245614376, -927.5347940638969, 116.68769173905567, 107.42727593638669, 39.76911715802217, 4.687142099484914, -55.892168547930474, 134.11607612631974, 147.09369914492598, 98.21200545721756, -92.90987018898022, -264.8696139398043, 65.19979262956599, 65.76489202956378, -262.1219820602496, -734.8710718851084, -39.765432423261636, 164.86390401381547, 114.31970084655477, 136.2583064472011, -23.478769798393525, -139.30988886756901, -101.72948795023127, 13.19525016146716, 11.864054350442288, -105.10177820977555, 45.61896468486586, -18.61368968562973, -425.97451651713675, -12.750775627532956, -498.2629618911009, 149.8926139928584, 67.21069903074962, 43.78914661819619, -30.848426891502683, -92.24472246390826, -105.74609652807997, 42.79168520002581, -2.141255668476246, -48.37729024300437, -47.39366081212436, -7.702471287275717, 101.48789191633671, -411.8898471422646, -30.356446189605226, 136.37409578703893, -126.49527220138113, -184.21497496395756, 93.07130050888513, 131.19030033800556, 2.0000000000000013, -395.3274382521921, -166.52266372494176, -291.7396066908359, 55.784152177422406, 137.18767285406142, -0.1388268303966187, 141.5491760949783, 134.47592212428756, -445.1399670394036, -636.148426538828, -687.9955500004188, 114.06695954339453, -2.7656639954129414, 69.14888898245297, 98.18835755168635, -29.9782457316556, -128.75021125659947, 149.46322831220306, -14.43693379758817, 180.05617389057852, -445.7691218323117, -106.25089634861534, 2.0000000000000013, -444.931994314665, 81.8011489868577, -115.34068265086323, -47.20787739204784, 132.63682035444907, 159.23364921941743, 65.60889104257359, 77.86699384744466, -53.621065154318565, -621.3276472744839, 2.0000000000000013, -9.533724896822783, 54.986031473897306, -20.820881688646086, 2.0000000000000013, -112.22511379069853, -1.142767342546863, -494.63094423907427, -49.67932661463908, -81.72388275661311, -577.4626071222043, -279.6669004067882, -21.659455527104093, -90.23632536016706, -881.9539483387421, -516.920756786523, 131.50689839437086, -74.11623574800146, -1.2222698055410275, 72.83635940780161, -387.97834260625024, 28.662281662963323, -352.15948992373757, -236.25358130513962, 135.9697930802019, -106.04397657042608, 50.638806095467615, -7.396760744898595, -683.6849719356057, -35.03808024866119, -12.279060968284018, -11.871852519308648, -496.9529051729613, -417.3289713805343, 47.04049621701255, -539.5275660708573, -965.9017426944398, -648.5445954545576, 125.83258637135434, -13.081881860290812, 146.11311273994886, -21.934966667129455, 38.181451378623905, 111.93816227035569, 30.32093593049875, 118.3233609429761, 72.56883652337993, -80.77330891832872, -35.19048821620092, 84.08736399237512, -693.9402527904774, -545.8238833403752, -46.61363206058443, 0.6804847740076485, 125.89343954009715, 117.27248137066971, 16.19451013564158, -46.59520119676422, -82.30571583193118, -155.77210159825646, 54.93116208344848, -27.505134634790757, -121.16516491063078, -71.76420202767393, 134.94573102974852, 149.43892937977898, 2.0000000000000013, 47.40937389951528, 39.48671798795755, -120.85797183405788, 156.61283440443373, -117.10695421732231, -29.65397831573948, 141.14095522573464, -530.9183608834633, -308.2833165801605, 95.16694918620212, 142.8457058824342, 5.3592304924840635, 134.80788105363155, 91.38778226904404, 91.83335913779037, -40.784597037684016, -37.389215683985775, -935.9328544653, -525.5082755747815, -84.41226288263087, 25.110215011646527, 69.41329861098887, -467.229127841727, 113.8700000000003, 2.0000000000000013, -61.75342224437504, -8.421659223066216, -14.294626034809733, -59.96243744825345, 115.45932799141717, 124.05489130802056, 46.972731177315225, -387.21510619929535, -38.55023301998781, -74.40735278368071, -18.57532213741965, 16.404383468021962, -423.8186928627536, 139.7874086294487, -697.5714728612613, -198.86943530791282], "policy_predator_policy_reward": [72.06024257477104, 51.32808285262172, 59.893255550506616, 51.95282678386104, 55.51382719387252, 30.179434207850143, 255.00772982368863, 16.455972120998023, 47.27927394120701, 927.5347940638969, 44.58230826094448, 63.67272406361333, 20.08683133390595, 128.69285790051524, 57.652168547930124, 46.883923873680224, 61.07256354747, 54.71730962125839, 8.607225136538585, 339.9889039231616, 74.07456209586621, 69.90598497105168, 131.3554750722727, 782.8371092277632, 41.69543242326125, 8.366095986184526, 8.022801196717907, 55.27702141472355, 25.34876979839381, 174.1398888675694, 110.42948795023214, 108.45474983853313, 121.52594564955791, 106.93177820977648, 42.41103531513429, 20.52368968563003, 483.3745165171364, 14.690775627532915, 99.71832449737738, 411.25202340086565, 67.26930096925045, 106.50085338180384, 51.63431357966516, 95.6611700056632, 6.2711701470567185, 205.90522800244327, 4.121255668476204, 50.237290243004, 23.348333182298532, 51.165067416140246, 412.61505716224667, 55.53689806368114, 32.226446189605454, 17.005904212961184, 128.13527220138187, 288.42497496395737, 56.122197185845444, 23.553594290196564, 27.885121627862866, 460.16524870976474, 322.76729381917727, 306.4954355164352, 0.0, 56.31817496851625, 8.739373073532747, 8.371566953812541, 5.1140778757125975, 445.54996703940367, 875.0356305652116, 10.440239160823047, 52.1730404566055, 4.745663995412899, 8.314222827879037, 102.73704071023138, 100.76478684885541, 130.9376523484642, 30.606771687796897, 16.386933797588195, 408.36447324405725, 393.2716309544792, 107.96089634861622, 0.0, 7.825630064248494, 454.6652152635588, 117.11068265086413, 49.05787739204747, 26.673179645551045, 20.856350780582492, 92.4880300756733, 72.58219480027319, 4.4940858815601565, 675.7816432571028, 0.0, 136.0437248968229, 49.79396852610267, 22.72088168864637, 0.0, 193.4451137906985, 137.4927673425468, 497.2560150315704, 51.50932661463872, 114.90388275661323, 610.0611238884381, 25.25013509853499, 23.599455527104396, 161.07632536016695, 923.389188644323, 386.04311364963627, 42.63310160562914, 75.84623574800234, 51.768201172778134, 47.701501949355624, 33.942271692312715, 365.49378925097415, 364.1044976077978, 70.16169294528193, 41.11020691979811, 107.6539765704268, 132.720266732247, 10.781730767370584, 13.397343379999247, 758.1750044050362, 15.671058408833348, 4.929145610928635, 681.1790985016673, 0.0, 484.29833541249246, 535.6391682855584, 847.1628432805701, 951.9127920115313, 20.617413628645618, 18.136220415725504, 34.42423891707644, 32.38035076131695, 86.58696685332215, 23.343419497698413, 48.15059510362282, 114.10614081748942, 53.54228250490785, 88.31426977123047, 37.070488216200545, 72.24263600762482, 740.1860691655816, 60.122822522448004, 122.94447167421703, 165.5728103037578, 56.91092169841236, 52.85751862933023, 130.21558396293625, 60.81109702018102, 4.670326035211996, 321.4264028308514, 6.448837916551485, 29.405134634791054, 122.80516491063162, 73.47420202767475, 34.184268970251544, 12.901070620221136, 0.0, 80.17062610048463, 23.266296627822452, 251.0579718340577, 6.727165595566304, 255.28695421732232, 31.533978315739773, 4.389044774265496, 530.9883608834633, 331.77331658016016, 55.21305081379792, 25.3842941175658, 11.817949387385742, 71.46452015548978, 38.77747917022712, 24.17816110989419, 55.89795788593841, 25.99585483573071, 1092.377050904347, 20.592737088453468, 148.3122628826305, 25.339784988353674, 473.58006665947335, 9.565762571264598, 0.0, 0.0, 24.6263601377461, 171.52655667475238, 16.22462603480973, 61.85243744825308, 31.354980145383692, 12.183022556426081, 355.6863261259717, 48.45604889600862, 79.87133969329395, 13.764114636373254, 137.94532213741977, 71.27400625077405, 102.74566864475115, 332.2956155885547, 697.5914728612613, 200.2094353079116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53664121604246, "mean_inference_ms": 1.6558184698750225, "mean_action_processing_ms": 0.24137902016264903, "mean_env_wait_ms": 0.18164800882207216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004535317420959473, "StateBufferConnector_ms": 0.0029783248901367188, "ViewRequirementAgentConnector_ms": 0.09031713008880615}, "num_episodes": 22, "episode_return_max": 535.9231562568024, "episode_return_min": -439.4552444428234, "episode_return_mean": 124.62585249264825, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.9916641559267, "num_env_steps_trained_throughput_per_sec": 409.9916641559267, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 9938.731, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9938.695, "sample_time_ms": 1216.264, "learn_time_ms": 8708.047, "learn_throughput": 459.345, "synch_weights_time_ms": 13.528}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "74486_00000", "date": "2024-08-16_15-12-24", "timestamp": 1723801344, "time_this_iter_s": 9.761083841323853, "time_total_s": 1011.923437833786, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x397740c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1011.923437833786, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 33.52307692307692, "ram_util_percent": 78.55384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.518645906763733, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.366613046958964, "policy_loss": -0.004579470426622758, "vf_loss": 6.369990274893544, "vf_explained_var": 0.061748546078091576, "kl": 0.010686476948930707, "entropy": 1.0452021898100616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0660810817486395, "cur_kl_coeff": 0.0421875, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3782224335998454, "policy_loss": -0.005432095658896422, "vf_loss": 2.3827163951106805, "vf_explained_var": 0.026946311810659984, "kl": 0.02223710724546875, "entropy": 0.8602077942676645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 535.9231562568024, "episode_reward_min": -439.4552444428234, "episode_reward_mean": 110.24949778246044, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -965.9017426944398, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.05617389057852, "predator_policy": 1092.377050904347}, "policy_reward_mean": {"prey_policy": -94.84576044301528, "predator_policy": 149.97050933424555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.33999999999983, 162.59999999999982, 284.76999999999964, 24.202334229916993, 149.22198682144605, 3.8399999999999603, 19.417268499039647, 157.75000000000006, 155.25000000000023, 105.85000000000029, 303.93739232293245, 94.7229320854356, 171.00045891983538, 249.28999999999982, 158.52128929192708, 140.0000000000001, -438.66810681321266, 168.21999999999974, 278.38851007224946, 72.97398220906744, 182.01999999999964, 535.9231562568024, 3.7099999999999596, 99.36000000000016, 3.6199999999999637, 339.39999999999975, 308.5461097659643, 5.327016709860666, 128.5100000000004, 106.68000000000029, 83.22000000000044, 138.97507079249655, 35.01000000000002, -221.81824854201957, 72.78, -89.44240283130617, 175.8699999999996, 171.08379272439413, 40.119999999999976, -154.14688067579743, 178.68999999999977, 186.7440428501868, 52.849295600767896, -3.550709467830684, -233.10277805182795, 527.4504338442055, 184.6292971431034, 151.50433855543508, 190.98273575121212, 260.0499999999997, 310.90103279458606, 133.65207988118897, 158.21000000000006, -439.4552444428234, 242.58413469139717, 352.93436123850955, 160.6259899219948, 88.01891143587598, 63.279999999999944, 3.34999999999997, 331.4699999999997, 129.58000000000055, 192.9530146157798, 301.5199999999997, 147.41000000000025, 23.559999999999988, 318.6099999999997, 223.4495810889904, 246.17678168695537, 3.719999999999964, -348.471342047279, 114.35000000000008, 85.32999999999988, 115.87000000000087, 125.97783534505778, 3.8199999999999634, 283.05222200124695, 63.89999999999995, -19.322131474001292, 207.04838971879545, 151.01, 1.359999999999989, 31.950000000000113, -23.38251015709884, 182.93999999999923, 83.07000000000019, -143.81901075593277, 169.17549909862464, 146.0177561927134, 118.58000000000035, 48.23999999999996, 33.16994720653854, 114.63118250545797, 84.59000000000009, 2.0599999999999916, 123.29000000000018, 120.53000000000044, 222.6399999999994, 105.29897963518157, 47.87000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-425.97451651713675, -12.750775627532956, -498.2629618911009, 149.8926139928584, 67.21069903074962, 43.78914661819619, -30.848426891502683, -92.24472246390826, -105.74609652807997, 42.79168520002581, -2.141255668476246, -48.37729024300437, -47.39366081212436, -7.702471287275717, 101.48789191633671, -411.8898471422646, -30.356446189605226, 136.37409578703893, -126.49527220138113, -184.21497496395756, 93.07130050888513, 131.19030033800556, 2.0000000000000013, -395.3274382521921, -166.52266372494176, -291.7396066908359, 55.784152177422406, 137.18767285406142, -0.1388268303966187, 141.5491760949783, 134.47592212428756, -445.1399670394036, -636.148426538828, -687.9955500004188, 114.06695954339453, -2.7656639954129414, 69.14888898245297, 98.18835755168635, -29.9782457316556, -128.75021125659947, 149.46322831220306, -14.43693379758817, 180.05617389057852, -445.7691218323117, -106.25089634861534, 2.0000000000000013, -444.931994314665, 81.8011489868577, -115.34068265086323, -47.20787739204784, 132.63682035444907, 159.23364921941743, 65.60889104257359, 77.86699384744466, -53.621065154318565, -621.3276472744839, 2.0000000000000013, -9.533724896822783, 54.986031473897306, -20.820881688646086, 2.0000000000000013, -112.22511379069853, -1.142767342546863, -494.63094423907427, -49.67932661463908, -81.72388275661311, -577.4626071222043, -279.6669004067882, -21.659455527104093, -90.23632536016706, -881.9539483387421, -516.920756786523, 131.50689839437086, -74.11623574800146, -1.2222698055410275, 72.83635940780161, -387.97834260625024, 28.662281662963323, -352.15948992373757, -236.25358130513962, 135.9697930802019, -106.04397657042608, 50.638806095467615, -7.396760744898595, -683.6849719356057, -35.03808024866119, -12.279060968284018, -11.871852519308648, -496.9529051729613, -417.3289713805343, 47.04049621701255, -539.5275660708573, -965.9017426944398, -648.5445954545576, 125.83258637135434, -13.081881860290812, 146.11311273994886, -21.934966667129455, 38.181451378623905, 111.93816227035569, 30.32093593049875, 118.3233609429761, 72.56883652337993, -80.77330891832872, -35.19048821620092, 84.08736399237512, -693.9402527904774, -545.8238833403752, -46.61363206058443, 0.6804847740076485, 125.89343954009715, 117.27248137066971, 16.19451013564158, -46.59520119676422, -82.30571583193118, -155.77210159825646, 54.93116208344848, -27.505134634790757, -121.16516491063078, -71.76420202767393, 134.94573102974852, 149.43892937977898, 2.0000000000000013, 47.40937389951528, 39.48671798795755, -120.85797183405788, 156.61283440443373, -117.10695421732231, -29.65397831573948, 141.14095522573464, -530.9183608834633, -308.2833165801605, 95.16694918620212, 142.8457058824342, 5.3592304924840635, 134.80788105363155, 91.38778226904404, 91.83335913779037, -40.784597037684016, -37.389215683985775, -935.9328544653, -525.5082755747815, -84.41226288263087, 25.110215011646527, 69.41329861098887, -467.229127841727, 113.8700000000003, 2.0000000000000013, -61.75342224437504, -8.421659223066216, -14.294626034809733, -59.96243744825345, 115.45932799141717, 124.05489130802056, 46.972731177315225, -387.21510619929535, -38.55023301998781, -74.40735278368071, -18.57532213741965, 16.404383468021962, -423.8186928627536, 139.7874086294487, -697.5714728612613, -198.86943530791282, -19.14043047277409, -424.84040882042143, -109.5004655134947, -27.019668893147387, 23.86314005405981, 49.870408925324554, -29.981014301677106, 74.97866628768257, -229.36081630004355, -534.1569112422314, -15.764901214279346, 45.69868369213532, 105.95000000000012, -7.23016756330518, -215.16808621714765, 52.94664032649068, -567.7320572217741, -27.70672787699293, -65.03426298875527, -8.30246994645989, -8.22093048663502, -37.36228590407575, -21.737509370063655, -6.096154177319535, -93.16362167122372, -516.7416163377371, 104.33361542132128, -378.159303378359, -58.26107582299472, 78.16594070966681, 37.66543122632722, 140.10338268214605, 18.58462028325737, -67.66814888011704, -22.902182025257833, -134.6922457239874], "policy_predator_policy_reward": [483.3745165171364, 14.690775627532915, 99.71832449737738, 411.25202340086565, 67.26930096925045, 106.50085338180384, 51.63431357966516, 95.6611700056632, 6.2711701470567185, 205.90522800244327, 4.121255668476204, 50.237290243004, 23.348333182298532, 51.165067416140246, 412.61505716224667, 55.53689806368114, 32.226446189605454, 17.005904212961184, 128.13527220138187, 288.42497496395737, 56.122197185845444, 23.553594290196564, 27.885121627862866, 460.16524870976474, 322.76729381917727, 306.4954355164352, 0.0, 56.31817496851625, 8.739373073532747, 8.371566953812541, 5.1140778757125975, 445.54996703940367, 875.0356305652116, 10.440239160823047, 52.1730404566055, 4.745663995412899, 8.314222827879037, 102.73704071023138, 100.76478684885541, 130.9376523484642, 30.606771687796897, 16.386933797588195, 408.36447324405725, 393.2716309544792, 107.96089634861622, 0.0, 7.825630064248494, 454.6652152635588, 117.11068265086413, 49.05787739204747, 26.673179645551045, 20.856350780582492, 92.4880300756733, 72.58219480027319, 4.4940858815601565, 675.7816432571028, 0.0, 136.0437248968229, 49.79396852610267, 22.72088168864637, 0.0, 193.4451137906985, 137.4927673425468, 497.2560150315704, 51.50932661463872, 114.90388275661323, 610.0611238884381, 25.25013509853499, 23.599455527104396, 161.07632536016695, 923.389188644323, 386.04311364963627, 42.63310160562914, 75.84623574800234, 51.768201172778134, 47.701501949355624, 33.942271692312715, 365.49378925097415, 364.1044976077978, 70.16169294528193, 41.11020691979811, 107.6539765704268, 132.720266732247, 10.781730767370584, 13.397343379999247, 758.1750044050362, 15.671058408833348, 4.929145610928635, 681.1790985016673, 0.0, 484.29833541249246, 535.6391682855584, 847.1628432805701, 951.9127920115313, 20.617413628645618, 18.136220415725504, 34.42423891707644, 32.38035076131695, 86.58696685332215, 23.343419497698413, 48.15059510362282, 114.10614081748942, 53.54228250490785, 88.31426977123047, 37.070488216200545, 72.24263600762482, 740.1860691655816, 60.122822522448004, 122.94447167421703, 165.5728103037578, 56.91092169841236, 52.85751862933023, 130.21558396293625, 60.81109702018102, 4.670326035211996, 321.4264028308514, 6.448837916551485, 29.405134634791054, 122.80516491063162, 73.47420202767475, 34.184268970251544, 12.901070620221136, 0.0, 80.17062610048463, 23.266296627822452, 251.0579718340577, 6.727165595566304, 255.28695421732232, 31.533978315739773, 4.389044774265496, 530.9883608834633, 331.77331658016016, 55.21305081379792, 25.3842941175658, 11.817949387385742, 71.46452015548978, 38.77747917022712, 24.17816110989419, 55.89795788593841, 25.99585483573071, 1092.377050904347, 20.592737088453468, 148.3122628826305, 25.339784988353674, 473.58006665947335, 9.565762571264598, 0.0, 0.0, 24.6263601377461, 171.52655667475238, 16.22462603480973, 61.85243744825308, 31.354980145383692, 12.183022556426081, 355.6863261259717, 48.45604889600862, 79.87133969329395, 13.764114636373254, 137.94532213741977, 71.27400625077405, 102.74566864475115, 332.2956155885547, 697.5914728612613, 200.2094353079116, 21.06043047277439, 454.87040882042146, 2.0671587360483, 111.0704655134955, 68.06685994594018, 41.139591074675394, 31.881014301677403, 6.191333712317432, 38.7254543222846, 580.973262464056, 78.91754435592915, 60.32417226483984, 32.245084192028656, 15.052839563989247, 216.12808621714797, 64.67335967350928, 567.7420572217741, 75.93672787699323, 56.51273087259061, 49.99394926916383, 133.9903585960702, 26.2240403000981, 104.36750937006362, 8.056154177319494, 94.91362167122462, 517.0516163377368, 18.376384578678692, 378.7393033783587, 60.05107582299436, 40.574059290333125, 38.46456877367265, 6.40661731785407, 21.452807806624484, 132.9297004254171, 24.80218202525813, 180.66224572398653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5368824826840433, "mean_inference_ms": 1.6559328611760906, "mean_action_processing_ms": 0.24138802456889638, "mean_env_wait_ms": 0.18177756188854688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004231095314025879, "StateBufferConnector_ms": 0.0029982328414916992, "ViewRequirementAgentConnector_ms": 0.09205090999603271}, "num_episodes": 18, "episode_return_max": 535.9231562568024, "episode_return_min": -439.4552444428234, "episode_return_mean": 110.24949778246044, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.0669055084803, "num_env_steps_trained_throughput_per_sec": 398.0669055084803, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 9941.505, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9941.469, "sample_time_ms": 1206.833, "learn_time_ms": 8720.229, "learn_throughput": 458.704, "synch_weights_time_ms": 13.556}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "74486_00000", "date": "2024-08-16_15-12-34", "timestamp": 1723801354, "time_this_iter_s": 10.053375005722046, "time_total_s": 1021.976812839508, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3977408b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1021.976812839508, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 28.48, "ram_util_percent": 78.77333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.267806253735981, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.519324830726341, "policy_loss": -0.005187105527394032, "vf_loss": 7.523590097225532, "vf_explained_var": 0.07095481150995486, "kl": 0.008194140543532489, "entropy": 1.036920532158443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9333616194901643, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.139540050395582, "policy_loss": -0.0037636122624414466, "vf_loss": 3.142507650864818, "vf_explained_var": 0.027794239256117077, "kl": 0.012578906547388307, "entropy": 0.923016658977226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 527.4504338442055, "episode_reward_min": -439.4552444428234, "episode_reward_mean": 108.19256682507734, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1062.4854750901936, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 159.23364921941743, "predator_policy": 1092.377050904347}, "policy_reward_mean": {"prey_policy": -96.17972322029864, "predator_policy": 150.27600663283735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.36000000000016, 3.6199999999999637, 339.39999999999975, 308.5461097659643, 5.327016709860666, 128.5100000000004, 106.68000000000029, 83.22000000000044, 138.97507079249655, 35.01000000000002, -221.81824854201957, 72.78, -89.44240283130617, 175.8699999999996, 171.08379272439413, 40.119999999999976, -154.14688067579743, 178.68999999999977, 186.7440428501868, 52.849295600767896, -3.550709467830684, -233.10277805182795, 527.4504338442055, 184.6292971431034, 151.50433855543508, 190.98273575121212, 260.0499999999997, 310.90103279458606, 133.65207988118897, 158.21000000000006, -439.4552444428234, 242.58413469139717, 352.93436123850955, 160.6259899219948, 88.01891143587598, 63.279999999999944, 3.34999999999997, 331.4699999999997, 129.58000000000055, 192.9530146157798, 301.5199999999997, 147.41000000000025, 23.559999999999988, 318.6099999999997, 223.4495810889904, 246.17678168695537, 3.719999999999964, -348.471342047279, 114.35000000000008, 85.32999999999988, 115.87000000000087, 125.97783534505778, 3.8199999999999634, 283.05222200124695, 63.89999999999995, -19.322131474001292, 207.04838971879545, 151.01, 1.359999999999989, 31.950000000000113, -23.38251015709884, 182.93999999999923, 83.07000000000019, -143.81901075593277, 169.17549909862464, 146.0177561927134, 118.58000000000035, 48.23999999999996, 33.16994720653854, 114.63118250545797, 84.59000000000009, 2.0599999999999916, 123.29000000000018, 120.53000000000044, 222.6399999999994, 105.29897963518157, 47.87000000000001, 76.03000000000006, 288.71480246435, 90.86000000000041, 41.162280728697, 133.1799999999999, 93.73680004424484, 75.2439991681477, 295.27989883078203, 3.781597618819142, 102.35650702447379, 120.56954725645532, 183.23823313542596, 112.68000000000049, 71.82144697609694, 41.42198646343186, 196.59999999999977, 269.7358867989918, 105.74566355296886, 175.19240732880178, 64.66441202388256, 103.77000000000076, -56.68217827876778, 247.484817020326], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-444.931994314665, 81.8011489868577, -115.34068265086323, -47.20787739204784, 132.63682035444907, 159.23364921941743, 65.60889104257359, 77.86699384744466, -53.621065154318565, -621.3276472744839, 2.0000000000000013, -9.533724896822783, 54.986031473897306, -20.820881688646086, 2.0000000000000013, -112.22511379069853, -1.142767342546863, -494.63094423907427, -49.67932661463908, -81.72388275661311, -577.4626071222043, -279.6669004067882, -21.659455527104093, -90.23632536016706, -881.9539483387421, -516.920756786523, 131.50689839437086, -74.11623574800146, -1.2222698055410275, 72.83635940780161, -387.97834260625024, 28.662281662963323, -352.15948992373757, -236.25358130513962, 135.9697930802019, -106.04397657042608, 50.638806095467615, -7.396760744898595, -683.6849719356057, -35.03808024866119, -12.279060968284018, -11.871852519308648, -496.9529051729613, -417.3289713805343, 47.04049621701255, -539.5275660708573, -965.9017426944398, -648.5445954545576, 125.83258637135434, -13.081881860290812, 146.11311273994886, -21.934966667129455, 38.181451378623905, 111.93816227035569, 30.32093593049875, 118.3233609429761, 72.56883652337993, -80.77330891832872, -35.19048821620092, 84.08736399237512, -693.9402527904774, -545.8238833403752, -46.61363206058443, 0.6804847740076485, 125.89343954009715, 117.27248137066971, 16.19451013564158, -46.59520119676422, -82.30571583193118, -155.77210159825646, 54.93116208344848, -27.505134634790757, -121.16516491063078, -71.76420202767393, 134.94573102974852, 149.43892937977898, 2.0000000000000013, 47.40937389951528, 39.48671798795755, -120.85797183405788, 156.61283440443373, -117.10695421732231, -29.65397831573948, 141.14095522573464, -530.9183608834633, -308.2833165801605, 95.16694918620212, 142.8457058824342, 5.3592304924840635, 134.80788105363155, 91.38778226904404, 91.83335913779037, -40.784597037684016, -37.389215683985775, -935.9328544653, -525.5082755747815, -84.41226288263087, 25.110215011646527, 69.41329861098887, -467.229127841727, 113.8700000000003, 2.0000000000000013, -61.75342224437504, -8.421659223066216, -14.294626034809733, -59.96243744825345, 115.45932799141717, 124.05489130802056, 46.972731177315225, -387.21510619929535, -38.55023301998781, -74.40735278368071, -18.57532213741965, 16.404383468021962, -423.8186928627536, 139.7874086294487, -697.5714728612613, -198.86943530791282, -19.14043047277409, -424.84040882042143, -109.5004655134947, -27.019668893147387, 23.86314005405981, 49.870408925324554, -29.981014301677106, 74.97866628768257, -229.36081630004355, -534.1569112422314, -15.764901214279346, 45.69868369213532, 105.95000000000012, -7.23016756330518, -215.16808621714765, 52.94664032649068, -567.7320572217741, -27.70672787699293, -65.03426298875527, -8.30246994645989, -8.22093048663502, -37.36228590407575, -21.737509370063655, -6.096154177319535, -93.16362167122372, -516.7416163377371, 104.33361542132128, -378.159303378359, -58.26107582299472, 78.16594070966681, 37.66543122632722, 140.10338268214605, 18.58462028325737, -67.66814888011704, -22.902182025257833, -134.6922457239874, -44.090441059379444, 59.619405688966616, 105.158730351014, 14.436878518242864, 38.80240867473895, -29.29950776608809, -211.01792831147188, -97.17484972739577, 111.541651510763, -334.1508623930483, -1062.4854750901936, -315.8746909513445, 3.7042213920680673, -69.68751138716955, 113.74456022730287, 17.576470976434354, -13.751436885597395, -2.6466881092483767, -2.8459780456679162, -24.565835543300942, 11.83947703295232, 37.50025906956571, -62.97756281618703, -37.466115615290086, -328.69646670782754, 66.47853843270316, 0.11811798830432947, 17.894532019121804, -139.68098302549404, -139.61263279360122, -252.9680149395831, 80.7689994316928, 86.44449314458673, 92.32263660109406, 90.1290924675325, -525.737807519766, -8.947918971831589, -1.5486509602968894, -570.8667635752589, -0.4775099686920763, 93.6772513222842, -43.32767376767728, -527.85729381279, -153.9412812545012, 21.963595149276312, 145.55000000000013], "policy_predator_policy_reward": [7.825630064248494, 454.6652152635588, 117.11068265086413, 49.05787739204747, 26.673179645551045, 20.856350780582492, 92.4880300756733, 72.58219480027319, 4.4940858815601565, 675.7816432571028, 0.0, 136.0437248968229, 49.79396852610267, 22.72088168864637, 0.0, 193.4451137906985, 137.4927673425468, 497.2560150315704, 51.50932661463872, 114.90388275661323, 610.0611238884381, 25.25013509853499, 23.599455527104396, 161.07632536016695, 923.389188644323, 386.04311364963627, 42.63310160562914, 75.84623574800234, 51.768201172778134, 47.701501949355624, 33.942271692312715, 365.49378925097415, 364.1044976077978, 70.16169294528193, 41.11020691979811, 107.6539765704268, 132.720266732247, 10.781730767370584, 13.397343379999247, 758.1750044050362, 15.671058408833348, 4.929145610928635, 681.1790985016673, 0.0, 484.29833541249246, 535.6391682855584, 847.1628432805701, 951.9127920115313, 20.617413628645618, 18.136220415725504, 34.42423891707644, 32.38035076131695, 86.58696685332215, 23.343419497698413, 48.15059510362282, 114.10614081748942, 53.54228250490785, 88.31426977123047, 37.070488216200545, 72.24263600762482, 740.1860691655816, 60.122822522448004, 122.94447167421703, 165.5728103037578, 56.91092169841236, 52.85751862933023, 130.21558396293625, 60.81109702018102, 4.670326035211996, 321.4264028308514, 6.448837916551485, 29.405134634791054, 122.80516491063162, 73.47420202767475, 34.184268970251544, 12.901070620221136, 0.0, 80.17062610048463, 23.266296627822452, 251.0579718340577, 6.727165595566304, 255.28695421732232, 31.533978315739773, 4.389044774265496, 530.9883608834633, 331.77331658016016, 55.21305081379792, 25.3842941175658, 11.817949387385742, 71.46452015548978, 38.77747917022712, 24.17816110989419, 55.89795788593841, 25.99585483573071, 1092.377050904347, 20.592737088453468, 148.3122628826305, 25.339784988353674, 473.58006665947335, 9.565762571264598, 0.0, 0.0, 24.6263601377461, 171.52655667475238, 16.22462603480973, 61.85243744825308, 31.354980145383692, 12.183022556426081, 355.6863261259717, 48.45604889600862, 79.87133969329395, 13.764114636373254, 137.94532213741977, 71.27400625077405, 102.74566864475115, 332.2956155885547, 697.5914728612613, 200.2094353079116, 21.06043047277439, 454.87040882042146, 2.0671587360483, 111.0704655134955, 68.06685994594018, 41.139591074675394, 31.881014301677403, 6.191333712317432, 38.7254543222846, 580.973262464056, 78.91754435592915, 60.32417226483984, 32.245084192028656, 15.052839563989247, 216.12808621714797, 64.67335967350928, 567.7420572217741, 75.93672787699323, 56.51273087259061, 49.99394926916383, 133.9903585960702, 26.2240403000981, 104.36750937006362, 8.056154177319494, 94.91362167122462, 517.0516163377368, 18.376384578678692, 378.7393033783587, 60.05107582299436, 40.574059290333125, 38.46456877367265, 6.40661731785407, 21.452807806624484, 132.9297004254171, 24.80218202525813, 180.66224572398653, 45.93044105937907, 14.570594311033418, 57.526436277989774, 111.5927573171042, 50.19759132526109, 31.15950776608838, 43.354533495419005, 306.0005252721454, 21.048348489237025, 334.740862393048, 1054.7958292168164, 417.3011368689677, 130.26524853569688, 10.962040627552476, 81.86985417510274, 82.08901345194259, 4.488285728067513, 15.691436885597353, 38.07885999474782, 91.6894606186939, 57.26052296704751, 13.969288186889566, 134.92756281618747, 148.75434875071628, 329.6364667078268, 45.26146156729682, 32.316828409827444, 21.491968558842018, 146.9329694889241, 173.78263279360164, 298.34801493958275, 70.45100056830726, 69.81550685541329, 21.1532501978985, 499.0750376799811, 42.27934092522111, 114.00402614195434, 71.684951118976, 597.7953825517365, 38.213303016097704, 8.262748677715985, 45.15767376767691, 586.0152689679562, 39.101127820566845, 74.80640485072378, 5.164817020327099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5345911882894077, "mean_inference_ms": 1.6500856790606422, "mean_action_processing_ms": 0.23991054476896484, "mean_env_wait_ms": 0.18090072228236564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038033723831176758, "StateBufferConnector_ms": 0.0029093027114868164, "ViewRequirementAgentConnector_ms": 0.09005844593048096}, "num_episodes": 23, "episode_return_max": 527.4504338442055, "episode_return_min": -439.4552444428234, "episode_return_mean": 108.19256682507734, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.68566098939704, "num_env_steps_trained_throughput_per_sec": 413.68566098939704, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 9916.395, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9916.358, "sample_time_ms": 1207.208, "learn_time_ms": 8695.008, "learn_throughput": 460.034, "synch_weights_time_ms": 13.288}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "74486_00000", "date": "2024-08-16_15-12-44", "timestamp": 1723801364, "time_this_iter_s": 9.673494815826416, "time_total_s": 1031.6503076553345, "pid": 48138, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x39738f040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1031.6503076553345, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 27.753846153846155, "ram_util_percent": 78.71538461538464}}
