{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0187356248244865, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.176751130401708, "policy_loss": -0.014436327928139368, "vf_loss": 6.18969061126628, "vf_explained_var": 0.02432859499489932, "kl": 0.007484227332589068, "entropy": 1.6037007169865245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 2355.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.398392705831305, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.854512030607577, "policy_loss": -0.016076201819167166, "vf_loss": 8.868430566079045, "vf_explained_var": 0.04356632559162796, "kl": 0.010788264559362392, "entropy": 1.6002669766197286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 2355.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 932.5034414761678, "episode_reward_min": 340.12303909729906, "episode_reward_mean": 633.0020977675948, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -500.806681806958, "predator_policy": 19.85207983751744}, "policy_reward_max": {"prey_policy": 364.50538407216317, "predator_policy": 599.7705117663926}, "policy_reward_mean": {"prey_policy": -64.0921913049297, "predator_policy": 190.69261085844664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.4896647018643, 340.12303909729906, 496.90825785030427, 775.9444095972316, 928.3263244550725, 932.5034414761678, 512.6504912658543, 783.8099900064275, 375.2632614581324], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [47.29508943767401, -121.9276494573801, -171.46035192711872, -168.3941994567885, -84.6935511893032, -408.8821747564593, -13.21015819449752, 47.18041090147727, -37.85316705544204, -185.57573559058335, 37.535033647341926, -418.43152383671077, 208.6287727698366, -146.21886873128835, -70.60621103825198, -142.0644130313912, 88.06452256995486, 150.63287778951306, 131.80565792203038, -106.14625474607013, 53.8679283776205, -357.75051304492655, 25.970944170329307, 364.50538407216317, -329.26491511728847, 298.31780864597357, -39.37985821142435, -230.9721447917285, 65.47475080453954, 139.25043785959622, 0.43079967117882256, -68.51914590446404, -44.898777437143394, -370.07491356538344, -54.43725855976439, -6.394959827914074, -151.60261259983017, 39.007779477962416, 10.194522623121456, 39.29459950013032, 49.97593694364861, -500.806681806958, 11.327273777453817, -408.15689674684705, -55.18620305842467], "policy_predator_policy_reward": [150.27479952948175, 275.0404227452082, 284.5932538533706, 193.56775626754688, 147.19409489915896, 429.88217475645905, 143.2101581944964, 317.8124320581865, 24.767606127544834, 22.791492656117605, 161.2944738346816, 370.3681260488505, 228.72771845770916, 20.23011665139934, 105.38062004672804, 156.72655096766562, 23.432762309751556, 115.16275784535854, 19.85207983751744, 338.47786813287837, 94.76145397367513, 302.8547815485967, 381.9225025347649, 23.89774729317387, 367.56101064696196, 28.482377565202857, 87.45530680128401, 180.2982724130677, 68.61775723116592, 334.95873315847314, 333.454323344748, 163.77885079546505, 89.19877743714295, 321.4933578708003, 142.2244776132641, 52.98915131730364, 184.50261259983034, 91.59988864059981, 243.66342766168927, 280.55558061352826, 111.27222977880982, 437.74696232613985, 40.533925419484014, 599.7705117663926, 88.78620305842462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2627580423564873, "mean_inference_ms": 1.4864686994015024, "mean_action_processing_ms": 0.5369810465064594, "mean_env_wait_ms": 0.3889898653657679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009316868252224393, "StateBufferConnector_ms": 0.005808141496446397, "ViewRequirementAgentConnector_ms": 0.21413034862942165}, "num_episodes": 9, "episode_return_max": 932.5034414761678, "episode_return_min": 340.12303909729906, "episode_return_mean": 633.0020977675948, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 34.583312237379076, "num_env_steps_trained_throughput_per_sec": 34.583312237379076, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 115662.731, "restore_workers_time_ms": 0.018, "training_step_time_ms": 115662.679, "sample_time_ms": 1788.012, "learn_time_ms": 113853.588, "learn_throughput": 35.133, "synch_weights_time_ms": 16.096}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "81797_00000", "date": "2024-08-22_10-47-15", "timestamp": 1724303835, "time_this_iter_s": 115.68574476242065, "time_total_s": 115.68574476242065, "pid": 4493, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16901fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 115.68574476242065, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.29333333333333, "ram_util_percent": 81.48909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6818250260345495, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.8672102666458, "policy_loss": -0.017120828354165684, "vf_loss": 4.882933088827032, "vf_explained_var": 0.09288289115433987, "kl": 0.0069900499205859095, "entropy": 1.5911062592660292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 7065.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.680234658148638, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.417801894554414, "policy_loss": -0.017428744876571395, "vf_loss": 8.433285273007273, "vf_explained_var": 0.1190839403500729, "kl": 0.009726852009223113, "entropy": 1.5837481403047111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 7065.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 932.5034414761678, "episode_reward_min": 277.5846129154099, "episode_reward_mean": 610.8359378612073, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -500.806681806958, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.0966074878685, "predator_policy": 599.7705117663926}, "policy_reward_mean": {"prey_policy": -51.4403781010927, "predator_policy": 173.60756567333252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.4896647018643, 340.12303909729906, 496.90825785030427, 775.9444095972316, 928.3263244550725, 932.5034414761678, 512.6504912658543, 783.8099900064275, 375.2632614581324, 277.5846129154099, 749.1974982269412, 865.1985513211526, 541.8262397108855, 558.1283572658265, 699.0634041087859, 736.6031030769838, 549.9204632925856, 320.5057716748088], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [47.29508943767401, -121.9276494573801, -171.46035192711872, -168.3941994567885, -84.6935511893032, -408.8821747564593, -13.21015819449752, 47.18041090147727, -37.85316705544204, -185.57573559058335, 37.535033647341926, -418.43152383671077, 208.6287727698366, -146.21886873128835, -70.60621103825198, -142.0644130313912, 88.06452256995486, 150.63287778951306, 131.80565792203038, -106.14625474607013, 53.8679283776205, -357.75051304492655, 25.970944170329307, 364.50538407216317, -329.26491511728847, 298.31780864597357, -39.37985821142435, -230.9721447917285, 65.47475080453954, 139.25043785959622, 0.43079967117882256, -68.51914590446404, -44.898777437143394, -370.07491356538344, -54.43725855976439, -6.394959827914074, -151.60261259983017, 39.007779477962416, 10.194522623121456, 39.29459950013032, 49.97593694364861, -500.806681806958, 11.327273777453817, -408.15689674684705, -55.18620305842467, -174.18115641676016, -57.344076879150535, -128.0165354344377, -75.66527243860521, -296.4903322576935, 194.55101828104347, 362.7714861835752, -37.04359390922265, 77.49198351638091, -291.5024960455287, 261.5299006930145, -109.46088943847727, -34.993726483346116, -299.5187149347649, 387.0966074878685, -68.93973677113482, -79.1450603603744, -1.5074749104702057, 39.15183035790276, 0.47634831350749607, 29.397104343020523, -48.58588182736993, -29.366183194534074, -338.3174557039075, -216.7688047551931, 113.05736713523099, -192.7680473702317, 299.1214143739197, -200.68736711993537, -57.877083917154266, -120.2146345410698, 320.0901823088099, 64.47189391917536, 42.47601730481387, -317.090508765177, 28.736969255197728, 301.076069954585, -240.36950396115859, -1.4968000483499102, -298.23159023350894, -49.850567585263136, -59.33485780625372, 36.68577493368458, -50.33641258449199, -428.56262304467106], "policy_predator_policy_reward": [150.27479952948175, 275.0404227452082, 284.5932538533706, 193.56775626754688, 147.19409489915896, 429.88217475645905, 143.2101581944964, 317.8124320581865, 24.767606127544834, 22.791492656117605, 161.2944738346816, 370.3681260488505, 228.72771845770916, 20.23011665139934, 105.38062004672804, 156.72655096766562, 23.432762309751556, 115.16275784535854, 19.85207983751744, 338.47786813287837, 94.76145397367513, 302.8547815485967, 381.9225025347649, 23.89774729317387, 367.56101064696196, 28.482377565202857, 87.45530680128401, 180.2982724130677, 68.61775723116592, 334.95873315847314, 333.454323344748, 163.77885079546505, 89.19877743714295, 321.4933578708003, 142.2244776132641, 52.98915131730364, 184.50261259983034, 91.59988864059981, 243.66342766168927, 280.55558061352826, 111.27222977880982, 437.74696232613985, 40.533925419484014, 599.7705117663926, 88.78620305842462, 241.18526693432, 123.10591636454161, 277.71653543443927, 64.42848254001188, 302.84578506874914, 0.0, 71.78161434621903, 73.9435939092225, 7.956998202575184, 289.24689374267, 324.509578050534, 142.66088943847566, 70.99372648334614, 114.73075691038876, 7.6504231140988965, 104.3397367711328, 172.5748892953746, 169.77082805896305, 0.7481696420975238, 204.3567093138684, 82.32563250808208, 130.3009449405291, 229.56618319453355, 254.1274785000661, 465.44933926059633, 10.235751098188334, 262.2674055250137, 121.81455954316716, 102.14156340253169, 241.7578414380469, 96.65161005532366, 185.58687520064214, 117.13527416779102, 87.77245764371773, 259.72393578295674, 66.16303074480254, 109.05475059357875, 223.6671405564705, 176.61864577944795, 184.70175065150596, 87.65056758526205, 162.58484694787145, 147.0142250663153, 95.53641258449116, 379.1184055778657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2347677817176725, "mean_inference_ms": 1.4457325208696181, "mean_action_processing_ms": 0.5274090348060968, "mean_env_wait_ms": 0.3814215368176162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008597638871934678, "StateBufferConnector_ms": 0.007836686240302192, "ViewRequirementAgentConnector_ms": 0.22604134347703722}, "num_episodes": 9, "episode_return_max": 932.5034414761678, "episode_return_min": 277.5846129154099, "episode_return_mean": 610.8359378612073, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.460718031637306, "num_env_steps_trained_throughput_per_sec": 33.460718031637306, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 117602.954, "restore_workers_time_ms": 0.018, "training_step_time_ms": 117602.892, "sample_time_ms": 1713.435, "learn_time_ms": 115866.443, "learn_throughput": 34.523, "synch_weights_time_ms": 16.872}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "81797_00000", "date": "2024-08-22_10-49-17", "timestamp": 1724303957, "time_this_iter_s": 119.5809850692749, "time_total_s": 235.26672983169556, "pid": 4493, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15d75f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 235.26672983169556, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.49653179190751, "ram_util_percent": 80.29537572254334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6984197009647475, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.129205320949514, "policy_loss": -0.01969742375364697, "vf_loss": 5.146836391325462, "vf_explained_var": 0.05763328042506159, "kl": 0.010331749875252658, "entropy": 1.564572936891244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 11775.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1813239047102106, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.396392354337527, "policy_loss": -0.023220942325933566, "vf_loss": 8.416895129473094, "vf_explained_var": 0.1032283550741313, "kl": 0.013590796285158952, "entropy": 1.5615014378938452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 11775.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 1077.2776235760261, "episode_reward_min": 277.5846129154099, "episode_reward_mean": 679.1551614069895, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -644.5282602115186, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.0966074878685, "predator_policy": 599.7705117663926}, "policy_reward_mean": {"prey_policy": -44.31403235286639, "predator_policy": 180.1450646342628}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.4896647018643, 340.12303909729906, 496.90825785030427, 775.9444095972316, 928.3263244550725, 932.5034414761678, 512.6504912658543, 783.8099900064275, 375.2632614581324, 277.5846129154099, 749.1974982269412, 865.1985513211526, 541.8262397108855, 558.1283572658265, 699.0634041087859, 736.6031030769838, 549.9204632925856, 320.5057716748088, 860.9622890247887, 1077.2776235760261, 506.9294865070705, 607.3884672493913, 931.6712494591202, 546.9501079131704, 799.2167355087145, 961.0840980170636, 1050.6624192316349], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [47.29508943767401, -121.9276494573801, -171.46035192711872, -168.3941994567885, -84.6935511893032, -408.8821747564593, -13.21015819449752, 47.18041090147727, -37.85316705544204, -185.57573559058335, 37.535033647341926, -418.43152383671077, 208.6287727698366, -146.21886873128835, -70.60621103825198, -142.0644130313912, 88.06452256995486, 150.63287778951306, 131.80565792203038, -106.14625474607013, 53.8679283776205, -357.75051304492655, 25.970944170329307, 364.50538407216317, -329.26491511728847, 298.31780864597357, -39.37985821142435, -230.9721447917285, 65.47475080453954, 139.25043785959622, 0.43079967117882256, -68.51914590446404, -44.898777437143394, -370.07491356538344, -54.43725855976439, -6.394959827914074, -151.60261259983017, 39.007779477962416, 10.194522623121456, 39.29459950013032, 49.97593694364861, -500.806681806958, 11.327273777453817, -408.15689674684705, -55.18620305842467, -174.18115641676016, -57.344076879150535, -128.0165354344377, -75.66527243860521, -296.4903322576935, 194.55101828104347, 362.7714861835752, -37.04359390922265, 77.49198351638091, -291.5024960455287, 261.5299006930145, -109.46088943847727, -34.993726483346116, -299.5187149347649, 387.0966074878685, -68.93973677113482, -79.1450603603744, -1.5074749104702057, 39.15183035790276, 0.47634831350749607, 29.397104343020523, -48.58588182736993, -29.366183194534074, -338.3174557039075, -216.7688047551931, 113.05736713523099, -192.7680473702317, 299.1214143739197, -200.68736711993537, -57.877083917154266, -120.2146345410698, 320.0901823088099, 64.47189391917536, 42.47601730481387, -317.090508765177, 28.736969255197728, 301.076069954585, -240.36950396115859, -1.4968000483499102, -298.23159023350894, -49.850567585263136, -59.33485780625372, 36.68577493368458, -50.33641258449199, -428.56262304467106, 8.456239568826692, 184.0520515441971, -28.99158883510142, -224.6431778067246, 262.7542891110038, 30.821640499044193, -644.5282602115186, 220.51723029350927, 191.17751552956742, 376.06585640709056, -159.94590835225185, -15.405225793856825, -160.3132041115322, -290.7030350189355, 203.8534779065476, 37.88458343935687, -370.24014663543954, 7.871469060715558, -126.39935533799868, 99.73130753129169, -167.78581724074334, 320.0477698590091, -54.26637888552724, -36.73382246830603, -310.14785073176836, -211.13910062921482, -123.7599418430305, -144.01174401751507, -101.79741782911384, -16.828896842155736, -194.51004189679074, -200.5353996477464, -105.06889120667348, -390.39647092254165, 53.69858719242932, -145.27502718060182, 276.0669108480104, -4.386768589207302, 262.8718885297776, 53.11229835952851, -389.5170819553037, 221.85209390068655, -138.34402441639185, 319.51503110049384, 272.56399918628347], "policy_predator_policy_reward": [150.27479952948175, 275.0404227452082, 284.5932538533706, 193.56775626754688, 147.19409489915896, 429.88217475645905, 143.2101581944964, 317.8124320581865, 24.767606127544834, 22.791492656117605, 161.2944738346816, 370.3681260488505, 228.72771845770916, 20.23011665139934, 105.38062004672804, 156.72655096766562, 23.432762309751556, 115.16275784535854, 19.85207983751744, 338.47786813287837, 94.76145397367513, 302.8547815485967, 381.9225025347649, 23.89774729317387, 367.56101064696196, 28.482377565202857, 87.45530680128401, 180.2982724130677, 68.61775723116592, 334.95873315847314, 333.454323344748, 163.77885079546505, 89.19877743714295, 321.4933578708003, 142.2244776132641, 52.98915131730364, 184.50261259983034, 91.59988864059981, 243.66342766168927, 280.55558061352826, 111.27222977880982, 437.74696232613985, 40.533925419484014, 599.7705117663926, 88.78620305842462, 241.18526693432, 123.10591636454161, 277.71653543443927, 64.42848254001188, 302.84578506874914, 0.0, 71.78161434621903, 73.9435939092225, 7.956998202575184, 289.24689374267, 324.509578050534, 142.66088943847566, 70.99372648334614, 114.73075691038876, 7.6504231140988965, 104.3397367711328, 172.5748892953746, 169.77082805896305, 0.7481696420975238, 204.3567093138684, 82.32563250808208, 130.3009449405291, 229.56618319453355, 254.1274785000661, 465.44933926059633, 10.235751098188334, 262.2674055250137, 121.81455954316716, 102.14156340253169, 241.7578414380469, 96.65161005532366, 185.58687520064214, 117.13527416779102, 87.77245764371773, 259.72393578295674, 66.16303074480254, 109.05475059357875, 223.6671405564705, 176.61864577944795, 184.70175065150596, 87.65056758526205, 162.58484694787145, 147.0142250663153, 95.53641258449116, 379.1184055778657, 201.70253572362083, 18.733145077270542, 201.84853359434513, 80.70674829650906, 156.3435127508321, 55.27927709543404, 192.51690420245347, 84.23187158389104, 84.12248447043221, 487.07310370612237, 179.6910339437158, 43.59112697419268, 199.55330683567456, 456.9467524436947, 49.66116167981352, 1.9154165606434013, 129.3172374564596, 29.72853093928458, 320.2818944186999, 477.29752981637, 368.2676745071862, 9.85223014099052, 158.95816663309301, 224.88437740583544, 418.5949002393469, 235.23910062921422, 29.618837743236842, 424.1507807115103, 133.42517899173967, 322.0533109984909, 210.2987138692873, 403.2110331697264, 484.0806267812594, 517.2131336925702, 21.225444477190067, 351.1790382212995, 29.333089151989682, 42.58676858920764, 60.063238696596585, 35.532661390457164, 288.97926463850627, 55.301630383509554, 310.2751092287938, 71.16237171224788, 38.87402545280612]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3012363303005807, "mean_inference_ms": 1.5315381429196349, "mean_action_processing_ms": 0.5496097138406465, "mean_env_wait_ms": 0.3964991519400647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008490350511338975, "StateBufferConnector_ms": 0.0074258557072392215, "ViewRequirementAgentConnector_ms": 0.22307281140927915}, "num_episodes": 9, "episode_return_max": 1077.2776235760261, "episode_return_min": 277.5846129154099, "episode_return_mean": 679.1551614069895, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.58141134805521, "num_env_steps_trained_throughput_per_sec": 32.58141134805521, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 119325.102, "restore_workers_time_ms": 0.017, "training_step_time_ms": 119325.045, "sample_time_ms": 2046.414, "learn_time_ms": 117257.663, "learn_throughput": 34.113, "synch_weights_time_ms": 15.409}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "81797_00000", "date": "2024-08-22_10-51-20", "timestamp": 1724304080, "time_this_iter_s": 122.81112313270569, "time_total_s": 358.07785296440125, "pid": 4493, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169061e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 358.07785296440125, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.55028571428571, "ram_util_percent": 79.29142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7266858727309355, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.39369970977686, "policy_loss": -0.021466152315105128, "vf_loss": 5.412862316564896, "vf_explained_var": 0.07230338188493328, "kl": 0.011517716287880612, "entropy": 1.537936037538411, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 16485.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8297752690796134, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.9553836053091, "policy_loss": -0.021137654166836727, "vf_loss": 8.97439313592931, "vf_explained_var": 0.11302053943561141, "kl": 0.010640654796012146, "entropy": 1.53877718582781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 16485.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 1118.1404864464653, "episode_reward_min": 277.5846129154099, "episode_reward_mean": 724.0762275997117, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -644.5282602115186, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.0966074878685, "predator_policy": 701.4082379437133}, "policy_reward_mean": {"prey_policy": -52.168351388579765, "predator_policy": 196.9835969085209}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.4896647018643, 340.12303909729906, 496.90825785030427, 775.9444095972316, 928.3263244550725, 932.5034414761678, 512.6504912658543, 783.8099900064275, 375.2632614581324, 277.5846129154099, 749.1974982269412, 865.1985513211526, 541.8262397108855, 558.1283572658265, 699.0634041087859, 736.6031030769838, 549.9204632925856, 320.5057716748088, 860.9622890247887, 1077.2776235760261, 506.9294865070705, 607.3884672493913, 931.6712494591202, 546.9501079131704, 799.2167355087145, 961.0840980170636, 1050.6624192316349, 1110.910947843269, 846.6863692411627, 732.3082439210142, 683.3138497177068, 1118.1404864464653, 586.918492484261, 740.7250906991978, 1106.3481084408193, 804.2032468070166], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [47.29508943767401, -121.9276494573801, -171.46035192711872, -168.3941994567885, -84.6935511893032, -408.8821747564593, -13.21015819449752, 47.18041090147727, -37.85316705544204, -185.57573559058335, 37.535033647341926, -418.43152383671077, 208.6287727698366, -146.21886873128835, -70.60621103825198, -142.0644130313912, 88.06452256995486, 150.63287778951306, 131.80565792203038, -106.14625474607013, 53.8679283776205, -357.75051304492655, 25.970944170329307, 364.50538407216317, -329.26491511728847, 298.31780864597357, -39.37985821142435, -230.9721447917285, 65.47475080453954, 139.25043785959622, 0.43079967117882256, -68.51914590446404, -44.898777437143394, -370.07491356538344, -54.43725855976439, -6.394959827914074, -151.60261259983017, 39.007779477962416, 10.194522623121456, 39.29459950013032, 49.97593694364861, -500.806681806958, 11.327273777453817, -408.15689674684705, -55.18620305842467, -174.18115641676016, -57.344076879150535, -128.0165354344377, -75.66527243860521, -296.4903322576935, 194.55101828104347, 362.7714861835752, -37.04359390922265, 77.49198351638091, -291.5024960455287, 261.5299006930145, -109.46088943847727, -34.993726483346116, -299.5187149347649, 387.0966074878685, -68.93973677113482, -79.1450603603744, -1.5074749104702057, 39.15183035790276, 0.47634831350749607, 29.397104343020523, -48.58588182736993, -29.366183194534074, -338.3174557039075, -216.7688047551931, 113.05736713523099, -192.7680473702317, 299.1214143739197, -200.68736711993537, -57.877083917154266, -120.2146345410698, 320.0901823088099, 64.47189391917536, 42.47601730481387, -317.090508765177, 28.736969255197728, 301.076069954585, -240.36950396115859, -1.4968000483499102, -298.23159023350894, -49.850567585263136, -59.33485780625372, 36.68577493368458, -50.33641258449199, -428.56262304467106, 8.456239568826692, 184.0520515441971, -28.99158883510142, -224.6431778067246, 262.7542891110038, 30.821640499044193, -644.5282602115186, 220.51723029350927, 191.17751552956742, 376.06585640709056, -159.94590835225185, -15.405225793856825, -160.3132041115322, -290.7030350189355, 203.8534779065476, 37.88458343935687, -370.24014663543954, 7.871469060715558, -126.39935533799868, 99.73130753129169, -167.78581724074334, 320.0477698590091, -54.26637888552724, -36.73382246830603, -310.14785073176836, -211.13910062921482, -123.7599418430305, -144.01174401751507, -101.79741782911384, -16.828896842155736, -194.51004189679074, -200.5353996477464, -105.06889120667348, -390.39647092254165, 53.69858719242932, -145.27502718060182, 276.0669108480104, -4.386768589207302, 262.8718885297776, 53.11229835952851, -389.5170819553037, 221.85209390068655, -138.34402441639185, 319.51503110049384, 272.56399918628347, 0.2651210339784902, -611.8860629109723, 334.9068394406195, 323.8323354543693, -128.4635607310206, -154.96877832572173, 273.8726347275052, -212.75699752910438, -221.94745646510052, -201.9044337223189, -82.04605126152057, 79.22365546330425, -79.97147388358528, -13.7310156814992, -363.25136599260594, 120.4285836001134, -414.94896754522887, -344.0524187745479, -352.819514804963, -247.68905175801567, 316.29715673181227, 36.259587042459806, -15.19272207220591, 101.96809358124574, 178.78932382637385, -387.0511984877481, -238.99158191438747, -135.11674009511555, -311.91604995816175, 40.0000000000003, -5.928314944586589, 115.04280495034524, 7.046562717728761, -296.5039250237048, -12.781450243315096, -591.8866945762516, 220.78873338585927, 164.50124601581643, -329.10613657921607, 85.71447210959653, -68.5418074295142, 17.037576572931034, 57.253102430275085, 9.3601284845604, -67.04306916587825], "policy_predator_policy_reward": [150.27479952948175, 275.0404227452082, 284.5932538533706, 193.56775626754688, 147.19409489915896, 429.88217475645905, 143.2101581944964, 317.8124320581865, 24.767606127544834, 22.791492656117605, 161.2944738346816, 370.3681260488505, 228.72771845770916, 20.23011665139934, 105.38062004672804, 156.72655096766562, 23.432762309751556, 115.16275784535854, 19.85207983751744, 338.47786813287837, 94.76145397367513, 302.8547815485967, 381.9225025347649, 23.89774729317387, 367.56101064696196, 28.482377565202857, 87.45530680128401, 180.2982724130677, 68.61775723116592, 334.95873315847314, 333.454323344748, 163.77885079546505, 89.19877743714295, 321.4933578708003, 142.2244776132641, 52.98915131730364, 184.50261259983034, 91.59988864059981, 243.66342766168927, 280.55558061352826, 111.27222977880982, 437.74696232613985, 40.533925419484014, 599.7705117663926, 88.78620305842462, 241.18526693432, 123.10591636454161, 277.71653543443927, 64.42848254001188, 302.84578506874914, 0.0, 71.78161434621903, 73.9435939092225, 7.956998202575184, 289.24689374267, 324.509578050534, 142.66088943847566, 70.99372648334614, 114.73075691038876, 7.6504231140988965, 104.3397367711328, 172.5748892953746, 169.77082805896305, 0.7481696420975238, 204.3567093138684, 82.32563250808208, 130.3009449405291, 229.56618319453355, 254.1274785000661, 465.44933926059633, 10.235751098188334, 262.2674055250137, 121.81455954316716, 102.14156340253169, 241.7578414380469, 96.65161005532366, 185.58687520064214, 117.13527416779102, 87.77245764371773, 259.72393578295674, 66.16303074480254, 109.05475059357875, 223.6671405564705, 176.61864577944795, 184.70175065150596, 87.65056758526205, 162.58484694787145, 147.0142250663153, 95.53641258449116, 379.1184055778657, 201.70253572362083, 18.733145077270542, 201.84853359434513, 80.70674829650906, 156.3435127508321, 55.27927709543404, 192.51690420245347, 84.23187158389104, 84.12248447043221, 487.07310370612237, 179.6910339437158, 43.59112697419268, 199.55330683567456, 456.9467524436947, 49.66116167981352, 1.9154165606434013, 129.3172374564596, 29.72853093928458, 320.2818944186999, 477.29752981637, 368.2676745071862, 9.85223014099052, 158.95816663309301, 224.88437740583544, 418.5949002393469, 235.23910062921422, 29.618837743236842, 424.1507807115103, 133.42517899173967, 322.0533109984909, 210.2987138692873, 403.2110331697264, 484.0806267812594, 517.2131336925702, 21.225444477190067, 351.1790382212995, 29.333089151989682, 42.58676858920764, 60.063238696596585, 35.532661390457164, 288.97926463850627, 55.301630383509554, 310.2751092287938, 71.16237171224788, 38.87402545280612, 373.25831248992904, 298.3148330181742, 24.33706141195664, 359.5089803235676, 136.83708831266588, 265.6876735687069, 2.048105301995894, 295.3717196390339, 363.8617809941877, 437.4221210519755, 71.02544065409244, 193.60345244870476, 518.7200950322637, 50.33101568149968, 358.4044914603569, 341.86087550829507, 338.11411376341823, 542.8745966714127, 553.8587030695626, 145.68692998765948, 187.6624557215859, 92.96544941526699, 33.30996869869279, 125.52303579363709, 60.55813770759195, 267.21998278233104, 571.9093049326273, 516.239981915941, 264.6247933087698, 0.0, 12.350703078889206, 0.0, 239.59944020103725, 614.3705213322996, 67.52874863050282, 173.98720970487219, 253.09422472684057, 701.4082379437133, 183.5314827376426, 244.31533297194306, 148.88629453803344, 205.86609800465774, 108.98143592592997, 214.52784329966423, 177.8756441463548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.325413473780124, "mean_inference_ms": 1.5670244121861436, "mean_action_processing_ms": 0.5560882701772638, "mean_env_wait_ms": 0.4030355262545937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009185075759887695, "StateBufferConnector_ms": 0.007098582055833604, "ViewRequirementAgentConnector_ms": 0.22441546122233072}, "num_episodes": 9, "episode_return_max": 1118.1404864464653, "episode_return_min": 277.5846129154099, "episode_return_mean": 724.0762275997117, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.2014549811541, "num_env_steps_trained_throughput_per_sec": 33.2014549811541, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 119612.99, "restore_workers_time_ms": 0.015, "training_step_time_ms": 119612.929, "sample_time_ms": 1980.901, "learn_time_ms": 117611.329, "learn_throughput": 34.01, "synch_weights_time_ms": 15.073}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "81797_00000", "date": "2024-08-22_10-53-21", "timestamp": 1724304201, "time_this_iter_s": 120.52116823196411, "time_total_s": 478.59902119636536, "pid": 4493, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169060700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 478.59902119636536, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.51578947368421, "ram_util_percent": 79.17251461988305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0326018246875446, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.458928226310989, "policy_loss": -0.022133930614109364, "vf_loss": 5.478689123313645, "vf_explained_var": 0.09012944943839071, "kl": 0.011865152983837692, "entropy": 1.5114607271621687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 21195.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.294845567729063, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 9.042082277123843, "policy_loss": -0.020733026554709155, "vf_loss": 9.060668396392952, "vf_explained_var": 0.1725656600008598, "kl": 0.010734613329875816, "entropy": 1.517638983215243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 21195.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 1456.383835411977, "episode_reward_min": 277.5846129154099, "episode_reward_mean": 761.7371648277795, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 18000, "policy_reward_min": {"prey_policy": -644.5282602115186, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 397.8827629051871, "predator_policy": 760.279228067023}, "policy_reward_mean": {"prey_policy": -52.4646999161127, "predator_policy": 204.81213288166748}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.4896647018643, 340.12303909729906, 496.90825785030427, 775.9444095972316, 928.3263244550725, 932.5034414761678, 512.6504912658543, 783.8099900064275, 375.2632614581324, 277.5846129154099, 749.1974982269412, 865.1985513211526, 541.8262397108855, 558.1283572658265, 699.0634041087859, 736.6031030769838, 549.9204632925856, 320.5057716748088, 860.9622890247887, 1077.2776235760261, 506.9294865070705, 607.3884672493913, 931.6712494591202, 546.9501079131704, 799.2167355087145, 961.0840980170636, 1050.6624192316349, 1110.910947843269, 846.6863692411627, 732.3082439210142, 683.3138497177068, 1118.1404864464653, 586.918492484261, 740.7250906991978, 1106.3481084408193, 804.2032468070166, 918.064979909985, 831.6921378448558, 537.8596171307452, 1456.383835411977, 811.1484964939074, 465.369248471998, 1232.942466182261, 1102.964795049871, 855.0026471648532], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [47.29508943767401, -121.9276494573801, -171.46035192711872, -168.3941994567885, -84.6935511893032, -408.8821747564593, -13.21015819449752, 47.18041090147727, -37.85316705544204, -185.57573559058335, 37.535033647341926, -418.43152383671077, 208.6287727698366, -146.21886873128835, -70.60621103825198, -142.0644130313912, 88.06452256995486, 150.63287778951306, 131.80565792203038, -106.14625474607013, 53.8679283776205, -357.75051304492655, 25.970944170329307, 364.50538407216317, -329.26491511728847, 298.31780864597357, -39.37985821142435, -230.9721447917285, 65.47475080453954, 139.25043785959622, 0.43079967117882256, -68.51914590446404, -44.898777437143394, -370.07491356538344, -54.43725855976439, -6.394959827914074, -151.60261259983017, 39.007779477962416, 10.194522623121456, 39.29459950013032, 49.97593694364861, -500.806681806958, 11.327273777453817, -408.15689674684705, -55.18620305842467, -174.18115641676016, -57.344076879150535, -128.0165354344377, -75.66527243860521, -296.4903322576935, 194.55101828104347, 362.7714861835752, -37.04359390922265, 77.49198351638091, -291.5024960455287, 261.5299006930145, -109.46088943847727, -34.993726483346116, -299.5187149347649, 387.0966074878685, -68.93973677113482, -79.1450603603744, -1.5074749104702057, 39.15183035790276, 0.47634831350749607, 29.397104343020523, -48.58588182736993, -29.366183194534074, -338.3174557039075, -216.7688047551931, 113.05736713523099, -192.7680473702317, 299.1214143739197, -200.68736711993537, -57.877083917154266, -120.2146345410698, 320.0901823088099, 64.47189391917536, 42.47601730481387, -317.090508765177, 28.736969255197728, 301.076069954585, -240.36950396115859, -1.4968000483499102, -298.23159023350894, -49.850567585263136, -59.33485780625372, 36.68577493368458, -50.33641258449199, -428.56262304467106, 8.456239568826692, 184.0520515441971, -28.99158883510142, -224.6431778067246, 262.7542891110038, 30.821640499044193, -644.5282602115186, 220.51723029350927, 191.17751552956742, 376.06585640709056, -159.94590835225185, -15.405225793856825, -160.3132041115322, -290.7030350189355, 203.8534779065476, 37.88458343935687, -370.24014663543954, 7.871469060715558, -126.39935533799868, 99.73130753129169, -167.78581724074334, 320.0477698590091, -54.26637888552724, -36.73382246830603, -310.14785073176836, -211.13910062921482, -123.7599418430305, -144.01174401751507, -101.79741782911384, -16.828896842155736, -194.51004189679074, -200.5353996477464, -105.06889120667348, -390.39647092254165, 53.69858719242932, -145.27502718060182, 276.0669108480104, -4.386768589207302, 262.8718885297776, 53.11229835952851, -389.5170819553037, 221.85209390068655, -138.34402441639185, 319.51503110049384, 272.56399918628347, 0.2651210339784902, -611.8860629109723, 334.9068394406195, 323.8323354543693, -128.4635607310206, -154.96877832572173, 273.8726347275052, -212.75699752910438, -221.94745646510052, -201.9044337223189, -82.04605126152057, 79.22365546330425, -79.97147388358528, -13.7310156814992, -363.25136599260594, 120.4285836001134, -414.94896754522887, -344.0524187745479, -352.819514804963, -247.68905175801567, 316.29715673181227, 36.259587042459806, -15.19272207220591, 101.96809358124574, 178.78932382637385, -387.0511984877481, -238.99158191438747, -135.11674009511555, -311.91604995816175, 40.0000000000003, -5.928314944586589, 115.04280495034524, 7.046562717728761, -296.5039250237048, -12.781450243315096, -591.8866945762516, 220.78873338585927, 164.50124601581643, -329.10613657921607, 85.71447210959653, -68.5418074295142, 17.037576572931034, 57.253102430275085, 9.3601284845604, -67.04306916587825, 87.35126662955066, -106.70786021658401, 179.77940902536028, -15.323394297997044, -589.7442687830933, -201.35570987054587, -43.77563067257884, -260.4338271401729, 182.2898318278983, -183.70170327180162, -505.6098087224272, 11.84475332710261, -342.4570461921943, -426.6516788027824, -31.80413915135222, 189.47009245520115, 355.7531481118902, 363.6487850985707, -139.15221197898157, 98.75971691707153, -91.39928180309687, 107.40698858087701, -195.89917329301596, -109.84735406340852, -73.53499736441633, -167.08295140571903, 129.41766453892637, -294.06305748382175, -346.16601009807675, -598.9644463954062, -309.1433974380411, 98.77109963922472, 168.9831560337733, 291.01434123059175, 197.46675288605488, 397.8827629051871, 262.3600084417114, 37.62848539217771, -31.151642795645216, -139.83667159639106, 60.01957364204037, 14.767740444640049, -322.16179049466956, -17.43635846586255, -105.46539651076392], "policy_predator_policy_reward": [150.27479952948175, 275.0404227452082, 284.5932538533706, 193.56775626754688, 147.19409489915896, 429.88217475645905, 143.2101581944964, 317.8124320581865, 24.767606127544834, 22.791492656117605, 161.2944738346816, 370.3681260488505, 228.72771845770916, 20.23011665139934, 105.38062004672804, 156.72655096766562, 23.432762309751556, 115.16275784535854, 19.85207983751744, 338.47786813287837, 94.76145397367513, 302.8547815485967, 381.9225025347649, 23.89774729317387, 367.56101064696196, 28.482377565202857, 87.45530680128401, 180.2982724130677, 68.61775723116592, 334.95873315847314, 333.454323344748, 163.77885079546505, 89.19877743714295, 321.4933578708003, 142.2244776132641, 52.98915131730364, 184.50261259983034, 91.59988864059981, 243.66342766168927, 280.55558061352826, 111.27222977880982, 437.74696232613985, 40.533925419484014, 599.7705117663926, 88.78620305842462, 241.18526693432, 123.10591636454161, 277.71653543443927, 64.42848254001188, 302.84578506874914, 0.0, 71.78161434621903, 73.9435939092225, 7.956998202575184, 289.24689374267, 324.509578050534, 142.66088943847566, 70.99372648334614, 114.73075691038876, 7.6504231140988965, 104.3397367711328, 172.5748892953746, 169.77082805896305, 0.7481696420975238, 204.3567093138684, 82.32563250808208, 130.3009449405291, 229.56618319453355, 254.1274785000661, 465.44933926059633, 10.235751098188334, 262.2674055250137, 121.81455954316716, 102.14156340253169, 241.7578414380469, 96.65161005532366, 185.58687520064214, 117.13527416779102, 87.77245764371773, 259.72393578295674, 66.16303074480254, 109.05475059357875, 223.6671405564705, 176.61864577944795, 184.70175065150596, 87.65056758526205, 162.58484694787145, 147.0142250663153, 95.53641258449116, 379.1184055778657, 201.70253572362083, 18.733145077270542, 201.84853359434513, 80.70674829650906, 156.3435127508321, 55.27927709543404, 192.51690420245347, 84.23187158389104, 84.12248447043221, 487.07310370612237, 179.6910339437158, 43.59112697419268, 199.55330683567456, 456.9467524436947, 49.66116167981352, 1.9154165606434013, 129.3172374564596, 29.72853093928458, 320.2818944186999, 477.29752981637, 368.2676745071862, 9.85223014099052, 158.95816663309301, 224.88437740583544, 418.5949002393469, 235.23910062921422, 29.618837743236842, 424.1507807115103, 133.42517899173967, 322.0533109984909, 210.2987138692873, 403.2110331697264, 484.0806267812594, 517.2131336925702, 21.225444477190067, 351.1790382212995, 29.333089151989682, 42.58676858920764, 60.063238696596585, 35.532661390457164, 288.97926463850627, 55.301630383509554, 310.2751092287938, 71.16237171224788, 38.87402545280612, 373.25831248992904, 298.3148330181742, 24.33706141195664, 359.5089803235676, 136.83708831266588, 265.6876735687069, 2.048105301995894, 295.3717196390339, 363.8617809941877, 437.4221210519755, 71.02544065409244, 193.60345244870476, 518.7200950322637, 50.33101568149968, 358.4044914603569, 341.86087550829507, 338.11411376341823, 542.8745966714127, 553.8587030695626, 145.68692998765948, 187.6624557215859, 92.96544941526699, 33.30996869869279, 125.52303579363709, 60.55813770759195, 267.21998278233104, 571.9093049326273, 516.239981915941, 264.6247933087698, 0.0, 12.350703078889206, 0.0, 239.59944020103725, 614.3705213322996, 67.52874863050282, 173.98720970487219, 253.09422472684057, 701.4082379437133, 183.5314827376426, 244.31533297194306, 148.88629453803344, 205.86609800465774, 108.98143592592997, 214.52784329966423, 177.8756441463548, 409.22916847163407, 48.564609704132025, 101.78971670336901, 375.19989074989826, 427.92644192371426, 445.66111683985037, 124.6833651638189, 510.324265559108, 152.20336089036164, 105.79706851891204, 760.279228067023, 189.37138232248518, 296.68584188968316, 104.18258851265385, 482.0184958805504, 129.69777770653087, 2.1055829253549825, 5.328181698695691, 366.8006041423196, 83.9721583353224, 206.1465622516874, 102.26540022053733, 429.1991732930162, 300.8583379500981, 135.9528407216206, 57.65006247754645, 352.04779725923146, 4.564683376218243, 708.7907521889854, 619.1747540141155, 320.02706316740085, 126.10333657532391, 118.49691402132117, 120.52000577146615, 100.70319429514493, 36.64851029117548, 97.50899810286529, 128.97151460782126, 169.2714757764565, 143.68135392450446, 253.6563074391074, 580.3969630562136, 199.685457256187, 188.53575910620773, 3.004391691752247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3355086406648558, "mean_inference_ms": 1.5842441673586574, "mean_action_processing_ms": 0.557720655600302, "mean_env_wait_ms": 0.4065440278068585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009513166215684678, "StateBufferConnector_ms": 0.006896919674343533, "ViewRequirementAgentConnector_ms": 0.22473467720879448}, "num_episodes": 9, "episode_return_max": 1456.383835411977, "episode_return_min": 277.5846129154099, "episode_return_mean": 761.7371648277795, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.13107667482027, "num_env_steps_trained_throughput_per_sec": 33.13107667482027, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 119836.907, "restore_workers_time_ms": 0.015, "training_step_time_ms": 119836.849, "sample_time_ms": 1944.762, "learn_time_ms": 117872.099, "learn_throughput": 33.935, "synch_weights_time_ms": 14.766}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "81797_00000", "date": "2024-08-22_10-55-21", "timestamp": 1724304321, "time_this_iter_s": 120.77635407447815, "time_total_s": 599.3753752708435, "pid": 4493, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169066700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 599.3753752708435, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.670348837209303, "ram_util_percent": 78.45988372093022}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.530575839767031, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.454218970539717, "policy_loss": -0.021085209107311192, "vf_loss": 6.472775645671124, "vf_explained_var": 0.08957093649102878, "kl": 0.012642669518265688, "entropy": 1.4666779074446157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 25905.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.133105751891045, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 9.020919319727872, "policy_loss": -0.020217281039023174, "vf_loss": 9.038814605016364, "vf_explained_var": 0.1688272093764789, "kl": 0.011609958099039721, "entropy": 1.4985757860914664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 25905.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 1665.6779671884888, "episode_reward_min": 277.5846129154099, "episode_reward_mean": 780.1326061561363, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 21600, "policy_reward_min": {"prey_policy": -725.5006764269084, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 397.8827629051871, "predator_policy": 850.5702302725535}, "policy_reward_mean": {"prey_policy": -59.894911838447285, "predator_policy": 215.92143306967347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.4896647018643, 340.12303909729906, 496.90825785030427, 775.9444095972316, 928.3263244550725, 932.5034414761678, 512.6504912658543, 783.8099900064275, 375.2632614581324, 277.5846129154099, 749.1974982269412, 865.1985513211526, 541.8262397108855, 558.1283572658265, 699.0634041087859, 736.6031030769838, 549.9204632925856, 320.5057716748088, 860.9622890247887, 1077.2776235760261, 506.9294865070705, 607.3884672493913, 931.6712494591202, 546.9501079131704, 799.2167355087145, 961.0840980170636, 1050.6624192316349, 1110.910947843269, 846.6863692411627, 732.3082439210142, 683.3138497177068, 1118.1404864464653, 586.918492484261, 740.7250906991978, 1106.3481084408193, 804.2032468070166, 918.064979909985, 831.6921378448558, 537.8596171307452, 1456.383835411977, 811.1484964939074, 465.369248471998, 1232.942466182261, 1102.964795049871, 855.0026471648532, 1052.1222865363627, 679.1323745844595, 1665.6779671884888, 501.65347702984013, 838.8110846334466, 750.2272990791964, 650.5208608897303, 919.0398028677886, 791.8031623719675], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [47.29508943767401, -121.9276494573801, -171.46035192711872, -168.3941994567885, -84.6935511893032, -408.8821747564593, -13.21015819449752, 47.18041090147727, -37.85316705544204, -185.57573559058335, 37.535033647341926, -418.43152383671077, 208.6287727698366, -146.21886873128835, -70.60621103825198, -142.0644130313912, 88.06452256995486, 150.63287778951306, 131.80565792203038, -106.14625474607013, 53.8679283776205, -357.75051304492655, 25.970944170329307, 364.50538407216317, -329.26491511728847, 298.31780864597357, -39.37985821142435, -230.9721447917285, 65.47475080453954, 139.25043785959622, 0.43079967117882256, -68.51914590446404, -44.898777437143394, -370.07491356538344, -54.43725855976439, -6.394959827914074, -151.60261259983017, 39.007779477962416, 10.194522623121456, 39.29459950013032, 49.97593694364861, -500.806681806958, 11.327273777453817, -408.15689674684705, -55.18620305842467, -174.18115641676016, -57.344076879150535, -128.0165354344377, -75.66527243860521, -296.4903322576935, 194.55101828104347, 362.7714861835752, -37.04359390922265, 77.49198351638091, -291.5024960455287, 261.5299006930145, -109.46088943847727, -34.993726483346116, -299.5187149347649, 387.0966074878685, -68.93973677113482, -79.1450603603744, -1.5074749104702057, 39.15183035790276, 0.47634831350749607, 29.397104343020523, -48.58588182736993, -29.366183194534074, -338.3174557039075, -216.7688047551931, 113.05736713523099, -192.7680473702317, 299.1214143739197, -200.68736711993537, -57.877083917154266, -120.2146345410698, 320.0901823088099, 64.47189391917536, 42.47601730481387, -317.090508765177, 28.736969255197728, 301.076069954585, -240.36950396115859, -1.4968000483499102, -298.23159023350894, -49.850567585263136, -59.33485780625372, 36.68577493368458, -50.33641258449199, -428.56262304467106, 8.456239568826692, 184.0520515441971, -28.99158883510142, -224.6431778067246, 262.7542891110038, 30.821640499044193, -644.5282602115186, 220.51723029350927, 191.17751552956742, 376.06585640709056, -159.94590835225185, -15.405225793856825, -160.3132041115322, -290.7030350189355, 203.8534779065476, 37.88458343935687, -370.24014663543954, 7.871469060715558, -126.39935533799868, 99.73130753129169, -167.78581724074334, 320.0477698590091, -54.26637888552724, -36.73382246830603, -310.14785073176836, -211.13910062921482, -123.7599418430305, -144.01174401751507, -101.79741782911384, -16.828896842155736, -194.51004189679074, -200.5353996477464, -105.06889120667348, -390.39647092254165, 53.69858719242932, -145.27502718060182, 276.0669108480104, -4.386768589207302, 262.8718885297776, 53.11229835952851, -389.5170819553037, 221.85209390068655, -138.34402441639185, 319.51503110049384, 272.56399918628347, 0.2651210339784902, -611.8860629109723, 334.9068394406195, 323.8323354543693, -128.4635607310206, -154.96877832572173, 273.8726347275052, -212.75699752910438, -221.94745646510052, -201.9044337223189, -82.04605126152057, 79.22365546330425, -79.97147388358528, -13.7310156814992, -363.25136599260594, 120.4285836001134, -414.94896754522887, -344.0524187745479, -352.819514804963, -247.68905175801567, 316.29715673181227, 36.259587042459806, -15.19272207220591, 101.96809358124574, 178.78932382637385, -387.0511984877481, -238.99158191438747, -135.11674009511555, -311.91604995816175, 40.0000000000003, -5.928314944586589, 115.04280495034524, 7.046562717728761, -296.5039250237048, -12.781450243315096, -591.8866945762516, 220.78873338585927, 164.50124601581643, -329.10613657921607, 85.71447210959653, -68.5418074295142, 17.037576572931034, 57.253102430275085, 9.3601284845604, -67.04306916587825, 87.35126662955066, -106.70786021658401, 179.77940902536028, -15.323394297997044, -589.7442687830933, -201.35570987054587, -43.77563067257884, -260.4338271401729, 182.2898318278983, -183.70170327180162, -505.6098087224272, 11.84475332710261, -342.4570461921943, -426.6516788027824, -31.80413915135222, 189.47009245520115, 355.7531481118902, 363.6487850985707, -139.15221197898157, 98.75971691707153, -91.39928180309687, 107.40698858087701, -195.89917329301596, -109.84735406340852, -73.53499736441633, -167.08295140571903, 129.41766453892637, -294.06305748382175, -346.16601009807675, -598.9644463954062, -309.1433974380411, 98.77109963922472, 168.9831560337733, 291.01434123059175, 197.46675288605488, 397.8827629051871, 262.3600084417114, 37.62848539217771, -31.151642795645216, -139.83667159639106, 60.01957364204037, 14.767740444640049, -322.16179049466956, -17.43635846586255, -105.46539651076392, -75.8835178430836, -197.34165721527202, 177.24883581695534, 153.14353110818348, 155.99171710872656, -383.6832742022045, -111.78320348263061, 44.309973799948025, -341.36077635868054, -489.05537158950426, 279.3980651079436, 196.19346822338733, 185.6827546163612, 191.73916260529018, 396.112058639826, -104.25850748678805, -65.92515237441829, -687.4418745833219, 36.719313594018, -299.62101075854395, -82.92294727774625, -236.1249380922377, -158.1649721596023, -213.45009269032383, 127.67580363249061, -611.7812273858285, 167.48288550656338, -222.4520829779386, 16.858396791320274, -578.2958769802984, -25.867700989881595, 217.81243695063316, -374.5770131962856, 61.24997547573646, -725.5006764269084, 317.5090191434664, -154.17266385861063, 56.96322679511338, -207.52724643701842, 18.083401597874317, -96.62208442007255, -88.88020297604842, -454.4439330189119, -233.70484486446654, 53.60010787737709], "policy_predator_policy_reward": [150.27479952948175, 275.0404227452082, 284.5932538533706, 193.56775626754688, 147.19409489915896, 429.88217475645905, 143.2101581944964, 317.8124320581865, 24.767606127544834, 22.791492656117605, 161.2944738346816, 370.3681260488505, 228.72771845770916, 20.23011665139934, 105.38062004672804, 156.72655096766562, 23.432762309751556, 115.16275784535854, 19.85207983751744, 338.47786813287837, 94.76145397367513, 302.8547815485967, 381.9225025347649, 23.89774729317387, 367.56101064696196, 28.482377565202857, 87.45530680128401, 180.2982724130677, 68.61775723116592, 334.95873315847314, 333.454323344748, 163.77885079546505, 89.19877743714295, 321.4933578708003, 142.2244776132641, 52.98915131730364, 184.50261259983034, 91.59988864059981, 243.66342766168927, 280.55558061352826, 111.27222977880982, 437.74696232613985, 40.533925419484014, 599.7705117663926, 88.78620305842462, 241.18526693432, 123.10591636454161, 277.71653543443927, 64.42848254001188, 302.84578506874914, 0.0, 71.78161434621903, 73.9435939092225, 7.956998202575184, 289.24689374267, 324.509578050534, 142.66088943847566, 70.99372648334614, 114.73075691038876, 7.6504231140988965, 104.3397367711328, 172.5748892953746, 169.77082805896305, 0.7481696420975238, 204.3567093138684, 82.32563250808208, 130.3009449405291, 229.56618319453355, 254.1274785000661, 465.44933926059633, 10.235751098188334, 262.2674055250137, 121.81455954316716, 102.14156340253169, 241.7578414380469, 96.65161005532366, 185.58687520064214, 117.13527416779102, 87.77245764371773, 259.72393578295674, 66.16303074480254, 109.05475059357875, 223.6671405564705, 176.61864577944795, 184.70175065150596, 87.65056758526205, 162.58484694787145, 147.0142250663153, 95.53641258449116, 379.1184055778657, 201.70253572362083, 18.733145077270542, 201.84853359434513, 80.70674829650906, 156.3435127508321, 55.27927709543404, 192.51690420245347, 84.23187158389104, 84.12248447043221, 487.07310370612237, 179.6910339437158, 43.59112697419268, 199.55330683567456, 456.9467524436947, 49.66116167981352, 1.9154165606434013, 129.3172374564596, 29.72853093928458, 320.2818944186999, 477.29752981637, 368.2676745071862, 9.85223014099052, 158.95816663309301, 224.88437740583544, 418.5949002393469, 235.23910062921422, 29.618837743236842, 424.1507807115103, 133.42517899173967, 322.0533109984909, 210.2987138692873, 403.2110331697264, 484.0806267812594, 517.2131336925702, 21.225444477190067, 351.1790382212995, 29.333089151989682, 42.58676858920764, 60.063238696596585, 35.532661390457164, 288.97926463850627, 55.301630383509554, 310.2751092287938, 71.16237171224788, 38.87402545280612, 373.25831248992904, 298.3148330181742, 24.33706141195664, 359.5089803235676, 136.83708831266588, 265.6876735687069, 2.048105301995894, 295.3717196390339, 363.8617809941877, 437.4221210519755, 71.02544065409244, 193.60345244870476, 518.7200950322637, 50.33101568149968, 358.4044914603569, 341.86087550829507, 338.11411376341823, 542.8745966714127, 553.8587030695626, 145.68692998765948, 187.6624557215859, 92.96544941526699, 33.30996869869279, 125.52303579363709, 60.55813770759195, 267.21998278233104, 571.9093049326273, 516.239981915941, 264.6247933087698, 0.0, 12.350703078889206, 0.0, 239.59944020103725, 614.3705213322996, 67.52874863050282, 173.98720970487219, 253.09422472684057, 701.4082379437133, 183.5314827376426, 244.31533297194306, 148.88629453803344, 205.86609800465774, 108.98143592592997, 214.52784329966423, 177.8756441463548, 409.22916847163407, 48.564609704132025, 101.78971670336901, 375.19989074989826, 427.92644192371426, 445.66111683985037, 124.6833651638189, 510.324265559108, 152.20336089036164, 105.79706851891204, 760.279228067023, 189.37138232248518, 296.68584188968316, 104.18258851265385, 482.0184958805504, 129.69777770653087, 2.1055829253549825, 5.328181698695691, 366.8006041423196, 83.9721583353224, 206.1465622516874, 102.26540022053733, 429.1991732930162, 300.8583379500981, 135.9528407216206, 57.65006247754645, 352.04779725923146, 4.564683376218243, 708.7907521889854, 619.1747540141155, 320.02706316740085, 126.10333657532391, 118.49691402132117, 120.52000577146615, 100.70319429514493, 36.64851029117548, 97.50899810286529, 128.97151460782126, 169.2714757764565, 143.68135392450446, 253.6563074391074, 580.3969630562136, 199.685457256187, 188.53575910620773, 3.004391691752247, 103.12297190564637, 494.09202742841575, 123.6909154498686, 0.0, 118.05746277692059, 600.8739857941213, 427.29374149588546, 227.33476400278533, 406.1443358692065, 299.05819925553084, 122.43591092162993, 8.943148154646018, 13.961727405341247, 86.20854194945838, 185.00312956460485, 296.69012142887993, 509.1518174936957, 418.6110383094829, 375.3923264747074, 22.335404932126757, 1.981793722446288, 403.676882252377, 164.56705502369226, 293.44588795485856, 538.1266122674826, 738.6460817332073, 165.01139773995774, 412.17310868752895, 206.65839464180058, 455.92622132287624, 0.789853573931198, 6.009079495784854, 570.606627733667, 69.42804800049728, 850.5702302725535, 134.45743547495698, 214.12869233758389, 294.1881668894387, 36.58953739581823, 208.82023352915502, 217.4163223642249, 112.31421975984448, 455.37271627976446, 424.05354141498816, 402.6973199552631]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3395975921518992, "mean_inference_ms": 1.5934056227290059, "mean_action_processing_ms": 0.5574131265626023, "mean_env_wait_ms": 0.4085705945345253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009997685750325521, "StateBufferConnector_ms": 0.006749894883897569, "ViewRequirementAgentConnector_ms": 0.22506493109243889}, "num_episodes": 9, "episode_return_max": 1665.6779671884888, "episode_return_min": 277.5846129154099, "episode_return_mean": 780.1326061561363, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.194324039543496, "num_env_steps_trained_throughput_per_sec": 33.194324039543496, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 119947.845, "restore_workers_time_ms": 0.014, "training_step_time_ms": 119947.789, "sample_time_ms": 1923.343, "learn_time_ms": 118004.754, "learn_throughput": 33.897, "synch_weights_time_ms": 14.776}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "81797_00000", "date": "2024-08-22_10-57-22", "timestamp": 1724304442, "time_this_iter_s": 120.54411101341248, "time_total_s": 719.919486284256, "pid": 4493, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15d630e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 719.919486284256, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.405263157894737, "ram_util_percent": 78.8766081871345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.887870683804186, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.571388582565729, "policy_loss": -0.02191519650473455, "vf_loss": 6.590663716342545, "vf_explained_var": 0.08516902794503863, "kl": 0.013200300094294756, "entropy": 1.43526598531476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 30615.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.265769832364566, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.553256329153754, "policy_loss": -0.021667492862656363, "vf_loss": 8.572663312960582, "vf_explained_var": 0.17009868047293078, "kl": 0.01130252774815984, "entropy": 1.4776849864900998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 30615.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 1665.6779671884888, "episode_reward_min": 277.5846129154099, "episode_reward_mean": 764.2685024286992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"prey_policy": -850.4827272473005, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 397.8827629051871, "predator_policy": 919.6132356496437}, "policy_reward_mean": {"prey_policy": -86.49924889895499, "predator_policy": 239.3529493846938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.4896647018643, 340.12303909729906, 496.90825785030427, 775.9444095972316, 928.3263244550725, 932.5034414761678, 512.6504912658543, 783.8099900064275, 375.2632614581324, 277.5846129154099, 749.1974982269412, 865.1985513211526, 541.8262397108855, 558.1283572658265, 699.0634041087859, 736.6031030769838, 549.9204632925856, 320.5057716748088, 860.9622890247887, 1077.2776235760261, 506.9294865070705, 607.3884672493913, 931.6712494591202, 546.9501079131704, 799.2167355087145, 961.0840980170636, 1050.6624192316349, 1110.910947843269, 846.6863692411627, 732.3082439210142, 683.3138497177068, 1118.1404864464653, 586.918492484261, 740.7250906991978, 1106.3481084408193, 804.2032468070166, 918.064979909985, 831.6921378448558, 537.8596171307452, 1456.383835411977, 811.1484964939074, 465.369248471998, 1232.942466182261, 1102.964795049871, 855.0026471648532, 1052.1222865363627, 679.1323745844595, 1665.6779671884888, 501.65347702984013, 838.8110846334466, 750.2272990791964, 650.5208608897303, 919.0398028677886, 791.8031623719675, 436.22683807028557, 621.611591907997, 774.6049683784626, 957.5826701029254, 666.0187017131211, 662.7277066376042, 476.77219565834577, 662.1998743796155, 764.0103737283335], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [47.29508943767401, -121.9276494573801, -171.46035192711872, -168.3941994567885, -84.6935511893032, -408.8821747564593, -13.21015819449752, 47.18041090147727, -37.85316705544204, -185.57573559058335, 37.535033647341926, -418.43152383671077, 208.6287727698366, -146.21886873128835, -70.60621103825198, -142.0644130313912, 88.06452256995486, 150.63287778951306, 131.80565792203038, -106.14625474607013, 53.8679283776205, -357.75051304492655, 25.970944170329307, 364.50538407216317, -329.26491511728847, 298.31780864597357, -39.37985821142435, -230.9721447917285, 65.47475080453954, 139.25043785959622, 0.43079967117882256, -68.51914590446404, -44.898777437143394, -370.07491356538344, -54.43725855976439, -6.394959827914074, -151.60261259983017, 39.007779477962416, 10.194522623121456, 39.29459950013032, 49.97593694364861, -500.806681806958, 11.327273777453817, -408.15689674684705, -55.18620305842467, -174.18115641676016, -57.344076879150535, -128.0165354344377, -75.66527243860521, -296.4903322576935, 194.55101828104347, 362.7714861835752, -37.04359390922265, 77.49198351638091, -291.5024960455287, 261.5299006930145, -109.46088943847727, -34.993726483346116, -299.5187149347649, 387.0966074878685, -68.93973677113482, -79.1450603603744, -1.5074749104702057, 39.15183035790276, 0.47634831350749607, 29.397104343020523, -48.58588182736993, -29.366183194534074, -338.3174557039075, -216.7688047551931, 113.05736713523099, -192.7680473702317, 299.1214143739197, -200.68736711993537, -57.877083917154266, -120.2146345410698, 320.0901823088099, 64.47189391917536, 42.47601730481387, -317.090508765177, 28.736969255197728, 301.076069954585, -240.36950396115859, -1.4968000483499102, -298.23159023350894, -49.850567585263136, -59.33485780625372, 36.68577493368458, -50.33641258449199, -428.56262304467106, 8.456239568826692, 184.0520515441971, -28.99158883510142, -224.6431778067246, 262.7542891110038, 30.821640499044193, -644.5282602115186, 220.51723029350927, 191.17751552956742, 376.06585640709056, -159.94590835225185, -15.405225793856825, -160.3132041115322, -290.7030350189355, 203.8534779065476, 37.88458343935687, -370.24014663543954, 7.871469060715558, -126.39935533799868, 99.73130753129169, -167.78581724074334, 320.0477698590091, -54.26637888552724, -36.73382246830603, -310.14785073176836, -211.13910062921482, -123.7599418430305, -144.01174401751507, -101.79741782911384, -16.828896842155736, -194.51004189679074, -200.5353996477464, -105.06889120667348, -390.39647092254165, 53.69858719242932, -145.27502718060182, 276.0669108480104, -4.386768589207302, 262.8718885297776, 53.11229835952851, -389.5170819553037, 221.85209390068655, -138.34402441639185, 319.51503110049384, 272.56399918628347, 0.2651210339784902, -611.8860629109723, 334.9068394406195, 323.8323354543693, -128.4635607310206, -154.96877832572173, 273.8726347275052, -212.75699752910438, -221.94745646510052, -201.9044337223189, -82.04605126152057, 79.22365546330425, -79.97147388358528, -13.7310156814992, -363.25136599260594, 120.4285836001134, -414.94896754522887, -344.0524187745479, -352.819514804963, -247.68905175801567, 316.29715673181227, 36.259587042459806, -15.19272207220591, 101.96809358124574, 178.78932382637385, -387.0511984877481, -238.99158191438747, -135.11674009511555, -311.91604995816175, 40.0000000000003, -5.928314944586589, 115.04280495034524, 7.046562717728761, -296.5039250237048, -12.781450243315096, -591.8866945762516, 220.78873338585927, 164.50124601581643, -329.10613657921607, 85.71447210959653, -68.5418074295142, 17.037576572931034, 57.253102430275085, 9.3601284845604, -67.04306916587825, 87.35126662955066, -106.70786021658401, 179.77940902536028, -15.323394297997044, -589.7442687830933, -201.35570987054587, -43.77563067257884, -260.4338271401729, 182.2898318278983, -183.70170327180162, -505.6098087224272, 11.84475332710261, -342.4570461921943, -426.6516788027824, -31.80413915135222, 189.47009245520115, 355.7531481118902, 363.6487850985707, -139.15221197898157, 98.75971691707153, -91.39928180309687, 107.40698858087701, -195.89917329301596, -109.84735406340852, -73.53499736441633, -167.08295140571903, 129.41766453892637, -294.06305748382175, -346.16601009807675, -598.9644463954062, -309.1433974380411, 98.77109963922472, 168.9831560337733, 291.01434123059175, 197.46675288605488, 397.8827629051871, 262.3600084417114, 37.62848539217771, -31.151642795645216, -139.83667159639106, 60.01957364204037, 14.767740444640049, -322.16179049466956, -17.43635846586255, -105.46539651076392, -75.8835178430836, -197.34165721527202, 177.24883581695534, 153.14353110818348, 155.99171710872656, -383.6832742022045, -111.78320348263061, 44.309973799948025, -341.36077635868054, -489.05537158950426, 279.3980651079436, 196.19346822338733, 185.6827546163612, 191.73916260529018, 396.112058639826, -104.25850748678805, -65.92515237441829, -687.4418745833219, 36.719313594018, -299.62101075854395, -82.92294727774625, -236.1249380922377, -158.1649721596023, -213.45009269032383, 127.67580363249061, -611.7812273858285, 167.48288550656338, -222.4520829779386, 16.858396791320274, -578.2958769802984, -25.867700989881595, 217.81243695063316, -374.5770131962856, 61.24997547573646, -725.5006764269084, 317.5090191434664, -154.17266385861063, 56.96322679511338, -207.52724643701842, 18.083401597874317, -96.62208442007255, -88.88020297604842, -454.4439330189119, -233.70484486446654, 53.60010787737709, -493.59315281376047, -375.9298993425908, -283.0434385804242, -69.70414374325576, -384.40015463475146, -341.5019403762717, 98.46042829078675, -700.2238877135626, -215.3473841664938, -247.4278499322025, 140.66461304528232, -246.08232785507647, -451.2551385174997, -302.37787298221014, -51.6014380054819, 222.1245986617986, 311.90969620966314, -118.83152842691166, -683.0087215113668, -377.59809845105883, -365.9553274987982, -137.32884320598865, -467.3463831254204, -398.7385124975814, 279.6727598467446, 94.98689661803877, -114.06975876706804, -799.6747369589153, -62.6799948883664, -850.4827272473005, -444.11751698313805, -368.1577591957496, -115.69532648022893, -200.71311167024953, -154.85789346930036, -601.8883806286608, -144.18211601498595, -590.7880176368132, 328.76113721535074, -532.2118566707317, 40.305833681025355, 252.424140300935, -555.9428138930897, -367.06047365484255, -231.12878311953287], "policy_predator_policy_reward": [150.27479952948175, 275.0404227452082, 284.5932538533706, 193.56775626754688, 147.19409489915896, 429.88217475645905, 143.2101581944964, 317.8124320581865, 24.767606127544834, 22.791492656117605, 161.2944738346816, 370.3681260488505, 228.72771845770916, 20.23011665139934, 105.38062004672804, 156.72655096766562, 23.432762309751556, 115.16275784535854, 19.85207983751744, 338.47786813287837, 94.76145397367513, 302.8547815485967, 381.9225025347649, 23.89774729317387, 367.56101064696196, 28.482377565202857, 87.45530680128401, 180.2982724130677, 68.61775723116592, 334.95873315847314, 333.454323344748, 163.77885079546505, 89.19877743714295, 321.4933578708003, 142.2244776132641, 52.98915131730364, 184.50261259983034, 91.59988864059981, 243.66342766168927, 280.55558061352826, 111.27222977880982, 437.74696232613985, 40.533925419484014, 599.7705117663926, 88.78620305842462, 241.18526693432, 123.10591636454161, 277.71653543443927, 64.42848254001188, 302.84578506874914, 0.0, 71.78161434621903, 73.9435939092225, 7.956998202575184, 289.24689374267, 324.509578050534, 142.66088943847566, 70.99372648334614, 114.73075691038876, 7.6504231140988965, 104.3397367711328, 172.5748892953746, 169.77082805896305, 0.7481696420975238, 204.3567093138684, 82.32563250808208, 130.3009449405291, 229.56618319453355, 254.1274785000661, 465.44933926059633, 10.235751098188334, 262.2674055250137, 121.81455954316716, 102.14156340253169, 241.7578414380469, 96.65161005532366, 185.58687520064214, 117.13527416779102, 87.77245764371773, 259.72393578295674, 66.16303074480254, 109.05475059357875, 223.6671405564705, 176.61864577944795, 184.70175065150596, 87.65056758526205, 162.58484694787145, 147.0142250663153, 95.53641258449116, 379.1184055778657, 201.70253572362083, 18.733145077270542, 201.84853359434513, 80.70674829650906, 156.3435127508321, 55.27927709543404, 192.51690420245347, 84.23187158389104, 84.12248447043221, 487.07310370612237, 179.6910339437158, 43.59112697419268, 199.55330683567456, 456.9467524436947, 49.66116167981352, 1.9154165606434013, 129.3172374564596, 29.72853093928458, 320.2818944186999, 477.29752981637, 368.2676745071862, 9.85223014099052, 158.95816663309301, 224.88437740583544, 418.5949002393469, 235.23910062921422, 29.618837743236842, 424.1507807115103, 133.42517899173967, 322.0533109984909, 210.2987138692873, 403.2110331697264, 484.0806267812594, 517.2131336925702, 21.225444477190067, 351.1790382212995, 29.333089151989682, 42.58676858920764, 60.063238696596585, 35.532661390457164, 288.97926463850627, 55.301630383509554, 310.2751092287938, 71.16237171224788, 38.87402545280612, 373.25831248992904, 298.3148330181742, 24.33706141195664, 359.5089803235676, 136.83708831266588, 265.6876735687069, 2.048105301995894, 295.3717196390339, 363.8617809941877, 437.4221210519755, 71.02544065409244, 193.60345244870476, 518.7200950322637, 50.33101568149968, 358.4044914603569, 341.86087550829507, 338.11411376341823, 542.8745966714127, 553.8587030695626, 145.68692998765948, 187.6624557215859, 92.96544941526699, 33.30996869869279, 125.52303579363709, 60.55813770759195, 267.21998278233104, 571.9093049326273, 516.239981915941, 264.6247933087698, 0.0, 12.350703078889206, 0.0, 239.59944020103725, 614.3705213322996, 67.52874863050282, 173.98720970487219, 253.09422472684057, 701.4082379437133, 183.5314827376426, 244.31533297194306, 148.88629453803344, 205.86609800465774, 108.98143592592997, 214.52784329966423, 177.8756441463548, 409.22916847163407, 48.564609704132025, 101.78971670336901, 375.19989074989826, 427.92644192371426, 445.66111683985037, 124.6833651638189, 510.324265559108, 152.20336089036164, 105.79706851891204, 760.279228067023, 189.37138232248518, 296.68584188968316, 104.18258851265385, 482.0184958805504, 129.69777770653087, 2.1055829253549825, 5.328181698695691, 366.8006041423196, 83.9721583353224, 206.1465622516874, 102.26540022053733, 429.1991732930162, 300.8583379500981, 135.9528407216206, 57.65006247754645, 352.04779725923146, 4.564683376218243, 708.7907521889854, 619.1747540141155, 320.02706316740085, 126.10333657532391, 118.49691402132117, 120.52000577146615, 100.70319429514493, 36.64851029117548, 97.50899810286529, 128.97151460782126, 169.2714757764565, 143.68135392450446, 253.6563074391074, 580.3969630562136, 199.685457256187, 188.53575910620773, 3.004391691752247, 103.12297190564637, 494.09202742841575, 123.6909154498686, 0.0, 118.05746277692059, 600.8739857941213, 427.29374149588546, 227.33476400278533, 406.1443358692065, 299.05819925553084, 122.43591092162993, 8.943148154646018, 13.961727405341247, 86.20854194945838, 185.00312956460485, 296.69012142887993, 509.1518174936957, 418.6110383094829, 375.3923264747074, 22.335404932126757, 1.981793722446288, 403.676882252377, 164.56705502369226, 293.44588795485856, 538.1266122674826, 738.6460817332073, 165.01139773995774, 412.17310868752895, 206.65839464180058, 455.92622132287624, 0.789853573931198, 6.009079495784854, 570.606627733667, 69.42804800049728, 850.5702302725535, 134.45743547495698, 214.12869233758389, 294.1881668894387, 36.58953739581823, 208.82023352915502, 217.4163223642249, 112.31421975984448, 455.37271627976446, 424.05354141498816, 402.6973199552631, 534.9174713699433, 126.34648514834734, 444.5910695881184, 306.9488357931309, 630.093765285526, 225.74190280600948, 557.0231019493822, 711.9238877135629, 430.32636037495104, 102.63697296183315, 292.1178209921018, 466.4624847500129, 381.40812483705884, 118.29614116425385, 426.9725609500163, 105.11624334468044, 535.1334123477513, 410.2923132196269, 411.11291748072495, 141.33183722801033, 392.87312997540266, 297.2574580061223, 221.14779504752136, 421.03851249758213, 423.39811266752963, 75.64949323995098, 735.1338463257667, 559.0679012883901, 105.18355137746377, 919.6132356496437, 82.5938987068733, 652.4713101621184, 581.2414686733892, 60.27448114031244, 383.73264477431235, 430.0987988177018, 876.5100389317196, 256.7351575747115, 480.54232423057425, 158.62278856074704, 303.2752985504545, 0.0, 343.94489380626584, 404.83316353912596, 573.3591145179873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3414839872564612, "mean_inference_ms": 1.5992916310606686, "mean_action_processing_ms": 0.5566197833557299, "mean_env_wait_ms": 0.40992265823658486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009730694785950676, "StateBufferConnector_ms": 0.00684696530538892, "ViewRequirementAgentConnector_ms": 0.22254368615528894}, "num_episodes": 9, "episode_return_max": 1665.6779671884888, "episode_return_min": 277.5846129154099, "episode_return_mean": 764.2685024286992, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.30235799354791, "num_env_steps_trained_throughput_per_sec": 33.30235799354791, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 119971.242, "restore_workers_time_ms": 0.015, "training_step_time_ms": 119971.187, "sample_time_ms": 1906.403, "learn_time_ms": 118045.19, "learn_throughput": 33.885, "synch_weights_time_ms": 14.67}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "81797_00000", "date": "2024-08-22_10-59-22", "timestamp": 1724304562, "time_this_iter_s": 120.15342426300049, "time_total_s": 840.0729105472565, "pid": 4493, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x169060430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 840.0729105472565, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.55823529411765, "ram_util_percent": 80.01823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.661685991211302, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.877643063721384, "policy_loss": -0.020595287399330905, "vf_loss": 7.8958135346698155, "vf_explained_var": 0.07367687831512176, "kl": 0.012124169728197213, "entropy": 1.391375231591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 35325.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7561603287729235, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.728021746734652, "policy_loss": -0.023270282506964498, "vf_loss": 7.74862957810647, "vf_explained_var": 0.061434994887900704, "kl": 0.013312221656911545, "entropy": 1.4347582626241535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 35325.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 1665.6779671884888, "episode_reward_min": 277.5846129154099, "episode_reward_mean": 753.030921673485, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -905.360134504755, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 397.8827629051871, "predator_policy": 919.6132356496437}, "policy_reward_mean": {"prey_policy": -105.78551979122017, "predator_policy": 256.3917041259162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.4896647018643, 340.12303909729906, 496.90825785030427, 775.9444095972316, 928.3263244550725, 932.5034414761678, 512.6504912658543, 783.8099900064275, 375.2632614581324, 277.5846129154099, 749.1974982269412, 865.1985513211526, 541.8262397108855, 558.1283572658265, 699.0634041087859, 736.6031030769838, 549.9204632925856, 320.5057716748088, 860.9622890247887, 1077.2776235760261, 506.9294865070705, 607.3884672493913, 931.6712494591202, 546.9501079131704, 799.2167355087145, 961.0840980170636, 1050.6624192316349, 1110.910947843269, 846.6863692411627, 732.3082439210142, 683.3138497177068, 1118.1404864464653, 586.918492484261, 740.7250906991978, 1106.3481084408193, 804.2032468070166, 918.064979909985, 831.6921378448558, 537.8596171307452, 1456.383835411977, 811.1484964939074, 465.369248471998, 1232.942466182261, 1102.964795049871, 855.0026471648532, 1052.1222865363627, 679.1323745844595, 1665.6779671884888, 501.65347702984013, 838.8110846334466, 750.2272990791964, 650.5208608897303, 919.0398028677886, 791.8031623719675, 436.22683807028557, 621.611591907997, 774.6049683784626, 957.5826701029254, 666.0187017131211, 662.7277066376042, 476.77219565834577, 662.1998743796155, 764.0103737283335, 1049.2063140772525, 503.70969090717756, 687.3843319513226, 407.22722421591124, 845.3962299020411, 580.4820399472668, 508.3604246288495, 503.987767079175, 983.556684773873], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [47.29508943767401, -121.9276494573801, -171.46035192711872, -168.3941994567885, -84.6935511893032, -408.8821747564593, -13.21015819449752, 47.18041090147727, -37.85316705544204, -185.57573559058335, 37.535033647341926, -418.43152383671077, 208.6287727698366, -146.21886873128835, -70.60621103825198, -142.0644130313912, 88.06452256995486, 150.63287778951306, 131.80565792203038, -106.14625474607013, 53.8679283776205, -357.75051304492655, 25.970944170329307, 364.50538407216317, -329.26491511728847, 298.31780864597357, -39.37985821142435, -230.9721447917285, 65.47475080453954, 139.25043785959622, 0.43079967117882256, -68.51914590446404, -44.898777437143394, -370.07491356538344, -54.43725855976439, -6.394959827914074, -151.60261259983017, 39.007779477962416, 10.194522623121456, 39.29459950013032, 49.97593694364861, -500.806681806958, 11.327273777453817, -408.15689674684705, -55.18620305842467, -174.18115641676016, -57.344076879150535, -128.0165354344377, -75.66527243860521, -296.4903322576935, 194.55101828104347, 362.7714861835752, -37.04359390922265, 77.49198351638091, -291.5024960455287, 261.5299006930145, -109.46088943847727, -34.993726483346116, -299.5187149347649, 387.0966074878685, -68.93973677113482, -79.1450603603744, -1.5074749104702057, 39.15183035790276, 0.47634831350749607, 29.397104343020523, -48.58588182736993, -29.366183194534074, -338.3174557039075, -216.7688047551931, 113.05736713523099, -192.7680473702317, 299.1214143739197, -200.68736711993537, -57.877083917154266, -120.2146345410698, 320.0901823088099, 64.47189391917536, 42.47601730481387, -317.090508765177, 28.736969255197728, 301.076069954585, -240.36950396115859, -1.4968000483499102, -298.23159023350894, -49.850567585263136, -59.33485780625372, 36.68577493368458, -50.33641258449199, -428.56262304467106, 8.456239568826692, 184.0520515441971, -28.99158883510142, -224.6431778067246, 262.7542891110038, 30.821640499044193, -644.5282602115186, 220.51723029350927, 191.17751552956742, 376.06585640709056, -159.94590835225185, -15.405225793856825, -160.3132041115322, -290.7030350189355, 203.8534779065476, 37.88458343935687, -370.24014663543954, 7.871469060715558, -126.39935533799868, 99.73130753129169, -167.78581724074334, 320.0477698590091, -54.26637888552724, -36.73382246830603, -310.14785073176836, -211.13910062921482, -123.7599418430305, -144.01174401751507, -101.79741782911384, -16.828896842155736, -194.51004189679074, -200.5353996477464, -105.06889120667348, -390.39647092254165, 53.69858719242932, -145.27502718060182, 276.0669108480104, -4.386768589207302, 262.8718885297776, 53.11229835952851, -389.5170819553037, 221.85209390068655, -138.34402441639185, 319.51503110049384, 272.56399918628347, 0.2651210339784902, -611.8860629109723, 334.9068394406195, 323.8323354543693, -128.4635607310206, -154.96877832572173, 273.8726347275052, -212.75699752910438, -221.94745646510052, -201.9044337223189, -82.04605126152057, 79.22365546330425, -79.97147388358528, -13.7310156814992, -363.25136599260594, 120.4285836001134, -414.94896754522887, -344.0524187745479, -352.819514804963, -247.68905175801567, 316.29715673181227, 36.259587042459806, -15.19272207220591, 101.96809358124574, 178.78932382637385, -387.0511984877481, -238.99158191438747, -135.11674009511555, -311.91604995816175, 40.0000000000003, -5.928314944586589, 115.04280495034524, 7.046562717728761, -296.5039250237048, -12.781450243315096, -591.8866945762516, 220.78873338585927, 164.50124601581643, -329.10613657921607, 85.71447210959653, -68.5418074295142, 17.037576572931034, 57.253102430275085, 9.3601284845604, -67.04306916587825, 87.35126662955066, -106.70786021658401, 179.77940902536028, -15.323394297997044, -589.7442687830933, -201.35570987054587, -43.77563067257884, -260.4338271401729, 182.2898318278983, -183.70170327180162, -505.6098087224272, 11.84475332710261, -342.4570461921943, -426.6516788027824, -31.80413915135222, 189.47009245520115, 355.7531481118902, 363.6487850985707, -139.15221197898157, 98.75971691707153, -91.39928180309687, 107.40698858087701, -195.89917329301596, -109.84735406340852, -73.53499736441633, -167.08295140571903, 129.41766453892637, -294.06305748382175, -346.16601009807675, -598.9644463954062, -309.1433974380411, 98.77109963922472, 168.9831560337733, 291.01434123059175, 197.46675288605488, 397.8827629051871, 262.3600084417114, 37.62848539217771, -31.151642795645216, -139.83667159639106, 60.01957364204037, 14.767740444640049, -322.16179049466956, -17.43635846586255, -105.46539651076392, -75.8835178430836, -197.34165721527202, 177.24883581695534, 153.14353110818348, 155.99171710872656, -383.6832742022045, -111.78320348263061, 44.309973799948025, -341.36077635868054, -489.05537158950426, 279.3980651079436, 196.19346822338733, 185.6827546163612, 191.73916260529018, 396.112058639826, -104.25850748678805, -65.92515237441829, -687.4418745833219, 36.719313594018, -299.62101075854395, -82.92294727774625, -236.1249380922377, -158.1649721596023, -213.45009269032383, 127.67580363249061, -611.7812273858285, 167.48288550656338, -222.4520829779386, 16.858396791320274, -578.2958769802984, -25.867700989881595, 217.81243695063316, -374.5770131962856, 61.24997547573646, -725.5006764269084, 317.5090191434664, -154.17266385861063, 56.96322679511338, -207.52724643701842, 18.083401597874317, -96.62208442007255, -88.88020297604842, -454.4439330189119, -233.70484486446654, 53.60010787737709, -493.59315281376047, -375.9298993425908, -283.0434385804242, -69.70414374325576, -384.40015463475146, -341.5019403762717, 98.46042829078675, -700.2238877135626, -215.3473841664938, -247.4278499322025, 140.66461304528232, -246.08232785507647, -451.2551385174997, -302.37787298221014, -51.6014380054819, 222.1245986617986, 311.90969620966314, -118.83152842691166, -683.0087215113668, -377.59809845105883, -365.9553274987982, -137.32884320598865, -467.3463831254204, -398.7385124975814, 279.6727598467446, 94.98689661803877, -114.06975876706804, -799.6747369589153, -62.6799948883664, -850.4827272473005, -444.11751698313805, -368.1577591957496, -115.69532648022893, -200.71311167024953, -154.85789346930036, -601.8883806286608, -144.18211601498595, -590.7880176368132, 328.76113721535074, -532.2118566707317, 40.305833681025355, 252.424140300935, -555.9428138930897, -367.06047365484255, -231.12878311953287, -901.6910706468126, -335.09435087875977, 300.1253387649006, 182.74363880854244, -5.804105131646793, -282.15896547520737, -296.2252749949149, -290.9839408301712, -350.30758365968296, -438.30388262876517, -517.6244668424557, -233.17021450628303, 5.293742795790365, -187.91025637791313, -176.72645945298697, -31.934491263847583, -761.8978569691193, 76.09082869203672, -905.360134504755, -30.23086776213176, -233.40863927042633, 132.6564314306599, 44.172111903235404, -280.29478282224403, -547.8487530940575, -27.76038740209462, -130.49479362478823, -52.72328402698819, -734.0054479585804, -317.22784766304954, -687.2031943991908, -144.39269118749218, 39.76408770414724, -13.214707190862264, -479.6379557304605, -157.29289286024675, -478.88924145217396, -55.38092892384477, -266.1686545631105, -625.4548011621507, -11.795005475775028, -171.9867604362092, -207.2444331489648, 60.58531954576698, -309.1060969953529], "policy_predator_policy_reward": [150.27479952948175, 275.0404227452082, 284.5932538533706, 193.56775626754688, 147.19409489915896, 429.88217475645905, 143.2101581944964, 317.8124320581865, 24.767606127544834, 22.791492656117605, 161.2944738346816, 370.3681260488505, 228.72771845770916, 20.23011665139934, 105.38062004672804, 156.72655096766562, 23.432762309751556, 115.16275784535854, 19.85207983751744, 338.47786813287837, 94.76145397367513, 302.8547815485967, 381.9225025347649, 23.89774729317387, 367.56101064696196, 28.482377565202857, 87.45530680128401, 180.2982724130677, 68.61775723116592, 334.95873315847314, 333.454323344748, 163.77885079546505, 89.19877743714295, 321.4933578708003, 142.2244776132641, 52.98915131730364, 184.50261259983034, 91.59988864059981, 243.66342766168927, 280.55558061352826, 111.27222977880982, 437.74696232613985, 40.533925419484014, 599.7705117663926, 88.78620305842462, 241.18526693432, 123.10591636454161, 277.71653543443927, 64.42848254001188, 302.84578506874914, 0.0, 71.78161434621903, 73.9435939092225, 7.956998202575184, 289.24689374267, 324.509578050534, 142.66088943847566, 70.99372648334614, 114.73075691038876, 7.6504231140988965, 104.3397367711328, 172.5748892953746, 169.77082805896305, 0.7481696420975238, 204.3567093138684, 82.32563250808208, 130.3009449405291, 229.56618319453355, 254.1274785000661, 465.44933926059633, 10.235751098188334, 262.2674055250137, 121.81455954316716, 102.14156340253169, 241.7578414380469, 96.65161005532366, 185.58687520064214, 117.13527416779102, 87.77245764371773, 259.72393578295674, 66.16303074480254, 109.05475059357875, 223.6671405564705, 176.61864577944795, 184.70175065150596, 87.65056758526205, 162.58484694787145, 147.0142250663153, 95.53641258449116, 379.1184055778657, 201.70253572362083, 18.733145077270542, 201.84853359434513, 80.70674829650906, 156.3435127508321, 55.27927709543404, 192.51690420245347, 84.23187158389104, 84.12248447043221, 487.07310370612237, 179.6910339437158, 43.59112697419268, 199.55330683567456, 456.9467524436947, 49.66116167981352, 1.9154165606434013, 129.3172374564596, 29.72853093928458, 320.2818944186999, 477.29752981637, 368.2676745071862, 9.85223014099052, 158.95816663309301, 224.88437740583544, 418.5949002393469, 235.23910062921422, 29.618837743236842, 424.1507807115103, 133.42517899173967, 322.0533109984909, 210.2987138692873, 403.2110331697264, 484.0806267812594, 517.2131336925702, 21.225444477190067, 351.1790382212995, 29.333089151989682, 42.58676858920764, 60.063238696596585, 35.532661390457164, 288.97926463850627, 55.301630383509554, 310.2751092287938, 71.16237171224788, 38.87402545280612, 373.25831248992904, 298.3148330181742, 24.33706141195664, 359.5089803235676, 136.83708831266588, 265.6876735687069, 2.048105301995894, 295.3717196390339, 363.8617809941877, 437.4221210519755, 71.02544065409244, 193.60345244870476, 518.7200950322637, 50.33101568149968, 358.4044914603569, 341.86087550829507, 338.11411376341823, 542.8745966714127, 553.8587030695626, 145.68692998765948, 187.6624557215859, 92.96544941526699, 33.30996869869279, 125.52303579363709, 60.55813770759195, 267.21998278233104, 571.9093049326273, 516.239981915941, 264.6247933087698, 0.0, 12.350703078889206, 0.0, 239.59944020103725, 614.3705213322996, 67.52874863050282, 173.98720970487219, 253.09422472684057, 701.4082379437133, 183.5314827376426, 244.31533297194306, 148.88629453803344, 205.86609800465774, 108.98143592592997, 214.52784329966423, 177.8756441463548, 409.22916847163407, 48.564609704132025, 101.78971670336901, 375.19989074989826, 427.92644192371426, 445.66111683985037, 124.6833651638189, 510.324265559108, 152.20336089036164, 105.79706851891204, 760.279228067023, 189.37138232248518, 296.68584188968316, 104.18258851265385, 482.0184958805504, 129.69777770653087, 2.1055829253549825, 5.328181698695691, 366.8006041423196, 83.9721583353224, 206.1465622516874, 102.26540022053733, 429.1991732930162, 300.8583379500981, 135.9528407216206, 57.65006247754645, 352.04779725923146, 4.564683376218243, 708.7907521889854, 619.1747540141155, 320.02706316740085, 126.10333657532391, 118.49691402132117, 120.52000577146615, 100.70319429514493, 36.64851029117548, 97.50899810286529, 128.97151460782126, 169.2714757764565, 143.68135392450446, 253.6563074391074, 580.3969630562136, 199.685457256187, 188.53575910620773, 3.004391691752247, 103.12297190564637, 494.09202742841575, 123.6909154498686, 0.0, 118.05746277692059, 600.8739857941213, 427.29374149588546, 227.33476400278533, 406.1443358692065, 299.05819925553084, 122.43591092162993, 8.943148154646018, 13.961727405341247, 86.20854194945838, 185.00312956460485, 296.69012142887993, 509.1518174936957, 418.6110383094829, 375.3923264747074, 22.335404932126757, 1.981793722446288, 403.676882252377, 164.56705502369226, 293.44588795485856, 538.1266122674826, 738.6460817332073, 165.01139773995774, 412.17310868752895, 206.65839464180058, 455.92622132287624, 0.789853573931198, 6.009079495784854, 570.606627733667, 69.42804800049728, 850.5702302725535, 134.45743547495698, 214.12869233758389, 294.1881668894387, 36.58953739581823, 208.82023352915502, 217.4163223642249, 112.31421975984448, 455.37271627976446, 424.05354141498816, 402.6973199552631, 534.9174713699433, 126.34648514834734, 444.5910695881184, 306.9488357931309, 630.093765285526, 225.74190280600948, 557.0231019493822, 711.9238877135629, 430.32636037495104, 102.63697296183315, 292.1178209921018, 466.4624847500129, 381.40812483705884, 118.29614116425385, 426.9725609500163, 105.11624334468044, 535.1334123477513, 410.2923132196269, 411.11291748072495, 141.33183722801033, 392.87312997540266, 297.2574580061223, 221.14779504752136, 421.03851249758213, 423.39811266752963, 75.64949323995098, 735.1338463257667, 559.0679012883901, 105.18355137746377, 919.6132356496437, 82.5938987068733, 652.4713101621184, 581.2414686733892, 60.27448114031244, 383.73264477431235, 430.0987988177018, 876.5100389317196, 256.7351575747115, 480.54232423057425, 158.62278856074704, 303.2752985504545, 0.0, 343.94489380626584, 404.83316353912596, 573.3591145179873, 184.9633619138559, 192.75082422096074, 282.5078503654039, 432.4125721145706, 716.2922545462371, 59.25512736032034, 696.8098035352372, 871.4867136358496, 20.321163918126302, 513.8165300463841, 233.95636238152687, 493.95809719625163, 303.1976632490941, 380.31991359342123, 386.0899499148729, 555.5690554615447, 155.13990429218913, 144.67891763865924, 519.4553556945516, 685.7165129367819, 239.66600443015008, 506.9933133659911, 601.4141835961516, 229.31214224593882, 152.73421811663266, 403.5590029895363, 96.30787597913806, 195.03335226428058, 474.69938786135685, 673.0941815284502, 566.0864350937024, 557.6077305563965, 11.97680771319312, 142.4331237769783, 514.9407882924398, 127.72345100642097, 528.5292213860045, 692.3684876913393, 264.43917969265004, 474.1139462642842, 339.5076982273875, 105.03619109291974, 445.95484922573496, 25.026212084795894, 707.5787106535686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.342981915660634, "mean_inference_ms": 1.6044716191770323, "mean_action_processing_ms": 0.5558613676273728, "mean_env_wait_ms": 0.4111493684071694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009600652588738335, "StateBufferConnector_ms": 0.006805194748772515, "ViewRequirementAgentConnector_ms": 0.2225569552845425}, "num_episodes": 9, "episode_return_max": 1665.6779671884888, "episode_return_min": 277.5846129154099, "episode_return_mean": 753.030921673485, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.88585442387081, "num_env_steps_trained_throughput_per_sec": 32.88585442387081, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 120178.943, "restore_workers_time_ms": 0.015, "training_step_time_ms": 120178.89, "sample_time_ms": 1907.567, "learn_time_ms": 118251.814, "learn_throughput": 33.826, "synch_weights_time_ms": 14.607}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "81797_00000", "date": "2024-08-22_11-01-24", "timestamp": 1724304684, "time_this_iter_s": 121.66944479942322, "time_total_s": 961.7423553466797, "pid": 4493, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16907f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 961.7423553466797, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.401162790697676, "ram_util_percent": 82.1906976744186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4849047271562483, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.133720061227268, "policy_loss": -0.018768612547103325, "vf_loss": 7.150118788943929, "vf_explained_var": 0.08847904870970741, "kl": 0.011849411613074108, "entropy": 1.3457514420183347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 40035.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.098527734940219, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.463804302296568, "policy_loss": -0.02424724042146702, "vf_loss": 7.485498506602714, "vf_explained_var": 0.05987316610453741, "kl": 0.01276520349770615, "entropy": 1.412717858216312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 40035.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 1665.6779671884888, "episode_reward_min": 174.08768603295422, "episode_reward_mean": 719.4454070803157, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 34000, "policy_reward_min": {"prey_policy": -1080.9089803551608, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 397.8827629051871, "predator_policy": 1074.324781163539}, "policy_reward_mean": {"prey_policy": -143.03239495474298, "predator_policy": 286.9214763708052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.4896647018643, 340.12303909729906, 496.90825785030427, 775.9444095972316, 928.3263244550725, 932.5034414761678, 512.6504912658543, 783.8099900064275, 375.2632614581324, 277.5846129154099, 749.1974982269412, 865.1985513211526, 541.8262397108855, 558.1283572658265, 699.0634041087859, 736.6031030769838, 549.9204632925856, 320.5057716748088, 860.9622890247887, 1077.2776235760261, 506.9294865070705, 607.3884672493913, 931.6712494591202, 546.9501079131704, 799.2167355087145, 961.0840980170636, 1050.6624192316349, 1110.910947843269, 846.6863692411627, 732.3082439210142, 683.3138497177068, 1118.1404864464653, 586.918492484261, 740.7250906991978, 1106.3481084408193, 804.2032468070166, 918.064979909985, 831.6921378448558, 537.8596171307452, 1456.383835411977, 811.1484964939074, 465.369248471998, 1232.942466182261, 1102.964795049871, 855.0026471648532, 1052.1222865363627, 679.1323745844595, 1665.6779671884888, 501.65347702984013, 838.8110846334466, 750.2272990791964, 650.5208608897303, 919.0398028677886, 791.8031623719675, 436.22683807028557, 621.611591907997, 774.6049683784626, 957.5826701029254, 666.0187017131211, 662.7277066376042, 476.77219565834577, 662.1998743796155, 764.0103737283335, 1049.2063140772525, 503.70969090717756, 687.3843319513226, 407.22722421591124, 845.3962299020411, 580.4820399472668, 508.3604246288495, 503.987767079175, 983.556684773873, 375.60190465516644, 578.4640179198325, 539.8040335945689, 174.08768603295422, 760.2052956627383, 623.1690719873809, 614.2124328219974, 563.0964977144127, 366.4575882695748, 503.65327716737085, 606.261403185371, 536.2204554613205, 693.3995768632268], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [47.29508943767401, -121.9276494573801, -171.46035192711872, -168.3941994567885, -84.6935511893032, -408.8821747564593, -13.21015819449752, 47.18041090147727, -37.85316705544204, -185.57573559058335, 37.535033647341926, -418.43152383671077, 208.6287727698366, -146.21886873128835, -70.60621103825198, -142.0644130313912, 88.06452256995486, 150.63287778951306, 131.80565792203038, -106.14625474607013, 53.8679283776205, -357.75051304492655, 25.970944170329307, 364.50538407216317, -329.26491511728847, 298.31780864597357, -39.37985821142435, -230.9721447917285, 65.47475080453954, 139.25043785959622, 0.43079967117882256, -68.51914590446404, -44.898777437143394, -370.07491356538344, -54.43725855976439, -6.394959827914074, -151.60261259983017, 39.007779477962416, 10.194522623121456, 39.29459950013032, 49.97593694364861, -500.806681806958, 11.327273777453817, -408.15689674684705, -55.18620305842467, -174.18115641676016, -57.344076879150535, -128.0165354344377, -75.66527243860521, -296.4903322576935, 194.55101828104347, 362.7714861835752, -37.04359390922265, 77.49198351638091, -291.5024960455287, 261.5299006930145, -109.46088943847727, -34.993726483346116, -299.5187149347649, 387.0966074878685, -68.93973677113482, -79.1450603603744, -1.5074749104702057, 39.15183035790276, 0.47634831350749607, 29.397104343020523, -48.58588182736993, -29.366183194534074, -338.3174557039075, -216.7688047551931, 113.05736713523099, -192.7680473702317, 299.1214143739197, -200.68736711993537, -57.877083917154266, -120.2146345410698, 320.0901823088099, 64.47189391917536, 42.47601730481387, -317.090508765177, 28.736969255197728, 301.076069954585, -240.36950396115859, -1.4968000483499102, -298.23159023350894, -49.850567585263136, -59.33485780625372, 36.68577493368458, -50.33641258449199, -428.56262304467106, 8.456239568826692, 184.0520515441971, -28.99158883510142, -224.6431778067246, 262.7542891110038, 30.821640499044193, -644.5282602115186, 220.51723029350927, 191.17751552956742, 376.06585640709056, -159.94590835225185, -15.405225793856825, -160.3132041115322, -290.7030350189355, 203.8534779065476, 37.88458343935687, -370.24014663543954, 7.871469060715558, -126.39935533799868, 99.73130753129169, -167.78581724074334, 320.0477698590091, -54.26637888552724, -36.73382246830603, -310.14785073176836, -211.13910062921482, -123.7599418430305, -144.01174401751507, -101.79741782911384, -16.828896842155736, -194.51004189679074, -200.5353996477464, -105.06889120667348, -390.39647092254165, 53.69858719242932, -145.27502718060182, 276.0669108480104, -4.386768589207302, 262.8718885297776, 53.11229835952851, -389.5170819553037, 221.85209390068655, -138.34402441639185, 319.51503110049384, 272.56399918628347, 0.2651210339784902, -611.8860629109723, 334.9068394406195, 323.8323354543693, -128.4635607310206, -154.96877832572173, 273.8726347275052, -212.75699752910438, -221.94745646510052, -201.9044337223189, -82.04605126152057, 79.22365546330425, -79.97147388358528, -13.7310156814992, -363.25136599260594, 120.4285836001134, -414.94896754522887, -344.0524187745479, -352.819514804963, -247.68905175801567, 316.29715673181227, 36.259587042459806, -15.19272207220591, 101.96809358124574, 178.78932382637385, -387.0511984877481, -238.99158191438747, -135.11674009511555, -311.91604995816175, 40.0000000000003, -5.928314944586589, 115.04280495034524, 7.046562717728761, -296.5039250237048, -12.781450243315096, -591.8866945762516, 220.78873338585927, 164.50124601581643, -329.10613657921607, 85.71447210959653, -68.5418074295142, 17.037576572931034, 57.253102430275085, 9.3601284845604, -67.04306916587825, 87.35126662955066, -106.70786021658401, 179.77940902536028, -15.323394297997044, -589.7442687830933, -201.35570987054587, -43.77563067257884, -260.4338271401729, 182.2898318278983, -183.70170327180162, -505.6098087224272, 11.84475332710261, -342.4570461921943, -426.6516788027824, -31.80413915135222, 189.47009245520115, 355.7531481118902, 363.6487850985707, -139.15221197898157, 98.75971691707153, -91.39928180309687, 107.40698858087701, -195.89917329301596, -109.84735406340852, -73.53499736441633, -167.08295140571903, 129.41766453892637, -294.06305748382175, -346.16601009807675, -598.9644463954062, -309.1433974380411, 98.77109963922472, 168.9831560337733, 291.01434123059175, 197.46675288605488, 397.8827629051871, 262.3600084417114, 37.62848539217771, -31.151642795645216, -139.83667159639106, 60.01957364204037, 14.767740444640049, -322.16179049466956, -17.43635846586255, -105.46539651076392, -75.8835178430836, -197.34165721527202, 177.24883581695534, 153.14353110818348, 155.99171710872656, -383.6832742022045, -111.78320348263061, 44.309973799948025, -341.36077635868054, -489.05537158950426, 279.3980651079436, 196.19346822338733, 185.6827546163612, 191.73916260529018, 396.112058639826, -104.25850748678805, -65.92515237441829, -687.4418745833219, 36.719313594018, -299.62101075854395, -82.92294727774625, -236.1249380922377, -158.1649721596023, -213.45009269032383, 127.67580363249061, -611.7812273858285, 167.48288550656338, -222.4520829779386, 16.858396791320274, -578.2958769802984, -25.867700989881595, 217.81243695063316, -374.5770131962856, 61.24997547573646, -725.5006764269084, 317.5090191434664, -154.17266385861063, 56.96322679511338, -207.52724643701842, 18.083401597874317, -96.62208442007255, -88.88020297604842, -454.4439330189119, -233.70484486446654, 53.60010787737709, -493.59315281376047, -375.9298993425908, -283.0434385804242, -69.70414374325576, -384.40015463475146, -341.5019403762717, 98.46042829078675, -700.2238877135626, -215.3473841664938, -247.4278499322025, 140.66461304528232, -246.08232785507647, -451.2551385174997, -302.37787298221014, -51.6014380054819, 222.1245986617986, 311.90969620966314, -118.83152842691166, -683.0087215113668, -377.59809845105883, -365.9553274987982, -137.32884320598865, -467.3463831254204, -398.7385124975814, 279.6727598467446, 94.98689661803877, -114.06975876706804, -799.6747369589153, -62.6799948883664, -850.4827272473005, -444.11751698313805, -368.1577591957496, -115.69532648022893, -200.71311167024953, -154.85789346930036, -601.8883806286608, -144.18211601498595, -590.7880176368132, 328.76113721535074, -532.2118566707317, 40.305833681025355, 252.424140300935, -555.9428138930897, -367.06047365484255, -231.12878311953287, -901.6910706468126, -335.09435087875977, 300.1253387649006, 182.74363880854244, -5.804105131646793, -282.15896547520737, -296.2252749949149, -290.9839408301712, -350.30758365968296, -438.30388262876517, -517.6244668424557, -233.17021450628303, 5.293742795790365, -187.91025637791313, -176.72645945298697, -31.934491263847583, -761.8978569691193, 76.09082869203672, -905.360134504755, -30.23086776213176, -233.40863927042633, 132.6564314306599, 44.172111903235404, -280.29478282224403, -547.8487530940575, -27.76038740209462, -130.49479362478823, -52.72328402698819, -734.0054479585804, -317.22784766304954, -687.2031943991908, -144.39269118749218, 39.76408770414724, -13.214707190862264, -479.6379557304605, -157.29289286024675, -478.88924145217396, -55.38092892384477, -266.1686545631105, -625.4548011621507, -11.795005475775028, -171.9867604362092, -207.2444331489648, 60.58531954576698, -309.1060969953529, -412.29763511642966, -715.0339752675818, -276.3567726119089, -364.5781948525496, -513.460132679269, -415.1965687201585, -622.1260780286309, -709.1297189717897, -148.58245362791624, -343.20550476517934, -267.9999097331119, -22.492571817341204, -185.02996132493664, -447.8619648383699, -321.41278428447407, -182.52710885624106, -410.68888436490107, -327.7231024878818, -466.7864253672616, 25.56152790266413, -418.6880819685868, -601.7142889067908, 101.46586677302112, -223.4924203425394, -138.09544568385968, 40.0000000000003, -283.12959221265317, -433.4320920323409, -16.33681315693336, -80.08226582183329, -503.3456091124227, -518.5364404478676, -408.09502686122846, -530.2902047580365, -305.231983732917, -40.72120328709784, 38.752116150019134, -507.5773782396398, -711.3194129412008, -190.70873319011523, -1080.9089803551608, -801.206974064565, -124.26725588389036, -84.69139866859578, -396.70966513568084, 35.61691799278967, -745.5364503606203, 40.0000000000003, -342.7370201582481, -760.4844145186385, -191.0944591504808, -679.4478908857801, -223.61850796537155, -179.95485940919517, -360.68320344534277, -836.2571424326857, -653.0417922301514, -310.6951646664473, -57.92203196106283, -848.5525328432411, -160.0227323324775, 142.54667450368197, -762.0893175561587, -492.85656965836887, 26.1412698454788], "policy_predator_policy_reward": [150.27479952948175, 275.0404227452082, 284.5932538533706, 193.56775626754688, 147.19409489915896, 429.88217475645905, 143.2101581944964, 317.8124320581865, 24.767606127544834, 22.791492656117605, 161.2944738346816, 370.3681260488505, 228.72771845770916, 20.23011665139934, 105.38062004672804, 156.72655096766562, 23.432762309751556, 115.16275784535854, 19.85207983751744, 338.47786813287837, 94.76145397367513, 302.8547815485967, 381.9225025347649, 23.89774729317387, 367.56101064696196, 28.482377565202857, 87.45530680128401, 180.2982724130677, 68.61775723116592, 334.95873315847314, 333.454323344748, 163.77885079546505, 89.19877743714295, 321.4933578708003, 142.2244776132641, 52.98915131730364, 184.50261259983034, 91.59988864059981, 243.66342766168927, 280.55558061352826, 111.27222977880982, 437.74696232613985, 40.533925419484014, 599.7705117663926, 88.78620305842462, 241.18526693432, 123.10591636454161, 277.71653543443927, 64.42848254001188, 302.84578506874914, 0.0, 71.78161434621903, 73.9435939092225, 7.956998202575184, 289.24689374267, 324.509578050534, 142.66088943847566, 70.99372648334614, 114.73075691038876, 7.6504231140988965, 104.3397367711328, 172.5748892953746, 169.77082805896305, 0.7481696420975238, 204.3567093138684, 82.32563250808208, 130.3009449405291, 229.56618319453355, 254.1274785000661, 465.44933926059633, 10.235751098188334, 262.2674055250137, 121.81455954316716, 102.14156340253169, 241.7578414380469, 96.65161005532366, 185.58687520064214, 117.13527416779102, 87.77245764371773, 259.72393578295674, 66.16303074480254, 109.05475059357875, 223.6671405564705, 176.61864577944795, 184.70175065150596, 87.65056758526205, 162.58484694787145, 147.0142250663153, 95.53641258449116, 379.1184055778657, 201.70253572362083, 18.733145077270542, 201.84853359434513, 80.70674829650906, 156.3435127508321, 55.27927709543404, 192.51690420245347, 84.23187158389104, 84.12248447043221, 487.07310370612237, 179.6910339437158, 43.59112697419268, 199.55330683567456, 456.9467524436947, 49.66116167981352, 1.9154165606434013, 129.3172374564596, 29.72853093928458, 320.2818944186999, 477.29752981637, 368.2676745071862, 9.85223014099052, 158.95816663309301, 224.88437740583544, 418.5949002393469, 235.23910062921422, 29.618837743236842, 424.1507807115103, 133.42517899173967, 322.0533109984909, 210.2987138692873, 403.2110331697264, 484.0806267812594, 517.2131336925702, 21.225444477190067, 351.1790382212995, 29.333089151989682, 42.58676858920764, 60.063238696596585, 35.532661390457164, 288.97926463850627, 55.301630383509554, 310.2751092287938, 71.16237171224788, 38.87402545280612, 373.25831248992904, 298.3148330181742, 24.33706141195664, 359.5089803235676, 136.83708831266588, 265.6876735687069, 2.048105301995894, 295.3717196390339, 363.8617809941877, 437.4221210519755, 71.02544065409244, 193.60345244870476, 518.7200950322637, 50.33101568149968, 358.4044914603569, 341.86087550829507, 338.11411376341823, 542.8745966714127, 553.8587030695626, 145.68692998765948, 187.6624557215859, 92.96544941526699, 33.30996869869279, 125.52303579363709, 60.55813770759195, 267.21998278233104, 571.9093049326273, 516.239981915941, 264.6247933087698, 0.0, 12.350703078889206, 0.0, 239.59944020103725, 614.3705213322996, 67.52874863050282, 173.98720970487219, 253.09422472684057, 701.4082379437133, 183.5314827376426, 244.31533297194306, 148.88629453803344, 205.86609800465774, 108.98143592592997, 214.52784329966423, 177.8756441463548, 409.22916847163407, 48.564609704132025, 101.78971670336901, 375.19989074989826, 427.92644192371426, 445.66111683985037, 124.6833651638189, 510.324265559108, 152.20336089036164, 105.79706851891204, 760.279228067023, 189.37138232248518, 296.68584188968316, 104.18258851265385, 482.0184958805504, 129.69777770653087, 2.1055829253549825, 5.328181698695691, 366.8006041423196, 83.9721583353224, 206.1465622516874, 102.26540022053733, 429.1991732930162, 300.8583379500981, 135.9528407216206, 57.65006247754645, 352.04779725923146, 4.564683376218243, 708.7907521889854, 619.1747540141155, 320.02706316740085, 126.10333657532391, 118.49691402132117, 120.52000577146615, 100.70319429514493, 36.64851029117548, 97.50899810286529, 128.97151460782126, 169.2714757764565, 143.68135392450446, 253.6563074391074, 580.3969630562136, 199.685457256187, 188.53575910620773, 3.004391691752247, 103.12297190564637, 494.09202742841575, 123.6909154498686, 0.0, 118.05746277692059, 600.8739857941213, 427.29374149588546, 227.33476400278533, 406.1443358692065, 299.05819925553084, 122.43591092162993, 8.943148154646018, 13.961727405341247, 86.20854194945838, 185.00312956460485, 296.69012142887993, 509.1518174936957, 418.6110383094829, 375.3923264747074, 22.335404932126757, 1.981793722446288, 403.676882252377, 164.56705502369226, 293.44588795485856, 538.1266122674826, 738.6460817332073, 165.01139773995774, 412.17310868752895, 206.65839464180058, 455.92622132287624, 0.789853573931198, 6.009079495784854, 570.606627733667, 69.42804800049728, 850.5702302725535, 134.45743547495698, 214.12869233758389, 294.1881668894387, 36.58953739581823, 208.82023352915502, 217.4163223642249, 112.31421975984448, 455.37271627976446, 424.05354141498816, 402.6973199552631, 534.9174713699433, 126.34648514834734, 444.5910695881184, 306.9488357931309, 630.093765285526, 225.74190280600948, 557.0231019493822, 711.9238877135629, 430.32636037495104, 102.63697296183315, 292.1178209921018, 466.4624847500129, 381.40812483705884, 118.29614116425385, 426.9725609500163, 105.11624334468044, 535.1334123477513, 410.2923132196269, 411.11291748072495, 141.33183722801033, 392.87312997540266, 297.2574580061223, 221.14779504752136, 421.03851249758213, 423.39811266752963, 75.64949323995098, 735.1338463257667, 559.0679012883901, 105.18355137746377, 919.6132356496437, 82.5938987068733, 652.4713101621184, 581.2414686733892, 60.27448114031244, 383.73264477431235, 430.0987988177018, 876.5100389317196, 256.7351575747115, 480.54232423057425, 158.62278856074704, 303.2752985504545, 0.0, 343.94489380626584, 404.83316353912596, 573.3591145179873, 184.9633619138559, 192.75082422096074, 282.5078503654039, 432.4125721145706, 716.2922545462371, 59.25512736032034, 696.8098035352372, 871.4867136358496, 20.321163918126302, 513.8165300463841, 233.95636238152687, 493.95809719625163, 303.1976632490941, 380.31991359342123, 386.0899499148729, 555.5690554615447, 155.13990429218913, 144.67891763865924, 519.4553556945516, 685.7165129367819, 239.66600443015008, 506.9933133659911, 601.4141835961516, 229.31214224593882, 152.73421811663266, 403.5590029895363, 96.30787597913806, 195.03335226428058, 474.69938786135685, 673.0941815284502, 566.0864350937024, 557.6077305563965, 11.97680771319312, 142.4331237769783, 514.9407882924398, 127.72345100642097, 528.5292213860045, 692.3684876913393, 264.43917969265004, 474.1139462642842, 339.5076982273875, 105.03619109291974, 445.95484922573496, 25.026212084795894, 707.5787106535686, 517.0212637037672, 726.9339752675843, 419.3147165032159, 391.17819485255563, 602.8804648557858, 378.55238033546385, 679.4356469437553, 658.2415086231285, 727.6157066222909, 372.85909950887003, 324.0059924815458, 614.2215050918727, 286.92701741446746, 472.8428285176893, 86.60388208722404, 78.43276151869023, 503.70069582979477, 513.8792593534411, 26.588978490402507, 413.64998401426317, 139.96572686699196, 929.089660124555, 350.18187241782067, 301.30755643584257, 320.18484994627084, 0.0, 317.8066621361126, 177.77165544659294, 352.8580950662673, 547.713422562162, 691.8129711475422, 322.8612636745087, 771.490447232633, 604.6642821174132, 488.88273356237255, 355.284460262645, 21.071889082052678, 851.3937382073043, 612.612209277085, 134.30881239335085, 1008.1216008618808, 244.75461695853917, 674.8138692673084, 505.5282538591023, 421.0235214306302, 54.58796607971554, 0.0, 461.6436353202827, 1074.324781163539, 686.2378616485476, 36.839409639562305, 222.73781078607564, 481.13878073513973, 999.0121927403668, 501.3321301403892, 883.2571424326853, 856.3166839433497, 579.8054350168193, 910.62451628393, 12.685341918123749, 727.7273073547627, 252.49103032887774, 279.004889095541, 87.83083825201271, 592.6261870298657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3438971139024474, "mean_inference_ms": 1.6087907938127581, "mean_action_processing_ms": 0.5543048818720167, "mean_env_wait_ms": 0.411961015209551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009385277243221508, "StateBufferConnector_ms": 0.006654823527616613, "ViewRequirementAgentConnector_ms": 0.2183995527379653}, "num_episodes": 13, "episode_return_max": 1665.6779671884888, "episode_return_min": 174.08768603295422, "episode_return_mean": 719.4454070803157, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.230169151623905, "num_env_steps_trained_throughput_per_sec": 33.230169151623905, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 120200.456, "restore_workers_time_ms": 0.015, "training_step_time_ms": 120200.401, "sample_time_ms": 1899.733, "learn_time_ms": 118281.254, "learn_throughput": 33.818, "synch_weights_time_ms": 14.396}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "81797_00000", "date": "2024-08-22_11-03-24", "timestamp": 1724304804, "time_this_iter_s": 120.41871881484985, "time_total_s": 1082.1610741615295, "pid": 4493, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15d630f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1082.1610741615295, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.415789473684214, "ram_util_percent": 81.51169590643275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.650396198831546, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.396039639713911, "policy_loss": -0.02184256951704289, "vf_loss": 7.415392468486875, "vf_explained_var": 0.08875055606704356, "kl": 0.012448714925092233, "entropy": 1.28649488578683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 44745.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.31168799707844, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.653773888002789, "policy_loss": -0.02133624065700017, "vf_loss": 8.672685412894895, "vf_explained_var": 0.13896910963291323, "kl": 0.012123614995008358, "entropy": 1.394733044929059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 44745.5, "diff_num_grad_updates_vs_sampler_policy": 2354.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 1665.6779671884888, "episode_reward_min": 174.08768603295422, "episode_reward_mean": 706.9124446066903, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 39600, "policy_reward_min": {"prey_policy": -1142.4196072028726, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 397.8827629051871, "predator_policy": 1266.8849107648382}, "policy_reward_mean": {"prey_policy": -175.1398973801668, "predator_policy": 316.52238630150396}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.4896647018643, 340.12303909729906, 496.90825785030427, 775.9444095972316, 928.3263244550725, 932.5034414761678, 512.6504912658543, 783.8099900064275, 375.2632614581324, 277.5846129154099, 749.1974982269412, 865.1985513211526, 541.8262397108855, 558.1283572658265, 699.0634041087859, 736.6031030769838, 549.9204632925856, 320.5057716748088, 860.9622890247887, 1077.2776235760261, 506.9294865070705, 607.3884672493913, 931.6712494591202, 546.9501079131704, 799.2167355087145, 961.0840980170636, 1050.6624192316349, 1110.910947843269, 846.6863692411627, 732.3082439210142, 683.3138497177068, 1118.1404864464653, 586.918492484261, 740.7250906991978, 1106.3481084408193, 804.2032468070166, 918.064979909985, 831.6921378448558, 537.8596171307452, 1456.383835411977, 811.1484964939074, 465.369248471998, 1232.942466182261, 1102.964795049871, 855.0026471648532, 1052.1222865363627, 679.1323745844595, 1665.6779671884888, 501.65347702984013, 838.8110846334466, 750.2272990791964, 650.5208608897303, 919.0398028677886, 791.8031623719675, 436.22683807028557, 621.611591907997, 774.6049683784626, 957.5826701029254, 666.0187017131211, 662.7277066376042, 476.77219565834577, 662.1998743796155, 764.0103737283335, 1049.2063140772525, 503.70969090717756, 687.3843319513226, 407.22722421591124, 845.3962299020411, 580.4820399472668, 508.3604246288495, 503.987767079175, 983.556684773873, 375.60190465516644, 578.4640179198325, 539.8040335945689, 174.08768603295422, 760.2052956627383, 623.1690719873809, 614.2124328219974, 563.0964977144127, 366.4575882695748, 503.65327716737085, 606.261403185371, 536.2204554613205, 693.3995768632268, 684.1351894371043, 821.9635085349834, 865.893670372465, 464.1763295683678, 485.12250645045265, 399.0378360021224, 620.43881801046, 514.8998672135579, 384.3942961045406, 935.3443134643285, 705.238889963154, 472.81766449560826, 555.102837772111, 922.9066868462575], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [47.29508943767401, -121.9276494573801, -171.46035192711872, -168.3941994567885, -84.6935511893032, -408.8821747564593, -13.21015819449752, 47.18041090147727, -37.85316705544204, -185.57573559058335, 37.535033647341926, -418.43152383671077, 208.6287727698366, -146.21886873128835, -70.60621103825198, -142.0644130313912, 88.06452256995486, 150.63287778951306, 131.80565792203038, -106.14625474607013, 53.8679283776205, -357.75051304492655, 25.970944170329307, 364.50538407216317, -329.26491511728847, 298.31780864597357, -39.37985821142435, -230.9721447917285, 65.47475080453954, 139.25043785959622, 0.43079967117882256, -68.51914590446404, -44.898777437143394, -370.07491356538344, -54.43725855976439, -6.394959827914074, -151.60261259983017, 39.007779477962416, 10.194522623121456, 39.29459950013032, 49.97593694364861, -500.806681806958, 11.327273777453817, -408.15689674684705, -55.18620305842467, -174.18115641676016, -57.344076879150535, -128.0165354344377, -75.66527243860521, -296.4903322576935, 194.55101828104347, 362.7714861835752, -37.04359390922265, 77.49198351638091, -291.5024960455287, 261.5299006930145, -109.46088943847727, -34.993726483346116, -299.5187149347649, 387.0966074878685, -68.93973677113482, -79.1450603603744, -1.5074749104702057, 39.15183035790276, 0.47634831350749607, 29.397104343020523, -48.58588182736993, -29.366183194534074, -338.3174557039075, -216.7688047551931, 113.05736713523099, -192.7680473702317, 299.1214143739197, -200.68736711993537, -57.877083917154266, -120.2146345410698, 320.0901823088099, 64.47189391917536, 42.47601730481387, -317.090508765177, 28.736969255197728, 301.076069954585, -240.36950396115859, -1.4968000483499102, -298.23159023350894, -49.850567585263136, -59.33485780625372, 36.68577493368458, -50.33641258449199, -428.56262304467106, 8.456239568826692, 184.0520515441971, -28.99158883510142, -224.6431778067246, 262.7542891110038, 30.821640499044193, -644.5282602115186, 220.51723029350927, 191.17751552956742, 376.06585640709056, -159.94590835225185, -15.405225793856825, -160.3132041115322, -290.7030350189355, 203.8534779065476, 37.88458343935687, -370.24014663543954, 7.871469060715558, -126.39935533799868, 99.73130753129169, -167.78581724074334, 320.0477698590091, -54.26637888552724, -36.73382246830603, -310.14785073176836, -211.13910062921482, -123.7599418430305, -144.01174401751507, -101.79741782911384, -16.828896842155736, -194.51004189679074, -200.5353996477464, -105.06889120667348, -390.39647092254165, 53.69858719242932, -145.27502718060182, 276.0669108480104, -4.386768589207302, 262.8718885297776, 53.11229835952851, -389.5170819553037, 221.85209390068655, -138.34402441639185, 319.51503110049384, 272.56399918628347, 0.2651210339784902, -611.8860629109723, 334.9068394406195, 323.8323354543693, -128.4635607310206, -154.96877832572173, 273.8726347275052, -212.75699752910438, -221.94745646510052, -201.9044337223189, -82.04605126152057, 79.22365546330425, -79.97147388358528, -13.7310156814992, -363.25136599260594, 120.4285836001134, -414.94896754522887, -344.0524187745479, -352.819514804963, -247.68905175801567, 316.29715673181227, 36.259587042459806, -15.19272207220591, 101.96809358124574, 178.78932382637385, -387.0511984877481, -238.99158191438747, -135.11674009511555, -311.91604995816175, 40.0000000000003, -5.928314944586589, 115.04280495034524, 7.046562717728761, -296.5039250237048, -12.781450243315096, -591.8866945762516, 220.78873338585927, 164.50124601581643, -329.10613657921607, 85.71447210959653, -68.5418074295142, 17.037576572931034, 57.253102430275085, 9.3601284845604, -67.04306916587825, 87.35126662955066, -106.70786021658401, 179.77940902536028, -15.323394297997044, -589.7442687830933, -201.35570987054587, -43.77563067257884, -260.4338271401729, 182.2898318278983, -183.70170327180162, -505.6098087224272, 11.84475332710261, -342.4570461921943, -426.6516788027824, -31.80413915135222, 189.47009245520115, 355.7531481118902, 363.6487850985707, -139.15221197898157, 98.75971691707153, -91.39928180309687, 107.40698858087701, -195.89917329301596, -109.84735406340852, -73.53499736441633, -167.08295140571903, 129.41766453892637, -294.06305748382175, -346.16601009807675, -598.9644463954062, -309.1433974380411, 98.77109963922472, 168.9831560337733, 291.01434123059175, 197.46675288605488, 397.8827629051871, 262.3600084417114, 37.62848539217771, -31.151642795645216, -139.83667159639106, 60.01957364204037, 14.767740444640049, -322.16179049466956, -17.43635846586255, -105.46539651076392, -75.8835178430836, -197.34165721527202, 177.24883581695534, 153.14353110818348, 155.99171710872656, -383.6832742022045, -111.78320348263061, 44.309973799948025, -341.36077635868054, -489.05537158950426, 279.3980651079436, 196.19346822338733, 185.6827546163612, 191.73916260529018, 396.112058639826, -104.25850748678805, -65.92515237441829, -687.4418745833219, 36.719313594018, -299.62101075854395, -82.92294727774625, -236.1249380922377, -158.1649721596023, -213.45009269032383, 127.67580363249061, -611.7812273858285, 167.48288550656338, -222.4520829779386, 16.858396791320274, -578.2958769802984, -25.867700989881595, 217.81243695063316, -374.5770131962856, 61.24997547573646, -725.5006764269084, 317.5090191434664, -154.17266385861063, 56.96322679511338, -207.52724643701842, 18.083401597874317, -96.62208442007255, -88.88020297604842, -454.4439330189119, -233.70484486446654, 53.60010787737709, -493.59315281376047, -375.9298993425908, -283.0434385804242, -69.70414374325576, -384.40015463475146, -341.5019403762717, 98.46042829078675, -700.2238877135626, -215.3473841664938, -247.4278499322025, 140.66461304528232, -246.08232785507647, -451.2551385174997, -302.37787298221014, -51.6014380054819, 222.1245986617986, 311.90969620966314, -118.83152842691166, -683.0087215113668, -377.59809845105883, -365.9553274987982, -137.32884320598865, -467.3463831254204, -398.7385124975814, 279.6727598467446, 94.98689661803877, -114.06975876706804, -799.6747369589153, -62.6799948883664, -850.4827272473005, -444.11751698313805, -368.1577591957496, -115.69532648022893, -200.71311167024953, -154.85789346930036, -601.8883806286608, -144.18211601498595, -590.7880176368132, 328.76113721535074, -532.2118566707317, 40.305833681025355, 252.424140300935, -555.9428138930897, -367.06047365484255, -231.12878311953287, -901.6910706468126, -335.09435087875977, 300.1253387649006, 182.74363880854244, -5.804105131646793, -282.15896547520737, -296.2252749949149, -290.9839408301712, -350.30758365968296, -438.30388262876517, -517.6244668424557, -233.17021450628303, 5.293742795790365, -187.91025637791313, -176.72645945298697, -31.934491263847583, -761.8978569691193, 76.09082869203672, -905.360134504755, -30.23086776213176, -233.40863927042633, 132.6564314306599, 44.172111903235404, -280.29478282224403, -547.8487530940575, -27.76038740209462, -130.49479362478823, -52.72328402698819, -734.0054479585804, -317.22784766304954, -687.2031943991908, -144.39269118749218, 39.76408770414724, -13.214707190862264, -479.6379557304605, -157.29289286024675, -478.88924145217396, -55.38092892384477, -266.1686545631105, -625.4548011621507, -11.795005475775028, -171.9867604362092, -207.2444331489648, 60.58531954576698, -309.1060969953529, -412.29763511642966, -715.0339752675818, -276.3567726119089, -364.5781948525496, -513.460132679269, -415.1965687201585, -622.1260780286309, -709.1297189717897, -148.58245362791624, -343.20550476517934, -267.9999097331119, -22.492571817341204, -185.02996132493664, -447.8619648383699, -321.41278428447407, -182.52710885624106, -410.68888436490107, -327.7231024878818, -466.7864253672616, 25.56152790266413, -418.6880819685868, -601.7142889067908, 101.46586677302112, -223.4924203425394, -138.09544568385968, 40.0000000000003, -283.12959221265317, -433.4320920323409, -16.33681315693336, -80.08226582183329, -503.3456091124227, -518.5364404478676, -408.09502686122846, -530.2902047580365, -305.231983732917, -40.72120328709784, 38.752116150019134, -507.5773782396398, -711.3194129412008, -190.70873319011523, -1080.9089803551608, -801.206974064565, -124.26725588389036, -84.69139866859578, -396.70966513568084, 35.61691799278967, -745.5364503606203, 40.0000000000003, -342.7370201582481, -760.4844145186385, -191.0944591504808, -679.4478908857801, -223.61850796537155, -179.95485940919517, -360.68320344534277, -836.2571424326857, -653.0417922301514, -310.6951646664473, -57.92203196106283, -848.5525328432411, -160.0227323324775, 142.54667450368197, -762.0893175561587, -492.85656965836887, 26.1412698454788, -484.8927096421052, -108.37580612047742, -94.30821311786723, -7.95090719174585, -352.8874196382234, 45.416113457999984, -179.44096374875872, -672.8720871277047, -934.8951462959113, -603.384587109251, -623.2884749851609, 289.74351624536854, -939.0276580828846, -835.8475966190048, 301.17459545489214, -382.435162676707, -583.9328765962464, -363.4142877426994, 84.95370322019768, 39.76248198797994, -865.7861809353735, 23.79399248661072, -891.1328051393436, -484.144504228256, -345.3081290662744, 233.55047193485095, -599.3756800113248, -581.7843354348378, -255.97523431207404, -215.059099487978, -177.78923779721717, -125.00794745737109, -531.8149247564919, -187.90413448580685, -194.01867877489968, -429.5314283618684, -662.2320320152207, -742.4539305899762, -177.1353010390986, -180.2192773402805, -130.96991557589428, -180.96847139673764, 61.51830400905894, -1002.7905577771007, -1132.0672492763063, -1037.5182577460675, -1142.4196072028726, 19.93968728960218, 340.818523004311, -789.1923734712332, -395.5333368216985, -675.0779321684274, -287.21788265945787, -54.94141332255902, -0.8051882752561674, -356.9414439628487, -995.235120633389, -93.41740902536378, -485.0039373235924, -590.5964385629026, -815.6039955300334, -353.9394220463116, -350.4163485676769, -45.63480186241571, -174.29336929543567, -782.4351480548214, -147.34360539791396, -429.09288888674183, -37.07432867384709, -45.995535062319576], "policy_predator_policy_reward": [150.27479952948175, 275.0404227452082, 284.5932538533706, 193.56775626754688, 147.19409489915896, 429.88217475645905, 143.2101581944964, 317.8124320581865, 24.767606127544834, 22.791492656117605, 161.2944738346816, 370.3681260488505, 228.72771845770916, 20.23011665139934, 105.38062004672804, 156.72655096766562, 23.432762309751556, 115.16275784535854, 19.85207983751744, 338.47786813287837, 94.76145397367513, 302.8547815485967, 381.9225025347649, 23.89774729317387, 367.56101064696196, 28.482377565202857, 87.45530680128401, 180.2982724130677, 68.61775723116592, 334.95873315847314, 333.454323344748, 163.77885079546505, 89.19877743714295, 321.4933578708003, 142.2244776132641, 52.98915131730364, 184.50261259983034, 91.59988864059981, 243.66342766168927, 280.55558061352826, 111.27222977880982, 437.74696232613985, 40.533925419484014, 599.7705117663926, 88.78620305842462, 241.18526693432, 123.10591636454161, 277.71653543443927, 64.42848254001188, 302.84578506874914, 0.0, 71.78161434621903, 73.9435939092225, 7.956998202575184, 289.24689374267, 324.509578050534, 142.66088943847566, 70.99372648334614, 114.73075691038876, 7.6504231140988965, 104.3397367711328, 172.5748892953746, 169.77082805896305, 0.7481696420975238, 204.3567093138684, 82.32563250808208, 130.3009449405291, 229.56618319453355, 254.1274785000661, 465.44933926059633, 10.235751098188334, 262.2674055250137, 121.81455954316716, 102.14156340253169, 241.7578414380469, 96.65161005532366, 185.58687520064214, 117.13527416779102, 87.77245764371773, 259.72393578295674, 66.16303074480254, 109.05475059357875, 223.6671405564705, 176.61864577944795, 184.70175065150596, 87.65056758526205, 162.58484694787145, 147.0142250663153, 95.53641258449116, 379.1184055778657, 201.70253572362083, 18.733145077270542, 201.84853359434513, 80.70674829650906, 156.3435127508321, 55.27927709543404, 192.51690420245347, 84.23187158389104, 84.12248447043221, 487.07310370612237, 179.6910339437158, 43.59112697419268, 199.55330683567456, 456.9467524436947, 49.66116167981352, 1.9154165606434013, 129.3172374564596, 29.72853093928458, 320.2818944186999, 477.29752981637, 368.2676745071862, 9.85223014099052, 158.95816663309301, 224.88437740583544, 418.5949002393469, 235.23910062921422, 29.618837743236842, 424.1507807115103, 133.42517899173967, 322.0533109984909, 210.2987138692873, 403.2110331697264, 484.0806267812594, 517.2131336925702, 21.225444477190067, 351.1790382212995, 29.333089151989682, 42.58676858920764, 60.063238696596585, 35.532661390457164, 288.97926463850627, 55.301630383509554, 310.2751092287938, 71.16237171224788, 38.87402545280612, 373.25831248992904, 298.3148330181742, 24.33706141195664, 359.5089803235676, 136.83708831266588, 265.6876735687069, 2.048105301995894, 295.3717196390339, 363.8617809941877, 437.4221210519755, 71.02544065409244, 193.60345244870476, 518.7200950322637, 50.33101568149968, 358.4044914603569, 341.86087550829507, 338.11411376341823, 542.8745966714127, 553.8587030695626, 145.68692998765948, 187.6624557215859, 92.96544941526699, 33.30996869869279, 125.52303579363709, 60.55813770759195, 267.21998278233104, 571.9093049326273, 516.239981915941, 264.6247933087698, 0.0, 12.350703078889206, 0.0, 239.59944020103725, 614.3705213322996, 67.52874863050282, 173.98720970487219, 253.09422472684057, 701.4082379437133, 183.5314827376426, 244.31533297194306, 148.88629453803344, 205.86609800465774, 108.98143592592997, 214.52784329966423, 177.8756441463548, 409.22916847163407, 48.564609704132025, 101.78971670336901, 375.19989074989826, 427.92644192371426, 445.66111683985037, 124.6833651638189, 510.324265559108, 152.20336089036164, 105.79706851891204, 760.279228067023, 189.37138232248518, 296.68584188968316, 104.18258851265385, 482.0184958805504, 129.69777770653087, 2.1055829253549825, 5.328181698695691, 366.8006041423196, 83.9721583353224, 206.1465622516874, 102.26540022053733, 429.1991732930162, 300.8583379500981, 135.9528407216206, 57.65006247754645, 352.04779725923146, 4.564683376218243, 708.7907521889854, 619.1747540141155, 320.02706316740085, 126.10333657532391, 118.49691402132117, 120.52000577146615, 100.70319429514493, 36.64851029117548, 97.50899810286529, 128.97151460782126, 169.2714757764565, 143.68135392450446, 253.6563074391074, 580.3969630562136, 199.685457256187, 188.53575910620773, 3.004391691752247, 103.12297190564637, 494.09202742841575, 123.6909154498686, 0.0, 118.05746277692059, 600.8739857941213, 427.29374149588546, 227.33476400278533, 406.1443358692065, 299.05819925553084, 122.43591092162993, 8.943148154646018, 13.961727405341247, 86.20854194945838, 185.00312956460485, 296.69012142887993, 509.1518174936957, 418.6110383094829, 375.3923264747074, 22.335404932126757, 1.981793722446288, 403.676882252377, 164.56705502369226, 293.44588795485856, 538.1266122674826, 738.6460817332073, 165.01139773995774, 412.17310868752895, 206.65839464180058, 455.92622132287624, 0.789853573931198, 6.009079495784854, 570.606627733667, 69.42804800049728, 850.5702302725535, 134.45743547495698, 214.12869233758389, 294.1881668894387, 36.58953739581823, 208.82023352915502, 217.4163223642249, 112.31421975984448, 455.37271627976446, 424.05354141498816, 402.6973199552631, 534.9174713699433, 126.34648514834734, 444.5910695881184, 306.9488357931309, 630.093765285526, 225.74190280600948, 557.0231019493822, 711.9238877135629, 430.32636037495104, 102.63697296183315, 292.1178209921018, 466.4624847500129, 381.40812483705884, 118.29614116425385, 426.9725609500163, 105.11624334468044, 535.1334123477513, 410.2923132196269, 411.11291748072495, 141.33183722801033, 392.87312997540266, 297.2574580061223, 221.14779504752136, 421.03851249758213, 423.39811266752963, 75.64949323995098, 735.1338463257667, 559.0679012883901, 105.18355137746377, 919.6132356496437, 82.5938987068733, 652.4713101621184, 581.2414686733892, 60.27448114031244, 383.73264477431235, 430.0987988177018, 876.5100389317196, 256.7351575747115, 480.54232423057425, 158.62278856074704, 303.2752985504545, 0.0, 343.94489380626584, 404.83316353912596, 573.3591145179873, 184.9633619138559, 192.75082422096074, 282.5078503654039, 432.4125721145706, 716.2922545462371, 59.25512736032034, 696.8098035352372, 871.4867136358496, 20.321163918126302, 513.8165300463841, 233.95636238152687, 493.95809719625163, 303.1976632490941, 380.31991359342123, 386.0899499148729, 555.5690554615447, 155.13990429218913, 144.67891763865924, 519.4553556945516, 685.7165129367819, 239.66600443015008, 506.9933133659911, 601.4141835961516, 229.31214224593882, 152.73421811663266, 403.5590029895363, 96.30787597913806, 195.03335226428058, 474.69938786135685, 673.0941815284502, 566.0864350937024, 557.6077305563965, 11.97680771319312, 142.4331237769783, 514.9407882924398, 127.72345100642097, 528.5292213860045, 692.3684876913393, 264.43917969265004, 474.1139462642842, 339.5076982273875, 105.03619109291974, 445.95484922573496, 25.026212084795894, 707.5787106535686, 517.0212637037672, 726.9339752675843, 419.3147165032159, 391.17819485255563, 602.8804648557858, 378.55238033546385, 679.4356469437553, 658.2415086231285, 727.6157066222909, 372.85909950887003, 324.0059924815458, 614.2215050918727, 286.92701741446746, 472.8428285176893, 86.60388208722404, 78.43276151869023, 503.70069582979477, 513.8792593534411, 26.588978490402507, 413.64998401426317, 139.96572686699196, 929.089660124555, 350.18187241782067, 301.30755643584257, 320.18484994627084, 0.0, 317.8066621361126, 177.77165544659294, 352.8580950662673, 547.713422562162, 691.8129711475422, 322.8612636745087, 771.490447232633, 604.6642821174132, 488.88273356237255, 355.284460262645, 21.071889082052678, 851.3937382073043, 612.612209277085, 134.30881239335085, 1008.1216008618808, 244.75461695853917, 674.8138692673084, 505.5282538591023, 421.0235214306302, 54.58796607971554, 0.0, 461.6436353202827, 1074.324781163539, 686.2378616485476, 36.839409639562305, 222.73781078607564, 481.13878073513973, 999.0121927403668, 501.3321301403892, 883.2571424326853, 856.3166839433497, 579.8054350168193, 910.62451628393, 12.685341918123749, 727.7273073547627, 252.49103032887774, 279.004889095541, 87.83083825201271, 592.6261870298657, 644.0379731579509, 4.194534532388569, 508.8659753406526, 437.92781504461846, 137.5239470719039, 145.1035000113007, 1266.8849107648382, 99.89125160667795, 951.0951462959116, 704.1653706798775, 389.24147182839323, 32.562108371098006, 943.4276580828852, 846.2475966190071, 461.6604534578718, 276.9267142007689, 268.1515653339651, 794.9123096898261, 4.56417018376227, 324.6877119675138, 821.8883154641591, 278.92361418968164, 301.542278580338, 774.0577782925427, 871.2881468063658, 2.1747431156456662, 892.93494551977, 39.538946846835884, 758.0621310914617, 124.97094673977489, 333.579828512981, 14.17207966330108, 796.4557539690749, 317.39363075231125, 375.3724483845691, 713.0704508547618, 1004.3000861448503, 661.2140171243403, 69.82493288447924, 258.0623495515638, 159.93458657740103, 960.7298650441719, 50.35227173364208, 672.3303237573859, 926.3251390089217, 948.6337367252048, 499.48156550088055, 440.99600835152484, 808.1885459884487, 846.4164850245138, 421.8333368217043, 787.8940479246626, 42.319026308420064, 618.0637810567893, 248.7044510989745, 1041.0635474902356, 377.1721976194033, 413.2049308465072, 671.3567742832308, 491.2145637643258, 849.6283242770666, 713.1756753131809, 342.8835475858219, 113.07192318646152, 276.231304711454, 864.4455408509394, 492.756482513974, 308.72503419533535, 27.94362471377591, 670.9775106478758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3447043528040779, "mean_inference_ms": 1.6126588964141866, "mean_action_processing_ms": 0.5533321284451806, "mean_env_wait_ms": 0.41288289762614894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00996974983600655, "StateBufferConnector_ms": 0.007018778059217665, "ViewRequirementAgentConnector_ms": 0.22669103410508898}, "num_episodes": 14, "episode_return_max": 1665.6779671884888, "episode_return_min": 174.08768603295422, "episode_return_mean": 706.9124446066903, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.52139445335418, "num_env_steps_trained_throughput_per_sec": 33.52139445335418, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 120113.089, "restore_workers_time_ms": 0.015, "training_step_time_ms": 120113.035, "sample_time_ms": 1892.861, "learn_time_ms": 118201.157, "learn_throughput": 33.841, "synch_weights_time_ms": 14.174}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 10, "trial_id": "81797_00000", "date": "2024-08-22_11-05-24", "timestamp": 1724304924, "time_this_iter_s": 119.37998628616333, "time_total_s": 1201.5410604476929, "pid": 4493, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1690604c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1201.5410604476929, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 21.261764705882353, "ram_util_percent": 81.2535294117647}}
