{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8550550197406361, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.448812102278073, "policy_loss": -0.016965375275564534, "vf_loss": 5.464205256104469, "vf_explained_var": 0.01010909341275692, "kl": 0.007861245618065974, "entropy": 1.6042299506564934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.191207569402953, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.274349245925745, "policy_loss": -0.02161983774615995, "vf_loss": 7.294076514740785, "vf_explained_var": 0.03213894460350275, "kl": 0.009462888678050755, "entropy": 1.6029283051689467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.6173333081294, "num_env_steps_trained_throughput_per_sec": 130.6173333081294, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 30623.814, "restore_workers_time_ms": 0.024, "training_step_time_ms": 30623.754, "sample_time_ms": 5155.337, "learn_time_ms": 25451.608, "learn_throughput": 157.161, "synch_weights_time_ms": 13.403}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 1, "trial_id": "cbf82_00000", "date": "2024-08-21_13-07-31", "timestamp": 1724225851, "time_this_iter_s": 30.681617975234985, "time_total_s": 30.681617975234985, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3074f3ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.681617975234985, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.70888888888888, "ram_util_percent": 83.44888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2257111519264678, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.392589833835761, "policy_loss": -0.017180321857934663, "vf_loss": 3.4078121644755206, "vf_explained_var": 0.053557954852779706, "kl": 0.009789982665339873, "entropy": 1.5961191979547342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.131442804137866, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.670573935906092, "policy_loss": -0.02810939397556164, "vf_loss": 6.696066297590733, "vf_explained_var": 0.09655571406086286, "kl": 0.013085288766402907, "entropy": 1.591802396128575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.99825747493207, "num_env_steps_trained_throughput_per_sec": 146.99825747493207, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 28917.551, "restore_workers_time_ms": 0.079, "training_step_time_ms": 28917.35, "sample_time_ms": 3989.626, "learn_time_ms": 24901.734, "learn_throughput": 160.631, "synch_weights_time_ms": 21.625}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 2, "trial_id": "cbf82_00000", "date": "2024-08-21_13-08-01", "timestamp": 1724225881, "time_this_iter_s": 27.258450984954834, "time_total_s": 57.94006896018982, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3074f3ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.94006896018982, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.481395348837204, "ram_util_percent": 83.34418604651164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1726320065868399, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.164773882428805, "policy_loss": -0.025367604507967673, "vf_loss": 2.1881762662281594, "vf_explained_var": 0.09085447192192078, "kl": 0.009826098026678665, "entropy": 1.5922768858571847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.117398017831147, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.338682920734088, "policy_loss": -0.029950691714232865, "vf_loss": 6.365158822635809, "vf_explained_var": 0.22742326265821855, "kl": 0.017373921240505297, "entropy": 1.5750327410797278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.40008248867932, "num_env_steps_trained_throughput_per_sec": 144.40008248867932, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 28511.992, "restore_workers_time_ms": 0.063, "training_step_time_ms": 28511.707, "sample_time_ms": 3427.438, "learn_time_ms": 25053.591, "learn_throughput": 159.658, "synch_weights_time_ms": 26.147}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 3, "trial_id": "cbf82_00000", "date": "2024-08-21_13-08-29", "timestamp": 1724225909, "time_this_iter_s": 27.777153253555298, "time_total_s": 85.71722221374512, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075741f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.71722221374512, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.545, "ram_util_percent": 83.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9927453065601488, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.9636873779818416, "policy_loss": -0.014792696613100512, "vf_loss": 1.9767813843364517, "vf_explained_var": 0.05858270153403282, "kl": 0.00849346348313702, "entropy": 1.5831736085315546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.259737178124487, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.000072924792766, "policy_loss": -0.024008496147871483, "vf_loss": 7.021263326704502, "vf_explained_var": 0.31941044225047033, "kl": 0.014090265396225732, "entropy": 1.5697678587088981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 133.21036669633483, "num_env_steps_trained_throughput_per_sec": 133.21036669633483, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 28890.926, "restore_workers_time_ms": 0.054, "training_step_time_ms": 28890.691, "sample_time_ms": 3604.861, "learn_time_ms": 25258.133, "learn_throughput": 158.365, "synch_weights_time_ms": 23.26}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 4, "trial_id": "cbf82_00000", "date": "2024-08-21_13-08-59", "timestamp": 1724225939, "time_this_iter_s": 30.05222511291504, "time_total_s": 115.76944732666016, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177de7c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 115.76944732666016, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.7547619047619, "ram_util_percent": 82.83095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8786201946126917, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.4264371200775108, "policy_loss": -0.02525222419256655, "vf_loss": 1.4491783622186631, "vf_explained_var": 0.10184233859181405, "kl": 0.012554921674503323, "entropy": 1.5726445719599724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.986372032761574, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.77292774717013, "policy_loss": -0.01686872404049306, "vf_loss": 7.787258818745613, "vf_explained_var": 0.2995977744460106, "kl": 0.012688230186176952, "entropy": 1.5587032239884138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.62031472418636, "num_env_steps_trained_throughput_per_sec": 151.62031472418636, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 28389.086, "restore_workers_time_ms": 0.046, "training_step_time_ms": 28388.852, "sample_time_ms": 3288.606, "learn_time_ms": 25073.021, "learn_throughput": 159.534, "synch_weights_time_ms": 23.437}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 5, "trial_id": "cbf82_00000", "date": "2024-08-21_13-09-26", "timestamp": 1724225966, "time_this_iter_s": 26.410375118255615, "time_total_s": 142.17982244491577, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075ab940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 142.17982244491577, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.265789473684215, "ram_util_percent": 82.78684210526318}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.596978102996945, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.3208075078825157, "policy_loss": -0.01373021711721473, "vf_loss": 1.3326234142916897, "vf_explained_var": 0.12741514667868614, "kl": 0.009571536433213623, "entropy": 1.5600993485500416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.107347881048918, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 8.526939555505912, "policy_loss": -0.023281634279313342, "vf_loss": 8.547366938988368, "vf_explained_var": 0.31949900512894, "kl": 0.014271164126936735, "entropy": 1.5536659857879083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 299.79999999999995, "episode_reward_min": 101.30000000000027, "episode_reward_mean": 200.55000000000013, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 800, "policy_reward_min": {"prey_policy": -2.993455606169192, "predator_policy": 27.448034091641453}, "policy_reward_max": {"prey_policy": 272.3519659083587, "predator_policy": 104.29345560616778}, "policy_reward_mean": {"prey_policy": 134.67925515109476, "predator_policy": 65.87074484890462}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.30000000000027, 299.79999999999995], "episode_lengths": [400, 400], "policy_prey_policy_reward": [-2.993455606169192, 272.3519659083587], "policy_predator_policy_reward": [104.29345560616778, 27.448034091641453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.239861631520308, "mean_inference_ms": 4.553477237049922, "mean_action_processing_ms": 1.0307834704091314, "mean_env_wait_ms": 10.936991797525383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038564205169677734, "StateBufferConnector_ms": 0.0021278858184814453, "ViewRequirementAgentConnector_ms": 0.040793418884277344}, "num_episodes": 2, "episode_return_max": 299.79999999999995, "episode_return_min": 101.30000000000027, "episode_return_mean": 200.55000000000013, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.59404007501357, "num_env_steps_trained_throughput_per_sec": 153.59404007501357, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 27998.026, "restore_workers_time_ms": 0.044, "training_step_time_ms": 27997.81, "sample_time_ms": 3036.829, "learn_time_ms": 24934.508, "learn_throughput": 160.42, "synch_weights_time_ms": 22.756}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 6, "trial_id": "cbf82_00000", "date": "2024-08-21_13-09-52", "timestamp": 1724225992, "time_this_iter_s": 26.080772876739502, "time_total_s": 168.26059532165527, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x307574040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 168.26059532165527, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 34.3972972972973, "ram_util_percent": 82.48648648648647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4835023786872625, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.749495370934407, "policy_loss": -0.017460602741387752, "vf_loss": 1.7653574063132207, "vf_explained_var": 0.15814971731354793, "kl": 0.007992822231850974, "entropy": 1.54436426696678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 492.93999999999954}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.012996115659673, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 8.159184715151786, "policy_loss": -0.02193199491909278, "vf_loss": 8.178309595088164, "vf_explained_var": 0.34566278805335365, "kl": 0.014035672019235789, "entropy": 1.5313437470545372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 492.93999999999954}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 369.8, "episode_reward_min": 38.90000000000028, "episode_reward_mean": 213.51428571428565, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 16800, "policy_reward_min": {"prey_policy": -175.78087862385092, "predator_policy": 0.757674130077879}, "policy_reward_max": {"prey_policy": 357.68825654787804, "predator_policy": 238.9808786238497}, "policy_reward_mean": {"prey_policy": 113.75590248551002, "predator_policy": 99.75838322877533}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.30000000000027, 299.79999999999995, 369.8, 287.70000000000005, 161.39999999999998, 265.5999999999999, 151.39999999999998, 221.40000000000012, 235.29999999999995, 167.30000000000004, 115.30000000000001, 339.4, 259.29999999999995, 240.4000000000001, 63.20000000000005, 119.20000000000012, 63.00000000000022, 234.99999999999994, 156.7999999999991, 221.99999999999966, 111.89999999999822, 136.20000000000005, 309.2, 199.7, 81.90000000000009, 202.30000000000004, 236.39999999999995, 38.90000000000028, 220.59999999999997, 291.99999999999966, 183.09999999999997, 336.19999999999993, 331.4, 150.39999999999998, 246.09999999999997, 225.50000000000003, 215.29999999999998, 324.7, 113.70000000000005, 359.3, 256.79999999999995, 321.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.993455606169192, 272.3519659083587, 351.1156569109023, 156.25091063732296, -34.97637311759539, 107.53879954600987, -1.8271166471617415, 143.6391052636105, 222.06596374165156, 101.64156872610326, -34.04754961194723, 289.14064177133605, 185.0667465997314, 92.88642714303677, -175.78087862385092, 79.77260865787765, -40.97611673985611, 57.060692877845526, 143.50610394629928, 150.46812879118366, 111.14232586992033, 38.65042552086718, 254.75209258870933, 93.86955829093293, -71.97904532329528, -16.227691124576637, 119.50097902438982, 27.830271691550283, 194.92691735165562, 200.9760943556355, 71.7077079941977, 245.08909717254775, 286.14323289488334, -12.833977753776274, 142.17391043859772, 60.37888176696898, 65.13018340330416, 284.8144913702052, -15.574191567289802, 357.68825654787804, 112.57609147313107, 165.108462230295], "policy_predator_policy_reward": [104.29345560616778, 27.448034091641453, 18.68434308909765, 131.44908936267706, 196.3763731175945, 158.06120045398976, 153.2271166471618, 77.76089473638973, 13.234036258348363, 65.65843127389677, 149.347549611946, 50.25935822866395, 74.23325340026815, 147.51357285696298, 238.9808786238497, 39.427391342122284, 103.97611673985455, 177.9393071221544, 13.293896053700252, 71.53187120881599, 0.757674130077879, 97.54957447913267, 54.44790741129076, 105.83044170906724, 153.87904532329432, 218.52769112457608, 116.89902097560967, 11.069728308449918, 25.6730826483444, 91.02390564436466, 111.39229200580128, 91.1109028274522, 45.25676710511662, 163.23397775377515, 103.9260895614023, 165.12111823303084, 150.16981659669574, 39.8855086297948, 129.27419156728874, 1.6117434521219673, 144.2239085268686, 156.29153776970503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.335425577689102, "mean_inference_ms": 4.588694074015323, "mean_action_processing_ms": 1.1814142368641531, "mean_env_wait_ms": 10.467778837514363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035135518936883835, "StateBufferConnector_ms": 0.002777008783249628, "ViewRequirementAgentConnector_ms": 0.12826578957693918}, "num_episodes": 40, "episode_return_max": 369.8, "episode_return_min": 38.90000000000028, "episode_return_mean": 213.51428571428565, "episodes_this_iter": 40}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.60831934132702, "num_env_steps_trained_throughput_per_sec": 150.60831934132702, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 27792.469, "restore_workers_time_ms": 0.04, "training_step_time_ms": 27792.207, "sample_time_ms": 2957.403, "learn_time_ms": 24807.43, "learn_throughput": 161.242, "synch_weights_time_ms": 23.552}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 7, "trial_id": "cbf82_00000", "date": "2024-08-21_13-10-18", "timestamp": 1724226018, "time_this_iter_s": 26.618098258972168, "time_total_s": 194.87869358062744, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075ab8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 194.87869358062744, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.02894736842105, "ram_util_percent": 83.33684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1200331658745806, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.7479301797846953, "policy_loss": -0.017165656042925546, "vf_loss": 2.7629721734672783, "vf_explained_var": 0.10280370519806942, "kl": 0.01061827792703601, "entropy": 1.521117048089703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.250192981213331, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.921908803780874, "policy_loss": -0.028103839007477895, "vf_loss": 7.947162210941315, "vf_explained_var": 0.37989100683480503, "kl": 0.014252143980411348, "entropy": 1.5062450849761566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 376.1, "episode_reward_min": 38.90000000000028, "episode_reward_mean": 224.77083333333326, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -175.78087862385092, "predator_policy": 0.757674130077879}, "policy_reward_max": {"prey_policy": 357.68825654787804, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 123.06966763203235, "predator_policy": 101.70116570130078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.30000000000027, 299.79999999999995, 369.8, 287.70000000000005, 161.39999999999998, 265.5999999999999, 151.39999999999998, 221.40000000000012, 235.29999999999995, 167.30000000000004, 115.30000000000001, 339.4, 259.29999999999995, 240.4000000000001, 63.20000000000005, 119.20000000000012, 63.00000000000022, 234.99999999999994, 156.7999999999991, 221.99999999999966, 111.89999999999822, 136.20000000000005, 309.2, 199.7, 81.90000000000009, 202.30000000000004, 236.39999999999995, 38.90000000000028, 220.59999999999997, 291.99999999999966, 183.09999999999997, 336.19999999999993, 331.4, 150.39999999999998, 246.09999999999997, 225.50000000000003, 215.29999999999998, 324.7, 113.70000000000005, 359.3, 256.79999999999995, 321.4, 98.6, 259.6999999999995, 255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.993455606169192, 272.3519659083587, 351.1156569109023, 156.25091063732296, -34.97637311759539, 107.53879954600987, -1.8271166471617415, 143.6391052636105, 222.06596374165156, 101.64156872610326, -34.04754961194723, 289.14064177133605, 185.0667465997314, 92.88642714303677, -175.78087862385092, 79.77260865787765, -40.97611673985611, 57.060692877845526, 143.50610394629928, 150.46812879118366, 111.14232586992033, 38.65042552086718, 254.75209258870933, 93.86955829093293, -71.97904532329528, -16.227691124576637, 119.50097902438982, 27.830271691550283, 194.92691735165562, 200.9760943556355, 71.7077079941977, 245.08909717254775, 286.14323289488334, -12.833977753776274, 142.17391043859772, 60.37888176696898, 65.13018340330416, 284.8144913702052, -15.574191567289802, 357.68825654787804, 112.57609147313107, 165.108462230295, -169.93120290007582, 144.88923235415083, 96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317], "policy_predator_policy_reward": [104.29345560616778, 27.448034091641453, 18.68434308909765, 131.44908936267706, 196.3763731175945, 158.06120045398976, 153.2271166471618, 77.76089473638973, 13.234036258348363, 65.65843127389677, 149.347549611946, 50.25935822866395, 74.23325340026815, 147.51357285696298, 238.9808786238497, 39.427391342122284, 103.97611673985455, 177.9393071221544, 13.293896053700252, 71.53187120881599, 0.757674130077879, 97.54957447913267, 54.44790741129076, 105.83044170906724, 153.87904532329432, 218.52769112457608, 116.89902097560967, 11.069728308449918, 25.6730826483444, 91.02390564436466, 111.39229200580128, 91.1109028274522, 45.25676710511662, 163.23397775377515, 103.9260895614023, 165.12111823303084, 150.16981659669574, 39.8855086297948, 129.27419156728874, 1.6117434521219673, 144.2239085268686, 156.29153776970503, 268.5312029000748, 114.81076764584904, 158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.212114619652324, "mean_inference_ms": 4.543888967755667, "mean_action_processing_ms": 1.1605274203458076, "mean_env_wait_ms": 10.461067015660673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003262692027621799, "StateBufferConnector_ms": 0.015248523818122016, "ViewRequirementAgentConnector_ms": 0.12689166598849827}, "num_episodes": 30, "episode_return_max": 376.1, "episode_return_min": 38.90000000000028, "episode_return_mean": 224.77083333333326, "episodes_this_iter": 30}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.4745063223266, "num_env_steps_trained_throughput_per_sec": 147.4745063223266, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 27708.83, "restore_workers_time_ms": 0.039, "training_step_time_ms": 27708.591, "sample_time_ms": 2851.72, "learn_time_ms": 24830.77, "learn_throughput": 161.09, "synch_weights_time_ms": 22.403}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 8, "trial_id": "cbf82_00000", "date": "2024-08-21_13-10-46", "timestamp": 1724226046, "time_this_iter_s": 27.177192211151123, "time_total_s": 222.05588579177856, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e00ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 222.05588579177856, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.781578947368416, "ram_util_percent": 83.37368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3089028033117454, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.8173527455578247, "policy_loss": -0.015706909642661533, "vf_loss": 1.831305498443544, "vf_explained_var": 0.08633738656838735, "kl": 0.008770742223714479, "entropy": 1.5220464122792086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.08808817670991, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 8.058638283610344, "policy_loss": -0.02345937448311209, "vf_loss": 8.079562565187613, "vf_explained_var": 0.31786715940882765, "kl": 0.012675424739427399, "entropy": 1.5062636151909827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 376.1, "episode_reward_min": 38.90000000000028, "episode_reward_mean": 224.77083333333326, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -175.78087862385092, "predator_policy": 0.757674130077879}, "policy_reward_max": {"prey_policy": 357.68825654787804, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 123.06966763203235, "predator_policy": 101.70116570130078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.30000000000027, 299.79999999999995, 369.8, 287.70000000000005, 161.39999999999998, 265.5999999999999, 151.39999999999998, 221.40000000000012, 235.29999999999995, 167.30000000000004, 115.30000000000001, 339.4, 259.29999999999995, 240.4000000000001, 63.20000000000005, 119.20000000000012, 63.00000000000022, 234.99999999999994, 156.7999999999991, 221.99999999999966, 111.89999999999822, 136.20000000000005, 309.2, 199.7, 81.90000000000009, 202.30000000000004, 236.39999999999995, 38.90000000000028, 220.59999999999997, 291.99999999999966, 183.09999999999997, 336.19999999999993, 331.4, 150.39999999999998, 246.09999999999997, 225.50000000000003, 215.29999999999998, 324.7, 113.70000000000005, 359.3, 256.79999999999995, 321.4, 98.6, 259.6999999999995, 255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.993455606169192, 272.3519659083587, 351.1156569109023, 156.25091063732296, -34.97637311759539, 107.53879954600987, -1.8271166471617415, 143.6391052636105, 222.06596374165156, 101.64156872610326, -34.04754961194723, 289.14064177133605, 185.0667465997314, 92.88642714303677, -175.78087862385092, 79.77260865787765, -40.97611673985611, 57.060692877845526, 143.50610394629928, 150.46812879118366, 111.14232586992033, 38.65042552086718, 254.75209258870933, 93.86955829093293, -71.97904532329528, -16.227691124576637, 119.50097902438982, 27.830271691550283, 194.92691735165562, 200.9760943556355, 71.7077079941977, 245.08909717254775, 286.14323289488334, -12.833977753776274, 142.17391043859772, 60.37888176696898, 65.13018340330416, 284.8144913702052, -15.574191567289802, 357.68825654787804, 112.57609147313107, 165.108462230295, -169.93120290007582, 144.88923235415083, 96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317], "policy_predator_policy_reward": [104.29345560616778, 27.448034091641453, 18.68434308909765, 131.44908936267706, 196.3763731175945, 158.06120045398976, 153.2271166471618, 77.76089473638973, 13.234036258348363, 65.65843127389677, 149.347549611946, 50.25935822866395, 74.23325340026815, 147.51357285696298, 238.9808786238497, 39.427391342122284, 103.97611673985455, 177.9393071221544, 13.293896053700252, 71.53187120881599, 0.757674130077879, 97.54957447913267, 54.44790741129076, 105.83044170906724, 153.87904532329432, 218.52769112457608, 116.89902097560967, 11.069728308449918, 25.6730826483444, 91.02390564436466, 111.39229200580128, 91.1109028274522, 45.25676710511662, 163.23397775377515, 103.9260895614023, 165.12111823303084, 150.16981659669574, 39.8855086297948, 129.27419156728874, 1.6117434521219673, 144.2239085268686, 156.29153776970503, 268.5312029000748, 114.81076764584904, 158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.212114619652324, "mean_inference_ms": 4.543888967755667, "mean_action_processing_ms": 1.1605274203458076, "mean_env_wait_ms": 10.461067015660673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003262692027621799, "StateBufferConnector_ms": 0.015248523818122016, "ViewRequirementAgentConnector_ms": 0.12689166598849827}, "num_episodes": 0, "episode_return_max": 376.1, "episode_return_min": 38.90000000000028, "episode_return_mean": 224.77083333333326, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.87367211450527, "num_env_steps_trained_throughput_per_sec": 139.87367211450527, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 27807.545, "restore_workers_time_ms": 0.036, "training_step_time_ms": 27807.286, "sample_time_ms": 2806.003, "learn_time_ms": 24974.094, "learn_throughput": 160.166, "synch_weights_time_ms": 23.63}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 9, "trial_id": "cbf82_00000", "date": "2024-08-21_13-11-14", "timestamp": 1724226074, "time_this_iter_s": 28.63730788230896, "time_total_s": 250.69319367408752, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e00d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 250.69319367408752, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 44.45609756097561, "ram_util_percent": 83.14634146341463}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8826337518791356, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.8933446086322268, "policy_loss": -0.01967231151017283, "vf_loss": 1.9105373853817582, "vf_explained_var": 0.14657661151140927, "kl": 0.012397645777673461, "entropy": 1.502679041897257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.110161297768354, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.883904267847538, "policy_loss": -0.01825825285704923, "vf_loss": 7.8994434749086695, "vf_explained_var": 0.30887426423529785, "kl": 0.013595295328317054, "entropy": 1.5064827768752973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 376.1, "episode_reward_min": 38.90000000000028, "episode_reward_mean": 224.77083333333326, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -175.78087862385092, "predator_policy": 0.757674130077879}, "policy_reward_max": {"prey_policy": 357.68825654787804, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 123.06966763203235, "predator_policy": 101.70116570130078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.30000000000027, 299.79999999999995, 369.8, 287.70000000000005, 161.39999999999998, 265.5999999999999, 151.39999999999998, 221.40000000000012, 235.29999999999995, 167.30000000000004, 115.30000000000001, 339.4, 259.29999999999995, 240.4000000000001, 63.20000000000005, 119.20000000000012, 63.00000000000022, 234.99999999999994, 156.7999999999991, 221.99999999999966, 111.89999999999822, 136.20000000000005, 309.2, 199.7, 81.90000000000009, 202.30000000000004, 236.39999999999995, 38.90000000000028, 220.59999999999997, 291.99999999999966, 183.09999999999997, 336.19999999999993, 331.4, 150.39999999999998, 246.09999999999997, 225.50000000000003, 215.29999999999998, 324.7, 113.70000000000005, 359.3, 256.79999999999995, 321.4, 98.6, 259.6999999999995, 255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.993455606169192, 272.3519659083587, 351.1156569109023, 156.25091063732296, -34.97637311759539, 107.53879954600987, -1.8271166471617415, 143.6391052636105, 222.06596374165156, 101.64156872610326, -34.04754961194723, 289.14064177133605, 185.0667465997314, 92.88642714303677, -175.78087862385092, 79.77260865787765, -40.97611673985611, 57.060692877845526, 143.50610394629928, 150.46812879118366, 111.14232586992033, 38.65042552086718, 254.75209258870933, 93.86955829093293, -71.97904532329528, -16.227691124576637, 119.50097902438982, 27.830271691550283, 194.92691735165562, 200.9760943556355, 71.7077079941977, 245.08909717254775, 286.14323289488334, -12.833977753776274, 142.17391043859772, 60.37888176696898, 65.13018340330416, 284.8144913702052, -15.574191567289802, 357.68825654787804, 112.57609147313107, 165.108462230295, -169.93120290007582, 144.88923235415083, 96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317], "policy_predator_policy_reward": [104.29345560616778, 27.448034091641453, 18.68434308909765, 131.44908936267706, 196.3763731175945, 158.06120045398976, 153.2271166471618, 77.76089473638973, 13.234036258348363, 65.65843127389677, 149.347549611946, 50.25935822866395, 74.23325340026815, 147.51357285696298, 238.9808786238497, 39.427391342122284, 103.97611673985455, 177.9393071221544, 13.293896053700252, 71.53187120881599, 0.757674130077879, 97.54957447913267, 54.44790741129076, 105.83044170906724, 153.87904532329432, 218.52769112457608, 116.89902097560967, 11.069728308449918, 25.6730826483444, 91.02390564436466, 111.39229200580128, 91.1109028274522, 45.25676710511662, 163.23397775377515, 103.9260895614023, 165.12111823303084, 150.16981659669574, 39.8855086297948, 129.27419156728874, 1.6117434521219673, 144.2239085268686, 156.29153776970503, 268.5312029000748, 114.81076764584904, 158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.212114619652324, "mean_inference_ms": 4.543888967755667, "mean_action_processing_ms": 1.1605274203458076, "mean_env_wait_ms": 10.461067015660673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003262692027621799, "StateBufferConnector_ms": 0.015248523818122016, "ViewRequirementAgentConnector_ms": 0.12689166598849827}, "num_episodes": 0, "episode_return_max": 376.1, "episode_return_min": 38.90000000000028, "episode_return_mean": 224.77083333333326, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.74910740000902, "num_env_steps_trained_throughput_per_sec": 146.74910740000902, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 27752.535, "restore_workers_time_ms": 0.035, "training_step_time_ms": 27752.288, "sample_time_ms": 2735.166, "learn_time_ms": 24989.309, "learn_throughput": 160.068, "synch_weights_time_ms": 23.884}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 10, "trial_id": "cbf82_00000", "date": "2024-08-21_13-11-42", "timestamp": 1724226102, "time_this_iter_s": 27.306174755096436, "time_total_s": 277.99936842918396, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075ab550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 277.99936842918396, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 38.323076923076925, "ram_util_percent": 82.91538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.748757807103296, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.4630759607379635, "policy_loss": -0.015153634471547169, "vf_loss": 1.4758617382496595, "vf_explained_var": 0.10357614296178023, "kl": 0.011839271425075518, "entropy": 1.4997399171193442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000005}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.955174069354932, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.760388232270876, "policy_loss": -0.013624807442344416, "vf_loss": 7.771700150271257, "vf_explained_var": 0.22954212749997774, "kl": 0.011564413651649374, "entropy": 1.5109725990643104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000005}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 376.1, "episode_reward_min": 38.90000000000028, "episode_reward_mean": 224.77083333333326, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -175.78087862385092, "predator_policy": 0.757674130077879}, "policy_reward_max": {"prey_policy": 357.68825654787804, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 123.06966763203235, "predator_policy": 101.70116570130078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.30000000000027, 299.79999999999995, 369.8, 287.70000000000005, 161.39999999999998, 265.5999999999999, 151.39999999999998, 221.40000000000012, 235.29999999999995, 167.30000000000004, 115.30000000000001, 339.4, 259.29999999999995, 240.4000000000001, 63.20000000000005, 119.20000000000012, 63.00000000000022, 234.99999999999994, 156.7999999999991, 221.99999999999966, 111.89999999999822, 136.20000000000005, 309.2, 199.7, 81.90000000000009, 202.30000000000004, 236.39999999999995, 38.90000000000028, 220.59999999999997, 291.99999999999966, 183.09999999999997, 336.19999999999993, 331.4, 150.39999999999998, 246.09999999999997, 225.50000000000003, 215.29999999999998, 324.7, 113.70000000000005, 359.3, 256.79999999999995, 321.4, 98.6, 259.6999999999995, 255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.993455606169192, 272.3519659083587, 351.1156569109023, 156.25091063732296, -34.97637311759539, 107.53879954600987, -1.8271166471617415, 143.6391052636105, 222.06596374165156, 101.64156872610326, -34.04754961194723, 289.14064177133605, 185.0667465997314, 92.88642714303677, -175.78087862385092, 79.77260865787765, -40.97611673985611, 57.060692877845526, 143.50610394629928, 150.46812879118366, 111.14232586992033, 38.65042552086718, 254.75209258870933, 93.86955829093293, -71.97904532329528, -16.227691124576637, 119.50097902438982, 27.830271691550283, 194.92691735165562, 200.9760943556355, 71.7077079941977, 245.08909717254775, 286.14323289488334, -12.833977753776274, 142.17391043859772, 60.37888176696898, 65.13018340330416, 284.8144913702052, -15.574191567289802, 357.68825654787804, 112.57609147313107, 165.108462230295, -169.93120290007582, 144.88923235415083, 96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317], "policy_predator_policy_reward": [104.29345560616778, 27.448034091641453, 18.68434308909765, 131.44908936267706, 196.3763731175945, 158.06120045398976, 153.2271166471618, 77.76089473638973, 13.234036258348363, 65.65843127389677, 149.347549611946, 50.25935822866395, 74.23325340026815, 147.51357285696298, 238.9808786238497, 39.427391342122284, 103.97611673985455, 177.9393071221544, 13.293896053700252, 71.53187120881599, 0.757674130077879, 97.54957447913267, 54.44790741129076, 105.83044170906724, 153.87904532329432, 218.52769112457608, 116.89902097560967, 11.069728308449918, 25.6730826483444, 91.02390564436466, 111.39229200580128, 91.1109028274522, 45.25676710511662, 163.23397775377515, 103.9260895614023, 165.12111823303084, 150.16981659669574, 39.8855086297948, 129.27419156728874, 1.6117434521219673, 144.2239085268686, 156.29153776970503, 268.5312029000748, 114.81076764584904, 158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.212114619652324, "mean_inference_ms": 4.543888967755667, "mean_action_processing_ms": 1.1605274203458076, "mean_env_wait_ms": 10.461067015660673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003262692027621799, "StateBufferConnector_ms": 0.015248523818122016, "ViewRequirementAgentConnector_ms": 0.12689166598849827}, "num_episodes": 0, "episode_return_max": 376.1, "episode_return_min": 38.90000000000028, "episode_return_mean": 224.77083333333326, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.63717872376608, "num_env_steps_trained_throughput_per_sec": 139.63717872376608, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 27554.752, "restore_workers_time_ms": 0.039, "training_step_time_ms": 27554.47, "sample_time_ms": 2477.071, "learn_time_ms": 25049.355, "learn_throughput": 159.685, "synch_weights_time_ms": 24.196}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 11, "trial_id": "cbf82_00000", "date": "2024-08-21_13-12-10", "timestamp": 1724226130, "time_this_iter_s": 28.682633876800537, "time_total_s": 306.6820023059845, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177de7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 306.6820023059845, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 45.779999999999994, "ram_util_percent": 82.94500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.868524400703609, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.9906962793320417, "policy_loss": -0.014948302596652259, "vf_loss": 1.0034806842915713, "vf_explained_var": 0.2694441436479489, "kl": 0.010819507227279247, "entropy": 1.486677106966575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.42500359999637, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.855448321501414, "policy_loss": -0.01475843091320712, "vf_loss": 6.867669139802456, "vf_explained_var": 0.614115655173858, "kl": 0.012688086813189633, "entropy": 1.507676071425279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 376.1, "episode_reward_min": 38.90000000000028, "episode_reward_mean": 224.77083333333326, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -175.78087862385092, "predator_policy": 0.757674130077879}, "policy_reward_max": {"prey_policy": 357.68825654787804, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 123.06966763203235, "predator_policy": 101.70116570130078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.30000000000027, 299.79999999999995, 369.8, 287.70000000000005, 161.39999999999998, 265.5999999999999, 151.39999999999998, 221.40000000000012, 235.29999999999995, 167.30000000000004, 115.30000000000001, 339.4, 259.29999999999995, 240.4000000000001, 63.20000000000005, 119.20000000000012, 63.00000000000022, 234.99999999999994, 156.7999999999991, 221.99999999999966, 111.89999999999822, 136.20000000000005, 309.2, 199.7, 81.90000000000009, 202.30000000000004, 236.39999999999995, 38.90000000000028, 220.59999999999997, 291.99999999999966, 183.09999999999997, 336.19999999999993, 331.4, 150.39999999999998, 246.09999999999997, 225.50000000000003, 215.29999999999998, 324.7, 113.70000000000005, 359.3, 256.79999999999995, 321.4, 98.6, 259.6999999999995, 255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.993455606169192, 272.3519659083587, 351.1156569109023, 156.25091063732296, -34.97637311759539, 107.53879954600987, -1.8271166471617415, 143.6391052636105, 222.06596374165156, 101.64156872610326, -34.04754961194723, 289.14064177133605, 185.0667465997314, 92.88642714303677, -175.78087862385092, 79.77260865787765, -40.97611673985611, 57.060692877845526, 143.50610394629928, 150.46812879118366, 111.14232586992033, 38.65042552086718, 254.75209258870933, 93.86955829093293, -71.97904532329528, -16.227691124576637, 119.50097902438982, 27.830271691550283, 194.92691735165562, 200.9760943556355, 71.7077079941977, 245.08909717254775, 286.14323289488334, -12.833977753776274, 142.17391043859772, 60.37888176696898, 65.13018340330416, 284.8144913702052, -15.574191567289802, 357.68825654787804, 112.57609147313107, 165.108462230295, -169.93120290007582, 144.88923235415083, 96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317], "policy_predator_policy_reward": [104.29345560616778, 27.448034091641453, 18.68434308909765, 131.44908936267706, 196.3763731175945, 158.06120045398976, 153.2271166471618, 77.76089473638973, 13.234036258348363, 65.65843127389677, 149.347549611946, 50.25935822866395, 74.23325340026815, 147.51357285696298, 238.9808786238497, 39.427391342122284, 103.97611673985455, 177.9393071221544, 13.293896053700252, 71.53187120881599, 0.757674130077879, 97.54957447913267, 54.44790741129076, 105.83044170906724, 153.87904532329432, 218.52769112457608, 116.89902097560967, 11.069728308449918, 25.6730826483444, 91.02390564436466, 111.39229200580128, 91.1109028274522, 45.25676710511662, 163.23397775377515, 103.9260895614023, 165.12111823303084, 150.16981659669574, 39.8855086297948, 129.27419156728874, 1.6117434521219673, 144.2239085268686, 156.29153776970503, 268.5312029000748, 114.81076764584904, 158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.212114619652324, "mean_inference_ms": 4.543888967755667, "mean_action_processing_ms": 1.1605274203458076, "mean_env_wait_ms": 10.461067015660673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003262692027621799, "StateBufferConnector_ms": 0.015248523818122016, "ViewRequirementAgentConnector_ms": 0.12689166598849827}, "num_episodes": 0, "episode_return_max": 376.1, "episode_return_min": 38.90000000000028, "episode_return_mean": 224.77083333333326, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 132.1253206037472, "num_env_steps_trained_throughput_per_sec": 132.1253206037472, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 27861.053, "restore_workers_time_ms": 0.027, "training_step_time_ms": 27860.781, "sample_time_ms": 2720.855, "learn_time_ms": 25112.223, "learn_throughput": 159.285, "synch_weights_time_ms": 23.789}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 12, "trial_id": "cbf82_00000", "date": "2024-08-21_13-12-41", "timestamp": 1724226161, "time_this_iter_s": 30.32080101966858, "time_total_s": 337.0028033256531, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e26f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 337.0028033256531, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 41.53023255813953, "ram_util_percent": 83.04418604651163}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0383377987891436, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.474568032597502, "policy_loss": -0.013548996141616953, "vf_loss": 2.486414854352673, "vf_explained_var": 0.13172719969103733, "kl": 0.008510917673508327, "entropy": 1.4807469889521598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 492.7000000000007}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.140363831197224, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.456874411304792, "policy_loss": -0.01707074496371206, "vf_loss": 7.471645194292068, "vf_explained_var": 0.399614173732698, "kl": 0.011499854652114058, "entropy": 1.4893232925484579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 492.7000000000007}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": 38.90000000000028, "episode_reward_mean": 241.84698795180717, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 33200, "policy_reward_min": {"prey_policy": -175.78087862385092, "predator_policy": 0.757674130077879}, "policy_reward_max": {"prey_policy": 379.4776171465087, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 147.2271507813425, "predator_policy": 94.61983717046458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.30000000000027, 299.79999999999995, 369.8, 287.70000000000005, 161.39999999999998, 265.5999999999999, 151.39999999999998, 221.40000000000012, 235.29999999999995, 167.30000000000004, 115.30000000000001, 339.4, 259.29999999999995, 240.4000000000001, 63.20000000000005, 119.20000000000012, 63.00000000000022, 234.99999999999994, 156.7999999999991, 221.99999999999966, 111.89999999999822, 136.20000000000005, 309.2, 199.7, 81.90000000000009, 202.30000000000004, 236.39999999999995, 38.90000000000028, 220.59999999999997, 291.99999999999966, 183.09999999999997, 336.19999999999993, 331.4, 150.39999999999998, 246.09999999999997, 225.50000000000003, 215.29999999999998, 324.7, 113.70000000000005, 359.3, 256.79999999999995, 321.4, 98.6, 259.6999999999995, 255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994, 328.3, 381.0, 390.0, 376.2, 303.6, 347.3, 340.2, 388.3, 367.0, 331.4, 336.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.993455606169192, 272.3519659083587, 351.1156569109023, 156.25091063732296, -34.97637311759539, 107.53879954600987, -1.8271166471617415, 143.6391052636105, 222.06596374165156, 101.64156872610326, -34.04754961194723, 289.14064177133605, 185.0667465997314, 92.88642714303677, -175.78087862385092, 79.77260865787765, -40.97611673985611, 57.060692877845526, 143.50610394629928, 150.46812879118366, 111.14232586992033, 38.65042552086718, 254.75209258870933, 93.86955829093293, -71.97904532329528, -16.227691124576637, 119.50097902438982, 27.830271691550283, 194.92691735165562, 200.9760943556355, 71.7077079941977, 245.08909717254775, 286.14323289488334, -12.833977753776274, 142.17391043859772, 60.37888176696898, 65.13018340330416, 284.8144913702052, -15.574191567289802, 357.68825654787804, 112.57609147313107, 165.108462230295, -169.93120290007582, 144.88923235415083, 96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317, 177.4556143564789, 335.8533773779967, 379.4776171465087, 352.4586836782329, 185.89712568601936, 328.69965877758295, 282.94715454309244, 379.3570517302454, 312.66421838817075, 303.4647148543097, 320.5622288064585], "policy_predator_policy_reward": [104.29345560616778, 27.448034091641453, 18.68434308909765, 131.44908936267706, 196.3763731175945, 158.06120045398976, 153.2271166471618, 77.76089473638973, 13.234036258348363, 65.65843127389677, 149.347549611946, 50.25935822866395, 74.23325340026815, 147.51357285696298, 238.9808786238497, 39.427391342122284, 103.97611673985455, 177.9393071221544, 13.293896053700252, 71.53187120881599, 0.757674130077879, 97.54957447913267, 54.44790741129076, 105.83044170906724, 153.87904532329432, 218.52769112457608, 116.89902097560967, 11.069728308449918, 25.6730826483444, 91.02390564436466, 111.39229200580128, 91.1109028274522, 45.25676710511662, 163.23397775377515, 103.9260895614023, 165.12111823303084, 150.16981659669574, 39.8855086297948, 129.27419156728874, 1.6117434521219673, 144.2239085268686, 156.29153776970503, 268.5312029000748, 114.81076764584904, 158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829, 150.84438564352106, 45.14662262200331, 10.522382853491301, 23.74131632176717, 117.70287431398049, 18.60034122241706, 57.252845456907544, 8.942948269754595, 54.335781611829226, 27.93528514569027, 15.937771193541503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.137522173540969, "mean_inference_ms": 4.554413098781167, "mean_action_processing_ms": 1.3102639468998283, "mean_env_wait_ms": 10.426925721504928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003181020897555064, "StateBufferConnector_ms": 0.013558548617075724, "ViewRequirementAgentConnector_ms": 0.1254962151309094}, "num_episodes": 11, "episode_return_max": 390.0, "episode_return_min": 38.90000000000028, "episode_return_mean": 241.84698795180717, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.24357073766697, "num_env_steps_trained_throughput_per_sec": 153.24357073766697, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 27701.197, "restore_workers_time_ms": 0.027, "training_step_time_ms": 27700.958, "sample_time_ms": 2678.692, "learn_time_ms": 24995.228, "learn_throughput": 160.031, "synch_weights_time_ms": 23.068}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 13, "trial_id": "cbf82_00000", "date": "2024-08-21_13-13-07", "timestamp": 1724226187, "time_this_iter_s": 26.14778208732605, "time_total_s": 363.1505854129791, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x307570e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 363.1505854129791, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.21315789473685, "ram_util_percent": 82.44736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.193461508055528, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.448959320783615, "policy_loss": -0.018731892201079365, "vf_loss": 3.46554057598114, "vf_explained_var": 0.16958051671584448, "kl": 0.010753202453391472, "entropy": 1.4487416525681813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.614651952435572, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.3606214011708895, "policy_loss": -0.017603134375046164, "vf_loss": 7.375930534799894, "vf_explained_var": 0.289460085084041, "kl": 0.011469986766557364, "entropy": 1.4364605971922477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": 38.90000000000028, "episode_reward_mean": 258.441, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -175.78087862385092, "predator_policy": 0.757674130077879}, "policy_reward_max": {"prey_policy": 379.4776171465087, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 164.6830914245193, "predator_policy": 93.75790857548058}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.40000000000012, 235.29999999999995, 167.30000000000004, 115.30000000000001, 339.4, 259.29999999999995, 240.4000000000001, 63.20000000000005, 119.20000000000012, 63.00000000000022, 234.99999999999994, 156.7999999999991, 221.99999999999966, 111.89999999999822, 136.20000000000005, 309.2, 199.7, 81.90000000000009, 202.30000000000004, 236.39999999999995, 38.90000000000028, 220.59999999999997, 291.99999999999966, 183.09999999999997, 336.19999999999993, 331.4, 150.39999999999998, 246.09999999999997, 225.50000000000003, 215.29999999999998, 324.7, 113.70000000000005, 359.3, 256.79999999999995, 321.4, 98.6, 259.6999999999995, 255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994, 328.3, 381.0, 390.0, 376.2, 303.6, 347.3, 340.2, 388.3, 367.0, 331.4, 336.5, 293.4, 341.0, 332.5, 236.9999999999999, 359.29999999999995, 353.29999999999995, 378.0, 170.79999999999995, 247.79999999999995, 239.19999999999996, 364.8, 325.1, 368.0, 334.8, 261.0, 281.0, 328.0, 135.19999999999993, 327.0, 381.0, 336.0, 340.29999999999995, 363.1, 310.2], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [143.6391052636105, 222.06596374165156, 101.64156872610326, -34.04754961194723, 289.14064177133605, 185.0667465997314, 92.88642714303677, -175.78087862385092, 79.77260865787765, -40.97611673985611, 57.060692877845526, 143.50610394629928, 150.46812879118366, 111.14232586992033, 38.65042552086718, 254.75209258870933, 93.86955829093293, -71.97904532329528, -16.227691124576637, 119.50097902438982, 27.830271691550283, 194.92691735165562, 200.9760943556355, 71.7077079941977, 245.08909717254775, 286.14323289488334, -12.833977753776274, 142.17391043859772, 60.37888176696898, 65.13018340330416, 284.8144913702052, -15.574191567289802, 357.68825654787804, 112.57609147313107, 165.108462230295, -169.93120290007582, 144.88923235415083, 96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317, 177.4556143564789, 335.8533773779967, 379.4776171465087, 352.4586836782329, 185.89712568601936, 328.69965877758295, 282.94715454309244, 379.3570517302454, 312.66421838817075, 303.4647148543097, 320.5622288064585, 98.92332613773446, 289.4460979864777, 272.76790913425486, -48.453057212970464, 308.16054348788805, 342.97325987800866, 365.26369866794676, 60.941265918453766, 20.947256695370367, 174.34313963498087, 335.81745873879254, 258.38366731314824, 329.92179315573225, 269.4247960316918, 104.46848395513717, 131.0437837222272, 190.913472822511, -97.5701591269817, 256.3818596772965, 348.89402010975766, 235.1392711901677, 269.34623493180766, 298.07912542204406, 280.3587669606932], "policy_predator_policy_reward": [77.76089473638973, 13.234036258348363, 65.65843127389677, 149.347549611946, 50.25935822866395, 74.23325340026815, 147.51357285696298, 238.9808786238497, 39.427391342122284, 103.97611673985455, 177.9393071221544, 13.293896053700252, 71.53187120881599, 0.757674130077879, 97.54957447913267, 54.44790741129076, 105.83044170906724, 153.87904532329432, 218.52769112457608, 116.89902097560967, 11.069728308449918, 25.6730826483444, 91.02390564436466, 111.39229200580128, 91.1109028274522, 45.25676710511662, 163.23397775377515, 103.9260895614023, 165.12111823303084, 150.16981659669574, 39.8855086297948, 129.27419156728874, 1.6117434521219673, 144.2239085268686, 156.29153776970503, 268.5312029000748, 114.81076764584904, 158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829, 150.84438564352106, 45.14662262200331, 10.522382853491301, 23.74131632176717, 117.70287431398049, 18.60034122241706, 57.252845456907544, 8.942948269754595, 54.335781611829226, 27.93528514569027, 15.937771193541503, 194.47667386226547, 51.55390201352231, 59.73209086574522, 285.45305721297046, 51.13945651211194, 10.326740121991246, 12.736301332053243, 109.85873408154615, 226.85274330462968, 64.85686036501907, 28.982541261207473, 66.71633268685181, 38.07820684426781, 65.37520396830817, 156.5315160448628, 149.95621627777285, 137.08652717748893, 232.77015912698164, 70.61814032270343, 32.10597989024232, 100.86072880983235, 70.95376506819221, 65.02087457795592, 29.84123303930682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.0271653175997795, "mean_inference_ms": 4.61852019389237, "mean_action_processing_ms": 1.4525879081745159, "mean_env_wait_ms": 10.328480788216867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003202676773071289, "StateBufferConnector_ms": 0.0119246244430542, "ViewRequirementAgentConnector_ms": 0.1318356990814209}, "num_episodes": 24, "episode_return_max": 390.0, "episode_return_min": 38.90000000000028, "episode_return_mean": 258.441, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.03652944265014, "num_env_steps_trained_throughput_per_sec": 148.03652944265014, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 27400.462, "restore_workers_time_ms": 0.026, "training_step_time_ms": 27400.206, "sample_time_ms": 2504.133, "learn_time_ms": 24866.16, "learn_throughput": 160.861, "synch_weights_time_ms": 24.473}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 14, "trial_id": "cbf82_00000", "date": "2024-08-21_13-13-34", "timestamp": 1724226214, "time_this_iter_s": 27.064274311065674, "time_total_s": 390.2148597240448, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e26f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 390.2148597240448, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 37.04473684210526, "ram_util_percent": 82.78421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0490226259455087, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.058635948598385, "policy_loss": -0.020120692727262697, "vf_loss": 3.07611382342875, "vf_explained_var": 0.15639537312090396, "kl": 0.013214101707368779, "entropy": 1.4325941814730565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.362248448034126, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.854756895204385, "policy_loss": -0.018872006323363166, "vf_loss": 6.871673535803954, "vf_explained_var": 0.43427416644990446, "kl": 0.009776760164822918, "entropy": 1.4381512393554052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 39.50000000000029, "episode_reward_mean": 295.337, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -169.93120290007582, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 208.9182774406354, "predator_policy": 86.41872255936461}, "custom_metrics": {}, "hist_stats": {"episode_reward": [215.29999999999998, 324.7, 113.70000000000005, 359.3, 256.79999999999995, 321.4, 98.6, 259.6999999999995, 255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994, 328.3, 381.0, 390.0, 376.2, 303.6, 347.3, 340.2, 388.3, 367.0, 331.4, 336.5, 293.4, 341.0, 332.5, 236.9999999999999, 359.29999999999995, 353.29999999999995, 378.0, 170.79999999999995, 247.79999999999995, 239.19999999999996, 364.8, 325.1, 368.0, 334.8, 261.0, 281.0, 328.0, 135.19999999999993, 327.0, 381.0, 336.0, 340.29999999999995, 363.1, 310.2, 379.50000000000006, 247.40000000000003, 336.0, 279.1, 345.0, 292.0, 122.10000000000014, 348.8, 375.5, 370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [65.13018340330416, 284.8144913702052, -15.574191567289802, 357.68825654787804, 112.57609147313107, 165.108462230295, -169.93120290007582, 144.88923235415083, 96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317, 177.4556143564789, 335.8533773779967, 379.4776171465087, 352.4586836782329, 185.89712568601936, 328.69965877758295, 282.94715454309244, 379.3570517302454, 312.66421838817075, 303.4647148543097, 320.5622288064585, 98.92332613773446, 289.4460979864777, 272.76790913425486, -48.453057212970464, 308.16054348788805, 342.97325987800866, 365.26369866794676, 60.941265918453766, 20.947256695370367, 174.34313963498087, 335.81745873879254, 258.38366731314824, 329.92179315573225, 269.4247960316918, 104.46848395513717, 131.0437837222272, 190.913472822511, -97.5701591269817, 256.3818596772965, 348.89402010975766, 235.1392711901677, 269.34623493180766, 298.07912542204406, 280.3587669606932, 349.31754365064853, 59.63514166764273, 226.7426849726693, 87.25652551229494, 274.20407148349796, 133.583716913102, 102.50957872273563, 303.77364486680005, 373.4955471954398, 340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892], "policy_predator_policy_reward": [150.16981659669574, 39.8855086297948, 129.27419156728874, 1.6117434521219673, 144.2239085268686, 156.29153776970503, 268.5312029000748, 114.81076764584904, 158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829, 150.84438564352106, 45.14662262200331, 10.522382853491301, 23.74131632176717, 117.70287431398049, 18.60034122241706, 57.252845456907544, 8.942948269754595, 54.335781611829226, 27.93528514569027, 15.937771193541503, 194.47667386226547, 51.55390201352231, 59.73209086574522, 285.45305721297046, 51.13945651211194, 10.326740121991246, 12.736301332053243, 109.85873408154615, 226.85274330462968, 64.85686036501907, 28.982541261207473, 66.71633268685181, 38.07820684426781, 65.37520396830817, 156.5315160448628, 149.95621627777285, 137.08652717748893, 232.77015912698164, 70.61814032270343, 32.10597989024232, 100.86072880983235, 70.95376506819221, 65.02087457795592, 29.84123303930682, 30.18245634935143, 187.76485833235753, 109.2573150273306, 191.8434744877051, 70.795928516502, 158.4162830868981, 19.590421277264458, 45.026355133199964, 2.004452804560131, 29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7946335327214684, "mean_inference_ms": 4.682839602617062, "mean_action_processing_ms": 1.6380402377857677, "mean_env_wait_ms": 10.251703097570621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033026933670043945, "StateBufferConnector_ms": 0.01285254955291748, "ViewRequirementAgentConnector_ms": 0.11284959316253662}, "num_episodes": 29, "episode_return_max": 400.0, "episode_return_min": 39.50000000000029, "episode_return_mean": 295.337, "episodes_this_iter": 29}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.67086719135958, "num_env_steps_trained_throughput_per_sec": 151.67086719135958, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 27399.6, "restore_workers_time_ms": 0.054, "training_step_time_ms": 27399.186, "sample_time_ms": 2503.466, "learn_time_ms": 24864.584, "learn_throughput": 160.871, "synch_weights_time_ms": 24.921}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 15, "trial_id": "cbf82_00000", "date": "2024-08-21_13-14-00", "timestamp": 1724226240, "time_this_iter_s": 26.410419940948486, "time_total_s": 416.6252796649933, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075745e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 416.6252796649933, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 35.181578947368415, "ram_util_percent": 82.89736842105262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.819460625822345, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.436463555196921, "policy_loss": -0.022124995753498904, "vf_loss": 3.4555700339376925, "vf_explained_var": 0.1931862918039163, "kl": 0.0150926216772253, "entropy": 1.396774973347783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000005}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.606647575149932, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.515089530249437, "policy_loss": -0.02116546688048402, "vf_loss": 6.5336030825972555, "vf_explained_var": 0.45056587643921375, "kl": 0.013259524738047427, "entropy": 1.4129313434163728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000005}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 39.50000000000029, "episode_reward_mean": 302.179, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -137.14438440454637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 222.04652045061644, "predator_policy": 80.13247954938359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994, 328.3, 381.0, 390.0, 376.2, 303.6, 347.3, 340.2, 388.3, 367.0, 331.4, 336.5, 293.4, 341.0, 332.5, 236.9999999999999, 359.29999999999995, 353.29999999999995, 378.0, 170.79999999999995, 247.79999999999995, 239.19999999999996, 364.8, 325.1, 368.0, 334.8, 261.0, 281.0, 328.0, 135.19999999999993, 327.0, 381.0, 336.0, 340.29999999999995, 363.1, 310.2, 379.50000000000006, 247.40000000000003, 336.0, 279.1, 345.0, 292.0, 122.10000000000014, 348.8, 375.5, 370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317, 177.4556143564789, 335.8533773779967, 379.4776171465087, 352.4586836782329, 185.89712568601936, 328.69965877758295, 282.94715454309244, 379.3570517302454, 312.66421838817075, 303.4647148543097, 320.5622288064585, 98.92332613773446, 289.4460979864777, 272.76790913425486, -48.453057212970464, 308.16054348788805, 342.97325987800866, 365.26369866794676, 60.941265918453766, 20.947256695370367, 174.34313963498087, 335.81745873879254, 258.38366731314824, 329.92179315573225, 269.4247960316918, 104.46848395513717, 131.0437837222272, 190.913472822511, -97.5701591269817, 256.3818596772965, 348.89402010975766, 235.1392711901677, 269.34623493180766, 298.07912542204406, 280.3587669606932, 349.31754365064853, 59.63514166764273, 226.7426849726693, 87.25652551229494, 274.20407148349796, 133.583716913102, 102.50957872273563, 303.77364486680005, 373.4955471954398, 340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545], "policy_predator_policy_reward": [158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829, 150.84438564352106, 45.14662262200331, 10.522382853491301, 23.74131632176717, 117.70287431398049, 18.60034122241706, 57.252845456907544, 8.942948269754595, 54.335781611829226, 27.93528514569027, 15.937771193541503, 194.47667386226547, 51.55390201352231, 59.73209086574522, 285.45305721297046, 51.13945651211194, 10.326740121991246, 12.736301332053243, 109.85873408154615, 226.85274330462968, 64.85686036501907, 28.982541261207473, 66.71633268685181, 38.07820684426781, 65.37520396830817, 156.5315160448628, 149.95621627777285, 137.08652717748893, 232.77015912698164, 70.61814032270343, 32.10597989024232, 100.86072880983235, 70.95376506819221, 65.02087457795592, 29.84123303930682, 30.18245634935143, 187.76485833235753, 109.2573150273306, 191.8434744877051, 70.795928516502, 158.4162830868981, 19.590421277264458, 45.026355133199964, 2.004452804560131, 29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7575828637822997, "mean_inference_ms": 4.642837480388371, "mean_action_processing_ms": 1.713598293409064, "mean_env_wait_ms": 10.219093783509411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032373666763305664, "StateBufferConnector_ms": 0.013074398040771484, "ViewRequirementAgentConnector_ms": 0.1296018362045288}, "num_episodes": 8, "episode_return_max": 400.0, "episode_return_min": 39.50000000000029, "episode_return_mean": 302.179, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.76586808841805, "num_env_steps_trained_throughput_per_sec": 149.76586808841805, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 27466.165, "restore_workers_time_ms": 0.053, "training_step_time_ms": 27465.746, "sample_time_ms": 2540.641, "learn_time_ms": 24894.385, "learn_throughput": 160.679, "synch_weights_time_ms": 24.534}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 16, "trial_id": "cbf82_00000", "date": "2024-08-21_13-14-27", "timestamp": 1724226267, "time_this_iter_s": 26.75249719619751, "time_total_s": 443.3777768611908, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e00ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 443.3777768611908, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.742105263157896, "ram_util_percent": 82.73157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.494921549409628, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.838574243088563, "policy_loss": -0.015651387071072047, "vf_loss": 4.851679612199465, "vf_explained_var": 0.16196122337132693, "kl": 0.012730072441142208, "entropy": 1.3965285107493401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.545608857398232, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.0335472191373505, "policy_loss": -0.020233123143649816, "vf_loss": 7.050774818658828, "vf_explained_var": 0.22125289185593525, "kl": 0.015027706731052604, "entropy": 1.420242075373729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 39.50000000000029, "episode_reward_mean": 302.179, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -137.14438440454637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 222.04652045061644, "predator_policy": 80.13247954938359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994, 328.3, 381.0, 390.0, 376.2, 303.6, 347.3, 340.2, 388.3, 367.0, 331.4, 336.5, 293.4, 341.0, 332.5, 236.9999999999999, 359.29999999999995, 353.29999999999995, 378.0, 170.79999999999995, 247.79999999999995, 239.19999999999996, 364.8, 325.1, 368.0, 334.8, 261.0, 281.0, 328.0, 135.19999999999993, 327.0, 381.0, 336.0, 340.29999999999995, 363.1, 310.2, 379.50000000000006, 247.40000000000003, 336.0, 279.1, 345.0, 292.0, 122.10000000000014, 348.8, 375.5, 370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317, 177.4556143564789, 335.8533773779967, 379.4776171465087, 352.4586836782329, 185.89712568601936, 328.69965877758295, 282.94715454309244, 379.3570517302454, 312.66421838817075, 303.4647148543097, 320.5622288064585, 98.92332613773446, 289.4460979864777, 272.76790913425486, -48.453057212970464, 308.16054348788805, 342.97325987800866, 365.26369866794676, 60.941265918453766, 20.947256695370367, 174.34313963498087, 335.81745873879254, 258.38366731314824, 329.92179315573225, 269.4247960316918, 104.46848395513717, 131.0437837222272, 190.913472822511, -97.5701591269817, 256.3818596772965, 348.89402010975766, 235.1392711901677, 269.34623493180766, 298.07912542204406, 280.3587669606932, 349.31754365064853, 59.63514166764273, 226.7426849726693, 87.25652551229494, 274.20407148349796, 133.583716913102, 102.50957872273563, 303.77364486680005, 373.4955471954398, 340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545], "policy_predator_policy_reward": [158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829, 150.84438564352106, 45.14662262200331, 10.522382853491301, 23.74131632176717, 117.70287431398049, 18.60034122241706, 57.252845456907544, 8.942948269754595, 54.335781611829226, 27.93528514569027, 15.937771193541503, 194.47667386226547, 51.55390201352231, 59.73209086574522, 285.45305721297046, 51.13945651211194, 10.326740121991246, 12.736301332053243, 109.85873408154615, 226.85274330462968, 64.85686036501907, 28.982541261207473, 66.71633268685181, 38.07820684426781, 65.37520396830817, 156.5315160448628, 149.95621627777285, 137.08652717748893, 232.77015912698164, 70.61814032270343, 32.10597989024232, 100.86072880983235, 70.95376506819221, 65.02087457795592, 29.84123303930682, 30.18245634935143, 187.76485833235753, 109.2573150273306, 191.8434744877051, 70.795928516502, 158.4162830868981, 19.590421277264458, 45.026355133199964, 2.004452804560131, 29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7575828637822997, "mean_inference_ms": 4.642837480388371, "mean_action_processing_ms": 1.713598293409064, "mean_env_wait_ms": 10.219093783509411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032373666763305664, "StateBufferConnector_ms": 0.013074398040771484, "ViewRequirementAgentConnector_ms": 0.1296018362045288}, "num_episodes": 0, "episode_return_max": 400.0, "episode_return_min": 39.50000000000029, "episode_return_mean": 302.179, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.2244234767788, "num_env_steps_trained_throughput_per_sec": 154.2244234767788, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 27403.877, "restore_workers_time_ms": 0.053, "training_step_time_ms": 27403.462, "sample_time_ms": 2481.416, "learn_time_ms": 24891.599, "learn_throughput": 160.697, "synch_weights_time_ms": 23.953}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 17, "trial_id": "cbf82_00000", "date": "2024-08-21_13-14-53", "timestamp": 1724226293, "time_this_iter_s": 25.98401403427124, "time_total_s": 469.36179089546204, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e00af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 469.36179089546204, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 33.851351351351354, "ram_util_percent": 83.04594594594596}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.734589619996647, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.9783500410616397, "policy_loss": -0.019828203862319545, "vf_loss": 3.9959765896201134, "vf_explained_var": 0.17557647861540318, "kl": 0.011008196151427304, "entropy": 1.4151994343847036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.78021356401344, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.626722151537736, "policy_loss": -0.020245593375026752, "vf_loss": 6.64433223704497, "vf_explained_var": 0.15204641899714869, "kl": 0.013177497304665546, "entropy": 1.427336041132609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 39.50000000000029, "episode_reward_mean": 302.179, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -137.14438440454637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 222.04652045061644, "predator_policy": 80.13247954938359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [255.2, 314.0999999999998, 280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994, 328.3, 381.0, 390.0, 376.2, 303.6, 347.3, 340.2, 388.3, 367.0, 331.4, 336.5, 293.4, 341.0, 332.5, 236.9999999999999, 359.29999999999995, 353.29999999999995, 378.0, 170.79999999999995, 247.79999999999995, 239.19999999999996, 364.8, 325.1, 368.0, 334.8, 261.0, 281.0, 328.0, 135.19999999999993, 327.0, 381.0, 336.0, 340.29999999999995, 363.1, 310.2, 379.50000000000006, 247.40000000000003, 336.0, 279.1, 345.0, 292.0, 122.10000000000014, 348.8, 375.5, 370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [96.82229178881775, 191.55035825848557, 229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317, 177.4556143564789, 335.8533773779967, 379.4776171465087, 352.4586836782329, 185.89712568601936, 328.69965877758295, 282.94715454309244, 379.3570517302454, 312.66421838817075, 303.4647148543097, 320.5622288064585, 98.92332613773446, 289.4460979864777, 272.76790913425486, -48.453057212970464, 308.16054348788805, 342.97325987800866, 365.26369866794676, 60.941265918453766, 20.947256695370367, 174.34313963498087, 335.81745873879254, 258.38366731314824, 329.92179315573225, 269.4247960316918, 104.46848395513717, 131.0437837222272, 190.913472822511, -97.5701591269817, 256.3818596772965, 348.89402010975766, 235.1392711901677, 269.34623493180766, 298.07912542204406, 280.3587669606932, 349.31754365064853, 59.63514166764273, 226.7426849726693, 87.25652551229494, 274.20407148349796, 133.583716913102, 102.50957872273563, 303.77364486680005, 373.4955471954398, 340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545], "policy_predator_policy_reward": [158.37770821118193, 122.54964174151446, 51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829, 150.84438564352106, 45.14662262200331, 10.522382853491301, 23.74131632176717, 117.70287431398049, 18.60034122241706, 57.252845456907544, 8.942948269754595, 54.335781611829226, 27.93528514569027, 15.937771193541503, 194.47667386226547, 51.55390201352231, 59.73209086574522, 285.45305721297046, 51.13945651211194, 10.326740121991246, 12.736301332053243, 109.85873408154615, 226.85274330462968, 64.85686036501907, 28.982541261207473, 66.71633268685181, 38.07820684426781, 65.37520396830817, 156.5315160448628, 149.95621627777285, 137.08652717748893, 232.77015912698164, 70.61814032270343, 32.10597989024232, 100.86072880983235, 70.95376506819221, 65.02087457795592, 29.84123303930682, 30.18245634935143, 187.76485833235753, 109.2573150273306, 191.8434744877051, 70.795928516502, 158.4162830868981, 19.590421277264458, 45.026355133199964, 2.004452804560131, 29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7575828637822997, "mean_inference_ms": 4.642837480388371, "mean_action_processing_ms": 1.713598293409064, "mean_env_wait_ms": 10.219093783509411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032373666763305664, "StateBufferConnector_ms": 0.013074398040771484, "ViewRequirementAgentConnector_ms": 0.1296018362045288}, "num_episodes": 0, "episode_return_max": 400.0, "episode_return_min": 39.50000000000029, "episode_return_mean": 302.179, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.3455908318522, "num_env_steps_trained_throughput_per_sec": 155.3455908318522, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 27266.448, "restore_workers_time_ms": 0.052, "training_step_time_ms": 27266.024, "sample_time_ms": 2469.048, "learn_time_ms": 24765.599, "learn_throughput": 161.514, "synch_weights_time_ms": 24.902}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 18, "trial_id": "cbf82_00000", "date": "2024-08-21_13-15-19", "timestamp": 1724226319, "time_this_iter_s": 25.804023027420044, "time_total_s": 495.1658139228821, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075745e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 495.1658139228821, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 32.39722222222222, "ram_util_percent": 83.16111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.681932615240415, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.7769006875654063, "policy_loss": -0.018194649907430478, "vf_loss": 3.7921162180602552, "vf_explained_var": 0.18697262611240148, "kl": 0.014895533523182772, "entropy": 1.3860685016959906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.572189246118068, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.013784428437551, "policy_loss": -0.021171157258262005, "vf_loss": 6.03215981622537, "vf_explained_var": 0.1449748232960701, "kl": 0.013978978019198014, "entropy": 1.4134466571112474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 39.50000000000029, "episode_reward_mean": 302.85, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -137.14438440454637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 289.64438440455035}, "policy_reward_mean": {"prey_policy": 223.7196420974829, "predator_policy": 79.13035790251709}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.19999999999993, 306.59999999999997, 313.0, 104.19999999999968, 209.7, 151.09999999999997, 364.6, 280.20000000000005, 345.20000000000016, 67.90000000000015, 202.49999999999955, 376.1, 39.50000000000029, 152.49999999999997, 183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994, 328.3, 381.0, 390.0, 376.2, 303.6, 347.3, 340.2, 388.3, 367.0, 331.4, 336.5, 293.4, 341.0, 332.5, 236.9999999999999, 359.29999999999995, 353.29999999999995, 378.0, 170.79999999999995, 247.79999999999995, 239.19999999999996, 364.8, 325.1, 368.0, 334.8, 261.0, 281.0, 328.0, 135.19999999999993, 327.0, 381.0, 336.0, 340.29999999999995, 363.1, 310.2, 379.50000000000006, 247.40000000000003, 336.0, 279.1, 345.0, 292.0, 122.10000000000014, 348.8, 375.5, 370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002, 284.0, 352.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [229.14742117391967, 232.02984838519407, 175.72348317586392, -94.17723399410632, -0.7579140251547756, 14.480617899778395, 298.9028102713662, 234.97991552584887, 336.8500758991389, -68.40427763517322, -17.02796965785819, 348.78129559428714, 35.155999204918785, -137.14438440454637, 182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317, 177.4556143564789, 335.8533773779967, 379.4776171465087, 352.4586836782329, 185.89712568601936, 328.69965877758295, 282.94715454309244, 379.3570517302454, 312.66421838817075, 303.4647148543097, 320.5622288064585, 98.92332613773446, 289.4460979864777, 272.76790913425486, -48.453057212970464, 308.16054348788805, 342.97325987800866, 365.26369866794676, 60.941265918453766, 20.947256695370367, 174.34313963498087, 335.81745873879254, 258.38366731314824, 329.92179315573225, 269.4247960316918, 104.46848395513717, 131.0437837222272, 190.913472822511, -97.5701591269817, 256.3818596772965, 348.89402010975766, 235.1392711901677, 269.34623493180766, 298.07912542204406, 280.3587669606932, 349.31754365064853, 59.63514166764273, 226.7426849726693, 87.25652551229494, 274.20407148349796, 133.583716913102, 102.50957872273563, 303.77364486680005, 373.4955471954398, 340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545, 163.92350887866047, 291.7613058552932], "policy_predator_policy_reward": [51.05257882608029, 74.57015161480571, 137.2765168241361, 198.37723399410632, 210.45791402515425, 136.61938210022163, 65.69718972863379, 45.22008447415127, 8.349924100861266, 136.30427763517318, 219.527969657858, 27.318704405712857, 4.344000795081432, 289.64438440455035, 1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829, 150.84438564352106, 45.14662262200331, 10.522382853491301, 23.74131632176717, 117.70287431398049, 18.60034122241706, 57.252845456907544, 8.942948269754595, 54.335781611829226, 27.93528514569027, 15.937771193541503, 194.47667386226547, 51.55390201352231, 59.73209086574522, 285.45305721297046, 51.13945651211194, 10.326740121991246, 12.736301332053243, 109.85873408154615, 226.85274330462968, 64.85686036501907, 28.982541261207473, 66.71633268685181, 38.07820684426781, 65.37520396830817, 156.5315160448628, 149.95621627777285, 137.08652717748893, 232.77015912698164, 70.61814032270343, 32.10597989024232, 100.86072880983235, 70.95376506819221, 65.02087457795592, 29.84123303930682, 30.18245634935143, 187.76485833235753, 109.2573150273306, 191.8434744877051, 70.795928516502, 158.4162830868981, 19.590421277264458, 45.026355133199964, 2.004452804560131, 29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196, 120.07649112133957, 60.63869414470694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.749921340610184, "mean_inference_ms": 4.630851067433871, "mean_action_processing_ms": 1.7314041920194407, "mean_env_wait_ms": 10.208531108632386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003242015838623047, "StateBufferConnector_ms": 0.013075470924377441, "ViewRequirementAgentConnector_ms": 0.12961053848266602}, "num_episodes": 2, "episode_return_max": 400.0, "episode_return_min": 39.50000000000029, "episode_return_mean": 302.85, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.63913840771315, "num_env_steps_trained_throughput_per_sec": 153.63913840771315, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 27010.227, "restore_workers_time_ms": 0.053, "training_step_time_ms": 27009.836, "sample_time_ms": 2424.071, "learn_time_ms": 24555.366, "learn_throughput": 162.897, "synch_weights_time_ms": 24.067}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 19, "trial_id": "cbf82_00000", "date": "2024-08-21_13-15-45", "timestamp": 1724226345, "time_this_iter_s": 26.059962034225464, "time_total_s": 521.2257759571075, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177de7b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 521.2257759571075, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 34.027027027027025, "ram_util_percent": 82.93513513513513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.893040990705291, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.129865533361833, "policy_loss": -0.01516485051009416, "vf_loss": 4.142833641419808, "vf_explained_var": 0.1666968997567892, "kl": 0.010983651227434166, "entropy": 1.3826650024702152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.5028874065727, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.3452495947480205, "policy_loss": -0.02032857837936414, "vf_loss": 6.362947005033493, "vf_explained_var": 0.1365885763739546, "kl": 0.013155885341014558, "entropy": 1.3780901492883761, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 39.700000000000195, "episode_reward_mean": 312.806, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -123.624003834293, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 285.45305721297046}, "policy_reward_mean": {"prey_policy": 235.1774345858538, "predator_policy": 77.62856541414614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.90000000000026, 274.4, 301.19999999999993, 218.89999999999998, 240.89999999999986, 358.79999999999995, 350.29999999999995, 277.5, 248.60000000000016, 225.79999999999913, 39.700000000000195, 374.99999999999994, 328.3, 381.0, 390.0, 376.2, 303.6, 347.3, 340.2, 388.3, 367.0, 331.4, 336.5, 293.4, 341.0, 332.5, 236.9999999999999, 359.29999999999995, 353.29999999999995, 378.0, 170.79999999999995, 247.79999999999995, 239.19999999999996, 364.8, 325.1, 368.0, 334.8, 261.0, 281.0, 328.0, 135.19999999999993, 327.0, 381.0, 336.0, 340.29999999999995, 363.1, 310.2, 379.50000000000006, 247.40000000000003, 336.0, 279.1, 345.0, 292.0, 122.10000000000014, 348.8, 375.5, 370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002, 284.0, 352.4, 332.4, 267.4, 306.0, 285.59999999999997, 330.4, 290.1, 245.0, 353.9, 209.19999999999996, 283.7000000000003, 300.1, 336.1, 373.0, 276.0000000000007], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [182.80033820941028, 118.371900946192, 142.18217403944612, 146.42227292851766, 163.69255292769506, 351.7850833497563, 348.6257039421252, 212.3980245699534, 162.4397675923526, 194.48286314476627, -123.624003834293, 331.8211203841317, 177.4556143564789, 335.8533773779967, 379.4776171465087, 352.4586836782329, 185.89712568601936, 328.69965877758295, 282.94715454309244, 379.3570517302454, 312.66421838817075, 303.4647148543097, 320.5622288064585, 98.92332613773446, 289.4460979864777, 272.76790913425486, -48.453057212970464, 308.16054348788805, 342.97325987800866, 365.26369866794676, 60.941265918453766, 20.947256695370367, 174.34313963498087, 335.81745873879254, 258.38366731314824, 329.92179315573225, 269.4247960316918, 104.46848395513717, 131.0437837222272, 190.913472822511, -97.5701591269817, 256.3818596772965, 348.89402010975766, 235.1392711901677, 269.34623493180766, 298.07912542204406, 280.3587669606932, 349.31754365064853, 59.63514166764273, 226.7426849726693, 87.25652551229494, 274.20407148349796, 133.583716913102, 102.50957872273563, 303.77364486680005, 373.4955471954398, 340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545, 163.92350887866047, 291.7613058552932, 252.77620522584277, 112.27580538536024, 155.49402005545025, 138.7783548238629, 236.27993437533559, 138.760407905531, 74.24810859883584, 314.8700219591731, 121.69276412286071, 172.04326555349635, 273.45354024586845, 239.66838282449027, 353.12018319094364, 150.8579419835173], "policy_predator_policy_reward": [1.0996617905899655, 156.02809905380767, 159.0178259605537, 72.47772707148246, 77.20744707230486, 7.014916650243738, 1.6742960578747212, 65.10197543004665, 86.16023240764757, 31.317136855233972, 163.32400383429118, 43.17887961586829, 150.84438564352106, 45.14662262200331, 10.522382853491301, 23.74131632176717, 117.70287431398049, 18.60034122241706, 57.252845456907544, 8.942948269754595, 54.335781611829226, 27.93528514569027, 15.937771193541503, 194.47667386226547, 51.55390201352231, 59.73209086574522, 285.45305721297046, 51.13945651211194, 10.326740121991246, 12.736301332053243, 109.85873408154615, 226.85274330462968, 64.85686036501907, 28.982541261207473, 66.71633268685181, 38.07820684426781, 65.37520396830817, 156.5315160448628, 149.95621627777285, 137.08652717748893, 232.77015912698164, 70.61814032270343, 32.10597989024232, 100.86072880983235, 70.95376506819221, 65.02087457795592, 29.84123303930682, 30.18245634935143, 187.76485833235753, 109.2573150273306, 191.8434744877051, 70.795928516502, 158.4162830868981, 19.590421277264458, 45.026355133199964, 2.004452804560131, 29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196, 120.07649112133957, 60.63869414470694, 79.62379477415719, 155.12419461463975, 150.5059799445497, 146.82164517613714, 94.12006562466443, 151.33959209446894, 170.75189140116422, 39.029978040826975, 87.5072358771392, 111.65673444650353, 26.64645975413164, 96.43161717550971, 19.879816809056493, 125.14205801648252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6281428005987864, "mean_inference_ms": 4.636840812930409, "mean_action_processing_ms": 1.7966133549198233, "mean_env_wait_ms": 10.168470837353231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003238081932067871, "StateBufferConnector_ms": 0.004432320594787598, "ViewRequirementAgentConnector_ms": 0.14395439624786377}, "num_episodes": 14, "episode_return_max": 400.0, "episode_return_min": 39.700000000000195, "episode_return_mean": 312.806, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.3849422064111, "num_env_steps_trained_throughput_per_sec": 137.3849422064111, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 27196.016, "restore_workers_time_ms": 0.053, "training_step_time_ms": 27195.592, "sample_time_ms": 2429.115, "learn_time_ms": 24736.265, "learn_throughput": 161.706, "synch_weights_time_ms": 23.877}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 20, "trial_id": "cbf82_00000", "date": "2024-08-21_13-16-14", "timestamp": 1724226374, "time_this_iter_s": 29.136345863342285, "time_total_s": 550.3621218204498, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e37700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 550.3621218204498, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 43.826190476190476, "ram_util_percent": 83.12380952380954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.210698736210664, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.133036795258522, "policy_loss": -0.016737934387492714, "vf_loss": 5.147368373225133, "vf_explained_var": 0.1796927310526371, "kl": 0.012031873308539312, "entropy": 1.292335209995508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.9209907853355, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.843528692921002, "policy_loss": -0.018506403412175132, "vf_loss": 6.859417406717936, "vf_explained_var": 0.13768845585485298, "kl": 0.013088423676284341, "entropy": 1.3132848422974348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 75.40000000000009, "episode_reward_mean": 311.908, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -110.47743205226892, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 311.0839978184726}, "policy_reward_mean": {"prey_policy": 227.27119107110036, "predator_policy": 84.63680892889964}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.3, 340.2, 388.3, 367.0, 331.4, 336.5, 293.4, 341.0, 332.5, 236.9999999999999, 359.29999999999995, 353.29999999999995, 378.0, 170.79999999999995, 247.79999999999995, 239.19999999999996, 364.8, 325.1, 368.0, 334.8, 261.0, 281.0, 328.0, 135.19999999999993, 327.0, 381.0, 336.0, 340.29999999999995, 363.1, 310.2, 379.50000000000006, 247.40000000000003, 336.0, 279.1, 345.0, 292.0, 122.10000000000014, 348.8, 375.5, 370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002, 284.0, 352.4, 332.4, 267.4, 306.0, 285.59999999999997, 330.4, 290.1, 245.0, 353.9, 209.19999999999996, 283.7000000000003, 300.1, 336.1, 373.0, 276.0000000000007, 86.9999999999996, 387.7, 394.3, 266.6, 294.0, 149.29999999999995, 305.1, 209.29999999999998, 126.30000000000004, 315.8, 337.8, 244.39999999999998, 341.3000000000003, 334.7, 237.99999999999994, 397.0, 355.7], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [328.69965877758295, 282.94715454309244, 379.3570517302454, 312.66421838817075, 303.4647148543097, 320.5622288064585, 98.92332613773446, 289.4460979864777, 272.76790913425486, -48.453057212970464, 308.16054348788805, 342.97325987800866, 365.26369866794676, 60.941265918453766, 20.947256695370367, 174.34313963498087, 335.81745873879254, 258.38366731314824, 329.92179315573225, 269.4247960316918, 104.46848395513717, 131.0437837222272, 190.913472822511, -97.5701591269817, 256.3818596772965, 348.89402010975766, 235.1392711901677, 269.34623493180766, 298.07912542204406, 280.3587669606932, 349.31754365064853, 59.63514166764273, 226.7426849726693, 87.25652551229494, 274.20407148349796, 133.583716913102, 102.50957872273563, 303.77364486680005, 373.4955471954398, 340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545, 163.92350887866047, 291.7613058552932, 252.77620522584277, 112.27580538536024, 155.49402005545025, 138.7783548238629, 236.27993437533559, 138.760407905531, 74.24810859883584, 314.8700219591731, 121.69276412286071, 172.04326555349635, 273.45354024586845, 239.66838282449027, 353.12018319094364, 150.8579419835173, -1.870397531995116, 373.2087065776735, 390.6272394566869, 31.818110438335182, 153.20360747872652, 39.35127620627225, 202.3283480102578, -101.78399781847263, 21.060988415110252, 224.9436034977248, 300.59169731670636, -13.267092581065837, 291.4703063975945, 265.0732587336157, -51.033719283101576, 393.8443066190275, 352.3496230368439], "policy_predator_policy_reward": [18.60034122241706, 57.252845456907544, 8.942948269754595, 54.335781611829226, 27.93528514569027, 15.937771193541503, 194.47667386226547, 51.55390201352231, 59.73209086574522, 285.45305721297046, 51.13945651211194, 10.326740121991246, 12.736301332053243, 109.85873408154615, 226.85274330462968, 64.85686036501907, 28.982541261207473, 66.71633268685181, 38.07820684426781, 65.37520396830817, 156.5315160448628, 149.95621627777285, 137.08652717748893, 232.77015912698164, 70.61814032270343, 32.10597989024232, 100.86072880983235, 70.95376506819221, 65.02087457795592, 29.84123303930682, 30.18245634935143, 187.76485833235753, 109.2573150273306, 191.8434744877051, 70.795928516502, 158.4162830868981, 19.590421277264458, 45.026355133199964, 2.004452804560131, 29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196, 120.07649112133957, 60.63869414470694, 79.62379477415719, 155.12419461463975, 150.5059799445497, 146.82164517613714, 94.12006562466443, 151.33959209446894, 170.75189140116422, 39.029978040826975, 87.5072358771392, 111.65673444650353, 26.64645975413164, 96.43161717550971, 19.879816809056493, 125.14205801648252, 88.87039753199515, 14.49129342232646, 3.672760543313154, 234.78188956166494, 140.79639252127348, 109.94872379372761, 102.77165198974215, 311.0839978184726, 105.23901158488978, 90.85639650227508, 37.20830268329361, 257.6670925810661, 49.82969360240574, 69.62674126638423, 289.0337192831016, 3.155693380972461, 3.3503769631560694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5205571332858288, "mean_inference_ms": 4.569283789053538, "mean_action_processing_ms": 1.8048905523551133, "mean_env_wait_ms": 10.119827912857351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032444000244140625, "StateBufferConnector_ms": 0.004273772239685059, "ViewRequirementAgentConnector_ms": 0.12759661674499512}, "num_episodes": 17, "episode_return_max": 400.0, "episode_return_min": 75.40000000000009, "episode_return_mean": 311.908, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.25395044720585, "num_env_steps_trained_throughput_per_sec": 153.25395044720585, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 26941.467, "restore_workers_time_ms": 0.048, "training_step_time_ms": 26941.078, "sample_time_ms": 2351.87, "learn_time_ms": 24559.236, "learn_throughput": 162.872, "synch_weights_time_ms": 23.717}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 21, "trial_id": "cbf82_00000", "date": "2024-08-21_13-16-41", "timestamp": 1724226401, "time_this_iter_s": 26.142009258270264, "time_total_s": 576.5041310787201, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e5a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 576.5041310787201, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 32.23243243243244, "ram_util_percent": 82.80540540540541}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.3095241298278175, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.431325108309587, "policy_loss": -0.01858128507640989, "vf_loss": 5.446438991526763, "vf_explained_var": 0.14097230272988479, "kl": 0.017336923450784525, "entropy": 1.2430852541079125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.746833334614832, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.640101855496566, "policy_loss": -0.020230959579445578, "vf_loss": 6.656826941172282, "vf_explained_var": 0.1766544369980693, "kl": 0.017529238340406057, "entropy": 1.291537944972515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 75.40000000000009, "episode_reward_mean": 305.086, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -113.49656014418906, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 317.79656014418896}, "policy_reward_mean": {"prey_policy": 208.6579171704413, "predator_policy": 96.42808282955868}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.19999999999996, 364.8, 325.1, 368.0, 334.8, 261.0, 281.0, 328.0, 135.19999999999993, 327.0, 381.0, 336.0, 340.29999999999995, 363.1, 310.2, 379.50000000000006, 247.40000000000003, 336.0, 279.1, 345.0, 292.0, 122.10000000000014, 348.8, 375.5, 370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002, 284.0, 352.4, 332.4, 267.4, 306.0, 285.59999999999997, 330.4, 290.1, 245.0, 353.9, 209.19999999999996, 283.7000000000003, 300.1, 336.1, 373.0, 276.0000000000007, 86.9999999999996, 387.7, 394.3, 266.6, 294.0, 149.29999999999995, 305.1, 209.29999999999998, 126.30000000000004, 315.8, 337.8, 244.39999999999998, 341.3000000000003, 334.7, 237.99999999999994, 397.0, 355.7, 312.79999999999995, 326.79999999999995, 308.0, 263.7000000000001, 204.3, 235.1, 286.29999999999995, 285.1, 274.3, 200.5, 260.4, 296.79999999999995, 308.5000000000001, 304.0, 275.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [174.34313963498087, 335.81745873879254, 258.38366731314824, 329.92179315573225, 269.4247960316918, 104.46848395513717, 131.0437837222272, 190.913472822511, -97.5701591269817, 256.3818596772965, 348.89402010975766, 235.1392711901677, 269.34623493180766, 298.07912542204406, 280.3587669606932, 349.31754365064853, 59.63514166764273, 226.7426849726693, 87.25652551229494, 274.20407148349796, 133.583716913102, 102.50957872273563, 303.77364486680005, 373.4955471954398, 340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545, 163.92350887866047, 291.7613058552932, 252.77620522584277, 112.27580538536024, 155.49402005545025, 138.7783548238629, 236.27993437533559, 138.760407905531, 74.24810859883584, 314.8700219591731, 121.69276412286071, 172.04326555349635, 273.45354024586845, 239.66838282449027, 353.12018319094364, 150.8579419835173, -1.870397531995116, 373.2087065776735, 390.6272394566869, 31.818110438335182, 153.20360747872652, 39.35127620627225, 202.3283480102578, -101.78399781847263, 21.060988415110252, 224.9436034977248, 300.59169731670636, -13.267092581065837, 291.4703063975945, 265.0732587336157, -51.033719283101576, 393.8443066190275, 352.3496230368439, 295.07179132265287, 296.4831913307652, 126.01244188256888, 123.20171163075842, -113.49656014418906, -71.24103263586741, 274.9409495382075, 130.9689719471551, 65.47461851243031, -97.99010957099566, 30.44591797499647, 290.6738642551198, 199.78279543284003, 141.4392627564002, 85.57012349427711], "policy_predator_policy_reward": [64.85686036501907, 28.982541261207473, 66.71633268685181, 38.07820684426781, 65.37520396830817, 156.5315160448628, 149.95621627777285, 137.08652717748893, 232.77015912698164, 70.61814032270343, 32.10597989024232, 100.86072880983235, 70.95376506819221, 65.02087457795592, 29.84123303930682, 30.18245634935143, 187.76485833235753, 109.2573150273306, 191.8434744877051, 70.795928516502, 158.4162830868981, 19.590421277264458, 45.026355133199964, 2.004452804560131, 29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196, 120.07649112133957, 60.63869414470694, 79.62379477415719, 155.12419461463975, 150.5059799445497, 146.82164517613714, 94.12006562466443, 151.33959209446894, 170.75189140116422, 39.029978040826975, 87.5072358771392, 111.65673444650353, 26.64645975413164, 96.43161717550971, 19.879816809056493, 125.14205801648252, 88.87039753199515, 14.49129342232646, 3.672760543313154, 234.78188956166494, 140.79639252127348, 109.94872379372761, 102.77165198974215, 311.0839978184726, 105.23901158488978, 90.85639650227508, 37.20830268329361, 257.6670925810661, 49.82969360240574, 69.62674126638423, 289.0337192831016, 3.155693380972461, 3.3503769631560694, 17.728208677347087, 30.31680866923493, 181.9875581174311, 140.49828836924158, 317.79656014418896, 306.34103263586735, 11.359050461792464, 154.13102805284484, 208.82538148756967, 298.4901095709956, 229.95408202500366, 6.126135744880239, 108.71720456715995, 162.56073724359976, 189.42987650572286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4518292089272773, "mean_inference_ms": 4.456592542742886, "mean_action_processing_ms": 1.7440864058972674, "mean_env_wait_ms": 10.089475290321102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030813217163085938, "StateBufferConnector_ms": 0.0041120052337646484, "ViewRequirementAgentConnector_ms": 0.11900556087493896}, "num_episodes": 15, "episode_return_max": 400.0, "episode_return_min": 75.40000000000009, "episode_return_mean": 305.086, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.4952659831267, "num_env_steps_trained_throughput_per_sec": 162.4952659831267, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 26375.656, "restore_workers_time_ms": 0.048, "training_step_time_ms": 26375.24, "sample_time_ms": 2008.877, "learn_time_ms": 24337.289, "learn_throughput": 164.357, "synch_weights_time_ms": 23.168}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 22, "trial_id": "cbf82_00000", "date": "2024-08-21_13-17-05", "timestamp": 1724226425, "time_this_iter_s": 24.6305410861969, "time_total_s": 601.134672164917, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x307570ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 601.134672164917, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.711428571428566, "ram_util_percent": 82.11999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.763286020979285, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.381381958474716, "policy_loss": -0.01778167324324992, "vf_loss": 4.396141343563795, "vf_explained_var": 0.17645382154732941, "kl": 0.01511149115928371, "entropy": 1.2566404594729343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.372284715125959, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.3222357630729675, "policy_loss": -0.018949471592592696, "vf_loss": 6.337715568641822, "vf_explained_var": 0.15485363670935234, "kl": 0.01734823193740643, "entropy": 1.3029112828274567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 75.40000000000009, "episode_reward_mean": 302.57500000000005, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -113.49656014418906, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 332.8427839114136}, "policy_reward_mean": {"prey_policy": 197.42366791598263, "predator_policy": 105.15133208401733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.0, 122.10000000000014, 348.8, 375.5, 370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002, 284.0, 352.4, 332.4, 267.4, 306.0, 285.59999999999997, 330.4, 290.1, 245.0, 353.9, 209.19999999999996, 283.7000000000003, 300.1, 336.1, 373.0, 276.0000000000007, 86.9999999999996, 387.7, 394.3, 266.6, 294.0, 149.29999999999995, 305.1, 209.29999999999998, 126.30000000000004, 315.8, 337.8, 244.39999999999998, 341.3000000000003, 334.7, 237.99999999999994, 397.0, 355.7, 312.79999999999995, 326.79999999999995, 308.0, 263.7000000000001, 204.3, 235.1, 286.29999999999995, 285.1, 274.3, 200.5, 260.4, 296.79999999999995, 308.5000000000001, 304.0, 275.0, 250.0, 218.99999999999994, 356.6, 389.5, 301.79999999999995, 285.5000000000001, 370.5, 254.2, 384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [133.583716913102, 102.50957872273563, 303.77364486680005, 373.4955471954398, 340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545, 163.92350887866047, 291.7613058552932, 252.77620522584277, 112.27580538536024, 155.49402005545025, 138.7783548238629, 236.27993437533559, 138.760407905531, 74.24810859883584, 314.8700219591731, 121.69276412286071, 172.04326555349635, 273.45354024586845, 239.66838282449027, 353.12018319094364, 150.8579419835173, -1.870397531995116, 373.2087065776735, 390.6272394566869, 31.818110438335182, 153.20360747872652, 39.35127620627225, 202.3283480102578, -101.78399781847263, 21.060988415110252, 224.9436034977248, 300.59169731670636, -13.267092581065837, 291.4703063975945, 265.0732587336157, -51.033719283101576, 393.8443066190275, 352.3496230368439, 295.07179132265287, 296.4831913307652, 126.01244188256888, 123.20171163075842, -113.49656014418906, -71.24103263586741, 274.9409495382075, 130.9689719471551, 65.47461851243031, -97.99010957099566, 30.44591797499647, 290.6738642551198, 199.78279543284003, 141.4392627564002, 85.57012349427711, 43.41491299087697, -69.20248893006338, 308.1887427968617, 382.26026110431417, 148.16485331127473, 143.57172189880126, 359.09096304040867, -33.283713919335014, 336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868], "policy_predator_policy_reward": [158.4162830868981, 19.590421277264458, 45.026355133199964, 2.004452804560131, 29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196, 120.07649112133957, 60.63869414470694, 79.62379477415719, 155.12419461463975, 150.5059799445497, 146.82164517613714, 94.12006562466443, 151.33959209446894, 170.75189140116422, 39.029978040826975, 87.5072358771392, 111.65673444650353, 26.64645975413164, 96.43161717550971, 19.879816809056493, 125.14205801648252, 88.87039753199515, 14.49129342232646, 3.672760543313154, 234.78188956166494, 140.79639252127348, 109.94872379372761, 102.77165198974215, 311.0839978184726, 105.23901158488978, 90.85639650227508, 37.20830268329361, 257.6670925810661, 49.82969360240574, 69.62674126638423, 289.0337192831016, 3.155693380972461, 3.3503769631560694, 17.728208677347087, 30.31680866923493, 181.9875581174311, 140.49828836924158, 317.79656014418896, 306.34103263586735, 11.359050461792464, 154.13102805284484, 208.82538148756967, 298.4901095709956, 229.95408202500366, 6.126135744880239, 108.71720456715995, 162.56073724359976, 189.42987650572286, 206.58508700912301, 288.20248893006345, 48.41125720313829, 7.239738895685835, 153.63514668872529, 141.9282781011987, 11.409036959591326, 287.48371391933495, 48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3465531263690615, "mean_inference_ms": 4.3516490915804535, "mean_action_processing_ms": 1.631996061281344, "mean_env_wait_ms": 10.068600851972723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003118157386779785, "StateBufferConnector_ms": 0.004023432731628418, "ViewRequirementAgentConnector_ms": 0.1099855899810791}, "num_episodes": 20, "episode_return_max": 400.0, "episode_return_min": 75.40000000000009, "episode_return_mean": 302.57500000000005, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.27941777772682, "num_env_steps_trained_throughput_per_sec": 160.27941777772682, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 26261.069, "restore_workers_time_ms": 0.047, "training_step_time_ms": 26260.658, "sample_time_ms": 1991.387, "learn_time_ms": 24241.214, "learn_throughput": 165.008, "synch_weights_time_ms": 22.484}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 23, "trial_id": "cbf82_00000", "date": "2024-08-21_13-17-30", "timestamp": 1724226450, "time_this_iter_s": 24.997770071029663, "time_total_s": 626.1324422359467, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30755ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 626.1324422359467, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.172222222222224, "ram_util_percent": 82.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.251579755047957, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.928262700637181, "policy_loss": -0.016216700048729157, "vf_loss": 5.941648733615875, "vf_explained_var": 0.16243290510028602, "kl": 0.014153300040440324, "entropy": 1.171647143177688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.173049891491731, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.201801939308643, "policy_loss": -0.020740183827971728, "vf_loss": 7.219249119857947, "vf_explained_var": 0.16079781583199898, "kl": 0.016464872205688152, "entropy": 1.2502452254295349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 75.40000000000009, "episode_reward_mean": 299.51099999999997, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -346.68726495023054, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 455.88726495023064}, "policy_reward_mean": {"prey_policy": 187.7470715896231, "predator_policy": 111.76392841037692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002, 284.0, 352.4, 332.4, 267.4, 306.0, 285.59999999999997, 330.4, 290.1, 245.0, 353.9, 209.19999999999996, 283.7000000000003, 300.1, 336.1, 373.0, 276.0000000000007, 86.9999999999996, 387.7, 394.3, 266.6, 294.0, 149.29999999999995, 305.1, 209.29999999999998, 126.30000000000004, 315.8, 337.8, 244.39999999999998, 341.3000000000003, 334.7, 237.99999999999994, 397.0, 355.7, 312.79999999999995, 326.79999999999995, 308.0, 263.7000000000001, 204.3, 235.1, 286.29999999999995, 285.1, 274.3, 200.5, 260.4, 296.79999999999995, 308.5000000000001, 304.0, 275.0, 250.0, 218.99999999999994, 356.6, 389.5, 301.79999999999995, 285.5000000000001, 370.5, 254.2, 384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545, 163.92350887866047, 291.7613058552932, 252.77620522584277, 112.27580538536024, 155.49402005545025, 138.7783548238629, 236.27993437533559, 138.760407905531, 74.24810859883584, 314.8700219591731, 121.69276412286071, 172.04326555349635, 273.45354024586845, 239.66838282449027, 353.12018319094364, 150.8579419835173, -1.870397531995116, 373.2087065776735, 390.6272394566869, 31.818110438335182, 153.20360747872652, 39.35127620627225, 202.3283480102578, -101.78399781847263, 21.060988415110252, 224.9436034977248, 300.59169731670636, -13.267092581065837, 291.4703063975945, 265.0732587336157, -51.033719283101576, 393.8443066190275, 352.3496230368439, 295.07179132265287, 296.4831913307652, 126.01244188256888, 123.20171163075842, -113.49656014418906, -71.24103263586741, 274.9409495382075, 130.9689719471551, 65.47461851243031, -97.99010957099566, 30.44591797499647, 290.6738642551198, 199.78279543284003, 141.4392627564002, 85.57012349427711, 43.41491299087697, -69.20248893006338, 308.1887427968617, 382.26026110431417, 148.16485331127473, 143.57172189880126, 359.09096304040867, -33.283713919335014, 336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054], "policy_predator_policy_reward": [29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196, 120.07649112133957, 60.63869414470694, 79.62379477415719, 155.12419461463975, 150.5059799445497, 146.82164517613714, 94.12006562466443, 151.33959209446894, 170.75189140116422, 39.029978040826975, 87.5072358771392, 111.65673444650353, 26.64645975413164, 96.43161717550971, 19.879816809056493, 125.14205801648252, 88.87039753199515, 14.49129342232646, 3.672760543313154, 234.78188956166494, 140.79639252127348, 109.94872379372761, 102.77165198974215, 311.0839978184726, 105.23901158488978, 90.85639650227508, 37.20830268329361, 257.6670925810661, 49.82969360240574, 69.62674126638423, 289.0337192831016, 3.155693380972461, 3.3503769631560694, 17.728208677347087, 30.31680866923493, 181.9875581174311, 140.49828836924158, 317.79656014418896, 306.34103263586735, 11.359050461792464, 154.13102805284484, 208.82538148756967, 298.4901095709956, 229.95408202500366, 6.126135744880239, 108.71720456715995, 162.56073724359976, 189.42987650572286, 206.58508700912301, 288.20248893006345, 48.41125720313829, 7.239738895685835, 153.63514668872529, 141.9282781011987, 11.409036959591326, 287.48371391933495, 48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.327821140735012, "mean_inference_ms": 4.2943544127527336, "mean_action_processing_ms": 1.6554471691982813, "mean_env_wait_ms": 10.063387561512966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028804540634155273, "StateBufferConnector_ms": 0.004382610321044922, "ViewRequirementAgentConnector_ms": 0.10957789421081543}, "num_episodes": 4, "episode_return_max": 400.0, "episode_return_min": 75.40000000000009, "episode_return_mean": 299.51099999999997, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.7968065422893, "num_env_steps_trained_throughput_per_sec": 161.7968065422893, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 26031.269, "restore_workers_time_ms": 0.047, "training_step_time_ms": 26030.875, "sample_time_ms": 1926.692, "learn_time_ms": 24077.802, "learn_throughput": 166.128, "synch_weights_time_ms": 22.481}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 24, "trial_id": "cbf82_00000", "date": "2024-08-21_13-17-55", "timestamp": 1724226475, "time_this_iter_s": 24.73652482032776, "time_total_s": 650.8689670562744, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075ab310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 650.8689670562744, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 28.668571428571433, "ram_util_percent": 82.74571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.413551480447253, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.122956046462059, "policy_loss": -0.014488679626083467, "vf_loss": 5.135045454402765, "vf_explained_var": 0.16016421243548393, "kl": 0.011996439621725585, "entropy": 1.2221735808998346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.087520948673289, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.913476631542047, "policy_loss": -0.020073478216848645, "vf_loss": 6.930765427649021, "vf_explained_var": 0.23995381363977988, "kl": 0.013923365176985196, "entropy": 1.2659847526500623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 75.40000000000009, "episode_reward_mean": 299.51099999999997, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -346.68726495023054, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 455.88726495023064}, "policy_reward_mean": {"prey_policy": 187.7470715896231, "predator_policy": 111.76392841037692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 322.6, 398.1, 387.1, 243.70000000000002, 324.29999999999995, 400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002, 284.0, 352.4, 332.4, 267.4, 306.0, 285.59999999999997, 330.4, 290.1, 245.0, 353.9, 209.19999999999996, 283.7000000000003, 300.1, 336.1, 373.0, 276.0000000000007, 86.9999999999996, 387.7, 394.3, 266.6, 294.0, 149.29999999999995, 305.1, 209.29999999999998, 126.30000000000004, 315.8, 337.8, 244.39999999999998, 341.3000000000003, 334.7, 237.99999999999994, 397.0, 355.7, 312.79999999999995, 326.79999999999995, 308.0, 263.7000000000001, 204.3, 235.1, 286.29999999999995, 285.1, 274.3, 200.5, 260.4, 296.79999999999995, 308.5000000000001, 304.0, 275.0, 250.0, 218.99999999999994, 356.6, 389.5, 301.79999999999995, 285.5000000000001, 370.5, 254.2, 384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [340.83962072383355, 252.5765276068043, 397.0302726432412, 351.70886557740516, 91.19588136469211, 323.33247868936473, 400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545, 163.92350887866047, 291.7613058552932, 252.77620522584277, 112.27580538536024, 155.49402005545025, 138.7783548238629, 236.27993437533559, 138.760407905531, 74.24810859883584, 314.8700219591731, 121.69276412286071, 172.04326555349635, 273.45354024586845, 239.66838282449027, 353.12018319094364, 150.8579419835173, -1.870397531995116, 373.2087065776735, 390.6272394566869, 31.818110438335182, 153.20360747872652, 39.35127620627225, 202.3283480102578, -101.78399781847263, 21.060988415110252, 224.9436034977248, 300.59169731670636, -13.267092581065837, 291.4703063975945, 265.0732587336157, -51.033719283101576, 393.8443066190275, 352.3496230368439, 295.07179132265287, 296.4831913307652, 126.01244188256888, 123.20171163075842, -113.49656014418906, -71.24103263586741, 274.9409495382075, 130.9689719471551, 65.47461851243031, -97.99010957099566, 30.44591797499647, 290.6738642551198, 199.78279543284003, 141.4392627564002, 85.57012349427711, 43.41491299087697, -69.20248893006338, 308.1887427968617, 382.26026110431417, 148.16485331127473, 143.57172189880126, 359.09096304040867, -33.283713919335014, 336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054], "policy_predator_policy_reward": [29.16037927616634, 70.02347239319575, 1.0697273567588264, 35.391134422594874, 152.50411863530786, 0.9675213106352365, 0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196, 120.07649112133957, 60.63869414470694, 79.62379477415719, 155.12419461463975, 150.5059799445497, 146.82164517613714, 94.12006562466443, 151.33959209446894, 170.75189140116422, 39.029978040826975, 87.5072358771392, 111.65673444650353, 26.64645975413164, 96.43161717550971, 19.879816809056493, 125.14205801648252, 88.87039753199515, 14.49129342232646, 3.672760543313154, 234.78188956166494, 140.79639252127348, 109.94872379372761, 102.77165198974215, 311.0839978184726, 105.23901158488978, 90.85639650227508, 37.20830268329361, 257.6670925810661, 49.82969360240574, 69.62674126638423, 289.0337192831016, 3.155693380972461, 3.3503769631560694, 17.728208677347087, 30.31680866923493, 181.9875581174311, 140.49828836924158, 317.79656014418896, 306.34103263586735, 11.359050461792464, 154.13102805284484, 208.82538148756967, 298.4901095709956, 229.95408202500366, 6.126135744880239, 108.71720456715995, 162.56073724359976, 189.42987650572286, 206.58508700912301, 288.20248893006345, 48.41125720313829, 7.239738895685835, 153.63514668872529, 141.9282781011987, 11.409036959591326, 287.48371391933495, 48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.327821140735012, "mean_inference_ms": 4.2943544127527336, "mean_action_processing_ms": 1.6554471691982813, "mean_env_wait_ms": 10.063387561512966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028804540634155273, "StateBufferConnector_ms": 0.004382610321044922, "ViewRequirementAgentConnector_ms": 0.10957789421081543}, "num_episodes": 0, "episode_return_max": 400.0, "episode_return_min": 75.40000000000009, "episode_return_mean": 299.51099999999997, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.07979160608528, "num_env_steps_trained_throughput_per_sec": 158.07979160608528, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 25924.342, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25924.081, "sample_time_ms": 1885.839, "learn_time_ms": 24012.021, "learn_throughput": 166.583, "synch_weights_time_ms": 22.713}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 25, "trial_id": "cbf82_00000", "date": "2024-08-21_13-18-20", "timestamp": 1724226500, "time_this_iter_s": 25.348478078842163, "time_total_s": 676.2174451351166, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e5af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 676.2174451351166, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.55833333333333, "ram_util_percent": 82.94722222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.026003345722954, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.589521717031797, "policy_loss": -0.008226182943811484, "vf_loss": 5.5956605389714245, "vf_explained_var": 0.1452724974602461, "kl": 0.010436895089757552, "entropy": 1.180006194114685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.73862510273854, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.86974895298481, "policy_loss": -0.018270653031747013, "vf_loss": 6.885404355327288, "vf_explained_var": 0.07821762654930353, "kl": 0.013076220187455571, "entropy": 1.2385094537089267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 75.40000000000009, "episode_reward_mean": 293.143, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -410.8700219256637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 518.9700219256634}, "policy_reward_mean": {"prey_policy": 170.35419772631195, "predator_policy": 122.78880227368803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 385.5, 356.3, 303.69999999999993, 339.29999999999995, 377.2, 359.6, 336.2, 361.5, 310.2, 363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002, 284.0, 352.4, 332.4, 267.4, 306.0, 285.59999999999997, 330.4, 290.1, 245.0, 353.9, 209.19999999999996, 283.7000000000003, 300.1, 336.1, 373.0, 276.0000000000007, 86.9999999999996, 387.7, 394.3, 266.6, 294.0, 149.29999999999995, 305.1, 209.29999999999998, 126.30000000000004, 315.8, 337.8, 244.39999999999998, 341.3000000000003, 334.7, 237.99999999999994, 397.0, 355.7, 312.79999999999995, 326.79999999999995, 308.0, 263.7000000000001, 204.3, 235.1, 286.29999999999995, 285.1, 274.3, 200.5, 260.4, 296.79999999999995, 308.5000000000001, 304.0, 275.0, 250.0, 218.99999999999994, 356.6, 389.5, 301.79999999999995, 285.5000000000001, 370.5, 254.2, 384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999, 333.9, 268.19999999999993, 268.5999999999999, 123.0, 307.19999999999993, 108.1], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [400.0, 342.70679460489544, 296.63327073832033, 214.93351810125492, 276.10277272972115, 374.0250006761921, 340.76297977669844, 230.91158360627344, 345.96377757581, 122.29637716783411, 316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545, 163.92350887866047, 291.7613058552932, 252.77620522584277, 112.27580538536024, 155.49402005545025, 138.7783548238629, 236.27993437533559, 138.760407905531, 74.24810859883584, 314.8700219591731, 121.69276412286071, 172.04326555349635, 273.45354024586845, 239.66838282449027, 353.12018319094364, 150.8579419835173, -1.870397531995116, 373.2087065776735, 390.6272394566869, 31.818110438335182, 153.20360747872652, 39.35127620627225, 202.3283480102578, -101.78399781847263, 21.060988415110252, 224.9436034977248, 300.59169731670636, -13.267092581065837, 291.4703063975945, 265.0732587336157, -51.033719283101576, 393.8443066190275, 352.3496230368439, 295.07179132265287, 296.4831913307652, 126.01244188256888, 123.20171163075842, -113.49656014418906, -71.24103263586741, 274.9409495382075, 130.9689719471551, 65.47461851243031, -97.99010957099566, 30.44591797499647, 290.6738642551198, 199.78279543284003, 141.4392627564002, 85.57012349427711, 43.41491299087697, -69.20248893006338, 308.1887427968617, 382.26026110431417, 148.16485331127473, 143.57172189880126, 359.09096304040867, -33.283713919335014, 336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054, 248.22928324342047, 175.71988050868976, 110.13805060774898, -267.06833916831675, 161.24740700834943, -410.8700219256637], "policy_predator_policy_reward": [0.0, 42.79320539510456, 59.666729261679684, 88.76648189874523, 63.19722727027882, 3.17499932380784, 18.837020223301483, 105.28841639372652, 15.53622242418995, 187.90362283216595, 47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196, 120.07649112133957, 60.63869414470694, 79.62379477415719, 155.12419461463975, 150.5059799445497, 146.82164517613714, 94.12006562466443, 151.33959209446894, 170.75189140116422, 39.029978040826975, 87.5072358771392, 111.65673444650353, 26.64645975413164, 96.43161717550971, 19.879816809056493, 125.14205801648252, 88.87039753199515, 14.49129342232646, 3.672760543313154, 234.78188956166494, 140.79639252127348, 109.94872379372761, 102.77165198974215, 311.0839978184726, 105.23901158488978, 90.85639650227508, 37.20830268329361, 257.6670925810661, 49.82969360240574, 69.62674126638423, 289.0337192831016, 3.155693380972461, 3.3503769631560694, 17.728208677347087, 30.31680866923493, 181.9875581174311, 140.49828836924158, 317.79656014418896, 306.34103263586735, 11.359050461792464, 154.13102805284484, 208.82538148756967, 298.4901095709956, 229.95408202500366, 6.126135744880239, 108.71720456715995, 162.56073724359976, 189.42987650572286, 206.58508700912301, 288.20248893006345, 48.41125720313829, 7.239738895685835, 153.63514668872529, 141.9282781011987, 11.409036959591326, 287.48371391933495, 48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064, 85.67071675657937, 92.48011949131029, 158.46194939225109, 390.0683391683163, 145.95259299165045, 518.9700219256634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.292290768500186, "mean_inference_ms": 4.2293126855854695, "mean_action_processing_ms": 1.6557103856029043, "mean_env_wait_ms": 10.063298610419201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002846240997314453, "StateBufferConnector_ms": 0.00422978401184082, "ViewRequirementAgentConnector_ms": 0.10943317413330078}, "num_episodes": 6, "episode_return_max": 400.0, "episode_return_min": 75.40000000000009, "episode_return_mean": 293.143, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.4214467246674, "num_env_steps_trained_throughput_per_sec": 148.4214467246674, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 25948.536, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25948.285, "sample_time_ms": 1906.473, "learn_time_ms": 24015.454, "learn_throughput": 166.559, "synch_weights_time_ms": 22.993}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 26, "trial_id": "cbf82_00000", "date": "2024-08-21_13-18-47", "timestamp": 1724226527, "time_this_iter_s": 26.98258900642395, "time_total_s": 703.2000341415405, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e5a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 703.2000341415405, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 36.044736842105266, "ram_util_percent": 82.56315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.675180630137523, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.878141553203265, "policy_loss": -0.010023346492865433, "vf_loss": 5.88585497935613, "vf_explained_var": 0.154858762336274, "kl": 0.011549614307538529, "entropy": 1.1421893366302054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.104576382103065, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.299237568676472, "policy_loss": -0.024521797026439647, "vf_loss": 7.32080237219731, "vf_explained_var": 0.16966936439275743, "kl": 0.014784981830356021, "entropy": 1.225401566301783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": 75.40000000000009, "episode_reward_mean": 280.466, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -410.8700219256637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.8443066190275, "predator_policy": 518.9700219256634}, "policy_reward_mean": {"prey_policy": 142.58397970658342, "predator_policy": 137.88202029341656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [363.1, 350.20000000000005, 339.6, 75.40000000000009, 287.0, 372.2, 377.7, 360.0, 373.6, 389.2, 363.29999999999995, 110.70000000000002, 284.0, 352.4, 332.4, 267.4, 306.0, 285.59999999999997, 330.4, 290.1, 245.0, 353.9, 209.19999999999996, 283.7000000000003, 300.1, 336.1, 373.0, 276.0000000000007, 86.9999999999996, 387.7, 394.3, 266.6, 294.0, 149.29999999999995, 305.1, 209.29999999999998, 126.30000000000004, 315.8, 337.8, 244.39999999999998, 341.3000000000003, 334.7, 237.99999999999994, 397.0, 355.7, 312.79999999999995, 326.79999999999995, 308.0, 263.7000000000001, 204.3, 235.1, 286.29999999999995, 285.1, 274.3, 200.5, 260.4, 296.79999999999995, 308.5000000000001, 304.0, 275.0, 250.0, 218.99999999999994, 356.6, 389.5, 301.79999999999995, 285.5000000000001, 370.5, 254.2, 384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999, 333.9, 268.19999999999993, 268.5999999999999, 123.0, 307.19999999999993, 108.1, 389.4, 231.0, 254.09999999999997, 103.09999999999997, 132.9000000000003, 185.69999999999996, 169.59999999999988, 297.2, 212.39999999999998, 286.39999999999975], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [316.0845896499346, 282.4141562753499, 284.5033344736527, -110.47743205226892, 212.6324873204262, 343.4620946369744, 347.56037000254906, 314.1882530737337, 370.07447300913964, 389.2, 320.1550614101981, -39.747115543319545, 163.92350887866047, 291.7613058552932, 252.77620522584277, 112.27580538536024, 155.49402005545025, 138.7783548238629, 236.27993437533559, 138.760407905531, 74.24810859883584, 314.8700219591731, 121.69276412286071, 172.04326555349635, 273.45354024586845, 239.66838282449027, 353.12018319094364, 150.8579419835173, -1.870397531995116, 373.2087065776735, 390.6272394566869, 31.818110438335182, 153.20360747872652, 39.35127620627225, 202.3283480102578, -101.78399781847263, 21.060988415110252, 224.9436034977248, 300.59169731670636, -13.267092581065837, 291.4703063975945, 265.0732587336157, -51.033719283101576, 393.8443066190275, 352.3496230368439, 295.07179132265287, 296.4831913307652, 126.01244188256888, 123.20171163075842, -113.49656014418906, -71.24103263586741, 274.9409495382075, 130.9689719471551, 65.47461851243031, -97.99010957099566, 30.44591797499647, 290.6738642551198, 199.78279543284003, 141.4392627564002, 85.57012349427711, 43.41491299087697, -69.20248893006338, 308.1887427968617, 382.26026110431417, 148.16485331127473, 143.57172189880126, 359.09096304040867, -33.283713919335014, 336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054, 248.22928324342047, 175.71988050868976, 110.13805060774898, -267.06833916831675, 161.24740700834943, -410.8700219256637, 379.47241553715884, -82.14623721236667, 35.50917809357182, -228.7409705759992, 10.736698847838277, -151.1429998676645, -99.64595347148692, 172.42272553916118, -58.36167076258008, 189.21108687651628], "policy_predator_policy_reward": [47.0154103500654, 67.78584372464996, 55.096665526347394, 185.877432052269, 74.36751267957351, 28.737905363025547, 30.139629997450967, 45.811746926266274, 3.5255269908603686, 0.0, 43.14493858980191, 150.4471155433196, 120.07649112133957, 60.63869414470694, 79.62379477415719, 155.12419461463975, 150.5059799445497, 146.82164517613714, 94.12006562466443, 151.33959209446894, 170.75189140116422, 39.029978040826975, 87.5072358771392, 111.65673444650353, 26.64645975413164, 96.43161717550971, 19.879816809056493, 125.14205801648252, 88.87039753199515, 14.49129342232646, 3.672760543313154, 234.78188956166494, 140.79639252127348, 109.94872379372761, 102.77165198974215, 311.0839978184726, 105.23901158488978, 90.85639650227508, 37.20830268329361, 257.6670925810661, 49.82969360240574, 69.62674126638423, 289.0337192831016, 3.155693380972461, 3.3503769631560694, 17.728208677347087, 30.31680866923493, 181.9875581174311, 140.49828836924158, 317.79656014418896, 306.34103263586735, 11.359050461792464, 154.13102805284484, 208.82538148756967, 298.4901095709956, 229.95408202500366, 6.126135744880239, 108.71720456715995, 162.56073724359976, 189.42987650572286, 206.58508700912301, 288.20248893006345, 48.41125720313829, 7.239738895685835, 153.63514668872529, 141.9282781011987, 11.409036959591326, 287.48371391933495, 48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064, 85.67071675657937, 92.48011949131029, 158.46194939225109, 390.0683391683163, 145.95259299165045, 518.9700219256634, 9.927584462841153, 313.14623721236643, 218.59082190642826, 331.84097057599854, 122.163301152162, 336.8429998676647, 269.2459534714868, 124.7772744608389, 270.76167076258014, 97.18891312348342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2312312511298864, "mean_inference_ms": 4.1769636796860015, "mean_action_processing_ms": 1.572310851859383, "mean_env_wait_ms": 10.0532516437174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027483701705932617, "StateBufferConnector_ms": 0.0034084320068359375, "ViewRequirementAgentConnector_ms": 0.10665357112884521}, "num_episodes": 10, "episode_return_max": 397.0, "episode_return_min": 75.40000000000009, "episode_return_mean": 280.466, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.4830633865023, "num_env_steps_trained_throughput_per_sec": 156.4830633865023, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 25911.108, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25910.888, "sample_time_ms": 1881.08, "learn_time_ms": 24000.834, "learn_throughput": 166.661, "synch_weights_time_ms": 25.997}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 27, "trial_id": "cbf82_00000", "date": "2024-08-21_13-19-13", "timestamp": 1724226553, "time_this_iter_s": 25.59980607032776, "time_total_s": 728.7998402118683, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177de7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 728.7998402118683, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.81351351351351, "ram_util_percent": 81.81621621621622}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.665042325730125, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.077222035825253, "policy_loss": -0.011489717839382744, "vf_loss": 6.0863170007864635, "vf_explained_var": 0.15116033256053923, "kl": 0.011973716085534155, "entropy": 1.0851506765310963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.656267954409124, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.449456652998924, "policy_loss": -0.01769649523921544, "vf_loss": 7.464211163918177, "vf_explained_var": 0.006549312236408393, "kl": 0.014709901730626977, "entropy": 1.1975876198460658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": 86.9999999999996, "episode_reward_mean": 273.89, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -410.8700219256637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 518.9700219256634}, "policy_reward_mean": {"prey_policy": 116.73667223566662, "predator_policy": 157.15332776433337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.4, 306.0, 285.59999999999997, 330.4, 290.1, 245.0, 353.9, 209.19999999999996, 283.7000000000003, 300.1, 336.1, 373.0, 276.0000000000007, 86.9999999999996, 387.7, 394.3, 266.6, 294.0, 149.29999999999995, 305.1, 209.29999999999998, 126.30000000000004, 315.8, 337.8, 244.39999999999998, 341.3000000000003, 334.7, 237.99999999999994, 397.0, 355.7, 312.79999999999995, 326.79999999999995, 308.0, 263.7000000000001, 204.3, 235.1, 286.29999999999995, 285.1, 274.3, 200.5, 260.4, 296.79999999999995, 308.5000000000001, 304.0, 275.0, 250.0, 218.99999999999994, 356.6, 389.5, 301.79999999999995, 285.5000000000001, 370.5, 254.2, 384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999, 333.9, 268.19999999999993, 268.5999999999999, 123.0, 307.19999999999993, 108.1, 389.4, 231.0, 254.09999999999997, 103.09999999999997, 132.9000000000003, 185.69999999999996, 169.59999999999988, 297.2, 212.39999999999998, 286.39999999999975, 284.2, 305.6, 261.0, 269.1, 290.0, 264.0, 189.09999999999997, 287.0, 171.19999999999953, 225.6, 361.0, 225.29999999999987, 330.0, 213.69999999999968, 396.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [112.27580538536024, 155.49402005545025, 138.7783548238629, 236.27993437533559, 138.760407905531, 74.24810859883584, 314.8700219591731, 121.69276412286071, 172.04326555349635, 273.45354024586845, 239.66838282449027, 353.12018319094364, 150.8579419835173, -1.870397531995116, 373.2087065776735, 390.6272394566869, 31.818110438335182, 153.20360747872652, 39.35127620627225, 202.3283480102578, -101.78399781847263, 21.060988415110252, 224.9436034977248, 300.59169731670636, -13.267092581065837, 291.4703063975945, 265.0732587336157, -51.033719283101576, 393.8443066190275, 352.3496230368439, 295.07179132265287, 296.4831913307652, 126.01244188256888, 123.20171163075842, -113.49656014418906, -71.24103263586741, 274.9409495382075, 130.9689719471551, 65.47461851243031, -97.99010957099566, 30.44591797499647, 290.6738642551198, 199.78279543284003, 141.4392627564002, 85.57012349427711, 43.41491299087697, -69.20248893006338, 308.1887427968617, 382.26026110431417, 148.16485331127473, 143.57172189880126, 359.09096304040867, -33.283713919335014, 336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054, 248.22928324342047, 175.71988050868976, 110.13805060774898, -267.06833916831675, 161.24740700834943, -410.8700219256637, 379.47241553715884, -82.14623721236667, 35.50917809357182, -228.7409705759992, 10.736698847838277, -151.1429998676645, -99.64595347148692, 172.42272553916118, -58.36167076258008, 189.21108687651628, 97.70612107598627, 48.296025695324296, 0.6810960803538393, 65.86074362314191, 112.60180355537588, 75.55738406447765, -277.2982475696506, 126.37346423162529, -68.53488518625436, -26.33066001625653, 315.4860105341767, 6.3625319671857925, 247.2338987799766, 33.385258289022005, 396.4], "policy_predator_policy_reward": [155.12419461463975, 150.5059799445497, 146.82164517613714, 94.12006562466443, 151.33959209446894, 170.75189140116422, 39.029978040826975, 87.5072358771392, 111.65673444650353, 26.64645975413164, 96.43161717550971, 19.879816809056493, 125.14205801648252, 88.87039753199515, 14.49129342232646, 3.672760543313154, 234.78188956166494, 140.79639252127348, 109.94872379372761, 102.77165198974215, 311.0839978184726, 105.23901158488978, 90.85639650227508, 37.20830268329361, 257.6670925810661, 49.82969360240574, 69.62674126638423, 289.0337192831016, 3.155693380972461, 3.3503769631560694, 17.728208677347087, 30.31680866923493, 181.9875581174311, 140.49828836924158, 317.79656014418896, 306.34103263586735, 11.359050461792464, 154.13102805284484, 208.82538148756967, 298.4901095709956, 229.95408202500366, 6.126135744880239, 108.71720456715995, 162.56073724359976, 189.42987650572286, 206.58508700912301, 288.20248893006345, 48.41125720313829, 7.239738895685835, 153.63514668872529, 141.9282781011987, 11.409036959591326, 287.48371391933495, 48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064, 85.67071675657937, 92.48011949131029, 158.46194939225109, 390.0683391683163, 145.95259299165045, 518.9700219256634, 9.927584462841153, 313.14623721236643, 218.59082190642826, 331.84097057599854, 122.163301152162, 336.8429998676647, 269.2459534714868, 124.7772744608389, 270.76167076258014, 97.18891312348342, 186.4938789240137, 257.3039743046756, 260.31890391964606, 203.23925637685804, 177.3981964446243, 188.4426159355223, 466.3982475696508, 160.62653576837482, 239.73488518625425, 251.9306600162565, 45.51398946582324, 218.93746803281428, 82.76610122002357, 180.314741710978, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.170857577201558, "mean_inference_ms": 4.123916325787748, "mean_action_processing_ms": 1.4409795539527537, "mean_env_wait_ms": 10.034663758724541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00829470157623291, "StateBufferConnector_ms": 0.004391789436340332, "ViewRequirementAgentConnector_ms": 0.12589192390441895}, "num_episodes": 15, "episode_return_max": 397.0, "episode_return_min": 86.9999999999996, "episode_return_mean": 273.89, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.60463247736686, "num_env_steps_trained_throughput_per_sec": 144.60463247736686, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 26102.385, "restore_workers_time_ms": 0.039, "training_step_time_ms": 26102.136, "sample_time_ms": 1933.956, "learn_time_ms": 24140.088, "learn_throughput": 165.699, "synch_weights_time_ms": 25.205}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 28, "trial_id": "cbf82_00000", "date": "2024-08-21_13-19-41", "timestamp": 1724226581, "time_this_iter_s": 27.690213918685913, "time_total_s": 756.4900541305542, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e37ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 756.4900541305542, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 38.284615384615385, "ram_util_percent": 82.3897435897436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.024984235937397, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.987407411634922, "policy_loss": -0.010816028804886932, "vf_loss": 5.996152060230573, "vf_explained_var": 0.16410644743591546, "kl": 0.010356870789352494, "entropy": 1.0733316142112017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.573348786806067, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.630940167109172, "policy_loss": -0.020389785088870363, "vf_loss": 7.648699343701204, "vf_explained_var": 0.057084644213318825, "kl": 0.013152943596893844, "entropy": 1.168942870075504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": 86.9999999999996, "episode_reward_mean": 265.4789999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -410.8700219256637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 518.9700219256634}, "policy_reward_mean": {"prey_policy": 95.84214215637076, "predator_policy": 169.63685784362926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.0, 276.0000000000007, 86.9999999999996, 387.7, 394.3, 266.6, 294.0, 149.29999999999995, 305.1, 209.29999999999998, 126.30000000000004, 315.8, 337.8, 244.39999999999998, 341.3000000000003, 334.7, 237.99999999999994, 397.0, 355.7, 312.79999999999995, 326.79999999999995, 308.0, 263.7000000000001, 204.3, 235.1, 286.29999999999995, 285.1, 274.3, 200.5, 260.4, 296.79999999999995, 308.5000000000001, 304.0, 275.0, 250.0, 218.99999999999994, 356.6, 389.5, 301.79999999999995, 285.5000000000001, 370.5, 254.2, 384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999, 333.9, 268.19999999999993, 268.5999999999999, 123.0, 307.19999999999993, 108.1, 389.4, 231.0, 254.09999999999997, 103.09999999999997, 132.9000000000003, 185.69999999999996, 169.59999999999988, 297.2, 212.39999999999998, 286.39999999999975, 284.2, 305.6, 261.0, 269.1, 290.0, 264.0, 189.09999999999997, 287.0, 171.19999999999953, 225.6, 361.0, 225.29999999999987, 330.0, 213.69999999999968, 396.4, 224.19999999999996, 252.19999999999996, 179.0999999999993, 253.69999999999993, 295.3, 203.89999999999944, 222.29999999999998, 187.3, 196.3, 169.59999999999977, 182.50000000000009], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [353.12018319094364, 150.8579419835173, -1.870397531995116, 373.2087065776735, 390.6272394566869, 31.818110438335182, 153.20360747872652, 39.35127620627225, 202.3283480102578, -101.78399781847263, 21.060988415110252, 224.9436034977248, 300.59169731670636, -13.267092581065837, 291.4703063975945, 265.0732587336157, -51.033719283101576, 393.8443066190275, 352.3496230368439, 295.07179132265287, 296.4831913307652, 126.01244188256888, 123.20171163075842, -113.49656014418906, -71.24103263586741, 274.9409495382075, 130.9689719471551, 65.47461851243031, -97.99010957099566, 30.44591797499647, 290.6738642551198, 199.78279543284003, 141.4392627564002, 85.57012349427711, 43.41491299087697, -69.20248893006338, 308.1887427968617, 382.26026110431417, 148.16485331127473, 143.57172189880126, 359.09096304040867, -33.283713919335014, 336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054, 248.22928324342047, 175.71988050868976, 110.13805060774898, -267.06833916831675, 161.24740700834943, -410.8700219256637, 379.47241553715884, -82.14623721236667, 35.50917809357182, -228.7409705759992, 10.736698847838277, -151.1429998676645, -99.64595347148692, 172.42272553916118, -58.36167076258008, 189.21108687651628, 97.70612107598627, 48.296025695324296, 0.6810960803538393, 65.86074362314191, 112.60180355537588, 75.55738406447765, -277.2982475696506, 126.37346423162529, -68.53488518625436, -26.33066001625653, 315.4860105341767, 6.3625319671857925, 247.2338987799766, 33.385258289022005, 396.4, -60.843991236629435, 52.10676407938611, 15.527217056366698, 43.245898561796864, 178.16364395878784, 38.97941869846098, -99.91861535402455, -28.61236420176714, -117.01807499200773, -47.94852911365392, -85.5697695360379], "policy_predator_policy_reward": [19.879816809056493, 125.14205801648252, 88.87039753199515, 14.49129342232646, 3.672760543313154, 234.78188956166494, 140.79639252127348, 109.94872379372761, 102.77165198974215, 311.0839978184726, 105.23901158488978, 90.85639650227508, 37.20830268329361, 257.6670925810661, 49.82969360240574, 69.62674126638423, 289.0337192831016, 3.155693380972461, 3.3503769631560694, 17.728208677347087, 30.31680866923493, 181.9875581174311, 140.49828836924158, 317.79656014418896, 306.34103263586735, 11.359050461792464, 154.13102805284484, 208.82538148756967, 298.4901095709956, 229.95408202500366, 6.126135744880239, 108.71720456715995, 162.56073724359976, 189.42987650572286, 206.58508700912301, 288.20248893006345, 48.41125720313829, 7.239738895685835, 153.63514668872529, 141.9282781011987, 11.409036959591326, 287.48371391933495, 48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064, 85.67071675657937, 92.48011949131029, 158.46194939225109, 390.0683391683163, 145.95259299165045, 518.9700219256634, 9.927584462841153, 313.14623721236643, 218.59082190642826, 331.84097057599854, 122.163301152162, 336.8429998676647, 269.2459534714868, 124.7772744608389, 270.76167076258014, 97.18891312348342, 186.4938789240137, 257.3039743046756, 260.31890391964606, 203.23925637685804, 177.3981964446243, 188.4426159355223, 466.3982475696508, 160.62653576837482, 239.73488518625425, 251.9306600162565, 45.51398946582324, 218.93746803281428, 82.76610122002357, 180.314741710978, 0.0, 285.0439912366295, 200.09323592061392, 163.5727829436333, 210.45410143820325, 117.13635604121207, 164.9205813015391, 322.21861535402473, 215.91236420176716, 313.3180749920078, 217.54852911365398, 268.0697695360381]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.138084195163082, "mean_inference_ms": 4.071700247297975, "mean_action_processing_ms": 1.4123916181532623, "mean_env_wait_ms": 10.031067301570683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008547067642211914, "StateBufferConnector_ms": 0.004222750663757324, "ViewRequirementAgentConnector_ms": 0.11086642742156982}, "num_episodes": 11, "episode_return_max": 397.0, "episode_return_min": 86.9999999999996, "episode_return_mean": 265.4789999999999, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.13471267781821, "num_env_steps_trained_throughput_per_sec": 158.13471267781821, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 26028.375, "restore_workers_time_ms": 0.039, "training_step_time_ms": 26028.031, "sample_time_ms": 1923.682, "learn_time_ms": 24076.021, "learn_throughput": 166.14, "synch_weights_time_ms": 25.119}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 29, "trial_id": "cbf82_00000", "date": "2024-08-21_13-20-06", "timestamp": 1724226606, "time_this_iter_s": 25.36408495903015, "time_total_s": 781.8541390895844, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e37a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 781.8541390895844, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 32.56944444444444, "ram_util_percent": 80.95277777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.738543803244829, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.427528747916222, "policy_loss": -0.011842981060423578, "vf_loss": 5.436557848254839, "vf_explained_var": 0.17355146103849015, "kl": 0.014069488614040893, "entropy": 1.084955456542472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.178004357839622, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.6764578128854435, "policy_loss": -0.020134071045807406, "vf_loss": 6.6935087089737255, "vf_explained_var": 0.04582669449349244, "kl": 0.015415860407908136, "entropy": 1.1598347725967566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": 103.09999999999997, "episode_reward_mean": 262.935, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -410.8700219256637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 518.9700219256634}, "policy_reward_mean": {"prey_policy": 76.0387117497066, "predator_policy": 186.89628825029337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [244.39999999999998, 341.3000000000003, 334.7, 237.99999999999994, 397.0, 355.7, 312.79999999999995, 326.79999999999995, 308.0, 263.7000000000001, 204.3, 235.1, 286.29999999999995, 285.1, 274.3, 200.5, 260.4, 296.79999999999995, 308.5000000000001, 304.0, 275.0, 250.0, 218.99999999999994, 356.6, 389.5, 301.79999999999995, 285.5000000000001, 370.5, 254.2, 384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999, 333.9, 268.19999999999993, 268.5999999999999, 123.0, 307.19999999999993, 108.1, 389.4, 231.0, 254.09999999999997, 103.09999999999997, 132.9000000000003, 185.69999999999996, 169.59999999999988, 297.2, 212.39999999999998, 286.39999999999975, 284.2, 305.6, 261.0, 269.1, 290.0, 264.0, 189.09999999999997, 287.0, 171.19999999999953, 225.6, 361.0, 225.29999999999987, 330.0, 213.69999999999968, 396.4, 224.19999999999996, 252.19999999999996, 179.0999999999993, 253.69999999999993, 295.3, 203.89999999999944, 222.29999999999998, 187.3, 196.3, 169.59999999999977, 182.50000000000009, 262.0999999999999, 185.1, 237.2, 216.1, 392.1, 237.3, 310.70000000000005, 224.49999999999997, 197.4, 141.8, 377.9, 206.39999999999998, 279.2], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-13.267092581065837, 291.4703063975945, 265.0732587336157, -51.033719283101576, 393.8443066190275, 352.3496230368439, 295.07179132265287, 296.4831913307652, 126.01244188256888, 123.20171163075842, -113.49656014418906, -71.24103263586741, 274.9409495382075, 130.9689719471551, 65.47461851243031, -97.99010957099566, 30.44591797499647, 290.6738642551198, 199.78279543284003, 141.4392627564002, 85.57012349427711, 43.41491299087697, -69.20248893006338, 308.1887427968617, 382.26026110431417, 148.16485331127473, 143.57172189880126, 359.09096304040867, -33.283713919335014, 336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054, 248.22928324342047, 175.71988050868976, 110.13805060774898, -267.06833916831675, 161.24740700834943, -410.8700219256637, 379.47241553715884, -82.14623721236667, 35.50917809357182, -228.7409705759992, 10.736698847838277, -151.1429998676645, -99.64595347148692, 172.42272553916118, -58.36167076258008, 189.21108687651628, 97.70612107598627, 48.296025695324296, 0.6810960803538393, 65.86074362314191, 112.60180355537588, 75.55738406447765, -277.2982475696506, 126.37346423162529, -68.53488518625436, -26.33066001625653, 315.4860105341767, 6.3625319671857925, 247.2338987799766, 33.385258289022005, 396.4, -60.843991236629435, 52.10676407938611, 15.527217056366698, 43.245898561796864, 178.16364395878784, 38.97941869846098, -99.91861535402455, -28.61236420176714, -117.01807499200773, -47.94852911365392, -85.5697695360379, 90.21285662749948, -211.2786083166867, -36.94277631795717, -125.3830828659254, 380.9040223057269, -11.27598708757322, 176.47668132899867, -77.44992280699286, -122.16012368473424, -350.4760419843988, 371.8867860863296, -36.74351231214824, 109.34397558293364], "policy_predator_policy_reward": [257.6670925810661, 49.82969360240574, 69.62674126638423, 289.0337192831016, 3.155693380972461, 3.3503769631560694, 17.728208677347087, 30.31680866923493, 181.9875581174311, 140.49828836924158, 317.79656014418896, 306.34103263586735, 11.359050461792464, 154.13102805284484, 208.82538148756967, 298.4901095709956, 229.95408202500366, 6.126135744880239, 108.71720456715995, 162.56073724359976, 189.42987650572286, 206.58508700912301, 288.20248893006345, 48.41125720313829, 7.239738895685835, 153.63514668872529, 141.9282781011987, 11.409036959591326, 287.48371391933495, 48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064, 85.67071675657937, 92.48011949131029, 158.46194939225109, 390.0683391683163, 145.95259299165045, 518.9700219256634, 9.927584462841153, 313.14623721236643, 218.59082190642826, 331.84097057599854, 122.163301152162, 336.8429998676647, 269.2459534714868, 124.7772744608389, 270.76167076258014, 97.18891312348342, 186.4938789240137, 257.3039743046756, 260.31890391964606, 203.23925637685804, 177.3981964446243, 188.4426159355223, 466.3982475696508, 160.62653576837482, 239.73488518625425, 251.9306600162565, 45.51398946582324, 218.93746803281428, 82.76610122002357, 180.314741710978, 0.0, 285.0439912366295, 200.09323592061392, 163.5727829436333, 210.45410143820325, 117.13635604121207, 164.9205813015391, 322.21861535402473, 215.91236420176716, 313.3180749920078, 217.54852911365398, 268.0697695360381, 171.88714337250045, 396.37860831668655, 274.14277631795704, 341.48308286592555, 11.1959776942731, 248.57598708757337, 134.22331867100135, 301.9499228069929, 319.56012368473415, 492.27604198439906, 6.01321391367042, 243.14351231214803, 169.85602441706624]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1108889690040558, "mean_inference_ms": 4.028405873844426, "mean_action_processing_ms": 1.3812676262515649, "mean_env_wait_ms": 10.036353733131584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008658409118652344, "StateBufferConnector_ms": 0.004217743873596191, "ViewRequirementAgentConnector_ms": 0.1111229658126831}, "num_episodes": 13, "episode_return_max": 397.0, "episode_return_min": 103.09999999999997, "episode_return_mean": 262.935, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.9143947732135, "num_env_steps_trained_throughput_per_sec": 149.9143947732135, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 25785.036, "restore_workers_time_ms": 0.041, "training_step_time_ms": 25784.713, "sample_time_ms": 1950.967, "learn_time_ms": 23806.213, "learn_throughput": 168.023, "synch_weights_time_ms": 24.804}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 30, "trial_id": "cbf82_00000", "date": "2024-08-21_13-20-33", "timestamp": 1724226633, "time_this_iter_s": 26.736019134521484, "time_total_s": 808.5901582241058, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e26a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 808.5901582241058, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 35.6578947368421, "ram_util_percent": 82.10526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.52087834738195, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.899038148671389, "policy_loss": -0.013064501779930045, "vf_loss": 4.910019297897816, "vf_explained_var": 0.19084572258094948, "kl": 0.01041679998403803, "entropy": 1.0878923575083415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.77133978853623, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.904662022242944, "policy_loss": -0.018206985396682286, "vf_loss": 5.920230241616567, "vf_explained_var": 0.16519775614142418, "kl": 0.013193815059397214, "entropy": 1.182732360313336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 103.09999999999997, "episode_reward_mean": 255.858, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -410.8700219256637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 518.9700219256634}, "policy_reward_mean": {"prey_policy": 55.54326067515513, "predator_policy": 200.31473932484485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [286.29999999999995, 285.1, 274.3, 200.5, 260.4, 296.79999999999995, 308.5000000000001, 304.0, 275.0, 250.0, 218.99999999999994, 356.6, 389.5, 301.79999999999995, 285.5000000000001, 370.5, 254.2, 384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999, 333.9, 268.19999999999993, 268.5999999999999, 123.0, 307.19999999999993, 108.1, 389.4, 231.0, 254.09999999999997, 103.09999999999997, 132.9000000000003, 185.69999999999996, 169.59999999999988, 297.2, 212.39999999999998, 286.39999999999975, 284.2, 305.6, 261.0, 269.1, 290.0, 264.0, 189.09999999999997, 287.0, 171.19999999999953, 225.6, 361.0, 225.29999999999987, 330.0, 213.69999999999968, 396.4, 224.19999999999996, 252.19999999999996, 179.0999999999993, 253.69999999999993, 295.3, 203.89999999999944, 222.29999999999998, 187.3, 196.3, 169.59999999999977, 182.50000000000009, 262.0999999999999, 185.1, 237.2, 216.1, 392.1, 237.3, 310.70000000000005, 224.49999999999997, 197.4, 141.8, 377.9, 206.39999999999998, 279.2, 319.4, 198.0, 222.49999999999991, 144.79999999999998, 203.0, 299.0000000000007, 236.3, 370.5, 129.89999999999992, 143.49999999999997, 398.2, 189.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [274.9409495382075, 130.9689719471551, 65.47461851243031, -97.99010957099566, 30.44591797499647, 290.6738642551198, 199.78279543284003, 141.4392627564002, 85.57012349427711, 43.41491299087697, -69.20248893006338, 308.1887427968617, 382.26026110431417, 148.16485331127473, 143.57172189880126, 359.09096304040867, -33.283713919335014, 336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054, 248.22928324342047, 175.71988050868976, 110.13805060774898, -267.06833916831675, 161.24740700834943, -410.8700219256637, 379.47241553715884, -82.14623721236667, 35.50917809357182, -228.7409705759992, 10.736698847838277, -151.1429998676645, -99.64595347148692, 172.42272553916118, -58.36167076258008, 189.21108687651628, 97.70612107598627, 48.296025695324296, 0.6810960803538393, 65.86074362314191, 112.60180355537588, 75.55738406447765, -277.2982475696506, 126.37346423162529, -68.53488518625436, -26.33066001625653, 315.4860105341767, 6.3625319671857925, 247.2338987799766, 33.385258289022005, 396.4, -60.843991236629435, 52.10676407938611, 15.527217056366698, 43.245898561796864, 178.16364395878784, 38.97941869846098, -99.91861535402455, -28.61236420176714, -117.01807499200773, -47.94852911365392, -85.5697695360379, 90.21285662749948, -211.2786083166867, -36.94277631795717, -125.3830828659254, 380.9040223057269, -11.27598708757322, 176.47668132899867, -77.44992280699286, -122.16012368473424, -350.4760419843988, 371.8867860863296, -36.74351231214824, 109.34397558293364, 197.96362648414802, -80.06833318763461, -123.34915593450381, -210.88367934100197, -141.5349399508441, 204.94151023821647, -45.83226115892905, 351.6302636483013, -283.57888041853437, -290.1693190719714, 398.2, -132.39571245279035], "policy_predator_policy_reward": [11.359050461792464, 154.13102805284484, 208.82538148756967, 298.4901095709956, 229.95408202500366, 6.126135744880239, 108.71720456715995, 162.56073724359976, 189.42987650572286, 206.58508700912301, 288.20248893006345, 48.41125720313829, 7.239738895685835, 153.63514668872529, 141.9282781011987, 11.409036959591326, 287.48371391933495, 48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064, 85.67071675657937, 92.48011949131029, 158.46194939225109, 390.0683391683163, 145.95259299165045, 518.9700219256634, 9.927584462841153, 313.14623721236643, 218.59082190642826, 331.84097057599854, 122.163301152162, 336.8429998676647, 269.2459534714868, 124.7772744608389, 270.76167076258014, 97.18891312348342, 186.4938789240137, 257.3039743046756, 260.31890391964606, 203.23925637685804, 177.3981964446243, 188.4426159355223, 466.3982475696508, 160.62653576837482, 239.73488518625425, 251.9306600162565, 45.51398946582324, 218.93746803281428, 82.76610122002357, 180.314741710978, 0.0, 285.0439912366295, 200.09323592061392, 163.5727829436333, 210.45410143820325, 117.13635604121207, 164.9205813015391, 322.21861535402473, 215.91236420176716, 313.3180749920078, 217.54852911365398, 268.0697695360381, 171.88714337250045, 396.37860831668655, 274.14277631795704, 341.48308286592555, 11.1959776942731, 248.57598708757337, 134.22331867100135, 301.9499228069929, 319.56012368473415, 492.27604198439906, 6.01321391367042, 243.14351231214803, 169.85602441706624, 121.43637351585208, 278.0683331876346, 345.84915593450387, 355.6836793410017, 344.53493995084403, 94.05848976178342, 282.13226115892905, 18.869736351698695, 413.47888041853446, 433.6693190719715, 0.0, 321.39571245279035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0840659088370495, "mean_inference_ms": 3.9763932784719764, "mean_action_processing_ms": 1.3695929979540287, "mean_env_wait_ms": 10.051148132747322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008594989776611328, "StateBufferConnector_ms": 0.008821845054626465, "ViewRequirementAgentConnector_ms": 0.11001777648925781}, "num_episodes": 12, "episode_return_max": 398.2, "episode_return_min": 103.09999999999997, "episode_return_mean": 255.858, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.56395708421084, "num_env_steps_trained_throughput_per_sec": 159.56395708421084, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 25681.821, "restore_workers_time_ms": 0.04, "training_step_time_ms": 25681.498, "sample_time_ms": 1942.669, "learn_time_ms": 23711.274, "learn_throughput": 168.696, "synch_weights_time_ms": 24.702}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 31, "trial_id": "cbf82_00000", "date": "2024-08-21_13-20-58", "timestamp": 1724226658, "time_this_iter_s": 25.112958908081055, "time_total_s": 833.7031171321869, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177de7e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 833.7031171321869, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 29.75, "ram_util_percent": 81.3138888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.73500108482937, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.227841855337222, "policy_loss": -0.013431923444053003, "vf_loss": 5.238796333968639, "vf_explained_var": 0.14839629419147968, "kl": 0.012387159756326583, "entropy": 1.0964626029133797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.243166515852014, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.331451447804769, "policy_loss": -0.019908528122565865, "vf_loss": 6.348637800912062, "vf_explained_var": 0.17340206298977137, "kl": 0.013610844900055478, "entropy": 1.1970444610963265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 103.09999999999997, "episode_reward_mean": 255.65599999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -410.8700219256637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 518.9700219256634}, "policy_reward_mean": {"prey_policy": 53.305109626388436, "predator_policy": 202.35089037361155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [308.5000000000001, 304.0, 275.0, 250.0, 218.99999999999994, 356.6, 389.5, 301.79999999999995, 285.5000000000001, 370.5, 254.2, 384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999, 333.9, 268.19999999999993, 268.5999999999999, 123.0, 307.19999999999993, 108.1, 389.4, 231.0, 254.09999999999997, 103.09999999999997, 132.9000000000003, 185.69999999999996, 169.59999999999988, 297.2, 212.39999999999998, 286.39999999999975, 284.2, 305.6, 261.0, 269.1, 290.0, 264.0, 189.09999999999997, 287.0, 171.19999999999953, 225.6, 361.0, 225.29999999999987, 330.0, 213.69999999999968, 396.4, 224.19999999999996, 252.19999999999996, 179.0999999999993, 253.69999999999993, 295.3, 203.89999999999944, 222.29999999999998, 187.3, 196.3, 169.59999999999977, 182.50000000000009, 262.0999999999999, 185.1, 237.2, 216.1, 392.1, 237.3, 310.70000000000005, 224.49999999999997, 197.4, 141.8, 377.9, 206.39999999999998, 279.2, 319.4, 198.0, 222.49999999999991, 144.79999999999998, 203.0, 299.0000000000007, 236.3, 370.5, 129.89999999999992, 143.49999999999997, 398.2, 189.0, 382.6, 289.70000000000005, 189.1, 126.599999999999, 374.0, 221.2], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [199.78279543284003, 141.4392627564002, 85.57012349427711, 43.41491299087697, -69.20248893006338, 308.1887427968617, 382.26026110431417, 148.16485331127473, 143.57172189880126, 359.09096304040867, -33.283713919335014, 336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054, 248.22928324342047, 175.71988050868976, 110.13805060774898, -267.06833916831675, 161.24740700834943, -410.8700219256637, 379.47241553715884, -82.14623721236667, 35.50917809357182, -228.7409705759992, 10.736698847838277, -151.1429998676645, -99.64595347148692, 172.42272553916118, -58.36167076258008, 189.21108687651628, 97.70612107598627, 48.296025695324296, 0.6810960803538393, 65.86074362314191, 112.60180355537588, 75.55738406447765, -277.2982475696506, 126.37346423162529, -68.53488518625436, -26.33066001625653, 315.4860105341767, 6.3625319671857925, 247.2338987799766, 33.385258289022005, 396.4, -60.843991236629435, 52.10676407938611, 15.527217056366698, 43.245898561796864, 178.16364395878784, 38.97941869846098, -99.91861535402455, -28.61236420176714, -117.01807499200773, -47.94852911365392, -85.5697695360379, 90.21285662749948, -211.2786083166867, -36.94277631795717, -125.3830828659254, 380.9040223057269, -11.27598708757322, 176.47668132899867, -77.44992280699286, -122.16012368473424, -350.4760419843988, 371.8867860863296, -36.74351231214824, 109.34397558293364, 197.96362648414802, -80.06833318763461, -123.34915593450381, -210.88367934100197, -141.5349399508441, 204.94151023821647, -45.83226115892905, 351.6302636483013, -283.57888041853437, -290.1693190719714, 398.2, -132.39571245279035, 378.71616465664675, 96.28668467023226, -196.30824396429378, -81.26457657014492, 342.9084985545099, -69.63941956670624], "policy_predator_policy_reward": [108.71720456715995, 162.56073724359976, 189.42987650572286, 206.58508700912301, 288.20248893006345, 48.41125720313829, 7.239738895685835, 153.63514668872529, 141.9282781011987, 11.409036959591326, 287.48371391933495, 48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064, 85.67071675657937, 92.48011949131029, 158.46194939225109, 390.0683391683163, 145.95259299165045, 518.9700219256634, 9.927584462841153, 313.14623721236643, 218.59082190642826, 331.84097057599854, 122.163301152162, 336.8429998676647, 269.2459534714868, 124.7772744608389, 270.76167076258014, 97.18891312348342, 186.4938789240137, 257.3039743046756, 260.31890391964606, 203.23925637685804, 177.3981964446243, 188.4426159355223, 466.3982475696508, 160.62653576837482, 239.73488518625425, 251.9306600162565, 45.51398946582324, 218.93746803281428, 82.76610122002357, 180.314741710978, 0.0, 285.0439912366295, 200.09323592061392, 163.5727829436333, 210.45410143820325, 117.13635604121207, 164.9205813015391, 322.21861535402473, 215.91236420176716, 313.3180749920078, 217.54852911365398, 268.0697695360381, 171.88714337250045, 396.37860831668655, 274.14277631795704, 341.48308286592555, 11.1959776942731, 248.57598708757337, 134.22331867100135, 301.9499228069929, 319.56012368473415, 492.27604198439906, 6.01321391367042, 243.14351231214803, 169.85602441706624, 121.43637351585208, 278.0683331876346, 345.84915593450387, 355.6836793410017, 344.53493995084403, 94.05848976178342, 282.13226115892905, 18.869736351698695, 413.47888041853446, 433.6693190719715, 0.0, 321.39571245279035, 3.883835343353244, 193.41331532976787, 385.40824396429315, 207.8645765701441, 31.091501445490078, 290.8394195667061]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.067651272777862, "mean_inference_ms": 3.9493626978914427, "mean_action_processing_ms": 1.3694979083299785, "mean_env_wait_ms": 10.069810360806956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01329803466796875, "StateBufferConnector_ms": 0.008879780769348145, "ViewRequirementAgentConnector_ms": 0.11282134056091309}, "num_episodes": 6, "episode_return_max": 398.2, "episode_return_min": 103.09999999999997, "episode_return_mean": 255.65599999999995, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.7964306092429, "num_env_steps_trained_throughput_per_sec": 157.7964306092429, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 25755.136, "restore_workers_time_ms": 0.041, "training_step_time_ms": 25754.824, "sample_time_ms": 1950.895, "learn_time_ms": 23775.179, "learn_throughput": 168.243, "synch_weights_time_ms": 25.728}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 32, "trial_id": "cbf82_00000", "date": "2024-08-21_13-21-24", "timestamp": 1724226684, "time_this_iter_s": 25.402751922607422, "time_total_s": 859.1058690547943, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075cc5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 859.1058690547943, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 31.127777777777776, "ram_util_percent": 81.99444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.689333655188481, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.549921286602815, "policy_loss": -0.007161774303434261, "vf_loss": 5.555095101396243, "vf_explained_var": 0.16367777939885855, "kl": 0.009939786685087408, "entropy": 1.0752866557488838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.140890150641402, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.470485482613245, "policy_loss": -0.0203620063373819, "vf_loss": 6.487717309594155, "vf_explained_var": 0.10629337094724178, "kl": 0.01565086409294357, "entropy": 1.1952405573179326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 103.09999999999997, "episode_reward_mean": 244.81699999999992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -410.8700219256637, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 518.9700219256634}, "policy_reward_mean": {"prey_policy": 26.246389101194712, "predator_policy": 218.57061089880526}, "custom_metrics": {}, "hist_stats": {"episode_reward": [384.3, 307.20000000000005, 388.0, 229.79999999999995, 229.10000000000002, 366.3, 318.8000000000002, 284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999, 333.9, 268.19999999999993, 268.5999999999999, 123.0, 307.19999999999993, 108.1, 389.4, 231.0, 254.09999999999997, 103.09999999999997, 132.9000000000003, 185.69999999999996, 169.59999999999988, 297.2, 212.39999999999998, 286.39999999999975, 284.2, 305.6, 261.0, 269.1, 290.0, 264.0, 189.09999999999997, 287.0, 171.19999999999953, 225.6, 361.0, 225.29999999999987, 330.0, 213.69999999999968, 396.4, 224.19999999999996, 252.19999999999996, 179.0999999999993, 253.69999999999993, 295.3, 203.89999999999944, 222.29999999999998, 187.3, 196.3, 169.59999999999977, 182.50000000000009, 262.0999999999999, 185.1, 237.2, 216.1, 392.1, 237.3, 310.70000000000005, 224.49999999999997, 197.4, 141.8, 377.9, 206.39999999999998, 279.2, 319.4, 198.0, 222.49999999999991, 144.79999999999998, 203.0, 299.0000000000007, 236.3, 370.5, 129.89999999999992, 143.49999999999997, 398.2, 189.0, 382.6, 289.70000000000005, 189.1, 126.599999999999, 374.0, 221.2, 163.7999999999999, 279.9999999999999, 202.0, 247.89999999999978, 241.7, 159.8, 325.0, 137.3999999999998, 125.39999999999996, 168.1, 179.59999999999997], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [336.10075354621756, 156.39214729161748, 375.22271009630936, 21.389505798548022, -103.74278391141341, 307.7060472474951, 219.86297423000386, 240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054, 248.22928324342047, 175.71988050868976, 110.13805060774898, -267.06833916831675, 161.24740700834943, -410.8700219256637, 379.47241553715884, -82.14623721236667, 35.50917809357182, -228.7409705759992, 10.736698847838277, -151.1429998676645, -99.64595347148692, 172.42272553916118, -58.36167076258008, 189.21108687651628, 97.70612107598627, 48.296025695324296, 0.6810960803538393, 65.86074362314191, 112.60180355537588, 75.55738406447765, -277.2982475696506, 126.37346423162529, -68.53488518625436, -26.33066001625653, 315.4860105341767, 6.3625319671857925, 247.2338987799766, 33.385258289022005, 396.4, -60.843991236629435, 52.10676407938611, 15.527217056366698, 43.245898561796864, 178.16364395878784, 38.97941869846098, -99.91861535402455, -28.61236420176714, -117.01807499200773, -47.94852911365392, -85.5697695360379, 90.21285662749948, -211.2786083166867, -36.94277631795717, -125.3830828659254, 380.9040223057269, -11.27598708757322, 176.47668132899867, -77.44992280699286, -122.16012368473424, -350.4760419843988, 371.8867860863296, -36.74351231214824, 109.34397558293364, 197.96362648414802, -80.06833318763461, -123.34915593450381, -210.88367934100197, -141.5349399508441, 204.94151023821647, -45.83226115892905, 351.6302636483013, -283.57888041853437, -290.1693190719714, 398.2, -132.39571245279035, 378.71616465664675, 96.28668467023226, -196.30824396429378, -81.26457657014492, 342.9084985545099, -69.63941956670624, -217.93690890230198, 138.1680959120032, -159.9861043066497, 163.6101952963238, -57.93437910123135, -162.93550209453176, 206.91112873449302, -269.0850351597421, -310.48067593138916, -194.8611106983713, -132.3443222913186], "policy_predator_policy_reward": [48.199246453782465, 150.80785270838268, 12.777289903690653, 208.4104942014519, 332.8427839114136, 58.59395275250493, 98.93702576999613, 43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064, 85.67071675657937, 92.48011949131029, 158.46194939225109, 390.0683391683163, 145.95259299165045, 518.9700219256634, 9.927584462841153, 313.14623721236643, 218.59082190642826, 331.84097057599854, 122.163301152162, 336.8429998676647, 269.2459534714868, 124.7772744608389, 270.76167076258014, 97.18891312348342, 186.4938789240137, 257.3039743046756, 260.31890391964606, 203.23925637685804, 177.3981964446243, 188.4426159355223, 466.3982475696508, 160.62653576837482, 239.73488518625425, 251.9306600162565, 45.51398946582324, 218.93746803281428, 82.76610122002357, 180.314741710978, 0.0, 285.0439912366295, 200.09323592061392, 163.5727829436333, 210.45410143820325, 117.13635604121207, 164.9205813015391, 322.21861535402473, 215.91236420176716, 313.3180749920078, 217.54852911365398, 268.0697695360381, 171.88714337250045, 396.37860831668655, 274.14277631795704, 341.48308286592555, 11.1959776942731, 248.57598708757337, 134.22331867100135, 301.9499228069929, 319.56012368473415, 492.27604198439906, 6.01321391367042, 243.14351231214803, 169.85602441706624, 121.43637351585208, 278.0683331876346, 345.84915593450387, 355.6836793410017, 344.53493995084403, 94.05848976178342, 282.13226115892905, 18.869736351698695, 413.47888041853446, 433.6693190719715, 0.0, 321.39571245279035, 3.883835343353244, 193.41331532976787, 385.40824396429315, 207.8645765701441, 31.091501445490078, 290.8394195667061, 381.7369089023021, 141.83190408799683, 361.9861043066497, 84.28980470367594, 299.63437910123133, 322.7355020945317, 118.088871265507, 406.4850351597419, 435.880675931389, 362.96111069837144, 311.94432229131854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.045329311308111, "mean_inference_ms": 3.9241884115782004, "mean_action_processing_ms": 1.3358678718479675, "mean_env_wait_ms": 10.066365605608219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013336777687072754, "StateBufferConnector_ms": 0.008873939514160156, "ViewRequirementAgentConnector_ms": 0.1047741174697876}, "num_episodes": 11, "episode_return_max": 398.2, "episode_return_min": 103.09999999999997, "episode_return_mean": 244.81699999999992, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.25419029083503, "num_env_steps_trained_throughput_per_sec": 162.25419029083503, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 25724.762, "restore_workers_time_ms": 0.041, "training_step_time_ms": 25724.45, "sample_time_ms": 1955.119, "learn_time_ms": 23741.411, "learn_throughput": 168.482, "synch_weights_time_ms": 24.966}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 33, "trial_id": "cbf82_00000", "date": "2024-08-21_13-21-48", "timestamp": 1724226708, "time_this_iter_s": 24.66862416267395, "time_total_s": 883.7744932174683, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075ccc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 883.7744932174683, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 28.662857142857145, "ram_util_percent": 82.0942857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.874167194093267, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.226122948527336, "policy_loss": -0.01296914345997114, "vf_loss": 6.2370665818452835, "vf_explained_var": 0.15033503646651905, "kl": 0.0101275463894126, "entropy": 0.9433704938739538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.44072633696099, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.573541416227817, "policy_loss": -0.020353034537887046, "vf_loss": 7.590824910501639, "vf_explained_var": -0.1704855779806773, "kl": 0.015347758272643357, "entropy": 1.0841468237961331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 83.19999999999996, "episode_reward_mean": 239.19999999999993, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -510.9367873641405, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 594.1367873641407}, "policy_reward_mean": {"prey_policy": 10.359501262326393, "predator_policy": 228.84049873767353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.1999999999996, 233.69999999999996, 273.5, 320.9, 267.70000000000016, 248.09999999999974, 178.29999999999924, 296.4000000000001, 109.1999999999999, 333.9, 268.19999999999993, 268.5999999999999, 123.0, 307.19999999999993, 108.1, 389.4, 231.0, 254.09999999999997, 103.09999999999997, 132.9000000000003, 185.69999999999996, 169.59999999999988, 297.2, 212.39999999999998, 286.39999999999975, 284.2, 305.6, 261.0, 269.1, 290.0, 264.0, 189.09999999999997, 287.0, 171.19999999999953, 225.6, 361.0, 225.29999999999987, 330.0, 213.69999999999968, 396.4, 224.19999999999996, 252.19999999999996, 179.0999999999993, 253.69999999999993, 295.3, 203.89999999999944, 222.29999999999998, 187.3, 196.3, 169.59999999999977, 182.50000000000009, 262.0999999999999, 185.1, 237.2, 216.1, 392.1, 237.3, 310.70000000000005, 224.49999999999997, 197.4, 141.8, 377.9, 206.39999999999998, 279.2, 319.4, 198.0, 222.49999999999991, 144.79999999999998, 203.0, 299.0000000000007, 236.3, 370.5, 129.89999999999992, 143.49999999999997, 398.2, 189.0, 382.6, 289.70000000000005, 189.1, 126.599999999999, 374.0, 221.2, 163.7999999999999, 279.9999999999999, 202.0, 247.89999999999978, 241.7, 159.8, 325.0, 137.3999999999998, 125.39999999999996, 168.1, 179.59999999999997, 272.4000000000002, 206.5999999999999, 331.0, 83.19999999999996, 310.59999999999997, 249.0, 209.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [240.84229066583842, 12.219572040309359, 121.21277110124842, 228.9798486796039, 60.28566730097868, 116.04060129561965, 45.34184963685035, 131.0076690798795, -346.68726495023054, 248.22928324342047, 175.71988050868976, 110.13805060774898, -267.06833916831675, 161.24740700834943, -410.8700219256637, 379.47241553715884, -82.14623721236667, 35.50917809357182, -228.7409705759992, 10.736698847838277, -151.1429998676645, -99.64595347148692, 172.42272553916118, -58.36167076258008, 189.21108687651628, 97.70612107598627, 48.296025695324296, 0.6810960803538393, 65.86074362314191, 112.60180355537588, 75.55738406447765, -277.2982475696506, 126.37346423162529, -68.53488518625436, -26.33066001625653, 315.4860105341767, 6.3625319671857925, 247.2338987799766, 33.385258289022005, 396.4, -60.843991236629435, 52.10676407938611, 15.527217056366698, 43.245898561796864, 178.16364395878784, 38.97941869846098, -99.91861535402455, -28.61236420176714, -117.01807499200773, -47.94852911365392, -85.5697695360379, 90.21285662749948, -211.2786083166867, -36.94277631795717, -125.3830828659254, 380.9040223057269, -11.27598708757322, 176.47668132899867, -77.44992280699286, -122.16012368473424, -350.4760419843988, 371.8867860863296, -36.74351231214824, 109.34397558293364, 197.96362648414802, -80.06833318763461, -123.34915593450381, -210.88367934100197, -141.5349399508441, 204.94151023821647, -45.83226115892905, 351.6302636483013, -283.57888041853437, -290.1693190719714, 398.2, -132.39571245279035, 378.71616465664675, 96.28668467023226, -196.30824396429378, -81.26457657014492, 342.9084985545099, -69.63941956670624, -217.93690890230198, 138.1680959120032, -159.9861043066497, 163.6101952963238, -57.93437910123135, -162.93550209453176, 206.91112873449302, -269.0850351597421, -310.48067593138916, -194.8611106983713, -132.3443222913186, 75.2353010198211, -77.3976823081336, 227.5313124929794, -510.9367873641405, 187.64170987361467, -10.304885752635064, -167.52639754955956], "policy_predator_policy_reward": [43.357709334161186, 221.48042795969062, 152.2872288987516, 91.92015132039613, 207.4143326990214, 132.05939870438013, 132.95815036314985, 165.39233092012051, 455.88726495023064, 85.67071675657937, 92.48011949131029, 158.46194939225109, 390.0683391683163, 145.95259299165045, 518.9700219256634, 9.927584462841153, 313.14623721236643, 218.59082190642826, 331.84097057599854, 122.163301152162, 336.8429998676647, 269.2459534714868, 124.7772744608389, 270.76167076258014, 97.18891312348342, 186.4938789240137, 257.3039743046756, 260.31890391964606, 203.23925637685804, 177.3981964446243, 188.4426159355223, 466.3982475696508, 160.62653576837482, 239.73488518625425, 251.9306600162565, 45.51398946582324, 218.93746803281428, 82.76610122002357, 180.314741710978, 0.0, 285.0439912366295, 200.09323592061392, 163.5727829436333, 210.45410143820325, 117.13635604121207, 164.9205813015391, 322.21861535402473, 215.91236420176716, 313.3180749920078, 217.54852911365398, 268.0697695360381, 171.88714337250045, 396.37860831668655, 274.14277631795704, 341.48308286592555, 11.1959776942731, 248.57598708757337, 134.22331867100135, 301.9499228069929, 319.56012368473415, 492.27604198439906, 6.01321391367042, 243.14351231214803, 169.85602441706624, 121.43637351585208, 278.0683331876346, 345.84915593450387, 355.6836793410017, 344.53493995084403, 94.05848976178342, 282.13226115892905, 18.869736351698695, 413.47888041853446, 433.6693190719715, 0.0, 321.39571245279035, 3.883835343353244, 193.41331532976787, 385.40824396429315, 207.8645765701441, 31.091501445490078, 290.8394195667061, 381.7369089023021, 141.83190408799683, 361.9861043066497, 84.28980470367594, 299.63437910123133, 322.7355020945317, 118.088871265507, 406.4850351597419, 435.880675931389, 362.96111069837144, 311.94432229131854, 197.1646989801788, 283.99768230813385, 103.46868750702065, 594.1367873641407, 122.95829012638531, 259.30488575263513, 376.52639754955965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0228944456516045, "mean_inference_ms": 3.9060282764239918, "mean_action_processing_ms": 1.304693302573465, "mean_env_wait_ms": 10.073829277377667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01334679126739502, "StateBufferConnector_ms": 0.00889277458190918, "ViewRequirementAgentConnector_ms": 0.10587596893310547}, "num_episodes": 7, "episode_return_max": 398.2, "episode_return_min": 83.19999999999996, "episode_return_mean": 239.19999999999993, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.64255736058513, "num_env_steps_trained_throughput_per_sec": 160.64255736058513, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 25742.527, "restore_workers_time_ms": 0.04, "training_step_time_ms": 25742.212, "sample_time_ms": 1964.952, "learn_time_ms": 23748.443, "learn_throughput": 168.432, "synch_weights_time_ms": 25.905}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 34, "trial_id": "cbf82_00000", "date": "2024-08-21_13-22-13", "timestamp": 1724226733, "time_this_iter_s": 24.913644075393677, "time_total_s": 908.6881372928619, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e5aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 908.6881372928619, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 28.79428571428572, "ram_util_percent": 81.76285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.238444211644431, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.928390930593014, "policy_loss": -0.006795451155145808, "vf_loss": 5.933074467380842, "vf_explained_var": 0.17319085927059252, "kl": 0.010559535109011146, "entropy": 0.9402696414540211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 492.9399999999987}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.680421976869305, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.048272800445557, "policy_loss": -0.022338495660612048, "vf_loss": 7.067589416106542, "vf_explained_var": 0.17775685321539642, "kl": 0.015109523540983598, "entropy": 1.1009072945763667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 492.9399999999987}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 83.19999999999996, "episode_reward_mean": 240.79699999999997, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -510.9367873641405, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 594.1367873641407}, "policy_reward_mean": {"prey_policy": 6.282671032181918, "predator_policy": 234.51432896781805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.9, 268.19999999999993, 268.5999999999999, 123.0, 307.19999999999993, 108.1, 389.4, 231.0, 254.09999999999997, 103.09999999999997, 132.9000000000003, 185.69999999999996, 169.59999999999988, 297.2, 212.39999999999998, 286.39999999999975, 284.2, 305.6, 261.0, 269.1, 290.0, 264.0, 189.09999999999997, 287.0, 171.19999999999953, 225.6, 361.0, 225.29999999999987, 330.0, 213.69999999999968, 396.4, 224.19999999999996, 252.19999999999996, 179.0999999999993, 253.69999999999993, 295.3, 203.89999999999944, 222.29999999999998, 187.3, 196.3, 169.59999999999977, 182.50000000000009, 262.0999999999999, 185.1, 237.2, 216.1, 392.1, 237.3, 310.70000000000005, 224.49999999999997, 197.4, 141.8, 377.9, 206.39999999999998, 279.2, 319.4, 198.0, 222.49999999999991, 144.79999999999998, 203.0, 299.0000000000007, 236.3, 370.5, 129.89999999999992, 143.49999999999997, 398.2, 189.0, 382.6, 289.70000000000005, 189.1, 126.599999999999, 374.0, 221.2, 163.7999999999999, 279.9999999999999, 202.0, 247.89999999999978, 241.7, 159.8, 325.0, 137.3999999999998, 125.39999999999996, 168.1, 179.59999999999997, 272.4000000000002, 206.5999999999999, 331.0, 83.19999999999996, 310.59999999999997, 249.0, 209.0, 135.2, 329.90000000000003, 392.4, 265.2, 174.09999999999994, 188.39999999999998, 271.4, 380.0, 235.10000000000002], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [248.22928324342047, 175.71988050868976, 110.13805060774898, -267.06833916831675, 161.24740700834943, -410.8700219256637, 379.47241553715884, -82.14623721236667, 35.50917809357182, -228.7409705759992, 10.736698847838277, -151.1429998676645, -99.64595347148692, 172.42272553916118, -58.36167076258008, 189.21108687651628, 97.70612107598627, 48.296025695324296, 0.6810960803538393, 65.86074362314191, 112.60180355537588, 75.55738406447765, -277.2982475696506, 126.37346423162529, -68.53488518625436, -26.33066001625653, 315.4860105341767, 6.3625319671857925, 247.2338987799766, 33.385258289022005, 396.4, -60.843991236629435, 52.10676407938611, 15.527217056366698, 43.245898561796864, 178.16364395878784, 38.97941869846098, -99.91861535402455, -28.61236420176714, -117.01807499200773, -47.94852911365392, -85.5697695360379, 90.21285662749948, -211.2786083166867, -36.94277631795717, -125.3830828659254, 380.9040223057269, -11.27598708757322, 176.47668132899867, -77.44992280699286, -122.16012368473424, -350.4760419843988, 371.8867860863296, -36.74351231214824, 109.34397558293364, 197.96362648414802, -80.06833318763461, -123.34915593450381, -210.88367934100197, -141.5349399508441, 204.94151023821647, -45.83226115892905, 351.6302636483013, -283.57888041853437, -290.1693190719714, 398.2, -132.39571245279035, 378.71616465664675, 96.28668467023226, -196.30824396429378, -81.26457657014492, 342.9084985545099, -69.63941956670624, -217.93690890230198, 138.1680959120032, -159.9861043066497, 163.6101952963238, -57.93437910123135, -162.93550209453176, 206.91112873449302, -269.0850351597421, -310.48067593138916, -194.8611106983713, -132.3443222913186, 75.2353010198211, -77.3976823081336, 227.5313124929794, -510.9367873641405, 187.64170987361467, -10.304885752635064, -167.52639754955956, -426.6707933547557, 270.61559100022555, 387.21082219912813, 60.406055259894515, -180.08687242636842, -227.22305626122218, 66.56198176249418, 358.26992166657595, -107.5236680103214], "policy_predator_policy_reward": [85.67071675657937, 92.48011949131029, 158.46194939225109, 390.0683391683163, 145.95259299165045, 518.9700219256634, 9.927584462841153, 313.14623721236643, 218.59082190642826, 331.84097057599854, 122.163301152162, 336.8429998676647, 269.2459534714868, 124.7772744608389, 270.76167076258014, 97.18891312348342, 186.4938789240137, 257.3039743046756, 260.31890391964606, 203.23925637685804, 177.3981964446243, 188.4426159355223, 466.3982475696508, 160.62653576837482, 239.73488518625425, 251.9306600162565, 45.51398946582324, 218.93746803281428, 82.76610122002357, 180.314741710978, 0.0, 285.0439912366295, 200.09323592061392, 163.5727829436333, 210.45410143820325, 117.13635604121207, 164.9205813015391, 322.21861535402473, 215.91236420176716, 313.3180749920078, 217.54852911365398, 268.0697695360381, 171.88714337250045, 396.37860831668655, 274.14277631795704, 341.48308286592555, 11.1959776942731, 248.57598708757337, 134.22331867100135, 301.9499228069929, 319.56012368473415, 492.27604198439906, 6.01321391367042, 243.14351231214803, 169.85602441706624, 121.43637351585208, 278.0683331876346, 345.84915593450387, 355.6836793410017, 344.53493995084403, 94.05848976178342, 282.13226115892905, 18.869736351698695, 413.47888041853446, 433.6693190719715, 0.0, 321.39571245279035, 3.883835343353244, 193.41331532976787, 385.40824396429315, 207.8645765701441, 31.091501445490078, 290.8394195667061, 381.7369089023021, 141.83190408799683, 361.9861043066497, 84.28980470367594, 299.63437910123133, 322.7355020945317, 118.088871265507, 406.4850351597419, 435.880675931389, 362.96111069837144, 311.94432229131854, 197.1646989801788, 283.99768230813385, 103.46868750702065, 594.1367873641407, 122.95829012638531, 259.30488575263513, 376.52639754955965, 561.8707933547557, 59.28440899977449, 5.1891778008718505, 204.79394474010542, 354.18687242636815, 415.6230562612224, 204.8380182375058, 21.730078333424093, 342.6236680103214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.001630722604189, "mean_inference_ms": 3.8944854813422536, "mean_action_processing_ms": 1.2547052580274092, "mean_env_wait_ms": 10.07431531448549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013247013092041016, "StateBufferConnector_ms": 0.008507966995239258, "ViewRequirementAgentConnector_ms": 0.10814428329467773}, "num_episodes": 9, "episode_return_max": 398.2, "episode_return_min": 83.19999999999996, "episode_return_mean": 240.79699999999997, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.10648269817753, "num_env_steps_trained_throughput_per_sec": 159.10648269817753, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 25726.185, "restore_workers_time_ms": 0.04, "training_step_time_ms": 25725.905, "sample_time_ms": 1981.373, "learn_time_ms": 23716.992, "learn_throughput": 168.655, "synch_weights_time_ms": 25.03}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 35, "trial_id": "cbf82_00000", "date": "2024-08-21_13-22-38", "timestamp": 1724226758, "time_this_iter_s": 25.181068658828735, "time_total_s": 933.8692059516907, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177de7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 933.8692059516907, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.022222222222226, "ram_util_percent": 82.46388888888887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.255247454841932, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.826936309784651, "policy_loss": -0.010774766128937093, "vf_loss": 4.835384868333737, "vf_explained_var": 0.16092187371104955, "kl": 0.011631045552348951, "entropy": 1.050476249307394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.115648397306602, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.841626277814309, "policy_loss": -0.0207794917858943, "vf_loss": 5.859592430790266, "vf_explained_var": 0.13889754433184862, "kl": 0.01406662619265262, "entropy": 1.0896437691524625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 83.19999999999996, "episode_reward_mean": 239.8579999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -510.9367873641405, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 594.1367873641407}, "policy_reward_mean": {"prey_policy": 3.07704473658864, "predator_policy": 236.78095526341139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [169.59999999999988, 297.2, 212.39999999999998, 286.39999999999975, 284.2, 305.6, 261.0, 269.1, 290.0, 264.0, 189.09999999999997, 287.0, 171.19999999999953, 225.6, 361.0, 225.29999999999987, 330.0, 213.69999999999968, 396.4, 224.19999999999996, 252.19999999999996, 179.0999999999993, 253.69999999999993, 295.3, 203.89999999999944, 222.29999999999998, 187.3, 196.3, 169.59999999999977, 182.50000000000009, 262.0999999999999, 185.1, 237.2, 216.1, 392.1, 237.3, 310.70000000000005, 224.49999999999997, 197.4, 141.8, 377.9, 206.39999999999998, 279.2, 319.4, 198.0, 222.49999999999991, 144.79999999999998, 203.0, 299.0000000000007, 236.3, 370.5, 129.89999999999992, 143.49999999999997, 398.2, 189.0, 382.6, 289.70000000000005, 189.1, 126.599999999999, 374.0, 221.2, 163.7999999999999, 279.9999999999999, 202.0, 247.89999999999978, 241.7, 159.8, 325.0, 137.3999999999998, 125.39999999999996, 168.1, 179.59999999999997, 272.4000000000002, 206.5999999999999, 331.0, 83.19999999999996, 310.59999999999997, 249.0, 209.0, 135.2, 329.90000000000003, 392.4, 265.2, 174.09999999999994, 188.39999999999998, 271.4, 380.0, 235.10000000000002, 133.4999999999997, 287.2, 229.10000000000002, 132.09999999999997, 360.8, 238.2, 382.7, 143.49999999999972, 267.6, 124.00000000000026, 227.4999999999997, 85.09999999999994], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-99.64595347148692, 172.42272553916118, -58.36167076258008, 189.21108687651628, 97.70612107598627, 48.296025695324296, 0.6810960803538393, 65.86074362314191, 112.60180355537588, 75.55738406447765, -277.2982475696506, 126.37346423162529, -68.53488518625436, -26.33066001625653, 315.4860105341767, 6.3625319671857925, 247.2338987799766, 33.385258289022005, 396.4, -60.843991236629435, 52.10676407938611, 15.527217056366698, 43.245898561796864, 178.16364395878784, 38.97941869846098, -99.91861535402455, -28.61236420176714, -117.01807499200773, -47.94852911365392, -85.5697695360379, 90.21285662749948, -211.2786083166867, -36.94277631795717, -125.3830828659254, 380.9040223057269, -11.27598708757322, 176.47668132899867, -77.44992280699286, -122.16012368473424, -350.4760419843988, 371.8867860863296, -36.74351231214824, 109.34397558293364, 197.96362648414802, -80.06833318763461, -123.34915593450381, -210.88367934100197, -141.5349399508441, 204.94151023821647, -45.83226115892905, 351.6302636483013, -283.57888041853437, -290.1693190719714, 398.2, -132.39571245279035, 378.71616465664675, 96.28668467023226, -196.30824396429378, -81.26457657014492, 342.9084985545099, -69.63941956670624, -217.93690890230198, 138.1680959120032, -159.9861043066497, 163.6101952963238, -57.93437910123135, -162.93550209453176, 206.91112873449302, -269.0850351597421, -310.48067593138916, -194.8611106983713, -132.3443222913186, 75.2353010198211, -77.3976823081336, 227.5313124929794, -510.9367873641405, 187.64170987361467, -10.304885752635064, -167.52639754955956, -426.6707933547557, 270.61559100022555, 387.21082219912813, 60.406055259894515, -180.08687242636842, -227.22305626122218, 66.56198176249418, 358.26992166657595, -107.5236680103214, -243.08853893099854, 130.70338024264993, -21.037820058579086, -360.6483276238888, 323.041920010763, -61.97118867079985, 373.24871596704406, -181.22189733488227, 70.16582794120126, 61.70360499581665, -5.3852993977215835, -424.9886616031664], "policy_predator_policy_reward": [269.2459534714868, 124.7772744608389, 270.76167076258014, 97.18891312348342, 186.4938789240137, 257.3039743046756, 260.31890391964606, 203.23925637685804, 177.3981964446243, 188.4426159355223, 466.3982475696508, 160.62653576837482, 239.73488518625425, 251.9306600162565, 45.51398946582324, 218.93746803281428, 82.76610122002357, 180.314741710978, 0.0, 285.0439912366295, 200.09323592061392, 163.5727829436333, 210.45410143820325, 117.13635604121207, 164.9205813015391, 322.21861535402473, 215.91236420176716, 313.3180749920078, 217.54852911365398, 268.0697695360381, 171.88714337250045, 396.37860831668655, 274.14277631795704, 341.48308286592555, 11.1959776942731, 248.57598708757337, 134.22331867100135, 301.9499228069929, 319.56012368473415, 492.27604198439906, 6.01321391367042, 243.14351231214803, 169.85602441706624, 121.43637351585208, 278.0683331876346, 345.84915593450387, 355.6836793410017, 344.53493995084403, 94.05848976178342, 282.13226115892905, 18.869736351698695, 413.47888041853446, 433.6693190719715, 0.0, 321.39571245279035, 3.883835343353244, 193.41331532976787, 385.40824396429315, 207.8645765701441, 31.091501445490078, 290.8394195667061, 381.7369089023021, 141.83190408799683, 361.9861043066497, 84.28980470367594, 299.63437910123133, 322.7355020945317, 118.088871265507, 406.4850351597419, 435.880675931389, 362.96111069837144, 311.94432229131854, 197.1646989801788, 283.99768230813385, 103.46868750702065, 594.1367873641407, 122.95829012638531, 259.30488575263513, 376.52639754955965, 561.8707933547557, 59.28440899977449, 5.1891778008718505, 204.79394474010542, 354.18687242636815, 415.6230562612224, 204.8380182375058, 21.730078333424093, 342.6236680103214, 376.5885389309984, 156.49661975734998, 250.13782005857914, 492.74832762388894, 37.75807998923693, 300.17118867079995, 9.451284032955936, 324.721897334882, 197.4341720587988, 62.29639500418336, 232.88529939772164, 510.08866160316643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.978678515233398, "mean_inference_ms": 3.8541822628887004, "mean_action_processing_ms": 1.2459892244738486, "mean_env_wait_ms": 10.071679200483347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01457679271697998, "StateBufferConnector_ms": 0.008588552474975586, "ViewRequirementAgentConnector_ms": 0.11297440528869629}, "num_episodes": 12, "episode_return_max": 398.2, "episode_return_min": 83.19999999999996, "episode_return_mean": 239.8579999999999, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.28708645948203, "num_env_steps_trained_throughput_per_sec": 160.28708645948203, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 25526.677, "restore_workers_time_ms": 0.041, "training_step_time_ms": 25526.398, "sample_time_ms": 1925.199, "learn_time_ms": 23574.067, "learn_throughput": 169.678, "synch_weights_time_ms": 24.672}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 36, "trial_id": "cbf82_00000", "date": "2024-08-21_13-23-03", "timestamp": 1724226783, "time_this_iter_s": 24.96423602104187, "time_total_s": 958.8334419727325, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e39550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 958.8334419727325, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 29.255555555555556, "ram_util_percent": 82.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3542243911574285, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.80607291907072, "policy_loss": -0.013773606884933542, "vf_loss": 5.817723603794972, "vf_explained_var": 0.14251100849360226, "kl": 0.010614581637006874, "entropy": 1.004614183306694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.696533264654379, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.873831635216872, "policy_loss": -0.022200095492977804, "vf_loss": 6.892835613091787, "vf_explained_var": -0.00994421485811472, "kl": 0.015980682963466584, "entropy": 1.0785106311862667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 83.19999999999996, "episode_reward_mean": 238.66399999999993, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -510.9367873641405, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 594.1367873641407}, "policy_reward_mean": {"prey_policy": 1.7238727612690679, "predator_policy": 236.94012723873092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.0, 264.0, 189.09999999999997, 287.0, 171.19999999999953, 225.6, 361.0, 225.29999999999987, 330.0, 213.69999999999968, 396.4, 224.19999999999996, 252.19999999999996, 179.0999999999993, 253.69999999999993, 295.3, 203.89999999999944, 222.29999999999998, 187.3, 196.3, 169.59999999999977, 182.50000000000009, 262.0999999999999, 185.1, 237.2, 216.1, 392.1, 237.3, 310.70000000000005, 224.49999999999997, 197.4, 141.8, 377.9, 206.39999999999998, 279.2, 319.4, 198.0, 222.49999999999991, 144.79999999999998, 203.0, 299.0000000000007, 236.3, 370.5, 129.89999999999992, 143.49999999999997, 398.2, 189.0, 382.6, 289.70000000000005, 189.1, 126.599999999999, 374.0, 221.2, 163.7999999999999, 279.9999999999999, 202.0, 247.89999999999978, 241.7, 159.8, 325.0, 137.3999999999998, 125.39999999999996, 168.1, 179.59999999999997, 272.4000000000002, 206.5999999999999, 331.0, 83.19999999999996, 310.59999999999997, 249.0, 209.0, 135.2, 329.90000000000003, 392.4, 265.2, 174.09999999999994, 188.39999999999998, 271.4, 380.0, 235.10000000000002, 133.4999999999997, 287.2, 229.10000000000002, 132.09999999999997, 360.8, 238.2, 382.7, 143.49999999999972, 267.6, 124.00000000000026, 227.4999999999997, 85.09999999999994, 241.5, 261.30000000000007, 297.30000000000007, 228.99999999999994, 267.79999999999984, 178.69999999999973, 211.39999999999998, 279.09999999999997], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [112.60180355537588, 75.55738406447765, -277.2982475696506, 126.37346423162529, -68.53488518625436, -26.33066001625653, 315.4860105341767, 6.3625319671857925, 247.2338987799766, 33.385258289022005, 396.4, -60.843991236629435, 52.10676407938611, 15.527217056366698, 43.245898561796864, 178.16364395878784, 38.97941869846098, -99.91861535402455, -28.61236420176714, -117.01807499200773, -47.94852911365392, -85.5697695360379, 90.21285662749948, -211.2786083166867, -36.94277631795717, -125.3830828659254, 380.9040223057269, -11.27598708757322, 176.47668132899867, -77.44992280699286, -122.16012368473424, -350.4760419843988, 371.8867860863296, -36.74351231214824, 109.34397558293364, 197.96362648414802, -80.06833318763461, -123.34915593450381, -210.88367934100197, -141.5349399508441, 204.94151023821647, -45.83226115892905, 351.6302636483013, -283.57888041853437, -290.1693190719714, 398.2, -132.39571245279035, 378.71616465664675, 96.28668467023226, -196.30824396429378, -81.26457657014492, 342.9084985545099, -69.63941956670624, -217.93690890230198, 138.1680959120032, -159.9861043066497, 163.6101952963238, -57.93437910123135, -162.93550209453176, 206.91112873449302, -269.0850351597421, -310.48067593138916, -194.8611106983713, -132.3443222913186, 75.2353010198211, -77.3976823081336, 227.5313124929794, -510.9367873641405, 187.64170987361467, -10.304885752635064, -167.52639754955956, -426.6707933547557, 270.61559100022555, 387.21082219912813, 60.406055259894515, -180.08687242636842, -227.22305626122218, 66.56198176249418, 358.26992166657595, -107.5236680103214, -243.08853893099854, 130.70338024264993, -21.037820058579086, -360.6483276238888, 323.041920010763, -61.97118867079985, 373.24871596704406, -181.22189733488227, 70.16582794120126, 61.70360499581665, -5.3852993977215835, -424.9886616031664, 7.164675116556198, 84.67258446118748, 146.02961789627838, -62.63196651441463, 165.68849979871996, -148.7666766873097, -45.049069350590926, 133.74531240403257], "policy_predator_policy_reward": [177.3981964446243, 188.4426159355223, 466.3982475696508, 160.62653576837482, 239.73488518625425, 251.9306600162565, 45.51398946582324, 218.93746803281428, 82.76610122002357, 180.314741710978, 0.0, 285.0439912366295, 200.09323592061392, 163.5727829436333, 210.45410143820325, 117.13635604121207, 164.9205813015391, 322.21861535402473, 215.91236420176716, 313.3180749920078, 217.54852911365398, 268.0697695360381, 171.88714337250045, 396.37860831668655, 274.14277631795704, 341.48308286592555, 11.1959776942731, 248.57598708757337, 134.22331867100135, 301.9499228069929, 319.56012368473415, 492.27604198439906, 6.01321391367042, 243.14351231214803, 169.85602441706624, 121.43637351585208, 278.0683331876346, 345.84915593450387, 355.6836793410017, 344.53493995084403, 94.05848976178342, 282.13226115892905, 18.869736351698695, 413.47888041853446, 433.6693190719715, 0.0, 321.39571245279035, 3.883835343353244, 193.41331532976787, 385.40824396429315, 207.8645765701441, 31.091501445490078, 290.8394195667061, 381.7369089023021, 141.83190408799683, 361.9861043066497, 84.28980470367594, 299.63437910123133, 322.7355020945317, 118.088871265507, 406.4850351597419, 435.880675931389, 362.96111069837144, 311.94432229131854, 197.1646989801788, 283.99768230813385, 103.46868750702065, 594.1367873641407, 122.95829012638531, 259.30488575263513, 376.52639754955965, 561.8707933547557, 59.28440899977449, 5.1891778008718505, 204.79394474010542, 354.18687242636815, 415.6230562612224, 204.8380182375058, 21.730078333424093, 342.6236680103214, 376.5885389309984, 156.49661975734998, 250.13782005857914, 492.74832762388894, 37.75807998923693, 300.17118867079995, 9.451284032955936, 324.721897334882, 197.4341720587988, 62.29639500418336, 232.88529939772164, 510.08866160316643, 234.335324883444, 176.6274155388125, 151.27038210372163, 291.6319665144148, 102.11150020128015, 327.46667668730953, 256.449069350591, 145.35468759596753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.959131926469674, "mean_inference_ms": 3.834373413463396, "mean_action_processing_ms": 1.2256738144379538, "mean_env_wait_ms": 10.069620842232025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014481306076049805, "StateBufferConnector_ms": 0.008556962013244629, "ViewRequirementAgentConnector_ms": 0.11185777187347412}, "num_episodes": 8, "episode_return_max": 398.2, "episode_return_min": 83.19999999999996, "episode_return_mean": 238.66399999999993, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.72385693427861, "num_env_steps_trained_throughput_per_sec": 159.72385693427861, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 25474.817, "restore_workers_time_ms": 0.041, "training_step_time_ms": 25474.45, "sample_time_ms": 1936.632, "learn_time_ms": 23512.966, "learn_throughput": 170.119, "synch_weights_time_ms": 22.563}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 37, "trial_id": "cbf82_00000", "date": "2024-08-21_13-23-28", "timestamp": 1724226808, "time_this_iter_s": 25.063635110855103, "time_total_s": 983.8970770835876, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e39430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 983.8970770835876, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 30.279999999999998, "ram_util_percent": 82.86285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8817472334951164, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.398312148451805, "policy_loss": -0.0053935953415930275, "vf_loss": 5.40170738051335, "vf_explained_var": 0.16401189429064592, "kl": 0.009991783388250042, "entropy": 0.9850342309102416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.636922666678826, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.411052900056045, "policy_loss": -0.02191055410997554, "vf_loss": 6.429933061202367, "vf_explained_var": 0.055402507570882636, "kl": 0.015151935083364758, "entropy": 1.0948094548036655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 83.19999999999996, "episode_reward_mean": 226.7609999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -510.9367873641405, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 594.1367873641407}, "policy_reward_mean": {"prey_policy": -21.313026504320707, "predator_policy": 248.07402650432067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.19999999999996, 252.19999999999996, 179.0999999999993, 253.69999999999993, 295.3, 203.89999999999944, 222.29999999999998, 187.3, 196.3, 169.59999999999977, 182.50000000000009, 262.0999999999999, 185.1, 237.2, 216.1, 392.1, 237.3, 310.70000000000005, 224.49999999999997, 197.4, 141.8, 377.9, 206.39999999999998, 279.2, 319.4, 198.0, 222.49999999999991, 144.79999999999998, 203.0, 299.0000000000007, 236.3, 370.5, 129.89999999999992, 143.49999999999997, 398.2, 189.0, 382.6, 289.70000000000005, 189.1, 126.599999999999, 374.0, 221.2, 163.7999999999999, 279.9999999999999, 202.0, 247.89999999999978, 241.7, 159.8, 325.0, 137.3999999999998, 125.39999999999996, 168.1, 179.59999999999997, 272.4000000000002, 206.5999999999999, 331.0, 83.19999999999996, 310.59999999999997, 249.0, 209.0, 135.2, 329.90000000000003, 392.4, 265.2, 174.09999999999994, 188.39999999999998, 271.4, 380.0, 235.10000000000002, 133.4999999999997, 287.2, 229.10000000000002, 132.09999999999997, 360.8, 238.2, 382.7, 143.49999999999972, 267.6, 124.00000000000026, 227.4999999999997, 85.09999999999994, 241.5, 261.30000000000007, 297.30000000000007, 228.99999999999994, 267.79999999999984, 178.69999999999973, 211.39999999999998, 279.09999999999997, 83.99999999999893, 283.6, 155.1, 292.3000000000003, 138.2, 105.00000000000011, 159.09999999999982, 130.59999999999891, 168.59999999999994, 85.9999999999989, 160.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-60.843991236629435, 52.10676407938611, 15.527217056366698, 43.245898561796864, 178.16364395878784, 38.97941869846098, -99.91861535402455, -28.61236420176714, -117.01807499200773, -47.94852911365392, -85.5697695360379, 90.21285662749948, -211.2786083166867, -36.94277631795717, -125.3830828659254, 380.9040223057269, -11.27598708757322, 176.47668132899867, -77.44992280699286, -122.16012368473424, -350.4760419843988, 371.8867860863296, -36.74351231214824, 109.34397558293364, 197.96362648414802, -80.06833318763461, -123.34915593450381, -210.88367934100197, -141.5349399508441, 204.94151023821647, -45.83226115892905, 351.6302636483013, -283.57888041853437, -290.1693190719714, 398.2, -132.39571245279035, 378.71616465664675, 96.28668467023226, -196.30824396429378, -81.26457657014492, 342.9084985545099, -69.63941956670624, -217.93690890230198, 138.1680959120032, -159.9861043066497, 163.6101952963238, -57.93437910123135, -162.93550209453176, 206.91112873449302, -269.0850351597421, -310.48067593138916, -194.8611106983713, -132.3443222913186, 75.2353010198211, -77.3976823081336, 227.5313124929794, -510.9367873641405, 187.64170987361467, -10.304885752635064, -167.52639754955956, -426.6707933547557, 270.61559100022555, 387.21082219912813, 60.406055259894515, -180.08687242636842, -227.22305626122218, 66.56198176249418, 358.26992166657595, -107.5236680103214, -243.08853893099854, 130.70338024264993, -21.037820058579086, -360.6483276238888, 323.041920010763, -61.97118867079985, 373.24871596704406, -181.22189733488227, 70.16582794120126, 61.70360499581665, -5.3852993977215835, -424.9886616031664, 7.164675116556198, 84.67258446118748, 146.02961789627838, -62.63196651441463, 165.68849979871996, -148.7666766873097, -45.049069350590926, 133.74531240403257, -58.66530564418129, 134.71421791976087, -293.71714616136717, 115.18028448073068, -351.3510887612847, -271.8615272755738, -249.99679333945411, 7.210926291858886, -147.1845465353328, -14.372179764750813, -232.41020911970418], "policy_predator_policy_reward": [285.0439912366295, 200.09323592061392, 163.5727829436333, 210.45410143820325, 117.13635604121207, 164.9205813015391, 322.21861535402473, 215.91236420176716, 313.3180749920078, 217.54852911365398, 268.0697695360381, 171.88714337250045, 396.37860831668655, 274.14277631795704, 341.48308286592555, 11.1959776942731, 248.57598708757337, 134.22331867100135, 301.9499228069929, 319.56012368473415, 492.27604198439906, 6.01321391367042, 243.14351231214803, 169.85602441706624, 121.43637351585208, 278.0683331876346, 345.84915593450387, 355.6836793410017, 344.53493995084403, 94.05848976178342, 282.13226115892905, 18.869736351698695, 413.47888041853446, 433.6693190719715, 0.0, 321.39571245279035, 3.883835343353244, 193.41331532976787, 385.40824396429315, 207.8645765701441, 31.091501445490078, 290.8394195667061, 381.7369089023021, 141.83190408799683, 361.9861043066497, 84.28980470367594, 299.63437910123133, 322.7355020945317, 118.088871265507, 406.4850351597419, 435.880675931389, 362.96111069837144, 311.94432229131854, 197.1646989801788, 283.99768230813385, 103.46868750702065, 594.1367873641407, 122.95829012638531, 259.30488575263513, 376.52639754955965, 561.8707933547557, 59.28440899977449, 5.1891778008718505, 204.79394474010542, 354.18687242636815, 415.6230562612224, 204.8380182375058, 21.730078333424093, 342.6236680103214, 376.5885389309984, 156.49661975734998, 250.13782005857914, 492.74832762388894, 37.75807998923693, 300.17118867079995, 9.451284032955936, 324.721897334882, 197.4341720587988, 62.29639500418336, 232.88529939772164, 510.08866160316643, 234.335324883444, 176.6274155388125, 151.27038210372163, 291.6319665144148, 102.11150020128015, 327.46667668730953, 256.449069350591, 145.35468759596753, 142.66530564418022, 148.88578208023915, 448.8171461613669, 177.1197155192693, 489.55108876128475, 376.86152727557305, 409.0967933394549, 123.38907370814103, 315.7845465353326, 100.37217976475101, 392.91020911970435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9262497201180344, "mean_inference_ms": 3.817850688823013, "mean_action_processing_ms": 1.184893892973746, "mean_env_wait_ms": 10.06548347924507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008943676948547363, "StateBufferConnector_ms": 0.0073316097259521484, "ViewRequirementAgentConnector_ms": 0.07126283645629883}, "num_episodes": 11, "episode_return_max": 398.2, "episode_return_min": 83.19999999999996, "episode_return_mean": 226.7609999999999, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.76303322294868, "num_env_steps_trained_throughput_per_sec": 160.76303322294868, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 25196.768, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25196.442, "sample_time_ms": 1869.875, "learn_time_ms": 23301.744, "learn_throughput": 171.661, "synch_weights_time_ms": 22.55}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 38, "trial_id": "cbf82_00000", "date": "2024-08-21_13-23-53", "timestamp": 1724226833, "time_this_iter_s": 24.90486192703247, "time_total_s": 1008.8019390106201, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e26ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1008.8019390106201, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 28.57222222222222, "ram_util_percent": 82.87222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.673136449605226, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.349808874974648, "policy_loss": -0.009293514359887923, "vf_loss": 5.356820986668269, "vf_explained_var": 0.18223756837348143, "kl": 0.011407033871364547, "entropy": 0.9844498661036293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.497659742087126, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.485784588754177, "policy_loss": -0.020447041804679125, "vf_loss": 6.502882625659307, "vf_explained_var": 0.21233375643690428, "kl": 0.016744984541340577, "entropy": 1.0782860700661938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 66.49999999999989, "episode_reward_mean": 218.84999999999988, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -510.9367873641405, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 596.5885188675469}, "policy_reward_mean": {"prey_policy": -37.809074064401756, "predator_policy": 256.6590740644017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [197.4, 141.8, 377.9, 206.39999999999998, 279.2, 319.4, 198.0, 222.49999999999991, 144.79999999999998, 203.0, 299.0000000000007, 236.3, 370.5, 129.89999999999992, 143.49999999999997, 398.2, 189.0, 382.6, 289.70000000000005, 189.1, 126.599999999999, 374.0, 221.2, 163.7999999999999, 279.9999999999999, 202.0, 247.89999999999978, 241.7, 159.8, 325.0, 137.3999999999998, 125.39999999999996, 168.1, 179.59999999999997, 272.4000000000002, 206.5999999999999, 331.0, 83.19999999999996, 310.59999999999997, 249.0, 209.0, 135.2, 329.90000000000003, 392.4, 265.2, 174.09999999999994, 188.39999999999998, 271.4, 380.0, 235.10000000000002, 133.4999999999997, 287.2, 229.10000000000002, 132.09999999999997, 360.8, 238.2, 382.7, 143.49999999999972, 267.6, 124.00000000000026, 227.4999999999997, 85.09999999999994, 241.5, 261.30000000000007, 297.30000000000007, 228.99999999999994, 267.79999999999984, 178.69999999999973, 211.39999999999998, 279.09999999999997, 83.99999999999893, 283.6, 155.1, 292.3000000000003, 138.2, 105.00000000000011, 159.09999999999982, 130.59999999999891, 168.59999999999994, 85.9999999999989, 160.5, 252.10000000000002, 199.9, 214.1999999999996, 179.8, 198.09999999999997, 88.09999999999874, 141.40000000000015, 207.19999999999982, 150.5999999999994, 241.19999999999996, 168.4, 66.49999999999989, 335.4, 226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-122.16012368473424, -350.4760419843988, 371.8867860863296, -36.74351231214824, 109.34397558293364, 197.96362648414802, -80.06833318763461, -123.34915593450381, -210.88367934100197, -141.5349399508441, 204.94151023821647, -45.83226115892905, 351.6302636483013, -283.57888041853437, -290.1693190719714, 398.2, -132.39571245279035, 378.71616465664675, 96.28668467023226, -196.30824396429378, -81.26457657014492, 342.9084985545099, -69.63941956670624, -217.93690890230198, 138.1680959120032, -159.9861043066497, 163.6101952963238, -57.93437910123135, -162.93550209453176, 206.91112873449302, -269.0850351597421, -310.48067593138916, -194.8611106983713, -132.3443222913186, 75.2353010198211, -77.3976823081336, 227.5313124929794, -510.9367873641405, 187.64170987361467, -10.304885752635064, -167.52639754955956, -426.6707933547557, 270.61559100022555, 387.21082219912813, 60.406055259894515, -180.08687242636842, -227.22305626122218, 66.56198176249418, 358.26992166657595, -107.5236680103214, -243.08853893099854, 130.70338024264993, -21.037820058579086, -360.6483276238888, 323.041920010763, -61.97118867079985, 373.24871596704406, -181.22189733488227, 70.16582794120126, 61.70360499581665, -5.3852993977215835, -424.9886616031664, 7.164675116556198, 84.67258446118748, 146.02961789627838, -62.63196651441463, 165.68849979871996, -148.7666766873097, -45.049069350590926, 133.74531240403257, -58.66530564418129, 134.71421791976087, -293.71714616136717, 115.18028448073068, -351.3510887612847, -271.8615272755738, -249.99679333945411, 7.210926291858886, -147.1845465353328, -14.372179764750813, -232.41020911970418, -3.591608032537586, -93.54931024528395, -27.119329413298278, -193.27261984242426, -143.11455720289334, 1.5020764293308064, 138.68631215593126, -65.45038870011493, -21.521428531817588, -41.93249598514751, -254.32315481435495, -425.60452003939463, 286.25079945839934, -118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694], "policy_predator_policy_reward": [319.56012368473415, 492.27604198439906, 6.01321391367042, 243.14351231214803, 169.85602441706624, 121.43637351585208, 278.0683331876346, 345.84915593450387, 355.6836793410017, 344.53493995084403, 94.05848976178342, 282.13226115892905, 18.869736351698695, 413.47888041853446, 433.6693190719715, 0.0, 321.39571245279035, 3.883835343353244, 193.41331532976787, 385.40824396429315, 207.8645765701441, 31.091501445490078, 290.8394195667061, 381.7369089023021, 141.83190408799683, 361.9861043066497, 84.28980470367594, 299.63437910123133, 322.7355020945317, 118.088871265507, 406.4850351597419, 435.880675931389, 362.96111069837144, 311.94432229131854, 197.1646989801788, 283.99768230813385, 103.46868750702065, 594.1367873641407, 122.95829012638531, 259.30488575263513, 376.52639754955965, 561.8707933547557, 59.28440899977449, 5.1891778008718505, 204.79394474010542, 354.18687242636815, 415.6230562612224, 204.8380182375058, 21.730078333424093, 342.6236680103214, 376.5885389309984, 156.49661975734998, 250.13782005857914, 492.74832762388894, 37.75807998923693, 300.17118867079995, 9.451284032955936, 324.721897334882, 197.4341720587988, 62.29639500418336, 232.88529939772164, 510.08866160316643, 234.335324883444, 176.6274155388125, 151.27038210372163, 291.6319665144148, 102.11150020128015, 327.46667668730953, 256.449069350591, 145.35468759596753, 142.66530564418022, 148.88578208023915, 448.8171461613669, 177.1197155192693, 489.55108876128475, 376.86152727557305, 409.0967933394549, 123.38907370814103, 315.7845465353326, 100.37217976475101, 392.91020911970435, 255.69160803253743, 293.44931024528387, 241.31932941329825, 373.0726198424244, 341.2145572028932, 86.59792357066921, 2.713687844068848, 272.6503887001151, 172.12142853181703, 283.13249598514756, 422.72315481435487, 492.10452003939594, 49.14920054160066, 344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8773299051313637, "mean_inference_ms": 3.7225636651111995, "mean_action_processing_ms": 1.2082209810624012, "mean_env_wait_ms": 10.059063509342023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008624076843261719, "StateBufferConnector_ms": 0.007313370704650879, "ViewRequirementAgentConnector_ms": 0.06512868404388428}, "num_episodes": 19, "episode_return_max": 398.2, "episode_return_min": 66.49999999999989, "episode_return_mean": 218.84999999999988, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.21363217112085, "num_env_steps_trained_throughput_per_sec": 156.21363217112085, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 25227.874, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25227.631, "sample_time_ms": 1859.229, "learn_time_ms": 23341.963, "learn_throughput": 171.365, "synch_weights_time_ms": 24.166}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 39, "trial_id": "cbf82_00000", "date": "2024-08-21_13-24-19", "timestamp": 1724226859, "time_this_iter_s": 25.654812812805176, "time_total_s": 1034.4567518234253, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e26e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1034.4567518234253, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 32.522222222222226, "ram_util_percent": 82.89166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.045030126099785, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.807032162944476, "policy_loss": -0.014011011195058624, "vf_loss": 4.818665570517381, "vf_explained_var": 0.19701962750405072, "kl": 0.011887994588323635, "entropy": 0.9549782982716958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.932939635093014, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.127476630608241, "policy_loss": -0.022295392149438462, "vf_loss": 6.146512570977211, "vf_explained_var": 0.08748565142353376, "kl": 0.01629722855674724, "entropy": 1.0911082743977507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 58.500000000000355, "episode_reward_mean": 215.42099999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -510.9367873641405, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 596.5885188675469}, "policy_reward_mean": {"prey_policy": -39.47680688680901, "predator_policy": 254.89780688680895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.0, 299.0000000000007, 236.3, 370.5, 129.89999999999992, 143.49999999999997, 398.2, 189.0, 382.6, 289.70000000000005, 189.1, 126.599999999999, 374.0, 221.2, 163.7999999999999, 279.9999999999999, 202.0, 247.89999999999978, 241.7, 159.8, 325.0, 137.3999999999998, 125.39999999999996, 168.1, 179.59999999999997, 272.4000000000002, 206.5999999999999, 331.0, 83.19999999999996, 310.59999999999997, 249.0, 209.0, 135.2, 329.90000000000003, 392.4, 265.2, 174.09999999999994, 188.39999999999998, 271.4, 380.0, 235.10000000000002, 133.4999999999997, 287.2, 229.10000000000002, 132.09999999999997, 360.8, 238.2, 382.7, 143.49999999999972, 267.6, 124.00000000000026, 227.4999999999997, 85.09999999999994, 241.5, 261.30000000000007, 297.30000000000007, 228.99999999999994, 267.79999999999984, 178.69999999999973, 211.39999999999998, 279.09999999999997, 83.99999999999893, 283.6, 155.1, 292.3000000000003, 138.2, 105.00000000000011, 159.09999999999982, 130.59999999999891, 168.59999999999994, 85.9999999999989, 160.5, 252.10000000000002, 199.9, 214.1999999999996, 179.8, 198.09999999999997, 88.09999999999874, 141.40000000000015, 207.19999999999982, 150.5999999999994, 241.19999999999996, 168.4, 66.49999999999989, 335.4, 226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001, 221.5, 101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-141.5349399508441, 204.94151023821647, -45.83226115892905, 351.6302636483013, -283.57888041853437, -290.1693190719714, 398.2, -132.39571245279035, 378.71616465664675, 96.28668467023226, -196.30824396429378, -81.26457657014492, 342.9084985545099, -69.63941956670624, -217.93690890230198, 138.1680959120032, -159.9861043066497, 163.6101952963238, -57.93437910123135, -162.93550209453176, 206.91112873449302, -269.0850351597421, -310.48067593138916, -194.8611106983713, -132.3443222913186, 75.2353010198211, -77.3976823081336, 227.5313124929794, -510.9367873641405, 187.64170987361467, -10.304885752635064, -167.52639754955956, -426.6707933547557, 270.61559100022555, 387.21082219912813, 60.406055259894515, -180.08687242636842, -227.22305626122218, 66.56198176249418, 358.26992166657595, -107.5236680103214, -243.08853893099854, 130.70338024264993, -21.037820058579086, -360.6483276238888, 323.041920010763, -61.97118867079985, 373.24871596704406, -181.22189733488227, 70.16582794120126, 61.70360499581665, -5.3852993977215835, -424.9886616031664, 7.164675116556198, 84.67258446118748, 146.02961789627838, -62.63196651441463, 165.68849979871996, -148.7666766873097, -45.049069350590926, 133.74531240403257, -58.66530564418129, 134.71421791976087, -293.71714616136717, 115.18028448073068, -351.3510887612847, -271.8615272755738, -249.99679333945411, 7.210926291858886, -147.1845465353328, -14.372179764750813, -232.41020911970418, -3.591608032537586, -93.54931024528395, -27.119329413298278, -193.27261984242426, -143.11455720289334, 1.5020764293308064, 138.68631215593126, -65.45038870011493, -21.521428531817588, -41.93249598514751, -254.32315481435495, -425.60452003939463, 286.25079945839934, -118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694, -162.30102614826558, -135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114], "policy_predator_policy_reward": [344.53493995084403, 94.05848976178342, 282.13226115892905, 18.869736351698695, 413.47888041853446, 433.6693190719715, 0.0, 321.39571245279035, 3.883835343353244, 193.41331532976787, 385.40824396429315, 207.8645765701441, 31.091501445490078, 290.8394195667061, 381.7369089023021, 141.83190408799683, 361.9861043066497, 84.28980470367594, 299.63437910123133, 322.7355020945317, 118.088871265507, 406.4850351597419, 435.880675931389, 362.96111069837144, 311.94432229131854, 197.1646989801788, 283.99768230813385, 103.46868750702065, 594.1367873641407, 122.95829012638531, 259.30488575263513, 376.52639754955965, 561.8707933547557, 59.28440899977449, 5.1891778008718505, 204.79394474010542, 354.18687242636815, 415.6230562612224, 204.8380182375058, 21.730078333424093, 342.6236680103214, 376.5885389309984, 156.49661975734998, 250.13782005857914, 492.74832762388894, 37.75807998923693, 300.17118867079995, 9.451284032955936, 324.721897334882, 197.4341720587988, 62.29639500418336, 232.88529939772164, 510.08866160316643, 234.335324883444, 176.6274155388125, 151.27038210372163, 291.6319665144148, 102.11150020128015, 327.46667668730953, 256.449069350591, 145.35468759596753, 142.66530564418022, 148.88578208023915, 448.8171461613669, 177.1197155192693, 489.55108876128475, 376.86152727557305, 409.0967933394549, 123.38907370814103, 315.7845465353326, 100.37217976475101, 392.91020911970435, 255.69160803253743, 293.44931024528387, 241.31932941329825, 373.0726198424244, 341.2145572028932, 86.59792357066921, 2.713687844068848, 272.6503887001151, 172.12142853181703, 283.13249598514756, 422.72315481435487, 492.10452003939594, 49.14920054160066, 344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469, 383.80102614826563, 237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.855254239563869, "mean_inference_ms": 3.7154877361028826, "mean_action_processing_ms": 1.17464890578764, "mean_env_wait_ms": 10.045467876368916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008497357368469238, "StateBufferConnector_ms": 0.007279157638549805, "ViewRequirementAgentConnector_ms": 0.06533956527709961}, "num_episodes": 9, "episode_return_max": 398.2, "episode_return_min": 58.500000000000355, "episode_return_mean": 215.42099999999994, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.18188717323233, "num_env_steps_trained_throughput_per_sec": 159.18188717323233, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 25072.532, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25072.263, "sample_time_ms": 1810.862, "learn_time_ms": 23233.824, "learn_throughput": 172.163, "synch_weights_time_ms": 25.299}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 40, "trial_id": "cbf82_00000", "date": "2024-08-21_13-24-44", "timestamp": 1724226884, "time_this_iter_s": 25.164188861846924, "time_total_s": 1059.6209406852722, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075b84c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1059.6209406852722, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 34.32777777777778, "ram_util_percent": 83.2027777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.425651921269794, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.241719030837218, "policy_loss": -0.010352181848914673, "vf_loss": 5.25012592424949, "vf_explained_var": 0.170555394453307, "kl": 0.009726468949277962, "entropy": 1.0023186165839433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.084279363540311, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.509689305722714, "policy_loss": -0.016746160383627286, "vf_loss": 6.523447804649671, "vf_explained_var": 0.13660385428617397, "kl": 0.014938398713517624, "entropy": 1.082671864082416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 213.51399999999987, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -510.9367873641405, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 596.5885188675469}, "policy_reward_mean": {"prey_policy": -40.419106583403774, "predator_policy": 253.9331065834038}, "custom_metrics": {}, "hist_stats": {"episode_reward": [398.2, 189.0, 382.6, 289.70000000000005, 189.1, 126.599999999999, 374.0, 221.2, 163.7999999999999, 279.9999999999999, 202.0, 247.89999999999978, 241.7, 159.8, 325.0, 137.3999999999998, 125.39999999999996, 168.1, 179.59999999999997, 272.4000000000002, 206.5999999999999, 331.0, 83.19999999999996, 310.59999999999997, 249.0, 209.0, 135.2, 329.90000000000003, 392.4, 265.2, 174.09999999999994, 188.39999999999998, 271.4, 380.0, 235.10000000000002, 133.4999999999997, 287.2, 229.10000000000002, 132.09999999999997, 360.8, 238.2, 382.7, 143.49999999999972, 267.6, 124.00000000000026, 227.4999999999997, 85.09999999999994, 241.5, 261.30000000000007, 297.30000000000007, 228.99999999999994, 267.79999999999984, 178.69999999999973, 211.39999999999998, 279.09999999999997, 83.99999999999893, 283.6, 155.1, 292.3000000000003, 138.2, 105.00000000000011, 159.09999999999982, 130.59999999999891, 168.59999999999994, 85.9999999999989, 160.5, 252.10000000000002, 199.9, 214.1999999999996, 179.8, 198.09999999999997, 88.09999999999874, 141.40000000000015, 207.19999999999982, 150.5999999999994, 241.19999999999996, 168.4, 66.49999999999989, 335.4, 226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001, 221.5, 101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [398.2, -132.39571245279035, 378.71616465664675, 96.28668467023226, -196.30824396429378, -81.26457657014492, 342.9084985545099, -69.63941956670624, -217.93690890230198, 138.1680959120032, -159.9861043066497, 163.6101952963238, -57.93437910123135, -162.93550209453176, 206.91112873449302, -269.0850351597421, -310.48067593138916, -194.8611106983713, -132.3443222913186, 75.2353010198211, -77.3976823081336, 227.5313124929794, -510.9367873641405, 187.64170987361467, -10.304885752635064, -167.52639754955956, -426.6707933547557, 270.61559100022555, 387.21082219912813, 60.406055259894515, -180.08687242636842, -227.22305626122218, 66.56198176249418, 358.26992166657595, -107.5236680103214, -243.08853893099854, 130.70338024264993, -21.037820058579086, -360.6483276238888, 323.041920010763, -61.97118867079985, 373.24871596704406, -181.22189733488227, 70.16582794120126, 61.70360499581665, -5.3852993977215835, -424.9886616031664, 7.164675116556198, 84.67258446118748, 146.02961789627838, -62.63196651441463, 165.68849979871996, -148.7666766873097, -45.049069350590926, 133.74531240403257, -58.66530564418129, 134.71421791976087, -293.71714616136717, 115.18028448073068, -351.3510887612847, -271.8615272755738, -249.99679333945411, 7.210926291858886, -147.1845465353328, -14.372179764750813, -232.41020911970418, -3.591608032537586, -93.54931024528395, -27.119329413298278, -193.27261984242426, -143.11455720289334, 1.5020764293308064, 138.68631215593126, -65.45038870011493, -21.521428531817588, -41.93249598514751, -254.32315481435495, -425.60452003939463, 286.25079945839934, -118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694, -162.30102614826558, -135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344], "policy_predator_policy_reward": [0.0, 321.39571245279035, 3.883835343353244, 193.41331532976787, 385.40824396429315, 207.8645765701441, 31.091501445490078, 290.8394195667061, 381.7369089023021, 141.83190408799683, 361.9861043066497, 84.28980470367594, 299.63437910123133, 322.7355020945317, 118.088871265507, 406.4850351597419, 435.880675931389, 362.96111069837144, 311.94432229131854, 197.1646989801788, 283.99768230813385, 103.46868750702065, 594.1367873641407, 122.95829012638531, 259.30488575263513, 376.52639754955965, 561.8707933547557, 59.28440899977449, 5.1891778008718505, 204.79394474010542, 354.18687242636815, 415.6230562612224, 204.8380182375058, 21.730078333424093, 342.6236680103214, 376.5885389309984, 156.49661975734998, 250.13782005857914, 492.74832762388894, 37.75807998923693, 300.17118867079995, 9.451284032955936, 324.721897334882, 197.4341720587988, 62.29639500418336, 232.88529939772164, 510.08866160316643, 234.335324883444, 176.6274155388125, 151.27038210372163, 291.6319665144148, 102.11150020128015, 327.46667668730953, 256.449069350591, 145.35468759596753, 142.66530564418022, 148.88578208023915, 448.8171461613669, 177.1197155192693, 489.55108876128475, 376.86152727557305, 409.0967933394549, 123.38907370814103, 315.7845465353326, 100.37217976475101, 392.91020911970435, 255.69160803253743, 293.44931024528387, 241.31932941329825, 373.0726198424244, 341.2145572028932, 86.59792357066921, 2.713687844068848, 272.6503887001151, 172.12142853181703, 283.13249598514756, 422.72315481435487, 492.10452003939594, 49.14920054160066, 344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469, 383.80102614826563, 237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8342814088937183, "mean_inference_ms": 3.702979958306529, "mean_action_processing_ms": 1.1558902943526488, "mean_env_wait_ms": 10.044486960582155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008472442626953125, "StateBufferConnector_ms": 0.002638697624206543, "ViewRequirementAgentConnector_ms": 0.06540870666503906}, "num_episodes": 6, "episode_return_max": 398.2, "episode_return_min": 39.40000000000029, "episode_return_mean": 213.51399999999987, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.22160476019872, "num_env_steps_trained_throughput_per_sec": 159.22160476019872, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 25077.923, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25077.653, "sample_time_ms": 1826.031, "learn_time_ms": 23224.151, "learn_throughput": 172.235, "synch_weights_time_ms": 25.341}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 41, "trial_id": "cbf82_00000", "date": "2024-08-21_13-25-09", "timestamp": 1724226909, "time_this_iter_s": 25.160803079605103, "time_total_s": 1084.7817437648773, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075b8e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1084.7817437648773, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 28.82222222222222, "ram_util_percent": 82.85277777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.1123970082650585, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.351331944018602, "policy_loss": -0.014034253917149424, "vf_loss": 5.363121381898721, "vf_explained_var": 0.14907253918548424, "kl": 0.011224136327170224, "entropy": 0.9430079800387223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.760370346158743, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.69597126096487, "policy_loss": -0.023156145444954746, "vf_loss": 6.716308831671873, "vf_explained_var": 0.09954835046082736, "kl": 0.01409283753988954, "entropy": 1.0919575941438475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 392.4, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 211.5789999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -510.9367873641405, "predator_policy": 2.713687844068848}, "policy_reward_max": {"prey_policy": 387.21082219912813, "predator_policy": 596.5885188675469}, "policy_reward_mean": {"prey_policy": -43.887387237243686, "predator_policy": 255.46638723724365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.7999999999999, 279.9999999999999, 202.0, 247.89999999999978, 241.7, 159.8, 325.0, 137.3999999999998, 125.39999999999996, 168.1, 179.59999999999997, 272.4000000000002, 206.5999999999999, 331.0, 83.19999999999996, 310.59999999999997, 249.0, 209.0, 135.2, 329.90000000000003, 392.4, 265.2, 174.09999999999994, 188.39999999999998, 271.4, 380.0, 235.10000000000002, 133.4999999999997, 287.2, 229.10000000000002, 132.09999999999997, 360.8, 238.2, 382.7, 143.49999999999972, 267.6, 124.00000000000026, 227.4999999999997, 85.09999999999994, 241.5, 261.30000000000007, 297.30000000000007, 228.99999999999994, 267.79999999999984, 178.69999999999973, 211.39999999999998, 279.09999999999997, 83.99999999999893, 283.6, 155.1, 292.3000000000003, 138.2, 105.00000000000011, 159.09999999999982, 130.59999999999891, 168.59999999999994, 85.9999999999989, 160.5, 252.10000000000002, 199.9, 214.1999999999996, 179.8, 198.09999999999997, 88.09999999999874, 141.40000000000015, 207.19999999999982, 150.5999999999994, 241.19999999999996, 168.4, 66.49999999999989, 335.4, 226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001, 221.5, 101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007, 373.1, 211.79999999999984, 151.99999999999946, 178.6999999999999, 368.5, 289.70000000000005, 243.6, 159.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-217.93690890230198, 138.1680959120032, -159.9861043066497, 163.6101952963238, -57.93437910123135, -162.93550209453176, 206.91112873449302, -269.0850351597421, -310.48067593138916, -194.8611106983713, -132.3443222913186, 75.2353010198211, -77.3976823081336, 227.5313124929794, -510.9367873641405, 187.64170987361467, -10.304885752635064, -167.52639754955956, -426.6707933547557, 270.61559100022555, 387.21082219912813, 60.406055259894515, -180.08687242636842, -227.22305626122218, 66.56198176249418, 358.26992166657595, -107.5236680103214, -243.08853893099854, 130.70338024264993, -21.037820058579086, -360.6483276238888, 323.041920010763, -61.97118867079985, 373.24871596704406, -181.22189733488227, 70.16582794120126, 61.70360499581665, -5.3852993977215835, -424.9886616031664, 7.164675116556198, 84.67258446118748, 146.02961789627838, -62.63196651441463, 165.68849979871996, -148.7666766873097, -45.049069350590926, 133.74531240403257, -58.66530564418129, 134.71421791976087, -293.71714616136717, 115.18028448073068, -351.3510887612847, -271.8615272755738, -249.99679333945411, 7.210926291858886, -147.1845465353328, -14.372179764750813, -232.41020911970418, -3.591608032537586, -93.54931024528395, -27.119329413298278, -193.27261984242426, -143.11455720289334, 1.5020764293308064, 138.68631215593126, -65.45038870011493, -21.521428531817588, -41.93249598514751, -254.32315481435495, -425.60452003939463, 286.25079945839934, -118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694, -162.30102614826558, -135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344, 362.79182160263565, -62.31685370756848, -46.44986225019795, -123.69106249548413, 331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252], "policy_predator_policy_reward": [381.7369089023021, 141.83190408799683, 361.9861043066497, 84.28980470367594, 299.63437910123133, 322.7355020945317, 118.088871265507, 406.4850351597419, 435.880675931389, 362.96111069837144, 311.94432229131854, 197.1646989801788, 283.99768230813385, 103.46868750702065, 594.1367873641407, 122.95829012638531, 259.30488575263513, 376.52639754955965, 561.8707933547557, 59.28440899977449, 5.1891778008718505, 204.79394474010542, 354.18687242636815, 415.6230562612224, 204.8380182375058, 21.730078333424093, 342.6236680103214, 376.5885389309984, 156.49661975734998, 250.13782005857914, 492.74832762388894, 37.75807998923693, 300.17118867079995, 9.451284032955936, 324.721897334882, 197.4341720587988, 62.29639500418336, 232.88529939772164, 510.08866160316643, 234.335324883444, 176.6274155388125, 151.27038210372163, 291.6319665144148, 102.11150020128015, 327.46667668730953, 256.449069350591, 145.35468759596753, 142.66530564418022, 148.88578208023915, 448.8171461613669, 177.1197155192693, 489.55108876128475, 376.86152727557305, 409.0967933394549, 123.38907370814103, 315.7845465353326, 100.37217976475101, 392.91020911970435, 255.69160803253743, 293.44931024528387, 241.31932941329825, 373.0726198424244, 341.2145572028932, 86.59792357066921, 2.713687844068848, 272.6503887001151, 172.12142853181703, 283.13249598514756, 422.72315481435487, 492.10452003939594, 49.14920054160066, 344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469, 383.80102614826563, 237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366, 10.308178397364346, 274.1168537075685, 198.4498622501975, 302.3910624954843, 36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8185286703881496, "mean_inference_ms": 3.695615041949045, "mean_action_processing_ms": 1.1242386756480336, "mean_env_wait_ms": 10.030918443438367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004430174827575684, "StateBufferConnector_ms": 0.0026221275329589844, "ViewRequirementAgentConnector_ms": 0.07442593574523926}, "num_episodes": 8, "episode_return_max": 392.4, "episode_return_min": 39.40000000000029, "episode_return_mean": 211.5789999999999, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.59922496130753, "num_env_steps_trained_throughput_per_sec": 155.59922496130753, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 25113.699, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25113.431, "sample_time_ms": 1807.457, "learn_time_ms": 23277.368, "learn_throughput": 171.841, "synch_weights_time_ms": 26.495}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 42, "trial_id": "cbf82_00000", "date": "2024-08-21_13-25-35", "timestamp": 1724226935, "time_this_iter_s": 25.763052701950073, "time_total_s": 1110.5447964668274, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075ccca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1110.5447964668274, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 37.555555555555564, "ram_util_percent": 82.98055555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.011389197409153, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.383744407693545, "policy_loss": -0.013391422813098568, "vf_loss": 6.394784211615721, "vf_explained_var": 0.13366978733489912, "kl": 0.011758024577526763, "entropy": 0.8097096459940076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.449846172332764, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.352007915576299, "policy_loss": -0.02501085607946152, "vf_loss": 7.3741069306929905, "vf_explained_var": 0.09887314531952143, "kl": 0.014559169069495207, "entropy": 1.0415076032901804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 392.4, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 212.6519999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -510.9367873641405, "predator_policy": 2.713687844068848}, "policy_reward_max": {"prey_policy": 387.21082219912813, "predator_policy": 596.5885188675469}, "policy_reward_mean": {"prey_policy": -40.20763809571148, "predator_policy": 252.8596380957115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.39999999999996, 168.1, 179.59999999999997, 272.4000000000002, 206.5999999999999, 331.0, 83.19999999999996, 310.59999999999997, 249.0, 209.0, 135.2, 329.90000000000003, 392.4, 265.2, 174.09999999999994, 188.39999999999998, 271.4, 380.0, 235.10000000000002, 133.4999999999997, 287.2, 229.10000000000002, 132.09999999999997, 360.8, 238.2, 382.7, 143.49999999999972, 267.6, 124.00000000000026, 227.4999999999997, 85.09999999999994, 241.5, 261.30000000000007, 297.30000000000007, 228.99999999999994, 267.79999999999984, 178.69999999999973, 211.39999999999998, 279.09999999999997, 83.99999999999893, 283.6, 155.1, 292.3000000000003, 138.2, 105.00000000000011, 159.09999999999982, 130.59999999999891, 168.59999999999994, 85.9999999999989, 160.5, 252.10000000000002, 199.9, 214.1999999999996, 179.8, 198.09999999999997, 88.09999999999874, 141.40000000000015, 207.19999999999982, 150.5999999999994, 241.19999999999996, 168.4, 66.49999999999989, 335.4, 226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001, 221.5, 101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007, 373.1, 211.79999999999984, 151.99999999999946, 178.6999999999999, 368.5, 289.70000000000005, 243.6, 159.5, 148.89999999999992, 354.1999999999999, 143.59999999999994, 364.7, 322.1000000000001, 224.59999999999997, 131.9, 174.89999999999992], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-310.48067593138916, -194.8611106983713, -132.3443222913186, 75.2353010198211, -77.3976823081336, 227.5313124929794, -510.9367873641405, 187.64170987361467, -10.304885752635064, -167.52639754955956, -426.6707933547557, 270.61559100022555, 387.21082219912813, 60.406055259894515, -180.08687242636842, -227.22305626122218, 66.56198176249418, 358.26992166657595, -107.5236680103214, -243.08853893099854, 130.70338024264993, -21.037820058579086, -360.6483276238888, 323.041920010763, -61.97118867079985, 373.24871596704406, -181.22189733488227, 70.16582794120126, 61.70360499581665, -5.3852993977215835, -424.9886616031664, 7.164675116556198, 84.67258446118748, 146.02961789627838, -62.63196651441463, 165.68849979871996, -148.7666766873097, -45.049069350590926, 133.74531240403257, -58.66530564418129, 134.71421791976087, -293.71714616136717, 115.18028448073068, -351.3510887612847, -271.8615272755738, -249.99679333945411, 7.210926291858886, -147.1845465353328, -14.372179764750813, -232.41020911970418, -3.591608032537586, -93.54931024528395, -27.119329413298278, -193.27261984242426, -143.11455720289334, 1.5020764293308064, 138.68631215593126, -65.45038870011493, -21.521428531817588, -41.93249598514751, -254.32315481435495, -425.60452003939463, 286.25079945839934, -118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694, -162.30102614826558, -135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344, 362.79182160263565, -62.31685370756848, -46.44986225019795, -123.69106249548413, 331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252, -215.7284483826228, 324.0797660280565, -259.01534935727176, 326.6136692782131, 290.78047402393986, -71.4995684889201, -268.11940497149527, -118.3247335983165], "policy_predator_policy_reward": [435.880675931389, 362.96111069837144, 311.94432229131854, 197.1646989801788, 283.99768230813385, 103.46868750702065, 594.1367873641407, 122.95829012638531, 259.30488575263513, 376.52639754955965, 561.8707933547557, 59.28440899977449, 5.1891778008718505, 204.79394474010542, 354.18687242636815, 415.6230562612224, 204.8380182375058, 21.730078333424093, 342.6236680103214, 376.5885389309984, 156.49661975734998, 250.13782005857914, 492.74832762388894, 37.75807998923693, 300.17118867079995, 9.451284032955936, 324.721897334882, 197.4341720587988, 62.29639500418336, 232.88529939772164, 510.08866160316643, 234.335324883444, 176.6274155388125, 151.27038210372163, 291.6319665144148, 102.11150020128015, 327.46667668730953, 256.449069350591, 145.35468759596753, 142.66530564418022, 148.88578208023915, 448.8171461613669, 177.1197155192693, 489.55108876128475, 376.86152727557305, 409.0967933394549, 123.38907370814103, 315.7845465353326, 100.37217976475101, 392.91020911970435, 255.69160803253743, 293.44931024528387, 241.31932941329825, 373.0726198424244, 341.2145572028932, 86.59792357066921, 2.713687844068848, 272.6503887001151, 172.12142853181703, 283.13249598514756, 422.72315481435487, 492.10452003939594, 49.14920054160066, 344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469, 383.80102614826563, 237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366, 10.308178397364346, 274.1168537075685, 198.4498622501975, 302.3910624954843, 36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513, 364.62844838262293, 30.12023397194352, 402.6153493572716, 38.086330721786936, 31.31952597606014, 296.09956848892006, 400.01940497149513, 293.22473359831633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8033573311773843, "mean_inference_ms": 3.6603374771812303, "mean_action_processing_ms": 1.1280466798176758, "mean_env_wait_ms": 10.02960696585083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004413962364196777, "StateBufferConnector_ms": 0.0026589632034301758, "ViewRequirementAgentConnector_ms": 0.07096898555755615}, "num_episodes": 8, "episode_return_max": 392.4, "episode_return_min": 39.40000000000029, "episode_return_mean": 212.6519999999999, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.42624224770583, "num_env_steps_trained_throughput_per_sec": 150.42624224770583, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 25307.542, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25307.273, "sample_time_ms": 1862.534, "learn_time_ms": 23415.765, "learn_throughput": 170.825, "synch_weights_time_ms": 26.854}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 43, "trial_id": "cbf82_00000", "date": "2024-08-21_13-26-02", "timestamp": 1724226962, "time_this_iter_s": 26.642401933670044, "time_total_s": 1137.1871984004974, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177de7d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1137.1871984004974, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 51.21578947368422, "ram_util_percent": 83.32894736842107}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.922285775343577, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.474885283410549, "policy_loss": -0.00633937532887406, "vf_loss": 5.479549309114615, "vf_explained_var": 0.13987757737437884, "kl": 0.008376819166248122, "entropy": 0.8985044571881493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.571810622140765, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.085344757139683, "policy_loss": -0.023598460190502615, "vf_loss": 7.106006469825903, "vf_explained_var": 0.04187794557462136, "kl": 0.014683769892144483, "entropy": 1.0734760292495291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 392.4, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 212.43099999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -500.28851886754694, "predator_policy": 2.713687844068848}, "policy_reward_max": {"prey_policy": 387.21082219912813, "predator_policy": 596.5885188675469}, "policy_reward_mean": {"prey_policy": -34.96606622161865, "predator_policy": 247.39706622161862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.59999999999997, 249.0, 209.0, 135.2, 329.90000000000003, 392.4, 265.2, 174.09999999999994, 188.39999999999998, 271.4, 380.0, 235.10000000000002, 133.4999999999997, 287.2, 229.10000000000002, 132.09999999999997, 360.8, 238.2, 382.7, 143.49999999999972, 267.6, 124.00000000000026, 227.4999999999997, 85.09999999999994, 241.5, 261.30000000000007, 297.30000000000007, 228.99999999999994, 267.79999999999984, 178.69999999999973, 211.39999999999998, 279.09999999999997, 83.99999999999893, 283.6, 155.1, 292.3000000000003, 138.2, 105.00000000000011, 159.09999999999982, 130.59999999999891, 168.59999999999994, 85.9999999999989, 160.5, 252.10000000000002, 199.9, 214.1999999999996, 179.8, 198.09999999999997, 88.09999999999874, 141.40000000000015, 207.19999999999982, 150.5999999999994, 241.19999999999996, 168.4, 66.49999999999989, 335.4, 226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001, 221.5, 101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007, 373.1, 211.79999999999984, 151.99999999999946, 178.6999999999999, 368.5, 289.70000000000005, 243.6, 159.5, 148.89999999999992, 354.1999999999999, 143.59999999999994, 364.7, 322.1000000000001, 224.59999999999997, 131.9, 174.89999999999992, 114.50000000000017, 161.20000000000005, 120.30000000000035, 273.8999999999998, 225.50000000000003, 188.5, 260.2999999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [187.64170987361467, -10.304885752635064, -167.52639754955956, -426.6707933547557, 270.61559100022555, 387.21082219912813, 60.406055259894515, -180.08687242636842, -227.22305626122218, 66.56198176249418, 358.26992166657595, -107.5236680103214, -243.08853893099854, 130.70338024264993, -21.037820058579086, -360.6483276238888, 323.041920010763, -61.97118867079985, 373.24871596704406, -181.22189733488227, 70.16582794120126, 61.70360499581665, -5.3852993977215835, -424.9886616031664, 7.164675116556198, 84.67258446118748, 146.02961789627838, -62.63196651441463, 165.68849979871996, -148.7666766873097, -45.049069350590926, 133.74531240403257, -58.66530564418129, 134.71421791976087, -293.71714616136717, 115.18028448073068, -351.3510887612847, -271.8615272755738, -249.99679333945411, 7.210926291858886, -147.1845465353328, -14.372179764750813, -232.41020911970418, -3.591608032537586, -93.54931024528395, -27.119329413298278, -193.27261984242426, -143.11455720289334, 1.5020764293308064, 138.68631215593126, -65.45038870011493, -21.521428531817588, -41.93249598514751, -254.32315481435495, -425.60452003939463, 286.25079945839934, -118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694, -162.30102614826558, -135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344, 362.79182160263565, -62.31685370756848, -46.44986225019795, -123.69106249548413, 331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252, -215.7284483826228, 324.0797660280565, -259.01534935727176, 326.6136692782131, 290.78047402393986, -71.4995684889201, -268.11940497149527, -118.3247335983165, -198.97904889836175, -216.63183129683185, 23.124171646431904, 123.99159897946377, 5.13091737477912, -173.33540633220343, 37.60282085545404], "policy_predator_policy_reward": [122.95829012638531, 259.30488575263513, 376.52639754955965, 561.8707933547557, 59.28440899977449, 5.1891778008718505, 204.79394474010542, 354.18687242636815, 415.6230562612224, 204.8380182375058, 21.730078333424093, 342.6236680103214, 376.5885389309984, 156.49661975734998, 250.13782005857914, 492.74832762388894, 37.75807998923693, 300.17118867079995, 9.451284032955936, 324.721897334882, 197.4341720587988, 62.29639500418336, 232.88529939772164, 510.08866160316643, 234.335324883444, 176.6274155388125, 151.27038210372163, 291.6319665144148, 102.11150020128015, 327.46667668730953, 256.449069350591, 145.35468759596753, 142.66530564418022, 148.88578208023915, 448.8171461613669, 177.1197155192693, 489.55108876128475, 376.86152727557305, 409.0967933394549, 123.38907370814103, 315.7845465353326, 100.37217976475101, 392.91020911970435, 255.69160803253743, 293.44931024528387, 241.31932941329825, 373.0726198424244, 341.2145572028932, 86.59792357066921, 2.713687844068848, 272.6503887001151, 172.12142853181703, 283.13249598514756, 422.72315481435487, 492.10452003939594, 49.14920054160066, 344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469, 383.80102614826563, 237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366, 10.308178397364346, 274.1168537075685, 198.4498622501975, 302.3910624954843, 36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513, 364.62844838262293, 30.12023397194352, 402.6153493572716, 38.086330721786936, 31.31952597606014, 296.09956848892006, 400.01940497149513, 293.22473359831633, 313.4790488983614, 377.8318312968314, 97.1758283535674, 149.90840102053608, 220.36908262522059, 361.83540633220355, 222.6971791445457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7877227680842793, "mean_inference_ms": 3.648563458307119, "mean_action_processing_ms": 1.1064221624243913, "mean_env_wait_ms": 10.023447517267273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004432320594787598, "StateBufferConnector_ms": 0.0026361942291259766, "ViewRequirementAgentConnector_ms": 0.07741081714630127}, "num_episodes": 7, "episode_return_max": 392.4, "episode_return_min": 39.40000000000029, "episode_return_mean": 212.43099999999995, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.19060575235892, "num_env_steps_trained_throughput_per_sec": 152.19060575235892, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 25445.858, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25445.47, "sample_time_ms": 1855.982, "learn_time_ms": 23561.024, "learn_throughput": 169.772, "synch_weights_time_ms": 25.852}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 44, "trial_id": "cbf82_00000", "date": "2024-08-21_13-26-28", "timestamp": 1724226988, "time_this_iter_s": 26.303267240524292, "time_total_s": 1163.4904656410217, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e26dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1163.4904656410217, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 36.316216216216226, "ram_util_percent": 82.9054054054054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.374536991119385, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.360939504702886, "policy_loss": -0.009174168357761421, "vf_loss": 6.36836606313785, "vf_explained_var": 0.10072472083071868, "kl": 0.008738061763142468, "entropy": 0.8207086812704801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.130903356522321, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.699967478215695, "policy_loss": -0.02245809519178389, "vf_loss": 7.7195044984420145, "vf_explained_var": 0.043558313076694805, "kl": 0.014605526759502633, "entropy": 1.0405810394634802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 210.24199999999985, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -500.28851886754694, "predator_policy": 2.713687844068848}, "policy_reward_max": {"prey_policy": 382.82572184022547, "predator_policy": 596.5885188675469}, "policy_reward_mean": {"prey_policy": -38.30471097698742, "predator_policy": 248.5467109769874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 235.10000000000002, 133.4999999999997, 287.2, 229.10000000000002, 132.09999999999997, 360.8, 238.2, 382.7, 143.49999999999972, 267.6, 124.00000000000026, 227.4999999999997, 85.09999999999994, 241.5, 261.30000000000007, 297.30000000000007, 228.99999999999994, 267.79999999999984, 178.69999999999973, 211.39999999999998, 279.09999999999997, 83.99999999999893, 283.6, 155.1, 292.3000000000003, 138.2, 105.00000000000011, 159.09999999999982, 130.59999999999891, 168.59999999999994, 85.9999999999989, 160.5, 252.10000000000002, 199.9, 214.1999999999996, 179.8, 198.09999999999997, 88.09999999999874, 141.40000000000015, 207.19999999999982, 150.5999999999994, 241.19999999999996, 168.4, 66.49999999999989, 335.4, 226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001, 221.5, 101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007, 373.1, 211.79999999999984, 151.99999999999946, 178.6999999999999, 368.5, 289.70000000000005, 243.6, 159.5, 148.89999999999992, 354.1999999999999, 143.59999999999994, 364.7, 322.1000000000001, 224.59999999999997, 131.9, 174.89999999999992, 114.50000000000017, 161.20000000000005, 120.30000000000035, 273.8999999999998, 225.50000000000003, 188.5, 260.2999999999999, 388.0, 165.49999999999997, 199.2, 170.89999999999998, 346.1, 208.19999999999987, 375.3, 209.6, 156.0, 87.50000000000001], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [358.26992166657595, -107.5236680103214, -243.08853893099854, 130.70338024264993, -21.037820058579086, -360.6483276238888, 323.041920010763, -61.97118867079985, 373.24871596704406, -181.22189733488227, 70.16582794120126, 61.70360499581665, -5.3852993977215835, -424.9886616031664, 7.164675116556198, 84.67258446118748, 146.02961789627838, -62.63196651441463, 165.68849979871996, -148.7666766873097, -45.049069350590926, 133.74531240403257, -58.66530564418129, 134.71421791976087, -293.71714616136717, 115.18028448073068, -351.3510887612847, -271.8615272755738, -249.99679333945411, 7.210926291858886, -147.1845465353328, -14.372179764750813, -232.41020911970418, -3.591608032537586, -93.54931024528395, -27.119329413298278, -193.27261984242426, -143.11455720289334, 1.5020764293308064, 138.68631215593126, -65.45038870011493, -21.521428531817588, -41.93249598514751, -254.32315481435495, -425.60452003939463, 286.25079945839934, -118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694, -162.30102614826558, -135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344, 362.79182160263565, -62.31685370756848, -46.44986225019795, -123.69106249548413, 331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252, -215.7284483826228, 324.0797660280565, -259.01534935727176, 326.6136692782131, 290.78047402393986, -71.4995684889201, -268.11940497149527, -118.3247335983165, -198.97904889836175, -216.63183129683185, 23.124171646431904, 123.99159897946377, 5.13091737477912, -173.33540633220343, 37.60282085545404, 382.82572184022547, -221.6333194998945, -104.37397222537582, -206.85086652080346, 262.6103423474317, -64.84720010009445, 354.08253076078455, -144.616250281303, -186.1748069621661, -444.26250014486703], "policy_predator_policy_reward": [21.730078333424093, 342.6236680103214, 376.5885389309984, 156.49661975734998, 250.13782005857914, 492.74832762388894, 37.75807998923693, 300.17118867079995, 9.451284032955936, 324.721897334882, 197.4341720587988, 62.29639500418336, 232.88529939772164, 510.08866160316643, 234.335324883444, 176.6274155388125, 151.27038210372163, 291.6319665144148, 102.11150020128015, 327.46667668730953, 256.449069350591, 145.35468759596753, 142.66530564418022, 148.88578208023915, 448.8171461613669, 177.1197155192693, 489.55108876128475, 376.86152727557305, 409.0967933394549, 123.38907370814103, 315.7845465353326, 100.37217976475101, 392.91020911970435, 255.69160803253743, 293.44931024528387, 241.31932941329825, 373.0726198424244, 341.2145572028932, 86.59792357066921, 2.713687844068848, 272.6503887001151, 172.12142853181703, 283.13249598514756, 422.72315481435487, 492.10452003939594, 49.14920054160066, 344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469, 383.80102614826563, 237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366, 10.308178397364346, 274.1168537075685, 198.4498622501975, 302.3910624954843, 36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513, 364.62844838262293, 30.12023397194352, 402.6153493572716, 38.086330721786936, 31.31952597606014, 296.09956848892006, 400.01940497149513, 293.22473359831633, 313.4790488983614, 377.8318312968314, 97.1758283535674, 149.90840102053608, 220.36908262522059, 361.83540633220355, 222.6971791445457, 5.17427815977453, 387.13331949989487, 303.5739722253758, 377.7508665208035, 83.48965765256835, 273.0472001000943, 21.217469239215447, 354.21625028130296, 342.1748069621661, 531.7625001448672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7660361575764245, "mean_inference_ms": 3.6299694029611453, "mean_action_processing_ms": 1.0912263203683081, "mean_env_wait_ms": 10.030110130195997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004470705986022949, "StateBufferConnector_ms": 0.0026149749755859375, "ViewRequirementAgentConnector_ms": 0.07563495635986328}, "num_episodes": 10, "episode_return_max": 388.0, "episode_return_min": 39.40000000000029, "episode_return_mean": 210.24199999999985, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.0147378497295, "num_env_steps_trained_throughput_per_sec": 162.0147378497295, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 25400.731, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25400.342, "sample_time_ms": 1855.521, "learn_time_ms": 23516.229, "learn_throughput": 170.095, "synch_weights_time_ms": 26.0}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 45, "trial_id": "cbf82_00000", "date": "2024-08-21_13-26-53", "timestamp": 1724227013, "time_this_iter_s": 24.703009128570557, "time_total_s": 1188.1934747695923, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e34ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1188.1934747695923, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 27.54571428571428, "ram_util_percent": 81.67714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8248126450926065, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.864100244392952, "policy_loss": -0.008463135871473544, "vf_loss": 5.870718211183945, "vf_explained_var": 0.14695263616740703, "kl": 0.009225949915950575, "entropy": 0.7793174856031935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.454512852430344, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.187804135183494, "policy_loss": -0.01857108036541225, "vf_loss": 7.203492821753025, "vf_explained_var": 0.03205237736304601, "kl": 0.014411940101126675, "entropy": 1.0004315982262293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 208.90899999999993, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -500.28851886754694, "predator_policy": 0.8337153118649714}, "policy_reward_max": {"prey_policy": 389.166284688135, "predator_policy": 596.5885188675469}, "policy_reward_mean": {"prey_policy": -42.791052937401176, "predator_policy": 251.70005293740115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.99999999999994, 267.79999999999984, 178.69999999999973, 211.39999999999998, 279.09999999999997, 83.99999999999893, 283.6, 155.1, 292.3000000000003, 138.2, 105.00000000000011, 159.09999999999982, 130.59999999999891, 168.59999999999994, 85.9999999999989, 160.5, 252.10000000000002, 199.9, 214.1999999999996, 179.8, 198.09999999999997, 88.09999999999874, 141.40000000000015, 207.19999999999982, 150.5999999999994, 241.19999999999996, 168.4, 66.49999999999989, 335.4, 226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001, 221.5, 101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007, 373.1, 211.79999999999984, 151.99999999999946, 178.6999999999999, 368.5, 289.70000000000005, 243.6, 159.5, 148.89999999999992, 354.1999999999999, 143.59999999999994, 364.7, 322.1000000000001, 224.59999999999997, 131.9, 174.89999999999992, 114.50000000000017, 161.20000000000005, 120.30000000000035, 273.8999999999998, 225.50000000000003, 188.5, 260.2999999999999, 388.0, 165.49999999999997, 199.2, 170.89999999999998, 346.1, 208.19999999999987, 375.3, 209.6, 156.0, 87.50000000000001, 384.0, 390.0, 119.1, 183.89999999999995, 184.89999999999995, 357.0, 237.8999999999999, 186.29999999999995, 175.49999999999991, 192.7, 231.4, 180.00000000000003, 158.09999999999994, 351.20000000000005, 149.99999999999997, 262.5, 148.69999999999965], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-62.63196651441463, 165.68849979871996, -148.7666766873097, -45.049069350590926, 133.74531240403257, -58.66530564418129, 134.71421791976087, -293.71714616136717, 115.18028448073068, -351.3510887612847, -271.8615272755738, -249.99679333945411, 7.210926291858886, -147.1845465353328, -14.372179764750813, -232.41020911970418, -3.591608032537586, -93.54931024528395, -27.119329413298278, -193.27261984242426, -143.11455720289334, 1.5020764293308064, 138.68631215593126, -65.45038870011493, -21.521428531817588, -41.93249598514751, -254.32315481435495, -425.60452003939463, 286.25079945839934, -118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694, -162.30102614826558, -135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344, 362.79182160263565, -62.31685370756848, -46.44986225019795, -123.69106249548413, 331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252, -215.7284483826228, 324.0797660280565, -259.01534935727176, 326.6136692782131, 290.78047402393986, -71.4995684889201, -268.11940497149527, -118.3247335983165, -198.97904889836175, -216.63183129683185, 23.124171646431904, 123.99159897946377, 5.13091737477912, -173.33540633220343, 37.60282085545404, 382.82572184022547, -221.6333194998945, -104.37397222537582, -206.85086652080346, 262.6103423474317, -64.84720010009445, 354.08253076078455, -144.616250281303, -186.1748069621661, -444.26250014486703, 376.40013205542186, 389.166284688135, -306.7602084844401, -206.3121059642433, -189.83392938371682, 346.77513182174243, 3.887191866832616, -179.71643661532974, -183.3048543177794, -40.67726103995659, -47.580703383048714, -149.15440292828225, -229.66885860125748, 315.95962781469325, -87.48491608653629, 29.833421063156507, -141.027461879051], "policy_predator_policy_reward": [291.6319665144148, 102.11150020128015, 327.46667668730953, 256.449069350591, 145.35468759596753, 142.66530564418022, 148.88578208023915, 448.8171461613669, 177.1197155192693, 489.55108876128475, 376.86152727557305, 409.0967933394549, 123.38907370814103, 315.7845465353326, 100.37217976475101, 392.91020911970435, 255.69160803253743, 293.44931024528387, 241.31932941329825, 373.0726198424244, 341.2145572028932, 86.59792357066921, 2.713687844068848, 272.6503887001151, 172.12142853181703, 283.13249598514756, 422.72315481435487, 492.10452003939594, 49.14920054160066, 344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469, 383.80102614826563, 237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366, 10.308178397364346, 274.1168537075685, 198.4498622501975, 302.3910624954843, 36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513, 364.62844838262293, 30.12023397194352, 402.6153493572716, 38.086330721786936, 31.31952597606014, 296.09956848892006, 400.01940497149513, 293.22473359831633, 313.4790488983614, 377.8318312968314, 97.1758283535674, 149.90840102053608, 220.36908262522059, 361.83540633220355, 222.6971791445457, 5.17427815977453, 387.13331949989487, 303.5739722253758, 377.7508665208035, 83.48965765256835, 273.0472001000943, 21.217469239215447, 354.21625028130296, 342.1748069621661, 531.7625001448672, 7.599867944578135, 0.8337153118649714, 425.8602084844402, 390.21210596424305, 374.73392938371654, 10.224868178257564, 234.0128081331673, 366.01643661532984, 358.8048543177791, 233.37726103995675, 278.98070338304876, 329.15440292828214, 387.768858601257, 35.24037218530673, 237.48491608653566, 232.66657893684356, 289.7274618790509]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7424297719846855, "mean_inference_ms": 3.592779729751497, "mean_action_processing_ms": 1.0709994214865635, "mean_env_wait_ms": 10.020356243992849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031052827835083008, "StateBufferConnector_ms": 0.0025053024291992188, "ViewRequirementAgentConnector_ms": 0.065329909324646}, "num_episodes": 17, "episode_return_max": 390.0, "episode_return_min": 39.40000000000029, "episode_return_mean": 208.90899999999993, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.8716767683925, "num_env_steps_trained_throughput_per_sec": 161.8716767683925, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 25376.301, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25375.914, "sample_time_ms": 1863.031, "learn_time_ms": 23484.327, "learn_throughput": 170.326, "synch_weights_time_ms": 25.901}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 46, "trial_id": "cbf82_00000", "date": "2024-08-21_13-27-18", "timestamp": 1724227038, "time_this_iter_s": 24.751787900924683, "time_total_s": 1212.945262670517, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30755bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1212.945262670517, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 29.240000000000002, "ram_util_percent": 81.45714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8832441445440056, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.007135177155336, "policy_loss": -0.007737383946368937, "vf_loss": 6.012859462201595, "vf_explained_var": 0.1311656277626753, "kl": 0.010065458943184542, "entropy": 0.796588640473783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.426844808583459, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.3005401184161505, "policy_loss": -0.01981815894396277, "vf_loss": 7.317683750391007, "vf_explained_var": 0.03445452408244212, "kl": 0.01337264526761525, "entropy": 1.0020803932100535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 211.70399999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -500.28851886754694, "predator_policy": 0.8337153118649714}, "policy_reward_max": {"prey_policy": 389.166284688135, "predator_policy": 602.1584856361068}, "policy_reward_mean": {"prey_policy": -43.13951511688817, "predator_policy": 254.84351511688806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.9999999999989, 160.5, 252.10000000000002, 199.9, 214.1999999999996, 179.8, 198.09999999999997, 88.09999999999874, 141.40000000000015, 207.19999999999982, 150.5999999999994, 241.19999999999996, 168.4, 66.49999999999989, 335.4, 226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001, 221.5, 101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007, 373.1, 211.79999999999984, 151.99999999999946, 178.6999999999999, 368.5, 289.70000000000005, 243.6, 159.5, 148.89999999999992, 354.1999999999999, 143.59999999999994, 364.7, 322.1000000000001, 224.59999999999997, 131.9, 174.89999999999992, 114.50000000000017, 161.20000000000005, 120.30000000000035, 273.8999999999998, 225.50000000000003, 188.5, 260.2999999999999, 388.0, 165.49999999999997, 199.2, 170.89999999999998, 346.1, 208.19999999999987, 375.3, 209.6, 156.0, 87.50000000000001, 384.0, 390.0, 119.1, 183.89999999999995, 184.89999999999995, 357.0, 237.8999999999999, 186.29999999999995, 175.49999999999991, 192.7, 231.4, 180.00000000000003, 158.09999999999994, 351.20000000000005, 149.99999999999997, 262.5, 148.69999999999965, 104.69999999999999, 354.0, 169.80000000000013, 232.39999999999998, 219.3999999999999, 216.8, 212.0, 262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-14.372179764750813, -232.41020911970418, -3.591608032537586, -93.54931024528395, -27.119329413298278, -193.27261984242426, -143.11455720289334, 1.5020764293308064, 138.68631215593126, -65.45038870011493, -21.521428531817588, -41.93249598514751, -254.32315481435495, -425.60452003939463, 286.25079945839934, -118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694, -162.30102614826558, -135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344, 362.79182160263565, -62.31685370756848, -46.44986225019795, -123.69106249548413, 331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252, -215.7284483826228, 324.0797660280565, -259.01534935727176, 326.6136692782131, 290.78047402393986, -71.4995684889201, -268.11940497149527, -118.3247335983165, -198.97904889836175, -216.63183129683185, 23.124171646431904, 123.99159897946377, 5.13091737477912, -173.33540633220343, 37.60282085545404, 382.82572184022547, -221.6333194998945, -104.37397222537582, -206.85086652080346, 262.6103423474317, -64.84720010009445, 354.08253076078455, -144.616250281303, -186.1748069621661, -444.26250014486703, 376.40013205542186, 389.166284688135, -306.7602084844401, -206.3121059642433, -189.83392938371682, 346.77513182174243, 3.887191866832616, -179.71643661532974, -183.3048543177794, -40.67726103995659, -47.580703383048714, -149.15440292828225, -229.66885860125748, 315.95962781469325, -87.48491608653629, 29.833421063156507, -141.027461879051, -497.45848563610724, 298.91422401215823, -59.95776786685127, 8.174688408947711, -41.200426082092065, -91.90059353946025, -141.8535384165317, 157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853], "policy_predator_policy_reward": [100.37217976475101, 392.91020911970435, 255.69160803253743, 293.44931024528387, 241.31932941329825, 373.0726198424244, 341.2145572028932, 86.59792357066921, 2.713687844068848, 272.6503887001151, 172.12142853181703, 283.13249598514756, 422.72315481435487, 492.10452003939594, 49.14920054160066, 344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469, 383.80102614826563, 237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366, 10.308178397364346, 274.1168537075685, 198.4498622501975, 302.3910624954843, 36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513, 364.62844838262293, 30.12023397194352, 402.6153493572716, 38.086330721786936, 31.31952597606014, 296.09956848892006, 400.01940497149513, 293.22473359831633, 313.4790488983614, 377.8318312968314, 97.1758283535674, 149.90840102053608, 220.36908262522059, 361.83540633220355, 222.6971791445457, 5.17427815977453, 387.13331949989487, 303.5739722253758, 377.7508665208035, 83.48965765256835, 273.0472001000943, 21.217469239215447, 354.21625028130296, 342.1748069621661, 531.7625001448672, 7.599867944578135, 0.8337153118649714, 425.8602084844402, 390.21210596424305, 374.73392938371654, 10.224868178257564, 234.0128081331673, 366.01643661532984, 358.8048543177791, 233.37726103995675, 278.98070338304876, 329.15440292828214, 387.768858601257, 35.24037218530673, 237.48491608653566, 232.66657893684356, 289.7274618790509, 602.1584856361068, 55.08577598784169, 229.75776786685074, 224.22531159105225, 260.600426082092, 308.70059353946016, 353.8535384165314, 104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.723199997033622, "mean_inference_ms": 3.5608660655535926, "mean_action_processing_ms": 1.0734086372000113, "mean_env_wait_ms": 10.034750856637654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032013654708862305, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.0811014175415039}, "num_episodes": 14, "episode_return_max": 390.0, "episode_return_min": 39.40000000000029, "episode_return_mean": 211.70399999999995, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.07353065138844, "num_env_steps_trained_throughput_per_sec": 161.07353065138844, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 25355.306, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25355.014, "sample_time_ms": 1894.913, "learn_time_ms": 23430.585, "learn_throughput": 170.717, "synch_weights_time_ms": 26.917}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 47, "trial_id": "cbf82_00000", "date": "2024-08-21_13-27-43", "timestamp": 1724227063, "time_this_iter_s": 24.845162868499756, "time_total_s": 1237.7904255390167, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075b8ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1237.7904255390167, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 28.67142857142857, "ram_util_percent": 81.80285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.648756934454044, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.147700204948584, "policy_loss": -0.011072996947041247, "vf_loss": 5.15670747657617, "vf_explained_var": 0.17661111646642288, "kl": 0.01032864734661416, "entropy": 0.8606847422197461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.870874173442523, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.487532236675421, "policy_loss": -0.0268024436532869, "vf_loss": 6.511168550451597, "vf_explained_var": 0.17359903330604234, "kl": 0.015830646188987885, "entropy": 1.0512022213389476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 212.84499999999997, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -500.28851886754694, "predator_policy": 0.8337153118649714}, "policy_reward_max": {"prey_policy": 389.166284688135, "predator_policy": 602.1584856361068}, "policy_reward_mean": {"prey_policy": -48.90432715800725, "predator_policy": 261.7493271580072}, "custom_metrics": {}, "hist_stats": {"episode_reward": [207.19999999999982, 150.5999999999994, 241.19999999999996, 168.4, 66.49999999999989, 335.4, 226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001, 221.5, 101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007, 373.1, 211.79999999999984, 151.99999999999946, 178.6999999999999, 368.5, 289.70000000000005, 243.6, 159.5, 148.89999999999992, 354.1999999999999, 143.59999999999994, 364.7, 322.1000000000001, 224.59999999999997, 131.9, 174.89999999999992, 114.50000000000017, 161.20000000000005, 120.30000000000035, 273.8999999999998, 225.50000000000003, 188.5, 260.2999999999999, 388.0, 165.49999999999997, 199.2, 170.89999999999998, 346.1, 208.19999999999987, 375.3, 209.6, 156.0, 87.50000000000001, 384.0, 390.0, 119.1, 183.89999999999995, 184.89999999999995, 357.0, 237.8999999999999, 186.29999999999995, 175.49999999999991, 192.7, 231.4, 180.00000000000003, 158.09999999999994, 351.20000000000005, 149.99999999999997, 262.5, 148.69999999999965, 104.69999999999999, 354.0, 169.80000000000013, 232.39999999999998, 219.3999999999999, 216.8, 212.0, 262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002, 141.5, 135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-65.45038870011493, -21.521428531817588, -41.93249598514751, -254.32315481435495, -425.60452003939463, 286.25079945839934, -118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694, -162.30102614826558, -135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344, 362.79182160263565, -62.31685370756848, -46.44986225019795, -123.69106249548413, 331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252, -215.7284483826228, 324.0797660280565, -259.01534935727176, 326.6136692782131, 290.78047402393986, -71.4995684889201, -268.11940497149527, -118.3247335983165, -198.97904889836175, -216.63183129683185, 23.124171646431904, 123.99159897946377, 5.13091737477912, -173.33540633220343, 37.60282085545404, 382.82572184022547, -221.6333194998945, -104.37397222537582, -206.85086652080346, 262.6103423474317, -64.84720010009445, 354.08253076078455, -144.616250281303, -186.1748069621661, -444.26250014486703, 376.40013205542186, 389.166284688135, -306.7602084844401, -206.3121059642433, -189.83392938371682, 346.77513182174243, 3.887191866832616, -179.71643661532974, -183.3048543177794, -40.67726103995659, -47.580703383048714, -149.15440292828225, -229.66885860125748, 315.95962781469325, -87.48491608653629, 29.833421063156507, -141.027461879051, -497.45848563610724, 298.91422401215823, -59.95776786685127, 8.174688408947711, -41.200426082092065, -91.90059353946025, -141.8535384165317, 157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853, -315.3603855756517, -295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314], "policy_predator_policy_reward": [272.6503887001151, 172.12142853181703, 283.13249598514756, 422.72315481435487, 492.10452003939594, 49.14920054160066, 344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469, 383.80102614826563, 237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366, 10.308178397364346, 274.1168537075685, 198.4498622501975, 302.3910624954843, 36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513, 364.62844838262293, 30.12023397194352, 402.6153493572716, 38.086330721786936, 31.31952597606014, 296.09956848892006, 400.01940497149513, 293.22473359831633, 313.4790488983614, 377.8318312968314, 97.1758283535674, 149.90840102053608, 220.36908262522059, 361.83540633220355, 222.6971791445457, 5.17427815977453, 387.13331949989487, 303.5739722253758, 377.7508665208035, 83.48965765256835, 273.0472001000943, 21.217469239215447, 354.21625028130296, 342.1748069621661, 531.7625001448672, 7.599867944578135, 0.8337153118649714, 425.8602084844402, 390.21210596424305, 374.73392938371654, 10.224868178257564, 234.0128081331673, 366.01643661532984, 358.8048543177791, 233.37726103995675, 278.98070338304876, 329.15440292828214, 387.768858601257, 35.24037218530673, 237.48491608653566, 232.66657893684356, 289.7274618790509, 602.1584856361068, 55.08577598784169, 229.75776786685074, 224.22531159105225, 260.600426082092, 308.70059353946016, 353.8535384165314, 104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834, 456.86038557565183, 431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7181670933466586, "mean_inference_ms": 3.5512058887238642, "mean_action_processing_ms": 1.0598641494135268, "mean_env_wait_ms": 10.018931107748616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00337374210357666, "StateBufferConnector_ms": 0.0025135278701782227, "ViewRequirementAgentConnector_ms": 0.08111464977264404}, "num_episodes": 9, "episode_return_max": 390.0, "episode_return_min": 39.40000000000029, "episode_return_mean": 212.84499999999997, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.54595010309527, "num_env_steps_trained_throughput_per_sec": 162.54595010309527, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 25328.015, "restore_workers_time_ms": 0.022, "training_step_time_ms": 25327.722, "sample_time_ms": 1892.488, "learn_time_ms": 23405.347, "learn_throughput": 170.901, "synch_weights_time_ms": 27.169}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 48, "trial_id": "cbf82_00000", "date": "2024-08-21_13-28-07", "timestamp": 1724227087, "time_this_iter_s": 24.64965510368347, "time_total_s": 1262.4400806427002, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075b8ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1262.4400806427002, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 29.21142857142857, "ram_util_percent": 81.63714285714283}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.328676575546464, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.49906338279446, "policy_loss": -0.00903403562066766, "vf_loss": 4.505758211513361, "vf_explained_var": 0.14782238646099966, "kl": 0.011696013123340284, "entropy": 0.9081073191016913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.731890677660704, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.99404122903943, "policy_loss": -0.020594158339857435, "vf_loss": 6.011851017177105, "vf_explained_var": 0.06682760249823332, "kl": 0.013921851010915512, "entropy": 1.0762440010905265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 211.07899999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -500.28851886754694, "predator_policy": 0.8337153118649714}, "policy_reward_max": {"prey_policy": 389.166284688135, "predator_policy": 602.1584856361068}, "policy_reward_mean": {"prey_policy": -56.54206091601758, "predator_policy": 267.62106091601754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.10000000000002, 247.50000000000003, 200.29999999999998, 233.20000000000007, 194.10000000000002, 96.30000000000001, 221.5, 101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007, 373.1, 211.79999999999984, 151.99999999999946, 178.6999999999999, 368.5, 289.70000000000005, 243.6, 159.5, 148.89999999999992, 354.1999999999999, 143.59999999999994, 364.7, 322.1000000000001, 224.59999999999997, 131.9, 174.89999999999992, 114.50000000000017, 161.20000000000005, 120.30000000000035, 273.8999999999998, 225.50000000000003, 188.5, 260.2999999999999, 388.0, 165.49999999999997, 199.2, 170.89999999999998, 346.1, 208.19999999999987, 375.3, 209.6, 156.0, 87.50000000000001, 384.0, 390.0, 119.1, 183.89999999999995, 184.89999999999995, 357.0, 237.8999999999999, 186.29999999999995, 175.49999999999991, 192.7, 231.4, 180.00000000000003, 158.09999999999994, 351.20000000000005, 149.99999999999997, 262.5, 148.69999999999965, 104.69999999999999, 354.0, 169.80000000000013, 232.39999999999998, 219.3999999999999, 216.8, 212.0, 262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002, 141.5, 135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995, 104.49999999999955, 126.19999999999996, 185.99999999999986, 275.8, 192.89999999999995, 107.30000000000001], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-118.42243481329254, 97.54084712165559, -168.35336722148827, 43.54528284010031, -87.21155951616095, -500.28851886754694, -162.30102614826558, -135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344, 362.79182160263565, -62.31685370756848, -46.44986225019795, -123.69106249548413, 331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252, -215.7284483826228, 324.0797660280565, -259.01534935727176, 326.6136692782131, 290.78047402393986, -71.4995684889201, -268.11940497149527, -118.3247335983165, -198.97904889836175, -216.63183129683185, 23.124171646431904, 123.99159897946377, 5.13091737477912, -173.33540633220343, 37.60282085545404, 382.82572184022547, -221.6333194998945, -104.37397222537582, -206.85086652080346, 262.6103423474317, -64.84720010009445, 354.08253076078455, -144.616250281303, -186.1748069621661, -444.26250014486703, 376.40013205542186, 389.166284688135, -306.7602084844401, -206.3121059642433, -189.83392938371682, 346.77513182174243, 3.887191866832616, -179.71643661532974, -183.3048543177794, -40.67726103995659, -47.580703383048714, -149.15440292828225, -229.66885860125748, 315.95962781469325, -87.48491608653629, 29.833421063156507, -141.027461879051, -497.45848563610724, 298.91422401215823, -59.95776786685127, 8.174688408947711, -41.200426082092065, -91.90059353946025, -141.8535384165317, 157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853, -315.3603855756517, -295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314, -258.4598272535702, -421.26655048653055, -159.44410958888594, 103.38873591506609, -127.4153573976846, -423.1574556018604], "policy_predator_policy_reward": [344.52243481329265, 149.95915287834444, 368.6533672214882, 189.65471715989952, 281.31155951616114, 596.5885188675469, 383.80102614826563, 237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366, 10.308178397364346, 274.1168537075685, 198.4498622501975, 302.3910624954843, 36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513, 364.62844838262293, 30.12023397194352, 402.6153493572716, 38.086330721786936, 31.31952597606014, 296.09956848892006, 400.01940497149513, 293.22473359831633, 313.4790488983614, 377.8318312968314, 97.1758283535674, 149.90840102053608, 220.36908262522059, 361.83540633220355, 222.6971791445457, 5.17427815977453, 387.13331949989487, 303.5739722253758, 377.7508665208035, 83.48965765256835, 273.0472001000943, 21.217469239215447, 354.21625028130296, 342.1748069621661, 531.7625001448672, 7.599867944578135, 0.8337153118649714, 425.8602084844402, 390.21210596424305, 374.73392938371654, 10.224868178257564, 234.0128081331673, 366.01643661532984, 358.8048543177791, 233.37726103995675, 278.98070338304876, 329.15440292828214, 387.768858601257, 35.24037218530673, 237.48491608653566, 232.66657893684356, 289.7274618790509, 602.1584856361068, 55.08577598784169, 229.75776786685074, 224.22531159105225, 260.600426082092, 308.70059353946016, 353.8535384165314, 104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834, 456.86038557565183, 431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687, 362.9598272535698, 547.4665504865309, 345.4441095888858, 172.4112640849339, 320.31535739768475, 530.4574556018606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7125108915292966, "mean_inference_ms": 3.5405974944174456, "mean_action_processing_ms": 1.0543690328807613, "mean_env_wait_ms": 10.026410557281014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033881664276123047, "StateBufferConnector_ms": 0.002523660659790039, "ViewRequirementAgentConnector_ms": 0.08135616779327393}, "num_episodes": 6, "episode_return_max": 390.0, "episode_return_min": 39.40000000000029, "episode_return_mean": 211.07899999999995, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.82628149174582, "num_env_steps_trained_throughput_per_sec": 156.82628149174582, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 25318.014, "restore_workers_time_ms": 0.029, "training_step_time_ms": 25317.706, "sample_time_ms": 1941.878, "learn_time_ms": 23346.835, "learn_throughput": 171.329, "synch_weights_time_ms": 26.454}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 49, "trial_id": "cbf82_00000", "date": "2024-08-21_13-28-33", "timestamp": 1724227113, "time_this_iter_s": 25.531229972839355, "time_total_s": 1287.9713106155396, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e375e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1287.9713106155396, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.55833333333333, "ram_util_percent": 82.09722222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.667907611404856, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.305223093181849, "policy_loss": -0.010108736927698677, "vf_loss": 5.312620635082324, "vf_explained_var": 0.14221033211797476, "kl": 0.013556068692317543, "entropy": 0.9227939483399192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.60177710739275, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.025628989438216, "policy_loss": -0.020458039520599415, "vf_loss": 7.043014192581177, "vf_explained_var": 0.24221390436093013, "kl": 0.01536414430544634, "entropy": 1.0774948166683316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 215.2729999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -497.45848563610724, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 602.1584856361068}, "policy_reward_mean": {"prey_policy": -43.44379389433188, "predator_policy": 258.71679389433183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.80000000000024, 154.99999999999972, 270.3, 189.2999999999997, 311.7, 177.19999999999968, 58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007, 373.1, 211.79999999999984, 151.99999999999946, 178.6999999999999, 368.5, 289.70000000000005, 243.6, 159.5, 148.89999999999992, 354.1999999999999, 143.59999999999994, 364.7, 322.1000000000001, 224.59999999999997, 131.9, 174.89999999999992, 114.50000000000017, 161.20000000000005, 120.30000000000035, 273.8999999999998, 225.50000000000003, 188.5, 260.2999999999999, 388.0, 165.49999999999997, 199.2, 170.89999999999998, 346.1, 208.19999999999987, 375.3, 209.6, 156.0, 87.50000000000001, 384.0, 390.0, 119.1, 183.89999999999995, 184.89999999999995, 357.0, 237.8999999999999, 186.29999999999995, 175.49999999999991, 192.7, 231.4, 180.00000000000003, 158.09999999999994, 351.20000000000005, 149.99999999999997, 262.5, 148.69999999999965, 104.69999999999999, 354.0, 169.80000000000013, 232.39999999999998, 219.3999999999999, 216.8, 212.0, 262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002, 141.5, 135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995, 104.49999999999955, 126.19999999999996, 185.99999999999986, 275.8, 192.89999999999995, 107.30000000000001, 249.5, 227.4, 244.4, 221.60000000000002, 398.2, 305.50000000000017, 191.80000000000004], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-135.94169470937177, -130.31115638424572, 24.96449316215545, -68.74129830733486, 183.52537032208835, -61.959504225962, -156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344, 362.79182160263565, -62.31685370756848, -46.44986225019795, -123.69106249548413, 331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252, -215.7284483826228, 324.0797660280565, -259.01534935727176, 326.6136692782131, 290.78047402393986, -71.4995684889201, -268.11940497149527, -118.3247335983165, -198.97904889836175, -216.63183129683185, 23.124171646431904, 123.99159897946377, 5.13091737477912, -173.33540633220343, 37.60282085545404, 382.82572184022547, -221.6333194998945, -104.37397222537582, -206.85086652080346, 262.6103423474317, -64.84720010009445, 354.08253076078455, -144.616250281303, -186.1748069621661, -444.26250014486703, 376.40013205542186, 389.166284688135, -306.7602084844401, -206.3121059642433, -189.83392938371682, 346.77513182174243, 3.887191866832616, -179.71643661532974, -183.3048543177794, -40.67726103995659, -47.580703383048714, -149.15440292828225, -229.66885860125748, 315.95962781469325, -87.48491608653629, 29.833421063156507, -141.027461879051, -497.45848563610724, 298.91422401215823, -59.95776786685127, 8.174688408947711, -41.200426082092065, -91.90059353946025, -141.8535384165317, 157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853, -315.3603855756517, -295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314, -258.4598272535702, -421.26655048653055, -159.44410958888594, 103.38873591506609, -127.4153573976846, -423.1574556018604, 95.08992233639182, -82.43676445371392, 29.432810595584854, -106.81743753174733, 398.2, 229.72874598851305, -148.8613513714564], "policy_predator_policy_reward": [237.74169470937133, 285.31115638424563, 245.33550683784446, 258.04129830733484, 128.17462967791167, 239.15950422596163, 214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366, 10.308178397364346, 274.1168537075685, 198.4498622501975, 302.3910624954843, 36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513, 364.62844838262293, 30.12023397194352, 402.6153493572716, 38.086330721786936, 31.31952597606014, 296.09956848892006, 400.01940497149513, 293.22473359831633, 313.4790488983614, 377.8318312968314, 97.1758283535674, 149.90840102053608, 220.36908262522059, 361.83540633220355, 222.6971791445457, 5.17427815977453, 387.13331949989487, 303.5739722253758, 377.7508665208035, 83.48965765256835, 273.0472001000943, 21.217469239215447, 354.21625028130296, 342.1748069621661, 531.7625001448672, 7.599867944578135, 0.8337153118649714, 425.8602084844402, 390.21210596424305, 374.73392938371654, 10.224868178257564, 234.0128081331673, 366.01643661532984, 358.8048543177791, 233.37726103995675, 278.98070338304876, 329.15440292828214, 387.768858601257, 35.24037218530673, 237.48491608653566, 232.66657893684356, 289.7274618790509, 602.1584856361068, 55.08577598784169, 229.75776786685074, 224.22531159105225, 260.600426082092, 308.70059353946016, 353.8535384165314, 104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834, 456.86038557565183, 431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687, 362.9598272535698, 547.4665504865309, 345.4441095888858, 172.4112640849339, 320.31535739768475, 530.4574556018606, 154.410077663608, 309.83676445371424, 214.9671894044152, 328.4174375317473, 0.0, 75.77125401148687, 340.6613513714564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7045589322459973, "mean_inference_ms": 3.541852332063227, "mean_action_processing_ms": 1.032534086828999, "mean_env_wait_ms": 10.008864733450864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033093690872192383, "StateBufferConnector_ms": 0.0025058984756469727, "ViewRequirementAgentConnector_ms": 0.08097171783447266}, "num_episodes": 7, "episode_return_max": 398.2, "episode_return_min": 39.40000000000029, "episode_return_mean": 215.2729999999999, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.49276308508988, "num_env_steps_trained_throughput_per_sec": 163.49276308508988, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 25251.755, "restore_workers_time_ms": 0.029, "training_step_time_ms": 25251.486, "sample_time_ms": 1927.363, "learn_time_ms": 23296.427, "learn_throughput": 171.7, "synch_weights_time_ms": 25.253}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 50, "trial_id": "cbf82_00000", "date": "2024-08-21_13-28-57", "timestamp": 1724227137, "time_this_iter_s": 24.470186948776245, "time_total_s": 1312.4414975643158, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075abaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1312.4414975643158, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 27.22571428571429, "ram_util_percent": 81.73714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6092691301057735, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.569443015009165, "policy_loss": -0.006694515992421657, "vf_loss": 5.573836243400971, "vf_explained_var": 0.1689005599046747, "kl": 0.011506450860906625, "entropy": 0.8271274048835039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.64556606200834, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.71166721234719, "policy_loss": -0.024180186771263833, "vf_loss": 6.732312827308973, "vf_explained_var": 0.144106949493289, "kl": 0.017672865825685828, "entropy": 1.0568630579238136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 39.40000000000029, "episode_reward_mean": 216.47599999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -516.6700241293161, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 602.1584856361068}, "policy_reward_mean": {"prey_policy": -45.07729937546164, "predator_policy": 261.55329937546156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.500000000000355, 259.2, 39.40000000000029, 302.3, 154.29999999999998, 321.59999999999997, 101.59999999999998, 272.30000000000007, 373.1, 211.79999999999984, 151.99999999999946, 178.6999999999999, 368.5, 289.70000000000005, 243.6, 159.5, 148.89999999999992, 354.1999999999999, 143.59999999999994, 364.7, 322.1000000000001, 224.59999999999997, 131.9, 174.89999999999992, 114.50000000000017, 161.20000000000005, 120.30000000000035, 273.8999999999998, 225.50000000000003, 188.5, 260.2999999999999, 388.0, 165.49999999999997, 199.2, 170.89999999999998, 346.1, 208.19999999999987, 375.3, 209.6, 156.0, 87.50000000000001, 384.0, 390.0, 119.1, 183.89999999999995, 184.89999999999995, 357.0, 237.8999999999999, 186.29999999999995, 175.49999999999991, 192.7, 231.4, 180.00000000000003, 158.09999999999994, 351.20000000000005, 149.99999999999997, 262.5, 148.69999999999965, 104.69999999999999, 354.0, 169.80000000000013, 232.39999999999998, 219.3999999999999, 216.8, 212.0, 262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002, 141.5, 135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995, 104.49999999999955, 126.19999999999996, 185.99999999999986, 275.8, 192.89999999999995, 107.30000000000001, 249.5, 227.4, 244.4, 221.60000000000002, 398.2, 305.50000000000017, 191.80000000000004, 233.49999999999955, 376.2, 226.8, 276.3, 128.69999999999993, 84.09999999999982], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-156.39641767695028, 95.90149343615114, 32.382405277604875, 158.7641118302337, -293.14046033319266, 215.01861336449542, -450.63074578744323, 38.83247927506344, 362.79182160263565, -62.31685370756848, -46.44986225019795, -123.69106249548413, 331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252, -215.7284483826228, 324.0797660280565, -259.01534935727176, 326.6136692782131, 290.78047402393986, -71.4995684889201, -268.11940497149527, -118.3247335983165, -198.97904889836175, -216.63183129683185, 23.124171646431904, 123.99159897946377, 5.13091737477912, -173.33540633220343, 37.60282085545404, 382.82572184022547, -221.6333194998945, -104.37397222537582, -206.85086652080346, 262.6103423474317, -64.84720010009445, 354.08253076078455, -144.616250281303, -186.1748069621661, -444.26250014486703, 376.40013205542186, 389.166284688135, -306.7602084844401, -206.3121059642433, -189.83392938371682, 346.77513182174243, 3.887191866832616, -179.71643661532974, -183.3048543177794, -40.67726103995659, -47.580703383048714, -149.15440292828225, -229.66885860125748, 315.95962781469325, -87.48491608653629, 29.833421063156507, -141.027461879051, -497.45848563610724, 298.91422401215823, -59.95776786685127, 8.174688408947711, -41.200426082092065, -91.90059353946025, -141.8535384165317, 157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853, -315.3603855756517, -295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314, -258.4598272535702, -421.26655048653055, -159.44410958888594, 103.38873591506609, -127.4153573976846, -423.1574556018604, 95.08992233639182, -82.43676445371392, 29.432810595584854, -106.81743753174733, 398.2, 229.72874598851305, -148.8613513714564, 85.60649637624036, 360.19932590341045, -23.74203998720722, 72.45593092250755, -329.66402734128127, -516.6700241293161], "policy_predator_policy_reward": [214.89641767694943, 163.29850656384895, 7.017594722395308, 143.5358881697662, 447.4404603331927, 106.5813866355045, 552.2307457874435, 233.4675207249366, 10.308178397364346, 274.1168537075685, 198.4498622501975, 302.3910624954843, 36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513, 364.62844838262293, 30.12023397194352, 402.6153493572716, 38.086330721786936, 31.31952597606014, 296.09956848892006, 400.01940497149513, 293.22473359831633, 313.4790488983614, 377.8318312968314, 97.1758283535674, 149.90840102053608, 220.36908262522059, 361.83540633220355, 222.6971791445457, 5.17427815977453, 387.13331949989487, 303.5739722253758, 377.7508665208035, 83.48965765256835, 273.0472001000943, 21.217469239215447, 354.21625028130296, 342.1748069621661, 531.7625001448672, 7.599867944578135, 0.8337153118649714, 425.8602084844402, 390.21210596424305, 374.73392938371654, 10.224868178257564, 234.0128081331673, 366.01643661532984, 358.8048543177791, 233.37726103995675, 278.98070338304876, 329.15440292828214, 387.768858601257, 35.24037218530673, 237.48491608653566, 232.66657893684356, 289.7274618790509, 602.1584856361068, 55.08577598784169, 229.75776786685074, 224.22531159105225, 260.600426082092, 308.70059353946016, 353.8535384165314, 104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834, 456.86038557565183, 431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687, 362.9598272535698, 547.4665504865309, 345.4441095888858, 172.4112640849339, 320.31535739768475, 530.4574556018606, 154.410077663608, 309.83676445371424, 214.9671894044152, 328.4174375317473, 0.0, 75.77125401148687, 340.6613513714564, 147.89350362375936, 16.000674096589513, 250.5420399872073, 203.8440690774924, 458.3640273412811, 600.770024129317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.696583957697627, "mean_inference_ms": 3.5295237541426565, "mean_action_processing_ms": 1.0276176049405326, "mean_env_wait_ms": 10.006494071182468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033278465270996094, "StateBufferConnector_ms": 0.00249636173248291, "ViewRequirementAgentConnector_ms": 0.08036434650421143}, "num_episodes": 6, "episode_return_max": 398.2, "episode_return_min": 39.40000000000029, "episode_return_mean": 216.47599999999994, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.25504948507637, "num_env_steps_trained_throughput_per_sec": 158.25504948507637, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 25267.098, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25266.83, "sample_time_ms": 1921.48, "learn_time_ms": 23317.23, "learn_throughput": 171.547, "synch_weights_time_ms": 25.581}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 51, "trial_id": "cbf82_00000", "date": "2024-08-21_13-29-23", "timestamp": 1724227163, "time_this_iter_s": 25.308850049972534, "time_total_s": 1337.7503476142883, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e34af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1337.7503476142883, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 30.671428571428578, "ram_util_percent": 82.28285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.095343272387981, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.9975639343261715, "policy_loss": -0.008977014330836634, "vf_loss": 6.004347613453865, "vf_explained_var": 0.1433699778591593, "kl": 0.010966681915063722, "entropy": 0.7990043958649039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.107708690936366, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.372482404112816, "policy_loss": -0.022757254376483616, "vf_loss": 7.392073149979114, "vf_explained_var": 0.13556726481765508, "kl": 0.015832629610667937, "entropy": 1.0199869588017463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 84.09999999999982, "episode_reward_mean": 212.28799999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -516.6700241293161, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 602.1584856361068}, "policy_reward_mean": {"prey_policy": -63.232131246866544, "predator_policy": 275.52013124686647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [368.5, 289.70000000000005, 243.6, 159.5, 148.89999999999992, 354.1999999999999, 143.59999999999994, 364.7, 322.1000000000001, 224.59999999999997, 131.9, 174.89999999999992, 114.50000000000017, 161.20000000000005, 120.30000000000035, 273.8999999999998, 225.50000000000003, 188.5, 260.2999999999999, 388.0, 165.49999999999997, 199.2, 170.89999999999998, 346.1, 208.19999999999987, 375.3, 209.6, 156.0, 87.50000000000001, 384.0, 390.0, 119.1, 183.89999999999995, 184.89999999999995, 357.0, 237.8999999999999, 186.29999999999995, 175.49999999999991, 192.7, 231.4, 180.00000000000003, 158.09999999999994, 351.20000000000005, 149.99999999999997, 262.5, 148.69999999999965, 104.69999999999999, 354.0, 169.80000000000013, 232.39999999999998, 219.3999999999999, 216.8, 212.0, 262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002, 141.5, 135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995, 104.49999999999955, 126.19999999999996, 185.99999999999986, 275.8, 192.89999999999995, 107.30000000000001, 249.5, 227.4, 244.4, 221.60000000000002, 398.2, 305.50000000000017, 191.80000000000004, 233.49999999999955, 376.2, 226.8, 276.3, 128.69999999999993, 84.09999999999982, 184.39999999999998, 173.0, 199.0, 99.79999999999917, 115.09999999999991, 154.39999999999992, 208.39999999999992, 132.19999999999968, 101.4999999999998, 166.00000000000003, 368.8, 103.40000000000006], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [331.6676606630733, 124.92034162029309, 2.1003188012367886, -199.3470342905252, -215.7284483826228, 324.0797660280565, -259.01534935727176, 326.6136692782131, 290.78047402393986, -71.4995684889201, -268.11940497149527, -118.3247335983165, -198.97904889836175, -216.63183129683185, 23.124171646431904, 123.99159897946377, 5.13091737477912, -173.33540633220343, 37.60282085545404, 382.82572184022547, -221.6333194998945, -104.37397222537582, -206.85086652080346, 262.6103423474317, -64.84720010009445, 354.08253076078455, -144.616250281303, -186.1748069621661, -444.26250014486703, 376.40013205542186, 389.166284688135, -306.7602084844401, -206.3121059642433, -189.83392938371682, 346.77513182174243, 3.887191866832616, -179.71643661532974, -183.3048543177794, -40.67726103995659, -47.580703383048714, -149.15440292828225, -229.66885860125748, 315.95962781469325, -87.48491608653629, 29.833421063156507, -141.027461879051, -497.45848563610724, 298.91422401215823, -59.95776786685127, 8.174688408947711, -41.200426082092065, -91.90059353946025, -141.8535384165317, 157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853, -315.3603855756517, -295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314, -258.4598272535702, -421.26655048653055, -159.44410958888594, 103.38873591506609, -127.4153573976846, -423.1574556018604, 95.08992233639182, -82.43676445371392, 29.432810595584854, -106.81743753174733, 398.2, 229.72874598851305, -148.8613513714564, 85.60649637624036, 360.19932590341045, -23.74203998720722, 72.45593092250755, -329.66402734128127, -516.6700241293161, -132.96785449940302, -215.62377586595076, -140.46715377207158, -187.88883207283854, -328.2677584367122, -117.66559358101662, -63.40724458305927, -235.16949981478635, -378.835094027888, -286.672098853952, 328.90008296803416, -286.3528420655002], "policy_predator_policy_reward": [36.83233933692668, 164.77965837970714, 241.4996811987633, 358.84703429052513, 364.62844838262293, 30.12023397194352, 402.6153493572716, 38.086330721786936, 31.31952597606014, 296.09956848892006, 400.01940497149513, 293.22473359831633, 313.4790488983614, 377.8318312968314, 97.1758283535674, 149.90840102053608, 220.36908262522059, 361.83540633220355, 222.6971791445457, 5.17427815977453, 387.13331949989487, 303.5739722253758, 377.7508665208035, 83.48965765256835, 273.0472001000943, 21.217469239215447, 354.21625028130296, 342.1748069621661, 531.7625001448672, 7.599867944578135, 0.8337153118649714, 425.8602084844402, 390.21210596424305, 374.73392938371654, 10.224868178257564, 234.0128081331673, 366.01643661532984, 358.8048543177791, 233.37726103995675, 278.98070338304876, 329.15440292828214, 387.768858601257, 35.24037218530673, 237.48491608653566, 232.66657893684356, 289.7274618790509, 602.1584856361068, 55.08577598784169, 229.75776786685074, 224.22531159105225, 260.600426082092, 308.70059353946016, 353.8535384165314, 104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834, 456.86038557565183, 431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687, 362.9598272535698, 547.4665504865309, 345.4441095888858, 172.4112640849339, 320.31535739768475, 530.4574556018606, 154.410077663608, 309.83676445371424, 214.9671894044152, 328.4174375317473, 0.0, 75.77125401148687, 340.6613513714564, 147.89350362375936, 16.000674096589513, 250.5420399872073, 203.8440690774924, 458.3640273412811, 600.770024129317, 317.36785449940305, 388.6237758659509, 339.46715377207164, 287.6888320728377, 443.36775843671194, 272.06559358101595, 271.80724458305906, 367.36949981478625, 480.33509402788815, 452.6720988539521, 39.89991703196586, 389.75284206549986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.681292297425631, "mean_inference_ms": 3.508745938416019, "mean_action_processing_ms": 1.0195298314242738, "mean_env_wait_ms": 10.00195919839029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002723097801208496, "StateBufferConnector_ms": 0.002547740936279297, "ViewRequirementAgentConnector_ms": 0.06925010681152344}, "num_episodes": 12, "episode_return_max": 398.2, "episode_return_min": 84.09999999999982, "episode_return_mean": 212.28799999999995, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.79830231221555, "num_env_steps_trained_throughput_per_sec": 162.79830231221555, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 25153.421, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25153.17, "sample_time_ms": 1924.126, "learn_time_ms": 23203.089, "learn_throughput": 172.391, "synch_weights_time_ms": 23.611}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 52, "trial_id": "cbf82_00000", "date": "2024-08-21_13-29-47", "timestamp": 1724227187, "time_this_iter_s": 24.601191997528076, "time_total_s": 1362.3515396118164, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e34f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1362.3515396118164, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 27.279999999999998, "ram_util_percent": 82.06571428571431}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5620024231572947, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.872432418664297, "policy_loss": -0.00919132346753031, "vf_loss": 5.879709140956402, "vf_explained_var": 0.1640682162096103, "kl": 0.009573020093133286, "entropy": 0.770273913256824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.001172825694084, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.399669220050176, "policy_loss": -0.024189986571097204, "vf_loss": 7.4206356555223465, "vf_explained_var": 0.006737531597415606, "kl": 0.01611767334106844, "entropy": 1.025355431623757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 84.09999999999982, "episode_reward_mean": 210.75799999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -516.6700241293161, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 602.1584856361068}, "policy_reward_mean": {"prey_policy": -69.61533052232603, "predator_policy": 280.37333052232594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.89999999999992, 114.50000000000017, 161.20000000000005, 120.30000000000035, 273.8999999999998, 225.50000000000003, 188.5, 260.2999999999999, 388.0, 165.49999999999997, 199.2, 170.89999999999998, 346.1, 208.19999999999987, 375.3, 209.6, 156.0, 87.50000000000001, 384.0, 390.0, 119.1, 183.89999999999995, 184.89999999999995, 357.0, 237.8999999999999, 186.29999999999995, 175.49999999999991, 192.7, 231.4, 180.00000000000003, 158.09999999999994, 351.20000000000005, 149.99999999999997, 262.5, 148.69999999999965, 104.69999999999999, 354.0, 169.80000000000013, 232.39999999999998, 219.3999999999999, 216.8, 212.0, 262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002, 141.5, 135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995, 104.49999999999955, 126.19999999999996, 185.99999999999986, 275.8, 192.89999999999995, 107.30000000000001, 249.5, 227.4, 244.4, 221.60000000000002, 398.2, 305.50000000000017, 191.80000000000004, 233.49999999999955, 376.2, 226.8, 276.3, 128.69999999999993, 84.09999999999982, 184.39999999999998, 173.0, 199.0, 99.79999999999917, 115.09999999999991, 154.39999999999992, 208.39999999999992, 132.19999999999968, 101.4999999999998, 166.00000000000003, 368.8, 103.40000000000006, 278.2, 199.89999999999998, 199.20000000000005, 319.1, 103.9, 178.29999999999998, 190.79999999999998, 302.0, 342.50000000000006, 339.7000000000001, 144.69999999999996], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-118.3247335983165, -198.97904889836175, -216.63183129683185, 23.124171646431904, 123.99159897946377, 5.13091737477912, -173.33540633220343, 37.60282085545404, 382.82572184022547, -221.6333194998945, -104.37397222537582, -206.85086652080346, 262.6103423474317, -64.84720010009445, 354.08253076078455, -144.616250281303, -186.1748069621661, -444.26250014486703, 376.40013205542186, 389.166284688135, -306.7602084844401, -206.3121059642433, -189.83392938371682, 346.77513182174243, 3.887191866832616, -179.71643661532974, -183.3048543177794, -40.67726103995659, -47.580703383048714, -149.15440292828225, -229.66885860125748, 315.95962781469325, -87.48491608653629, 29.833421063156507, -141.027461879051, -497.45848563610724, 298.91422401215823, -59.95776786685127, 8.174688408947711, -41.200426082092065, -91.90059353946025, -141.8535384165317, 157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853, -315.3603855756517, -295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314, -258.4598272535702, -421.26655048653055, -159.44410958888594, 103.38873591506609, -127.4153573976846, -423.1574556018604, 95.08992233639182, -82.43676445371392, 29.432810595584854, -106.81743753174733, 398.2, 229.72874598851305, -148.8613513714564, 85.60649637624036, 360.19932590341045, -23.74203998720722, 72.45593092250755, -329.66402734128127, -516.6700241293161, -132.96785449940302, -215.62377586595076, -140.46715377207158, -187.88883207283854, -328.2677584367122, -117.66559358101662, -63.40724458305927, -235.16949981478635, -378.835094027888, -286.672098853952, 328.90008296803416, -286.3528420655002, 119.22080703577191, -111.49690387266887, -5.355989473360751, 127.64267166874947, -430.3314347504574, -225.0082265281122, -116.73031773505446, 175.97113395670186, 255.13349397183237, 251.7729725025515, -292.68570939792437], "policy_predator_policy_reward": [293.22473359831633, 313.4790488983614, 377.8318312968314, 97.1758283535674, 149.90840102053608, 220.36908262522059, 361.83540633220355, 222.6971791445457, 5.17427815977453, 387.13331949989487, 303.5739722253758, 377.7508665208035, 83.48965765256835, 273.0472001000943, 21.217469239215447, 354.21625028130296, 342.1748069621661, 531.7625001448672, 7.599867944578135, 0.8337153118649714, 425.8602084844402, 390.21210596424305, 374.73392938371654, 10.224868178257564, 234.0128081331673, 366.01643661532984, 358.8048543177791, 233.37726103995675, 278.98070338304876, 329.15440292828214, 387.768858601257, 35.24037218530673, 237.48491608653566, 232.66657893684356, 289.7274618790509, 602.1584856361068, 55.08577598784169, 229.75776786685074, 224.22531159105225, 260.600426082092, 308.70059353946016, 353.8535384165314, 104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834, 456.86038557565183, 431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687, 362.9598272535698, 547.4665504865309, 345.4441095888858, 172.4112640849339, 320.31535739768475, 530.4574556018606, 154.410077663608, 309.83676445371424, 214.9671894044152, 328.4174375317473, 0.0, 75.77125401148687, 340.6613513714564, 147.89350362375936, 16.000674096589513, 250.5420399872073, 203.8440690774924, 458.3640273412811, 600.770024129317, 317.36785449940305, 388.6237758659509, 339.46715377207164, 287.6888320728377, 443.36775843671194, 272.06559358101595, 271.80724458305906, 367.36949981478625, 480.33509402788815, 452.6720988539521, 39.89991703196586, 389.75284206549986, 158.97919296422808, 311.39690387266893, 204.55598947336048, 191.4573283312506, 534.2314347504575, 403.3082265281121, 307.53031773505415, 126.02886604329811, 87.36650602816766, 87.92702749744859, 437.3857093979243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6643534873038766, "mean_inference_ms": 3.503468261851416, "mean_action_processing_ms": 0.9987530032274163, "mean_env_wait_ms": 9.996964638386883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027403831481933594, "StateBufferConnector_ms": 0.0027937889099121094, "ViewRequirementAgentConnector_ms": 0.07454192638397217}, "num_episodes": 11, "episode_return_max": 398.2, "episode_return_min": 84.09999999999982, "episode_return_mean": 210.75799999999995, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.16016457125608, "num_env_steps_trained_throughput_per_sec": 161.16016457125608, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 24976.311, "restore_workers_time_ms": 0.029, "training_step_time_ms": 24976.061, "sample_time_ms": 1870.046, "learn_time_ms": 23079.996, "learn_throughput": 173.31, "synch_weights_time_ms": 23.589}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "training_iteration": 53, "trial_id": "cbf82_00000", "date": "2024-08-21_13-30-12", "timestamp": 1724227212, "time_this_iter_s": 24.861688137054443, "time_total_s": 1387.2132277488708, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075709d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1387.2132277488708, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 29.02, "ram_util_percent": 81.66285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.652471815173825, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.107034085690975, "policy_loss": -0.010099516715854406, "vf_loss": 6.115369861821334, "vf_explained_var": 0.18471082008133333, "kl": 0.008818677755092116, "entropy": 0.7093441505916417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.696049425005913, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.449235264956951, "policy_loss": -0.019883758266223593, "vf_loss": 7.465951586763064, "vf_explained_var": 0.19106851958980162, "kl": 0.01583709019420591, "entropy": 0.9732190350691478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 78.80000000000003, "episode_reward_mean": 214.30799999999996, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -528.0415039059238, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 606.841503905924}, "policy_reward_mean": {"prey_policy": -63.53778334918004, "predator_policy": 277.84578334917995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.0, 87.50000000000001, 384.0, 390.0, 119.1, 183.89999999999995, 184.89999999999995, 357.0, 237.8999999999999, 186.29999999999995, 175.49999999999991, 192.7, 231.4, 180.00000000000003, 158.09999999999994, 351.20000000000005, 149.99999999999997, 262.5, 148.69999999999965, 104.69999999999999, 354.0, 169.80000000000013, 232.39999999999998, 219.3999999999999, 216.8, 212.0, 262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002, 141.5, 135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995, 104.49999999999955, 126.19999999999996, 185.99999999999986, 275.8, 192.89999999999995, 107.30000000000001, 249.5, 227.4, 244.4, 221.60000000000002, 398.2, 305.50000000000017, 191.80000000000004, 233.49999999999955, 376.2, 226.8, 276.3, 128.69999999999993, 84.09999999999982, 184.39999999999998, 173.0, 199.0, 99.79999999999917, 115.09999999999991, 154.39999999999992, 208.39999999999992, 132.19999999999968, 101.4999999999998, 166.00000000000003, 368.8, 103.40000000000006, 278.2, 199.89999999999998, 199.20000000000005, 319.1, 103.9, 178.29999999999998, 190.79999999999998, 302.0, 342.50000000000006, 339.7000000000001, 144.69999999999996, 165.4, 229.69999999999973, 280.69999999999993, 111.7999999999999, 232.3, 393.4, 328.39999999999986, 78.80000000000003, 398.1, 198.10000000000002, 255.29999999999998, 395.4, 130.79999999999927, 132.2, 388.8, 217.7], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-186.1748069621661, -444.26250014486703, 376.40013205542186, 389.166284688135, -306.7602084844401, -206.3121059642433, -189.83392938371682, 346.77513182174243, 3.887191866832616, -179.71643661532974, -183.3048543177794, -40.67726103995659, -47.580703383048714, -149.15440292828225, -229.66885860125748, 315.95962781469325, -87.48491608653629, 29.833421063156507, -141.027461879051, -497.45848563610724, 298.91422401215823, -59.95776786685127, 8.174688408947711, -41.200426082092065, -91.90059353946025, -141.8535384165317, 157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853, -315.3603855756517, -295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314, -258.4598272535702, -421.26655048653055, -159.44410958888594, 103.38873591506609, -127.4153573976846, -423.1574556018604, 95.08992233639182, -82.43676445371392, 29.432810595584854, -106.81743753174733, 398.2, 229.72874598851305, -148.8613513714564, 85.60649637624036, 360.19932590341045, -23.74203998720722, 72.45593092250755, -329.66402734128127, -516.6700241293161, -132.96785449940302, -215.62377586595076, -140.46715377207158, -187.88883207283854, -328.2677584367122, -117.66559358101662, -63.40724458305927, -235.16949981478635, -378.835094027888, -286.672098853952, 328.90008296803416, -286.3528420655002, 119.22080703577191, -111.49690387266887, -5.355989473360751, 127.64267166874947, -430.3314347504574, -225.0082265281122, -116.73031773505446, 175.97113395670186, 255.13349397183237, 251.7729725025515, -292.68570939792437, -306.7923594638208, 91.67477240291984, 176.89701958627901, -243.0905444705682, -73.25323115398886, 389.50644837087765, 246.77752189735568, -528.0415039059238, 397.2854215893083, -176.24390779299227, 48.844684034201684, 394.5581167356045, -89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689], "policy_predator_policy_reward": [342.1748069621661, 531.7625001448672, 7.599867944578135, 0.8337153118649714, 425.8602084844402, 390.21210596424305, 374.73392938371654, 10.224868178257564, 234.0128081331673, 366.01643661532984, 358.8048543177791, 233.37726103995675, 278.98070338304876, 329.15440292828214, 387.768858601257, 35.24037218530673, 237.48491608653566, 232.66657893684356, 289.7274618790509, 602.1584856361068, 55.08577598784169, 229.75776786685074, 224.22531159105225, 260.600426082092, 308.70059353946016, 353.8535384165314, 104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834, 456.86038557565183, 431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687, 362.9598272535698, 547.4665504865309, 345.4441095888858, 172.4112640849339, 320.31535739768475, 530.4574556018606, 154.410077663608, 309.83676445371424, 214.9671894044152, 328.4174375317473, 0.0, 75.77125401148687, 340.6613513714564, 147.89350362375936, 16.000674096589513, 250.5420399872073, 203.8440690774924, 458.3640273412811, 600.770024129317, 317.36785449940305, 388.6237758659509, 339.46715377207164, 287.6888320728377, 443.36775843671194, 272.06559358101595, 271.80724458305906, 367.36949981478625, 480.33509402788815, 452.6720988539521, 39.89991703196586, 389.75284206549986, 158.97919296422808, 311.39690387266893, 204.55598947336048, 191.4573283312506, 534.2314347504575, 403.3082265281121, 307.53031773505415, 126.02886604329811, 87.36650602816766, 87.92702749744859, 437.3857093979243, 472.1923594638207, 138.02522759707995, 103.80298041372087, 354.89054447056867, 305.553231153989, 3.893551629122335, 81.62247810264428, 606.841503905924, 0.8145784106916721, 374.34390779299235, 206.45531596579838, 0.8418832643955543, 219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.651902025261758, "mean_inference_ms": 3.4714164673860184, "mean_action_processing_ms": 0.999588490890723, "mean_env_wait_ms": 9.994287173555547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035886764526367188, "StateBufferConnector_ms": 0.0029371976852416992, "ViewRequirementAgentConnector_ms": 0.0681142807006836}, "num_episodes": 16, "episode_return_max": 398.2, "episode_return_min": 78.80000000000003, "episode_return_mean": 214.30799999999996, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.46831007361877, "num_env_steps_trained_throughput_per_sec": 160.46831007361877, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 24840.701, "restore_workers_time_ms": 0.029, "training_step_time_ms": 24840.559, "sample_time_ms": 1863.142, "learn_time_ms": 22950.557, "learn_throughput": 174.288, "synch_weights_time_ms": 24.749}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 54, "trial_id": "cbf82_00000", "date": "2024-08-21_13-30-37", "timestamp": 1724227237, "time_this_iter_s": 25.005748987197876, "time_total_s": 1412.2189767360687, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3074f3af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1412.2189767360687, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 31.12222222222223, "ram_util_percent": 82.20277777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8942538258930046, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.340409901738167, "policy_loss": -0.011305686360962379, "vf_loss": 6.349897423138221, "vf_explained_var": 0.17016205961505573, "kl": 0.00909072748569694, "entropy": 0.61426775145034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.873124673217536, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.319213856756687, "policy_loss": -0.028839802867150866, "vf_loss": 7.3448063537478445, "vf_explained_var": 0.09271927357961735, "kl": 0.016236624874970098, "entropy": 0.9123822358126442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 72.59999999999985, "episode_reward_mean": 211.9219999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -528.0415039059238, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 606.841503905924}, "policy_reward_mean": {"prey_policy": -63.95166338028018, "predator_policy": 275.8736633802801}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.49999999999991, 192.7, 231.4, 180.00000000000003, 158.09999999999994, 351.20000000000005, 149.99999999999997, 262.5, 148.69999999999965, 104.69999999999999, 354.0, 169.80000000000013, 232.39999999999998, 219.3999999999999, 216.8, 212.0, 262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002, 141.5, 135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995, 104.49999999999955, 126.19999999999996, 185.99999999999986, 275.8, 192.89999999999995, 107.30000000000001, 249.5, 227.4, 244.4, 221.60000000000002, 398.2, 305.50000000000017, 191.80000000000004, 233.49999999999955, 376.2, 226.8, 276.3, 128.69999999999993, 84.09999999999982, 184.39999999999998, 173.0, 199.0, 99.79999999999917, 115.09999999999991, 154.39999999999992, 208.39999999999992, 132.19999999999968, 101.4999999999998, 166.00000000000003, 368.8, 103.40000000000006, 278.2, 199.89999999999998, 199.20000000000005, 319.1, 103.9, 178.29999999999998, 190.79999999999998, 302.0, 342.50000000000006, 339.7000000000001, 144.69999999999996, 165.4, 229.69999999999973, 280.69999999999993, 111.7999999999999, 232.3, 393.4, 328.39999999999986, 78.80000000000003, 398.1, 198.10000000000002, 255.29999999999998, 395.4, 130.79999999999927, 132.2, 388.8, 217.7, 222.19999999999982, 224.99999999999972, 239.6, 72.59999999999985, 132.09999999999997, 155.79999999999993, 259.09999999999997, 249.79999999999995, 341.3, 150.49999999999997], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-183.3048543177794, -40.67726103995659, -47.580703383048714, -149.15440292828225, -229.66885860125748, 315.95962781469325, -87.48491608653629, 29.833421063156507, -141.027461879051, -497.45848563610724, 298.91422401215823, -59.95776786685127, 8.174688408947711, -41.200426082092065, -91.90059353946025, -141.8535384165317, 157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853, -315.3603855756517, -295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314, -258.4598272535702, -421.26655048653055, -159.44410958888594, 103.38873591506609, -127.4153573976846, -423.1574556018604, 95.08992233639182, -82.43676445371392, 29.432810595584854, -106.81743753174733, 398.2, 229.72874598851305, -148.8613513714564, 85.60649637624036, 360.19932590341045, -23.74203998720722, 72.45593092250755, -329.66402734128127, -516.6700241293161, -132.96785449940302, -215.62377586595076, -140.46715377207158, -187.88883207283854, -328.2677584367122, -117.66559358101662, -63.40724458305927, -235.16949981478635, -378.835094027888, -286.672098853952, 328.90008296803416, -286.3528420655002, 119.22080703577191, -111.49690387266887, -5.355989473360751, 127.64267166874947, -430.3314347504574, -225.0082265281122, -116.73031773505446, 175.97113395670186, 255.13349397183237, 251.7729725025515, -292.68570939792437, -306.7923594638208, 91.67477240291984, 176.89701958627901, -243.0905444705682, -73.25323115398886, 389.50644837087765, 246.77752189735568, -528.0415039059238, 397.2854215893083, -176.24390779299227, 48.844684034201684, 394.5581167356045, -89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689, -32.654208079802444, -23.632189645687422, -38.18431931208067, -283.2284509841188, -343.64238716020475, -178.53441764974215, 254.2843822162861, 73.44032105806866, 289.24480461653974, -155.31278529190442], "policy_predator_policy_reward": [358.8048543177791, 233.37726103995675, 278.98070338304876, 329.15440292828214, 387.768858601257, 35.24037218530673, 237.48491608653566, 232.66657893684356, 289.7274618790509, 602.1584856361068, 55.08577598784169, 229.75776786685074, 224.22531159105225, 260.600426082092, 308.70059353946016, 353.8535384165314, 104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834, 456.86038557565183, 431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687, 362.9598272535698, 547.4665504865309, 345.4441095888858, 172.4112640849339, 320.31535739768475, 530.4574556018606, 154.410077663608, 309.83676445371424, 214.9671894044152, 328.4174375317473, 0.0, 75.77125401148687, 340.6613513714564, 147.89350362375936, 16.000674096589513, 250.5420399872073, 203.8440690774924, 458.3640273412811, 600.770024129317, 317.36785449940305, 388.6237758659509, 339.46715377207164, 287.6888320728377, 443.36775843671194, 272.06559358101595, 271.80724458305906, 367.36949981478625, 480.33509402788815, 452.6720988539521, 39.89991703196586, 389.75284206549986, 158.97919296422808, 311.39690387266893, 204.55598947336048, 191.4573283312506, 534.2314347504575, 403.3082265281121, 307.53031773505415, 126.02886604329811, 87.36650602816766, 87.92702749744859, 437.3857093979243, 472.1923594638207, 138.02522759707995, 103.80298041372087, 354.89054447056867, 305.553231153989, 3.893551629122335, 81.62247810264428, 606.841503905924, 0.8145784106916721, 374.34390779299235, 206.45531596579838, 0.8418832643955543, 219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677, 254.85420807980236, 248.63218964568713, 277.7843193120804, 355.8284509841185, 475.742387160205, 334.3344176497419, 4.815617783713885, 176.35967894193135, 52.0551953834604, 305.812785291904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6440551661706997, "mean_inference_ms": 3.456305805644092, "mean_action_processing_ms": 1.0022333880644112, "mean_env_wait_ms": 9.986886615332214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0429002046585083, "StateBufferConnector_ms": 0.0030138492584228516, "ViewRequirementAgentConnector_ms": 0.07791435718536377}, "num_episodes": 10, "episode_return_max": 398.2, "episode_return_min": 72.59999999999985, "episode_return_mean": 211.9219999999999, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.0178428103413, "num_env_steps_trained_throughput_per_sec": 156.0178428103413, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 24935.598, "restore_workers_time_ms": 0.029, "training_step_time_ms": 24935.359, "sample_time_ms": 1918.106, "learn_time_ms": 22990.475, "learn_throughput": 173.985, "synch_weights_time_ms": 24.381}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 55, "trial_id": "cbf82_00000", "date": "2024-08-21_13-31-03", "timestamp": 1724227263, "time_this_iter_s": 25.684990882873535, "time_total_s": 1437.9039676189423, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3073a0700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1437.9039676189423, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 34.28055555555555, "ram_util_percent": 82.87222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.675107884282867, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.358815369506677, "policy_loss": -0.007236134602862876, "vf_loss": 6.364529543121656, "vf_explained_var": 0.15628524062534174, "kl": 0.007609852854026637, "entropy": 0.6577787748537958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.093189349522193, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.259318646788597, "policy_loss": -0.021117329392776205, "vf_loss": 7.277808787425359, "vf_explained_var": 0.06869854169587294, "kl": 0.013135935477718401, "entropy": 0.8941445344438156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 69.60000000000016, "episode_reward_mean": 210.77499999999992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -542.2501938402174, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 613.9501938402171}, "policy_reward_mean": {"prey_policy": -68.15244966752161, "predator_policy": 278.92744966752156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.69999999999999, 354.0, 169.80000000000013, 232.39999999999998, 219.3999999999999, 216.8, 212.0, 262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002, 141.5, 135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995, 104.49999999999955, 126.19999999999996, 185.99999999999986, 275.8, 192.89999999999995, 107.30000000000001, 249.5, 227.4, 244.4, 221.60000000000002, 398.2, 305.50000000000017, 191.80000000000004, 233.49999999999955, 376.2, 226.8, 276.3, 128.69999999999993, 84.09999999999982, 184.39999999999998, 173.0, 199.0, 99.79999999999917, 115.09999999999991, 154.39999999999992, 208.39999999999992, 132.19999999999968, 101.4999999999998, 166.00000000000003, 368.8, 103.40000000000006, 278.2, 199.89999999999998, 199.20000000000005, 319.1, 103.9, 178.29999999999998, 190.79999999999998, 302.0, 342.50000000000006, 339.7000000000001, 144.69999999999996, 165.4, 229.69999999999973, 280.69999999999993, 111.7999999999999, 232.3, 393.4, 328.39999999999986, 78.80000000000003, 398.1, 198.10000000000002, 255.29999999999998, 395.4, 130.79999999999927, 132.2, 388.8, 217.7, 222.19999999999982, 224.99999999999972, 239.6, 72.59999999999985, 132.09999999999997, 155.79999999999993, 259.09999999999997, 249.79999999999995, 341.3, 150.49999999999997, 358.3, 109.59999999999977, 69.60000000000016, 262.6999999999998, 71.70000000000005, 167.0, 254.49999999999983, 126.39999999999975, 315.6], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-497.45848563610724, 298.91422401215823, -59.95776786685127, 8.174688408947711, -41.200426082092065, -91.90059353946025, -141.8535384165317, 157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853, -315.3603855756517, -295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314, -258.4598272535702, -421.26655048653055, -159.44410958888594, 103.38873591506609, -127.4153573976846, -423.1574556018604, 95.08992233639182, -82.43676445371392, 29.432810595584854, -106.81743753174733, 398.2, 229.72874598851305, -148.8613513714564, 85.60649637624036, 360.19932590341045, -23.74203998720722, 72.45593092250755, -329.66402734128127, -516.6700241293161, -132.96785449940302, -215.62377586595076, -140.46715377207158, -187.88883207283854, -328.2677584367122, -117.66559358101662, -63.40724458305927, -235.16949981478635, -378.835094027888, -286.672098853952, 328.90008296803416, -286.3528420655002, 119.22080703577191, -111.49690387266887, -5.355989473360751, 127.64267166874947, -430.3314347504574, -225.0082265281122, -116.73031773505446, 175.97113395670186, 255.13349397183237, 251.7729725025515, -292.68570939792437, -306.7923594638208, 91.67477240291984, 176.89701958627901, -243.0905444705682, -73.25323115398886, 389.50644837087765, 246.77752189735568, -528.0415039059238, 397.2854215893083, -176.24390779299227, 48.844684034201684, 394.5581167356045, -89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689, -32.654208079802444, -23.632189645687422, -38.18431931208067, -283.2284509841188, -343.64238716020475, -178.53441764974215, 254.2843822162861, 73.44032105806866, 289.24480461653974, -155.31278529190442, 336.99792607385007, -374.39551716265663, -250.75800712609606, 65.52116885224706, -542.2501938402174, -311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506], "policy_predator_policy_reward": [602.1584856361068, 55.08577598784169, 229.75776786685074, 224.22531159105225, 260.600426082092, 308.70059353946016, 353.8535384165314, 104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834, 456.86038557565183, 431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687, 362.9598272535698, 547.4665504865309, 345.4441095888858, 172.4112640849339, 320.31535739768475, 530.4574556018606, 154.410077663608, 309.83676445371424, 214.9671894044152, 328.4174375317473, 0.0, 75.77125401148687, 340.6613513714564, 147.89350362375936, 16.000674096589513, 250.5420399872073, 203.8440690774924, 458.3640273412811, 600.770024129317, 317.36785449940305, 388.6237758659509, 339.46715377207164, 287.6888320728377, 443.36775843671194, 272.06559358101595, 271.80724458305906, 367.36949981478625, 480.33509402788815, 452.6720988539521, 39.89991703196586, 389.75284206549986, 158.97919296422808, 311.39690387266893, 204.55598947336048, 191.4573283312506, 534.2314347504575, 403.3082265281121, 307.53031773505415, 126.02886604329811, 87.36650602816766, 87.92702749744859, 437.3857093979243, 472.1923594638207, 138.02522759707995, 103.80298041372087, 354.89054447056867, 305.553231153989, 3.893551629122335, 81.62247810264428, 606.841503905924, 0.8145784106916721, 374.34390779299235, 206.45531596579838, 0.8418832643955543, 219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677, 254.85420807980236, 248.63218964568713, 277.7843193120804, 355.8284509841185, 475.742387160205, 334.3344176497419, 4.815617783713885, 176.35967894193135, 52.0551953834604, 305.812785291904, 21.30207392614994, 483.9955171626561, 320.35800712609637, 197.1788311477529, 613.9501938402171, 478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.635607086546793, "mean_inference_ms": 3.453633940049735, "mean_action_processing_ms": 0.9868460882686995, "mean_env_wait_ms": 9.990646188015749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04298245906829834, "StateBufferConnector_ms": 0.003003716468811035, "ViewRequirementAgentConnector_ms": 0.07840752601623535}, "num_episodes": 9, "episode_return_max": 398.2, "episode_return_min": 69.60000000000016, "episode_return_mean": 210.77499999999992, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.85145316483752, "num_env_steps_trained_throughput_per_sec": 158.85145316483752, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 24982.582, "restore_workers_time_ms": 0.029, "training_step_time_ms": 24982.342, "sample_time_ms": 1920.378, "learn_time_ms": 23035.118, "learn_throughput": 173.648, "synch_weights_time_ms": 24.467}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 56, "trial_id": "cbf82_00000", "date": "2024-08-21_13-31-28", "timestamp": 1724227288, "time_this_iter_s": 25.187339067459106, "time_total_s": 1463.0913066864014, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e34ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1463.0913066864014, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 30.808571428571426, "ram_util_percent": 82.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9563491559276978, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.672796362141768, "policy_loss": -0.008838203610018051, "vf_loss": 6.67961498995622, "vf_explained_var": 0.17449527873347204, "kl": 0.010097867669173866, "entropy": 0.5970299969116847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.381142935963968, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.38832178413868, "policy_loss": -0.01789400832785759, "vf_loss": 7.40394498805205, "vf_explained_var": 0.19590819124132394, "kl": 0.01135391468318024, "entropy": 0.8904697626208266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 69.60000000000016, "episode_reward_mean": 213.84799999999987, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -542.2501938402174, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 613.9501938402171}, "policy_reward_mean": {"prey_policy": -60.399196020447654, "predator_policy": 274.24719602044763}, "custom_metrics": {}, "hist_stats": {"episode_reward": [262.3, 260.79999999999995, 185.2, 128.09999999999997, 165.19999999999996, 224.70000000000002, 226.60000000000002, 141.5, 135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995, 104.49999999999955, 126.19999999999996, 185.99999999999986, 275.8, 192.89999999999995, 107.30000000000001, 249.5, 227.4, 244.4, 221.60000000000002, 398.2, 305.50000000000017, 191.80000000000004, 233.49999999999955, 376.2, 226.8, 276.3, 128.69999999999993, 84.09999999999982, 184.39999999999998, 173.0, 199.0, 99.79999999999917, 115.09999999999991, 154.39999999999992, 208.39999999999992, 132.19999999999968, 101.4999999999998, 166.00000000000003, 368.8, 103.40000000000006, 278.2, 199.89999999999998, 199.20000000000005, 319.1, 103.9, 178.29999999999998, 190.79999999999998, 302.0, 342.50000000000006, 339.7000000000001, 144.69999999999996, 165.4, 229.69999999999973, 280.69999999999993, 111.7999999999999, 232.3, 393.4, 328.39999999999986, 78.80000000000003, 398.1, 198.10000000000002, 255.29999999999998, 395.4, 130.79999999999927, 132.2, 388.8, 217.7, 222.19999999999982, 224.99999999999972, 239.6, 72.59999999999985, 132.09999999999997, 155.79999999999993, 259.09999999999997, 249.79999999999995, 341.3, 150.49999999999997, 358.3, 109.59999999999977, 69.60000000000016, 262.6999999999998, 71.70000000000005, 167.0, 254.49999999999983, 126.39999999999975, 315.6, 154.39999999999986, 256.19999999999993, 378.1, 144.29999999999998, 220.59999999999997, 305.3, 357.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [157.42625794757004, 65.19535988999138, -161.0907123840237, -228.00215639462976, -315.4735134002937, -61.953031229413845, -38.35140263236853, -315.3603855756517, -295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314, -258.4598272535702, -421.26655048653055, -159.44410958888594, 103.38873591506609, -127.4153573976846, -423.1574556018604, 95.08992233639182, -82.43676445371392, 29.432810595584854, -106.81743753174733, 398.2, 229.72874598851305, -148.8613513714564, 85.60649637624036, 360.19932590341045, -23.74203998720722, 72.45593092250755, -329.66402734128127, -516.6700241293161, -132.96785449940302, -215.62377586595076, -140.46715377207158, -187.88883207283854, -328.2677584367122, -117.66559358101662, -63.40724458305927, -235.16949981478635, -378.835094027888, -286.672098853952, 328.90008296803416, -286.3528420655002, 119.22080703577191, -111.49690387266887, -5.355989473360751, 127.64267166874947, -430.3314347504574, -225.0082265281122, -116.73031773505446, 175.97113395670186, 255.13349397183237, 251.7729725025515, -292.68570939792437, -306.7923594638208, 91.67477240291984, 176.89701958627901, -243.0905444705682, -73.25323115398886, 389.50644837087765, 246.77752189735568, -528.0415039059238, 397.2854215893083, -176.24390779299227, 48.844684034201684, 394.5581167356045, -89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689, -32.654208079802444, -23.632189645687422, -38.18431931208067, -283.2284509841188, -343.64238716020475, -178.53441764974215, 254.2843822162861, 73.44032105806866, 289.24480461653974, -155.31278529190442, 336.99792607385007, -374.39551716265663, -250.75800712609606, 65.52116885224706, -542.2501938402174, -311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506, -228.36801504285137, 54.355337087577816, 375.13127377864805, -262.3470486507464, -120.47429414907927, 139.23946376900275, 292.50674879490776], "policy_predator_policy_reward": [104.87374205242993, 195.60464011000857, 346.2907123840235, 356.10215639462973, 480.67351340029353, 286.65303122941395, 264.95140263236834, 456.86038557565183, 431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687, 362.9598272535698, 547.4665504865309, 345.4441095888858, 172.4112640849339, 320.31535739768475, 530.4574556018606, 154.410077663608, 309.83676445371424, 214.9671894044152, 328.4174375317473, 0.0, 75.77125401148687, 340.6613513714564, 147.89350362375936, 16.000674096589513, 250.5420399872073, 203.8440690774924, 458.3640273412811, 600.770024129317, 317.36785449940305, 388.6237758659509, 339.46715377207164, 287.6888320728377, 443.36775843671194, 272.06559358101595, 271.80724458305906, 367.36949981478625, 480.33509402788815, 452.6720988539521, 39.89991703196586, 389.75284206549986, 158.97919296422808, 311.39690387266893, 204.55598947336048, 191.4573283312506, 534.2314347504575, 403.3082265281121, 307.53031773505415, 126.02886604329811, 87.36650602816766, 87.92702749744859, 437.3857093979243, 472.1923594638207, 138.02522759707995, 103.80298041372087, 354.89054447056867, 305.553231153989, 3.893551629122335, 81.62247810264428, 606.841503905924, 0.8145784106916721, 374.34390779299235, 206.45531596579838, 0.8418832643955543, 219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677, 254.85420807980236, 248.63218964568713, 277.7843193120804, 355.8284509841185, 475.742387160205, 334.3344176497419, 4.815617783713885, 176.35967894193135, 52.0551953834604, 305.812785291904, 21.30207392614994, 483.9955171626561, 320.35800712609637, 197.1788311477529, 613.9501938402171, 478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333, 382.7680150428513, 201.84466291242205, 2.968726221351959, 406.6470486507466, 341.0742941490792, 166.06053623099712, 64.99325120509216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6308043408106396, "mean_inference_ms": 3.4363116837747163, "mean_action_processing_ms": 0.994180164129499, "mean_env_wait_ms": 9.986721854738263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04292631149291992, "StateBufferConnector_ms": 0.003008127212524414, "ViewRequirementAgentConnector_ms": 0.06781637668609619}, "num_episodes": 7, "episode_return_max": 398.2, "episode_return_min": 69.60000000000016, "episode_return_mean": 213.84799999999987, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.970268663559, "num_env_steps_trained_throughput_per_sec": 164.970268663559, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 24923.924, "restore_workers_time_ms": 0.029, "training_step_time_ms": 24923.637, "sample_time_ms": 1882.51, "learn_time_ms": 23015.28, "learn_throughput": 173.798, "synch_weights_time_ms": 22.912}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 57, "trial_id": "cbf82_00000", "date": "2024-08-21_13-31-53", "timestamp": 1724227313, "time_this_iter_s": 24.285215854644775, "time_total_s": 1487.3765225410461, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e34dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1487.3765225410461, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 27.102857142857143, "ram_util_percent": 82.13142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.9033257234841585, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.4412462164958315, "policy_loss": -0.009338487887240869, "vf_loss": 6.448793408771356, "vf_explained_var": 0.16144979267070692, "kl": 0.008956427595209485, "entropy": 0.6277460804209113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.85453523149093, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.475223728517691, "policy_loss": -0.021495808348117863, "vf_loss": 7.494192324082056, "vf_explained_var": -0.004316331384082635, "kl": 0.012635979680878033, "entropy": 0.8775041975701848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 64.10000000000007, "episode_reward_mean": 209.28599999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -72.7799150777398, "predator_policy": 282.0659150777398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.59999999999988, 230.7999999999999, 183.59999999999928, 266.19999999999993, 139.79999999999995, 137.69999999999996, 165.59999999999914, 233.39999999999995, 104.49999999999955, 126.19999999999996, 185.99999999999986, 275.8, 192.89999999999995, 107.30000000000001, 249.5, 227.4, 244.4, 221.60000000000002, 398.2, 305.50000000000017, 191.80000000000004, 233.49999999999955, 376.2, 226.8, 276.3, 128.69999999999993, 84.09999999999982, 184.39999999999998, 173.0, 199.0, 99.79999999999917, 115.09999999999991, 154.39999999999992, 208.39999999999992, 132.19999999999968, 101.4999999999998, 166.00000000000003, 368.8, 103.40000000000006, 278.2, 199.89999999999998, 199.20000000000005, 319.1, 103.9, 178.29999999999998, 190.79999999999998, 302.0, 342.50000000000006, 339.7000000000001, 144.69999999999996, 165.4, 229.69999999999973, 280.69999999999993, 111.7999999999999, 232.3, 393.4, 328.39999999999986, 78.80000000000003, 398.1, 198.10000000000002, 255.29999999999998, 395.4, 130.79999999999927, 132.2, 388.8, 217.7, 222.19999999999982, 224.99999999999972, 239.6, 72.59999999999985, 132.09999999999997, 155.79999999999993, 259.09999999999997, 249.79999999999995, 341.3, 150.49999999999997, 358.3, 109.59999999999977, 69.60000000000016, 262.6999999999998, 71.70000000000005, 167.0, 254.49999999999983, 126.39999999999975, 315.6, 154.39999999999986, 256.19999999999993, 378.1, 144.29999999999998, 220.59999999999997, 305.3, 357.5, 165.8999999999998, 128.59999999999997, 64.10000000000007, 149.89999999999986, 158.89999999999992, 297.79999999999995, 69.19999999999997, 103.79999999999981], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-295.4144773681521, -50.51433828289818, 38.62782056339084, 102.4329630582802, -349.74415761975024, -355.3037251965252, 85.16615281839675, -3.6124815446269314, -258.4598272535702, -421.26655048653055, -159.44410958888594, 103.38873591506609, -127.4153573976846, -423.1574556018604, 95.08992233639182, -82.43676445371392, 29.432810595584854, -106.81743753174733, 398.2, 229.72874598851305, -148.8613513714564, 85.60649637624036, 360.19932590341045, -23.74203998720722, 72.45593092250755, -329.66402734128127, -516.6700241293161, -132.96785449940302, -215.62377586595076, -140.46715377207158, -187.88883207283854, -328.2677584367122, -117.66559358101662, -63.40724458305927, -235.16949981478635, -378.835094027888, -286.672098853952, 328.90008296803416, -286.3528420655002, 119.22080703577191, -111.49690387266887, -5.355989473360751, 127.64267166874947, -430.3314347504574, -225.0082265281122, -116.73031773505446, 175.97113395670186, 255.13349397183237, 251.7729725025515, -292.68570939792437, -306.7923594638208, 91.67477240291984, 176.89701958627901, -243.0905444705682, -73.25323115398886, 389.50644837087765, 246.77752189735568, -528.0415039059238, 397.2854215893083, -176.24390779299227, 48.844684034201684, 394.5581167356045, -89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689, -32.654208079802444, -23.632189645687422, -38.18431931208067, -283.2284509841188, -343.64238716020475, -178.53441764974215, 254.2843822162861, 73.44032105806866, 289.24480461653974, -155.31278529190442, 336.99792607385007, -374.39551716265663, -250.75800712609606, 65.52116885224706, -542.2501938402174, -311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506, -228.36801504285137, 54.355337087577816, 375.13127377864805, -262.3470486507464, -120.47429414907927, 139.23946376900275, 292.50674879490776, -118.79174281264902, -274.0202663814661, -476.5910330279585, -345.6437408287901, -279.9633281372732, 291.4521321738304, -553.0716073694585, -379.05190312426805], "policy_predator_policy_reward": [431.01447736815254, 281.3143382828982, 144.97217943660922, 163.7670369417199, 489.54415761975037, 493.0037251965253, 80.43384718160344, 237.01248154462687, 362.9598272535698, 547.4665504865309, 345.4441095888858, 172.4112640849339, 320.31535739768475, 530.4574556018606, 154.410077663608, 309.83676445371424, 214.9671894044152, 328.4174375317473, 0.0, 75.77125401148687, 340.6613513714564, 147.89350362375936, 16.000674096589513, 250.5420399872073, 203.8440690774924, 458.3640273412811, 600.770024129317, 317.36785449940305, 388.6237758659509, 339.46715377207164, 287.6888320728377, 443.36775843671194, 272.06559358101595, 271.80724458305906, 367.36949981478625, 480.33509402788815, 452.6720988539521, 39.89991703196586, 389.75284206549986, 158.97919296422808, 311.39690387266893, 204.55598947336048, 191.4573283312506, 534.2314347504575, 403.3082265281121, 307.53031773505415, 126.02886604329811, 87.36650602816766, 87.92702749744859, 437.3857093979243, 472.1923594638207, 138.02522759707995, 103.80298041372087, 354.89054447056867, 305.553231153989, 3.893551629122335, 81.62247810264428, 606.841503905924, 0.8145784106916721, 374.34390779299235, 206.45531596579838, 0.8418832643955543, 219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677, 254.85420807980236, 248.63218964568713, 277.7843193120804, 355.8284509841185, 475.742387160205, 334.3344176497419, 4.815617783713885, 176.35967894193135, 52.0551953834604, 305.812785291904, 21.30207392614994, 483.9955171626561, 320.35800712609637, 197.1788311477529, 613.9501938402171, 478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333, 382.7680150428513, 201.84466291242205, 2.968726221351959, 406.6470486507466, 341.0742941490792, 166.06053623099712, 64.99325120509216, 284.69174281264867, 402.6202663814661, 540.6910330279585, 495.54374082879065, 438.86332813727387, 6.347867826169584, 622.2716073694597, 482.85190312426863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6220059774474676, "mean_inference_ms": 3.442137591764789, "mean_action_processing_ms": 0.9669086084409666, "mean_env_wait_ms": 9.980017676801856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04297506809234619, "StateBufferConnector_ms": 0.0030106306076049805, "ViewRequirementAgentConnector_ms": 0.06684541702270508}, "num_episodes": 8, "episode_return_max": 398.2, "episode_return_min": 64.10000000000007, "episode_return_mean": 209.28599999999994, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.90605840860206, "num_env_steps_trained_throughput_per_sec": 157.90605840860206, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 24996.233, "restore_workers_time_ms": 0.029, "training_step_time_ms": 24995.946, "sample_time_ms": 1931.446, "learn_time_ms": 23038.934, "learn_throughput": 173.619, "synch_weights_time_ms": 22.578}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 58, "trial_id": "cbf82_00000", "date": "2024-08-21_13-32-18", "timestamp": 1724227338, "time_this_iter_s": 25.376208782196045, "time_total_s": 1512.7527313232422, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075bd670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1512.7527313232422, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 29.883333333333333, "ram_util_percent": 82.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.961005537087718, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.807880465189616, "policy_loss": -0.009309892238040145, "vf_loss": 5.815359768768151, "vf_explained_var": 0.19583548624068498, "kl": 0.009152997034107102, "entropy": 0.7322110068673889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.517735401913523, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.458596296608448, "policy_loss": -0.021913141490464718, "vf_loss": 7.478028412659963, "vf_explained_var": 0.11500682483116785, "kl": 0.01240508795453934, "entropy": 0.9011525956292947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 64.10000000000007, "episode_reward_mean": 211.1889999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -67.96559940192822, "predator_policy": 279.15459940192824}, "custom_metrics": {}, "hist_stats": {"episode_reward": [275.8, 192.89999999999995, 107.30000000000001, 249.5, 227.4, 244.4, 221.60000000000002, 398.2, 305.50000000000017, 191.80000000000004, 233.49999999999955, 376.2, 226.8, 276.3, 128.69999999999993, 84.09999999999982, 184.39999999999998, 173.0, 199.0, 99.79999999999917, 115.09999999999991, 154.39999999999992, 208.39999999999992, 132.19999999999968, 101.4999999999998, 166.00000000000003, 368.8, 103.40000000000006, 278.2, 199.89999999999998, 199.20000000000005, 319.1, 103.9, 178.29999999999998, 190.79999999999998, 302.0, 342.50000000000006, 339.7000000000001, 144.69999999999996, 165.4, 229.69999999999973, 280.69999999999993, 111.7999999999999, 232.3, 393.4, 328.39999999999986, 78.80000000000003, 398.1, 198.10000000000002, 255.29999999999998, 395.4, 130.79999999999927, 132.2, 388.8, 217.7, 222.19999999999982, 224.99999999999972, 239.6, 72.59999999999985, 132.09999999999997, 155.79999999999993, 259.09999999999997, 249.79999999999995, 341.3, 150.49999999999997, 358.3, 109.59999999999977, 69.60000000000016, 262.6999999999998, 71.70000000000005, 167.0, 254.49999999999983, 126.39999999999975, 315.6, 154.39999999999986, 256.19999999999993, 378.1, 144.29999999999998, 220.59999999999997, 305.3, 357.5, 165.8999999999998, 128.59999999999997, 64.10000000000007, 149.89999999999986, 158.89999999999992, 297.79999999999995, 69.19999999999997, 103.79999999999981, 347.3, 185.10000000000002, 168.6999999999999, 112.29999999999976, 160.19999999999942, 240.39999999999992, 110.09999999999977, 285.10000000000025, 80.59999999999951, 271.90000000000003, 137.99999999999994], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [103.38873591506609, -127.4153573976846, -423.1574556018604, 95.08992233639182, -82.43676445371392, 29.432810595584854, -106.81743753174733, 398.2, 229.72874598851305, -148.8613513714564, 85.60649637624036, 360.19932590341045, -23.74203998720722, 72.45593092250755, -329.66402734128127, -516.6700241293161, -132.96785449940302, -215.62377586595076, -140.46715377207158, -187.88883207283854, -328.2677584367122, -117.66559358101662, -63.40724458305927, -235.16949981478635, -378.835094027888, -286.672098853952, 328.90008296803416, -286.3528420655002, 119.22080703577191, -111.49690387266887, -5.355989473360751, 127.64267166874947, -430.3314347504574, -225.0082265281122, -116.73031773505446, 175.97113395670186, 255.13349397183237, 251.7729725025515, -292.68570939792437, -306.7923594638208, 91.67477240291984, 176.89701958627901, -243.0905444705682, -73.25323115398886, 389.50644837087765, 246.77752189735568, -528.0415039059238, 397.2854215893083, -176.24390779299227, 48.844684034201684, 394.5581167356045, -89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689, -32.654208079802444, -23.632189645687422, -38.18431931208067, -283.2284509841188, -343.64238716020475, -178.53441764974215, 254.2843822162861, 73.44032105806866, 289.24480461653974, -155.31278529190442, 336.99792607385007, -374.39551716265663, -250.75800712609606, 65.52116885224706, -542.2501938402174, -311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506, -228.36801504285137, 54.355337087577816, 375.13127377864805, -262.3470486507464, -120.47429414907927, 139.23946376900275, 292.50674879490776, -118.79174281264902, -274.0202663814661, -476.5910330279585, -345.6437408287901, -279.9633281372732, 291.4521321738304, -553.0716073694585, -379.05190312426805, 314.2458832451748, -237.96869506297702, -67.07372890471147, -418.8121474173992, -81.90529232936592, 16.43626128855909, -353.10267935846446, 142.48970070755476, -303.69017722305017, 129.38704651736234, -326.1073347823983], "policy_predator_policy_reward": [172.4112640849339, 320.31535739768475, 530.4574556018606, 154.410077663608, 309.83676445371424, 214.9671894044152, 328.4174375317473, 0.0, 75.77125401148687, 340.6613513714564, 147.89350362375936, 16.000674096589513, 250.5420399872073, 203.8440690774924, 458.3640273412811, 600.770024129317, 317.36785449940305, 388.6237758659509, 339.46715377207164, 287.6888320728377, 443.36775843671194, 272.06559358101595, 271.80724458305906, 367.36949981478625, 480.33509402788815, 452.6720988539521, 39.89991703196586, 389.75284206549986, 158.97919296422808, 311.39690387266893, 204.55598947336048, 191.4573283312506, 534.2314347504575, 403.3082265281121, 307.53031773505415, 126.02886604329811, 87.36650602816766, 87.92702749744859, 437.3857093979243, 472.1923594638207, 138.02522759707995, 103.80298041372087, 354.89054447056867, 305.553231153989, 3.893551629122335, 81.62247810264428, 606.841503905924, 0.8145784106916721, 374.34390779299235, 206.45531596579838, 0.8418832643955543, 219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677, 254.85420807980236, 248.63218964568713, 277.7843193120804, 355.8284509841185, 475.742387160205, 334.3344176497419, 4.815617783713885, 176.35967894193135, 52.0551953834604, 305.812785291904, 21.30207392614994, 483.9955171626561, 320.35800712609637, 197.1788311477529, 613.9501938402171, 478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333, 382.7680150428513, 201.84466291242205, 2.968726221351959, 406.6470486507466, 341.0742941490792, 166.06053623099712, 64.99325120509216, 284.69174281264867, 402.6202663814661, 540.6910330279585, 495.54374082879065, 438.86332813727387, 6.347867826169584, 622.2716073694597, 482.85190312426863, 33.054116754825195, 423.0686950629771, 235.77372890471145, 531.1121474174001, 242.10529232936605, 223.96373871144087, 463.20267935846425, 142.61029929244535, 384.29017722305224, 142.5129534826375, 464.1073347823986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6136367280480552, "mean_inference_ms": 3.4309212271953826, "mean_action_processing_ms": 0.9620464208143769, "mean_env_wait_ms": 9.980989526407003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04273366928100586, "StateBufferConnector_ms": 0.0030069351196289062, "ViewRequirementAgentConnector_ms": 0.0661931037902832}, "num_episodes": 11, "episode_return_max": 398.2, "episode_return_min": 64.10000000000007, "episode_return_mean": 211.1889999999999, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.89052322962553, "num_env_steps_trained_throughput_per_sec": 162.89052322962553, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 24901.271, "restore_workers_time_ms": 0.021, "training_step_time_ms": 24901.012, "sample_time_ms": 1882.13, "learn_time_ms": 22992.897, "learn_throughput": 173.967, "synch_weights_time_ms": 23.166}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "training_iteration": 59, "trial_id": "cbf82_00000", "date": "2024-08-21_13-32-43", "timestamp": 1724227363, "time_this_iter_s": 24.56368112564087, "time_total_s": 1537.316412448883, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e00a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1537.316412448883, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 28.361764705882354, "ram_util_percent": 82.19411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.269238802914818, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.238616080582142, "policy_loss": -0.010453424585284666, "vf_loss": 5.2472427122294905, "vf_explained_var": 0.20324524883180856, "kl": 0.009133882862564254, "entropy": 0.7812269896889726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.422481705745062, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.6559609388311705, "policy_loss": -0.024067861441047476, "vf_loss": 6.6775359953443205, "vf_explained_var": 0.24781878044207892, "kl": 0.012463972443219973, "entropy": 0.9254452522223194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 398.1, "episode_reward_min": 52.80000000000008, "episode_reward_mean": 200.9809999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 0.8145784106916721}, "policy_reward_max": {"prey_policy": 397.2854215893083, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -89.60423574729833, "predator_policy": 290.5852357472984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [376.2, 226.8, 276.3, 128.69999999999993, 84.09999999999982, 184.39999999999998, 173.0, 199.0, 99.79999999999917, 115.09999999999991, 154.39999999999992, 208.39999999999992, 132.19999999999968, 101.4999999999998, 166.00000000000003, 368.8, 103.40000000000006, 278.2, 199.89999999999998, 199.20000000000005, 319.1, 103.9, 178.29999999999998, 190.79999999999998, 302.0, 342.50000000000006, 339.7000000000001, 144.69999999999996, 165.4, 229.69999999999973, 280.69999999999993, 111.7999999999999, 232.3, 393.4, 328.39999999999986, 78.80000000000003, 398.1, 198.10000000000002, 255.29999999999998, 395.4, 130.79999999999927, 132.2, 388.8, 217.7, 222.19999999999982, 224.99999999999972, 239.6, 72.59999999999985, 132.09999999999997, 155.79999999999993, 259.09999999999997, 249.79999999999995, 341.3, 150.49999999999997, 358.3, 109.59999999999977, 69.60000000000016, 262.6999999999998, 71.70000000000005, 167.0, 254.49999999999983, 126.39999999999975, 315.6, 154.39999999999986, 256.19999999999993, 378.1, 144.29999999999998, 220.59999999999997, 305.3, 357.5, 165.8999999999998, 128.59999999999997, 64.10000000000007, 149.89999999999986, 158.89999999999992, 297.79999999999995, 69.19999999999997, 103.79999999999981, 347.3, 185.10000000000002, 168.6999999999999, 112.29999999999976, 160.19999999999942, 240.39999999999992, 110.09999999999977, 285.10000000000025, 80.59999999999951, 271.90000000000003, 137.99999999999994, 76.10000000000026, 159.60000000000008, 215.9, 196.39999999999995, 191.09999999999982, 185.30000000000013, 109.09999999999997, 136.99999999999983, 52.80000000000008, 106.99999999999997, 196.8], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [360.19932590341045, -23.74203998720722, 72.45593092250755, -329.66402734128127, -516.6700241293161, -132.96785449940302, -215.62377586595076, -140.46715377207158, -187.88883207283854, -328.2677584367122, -117.66559358101662, -63.40724458305927, -235.16949981478635, -378.835094027888, -286.672098853952, 328.90008296803416, -286.3528420655002, 119.22080703577191, -111.49690387266887, -5.355989473360751, 127.64267166874947, -430.3314347504574, -225.0082265281122, -116.73031773505446, 175.97113395670186, 255.13349397183237, 251.7729725025515, -292.68570939792437, -306.7923594638208, 91.67477240291984, 176.89701958627901, -243.0905444705682, -73.25323115398886, 389.50644837087765, 246.77752189735568, -528.0415039059238, 397.2854215893083, -176.24390779299227, 48.844684034201684, 394.5581167356045, -89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689, -32.654208079802444, -23.632189645687422, -38.18431931208067, -283.2284509841188, -343.64238716020475, -178.53441764974215, 254.2843822162861, 73.44032105806866, 289.24480461653974, -155.31278529190442, 336.99792607385007, -374.39551716265663, -250.75800712609606, 65.52116885224706, -542.2501938402174, -311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506, -228.36801504285137, 54.355337087577816, 375.13127377864805, -262.3470486507464, -120.47429414907927, 139.23946376900275, 292.50674879490776, -118.79174281264902, -274.0202663814661, -476.5910330279585, -345.6437408287901, -279.9633281372732, 291.4521321738304, -553.0716073694585, -379.05190312426805, 314.2458832451748, -237.96869506297702, -67.07372890471147, -418.8121474173992, -81.90529232936592, 16.43626128855909, -353.10267935846446, 142.48970070755476, -303.69017722305017, 129.38704651736234, -326.1073347823983, -152.24438998468227, -107.35009053533813, -80.29128216955493, -94.22275360207009, -83.2237111708841, -48.76255399145796, -301.5534880975212, -276.55655807070514, -477.4148693150802, -381.73063756878713, -107.75495517559557], "policy_predator_policy_reward": [16.000674096589513, 250.5420399872073, 203.8440690774924, 458.3640273412811, 600.770024129317, 317.36785449940305, 388.6237758659509, 339.46715377207164, 287.6888320728377, 443.36775843671194, 272.06559358101595, 271.80724458305906, 367.36949981478625, 480.33509402788815, 452.6720988539521, 39.89991703196586, 389.75284206549986, 158.97919296422808, 311.39690387266893, 204.55598947336048, 191.4573283312506, 534.2314347504575, 403.3082265281121, 307.53031773505415, 126.02886604329811, 87.36650602816766, 87.92702749744859, 437.3857093979243, 472.1923594638207, 138.02522759707995, 103.80298041372087, 354.89054447056867, 305.553231153989, 3.893551629122335, 81.62247810264428, 606.841503905924, 0.8145784106916721, 374.34390779299235, 206.45531596579838, 0.8418832643955543, 219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677, 254.85420807980236, 248.63218964568713, 277.7843193120804, 355.8284509841185, 475.742387160205, 334.3344176497419, 4.815617783713885, 176.35967894193135, 52.0551953834604, 305.812785291904, 21.30207392614994, 483.9955171626561, 320.35800712609637, 197.1788311477529, 613.9501938402171, 478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333, 382.7680150428513, 201.84466291242205, 2.968726221351959, 406.6470486507466, 341.0742941490792, 166.06053623099712, 64.99325120509216, 284.69174281264867, 402.6202663814661, 540.6910330279585, 495.54374082879065, 438.86332813727387, 6.347867826169584, 622.2716073694597, 482.85190312426863, 33.054116754825195, 423.0686950629771, 235.77372890471145, 531.1121474174001, 242.10529232936605, 223.96373871144087, 463.20267935846425, 142.61029929244535, 384.29017722305224, 142.5129534826375, 464.1073347823986, 228.34438998468104, 266.95009053533823, 296.1912821695551, 290.6227536020701, 274.32371117088417, 234.06255399145755, 410.65348809752106, 413.55655807070514, 530.2148693150816, 488.7306375687872, 304.55495517559575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.603718519361284, "mean_inference_ms": 3.4277454503258324, "mean_action_processing_ms": 0.9494893943897448, "mean_env_wait_ms": 9.990925942967296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04279184341430664, "StateBufferConnector_ms": 0.0030472278594970703, "ViewRequirementAgentConnector_ms": 0.06765556335449219}, "num_episodes": 11, "episode_return_max": 398.1, "episode_return_min": 52.80000000000008, "episode_return_mean": 200.9809999999999, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.00884600906673, "num_env_steps_trained_throughput_per_sec": 160.00884600906673, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 24954.549, "restore_workers_time_ms": 0.022, "training_step_time_ms": 24954.208, "sample_time_ms": 1917.778, "learn_time_ms": 23010.027, "learn_throughput": 173.837, "synch_weights_time_ms": 23.569}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 60, "trial_id": "cbf82_00000", "date": "2024-08-21_13-33-08", "timestamp": 1724227388, "time_this_iter_s": 25.03758692741394, "time_total_s": 1562.353999376297, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x307570d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1562.353999376297, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 28.980555555555554, "ram_util_percent": 82.56388888888891}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.426341409981251, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.546906479199728, "policy_loss": -0.00824310413299827, "vf_loss": 5.553071675697963, "vf_explained_var": 0.17962126303464174, "kl": 0.010389513431922145, "entropy": 0.7531355510776242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.306914135192832, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.352402259409428, "policy_loss": -0.025194018816303773, "vf_loss": 6.374878141283989, "vf_explained_var": 0.27946063280105593, "kl": 0.01359063546891169, "entropy": 0.9333945404117306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "env_runners": {"episode_reward_max": 398.1, "episode_reward_min": 52.80000000000008, "episode_reward_mean": 201.32199999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 0.8145784106916721}, "policy_reward_max": {"prey_policy": 397.2854215893083, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -81.5550083113451, "predator_policy": 282.87700831134515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.79999999999917, 115.09999999999991, 154.39999999999992, 208.39999999999992, 132.19999999999968, 101.4999999999998, 166.00000000000003, 368.8, 103.40000000000006, 278.2, 199.89999999999998, 199.20000000000005, 319.1, 103.9, 178.29999999999998, 190.79999999999998, 302.0, 342.50000000000006, 339.7000000000001, 144.69999999999996, 165.4, 229.69999999999973, 280.69999999999993, 111.7999999999999, 232.3, 393.4, 328.39999999999986, 78.80000000000003, 398.1, 198.10000000000002, 255.29999999999998, 395.4, 130.79999999999927, 132.2, 388.8, 217.7, 222.19999999999982, 224.99999999999972, 239.6, 72.59999999999985, 132.09999999999997, 155.79999999999993, 259.09999999999997, 249.79999999999995, 341.3, 150.49999999999997, 358.3, 109.59999999999977, 69.60000000000016, 262.6999999999998, 71.70000000000005, 167.0, 254.49999999999983, 126.39999999999975, 315.6, 154.39999999999986, 256.19999999999993, 378.1, 144.29999999999998, 220.59999999999997, 305.3, 357.5, 165.8999999999998, 128.59999999999997, 64.10000000000007, 149.89999999999986, 158.89999999999992, 297.79999999999995, 69.19999999999997, 103.79999999999981, 347.3, 185.10000000000002, 168.6999999999999, 112.29999999999976, 160.19999999999942, 240.39999999999992, 110.09999999999977, 285.10000000000025, 80.59999999999951, 271.90000000000003, 137.99999999999994, 76.10000000000026, 159.60000000000008, 215.9, 196.39999999999995, 191.09999999999982, 185.30000000000013, 109.09999999999997, 136.99999999999983, 52.80000000000008, 106.99999999999997, 196.8, 108.19999999999987, 210.49999999999957, 240.3, 77.4999999999999, 240.40000000000003, 233.19999999999996, 389.0, 183.50000000000006], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-187.88883207283854, -328.2677584367122, -117.66559358101662, -63.40724458305927, -235.16949981478635, -378.835094027888, -286.672098853952, 328.90008296803416, -286.3528420655002, 119.22080703577191, -111.49690387266887, -5.355989473360751, 127.64267166874947, -430.3314347504574, -225.0082265281122, -116.73031773505446, 175.97113395670186, 255.13349397183237, 251.7729725025515, -292.68570939792437, -306.7923594638208, 91.67477240291984, 176.89701958627901, -243.0905444705682, -73.25323115398886, 389.50644837087765, 246.77752189735568, -528.0415039059238, 397.2854215893083, -176.24390779299227, 48.844684034201684, 394.5581167356045, -89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689, -32.654208079802444, -23.632189645687422, -38.18431931208067, -283.2284509841188, -343.64238716020475, -178.53441764974215, 254.2843822162861, 73.44032105806866, 289.24480461653974, -155.31278529190442, 336.99792607385007, -374.39551716265663, -250.75800712609606, 65.52116885224706, -542.2501938402174, -311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506, -228.36801504285137, 54.355337087577816, 375.13127377864805, -262.3470486507464, -120.47429414907927, 139.23946376900275, 292.50674879490776, -118.79174281264902, -274.0202663814661, -476.5910330279585, -345.6437408287901, -279.9633281372732, 291.4521321738304, -553.0716073694585, -379.05190312426805, 314.2458832451748, -237.96869506297702, -67.07372890471147, -418.8121474173992, -81.90529232936592, 16.43626128855909, -353.10267935846446, 142.48970070755476, -303.69017722305017, 129.38704651736234, -326.1073347823983, -152.24438998468227, -107.35009053533813, -80.29128216955493, -94.22275360207009, -83.2237111708841, -48.76255399145796, -301.5534880975212, -276.55655807070514, -477.4148693150802, -381.73063756878713, -107.75495517559557, -298.4275800775233, 17.62630231065772, 88.9061231668174, -385.44969970015165, 121.13922314438769, 4.957095159707221, 386.5012997725767, -56.80963895046159], "policy_predator_policy_reward": [287.6888320728377, 443.36775843671194, 272.06559358101595, 271.80724458305906, 367.36949981478625, 480.33509402788815, 452.6720988539521, 39.89991703196586, 389.75284206549986, 158.97919296422808, 311.39690387266893, 204.55598947336048, 191.4573283312506, 534.2314347504575, 403.3082265281121, 307.53031773505415, 126.02886604329811, 87.36650602816766, 87.92702749744859, 437.3857093979243, 472.1923594638207, 138.02522759707995, 103.80298041372087, 354.89054447056867, 305.553231153989, 3.893551629122335, 81.62247810264428, 606.841503905924, 0.8145784106916721, 374.34390779299235, 206.45531596579838, 0.8418832643955543, 219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677, 254.85420807980236, 248.63218964568713, 277.7843193120804, 355.8284509841185, 475.742387160205, 334.3344176497419, 4.815617783713885, 176.35967894193135, 52.0551953834604, 305.812785291904, 21.30207392614994, 483.9955171626561, 320.35800712609637, 197.1788311477529, 613.9501938402171, 478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333, 382.7680150428513, 201.84466291242205, 2.968726221351959, 406.6470486507466, 341.0742941490792, 166.06053623099712, 64.99325120509216, 284.69174281264867, 402.6202663814661, 540.6910330279585, 495.54374082879065, 438.86332813727387, 6.347867826169584, 622.2716073694597, 482.85190312426863, 33.054116754825195, 423.0686950629771, 235.77372890471145, 531.1121474174001, 242.10529232936605, 223.96373871144087, 463.20267935846425, 142.61029929244535, 384.29017722305224, 142.5129534826375, 464.1073347823986, 228.34438998468104, 266.95009053533823, 296.1912821695551, 290.6227536020701, 274.32371117088417, 234.06255399145755, 410.65348809752106, 413.55655807070514, 530.2148693150816, 488.7306375687872, 304.55495517559575, 406.6275800775236, 192.8736976893424, 151.39387683318228, 462.9496997001515, 119.26077685561243, 228.2429048402929, 2.4987002274232797, 240.3096389504613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.597515118191559, "mean_inference_ms": 3.426890744521649, "mean_action_processing_ms": 0.9425890360817811, "mean_env_wait_ms": 9.985962105240574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042736053466796875, "StateBufferConnector_ms": 0.0030355453491210938, "ViewRequirementAgentConnector_ms": 0.0671544075012207}, "num_episodes": 8, "episode_return_max": 398.1, "episode_return_min": 52.80000000000008, "episode_return_mean": 201.32199999999995, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.52708159475884, "num_env_steps_trained_throughput_per_sec": 160.52708159475884, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 24918.775, "restore_workers_time_ms": 0.022, "training_step_time_ms": 24918.43, "sample_time_ms": 1903.875, "learn_time_ms": 22988.35, "learn_throughput": 174.001, "synch_weights_time_ms": 23.332}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "training_iteration": 61, "trial_id": "cbf82_00000", "date": "2024-08-21_13-33-33", "timestamp": 1724227413, "time_this_iter_s": 24.962193727493286, "time_total_s": 1587.3161931037903, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e53af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1587.3161931037903, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 30.7, "ram_util_percent": 82.97428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.69104651560386, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.2960567320386565, "policy_loss": -0.01011154753214214, "vf_loss": 5.303991641849279, "vf_explained_var": 0.1866314794247349, "kl": 0.010883140069442259, "entropy": 0.8003100891287128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.884054961552222, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.074302133421103, "policy_loss": -0.01611529035459777, "vf_loss": 6.087482017775376, "vf_explained_var": 0.12223759436359008, "kl": 0.014677104149207783, "entropy": 0.9571673007061084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 398.1, "episode_reward_min": 52.80000000000008, "episode_reward_mean": 200.99799999999993, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 0.8145784106916721}, "policy_reward_max": {"prey_policy": 397.2854215893083, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -80.06974685159103, "predator_policy": 281.06774685159104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.29999999999998, 190.79999999999998, 302.0, 342.50000000000006, 339.7000000000001, 144.69999999999996, 165.4, 229.69999999999973, 280.69999999999993, 111.7999999999999, 232.3, 393.4, 328.39999999999986, 78.80000000000003, 398.1, 198.10000000000002, 255.29999999999998, 395.4, 130.79999999999927, 132.2, 388.8, 217.7, 222.19999999999982, 224.99999999999972, 239.6, 72.59999999999985, 132.09999999999997, 155.79999999999993, 259.09999999999997, 249.79999999999995, 341.3, 150.49999999999997, 358.3, 109.59999999999977, 69.60000000000016, 262.6999999999998, 71.70000000000005, 167.0, 254.49999999999983, 126.39999999999975, 315.6, 154.39999999999986, 256.19999999999993, 378.1, 144.29999999999998, 220.59999999999997, 305.3, 357.5, 165.8999999999998, 128.59999999999997, 64.10000000000007, 149.89999999999986, 158.89999999999992, 297.79999999999995, 69.19999999999997, 103.79999999999981, 347.3, 185.10000000000002, 168.6999999999999, 112.29999999999976, 160.19999999999942, 240.39999999999992, 110.09999999999977, 285.10000000000025, 80.59999999999951, 271.90000000000003, 137.99999999999994, 76.10000000000026, 159.60000000000008, 215.9, 196.39999999999995, 191.09999999999982, 185.30000000000013, 109.09999999999997, 136.99999999999983, 52.80000000000008, 106.99999999999997, 196.8, 108.19999999999987, 210.49999999999957, 240.3, 77.4999999999999, 240.40000000000003, 233.19999999999996, 389.0, 183.50000000000006, 96.9, 109.5, 93.7, 229.70000000000002, 134.29999999999998, 96.59999999999997, 228.70000000000005, 326.0, 89.80000000000001, 186.99999999999977, 324.5, 281.3999999999998, 169.59999999999957, 149.79999999999967], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-225.0082265281122, -116.73031773505446, 175.97113395670186, 255.13349397183237, 251.7729725025515, -292.68570939792437, -306.7923594638208, 91.67477240291984, 176.89701958627901, -243.0905444705682, -73.25323115398886, 389.50644837087765, 246.77752189735568, -528.0415039059238, 397.2854215893083, -176.24390779299227, 48.844684034201684, 394.5581167356045, -89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689, -32.654208079802444, -23.632189645687422, -38.18431931208067, -283.2284509841188, -343.64238716020475, -178.53441764974215, 254.2843822162861, 73.44032105806866, 289.24480461653974, -155.31278529190442, 336.99792607385007, -374.39551716265663, -250.75800712609606, 65.52116885224706, -542.2501938402174, -311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506, -228.36801504285137, 54.355337087577816, 375.13127377864805, -262.3470486507464, -120.47429414907927, 139.23946376900275, 292.50674879490776, -118.79174281264902, -274.0202663814661, -476.5910330279585, -345.6437408287901, -279.9633281372732, 291.4521321738304, -553.0716073694585, -379.05190312426805, 314.2458832451748, -237.96869506297702, -67.07372890471147, -418.8121474173992, -81.90529232936592, 16.43626128855909, -353.10267935846446, 142.48970070755476, -303.69017722305017, 129.38704651736234, -326.1073347823983, -152.24438998468227, -107.35009053533813, -80.29128216955493, -94.22275360207009, -83.2237111708841, -48.76255399145796, -301.5534880975212, -276.55655807070514, -477.4148693150802, -381.73063756878713, -107.75495517559557, -298.4275800775233, 17.62630231065772, 88.9061231668174, -385.44969970015165, 121.13922314438769, 4.957095159707221, 386.5012997725767, -56.80963895046159, -362.54978966178663, -226.6860046764894, -457.8086731337442, -16.75888056559407, -202.54735509742218, -429.9804239001044, 21.333224176862927, 202.5200985274773, -389.8650216035965, -117.56191377075152, 263.1996827012921, 158.4470800723294, -28.702089045467627, -120.19351790728243], "policy_predator_policy_reward": [403.3082265281121, 307.53031773505415, 126.02886604329811, 87.36650602816766, 87.92702749744859, 437.3857093979243, 472.1923594638207, 138.02522759707995, 103.80298041372087, 354.89054447056867, 305.553231153989, 3.893551629122335, 81.62247810264428, 606.841503905924, 0.8145784106916721, 374.34390779299235, 206.45531596579838, 0.8418832643955543, 219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677, 254.85420807980236, 248.63218964568713, 277.7843193120804, 355.8284509841185, 475.742387160205, 334.3344176497419, 4.815617783713885, 176.35967894193135, 52.0551953834604, 305.812785291904, 21.30207392614994, 483.9955171626561, 320.35800712609637, 197.1788311477529, 613.9501938402171, 478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333, 382.7680150428513, 201.84466291242205, 2.968726221351959, 406.6470486507466, 341.0742941490792, 166.06053623099712, 64.99325120509216, 284.69174281264867, 402.6202663814661, 540.6910330279585, 495.54374082879065, 438.86332813727387, 6.347867826169584, 622.2716073694597, 482.85190312426863, 33.054116754825195, 423.0686950629771, 235.77372890471145, 531.1121474174001, 242.10529232936605, 223.96373871144087, 463.20267935846425, 142.61029929244535, 384.29017722305224, 142.5129534826375, 464.1073347823986, 228.34438998468104, 266.95009053533823, 296.1912821695551, 290.6227536020701, 274.32371117088417, 234.06255399145755, 410.65348809752106, 413.55655807070514, 530.2148693150816, 488.7306375687872, 304.55495517559575, 406.6275800775236, 192.8736976893424, 151.39387683318228, 462.9496997001515, 119.26077685561243, 228.2429048402929, 2.4987002274232797, 240.3096389504613, 459.4497896617867, 336.18600467648923, 551.5086731337442, 246.458880565594, 336.84735509742234, 526.5804239001046, 207.3667758231369, 123.47990147252267, 479.6650216035963, 304.5619137707514, 61.300317298707895, 122.95291992767052, 198.3020890454673, 269.9935179072825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5941555609598197, "mean_inference_ms": 3.4019116438616264, "mean_action_processing_ms": 0.9450812417377686, "mean_env_wait_ms": 10.00324371969246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042780399322509766, "StateBufferConnector_ms": 0.0030710697174072266, "ViewRequirementAgentConnector_ms": 0.06665301322937012}, "num_episodes": 14, "episode_return_max": 398.1, "episode_return_min": 52.80000000000008, "episode_return_mean": 200.99799999999993, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.44739532370951, "num_env_steps_trained_throughput_per_sec": 161.44739532370951, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 24939.345, "restore_workers_time_ms": 0.022, "training_step_time_ms": 24938.984, "sample_time_ms": 1913.355, "learn_time_ms": 22998.693, "learn_throughput": 173.923, "synch_weights_time_ms": 23.959}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 62, "trial_id": "cbf82_00000", "date": "2024-08-21_13-33-57", "timestamp": 1724227437, "time_this_iter_s": 24.8198561668396, "time_total_s": 1612.1360492706299, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e651f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1612.1360492706299, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 28.29714285714286, "ram_util_percent": 83.15428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.034226759647329, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.461859591305256, "policy_loss": -0.0064190279765171, "vf_loss": 5.466694165269534, "vf_explained_var": 0.23214992632468542, "kl": 0.007922345192491775, "entropy": 0.7261352599908908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.926883256807923, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.108134460945924, "policy_loss": -0.018929352876148185, "vf_loss": 6.124372587601344, "vf_explained_var": 0.10554444584995508, "kl": 0.01345620782279487, "entropy": 0.9424035262937347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 398.1, "episode_reward_min": 52.80000000000008, "episode_reward_mean": 199.82699999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 0.8145784106916721}, "policy_reward_max": {"prey_policy": 397.2854215893083, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -81.55392904581161, "predator_policy": 281.3809290458116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [232.3, 393.4, 328.39999999999986, 78.80000000000003, 398.1, 198.10000000000002, 255.29999999999998, 395.4, 130.79999999999927, 132.2, 388.8, 217.7, 222.19999999999982, 224.99999999999972, 239.6, 72.59999999999985, 132.09999999999997, 155.79999999999993, 259.09999999999997, 249.79999999999995, 341.3, 150.49999999999997, 358.3, 109.59999999999977, 69.60000000000016, 262.6999999999998, 71.70000000000005, 167.0, 254.49999999999983, 126.39999999999975, 315.6, 154.39999999999986, 256.19999999999993, 378.1, 144.29999999999998, 220.59999999999997, 305.3, 357.5, 165.8999999999998, 128.59999999999997, 64.10000000000007, 149.89999999999986, 158.89999999999992, 297.79999999999995, 69.19999999999997, 103.79999999999981, 347.3, 185.10000000000002, 168.6999999999999, 112.29999999999976, 160.19999999999942, 240.39999999999992, 110.09999999999977, 285.10000000000025, 80.59999999999951, 271.90000000000003, 137.99999999999994, 76.10000000000026, 159.60000000000008, 215.9, 196.39999999999995, 191.09999999999982, 185.30000000000013, 109.09999999999997, 136.99999999999983, 52.80000000000008, 106.99999999999997, 196.8, 108.19999999999987, 210.49999999999957, 240.3, 77.4999999999999, 240.40000000000003, 233.19999999999996, 389.0, 183.50000000000006, 96.9, 109.5, 93.7, 229.70000000000002, 134.29999999999998, 96.59999999999997, 228.70000000000005, 326.0, 89.80000000000001, 186.99999999999977, 324.5, 281.3999999999998, 169.59999999999957, 149.79999999999967, 109.49999999999997, 116.1, 189.39999999999995, 319.5, 317.0, 137.59999999999997, 290.6, 131.09999999999985, 292.2, 265.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-73.25323115398886, 389.50644837087765, 246.77752189735568, -528.0415039059238, 397.2854215893083, -176.24390779299227, 48.844684034201684, 394.5581167356045, -89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689, -32.654208079802444, -23.632189645687422, -38.18431931208067, -283.2284509841188, -343.64238716020475, -178.53441764974215, 254.2843822162861, 73.44032105806866, 289.24480461653974, -155.31278529190442, 336.99792607385007, -374.39551716265663, -250.75800712609606, 65.52116885224706, -542.2501938402174, -311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506, -228.36801504285137, 54.355337087577816, 375.13127377864805, -262.3470486507464, -120.47429414907927, 139.23946376900275, 292.50674879490776, -118.79174281264902, -274.0202663814661, -476.5910330279585, -345.6437408287901, -279.9633281372732, 291.4521321738304, -553.0716073694585, -379.05190312426805, 314.2458832451748, -237.96869506297702, -67.07372890471147, -418.8121474173992, -81.90529232936592, 16.43626128855909, -353.10267935846446, 142.48970070755476, -303.69017722305017, 129.38704651736234, -326.1073347823983, -152.24438998468227, -107.35009053533813, -80.29128216955493, -94.22275360207009, -83.2237111708841, -48.76255399145796, -301.5534880975212, -276.55655807070514, -477.4148693150802, -381.73063756878713, -107.75495517559557, -298.4275800775233, 17.62630231065772, 88.9061231668174, -385.44969970015165, 121.13922314438769, 4.957095159707221, 386.5012997725767, -56.80963895046159, -362.54978966178663, -226.6860046764894, -457.8086731337442, -16.75888056559407, -202.54735509742218, -429.9804239001044, 21.333224176862927, 202.5200985274773, -389.8650216035965, -117.56191377075152, 263.1996827012921, 158.4470800723294, -28.702089045467627, -120.19351790728243, -351.7468128592037, -376.78711621499775, -173.75741721158496, 266.48801808831246, 162.35249130939408, -139.0388003661047, 191.20965339206882, -227.72641721389238, 148.0790904628101, 119.6513260159449], "policy_predator_policy_reward": [305.553231153989, 3.893551629122335, 81.62247810264428, 606.841503905924, 0.8145784106916721, 374.34390779299235, 206.45531596579838, 0.8418832643955543, 219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677, 254.85420807980236, 248.63218964568713, 277.7843193120804, 355.8284509841185, 475.742387160205, 334.3344176497419, 4.815617783713885, 176.35967894193135, 52.0551953834604, 305.812785291904, 21.30207392614994, 483.9955171626561, 320.35800712609637, 197.1788311477529, 613.9501938402171, 478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333, 382.7680150428513, 201.84466291242205, 2.968726221351959, 406.6470486507466, 341.0742941490792, 166.06053623099712, 64.99325120509216, 284.69174281264867, 402.6202663814661, 540.6910330279585, 495.54374082879065, 438.86332813727387, 6.347867826169584, 622.2716073694597, 482.85190312426863, 33.054116754825195, 423.0686950629771, 235.77372890471145, 531.1121474174001, 242.10529232936605, 223.96373871144087, 463.20267935846425, 142.61029929244535, 384.29017722305224, 142.5129534826375, 464.1073347823986, 228.34438998468104, 266.95009053533823, 296.1912821695551, 290.6227536020701, 274.32371117088417, 234.06255399145755, 410.65348809752106, 413.55655807070514, 530.2148693150816, 488.7306375687872, 304.55495517559575, 406.6275800775236, 192.8736976893424, 151.39387683318228, 462.9496997001515, 119.26077685561243, 228.2429048402929, 2.4987002274232797, 240.3096389504613, 459.4497896617867, 336.18600467648923, 551.5086731337442, 246.458880565594, 336.84735509742234, 526.5804239001046, 207.3667758231369, 123.47990147252267, 479.6650216035963, 304.5619137707514, 61.300317298707895, 122.95291992767052, 198.3020890454673, 269.9935179072825, 461.2468128592036, 492.88711621499755, 363.15741721158486, 53.01198191168758, 154.64750869060603, 276.6388003661046, 99.39034660793126, 358.8264172138922, 144.12090953718993, 145.8486739840551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5889454963658873, "mean_inference_ms": 3.4043417610416653, "mean_action_processing_ms": 0.9338553646075163, "mean_env_wait_ms": 9.995941797180448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04273045063018799, "StateBufferConnector_ms": 0.002821207046508789, "ViewRequirementAgentConnector_ms": 0.06645381450653076}, "num_episodes": 10, "episode_return_max": 398.1, "episode_return_min": 52.80000000000008, "episode_return_mean": 199.82699999999994, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.13572599899706, "num_env_steps_trained_throughput_per_sec": 160.13572599899706, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 24955.224, "restore_workers_time_ms": 0.021, "training_step_time_ms": 24954.864, "sample_time_ms": 1926.383, "learn_time_ms": 23001.419, "learn_throughput": 173.902, "synch_weights_time_ms": 24.139}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 63, "trial_id": "cbf82_00000", "date": "2024-08-21_13-34-23", "timestamp": 1724227463, "time_this_iter_s": 25.024978160858154, "time_total_s": 1637.161027431488, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075bd4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1637.161027431488, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 29.685714285714287, "ram_util_percent": 83.04857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.131831032037735, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.510843826830387, "policy_loss": -0.00771875672362512, "vf_loss": 4.516765561699867, "vf_explained_var": 0.22817969284951686, "kl": 0.008985155050565179, "entropy": 0.8616582072650393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.044588635365168, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.250703129917383, "policy_loss": -0.02573496269348349, "vf_loss": 5.273862184087435, "vf_explained_var": 0.28478332217782737, "kl": 0.012879586340811025, "entropy": 0.9462051675344507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": 52.80000000000008, "episode_reward_mean": 194.13099999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 2.4987002274232797}, "policy_reward_max": {"prey_policy": 386.5012997725767, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -92.93211780967508, "predator_policy": 287.0631178096751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.79999999999927, 132.2, 388.8, 217.7, 222.19999999999982, 224.99999999999972, 239.6, 72.59999999999985, 132.09999999999997, 155.79999999999993, 259.09999999999997, 249.79999999999995, 341.3, 150.49999999999997, 358.3, 109.59999999999977, 69.60000000000016, 262.6999999999998, 71.70000000000005, 167.0, 254.49999999999983, 126.39999999999975, 315.6, 154.39999999999986, 256.19999999999993, 378.1, 144.29999999999998, 220.59999999999997, 305.3, 357.5, 165.8999999999998, 128.59999999999997, 64.10000000000007, 149.89999999999986, 158.89999999999992, 297.79999999999995, 69.19999999999997, 103.79999999999981, 347.3, 185.10000000000002, 168.6999999999999, 112.29999999999976, 160.19999999999942, 240.39999999999992, 110.09999999999977, 285.10000000000025, 80.59999999999951, 271.90000000000003, 137.99999999999994, 76.10000000000026, 159.60000000000008, 215.9, 196.39999999999995, 191.09999999999982, 185.30000000000013, 109.09999999999997, 136.99999999999983, 52.80000000000008, 106.99999999999997, 196.8, 108.19999999999987, 210.49999999999957, 240.3, 77.4999999999999, 240.40000000000003, 233.19999999999996, 389.0, 183.50000000000006, 96.9, 109.5, 93.7, 229.70000000000002, 134.29999999999998, 96.59999999999997, 228.70000000000005, 326.0, 89.80000000000001, 186.99999999999977, 324.5, 281.3999999999998, 169.59999999999957, 149.79999999999967, 109.49999999999997, 116.1, 189.39999999999995, 319.5, 317.0, 137.59999999999997, 290.6, 131.09999999999985, 292.2, 265.5, 251.09999999999943, 215.49999999999991, 197.9999999999999, 367.0, 195.2, 134.20000000000002, 210.39999999999986, 138.7999999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-89.03599371473004, -281.72986100967864, 384.6668189913302, -84.49320973018689, -32.654208079802444, -23.632189645687422, -38.18431931208067, -283.2284509841188, -343.64238716020475, -178.53441764974215, 254.2843822162861, 73.44032105806866, 289.24480461653974, -155.31278529190442, 336.99792607385007, -374.39551716265663, -250.75800712609606, 65.52116885224706, -542.2501938402174, -311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506, -228.36801504285137, 54.355337087577816, 375.13127377864805, -262.3470486507464, -120.47429414907927, 139.23946376900275, 292.50674879490776, -118.79174281264902, -274.0202663814661, -476.5910330279585, -345.6437408287901, -279.9633281372732, 291.4521321738304, -553.0716073694585, -379.05190312426805, 314.2458832451748, -237.96869506297702, -67.07372890471147, -418.8121474173992, -81.90529232936592, 16.43626128855909, -353.10267935846446, 142.48970070755476, -303.69017722305017, 129.38704651736234, -326.1073347823983, -152.24438998468227, -107.35009053533813, -80.29128216955493, -94.22275360207009, -83.2237111708841, -48.76255399145796, -301.5534880975212, -276.55655807070514, -477.4148693150802, -381.73063756878713, -107.75495517559557, -298.4275800775233, 17.62630231065772, 88.9061231668174, -385.44969970015165, 121.13922314438769, 4.957095159707221, 386.5012997725767, -56.80963895046159, -362.54978966178663, -226.6860046764894, -457.8086731337442, -16.75888056559407, -202.54735509742218, -429.9804239001044, 21.333224176862927, 202.5200985274773, -389.8650216035965, -117.56191377075152, 263.1996827012921, 158.4470800723294, -28.702089045467627, -120.19351790728243, -351.7468128592037, -376.78711621499775, -173.75741721158496, 266.48801808831246, 162.35249130939408, -139.0388003661047, 191.20965339206882, -227.72641721389238, 148.0790904628101, 119.6513260159449, 179.1356127847685, -96.98983910916093, -90.94972532719781, 320.9604594868953, -151.34546625167934, -268.7165122471617, -21.467826355047137, -309.0120295933212], "policy_predator_policy_reward": [219.8359937147293, 413.92986100967846, 4.13318100866978, 302.19320973018677, 254.85420807980236, 248.63218964568713, 277.7843193120804, 355.8284509841185, 475.742387160205, 334.3344176497419, 4.815617783713885, 176.35967894193135, 52.0551953834604, 305.812785291904, 21.30207392614994, 483.9955171626561, 320.35800712609637, 197.1788311477529, 613.9501938402171, 478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333, 382.7680150428513, 201.84466291242205, 2.968726221351959, 406.6470486507466, 341.0742941490792, 166.06053623099712, 64.99325120509216, 284.69174281264867, 402.6202663814661, 540.6910330279585, 495.54374082879065, 438.86332813727387, 6.347867826169584, 622.2716073694597, 482.85190312426863, 33.054116754825195, 423.0686950629771, 235.77372890471145, 531.1121474174001, 242.10529232936605, 223.96373871144087, 463.20267935846425, 142.61029929244535, 384.29017722305224, 142.5129534826375, 464.1073347823986, 228.34438998468104, 266.95009053533823, 296.1912821695551, 290.6227536020701, 274.32371117088417, 234.06255399145755, 410.65348809752106, 413.55655807070514, 530.2148693150816, 488.7306375687872, 304.55495517559575, 406.6275800775236, 192.8736976893424, 151.39387683318228, 462.9496997001515, 119.26077685561243, 228.2429048402929, 2.4987002274232797, 240.3096389504613, 459.4497896617867, 336.18600467648923, 551.5086731337442, 246.458880565594, 336.84735509742234, 526.5804239001046, 207.3667758231369, 123.47990147252267, 479.6650216035963, 304.5619137707514, 61.300317298707895, 122.95291992767052, 198.3020890454673, 269.9935179072825, 461.2468128592036, 492.88711621499755, 363.15741721158486, 53.01198191168758, 154.64750869060603, 276.6388003661046, 99.39034660793126, 358.8264172138922, 144.12090953718993, 145.8486739840551, 71.96438721523089, 312.489839109161, 288.94972532719794, 46.039540513104754, 346.54546625167933, 402.91651224716196, 231.86782635504693, 447.8120295933212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.584347441138159, "mean_inference_ms": 3.3967221940205046, "mean_action_processing_ms": 0.9390032008889649, "mean_env_wait_ms": 10.00159588043417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042769789695739746, "StateBufferConnector_ms": 0.0027654170989990234, "ViewRequirementAgentConnector_ms": 0.06664502620697021}, "num_episodes": 8, "episode_return_max": 389.0, "episode_return_min": 52.80000000000008, "episode_return_mean": 194.13099999999994, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.30768205325873, "num_env_steps_trained_throughput_per_sec": 161.30768205325873, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 24942.253, "restore_workers_time_ms": 0.021, "training_step_time_ms": 24941.903, "sample_time_ms": 1948.935, "learn_time_ms": 22967.818, "learn_throughput": 174.157, "synch_weights_time_ms": 22.431}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 64, "trial_id": "cbf82_00000", "date": "2024-08-21_13-34-47", "timestamp": 1724227487, "time_this_iter_s": 24.806411743164062, "time_total_s": 1661.967439174652, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x307376040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1661.967439174652, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 28.408571428571427, "ram_util_percent": 82.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.895326783756415, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.817809642354647, "policy_loss": -0.007148240127329094, "vf_loss": 4.823253978292147, "vf_explained_var": 0.17570848409086465, "kl": 0.008519538788823411, "entropy": 0.872719612903893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.344908323759833, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.962130100031694, "policy_loss": -0.021619845339834378, "vf_loss": 5.981506391863028, "vf_explained_var": 0.07804670793314775, "kl": 0.011217756994543986, "entropy": 1.027374705299735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": 52.80000000000008, "episode_reward_mean": 198.62099999999992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 2.4987002274232797}, "policy_reward_max": {"prey_policy": 386.5012997725767, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -82.787171847841, "predator_policy": 281.40817184784106}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.3, 150.49999999999997, 358.3, 109.59999999999977, 69.60000000000016, 262.6999999999998, 71.70000000000005, 167.0, 254.49999999999983, 126.39999999999975, 315.6, 154.39999999999986, 256.19999999999993, 378.1, 144.29999999999998, 220.59999999999997, 305.3, 357.5, 165.8999999999998, 128.59999999999997, 64.10000000000007, 149.89999999999986, 158.89999999999992, 297.79999999999995, 69.19999999999997, 103.79999999999981, 347.3, 185.10000000000002, 168.6999999999999, 112.29999999999976, 160.19999999999942, 240.39999999999992, 110.09999999999977, 285.10000000000025, 80.59999999999951, 271.90000000000003, 137.99999999999994, 76.10000000000026, 159.60000000000008, 215.9, 196.39999999999995, 191.09999999999982, 185.30000000000013, 109.09999999999997, 136.99999999999983, 52.80000000000008, 106.99999999999997, 196.8, 108.19999999999987, 210.49999999999957, 240.3, 77.4999999999999, 240.40000000000003, 233.19999999999996, 389.0, 183.50000000000006, 96.9, 109.5, 93.7, 229.70000000000002, 134.29999999999998, 96.59999999999997, 228.70000000000005, 326.0, 89.80000000000001, 186.99999999999977, 324.5, 281.3999999999998, 169.59999999999957, 149.79999999999967, 109.49999999999997, 116.1, 189.39999999999995, 319.5, 317.0, 137.59999999999997, 290.6, 131.09999999999985, 292.2, 265.5, 251.09999999999943, 215.49999999999991, 197.9999999999999, 367.0, 195.2, 134.20000000000002, 210.39999999999986, 138.7999999999999, 300.1, 367.9, 292.29999999999995, 101.89999999999989, 318.1, 352.4, 163.7, 110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [289.24480461653974, -155.31278529190442, 336.99792607385007, -374.39551716265663, -250.75800712609606, 65.52116885224706, -542.2501938402174, -311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506, -228.36801504285137, 54.355337087577816, 375.13127377864805, -262.3470486507464, -120.47429414907927, 139.23946376900275, 292.50674879490776, -118.79174281264902, -274.0202663814661, -476.5910330279585, -345.6437408287901, -279.9633281372732, 291.4521321738304, -553.0716073694585, -379.05190312426805, 314.2458832451748, -237.96869506297702, -67.07372890471147, -418.8121474173992, -81.90529232936592, 16.43626128855909, -353.10267935846446, 142.48970070755476, -303.69017722305017, 129.38704651736234, -326.1073347823983, -152.24438998468227, -107.35009053533813, -80.29128216955493, -94.22275360207009, -83.2237111708841, -48.76255399145796, -301.5534880975212, -276.55655807070514, -477.4148693150802, -381.73063756878713, -107.75495517559557, -298.4275800775233, 17.62630231065772, 88.9061231668174, -385.44969970015165, 121.13922314438769, 4.957095159707221, 386.5012997725767, -56.80963895046159, -362.54978966178663, -226.6860046764894, -457.8086731337442, -16.75888056559407, -202.54735509742218, -429.9804239001044, 21.333224176862927, 202.5200985274773, -389.8650216035965, -117.56191377075152, 263.1996827012921, 158.4470800723294, -28.702089045467627, -120.19351790728243, -351.7468128592037, -376.78711621499775, -173.75741721158496, 266.48801808831246, 162.35249130939408, -139.0388003661047, 191.20965339206882, -227.72641721389238, 148.0790904628101, 119.6513260159449, 179.1356127847685, -96.98983910916093, -90.94972532719781, 320.9604594868953, -151.34546625167934, -268.7165122471617, -21.467826355047137, -309.0120295933212, 202.32449586990361, 341.80642312763126, 152.9619883316687, -288.6625616340598, 208.52106303849263, 307.31432730375525, -164.52927052641326, -265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732], "policy_predator_policy_reward": [52.0551953834604, 305.812785291904, 21.30207392614994, 483.9955171626561, 320.35800712609637, 197.1788311477529, 613.9501938402171, 478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333, 382.7680150428513, 201.84466291242205, 2.968726221351959, 406.6470486507466, 341.0742941490792, 166.06053623099712, 64.99325120509216, 284.69174281264867, 402.6202663814661, 540.6910330279585, 495.54374082879065, 438.86332813727387, 6.347867826169584, 622.2716073694597, 482.85190312426863, 33.054116754825195, 423.0686950629771, 235.77372890471145, 531.1121474174001, 242.10529232936605, 223.96373871144087, 463.20267935846425, 142.61029929244535, 384.29017722305224, 142.5129534826375, 464.1073347823986, 228.34438998468104, 266.95009053533823, 296.1912821695551, 290.6227536020701, 274.32371117088417, 234.06255399145755, 410.65348809752106, 413.55655807070514, 530.2148693150816, 488.7306375687872, 304.55495517559575, 406.6275800775236, 192.8736976893424, 151.39387683318228, 462.9496997001515, 119.26077685561243, 228.2429048402929, 2.4987002274232797, 240.3096389504613, 459.4497896617867, 336.18600467648923, 551.5086731337442, 246.458880565594, 336.84735509742234, 526.5804239001046, 207.3667758231369, 123.47990147252267, 479.6650216035963, 304.5619137707514, 61.300317298707895, 122.95291992767052, 198.3020890454673, 269.9935179072825, 461.2468128592036, 492.88711621499755, 363.15741721158486, 53.01198191168758, 154.64750869060603, 276.6388003661046, 99.39034660793126, 358.8264172138922, 144.12090953718993, 145.8486739840551, 71.96438721523089, 312.489839109161, 288.94972532719794, 46.039540513104754, 346.54546625167933, 402.91651224716196, 231.86782635504693, 447.8120295933212, 97.77550413009645, 26.093576872368757, 139.33801166833132, 390.5625616340598, 109.5789369615073, 45.08567269624464, 328.2292705264132, 376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5739160200921685, "mean_inference_ms": 3.3925357474139175, "mean_action_processing_ms": 0.9270157047640832, "mean_env_wait_ms": 10.006766606070046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027344226837158203, "StateBufferConnector_ms": 0.0026625394821166992, "ViewRequirementAgentConnector_ms": 0.0574263334274292}, "num_episodes": 12, "episode_return_max": 389.0, "episode_return_min": 52.80000000000008, "episode_return_mean": 198.62099999999992, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.48555635836885, "num_env_steps_trained_throughput_per_sec": 161.48555635836885, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 24855.491, "restore_workers_time_ms": 0.025, "training_step_time_ms": 24855.189, "sample_time_ms": 1896.048, "learn_time_ms": 22933.582, "learn_throughput": 174.417, "synch_weights_time_ms": 22.886}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 65, "trial_id": "cbf82_00000", "date": "2024-08-21_13-35-12", "timestamp": 1724227512, "time_this_iter_s": 24.816149950027466, "time_total_s": 1686.7835891246796, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e39820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1686.7835891246796, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 28.602777777777778, "ram_util_percent": 82.73333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.725872849114239, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.957725728551547, "policy_loss": -0.008005536038641974, "vf_loss": 4.963557185480992, "vf_explained_var": 0.23023332400868338, "kl": 0.010870391565064589, "entropy": 0.8229959001764655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.08088173593084, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.096185764670372, "policy_loss": -0.02136373849158796, "vf_loss": 6.115294750034809, "vf_explained_var": 0.2650335003932317, "kl": 0.01127373787482308, "entropy": 0.9893394475181897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": 52.80000000000008, "episode_reward_mean": 200.91799999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 2.4987002274232797}, "policy_reward_max": {"prey_policy": 386.5012997725767, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -77.15590209059927, "predator_policy": 278.0739020905993}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.0, 254.49999999999983, 126.39999999999975, 315.6, 154.39999999999986, 256.19999999999993, 378.1, 144.29999999999998, 220.59999999999997, 305.3, 357.5, 165.8999999999998, 128.59999999999997, 64.10000000000007, 149.89999999999986, 158.89999999999992, 297.79999999999995, 69.19999999999997, 103.79999999999981, 347.3, 185.10000000000002, 168.6999999999999, 112.29999999999976, 160.19999999999942, 240.39999999999992, 110.09999999999977, 285.10000000000025, 80.59999999999951, 271.90000000000003, 137.99999999999994, 76.10000000000026, 159.60000000000008, 215.9, 196.39999999999995, 191.09999999999982, 185.30000000000013, 109.09999999999997, 136.99999999999983, 52.80000000000008, 106.99999999999997, 196.8, 108.19999999999987, 210.49999999999957, 240.3, 77.4999999999999, 240.40000000000003, 233.19999999999996, 389.0, 183.50000000000006, 96.9, 109.5, 93.7, 229.70000000000002, 134.29999999999998, 96.59999999999997, 228.70000000000005, 326.0, 89.80000000000001, 186.99999999999977, 324.5, 281.3999999999998, 169.59999999999957, 149.79999999999967, 109.49999999999997, 116.1, 189.39999999999995, 319.5, 317.0, 137.59999999999997, 290.6, 131.09999999999985, 292.2, 265.5, 251.09999999999943, 215.49999999999991, 197.9999999999999, 367.0, 195.2, 134.20000000000002, 210.39999999999986, 138.7999999999999, 300.1, 367.9, 292.29999999999995, 101.89999999999989, 318.1, 352.4, 163.7, 110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6, 386.3, 136.29999999999995, 82.0000000000001, 131.0, 345.0, 207.19999999999993, 305.59999999999974], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-311.4469311979356, 77.94970282615446, -255.25583475170222, 300.4536482441506, -228.36801504285137, 54.355337087577816, 375.13127377864805, -262.3470486507464, -120.47429414907927, 139.23946376900275, 292.50674879490776, -118.79174281264902, -274.0202663814661, -476.5910330279585, -345.6437408287901, -279.9633281372732, 291.4521321738304, -553.0716073694585, -379.05190312426805, 314.2458832451748, -237.96869506297702, -67.07372890471147, -418.8121474173992, -81.90529232936592, 16.43626128855909, -353.10267935846446, 142.48970070755476, -303.69017722305017, 129.38704651736234, -326.1073347823983, -152.24438998468227, -107.35009053533813, -80.29128216955493, -94.22275360207009, -83.2237111708841, -48.76255399145796, -301.5534880975212, -276.55655807070514, -477.4148693150802, -381.73063756878713, -107.75495517559557, -298.4275800775233, 17.62630231065772, 88.9061231668174, -385.44969970015165, 121.13922314438769, 4.957095159707221, 386.5012997725767, -56.80963895046159, -362.54978966178663, -226.6860046764894, -457.8086731337442, -16.75888056559407, -202.54735509742218, -429.9804239001044, 21.333224176862927, 202.5200985274773, -389.8650216035965, -117.56191377075152, 263.1996827012921, 158.4470800723294, -28.702089045467627, -120.19351790728243, -351.7468128592037, -376.78711621499775, -173.75741721158496, 266.48801808831246, 162.35249130939408, -139.0388003661047, 191.20965339206882, -227.72641721389238, 148.0790904628101, 119.6513260159449, 179.1356127847685, -96.98983910916093, -90.94972532719781, 320.9604594868953, -151.34546625167934, -268.7165122471617, -21.467826355047137, -309.0120295933212, 202.32449586990361, 341.80642312763126, 152.9619883316687, -288.6625616340598, 208.52106303849263, 307.31432730375525, -164.52927052641326, -265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732, 376.6179976676897, -302.73571044651356, -335.2491863148508, -245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683], "policy_predator_policy_reward": [478.4469311979356, 176.55029717384542, 381.65583475170297, 15.146351755849333, 382.7680150428513, 201.84466291242205, 2.968726221351959, 406.6470486507466, 341.0742941490792, 166.06053623099712, 64.99325120509216, 284.69174281264867, 402.6202663814661, 540.6910330279585, 495.54374082879065, 438.86332813727387, 6.347867826169584, 622.2716073694597, 482.85190312426863, 33.054116754825195, 423.0686950629771, 235.77372890471145, 531.1121474174001, 242.10529232936605, 223.96373871144087, 463.20267935846425, 142.61029929244535, 384.29017722305224, 142.5129534826375, 464.1073347823986, 228.34438998468104, 266.95009053533823, 296.1912821695551, 290.6227536020701, 274.32371117088417, 234.06255399145755, 410.65348809752106, 413.55655807070514, 530.2148693150816, 488.7306375687872, 304.55495517559575, 406.6275800775236, 192.8736976893424, 151.39387683318228, 462.9496997001515, 119.26077685561243, 228.2429048402929, 2.4987002274232797, 240.3096389504613, 459.4497896617867, 336.18600467648923, 551.5086731337442, 246.458880565594, 336.84735509742234, 526.5804239001046, 207.3667758231369, 123.47990147252267, 479.6650216035963, 304.5619137707514, 61.300317298707895, 122.95291992767052, 198.3020890454673, 269.9935179072825, 461.2468128592036, 492.88711621499755, 363.15741721158486, 53.01198191168758, 154.64750869060603, 276.6388003661046, 99.39034660793126, 358.8264172138922, 144.12090953718993, 145.8486739840551, 71.96438721523089, 312.489839109161, 288.94972532719794, 46.039540513104754, 346.54546625167933, 402.91651224716196, 231.86782635504693, 447.8120295933212, 97.77550413009645, 26.093576872368757, 139.33801166833132, 390.5625616340598, 109.5789369615073, 45.08567269624464, 328.2292705264132, 376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678, 9.682002332310278, 439.03571044651386, 417.2491863148506, 376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.568790157495893, "mean_inference_ms": 3.3907175304196038, "mean_action_processing_ms": 0.9179175051078957, "mean_env_wait_ms": 9.998375711545163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012615680694580078, "StateBufferConnector_ms": 0.002650618553161621, "ViewRequirementAgentConnector_ms": 0.057387590408325195}, "num_episodes": 7, "episode_return_max": 389.0, "episode_return_min": 52.80000000000008, "episode_return_mean": 200.91799999999995, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.52065799224195, "num_env_steps_trained_throughput_per_sec": 161.52065799224195, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 24813.878, "restore_workers_time_ms": 0.025, "training_step_time_ms": 24813.577, "sample_time_ms": 1888.586, "learn_time_ms": 22899.849, "learn_throughput": 174.674, "synch_weights_time_ms": 22.531}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 66, "trial_id": "cbf82_00000", "date": "2024-08-21_13-35-37", "timestamp": 1724227537, "time_this_iter_s": 24.78934383392334, "time_total_s": 1711.572932958603, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e7e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1711.572932958603, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 28.757142857142853, "ram_util_percent": 83.10857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.794285019611319, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.909529640525579, "policy_loss": -0.005671573348809034, "vf_loss": 4.913657784461975, "vf_explained_var": 0.2381046421205004, "kl": 0.00771718902081678, "entropy": 0.7719846168532968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.234075044343868, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.888293567299843, "policy_loss": -0.026814880061040942, "vf_loss": 5.911947980026404, "vf_explained_var": 0.20968154352158308, "kl": 0.015802349984975688, "entropy": 1.000955798663199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": 52.80000000000008, "episode_reward_mean": 207.34199999999993, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 2.4987002274232797}, "policy_reward_max": {"prey_policy": 386.5012997725767, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -59.19706581126753, "predator_policy": 266.53906581126756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.10000000000007, 149.89999999999986, 158.89999999999992, 297.79999999999995, 69.19999999999997, 103.79999999999981, 347.3, 185.10000000000002, 168.6999999999999, 112.29999999999976, 160.19999999999942, 240.39999999999992, 110.09999999999977, 285.10000000000025, 80.59999999999951, 271.90000000000003, 137.99999999999994, 76.10000000000026, 159.60000000000008, 215.9, 196.39999999999995, 191.09999999999982, 185.30000000000013, 109.09999999999997, 136.99999999999983, 52.80000000000008, 106.99999999999997, 196.8, 108.19999999999987, 210.49999999999957, 240.3, 77.4999999999999, 240.40000000000003, 233.19999999999996, 389.0, 183.50000000000006, 96.9, 109.5, 93.7, 229.70000000000002, 134.29999999999998, 96.59999999999997, 228.70000000000005, 326.0, 89.80000000000001, 186.99999999999977, 324.5, 281.3999999999998, 169.59999999999957, 149.79999999999967, 109.49999999999997, 116.1, 189.39999999999995, 319.5, 317.0, 137.59999999999997, 290.6, 131.09999999999985, 292.2, 265.5, 251.09999999999943, 215.49999999999991, 197.9999999999999, 367.0, 195.2, 134.20000000000002, 210.39999999999986, 138.7999999999999, 300.1, 367.9, 292.29999999999995, 101.89999999999989, 318.1, 352.4, 163.7, 110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6, 386.3, 136.29999999999995, 82.0000000000001, 131.0, 345.0, 207.19999999999993, 305.59999999999974, 330.8, 251.0, 230.0, 197.7, 216.60000000000002, 213.2, 174.39999999999992, 333.40000000000003, 351.1, 316.6000000000001, 358.0, 370.8, 273.2], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-476.5910330279585, -345.6437408287901, -279.9633281372732, 291.4521321738304, -553.0716073694585, -379.05190312426805, 314.2458832451748, -237.96869506297702, -67.07372890471147, -418.8121474173992, -81.90529232936592, 16.43626128855909, -353.10267935846446, 142.48970070755476, -303.69017722305017, 129.38704651736234, -326.1073347823983, -152.24438998468227, -107.35009053533813, -80.29128216955493, -94.22275360207009, -83.2237111708841, -48.76255399145796, -301.5534880975212, -276.55655807070514, -477.4148693150802, -381.73063756878713, -107.75495517559557, -298.4275800775233, 17.62630231065772, 88.9061231668174, -385.44969970015165, 121.13922314438769, 4.957095159707221, 386.5012997725767, -56.80963895046159, -362.54978966178663, -226.6860046764894, -457.8086731337442, -16.75888056559407, -202.54735509742218, -429.9804239001044, 21.333224176862927, 202.5200985274773, -389.8650216035965, -117.56191377075152, 263.1996827012921, 158.4470800723294, -28.702089045467627, -120.19351790728243, -351.7468128592037, -376.78711621499775, -173.75741721158496, 266.48801808831246, 162.35249130939408, -139.0388003661047, 191.20965339206882, -227.72641721389238, 148.0790904628101, 119.6513260159449, 179.1356127847685, -96.98983910916093, -90.94972532719781, 320.9604594868953, -151.34546625167934, -268.7165122471617, -21.467826355047137, -309.0120295933212, 202.32449586990361, 341.80642312763126, 152.9619883316687, -288.6625616340598, 208.52106303849263, 307.31432730375525, -164.52927052641326, -265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732, 376.6179976676897, -302.73571044651356, -335.2491863148508, -245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683, 221.1661792855318, 75.71907473357768, -3.740898262383835, -135.69540010494825, -25.279464680431335, -97.72830847183643, -168.83453459487913, 298.9941438427073, 347.40071407413706, 207.23628697389117, 322.0200298309355, 326.03165264481765, 97.52619417606545], "policy_predator_policy_reward": [540.6910330279585, 495.54374082879065, 438.86332813727387, 6.347867826169584, 622.2716073694597, 482.85190312426863, 33.054116754825195, 423.0686950629771, 235.77372890471145, 531.1121474174001, 242.10529232936605, 223.96373871144087, 463.20267935846425, 142.61029929244535, 384.29017722305224, 142.5129534826375, 464.1073347823986, 228.34438998468104, 266.95009053533823, 296.1912821695551, 290.6227536020701, 274.32371117088417, 234.06255399145755, 410.65348809752106, 413.55655807070514, 530.2148693150816, 488.7306375687872, 304.55495517559575, 406.6275800775236, 192.8736976893424, 151.39387683318228, 462.9496997001515, 119.26077685561243, 228.2429048402929, 2.4987002274232797, 240.3096389504613, 459.4497896617867, 336.18600467648923, 551.5086731337442, 246.458880565594, 336.84735509742234, 526.5804239001046, 207.3667758231369, 123.47990147252267, 479.6650216035963, 304.5619137707514, 61.300317298707895, 122.95291992767052, 198.3020890454673, 269.9935179072825, 461.2468128592036, 492.88711621499755, 363.15741721158486, 53.01198191168758, 154.64750869060603, 276.6388003661046, 99.39034660793126, 358.8264172138922, 144.12090953718993, 145.8486739840551, 71.96438721523089, 312.489839109161, 288.94972532719794, 46.039540513104754, 346.54546625167933, 402.91651224716196, 231.86782635504693, 447.8120295933212, 97.77550413009645, 26.093576872368757, 139.33801166833132, 390.5625616340598, 109.5789369615073, 45.08567269624464, 328.2292705264132, 376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678, 9.682002332310278, 439.03571044651386, 417.2491863148506, 376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295, 109.63382071446819, 175.28092526642203, 233.74089826238406, 333.39540010494807, 241.87946468043143, 310.92830847183654, 343.23453459487916, 34.4058561572927, 3.6992859258629585, 109.36371302610893, 35.97997016906447, 44.768347355182335, 175.67380582393457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.558904444032831, "mean_inference_ms": 3.383900942057144, "mean_action_processing_ms": 0.9055590120123871, "mean_env_wait_ms": 10.003344458928389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012714028358459473, "StateBufferConnector_ms": 0.003911495208740234, "ViewRequirementAgentConnector_ms": 0.05885648727416992}, "num_episodes": 13, "episode_return_max": 389.0, "episode_return_min": 52.80000000000008, "episode_return_mean": 207.34199999999993, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.94371409763056, "num_env_steps_trained_throughput_per_sec": 162.94371409763056, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 24844.032, "restore_workers_time_ms": 0.025, "training_step_time_ms": 24843.746, "sample_time_ms": 1898.055, "learn_time_ms": 22919.748, "learn_throughput": 174.522, "synch_weights_time_ms": 23.651}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "training_iteration": 67, "trial_id": "cbf82_00000", "date": "2024-08-21_13-36-02", "timestamp": 1724227562, "time_this_iter_s": 24.597844123840332, "time_total_s": 1736.1707770824432, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075b8790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1736.1707770824432, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.89411764705882, "ram_util_percent": 82.81470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.183028070876996, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.469943956037363, "policy_loss": -0.004647846878894294, "vf_loss": 5.473012179136276, "vf_explained_var": 0.18126767581949632, "kl": 0.007897969421416443, "entropy": 0.7866882493719458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.822375235582392, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.33050437271595, "policy_loss": -0.019645015361796445, "vf_loss": 6.347105544308821, "vf_explained_var": 0.20638995263725518, "kl": 0.015219124729628674, "entropy": 0.9814798464377721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": 52.80000000000008, "episode_reward_mean": 210.77099999999996, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -553.0716073694585, "predator_policy": 2.4987002274232797}, "policy_reward_max": {"prey_policy": 386.5012997725767, "predator_policy": 622.2716073694597}, "policy_reward_mean": {"prey_policy": -48.75089331619718, "predator_policy": 259.52189331619724}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.19999999999997, 103.79999999999981, 347.3, 185.10000000000002, 168.6999999999999, 112.29999999999976, 160.19999999999942, 240.39999999999992, 110.09999999999977, 285.10000000000025, 80.59999999999951, 271.90000000000003, 137.99999999999994, 76.10000000000026, 159.60000000000008, 215.9, 196.39999999999995, 191.09999999999982, 185.30000000000013, 109.09999999999997, 136.99999999999983, 52.80000000000008, 106.99999999999997, 196.8, 108.19999999999987, 210.49999999999957, 240.3, 77.4999999999999, 240.40000000000003, 233.19999999999996, 389.0, 183.50000000000006, 96.9, 109.5, 93.7, 229.70000000000002, 134.29999999999998, 96.59999999999997, 228.70000000000005, 326.0, 89.80000000000001, 186.99999999999977, 324.5, 281.3999999999998, 169.59999999999957, 149.79999999999967, 109.49999999999997, 116.1, 189.39999999999995, 319.5, 317.0, 137.59999999999997, 290.6, 131.09999999999985, 292.2, 265.5, 251.09999999999943, 215.49999999999991, 197.9999999999999, 367.0, 195.2, 134.20000000000002, 210.39999999999986, 138.7999999999999, 300.1, 367.9, 292.29999999999995, 101.89999999999989, 318.1, 352.4, 163.7, 110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6, 386.3, 136.29999999999995, 82.0000000000001, 131.0, 345.0, 207.19999999999993, 305.59999999999974, 330.8, 251.0, 230.0, 197.7, 216.60000000000002, 213.2, 174.39999999999992, 333.40000000000003, 351.1, 316.6000000000001, 358.0, 370.8, 273.2, 202.8, 197.4, 312.0, 301.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-553.0716073694585, -379.05190312426805, 314.2458832451748, -237.96869506297702, -67.07372890471147, -418.8121474173992, -81.90529232936592, 16.43626128855909, -353.10267935846446, 142.48970070755476, -303.69017722305017, 129.38704651736234, -326.1073347823983, -152.24438998468227, -107.35009053533813, -80.29128216955493, -94.22275360207009, -83.2237111708841, -48.76255399145796, -301.5534880975212, -276.55655807070514, -477.4148693150802, -381.73063756878713, -107.75495517559557, -298.4275800775233, 17.62630231065772, 88.9061231668174, -385.44969970015165, 121.13922314438769, 4.957095159707221, 386.5012997725767, -56.80963895046159, -362.54978966178663, -226.6860046764894, -457.8086731337442, -16.75888056559407, -202.54735509742218, -429.9804239001044, 21.333224176862927, 202.5200985274773, -389.8650216035965, -117.56191377075152, 263.1996827012921, 158.4470800723294, -28.702089045467627, -120.19351790728243, -351.7468128592037, -376.78711621499775, -173.75741721158496, 266.48801808831246, 162.35249130939408, -139.0388003661047, 191.20965339206882, -227.72641721389238, 148.0790904628101, 119.6513260159449, 179.1356127847685, -96.98983910916093, -90.94972532719781, 320.9604594868953, -151.34546625167934, -268.7165122471617, -21.467826355047137, -309.0120295933212, 202.32449586990361, 341.80642312763126, 152.9619883316687, -288.6625616340598, 208.52106303849263, 307.31432730375525, -164.52927052641326, -265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732, 376.6179976676897, -302.73571044651356, -335.2491863148508, -245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683, 221.1661792855318, 75.71907473357768, -3.740898262383835, -135.69540010494825, -25.279464680431335, -97.72830847183643, -168.83453459487913, 298.9941438427073, 347.40071407413706, 207.23628697389117, 322.0200298309355, 326.03165264481765, 97.52619417606545, -52.45884445400586, -74.97561133910519, 196.7081437924051, 164.59759168754988], "policy_predator_policy_reward": [622.2716073694597, 482.85190312426863, 33.054116754825195, 423.0686950629771, 235.77372890471145, 531.1121474174001, 242.10529232936605, 223.96373871144087, 463.20267935846425, 142.61029929244535, 384.29017722305224, 142.5129534826375, 464.1073347823986, 228.34438998468104, 266.95009053533823, 296.1912821695551, 290.6227536020701, 274.32371117088417, 234.06255399145755, 410.65348809752106, 413.55655807070514, 530.2148693150816, 488.7306375687872, 304.55495517559575, 406.6275800775236, 192.8736976893424, 151.39387683318228, 462.9496997001515, 119.26077685561243, 228.2429048402929, 2.4987002274232797, 240.3096389504613, 459.4497896617867, 336.18600467648923, 551.5086731337442, 246.458880565594, 336.84735509742234, 526.5804239001046, 207.3667758231369, 123.47990147252267, 479.6650216035963, 304.5619137707514, 61.300317298707895, 122.95291992767052, 198.3020890454673, 269.9935179072825, 461.2468128592036, 492.88711621499755, 363.15741721158486, 53.01198191168758, 154.64750869060603, 276.6388003661046, 99.39034660793126, 358.8264172138922, 144.12090953718993, 145.8486739840551, 71.96438721523089, 312.489839109161, 288.94972532719794, 46.039540513104754, 346.54546625167933, 402.91651224716196, 231.86782635504693, 447.8120295933212, 97.77550413009645, 26.093576872368757, 139.33801166833132, 390.5625616340598, 109.5789369615073, 45.08567269624464, 328.2292705264132, 376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678, 9.682002332310278, 439.03571044651386, 417.2491863148506, 376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295, 109.63382071446819, 175.28092526642203, 233.74089826238406, 333.39540010494807, 241.87946468043143, 310.92830847183654, 343.23453459487916, 34.4058561572927, 3.6992859258629585, 109.36371302610893, 35.97997016906447, 44.768347355182335, 175.67380582393457, 255.2588444540058, 272.37561133910515, 115.29185620759492, 136.80240831245013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.555743762056216, "mean_inference_ms": 3.374940504215289, "mean_action_processing_ms": 0.9123449080357987, "mean_env_wait_ms": 10.0077146853621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012740135192871094, "StateBufferConnector_ms": 0.0039217472076416016, "ViewRequirementAgentConnector_ms": 0.05871701240539551}, "num_episodes": 4, "episode_return_max": 389.0, "episode_return_min": 52.80000000000008, "episode_return_mean": 210.77099999999996, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.8178329971173, "num_env_steps_trained_throughput_per_sec": 137.8178329971173, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 25213.263, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25212.977, "sample_time_ms": 1846.174, "learn_time_ms": 23340.823, "learn_throughput": 171.374, "synch_weights_time_ms": 23.909}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 68, "trial_id": "cbf82_00000", "date": "2024-08-21_13-36-31", "timestamp": 1724227591, "time_this_iter_s": 29.064509868621826, "time_total_s": 1765.235286951065, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x307570d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1765.235286951065, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 44.745238095238086, "ram_util_percent": 80.80238095238094}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.505316418968141, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.7809769277771315, "policy_loss": -0.008295864595856984, "vf_loss": 5.786994835734367, "vf_explained_var": 0.19258917073408763, "kl": 0.011389685615965088, "entropy": 0.6769703643396496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 506.1399999999994}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.589575265596311, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.446072234213352, "policy_loss": -0.025677001148869748, "vf_loss": 6.468778568009536, "vf_explained_var": 0.29621440476427474, "kl": 0.014853384508266268, "entropy": 0.9347528870527942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 506.1399999999994}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": 52.80000000000008, "episode_reward_mean": 216.61899999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -477.4148693150802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 386.5012997725767, "predator_policy": 551.5086731337442}, "policy_reward_mean": {"prey_policy": -34.01188855234793, "predator_policy": 250.6308885523479}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.99999999999994, 76.10000000000026, 159.60000000000008, 215.9, 196.39999999999995, 191.09999999999982, 185.30000000000013, 109.09999999999997, 136.99999999999983, 52.80000000000008, 106.99999999999997, 196.8, 108.19999999999987, 210.49999999999957, 240.3, 77.4999999999999, 240.40000000000003, 233.19999999999996, 389.0, 183.50000000000006, 96.9, 109.5, 93.7, 229.70000000000002, 134.29999999999998, 96.59999999999997, 228.70000000000005, 326.0, 89.80000000000001, 186.99999999999977, 324.5, 281.3999999999998, 169.59999999999957, 149.79999999999967, 109.49999999999997, 116.1, 189.39999999999995, 319.5, 317.0, 137.59999999999997, 290.6, 131.09999999999985, 292.2, 265.5, 251.09999999999943, 215.49999999999991, 197.9999999999999, 367.0, 195.2, 134.20000000000002, 210.39999999999986, 138.7999999999999, 300.1, 367.9, 292.29999999999995, 101.89999999999989, 318.1, 352.4, 163.7, 110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6, 386.3, 136.29999999999995, 82.0000000000001, 131.0, 345.0, 207.19999999999993, 305.59999999999974, 330.8, 251.0, 230.0, 197.7, 216.60000000000002, 213.2, 174.39999999999992, 333.40000000000003, 351.1, 316.6000000000001, 358.0, 370.8, 273.2, 202.8, 197.4, 312.0, 301.4, 267.09999999999997, 67.19999999999997, 95.90000000000009, 332.1, 145.29999999999995, 380.7, 386.5, 381.4, 124.09999999999965, 238.09999999999997, 90.4, 210.7], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-326.1073347823983, -152.24438998468227, -107.35009053533813, -80.29128216955493, -94.22275360207009, -83.2237111708841, -48.76255399145796, -301.5534880975212, -276.55655807070514, -477.4148693150802, -381.73063756878713, -107.75495517559557, -298.4275800775233, 17.62630231065772, 88.9061231668174, -385.44969970015165, 121.13922314438769, 4.957095159707221, 386.5012997725767, -56.80963895046159, -362.54978966178663, -226.6860046764894, -457.8086731337442, -16.75888056559407, -202.54735509742218, -429.9804239001044, 21.333224176862927, 202.5200985274773, -389.8650216035965, -117.56191377075152, 263.1996827012921, 158.4470800723294, -28.702089045467627, -120.19351790728243, -351.7468128592037, -376.78711621499775, -173.75741721158496, 266.48801808831246, 162.35249130939408, -139.0388003661047, 191.20965339206882, -227.72641721389238, 148.0790904628101, 119.6513260159449, 179.1356127847685, -96.98983910916093, -90.94972532719781, 320.9604594868953, -151.34546625167934, -268.7165122471617, -21.467826355047137, -309.0120295933212, 202.32449586990361, 341.80642312763126, 152.9619883316687, -288.6625616340598, 208.52106303849263, 307.31432730375525, -164.52927052641326, -265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732, 376.6179976676897, -302.73571044651356, -335.2491863148508, -245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683, 221.1661792855318, 75.71907473357768, -3.740898262383835, -135.69540010494825, -25.279464680431335, -97.72830847183643, -168.83453459487913, 298.9941438427073, 347.40071407413706, 207.23628697389117, 322.0200298309355, 326.03165264481765, 97.52619417606545, -52.45884445400586, -74.97561133910519, 196.7081437924051, 164.59759168754988, 39.89136004852176, -457.4170146861596, -288.66121510530826, 249.38410151717028, -346.2264063657511, 376.15867018148805, 386.5, 372.2382012878113, -119.06347487686728, -102.45047095753381, -374.1871220777666, -54.38349161172414], "policy_predator_policy_reward": [464.1073347823986, 228.34438998468104, 266.95009053533823, 296.1912821695551, 290.6227536020701, 274.32371117088417, 234.06255399145755, 410.65348809752106, 413.55655807070514, 530.2148693150816, 488.7306375687872, 304.55495517559575, 406.6275800775236, 192.8736976893424, 151.39387683318228, 462.9496997001515, 119.26077685561243, 228.2429048402929, 2.4987002274232797, 240.3096389504613, 459.4497896617867, 336.18600467648923, 551.5086731337442, 246.458880565594, 336.84735509742234, 526.5804239001046, 207.3667758231369, 123.47990147252267, 479.6650216035963, 304.5619137707514, 61.300317298707895, 122.95291992767052, 198.3020890454673, 269.9935179072825, 461.2468128592036, 492.88711621499755, 363.15741721158486, 53.01198191168758, 154.64750869060603, 276.6388003661046, 99.39034660793126, 358.8264172138922, 144.12090953718993, 145.8486739840551, 71.96438721523089, 312.489839109161, 288.94972532719794, 46.039540513104754, 346.54546625167933, 402.91651224716196, 231.86782635504693, 447.8120295933212, 97.77550413009645, 26.093576872368757, 139.33801166833132, 390.5625616340598, 109.5789369615073, 45.08567269624464, 328.2292705264132, 376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678, 9.682002332310278, 439.03571044651386, 417.2491863148506, 376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295, 109.63382071446819, 175.28092526642203, 233.74089826238406, 333.39540010494807, 241.87946468043143, 310.92830847183654, 343.23453459487916, 34.4058561572927, 3.6992859258629585, 109.36371302610893, 35.97997016906447, 44.768347355182335, 175.67380582393457, 255.2588444540058, 272.37561133910515, 115.29185620759492, 136.80240831245013, 227.20863995147832, 524.6170146861598, 384.5612151053081, 82.7158984828297, 491.52640636575114, 4.541329818511963, 0.0, 9.161798712188716, 243.16347487686733, 340.550470957534, 464.58712207776665, 265.0834916117241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5452941509398825, "mean_inference_ms": 3.37307587299277, "mean_action_processing_ms": 0.898129939992763, "mean_env_wait_ms": 10.003673379363281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012844324111938477, "StateBufferConnector_ms": 0.004049062728881836, "ViewRequirementAgentConnector_ms": 0.06186246871948242}, "num_episodes": 12, "episode_return_max": 389.0, "episode_return_min": 52.80000000000008, "episode_return_mean": 216.61899999999994, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.87634493329097, "num_env_steps_trained_throughput_per_sec": 150.87634493329097, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 25408.805, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25408.513, "sample_time_ms": 1885.174, "learn_time_ms": 23498.909, "learn_throughput": 170.221, "synch_weights_time_ms": 22.276}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 69, "trial_id": "cbf82_00000", "date": "2024-08-21_13-36-57", "timestamp": 1724227617, "time_this_iter_s": 26.54007911682129, "time_total_s": 1791.7753660678864, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e7ed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1791.7753660678864, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 35.76216216216217, "ram_util_percent": 77.5135135135135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.795820357277989, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.752391714851061, "policy_loss": -0.004924009254318662, "vf_loss": 5.755569506188234, "vf_explained_var": 0.20083016113688548, "kl": 0.008731023025029571, "entropy": 0.6868759904367229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.893532564987739, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.385481229921182, "policy_loss": -0.026471509213297394, "vf_loss": 6.409068709611892, "vf_explained_var": 0.07059891813745102, "kl": 0.014420091210922692, "entropy": 0.9535899906108777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 67.19999999999997, "episode_reward_mean": 224.13499999999996, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -457.8086731337442, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 551.5086731337442}, "policy_reward_mean": {"prey_policy": -14.390435810828654, "predator_policy": 238.5254358108286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.19999999999987, 210.49999999999957, 240.3, 77.4999999999999, 240.40000000000003, 233.19999999999996, 389.0, 183.50000000000006, 96.9, 109.5, 93.7, 229.70000000000002, 134.29999999999998, 96.59999999999997, 228.70000000000005, 326.0, 89.80000000000001, 186.99999999999977, 324.5, 281.3999999999998, 169.59999999999957, 149.79999999999967, 109.49999999999997, 116.1, 189.39999999999995, 319.5, 317.0, 137.59999999999997, 290.6, 131.09999999999985, 292.2, 265.5, 251.09999999999943, 215.49999999999991, 197.9999999999999, 367.0, 195.2, 134.20000000000002, 210.39999999999986, 138.7999999999999, 300.1, 367.9, 292.29999999999995, 101.89999999999989, 318.1, 352.4, 163.7, 110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6, 386.3, 136.29999999999995, 82.0000000000001, 131.0, 345.0, 207.19999999999993, 305.59999999999974, 330.8, 251.0, 230.0, 197.7, 216.60000000000002, 213.2, 174.39999999999992, 333.40000000000003, 351.1, 316.6000000000001, 358.0, 370.8, 273.2, 202.8, 197.4, 312.0, 301.4, 267.09999999999997, 67.19999999999997, 95.90000000000009, 332.1, 145.29999999999995, 380.7, 386.5, 381.4, 124.09999999999965, 238.09999999999997, 90.4, 210.7, 96.20000000000002, 111.49999999999977, 165.60000000000002, 399.1, 355.6, 281.39999999999986, 109.79999999999995, 192.59999999999997, 176.69999999999973, 83.79999999999987, 395.0, 149.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-298.4275800775233, 17.62630231065772, 88.9061231668174, -385.44969970015165, 121.13922314438769, 4.957095159707221, 386.5012997725767, -56.80963895046159, -362.54978966178663, -226.6860046764894, -457.8086731337442, -16.75888056559407, -202.54735509742218, -429.9804239001044, 21.333224176862927, 202.5200985274773, -389.8650216035965, -117.56191377075152, 263.1996827012921, 158.4470800723294, -28.702089045467627, -120.19351790728243, -351.7468128592037, -376.78711621499775, -173.75741721158496, 266.48801808831246, 162.35249130939408, -139.0388003661047, 191.20965339206882, -227.72641721389238, 148.0790904628101, 119.6513260159449, 179.1356127847685, -96.98983910916093, -90.94972532719781, 320.9604594868953, -151.34546625167934, -268.7165122471617, -21.467826355047137, -309.0120295933212, 202.32449586990361, 341.80642312763126, 152.9619883316687, -288.6625616340598, 208.52106303849263, 307.31432730375525, -164.52927052641326, -265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732, 376.6179976676897, -302.73571044651356, -335.2491863148508, -245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683, 221.1661792855318, 75.71907473357768, -3.740898262383835, -135.69540010494825, -25.279464680431335, -97.72830847183643, -168.83453459487913, 298.9941438427073, 347.40071407413706, 207.23628697389117, 322.0200298309355, 326.03165264481765, 97.52619417606545, -52.45884445400586, -74.97561133910519, 196.7081437924051, 164.59759168754988, 39.89136004852176, -457.4170146861596, -288.66121510530826, 249.38410151717028, -346.2264063657511, 376.15867018148805, 386.5, 372.2382012878113, -119.06347487686728, -102.45047095753381, -374.1871220777666, -54.38349161172414, -344.732095054025, -259.7018987966682, -135.16788489398127, 399.1, 339.95479493400074, 140.93242031939488, -362.44407546777074, -18.27489873988506, -109.14891458360411, -315.1978404375589, 390.96595669289263, -201.35291428494165], "policy_predator_policy_reward": [406.6275800775236, 192.8736976893424, 151.39387683318228, 462.9496997001515, 119.26077685561243, 228.2429048402929, 2.4987002274232797, 240.3096389504613, 459.4497896617867, 336.18600467648923, 551.5086731337442, 246.458880565594, 336.84735509742234, 526.5804239001046, 207.3667758231369, 123.47990147252267, 479.6650216035963, 304.5619137707514, 61.300317298707895, 122.95291992767052, 198.3020890454673, 269.9935179072825, 461.2468128592036, 492.88711621499755, 363.15741721158486, 53.01198191168758, 154.64750869060603, 276.6388003661046, 99.39034660793126, 358.8264172138922, 144.12090953718993, 145.8486739840551, 71.96438721523089, 312.489839109161, 288.94972532719794, 46.039540513104754, 346.54546625167933, 402.91651224716196, 231.86782635504693, 447.8120295933212, 97.77550413009645, 26.093576872368757, 139.33801166833132, 390.5625616340598, 109.5789369615073, 45.08567269624464, 328.2292705264132, 376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678, 9.682002332310278, 439.03571044651386, 417.2491863148506, 376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295, 109.63382071446819, 175.28092526642203, 233.74089826238406, 333.39540010494807, 241.87946468043143, 310.92830847183654, 343.23453459487916, 34.4058561572927, 3.6992859258629585, 109.36371302610893, 35.97997016906447, 44.768347355182335, 175.67380582393457, 255.2588444540058, 272.37561133910515, 115.29185620759492, 136.80240831245013, 227.20863995147832, 524.6170146861598, 384.5612151053081, 82.7158984828297, 491.52640636575114, 4.541329818511963, 0.0, 9.161798712188716, 243.16347487686733, 340.550470957534, 464.58712207776665, 265.0834916117241, 440.9320950540247, 371.20189879666816, 300.76788489398126, 0.0, 15.645205065999251, 140.4675796806051, 472.2440754677708, 210.8748987398847, 285.848914583604, 398.9978404375588, 4.0340433071073925, 350.75291428494165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5415584708215273, "mean_inference_ms": 3.363688475760948, "mean_action_processing_ms": 0.8921596038724132, "mean_env_wait_ms": 10.002693911244263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012849688529968262, "StateBufferConnector_ms": 0.009823918342590332, "ViewRequirementAgentConnector_ms": 0.0822761058807373}, "num_episodes": 12, "episode_return_max": 399.1, "episode_return_min": 67.19999999999997, "episode_return_mean": 224.13499999999996, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.55797038157394, "num_env_steps_trained_throughput_per_sec": 149.55797038157394, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 25583.484, "restore_workers_time_ms": 0.031, "training_step_time_ms": 25583.268, "sample_time_ms": 1903.785, "learn_time_ms": 23654.649, "learn_throughput": 169.1, "synch_weights_time_ms": 22.749}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 70, "trial_id": "cbf82_00000", "date": "2024-08-21_13-37-24", "timestamp": 1724227644, "time_this_iter_s": 26.761911153793335, "time_total_s": 1818.5372772216797, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e7ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1818.5372772216797, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 38.41842105263158, "ram_util_percent": 78.2421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4383500789602595, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.25247443045179, "policy_loss": -0.0067869406411773525, "vf_loss": 5.257483616222938, "vf_explained_var": 0.20974407698959113, "kl": 0.008888706319460956, "entropy": 0.7139108236258228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.301865980401635, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.893067753811677, "policy_loss": -0.025815436339568502, "vf_loss": 5.915877480308215, "vf_explained_var": 0.22002787776291372, "kl": 0.015028486365433006, "entropy": 0.9740691917017102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 67.19999999999997, "episode_reward_mean": 229.65999999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -520.3079545804243, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 588.7079545804244}, "policy_reward_mean": {"prey_policy": -6.374386830817286, "predator_policy": 236.03438683081723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.0, 89.80000000000001, 186.99999999999977, 324.5, 281.3999999999998, 169.59999999999957, 149.79999999999967, 109.49999999999997, 116.1, 189.39999999999995, 319.5, 317.0, 137.59999999999997, 290.6, 131.09999999999985, 292.2, 265.5, 251.09999999999943, 215.49999999999991, 197.9999999999999, 367.0, 195.2, 134.20000000000002, 210.39999999999986, 138.7999999999999, 300.1, 367.9, 292.29999999999995, 101.89999999999989, 318.1, 352.4, 163.7, 110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6, 386.3, 136.29999999999995, 82.0000000000001, 131.0, 345.0, 207.19999999999993, 305.59999999999974, 330.8, 251.0, 230.0, 197.7, 216.60000000000002, 213.2, 174.39999999999992, 333.40000000000003, 351.1, 316.6000000000001, 358.0, 370.8, 273.2, 202.8, 197.4, 312.0, 301.4, 267.09999999999997, 67.19999999999997, 95.90000000000009, 332.1, 145.29999999999995, 380.7, 386.5, 381.4, 124.09999999999965, 238.09999999999997, 90.4, 210.7, 96.20000000000002, 111.49999999999977, 165.60000000000002, 399.1, 355.6, 281.39999999999986, 109.79999999999995, 192.59999999999997, 176.69999999999973, 83.79999999999987, 395.0, 149.4, 279.2, 386.0, 110.80000000000001, 317.79999999999995, 189.7999999999997, 113.9, 115.39999999999995, 100.3, 68.40000000000002, 352.0, 396.3, 134.1, 129.1, 148.49999999999997, 382.9], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [202.5200985274773, -389.8650216035965, -117.56191377075152, 263.1996827012921, 158.4470800723294, -28.702089045467627, -120.19351790728243, -351.7468128592037, -376.78711621499775, -173.75741721158496, 266.48801808831246, 162.35249130939408, -139.0388003661047, 191.20965339206882, -227.72641721389238, 148.0790904628101, 119.6513260159449, 179.1356127847685, -96.98983910916093, -90.94972532719781, 320.9604594868953, -151.34546625167934, -268.7165122471617, -21.467826355047137, -309.0120295933212, 202.32449586990361, 341.80642312763126, 152.9619883316687, -288.6625616340598, 208.52106303849263, 307.31432730375525, -164.52927052641326, -265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732, 376.6179976676897, -302.73571044651356, -335.2491863148508, -245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683, 221.1661792855318, 75.71907473357768, -3.740898262383835, -135.69540010494825, -25.279464680431335, -97.72830847183643, -168.83453459487913, 298.9941438427073, 347.40071407413706, 207.23628697389117, 322.0200298309355, 326.03165264481765, 97.52619417606545, -52.45884445400586, -74.97561133910519, 196.7081437924051, 164.59759168754988, 39.89136004852176, -457.4170146861596, -288.66121510530826, 249.38410151717028, -346.2264063657511, 376.15867018148805, 386.5, 372.2382012878113, -119.06347487686728, -102.45047095753381, -374.1871220777666, -54.38349161172414, -344.732095054025, -259.7018987966682, -135.16788489398127, 399.1, 339.95479493400074, 140.93242031939488, -362.44407546777074, -18.27489873988506, -109.14891458360411, -315.1978404375589, 390.96595669289263, -201.35291428494165, 221.52149194681326, 369.73357133461377, -409.87043187792017, 229.4772916703855, -42.165178904410475, -409.91515077706157, -269.72430917140935, -481.14876927843454, -520.3079545804243, 293.5121005383879, 395.497252790905, -239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364], "policy_predator_policy_reward": [123.47990147252267, 479.6650216035963, 304.5619137707514, 61.300317298707895, 122.95291992767052, 198.3020890454673, 269.9935179072825, 461.2468128592036, 492.88711621499755, 363.15741721158486, 53.01198191168758, 154.64750869060603, 276.6388003661046, 99.39034660793126, 358.8264172138922, 144.12090953718993, 145.8486739840551, 71.96438721523089, 312.489839109161, 288.94972532719794, 46.039540513104754, 346.54546625167933, 402.91651224716196, 231.86782635504693, 447.8120295933212, 97.77550413009645, 26.093576872368757, 139.33801166833132, 390.5625616340598, 109.5789369615073, 45.08567269624464, 328.2292705264132, 376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678, 9.682002332310278, 439.03571044651386, 417.2491863148506, 376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295, 109.63382071446819, 175.28092526642203, 233.74089826238406, 333.39540010494807, 241.87946468043143, 310.92830847183654, 343.23453459487916, 34.4058561572927, 3.6992859258629585, 109.36371302610893, 35.97997016906447, 44.768347355182335, 175.67380582393457, 255.2588444540058, 272.37561133910515, 115.29185620759492, 136.80240831245013, 227.20863995147832, 524.6170146861598, 384.5612151053081, 82.7158984828297, 491.52640636575114, 4.541329818511963, 0.0, 9.161798712188716, 243.16347487686733, 340.550470957534, 464.58712207776665, 265.0834916117241, 440.9320950540247, 371.20189879666816, 300.76788489398126, 0.0, 15.645205065999251, 140.4675796806051, 472.2440754677708, 210.8748987398847, 285.848914583604, 398.9978404375588, 4.0340433071073925, 350.75291428494165, 57.678508053186754, 16.266428665386226, 520.6704318779202, 88.3227083296145, 231.9651789044106, 523.8151507770614, 385.12430917140927, 581.4487692784352, 588.7079545804244, 58.487899461612166, 0.8027472090949631, 373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5352733132999554, "mean_inference_ms": 3.358780073168515, "mean_action_processing_ms": 0.8947984727824608, "mean_env_wait_ms": 9.985757266107294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013018012046813965, "StateBufferConnector_ms": 0.009787440299987793, "ViewRequirementAgentConnector_ms": 0.08249187469482422}, "num_episodes": 15, "episode_return_max": 399.1, "episode_return_min": 67.19999999999997, "episode_return_mean": 229.65999999999994, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.68130097683235, "num_env_steps_trained_throughput_per_sec": 151.68130097683235, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 25728.8, "restore_workers_time_ms": 0.034, "training_step_time_ms": 25728.586, "sample_time_ms": 1917.66, "learn_time_ms": 23785.946, "learn_throughput": 168.167, "synch_weights_time_ms": 23.037}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "training_iteration": 71, "trial_id": "cbf82_00000", "date": "2024-08-21_13-37-51", "timestamp": 1724227671, "time_this_iter_s": 26.42750310897827, "time_total_s": 1844.964780330658, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075bd700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1844.964780330658, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 34.63157894736842, "ram_util_percent": 78.57105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4963790223002436, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.6591908380389215, "policy_loss": -0.006419888522456555, "vf_loss": 5.66407270754377, "vf_explained_var": 0.20458684097975494, "kl": 0.007690045733761508, "entropy": 0.7535777357717355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.259974441925685, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.3932975326975185, "policy_loss": -0.021842923464767714, "vf_loss": 6.412343760828177, "vf_explained_var": 0.1442587270711859, "kl": 0.013983366116493319, "entropy": 0.9631122453759114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 67.19999999999997, "episode_reward_mean": 226.80499999999992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -520.3079545804243, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 588.7079545804244}, "policy_reward_mean": {"prey_policy": -19.03141880114355, "predator_policy": 245.83641880114357}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.1, 189.39999999999995, 319.5, 317.0, 137.59999999999997, 290.6, 131.09999999999985, 292.2, 265.5, 251.09999999999943, 215.49999999999991, 197.9999999999999, 367.0, 195.2, 134.20000000000002, 210.39999999999986, 138.7999999999999, 300.1, 367.9, 292.29999999999995, 101.89999999999989, 318.1, 352.4, 163.7, 110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6, 386.3, 136.29999999999995, 82.0000000000001, 131.0, 345.0, 207.19999999999993, 305.59999999999974, 330.8, 251.0, 230.0, 197.7, 216.60000000000002, 213.2, 174.39999999999992, 333.40000000000003, 351.1, 316.6000000000001, 358.0, 370.8, 273.2, 202.8, 197.4, 312.0, 301.4, 267.09999999999997, 67.19999999999997, 95.90000000000009, 332.1, 145.29999999999995, 380.7, 386.5, 381.4, 124.09999999999965, 238.09999999999997, 90.4, 210.7, 96.20000000000002, 111.49999999999977, 165.60000000000002, 399.1, 355.6, 281.39999999999986, 109.79999999999995, 192.59999999999997, 176.69999999999973, 83.79999999999987, 395.0, 149.4, 279.2, 386.0, 110.80000000000001, 317.79999999999995, 189.7999999999997, 113.9, 115.39999999999995, 100.3, 68.40000000000002, 352.0, 396.3, 134.1, 129.1, 148.49999999999997, 382.9, 76.79999999999961, 101.2, 314.30000000000007, 243.1, 158.0, 86.1, 168.79999999999998, 203.79999999999976], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-376.78711621499775, -173.75741721158496, 266.48801808831246, 162.35249130939408, -139.0388003661047, 191.20965339206882, -227.72641721389238, 148.0790904628101, 119.6513260159449, 179.1356127847685, -96.98983910916093, -90.94972532719781, 320.9604594868953, -151.34546625167934, -268.7165122471617, -21.467826355047137, -309.0120295933212, 202.32449586990361, 341.80642312763126, 152.9619883316687, -288.6625616340598, 208.52106303849263, 307.31432730375525, -164.52927052641326, -265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732, 376.6179976676897, -302.73571044651356, -335.2491863148508, -245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683, 221.1661792855318, 75.71907473357768, -3.740898262383835, -135.69540010494825, -25.279464680431335, -97.72830847183643, -168.83453459487913, 298.9941438427073, 347.40071407413706, 207.23628697389117, 322.0200298309355, 326.03165264481765, 97.52619417606545, -52.45884445400586, -74.97561133910519, 196.7081437924051, 164.59759168754988, 39.89136004852176, -457.4170146861596, -288.66121510530826, 249.38410151717028, -346.2264063657511, 376.15867018148805, 386.5, 372.2382012878113, -119.06347487686728, -102.45047095753381, -374.1871220777666, -54.38349161172414, -344.732095054025, -259.7018987966682, -135.16788489398127, 399.1, 339.95479493400074, 140.93242031939488, -362.44407546777074, -18.27489873988506, -109.14891458360411, -315.1978404375589, 390.96595669289263, -201.35291428494165, 221.52149194681326, 369.73357133461377, -409.87043187792017, 229.4772916703855, -42.165178904410475, -409.91515077706157, -269.72430917140935, -481.14876927843454, -520.3079545804243, 293.5121005383879, 395.497252790905, -239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364, -436.3623769289565, -470.3405088020761, 185.1735371451033, -16.870531915014965, -258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428], "policy_predator_policy_reward": [492.88711621499755, 363.15741721158486, 53.01198191168758, 154.64750869060603, 276.6388003661046, 99.39034660793126, 358.8264172138922, 144.12090953718993, 145.8486739840551, 71.96438721523089, 312.489839109161, 288.94972532719794, 46.039540513104754, 346.54546625167933, 402.91651224716196, 231.86782635504693, 447.8120295933212, 97.77550413009645, 26.093576872368757, 139.33801166833132, 390.5625616340598, 109.5789369615073, 45.08567269624464, 328.2292705264132, 376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678, 9.682002332310278, 439.03571044651386, 417.2491863148506, 376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295, 109.63382071446819, 175.28092526642203, 233.74089826238406, 333.39540010494807, 241.87946468043143, 310.92830847183654, 343.23453459487916, 34.4058561572927, 3.6992859258629585, 109.36371302610893, 35.97997016906447, 44.768347355182335, 175.67380582393457, 255.2588444540058, 272.37561133910515, 115.29185620759492, 136.80240831245013, 227.20863995147832, 524.6170146861598, 384.5612151053081, 82.7158984828297, 491.52640636575114, 4.541329818511963, 0.0, 9.161798712188716, 243.16347487686733, 340.550470957534, 464.58712207776665, 265.0834916117241, 440.9320950540247, 371.20189879666816, 300.76788489398126, 0.0, 15.645205065999251, 140.4675796806051, 472.2440754677708, 210.8748987398847, 285.848914583604, 398.9978404375588, 4.0340433071073925, 350.75291428494165, 57.678508053186754, 16.266428665386226, 520.6704318779202, 88.3227083296145, 231.9651789044106, 523.8151507770614, 385.12430917140927, 581.4487692784352, 588.7079545804244, 58.487899461612166, 0.8027472090949631, 373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384, 513.1623769289581, 571.5405088020761, 129.12646285489672, 259.97053191501493, 416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5305239788725453, "mean_inference_ms": 3.356794963512803, "mean_action_processing_ms": 0.891487308167317, "mean_env_wait_ms": 9.98231809848495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012976288795471191, "StateBufferConnector_ms": 0.00976550579071045, "ViewRequirementAgentConnector_ms": 0.07884323596954346}, "num_episodes": 8, "episode_return_max": 399.1, "episode_return_min": 67.19999999999997, "episode_return_mean": 226.80499999999992, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.2345614730063, "num_env_steps_trained_throughput_per_sec": 155.2345614730063, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 25827.945, "restore_workers_time_ms": 0.034, "training_step_time_ms": 25827.761, "sample_time_ms": 1912.621, "learn_time_ms": 23890.254, "learn_throughput": 167.432, "synch_weights_time_ms": 23.116}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 72, "trial_id": "cbf82_00000", "date": "2024-08-21_13-38-16", "timestamp": 1724227696, "time_this_iter_s": 25.787872076034546, "time_total_s": 1870.7526524066925, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075bd280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1870.7526524066925, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 38.564864864864866, "ram_util_percent": 79.42162162162161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.30615487160782, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.383884707093239, "policy_loss": -0.006107992646866478, "vf_loss": 5.388345235586167, "vf_explained_var": 0.22441370350619158, "kl": 0.008237247457145713, "entropy": 0.7498979619704187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.925924568623305, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.853267571826776, "policy_loss": -0.02449055511096958, "vf_loss": 6.8748955448468525, "vf_explained_var": 0.0832561166336139, "kl": 0.014312876048643374, "entropy": 0.9127978982403875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 67.19999999999997, "episode_reward_mean": 227.94799999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -543.9581729944415, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -21.541704040565488, "predator_policy": 249.48970404056553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [265.5, 251.09999999999943, 215.49999999999991, 197.9999999999999, 367.0, 195.2, 134.20000000000002, 210.39999999999986, 138.7999999999999, 300.1, 367.9, 292.29999999999995, 101.89999999999989, 318.1, 352.4, 163.7, 110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6, 386.3, 136.29999999999995, 82.0000000000001, 131.0, 345.0, 207.19999999999993, 305.59999999999974, 330.8, 251.0, 230.0, 197.7, 216.60000000000002, 213.2, 174.39999999999992, 333.40000000000003, 351.1, 316.6000000000001, 358.0, 370.8, 273.2, 202.8, 197.4, 312.0, 301.4, 267.09999999999997, 67.19999999999997, 95.90000000000009, 332.1, 145.29999999999995, 380.7, 386.5, 381.4, 124.09999999999965, 238.09999999999997, 90.4, 210.7, 96.20000000000002, 111.49999999999977, 165.60000000000002, 399.1, 355.6, 281.39999999999986, 109.79999999999995, 192.59999999999997, 176.69999999999973, 83.79999999999987, 395.0, 149.4, 279.2, 386.0, 110.80000000000001, 317.79999999999995, 189.7999999999997, 113.9, 115.39999999999995, 100.3, 68.40000000000002, 352.0, 396.3, 134.1, 129.1, 148.49999999999997, 382.9, 76.79999999999961, 101.2, 314.30000000000007, 243.1, 158.0, 86.1, 168.79999999999998, 203.79999999999976, 385.4, 117.4, 371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [119.6513260159449, 179.1356127847685, -96.98983910916093, -90.94972532719781, 320.9604594868953, -151.34546625167934, -268.7165122471617, -21.467826355047137, -309.0120295933212, 202.32449586990361, 341.80642312763126, 152.9619883316687, -288.6625616340598, 208.52106303849263, 307.31432730375525, -164.52927052641326, -265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732, 376.6179976676897, -302.73571044651356, -335.2491863148508, -245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683, 221.1661792855318, 75.71907473357768, -3.740898262383835, -135.69540010494825, -25.279464680431335, -97.72830847183643, -168.83453459487913, 298.9941438427073, 347.40071407413706, 207.23628697389117, 322.0200298309355, 326.03165264481765, 97.52619417606545, -52.45884445400586, -74.97561133910519, 196.7081437924051, 164.59759168754988, 39.89136004852176, -457.4170146861596, -288.66121510530826, 249.38410151717028, -346.2264063657511, 376.15867018148805, 386.5, 372.2382012878113, -119.06347487686728, -102.45047095753381, -374.1871220777666, -54.38349161172414, -344.732095054025, -259.7018987966682, -135.16788489398127, 399.1, 339.95479493400074, 140.93242031939488, -362.44407546777074, -18.27489873988506, -109.14891458360411, -315.1978404375589, 390.96595669289263, -201.35291428494165, 221.52149194681326, 369.73357133461377, -409.87043187792017, 229.4772916703855, -42.165178904410475, -409.91515077706157, -269.72430917140935, -481.14876927843454, -520.3079545804243, 293.5121005383879, 395.497252790905, -239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364, -436.3623769289565, -470.3405088020761, 185.1735371451033, -16.870531915014965, -258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428, 382.8912403034707, -376.1091552136775, 345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907], "policy_predator_policy_reward": [145.8486739840551, 71.96438721523089, 312.489839109161, 288.94972532719794, 46.039540513104754, 346.54546625167933, 402.91651224716196, 231.86782635504693, 447.8120295933212, 97.77550413009645, 26.093576872368757, 139.33801166833132, 390.5625616340598, 109.5789369615073, 45.08567269624464, 328.2292705264132, 376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678, 9.682002332310278, 439.03571044651386, 417.2491863148506, 376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295, 109.63382071446819, 175.28092526642203, 233.74089826238406, 333.39540010494807, 241.87946468043143, 310.92830847183654, 343.23453459487916, 34.4058561572927, 3.6992859258629585, 109.36371302610893, 35.97997016906447, 44.768347355182335, 175.67380582393457, 255.2588444540058, 272.37561133910515, 115.29185620759492, 136.80240831245013, 227.20863995147832, 524.6170146861598, 384.5612151053081, 82.7158984828297, 491.52640636575114, 4.541329818511963, 0.0, 9.161798712188716, 243.16347487686733, 340.550470957534, 464.58712207776665, 265.0834916117241, 440.9320950540247, 371.20189879666816, 300.76788489398126, 0.0, 15.645205065999251, 140.4675796806051, 472.2440754677708, 210.8748987398847, 285.848914583604, 398.9978404375588, 4.0340433071073925, 350.75291428494165, 57.678508053186754, 16.266428665386226, 520.6704318779202, 88.3227083296145, 231.9651789044106, 523.8151507770614, 385.12430917140927, 581.4487692784352, 588.7079545804244, 58.487899461612166, 0.8027472090949631, 373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384, 513.1623769289581, 571.5405088020761, 129.12646285489672, 259.97053191501493, 416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405, 2.5087596965293066, 493.5091552136774, 25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.527497232221914, "mean_inference_ms": 3.3585291728114233, "mean_action_processing_ms": 0.8817333180508621, "mean_env_wait_ms": 9.978497457043064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012997269630432129, "StateBufferConnector_ms": 0.009753584861755371, "ViewRequirementAgentConnector_ms": 0.09168422222137451}, "num_episodes": 8, "episode_return_max": 399.1, "episode_return_min": 67.19999999999997, "episode_return_mean": 227.94799999999995, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.8806784044311, "num_env_steps_trained_throughput_per_sec": 142.8806784044311, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 26129.604, "restore_workers_time_ms": 0.036, "training_step_time_ms": 26129.398, "sample_time_ms": 1959.333, "learn_time_ms": 24144.997, "learn_throughput": 165.666, "synch_weights_time_ms": 23.009}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "training_iteration": 73, "trial_id": "cbf82_00000", "date": "2024-08-21_13-38-44", "timestamp": 1724227724, "time_this_iter_s": 28.028847694396973, "time_total_s": 1898.7815001010895, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e730d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1898.7815001010895, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 47.1575, "ram_util_percent": 81.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.017225905507803, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.641926324615876, "policy_loss": -0.007230509207389938, "vf_loss": 4.646785677969456, "vf_explained_var": 0.22240358348935843, "kl": 0.01185581616203611, "entropy": 0.8187928328911463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.42212730968992, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.527714806298415, "policy_loss": -0.02695344757909576, "vf_loss": 5.551350416739782, "vf_explained_var": 0.1427458751325806, "kl": 0.01658935370457281, "entropy": 0.8987045172601938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 60.400000000000034, "episode_reward_mean": 225.83100000000002, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -555.6003145828362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -31.897492813145785, "predator_policy": 257.7284928131458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.9, 292.29999999999995, 101.89999999999989, 318.1, 352.4, 163.7, 110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6, 386.3, 136.29999999999995, 82.0000000000001, 131.0, 345.0, 207.19999999999993, 305.59999999999974, 330.8, 251.0, 230.0, 197.7, 216.60000000000002, 213.2, 174.39999999999992, 333.40000000000003, 351.1, 316.6000000000001, 358.0, 370.8, 273.2, 202.8, 197.4, 312.0, 301.4, 267.09999999999997, 67.19999999999997, 95.90000000000009, 332.1, 145.29999999999995, 380.7, 386.5, 381.4, 124.09999999999965, 238.09999999999997, 90.4, 210.7, 96.20000000000002, 111.49999999999977, 165.60000000000002, 399.1, 355.6, 281.39999999999986, 109.79999999999995, 192.59999999999997, 176.69999999999973, 83.79999999999987, 395.0, 149.4, 279.2, 386.0, 110.80000000000001, 317.79999999999995, 189.7999999999997, 113.9, 115.39999999999995, 100.3, 68.40000000000002, 352.0, 396.3, 134.1, 129.1, 148.49999999999997, 382.9, 76.79999999999961, 101.2, 314.30000000000007, 243.1, 158.0, 86.1, 168.79999999999998, 203.79999999999976, 385.4, 117.4, 371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993, 340.0000000000002, 147.09999999999982, 184.19999999999996, 96.59999999999991, 155.2, 381.6, 60.400000000000034, 236.10000000000014, 64.69999999999996, 398.2], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [341.80642312763126, 152.9619883316687, -288.6625616340598, 208.52106303849263, 307.31432730375525, -164.52927052641326, -265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732, 376.6179976676897, -302.73571044651356, -335.2491863148508, -245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683, 221.1661792855318, 75.71907473357768, -3.740898262383835, -135.69540010494825, -25.279464680431335, -97.72830847183643, -168.83453459487913, 298.9941438427073, 347.40071407413706, 207.23628697389117, 322.0200298309355, 326.03165264481765, 97.52619417606545, -52.45884445400586, -74.97561133910519, 196.7081437924051, 164.59759168754988, 39.89136004852176, -457.4170146861596, -288.66121510530826, 249.38410151717028, -346.2264063657511, 376.15867018148805, 386.5, 372.2382012878113, -119.06347487686728, -102.45047095753381, -374.1871220777666, -54.38349161172414, -344.732095054025, -259.7018987966682, -135.16788489398127, 399.1, 339.95479493400074, 140.93242031939488, -362.44407546777074, -18.27489873988506, -109.14891458360411, -315.1978404375589, 390.96595669289263, -201.35291428494165, 221.52149194681326, 369.73357133461377, -409.87043187792017, 229.4772916703855, -42.165178904410475, -409.91515077706157, -269.72430917140935, -481.14876927843454, -520.3079545804243, 293.5121005383879, 395.497252790905, -239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364, -436.3623769289565, -470.3405088020761, 185.1735371451033, -16.870531915014965, -258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428, 382.8912403034707, -376.1091552136775, 345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907, 272.7362266702808, -308.2356572479278, -203.73929621076059, -496.18081897514395, -251.75896116720725, 375.9369191281379, -555.6003145828362, 112.1699248870858, -495.5164044857149, 398.2], "policy_predator_policy_reward": [26.093576872368757, 139.33801166833132, 390.5625616340598, 109.5789369615073, 45.08567269624464, 328.2292705264132, 376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678, 9.682002332310278, 439.03571044651386, 417.2491863148506, 376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295, 109.63382071446819, 175.28092526642203, 233.74089826238406, 333.39540010494807, 241.87946468043143, 310.92830847183654, 343.23453459487916, 34.4058561572927, 3.6992859258629585, 109.36371302610893, 35.97997016906447, 44.768347355182335, 175.67380582393457, 255.2588444540058, 272.37561133910515, 115.29185620759492, 136.80240831245013, 227.20863995147832, 524.6170146861598, 384.5612151053081, 82.7158984828297, 491.52640636575114, 4.541329818511963, 0.0, 9.161798712188716, 243.16347487686733, 340.550470957534, 464.58712207776665, 265.0834916117241, 440.9320950540247, 371.20189879666816, 300.76788489398126, 0.0, 15.645205065999251, 140.4675796806051, 472.2440754677708, 210.8748987398847, 285.848914583604, 398.9978404375588, 4.0340433071073925, 350.75291428494165, 57.678508053186754, 16.266428665386226, 520.6704318779202, 88.3227083296145, 231.9651789044106, 523.8151507770614, 385.12430917140927, 581.4487692784352, 588.7079545804244, 58.487899461612166, 0.8027472090949631, 373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384, 513.1623769289581, 571.5405088020761, 129.12646285489672, 259.97053191501493, 416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405, 2.5087596965293066, 493.5091552136774, 25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193, 67.2637733297196, 455.33565724792834, 387.9392962107602, 592.7808189751438, 406.9589611672073, 5.6630808718621, 616.0003145828358, 123.93007511291428, 560.2164044857149, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.528690864619267, "mean_inference_ms": 3.358708927823039, "mean_action_processing_ms": 0.8771813123233155, "mean_env_wait_ms": 9.979710402092064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013201594352722168, "StateBufferConnector_ms": 0.010034322738647461, "ViewRequirementAgentConnector_ms": 0.09462940692901611}, "num_episodes": 10, "episode_return_max": 399.1, "episode_return_min": 60.400000000000034, "episode_return_mean": 225.83100000000002, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.14625610946587, "num_env_steps_trained_throughput_per_sec": 139.14625610946587, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 26524.542, "restore_workers_time_ms": 0.036, "training_step_time_ms": 26524.312, "sample_time_ms": 2025.616, "learn_time_ms": 24472.888, "learn_throughput": 163.446, "synch_weights_time_ms": 23.504}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 74, "trial_id": "cbf82_00000", "date": "2024-08-21_13-39-13", "timestamp": 1724227753, "time_this_iter_s": 28.779367923736572, "time_total_s": 1927.560868024826, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e65280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1927.560868024826, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 43.7625, "ram_util_percent": 83.31500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.006166323150198, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.383487544208765, "policy_loss": -0.005851267991723337, "vf_loss": 4.387553031742573, "vf_explained_var": 0.23176006078720093, "kl": 0.008928868678049184, "entropy": 0.870047146640718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.89421584593753, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.205754556755225, "policy_loss": -0.023073217645287514, "vf_loss": 5.225896846254667, "vf_explained_var": 0.3013189058750868, "kl": 0.014654636737153245, "entropy": 0.8747229276845853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 60.400000000000034, "episode_reward_mean": 222.20399999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -555.6003145828362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -43.17406142567265, "predator_policy": 265.3780614256726}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.49999999999989, 294.8, 148.60000000000002, 147.79999999999993, 276.6, 386.3, 136.29999999999995, 82.0000000000001, 131.0, 345.0, 207.19999999999993, 305.59999999999974, 330.8, 251.0, 230.0, 197.7, 216.60000000000002, 213.2, 174.39999999999992, 333.40000000000003, 351.1, 316.6000000000001, 358.0, 370.8, 273.2, 202.8, 197.4, 312.0, 301.4, 267.09999999999997, 67.19999999999997, 95.90000000000009, 332.1, 145.29999999999995, 380.7, 386.5, 381.4, 124.09999999999965, 238.09999999999997, 90.4, 210.7, 96.20000000000002, 111.49999999999977, 165.60000000000002, 399.1, 355.6, 281.39999999999986, 109.79999999999995, 192.59999999999997, 176.69999999999973, 83.79999999999987, 395.0, 149.4, 279.2, 386.0, 110.80000000000001, 317.79999999999995, 189.7999999999997, 113.9, 115.39999999999995, 100.3, 68.40000000000002, 352.0, 396.3, 134.1, 129.1, 148.49999999999997, 382.9, 76.79999999999961, 101.2, 314.30000000000007, 243.1, 158.0, 86.1, 168.79999999999998, 203.79999999999976, 385.4, 117.4, 371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993, 340.0000000000002, 147.09999999999982, 184.19999999999996, 96.59999999999991, 155.2, 381.6, 60.400000000000034, 236.10000000000014, 64.69999999999996, 398.2, 161.0, 244.2, 397.0, 216.0, 127.1, 88.30000000000014], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-265.61081018278463, 139.6972079036686, -249.9547693399096, -127.76468108906575, 115.6476683599732, 376.6179976676897, -302.73571044651356, -335.2491863148508, -245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683, 221.1661792855318, 75.71907473357768, -3.740898262383835, -135.69540010494825, -25.279464680431335, -97.72830847183643, -168.83453459487913, 298.9941438427073, 347.40071407413706, 207.23628697389117, 322.0200298309355, 326.03165264481765, 97.52619417606545, -52.45884445400586, -74.97561133910519, 196.7081437924051, 164.59759168754988, 39.89136004852176, -457.4170146861596, -288.66121510530826, 249.38410151717028, -346.2264063657511, 376.15867018148805, 386.5, 372.2382012878113, -119.06347487686728, -102.45047095753381, -374.1871220777666, -54.38349161172414, -344.732095054025, -259.7018987966682, -135.16788489398127, 399.1, 339.95479493400074, 140.93242031939488, -362.44407546777074, -18.27489873988506, -109.14891458360411, -315.1978404375589, 390.96595669289263, -201.35291428494165, 221.52149194681326, 369.73357133461377, -409.87043187792017, 229.4772916703855, -42.165178904410475, -409.91515077706157, -269.72430917140935, -481.14876927843454, -520.3079545804243, 293.5121005383879, 395.497252790905, -239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364, -436.3623769289565, -470.3405088020761, 185.1735371451033, -16.870531915014965, -258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428, 382.8912403034707, -376.1091552136775, 345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907, 272.7362266702808, -308.2356572479278, -203.73929621076059, -496.18081897514395, -251.75896116720725, 375.9369191281379, -555.6003145828362, 112.1699248870858, -495.5164044857149, 398.2, -265.10468534180643, -64.26343113738972, 394.2740241407002, -83.34546471769085, -266.3295715864467, -285.4757629689764], "policy_predator_policy_reward": [376.1108101827845, 155.10279209633126, 398.55476933990957, 275.56468108906563, 160.95233164002678, 9.682002332310278, 439.03571044651386, 417.2491863148506, 376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295, 109.63382071446819, 175.28092526642203, 233.74089826238406, 333.39540010494807, 241.87946468043143, 310.92830847183654, 343.23453459487916, 34.4058561572927, 3.6992859258629585, 109.36371302610893, 35.97997016906447, 44.768347355182335, 175.67380582393457, 255.2588444540058, 272.37561133910515, 115.29185620759492, 136.80240831245013, 227.20863995147832, 524.6170146861598, 384.5612151053081, 82.7158984828297, 491.52640636575114, 4.541329818511963, 0.0, 9.161798712188716, 243.16347487686733, 340.550470957534, 464.58712207776665, 265.0834916117241, 440.9320950540247, 371.20189879666816, 300.76788489398126, 0.0, 15.645205065999251, 140.4675796806051, 472.2440754677708, 210.8748987398847, 285.848914583604, 398.9978404375588, 4.0340433071073925, 350.75291428494165, 57.678508053186754, 16.266428665386226, 520.6704318779202, 88.3227083296145, 231.9651789044106, 523.8151507770614, 385.12430917140927, 581.4487692784352, 588.7079545804244, 58.487899461612166, 0.8027472090949631, 373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384, 513.1623769289581, 571.5405088020761, 129.12646285489672, 259.97053191501493, 416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405, 2.5087596965293066, 493.5091552136774, 25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193, 67.2637733297196, 455.33565724792834, 387.9392962107602, 592.7808189751438, 406.9589611672073, 5.6630808718621, 616.0003145828358, 123.93007511291428, 560.2164044857149, 0.0, 426.1046853418064, 308.46343113738965, 2.725975859299783, 299.3454647176908, 393.42957158644674, 373.77576296897644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5295266247391965, "mean_inference_ms": 3.3519182430602195, "mean_action_processing_ms": 0.8865900199680358, "mean_env_wait_ms": 9.988304381604785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013216376304626465, "StateBufferConnector_ms": 0.010041594505310059, "ViewRequirementAgentConnector_ms": 0.09849762916564941}, "num_episodes": 6, "episode_return_max": 399.1, "episode_return_min": 60.400000000000034, "episode_return_mean": 222.20399999999995, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.1221139683831, "num_env_steps_trained_throughput_per_sec": 156.1221139683831, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 26609.597, "restore_workers_time_ms": 0.032, "training_step_time_ms": 26609.32, "sample_time_ms": 2045.174, "learn_time_ms": 24535.93, "learn_throughput": 163.026, "synch_weights_time_ms": 25.934}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 75, "trial_id": "cbf82_00000", "date": "2024-08-21_13-39-39", "timestamp": 1724227779, "time_this_iter_s": 25.668251991271973, "time_total_s": 1953.229120016098, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075ccd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1953.229120016098, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 31.762162162162156, "ram_util_percent": 81.62972972972975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.760108708652357, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.802097888539235, "policy_loss": -0.006969604547096727, "vf_loss": 3.8069340005517005, "vf_explained_var": 0.23632394497593243, "kl": 0.010667432240249278, "entropy": 0.9258461279173692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.80417482604583, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.895343443751335, "policy_loss": -0.02783588411936459, "vf_loss": 4.920551387965679, "vf_explained_var": 0.29712337149928014, "kl": 0.013139698993957913, "entropy": 0.8514301634704073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 52.7, "episode_reward_mean": 223.47799999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -555.6003145828362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -43.022215864535056, "predator_policy": 266.5002158645351}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.0, 345.0, 207.19999999999993, 305.59999999999974, 330.8, 251.0, 230.0, 197.7, 216.60000000000002, 213.2, 174.39999999999992, 333.40000000000003, 351.1, 316.6000000000001, 358.0, 370.8, 273.2, 202.8, 197.4, 312.0, 301.4, 267.09999999999997, 67.19999999999997, 95.90000000000009, 332.1, 145.29999999999995, 380.7, 386.5, 381.4, 124.09999999999965, 238.09999999999997, 90.4, 210.7, 96.20000000000002, 111.49999999999977, 165.60000000000002, 399.1, 355.6, 281.39999999999986, 109.79999999999995, 192.59999999999997, 176.69999999999973, 83.79999999999987, 395.0, 149.4, 279.2, 386.0, 110.80000000000001, 317.79999999999995, 189.7999999999997, 113.9, 115.39999999999995, 100.3, 68.40000000000002, 352.0, 396.3, 134.1, 129.1, 148.49999999999997, 382.9, 76.79999999999961, 101.2, 314.30000000000007, 243.1, 158.0, 86.1, 168.79999999999998, 203.79999999999976, 385.4, 117.4, 371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993, 340.0000000000002, 147.09999999999982, 184.19999999999996, 96.59999999999991, 155.2, 381.6, 60.400000000000034, 236.10000000000014, 64.69999999999996, 398.2, 161.0, 244.2, 397.0, 216.0, 127.1, 88.30000000000014, 109.39999999999992, 141.29999999999998, 192.0, 360.0, 298.79999999999995, 291.1, 265.00000000000006, 52.7], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-245.11819751661864, 269.1510179471903, -75.1432263879478, 244.65167689698683, 221.1661792855318, 75.71907473357768, -3.740898262383835, -135.69540010494825, -25.279464680431335, -97.72830847183643, -168.83453459487913, 298.9941438427073, 347.40071407413706, 207.23628697389117, 322.0200298309355, 326.03165264481765, 97.52619417606545, -52.45884445400586, -74.97561133910519, 196.7081437924051, 164.59759168754988, 39.89136004852176, -457.4170146861596, -288.66121510530826, 249.38410151717028, -346.2264063657511, 376.15867018148805, 386.5, 372.2382012878113, -119.06347487686728, -102.45047095753381, -374.1871220777666, -54.38349161172414, -344.732095054025, -259.7018987966682, -135.16788489398127, 399.1, 339.95479493400074, 140.93242031939488, -362.44407546777074, -18.27489873988506, -109.14891458360411, -315.1978404375589, 390.96595669289263, -201.35291428494165, 221.52149194681326, 369.73357133461377, -409.87043187792017, 229.4772916703855, -42.165178904410475, -409.91515077706157, -269.72430917140935, -481.14876927843454, -520.3079545804243, 293.5121005383879, 395.497252790905, -239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364, -436.3623769289565, -470.3405088020761, 185.1735371451033, -16.870531915014965, -258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428, 382.8912403034707, -376.1091552136775, 345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907, 272.7362266702808, -308.2356572479278, -203.73929621076059, -496.18081897514395, -251.75896116720725, 375.9369191281379, -555.6003145828362, 112.1699248870858, -495.5164044857149, 398.2, -265.10468534180643, -64.26343113738972, 394.2740241407002, -83.34546471769085, -266.3295715864467, -285.4757629689764, -489.5166591567843, -252.55306321993314, -178.89437914272213, 302.75638835493055, 295.16258632600113, 117.38952679689608, 113.35968708537378, -541.8718143717974], "policy_predator_policy_reward": [376.11819751661926, 75.8489820528097, 282.3432263879477, 60.94832310301295, 109.63382071446819, 175.28092526642203, 233.74089826238406, 333.39540010494807, 241.87946468043143, 310.92830847183654, 343.23453459487916, 34.4058561572927, 3.6992859258629585, 109.36371302610893, 35.97997016906447, 44.768347355182335, 175.67380582393457, 255.2588444540058, 272.37561133910515, 115.29185620759492, 136.80240831245013, 227.20863995147832, 524.6170146861598, 384.5612151053081, 82.7158984828297, 491.52640636575114, 4.541329818511963, 0.0, 9.161798712188716, 243.16347487686733, 340.550470957534, 464.58712207776665, 265.0834916117241, 440.9320950540247, 371.20189879666816, 300.76788489398126, 0.0, 15.645205065999251, 140.4675796806051, 472.2440754677708, 210.8748987398847, 285.848914583604, 398.9978404375588, 4.0340433071073925, 350.75291428494165, 57.678508053186754, 16.266428665386226, 520.6704318779202, 88.3227083296145, 231.9651789044106, 523.8151507770614, 385.12430917140927, 581.4487692784352, 588.7079545804244, 58.487899461612166, 0.8027472090949631, 373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384, 513.1623769289581, 571.5405088020761, 129.12646285489672, 259.97053191501493, 416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405, 2.5087596965293066, 493.5091552136774, 25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193, 67.2637733297196, 455.33565724792834, 387.9392962107602, 592.7808189751438, 406.9589611672073, 5.6630808718621, 616.0003145828358, 123.93007511291428, 560.2164044857149, 0.0, 426.1046853418064, 308.46343113738965, 2.725975859299783, 299.3454647176908, 393.42957158644674, 373.77576296897644, 598.9166591567846, 393.8530632199331, 370.894379142722, 57.24361164506949, 3.6374136739988248, 173.71047320310393, 151.640312914626, 594.5718143717976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5285102898231053, "mean_inference_ms": 3.3557940090685903, "mean_action_processing_ms": 0.8796869544231343, "mean_env_wait_ms": 9.977013070821053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008386731147766113, "StateBufferConnector_ms": 0.010087966918945312, "ViewRequirementAgentConnector_ms": 0.10828495025634766}, "num_episodes": 8, "episode_return_max": 399.1, "episode_return_min": 52.7, "episode_return_mean": 223.47799999999995, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.70673386393207, "num_env_steps_trained_throughput_per_sec": 154.70673386393207, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 26718.671, "restore_workers_time_ms": 0.032, "training_step_time_ms": 26718.394, "sample_time_ms": 2045.567, "learn_time_ms": 24644.347, "learn_throughput": 162.309, "synch_weights_time_ms": 26.231}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 76, "trial_id": "cbf82_00000", "date": "2024-08-21_13-40-05", "timestamp": 1724227805, "time_this_iter_s": 25.865091800689697, "time_total_s": 1979.0942118167877, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075bd550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1979.0942118167877, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 30.83888888888889, "ram_util_percent": 80.86111111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2591404582063355, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.86798169563214, "policy_loss": -0.001924557153445979, "vf_loss": 3.8677895572036505, "vf_explained_var": 0.18565275836735964, "kl": 0.01058346830929319, "entropy": 1.005316984343032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.21061686761677, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.779769574850798, "policy_loss": -0.019723455842661983, "vf_loss": 4.797423176715771, "vf_explained_var": 0.36756693528344236, "kl": 0.010349405604453446, "entropy": 0.8717585328345497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 52.7, "episode_reward_mean": 223.55299999999997, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -555.6003145828362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -46.72902544086471, "predator_policy": 270.2820254408648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.0, 370.8, 273.2, 202.8, 197.4, 312.0, 301.4, 267.09999999999997, 67.19999999999997, 95.90000000000009, 332.1, 145.29999999999995, 380.7, 386.5, 381.4, 124.09999999999965, 238.09999999999997, 90.4, 210.7, 96.20000000000002, 111.49999999999977, 165.60000000000002, 399.1, 355.6, 281.39999999999986, 109.79999999999995, 192.59999999999997, 176.69999999999973, 83.79999999999987, 395.0, 149.4, 279.2, 386.0, 110.80000000000001, 317.79999999999995, 189.7999999999997, 113.9, 115.39999999999995, 100.3, 68.40000000000002, 352.0, 396.3, 134.1, 129.1, 148.49999999999997, 382.9, 76.79999999999961, 101.2, 314.30000000000007, 243.1, 158.0, 86.1, 168.79999999999998, 203.79999999999976, 385.4, 117.4, 371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993, 340.0000000000002, 147.09999999999982, 184.19999999999996, 96.59999999999991, 155.2, 381.6, 60.400000000000034, 236.10000000000014, 64.69999999999996, 398.2, 161.0, 244.2, 397.0, 216.0, 127.1, 88.30000000000014, 109.39999999999992, 141.29999999999998, 192.0, 360.0, 298.79999999999995, 291.1, 265.00000000000006, 52.7, 378.0, 278.4, 385.2, 167.2, 217.39999999999998, 360.4, 168.2999999999999, 261.5, 188.99999999999994, 306.3999999999999, 102.89999999999982, 325.2, 132.10000000000002, 339.1], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [322.0200298309355, 326.03165264481765, 97.52619417606545, -52.45884445400586, -74.97561133910519, 196.7081437924051, 164.59759168754988, 39.89136004852176, -457.4170146861596, -288.66121510530826, 249.38410151717028, -346.2264063657511, 376.15867018148805, 386.5, 372.2382012878113, -119.06347487686728, -102.45047095753381, -374.1871220777666, -54.38349161172414, -344.732095054025, -259.7018987966682, -135.16788489398127, 399.1, 339.95479493400074, 140.93242031939488, -362.44407546777074, -18.27489873988506, -109.14891458360411, -315.1978404375589, 390.96595669289263, -201.35291428494165, 221.52149194681326, 369.73357133461377, -409.87043187792017, 229.4772916703855, -42.165178904410475, -409.91515077706157, -269.72430917140935, -481.14876927843454, -520.3079545804243, 293.5121005383879, 395.497252790905, -239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364, -436.3623769289565, -470.3405088020761, 185.1735371451033, -16.870531915014965, -258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428, 382.8912403034707, -376.1091552136775, 345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907, 272.7362266702808, -308.2356572479278, -203.73929621076059, -496.18081897514395, -251.75896116720725, 375.9369191281379, -555.6003145828362, 112.1699248870858, -495.5164044857149, 398.2, -265.10468534180643, -64.26343113738972, 394.2740241407002, -83.34546471769085, -266.3295715864467, -285.4757629689764, -489.5166591567843, -252.55306321993314, -178.89437914272213, 302.75638835493055, 295.16258632600113, 117.38952679689608, 113.35968708537378, -541.8718143717974, 352.183761785363, 83.0143612747008, 358.943128146272, -225.07246715041225, -3.203183252279814, 360.4, -200.78113646596265, 19.53348949504749, -204.37107034999175, 190.24638385344355, -313.7160863502901, 275.15725645594586, -410.11311290504284, 259.8767815652187], "policy_predator_policy_reward": [35.97997016906447, 44.768347355182335, 175.67380582393457, 255.2588444540058, 272.37561133910515, 115.29185620759492, 136.80240831245013, 227.20863995147832, 524.6170146861598, 384.5612151053081, 82.7158984828297, 491.52640636575114, 4.541329818511963, 0.0, 9.161798712188716, 243.16347487686733, 340.550470957534, 464.58712207776665, 265.0834916117241, 440.9320950540247, 371.20189879666816, 300.76788489398126, 0.0, 15.645205065999251, 140.4675796806051, 472.2440754677708, 210.8748987398847, 285.848914583604, 398.9978404375588, 4.0340433071073925, 350.75291428494165, 57.678508053186754, 16.266428665386226, 520.6704318779202, 88.3227083296145, 231.9651789044106, 523.8151507770614, 385.12430917140927, 581.4487692784352, 588.7079545804244, 58.487899461612166, 0.8027472090949631, 373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384, 513.1623769289581, 571.5405088020761, 129.12646285489672, 259.97053191501493, 416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405, 2.5087596965293066, 493.5091552136774, 25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193, 67.2637733297196, 455.33565724792834, 387.9392962107602, 592.7808189751438, 406.9589611672073, 5.6630808718621, 616.0003145828358, 123.93007511291428, 560.2164044857149, 0.0, 426.1046853418064, 308.46343113738965, 2.725975859299783, 299.3454647176908, 393.42957158644674, 373.77576296897644, 598.9166591567846, 393.8530632199331, 370.894379142722, 57.24361164506949, 3.6374136739988248, 173.71047320310393, 151.640312914626, 594.5718143717976, 25.81623821463693, 195.38563872529923, 26.256871853728047, 392.2724671504124, 220.6031832522799, 0.0, 369.08113646596274, 241.96651050495245, 393.3710703499917, 116.15361614655636, 416.61608635029074, 50.04274354405423, 542.2131129050433, 79.2232184347813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5283398241141612, "mean_inference_ms": 3.363994640845147, "mean_action_processing_ms": 0.8729519280953358, "mean_env_wait_ms": 9.972222448168534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008501052856445312, "StateBufferConnector_ms": 0.0088653564453125, "ViewRequirementAgentConnector_ms": 0.11023032665252686}, "num_episodes": 14, "episode_return_max": 399.1, "episode_return_min": 52.7, "episode_return_mean": 223.55299999999997, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.79730774001865, "num_env_steps_trained_throughput_per_sec": 157.79730774001865, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 26798.736, "restore_workers_time_ms": 0.032, "training_step_time_ms": 26798.486, "sample_time_ms": 2044.936, "learn_time_ms": 24726.552, "learn_throughput": 161.769, "synch_weights_time_ms": 24.91}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "training_iteration": 77, "trial_id": "cbf82_00000", "date": "2024-08-21_13-40-30", "timestamp": 1724227830, "time_this_iter_s": 25.382493019104004, "time_total_s": 2004.4767048358917, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177ebd3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2004.4767048358917, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 29.92702702702703, "ram_util_percent": 80.73243243243243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.970102505510052, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.637938731908799, "policy_loss": -0.006295519213017542, "vf_loss": 4.64222074697415, "vf_explained_var": 0.23341218680143355, "kl": 0.010067604956323825, "entropy": 0.8504468887423475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.47171788799266, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.512321616212527, "policy_loss": -0.022768534001079387, "vf_loss": 5.532291913032532, "vf_explained_var": 0.12765455171465873, "kl": 0.013991391698558195, "entropy": 0.8404623261342447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 52.7, "episode_reward_mean": 218.46599999999998, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -555.6003145828362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -59.68634350359622, "predator_policy": 278.1523435035963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [381.4, 124.09999999999965, 238.09999999999997, 90.4, 210.7, 96.20000000000002, 111.49999999999977, 165.60000000000002, 399.1, 355.6, 281.39999999999986, 109.79999999999995, 192.59999999999997, 176.69999999999973, 83.79999999999987, 395.0, 149.4, 279.2, 386.0, 110.80000000000001, 317.79999999999995, 189.7999999999997, 113.9, 115.39999999999995, 100.3, 68.40000000000002, 352.0, 396.3, 134.1, 129.1, 148.49999999999997, 382.9, 76.79999999999961, 101.2, 314.30000000000007, 243.1, 158.0, 86.1, 168.79999999999998, 203.79999999999976, 385.4, 117.4, 371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993, 340.0000000000002, 147.09999999999982, 184.19999999999996, 96.59999999999991, 155.2, 381.6, 60.400000000000034, 236.10000000000014, 64.69999999999996, 398.2, 161.0, 244.2, 397.0, 216.0, 127.1, 88.30000000000014, 109.39999999999992, 141.29999999999998, 192.0, 360.0, 298.79999999999995, 291.1, 265.00000000000006, 52.7, 378.0, 278.4, 385.2, 167.2, 217.39999999999998, 360.4, 168.2999999999999, 261.5, 188.99999999999994, 306.3999999999999, 102.89999999999982, 325.2, 132.10000000000002, 339.1, 139.19999999999996, 113.8999999999998, 386.0, 114.6999999999999, 217.00000000000003, 270.20000000000005, 351.0, 107.39999999999998, 272.6, 285.8000000000005, 104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [372.2382012878113, -119.06347487686728, -102.45047095753381, -374.1871220777666, -54.38349161172414, -344.732095054025, -259.7018987966682, -135.16788489398127, 399.1, 339.95479493400074, 140.93242031939488, -362.44407546777074, -18.27489873988506, -109.14891458360411, -315.1978404375589, 390.96595669289263, -201.35291428494165, 221.52149194681326, 369.73357133461377, -409.87043187792017, 229.4772916703855, -42.165178904410475, -409.91515077706157, -269.72430917140935, -481.14876927843454, -520.3079545804243, 293.5121005383879, 395.497252790905, -239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364, -436.3623769289565, -470.3405088020761, 185.1735371451033, -16.870531915014965, -258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428, 382.8912403034707, -376.1091552136775, 345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907, 272.7362266702808, -308.2356572479278, -203.73929621076059, -496.18081897514395, -251.75896116720725, 375.9369191281379, -555.6003145828362, 112.1699248870858, -495.5164044857149, 398.2, -265.10468534180643, -64.26343113738972, 394.2740241407002, -83.34546471769085, -266.3295715864467, -285.4757629689764, -489.5166591567843, -252.55306321993314, -178.89437914272213, 302.75638835493055, 295.16258632600113, 117.38952679689608, 113.35968708537378, -541.8718143717974, 352.183761785363, 83.0143612747008, 358.943128146272, -225.07246715041225, -3.203183252279814, 360.4, -200.78113646596265, 19.53348949504749, -204.37107034999175, 190.24638385344355, -313.7160863502901, 275.15725645594586, -410.11311290504284, 259.8767815652187, -218.89192573370144, -337.6786390685438, 364.58601347109675, -264.14322087656507, -62.81823026146773, 100.5039975628063, 245.66941226482976, -357.34898700873174, 121.05205421088753, 149.71478540129007, -350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293], "policy_predator_policy_reward": [9.161798712188716, 243.16347487686733, 340.550470957534, 464.58712207776665, 265.0834916117241, 440.9320950540247, 371.20189879666816, 300.76788489398126, 0.0, 15.645205065999251, 140.4675796806051, 472.2440754677708, 210.8748987398847, 285.848914583604, 398.9978404375588, 4.0340433071073925, 350.75291428494165, 57.678508053186754, 16.266428665386226, 520.6704318779202, 88.3227083296145, 231.9651789044106, 523.8151507770614, 385.12430917140927, 581.4487692784352, 588.7079545804244, 58.487899461612166, 0.8027472090949631, 373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384, 513.1623769289581, 571.5405088020761, 129.12646285489672, 259.97053191501493, 416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405, 2.5087596965293066, 493.5091552136774, 25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193, 67.2637733297196, 455.33565724792834, 387.9392962107602, 592.7808189751438, 406.9589611672073, 5.6630808718621, 616.0003145828358, 123.93007511291428, 560.2164044857149, 0.0, 426.1046853418064, 308.46343113738965, 2.725975859299783, 299.3454647176908, 393.42957158644674, 373.77576296897644, 598.9166591567846, 393.8530632199331, 370.894379142722, 57.24361164506949, 3.6374136739988248, 173.71047320310393, 151.640312914626, 594.5718143717976, 25.81623821463693, 195.38563872529923, 26.256871853728047, 392.2724671504124, 220.6031832522799, 0.0, 369.08113646596274, 241.96651050495245, 393.3710703499917, 116.15361614655636, 416.61608635029074, 50.04274354405423, 542.2131129050433, 79.2232184347813, 358.0919257337012, 451.5786390685449, 21.41398652890328, 378.84322087656494, 279.81823026146776, 169.6960024371935, 105.33058773517025, 464.74898700873183, 151.54794578911248, 136.0852145987097, 455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5293450469135506, "mean_inference_ms": 3.3673581917756246, "mean_action_processing_ms": 0.8653215069215454, "mean_env_wait_ms": 9.96822321463349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008541584014892578, "StateBufferConnector_ms": 0.008855104446411133, "ViewRequirementAgentConnector_ms": 0.11282205581665039}, "num_episodes": 14, "episode_return_max": 399.1, "episode_return_min": 52.7, "episode_return_mean": 218.46599999999998, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.58436396253833, "num_env_steps_trained_throughput_per_sec": 157.58436396253833, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 26434.675, "restore_workers_time_ms": 0.032, "training_step_time_ms": 26434.416, "sample_time_ms": 2047.3, "learn_time_ms": 24359.097, "learn_throughput": 164.21, "synch_weights_time_ms": 25.5}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 78, "trial_id": "cbf82_00000", "date": "2024-08-21_13-40-56", "timestamp": 1724227856, "time_this_iter_s": 25.404773235321045, "time_total_s": 2029.8814780712128, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177ebd5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2029.8814780712128, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 29.36666666666666, "ram_util_percent": 81.15833333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.004279444118341, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.423643010854721, "policy_loss": -0.0061129580935812555, "vf_loss": 6.428082371254762, "vf_explained_var": 0.13220871997376282, "kl": 0.008367989628216796, "entropy": 0.7210496123259266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.610296802222729, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.941989062229792, "policy_loss": -0.02059113000044211, "vf_loss": 6.959700792034467, "vf_explained_var": 0.008549778970579307, "kl": 0.014396984825725666, "entropy": 0.8750175384183725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 52.7, "episode_reward_mean": 221.457, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -555.6003145828362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -53.21722847070785, "predator_policy": 274.67422847070793}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.79999999999995, 192.59999999999997, 176.69999999999973, 83.79999999999987, 395.0, 149.4, 279.2, 386.0, 110.80000000000001, 317.79999999999995, 189.7999999999997, 113.9, 115.39999999999995, 100.3, 68.40000000000002, 352.0, 396.3, 134.1, 129.1, 148.49999999999997, 382.9, 76.79999999999961, 101.2, 314.30000000000007, 243.1, 158.0, 86.1, 168.79999999999998, 203.79999999999976, 385.4, 117.4, 371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993, 340.0000000000002, 147.09999999999982, 184.19999999999996, 96.59999999999991, 155.2, 381.6, 60.400000000000034, 236.10000000000014, 64.69999999999996, 398.2, 161.0, 244.2, 397.0, 216.0, 127.1, 88.30000000000014, 109.39999999999992, 141.29999999999998, 192.0, 360.0, 298.79999999999995, 291.1, 265.00000000000006, 52.7, 378.0, 278.4, 385.2, 167.2, 217.39999999999998, 360.4, 168.2999999999999, 261.5, 188.99999999999994, 306.3999999999999, 102.89999999999982, 325.2, 132.10000000000002, 339.1, 139.19999999999996, 113.8999999999998, 386.0, 114.6999999999999, 217.00000000000003, 270.20000000000005, 351.0, 107.39999999999998, 272.6, 285.8000000000005, 104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2, 210.89999999999998, 330.7, 81.40000000000012, 351.0, 349.4, 375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-362.44407546777074, -18.27489873988506, -109.14891458360411, -315.1978404375589, 390.96595669289263, -201.35291428494165, 221.52149194681326, 369.73357133461377, -409.87043187792017, 229.4772916703855, -42.165178904410475, -409.91515077706157, -269.72430917140935, -481.14876927843454, -520.3079545804243, 293.5121005383879, 395.497252790905, -239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364, -436.3623769289565, -470.3405088020761, 185.1735371451033, -16.870531915014965, -258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428, 382.8912403034707, -376.1091552136775, 345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907, 272.7362266702808, -308.2356572479278, -203.73929621076059, -496.18081897514395, -251.75896116720725, 375.9369191281379, -555.6003145828362, 112.1699248870858, -495.5164044857149, 398.2, -265.10468534180643, -64.26343113738972, 394.2740241407002, -83.34546471769085, -266.3295715864467, -285.4757629689764, -489.5166591567843, -252.55306321993314, -178.89437914272213, 302.75638835493055, 295.16258632600113, 117.38952679689608, 113.35968708537378, -541.8718143717974, 352.183761785363, 83.0143612747008, 358.943128146272, -225.07246715041225, -3.203183252279814, 360.4, -200.78113646596265, 19.53348949504749, -204.37107034999175, 190.24638385344355, -313.7160863502901, 275.15725645594586, -410.11311290504284, 259.8767815652187, -218.89192573370144, -337.6786390685438, 364.58601347109675, -264.14322087656507, -62.81823026146773, 100.5039975628063, 245.66941226482976, -357.34898700873174, 121.05205421088753, 149.71478540129007, -350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293, -114.9466587742722, 244.92569587849493, -282.72465296750715, 283.2438984334918, 265.8883297003783, 358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426], "policy_predator_policy_reward": [472.2440754677708, 210.8748987398847, 285.848914583604, 398.9978404375588, 4.0340433071073925, 350.75291428494165, 57.678508053186754, 16.266428665386226, 520.6704318779202, 88.3227083296145, 231.9651789044106, 523.8151507770614, 385.12430917140927, 581.4487692784352, 588.7079545804244, 58.487899461612166, 0.8027472090949631, 373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384, 513.1623769289581, 571.5405088020761, 129.12646285489672, 259.97053191501493, 416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405, 2.5087596965293066, 493.5091552136774, 25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193, 67.2637733297196, 455.33565724792834, 387.9392962107602, 592.7808189751438, 406.9589611672073, 5.6630808718621, 616.0003145828358, 123.93007511291428, 560.2164044857149, 0.0, 426.1046853418064, 308.46343113738965, 2.725975859299783, 299.3454647176908, 393.42957158644674, 373.77576296897644, 598.9166591567846, 393.8530632199331, 370.894379142722, 57.24361164506949, 3.6374136739988248, 173.71047320310393, 151.640312914626, 594.5718143717976, 25.81623821463693, 195.38563872529923, 26.256871853728047, 392.2724671504124, 220.6031832522799, 0.0, 369.08113646596274, 241.96651050495245, 393.3710703499917, 116.15361614655636, 416.61608635029074, 50.04274354405423, 542.2131129050433, 79.2232184347813, 358.0919257337012, 451.5786390685449, 21.41398652890328, 378.84322087656494, 279.81823026146776, 169.6960024371935, 105.33058773517025, 464.74898700873183, 151.54794578911248, 136.0852145987097, 455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671, 325.84665877427216, 85.7743041215051, 364.1246529675091, 67.7561015665082, 83.51167029962173, 16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.52603251752086, "mean_inference_ms": 3.3635083880478414, "mean_action_processing_ms": 0.8733496031628681, "mean_env_wait_ms": 9.962565211234933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00844275951385498, "StateBufferConnector_ms": 0.00879824161529541, "ViewRequirementAgentConnector_ms": 0.11755752563476562}, "num_episodes": 11, "episode_return_max": 398.2, "episode_return_min": 52.7, "episode_return_mean": 221.457, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.23715672553735, "num_env_steps_trained_throughput_per_sec": 160.23715672553735, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 26279.797, "restore_workers_time_ms": 0.031, "training_step_time_ms": 26279.538, "sample_time_ms": 2004.837, "learn_time_ms": 24246.295, "learn_throughput": 164.974, "synch_weights_time_ms": 25.899}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "training_iteration": 79, "trial_id": "cbf82_00000", "date": "2024-08-21_13-41-21", "timestamp": 1724227881, "time_this_iter_s": 24.987140893936157, "time_total_s": 2054.868618965149, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e7e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2054.868618965149, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 29.617142857142856, "ram_util_percent": 81.25999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.020207837348183, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.549662341177464, "policy_loss": -0.007284387465430578, "vf_loss": 6.555017860730489, "vf_explained_var": 0.20006005689501763, "kl": 0.009644392531117773, "entropy": 0.7191021104032794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.4853715694199, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.1142093881964685, "policy_loss": -0.02446144157414286, "vf_loss": 7.135799377163251, "vf_explained_var": 0.17913404752810796, "kl": 0.014357171231677058, "entropy": 0.8373577851181229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 52.7, "episode_reward_mean": 222.72799999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -555.6003145828362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -53.986418749133755, "predator_policy": 276.71441874913376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.9, 115.39999999999995, 100.3, 68.40000000000002, 352.0, 396.3, 134.1, 129.1, 148.49999999999997, 382.9, 76.79999999999961, 101.2, 314.30000000000007, 243.1, 158.0, 86.1, 168.79999999999998, 203.79999999999976, 385.4, 117.4, 371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993, 340.0000000000002, 147.09999999999982, 184.19999999999996, 96.59999999999991, 155.2, 381.6, 60.400000000000034, 236.10000000000014, 64.69999999999996, 398.2, 161.0, 244.2, 397.0, 216.0, 127.1, 88.30000000000014, 109.39999999999992, 141.29999999999998, 192.0, 360.0, 298.79999999999995, 291.1, 265.00000000000006, 52.7, 378.0, 278.4, 385.2, 167.2, 217.39999999999998, 360.4, 168.2999999999999, 261.5, 188.99999999999994, 306.3999999999999, 102.89999999999982, 325.2, 132.10000000000002, 339.1, 139.19999999999996, 113.8999999999998, 386.0, 114.6999999999999, 217.00000000000003, 270.20000000000005, 351.0, 107.39999999999998, 272.6, 285.8000000000005, 104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2, 210.89999999999998, 330.7, 81.40000000000012, 351.0, 349.4, 375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7, 210.29999999999978, 298.5000000000001, 297.79999999999995, 230.29999999999995, 291.29999999999995, 221.49999999999994, 125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-409.91515077706157, -269.72430917140935, -481.14876927843454, -520.3079545804243, 293.5121005383879, 395.497252790905, -239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364, -436.3623769289565, -470.3405088020761, 185.1735371451033, -16.870531915014965, -258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428, 382.8912403034707, -376.1091552136775, 345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907, 272.7362266702808, -308.2356572479278, -203.73929621076059, -496.18081897514395, -251.75896116720725, 375.9369191281379, -555.6003145828362, 112.1699248870858, -495.5164044857149, 398.2, -265.10468534180643, -64.26343113738972, 394.2740241407002, -83.34546471769085, -266.3295715864467, -285.4757629689764, -489.5166591567843, -252.55306321993314, -178.89437914272213, 302.75638835493055, 295.16258632600113, 117.38952679689608, 113.35968708537378, -541.8718143717974, 352.183761785363, 83.0143612747008, 358.943128146272, -225.07246715041225, -3.203183252279814, 360.4, -200.78113646596265, 19.53348949504749, -204.37107034999175, 190.24638385344355, -313.7160863502901, 275.15725645594586, -410.11311290504284, 259.8767815652187, -218.89192573370144, -337.6786390685438, 364.58601347109675, -264.14322087656507, -62.81823026146773, 100.5039975628063, 245.66941226482976, -357.34898700873174, 121.05205421088753, 149.71478540129007, -350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293, -114.9466587742722, 244.92569587849493, -282.72465296750715, 283.2438984334918, 265.8883297003783, 358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426, -92.5931609506922, 173.1722934561079, 151.63013759891675, 4.073753721191082, 110.44792253647707, -10.597894350731332, -239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591], "policy_predator_policy_reward": [523.8151507770614, 385.12430917140927, 581.4487692784352, 588.7079545804244, 58.487899461612166, 0.8027472090949631, 373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384, 513.1623769289581, 571.5405088020761, 129.12646285489672, 259.97053191501493, 416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405, 2.5087596965293066, 493.5091552136774, 25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193, 67.2637733297196, 455.33565724792834, 387.9392962107602, 592.7808189751438, 406.9589611672073, 5.6630808718621, 616.0003145828358, 123.93007511291428, 560.2164044857149, 0.0, 426.1046853418064, 308.46343113738965, 2.725975859299783, 299.3454647176908, 393.42957158644674, 373.77576296897644, 598.9166591567846, 393.8530632199331, 370.894379142722, 57.24361164506949, 3.6374136739988248, 173.71047320310393, 151.640312914626, 594.5718143717976, 25.81623821463693, 195.38563872529923, 26.256871853728047, 392.2724671504124, 220.6031832522799, 0.0, 369.08113646596274, 241.96651050495245, 393.3710703499917, 116.15361614655636, 416.61608635029074, 50.04274354405423, 542.2131129050433, 79.2232184347813, 358.0919257337012, 451.5786390685449, 21.41398652890328, 378.84322087656494, 279.81823026146776, 169.6960024371935, 105.33058773517025, 464.74898700873183, 151.54794578911248, 136.0852145987097, 455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671, 325.84665877427216, 85.7743041215051, 364.1246529675091, 67.7561015665082, 83.51167029962173, 16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227, 302.8931609506917, 125.32770654389208, 146.16986240108318, 226.22624627880893, 180.85207746352302, 232.0978943507313, 365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.522661624092991, "mean_inference_ms": 3.3676409352478007, "mean_action_processing_ms": 0.8627129193645918, "mean_env_wait_ms": 9.954703286820395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00847005844116211, "StateBufferConnector_ms": 0.003088712692260742, "ViewRequirementAgentConnector_ms": 0.09741020202636719}, "num_episodes": 11, "episode_return_max": 398.2, "episode_return_min": 52.7, "episode_return_mean": 222.72799999999995, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.8021879834115, "num_env_steps_trained_throughput_per_sec": 156.8021879834115, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 26156.233, "restore_workers_time_ms": 0.024, "training_step_time_ms": 26155.976, "sample_time_ms": 1950.317, "learn_time_ms": 24176.946, "learn_throughput": 165.447, "synch_weights_time_ms": 25.863}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 80, "trial_id": "cbf82_00000", "date": "2024-08-21_13-41-46", "timestamp": 1724227906, "time_this_iter_s": 25.553489923477173, "time_total_s": 2080.422108888626, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e7e790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2080.422108888626, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 30.84722222222222, "ram_util_percent": 81.29444444444442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.147223439688484, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.174119231601556, "policy_loss": -0.008131345964890594, "vf_loss": 6.180521125098069, "vf_explained_var": 0.18491227043171723, "kl": 0.008647262687736657, "entropy": 0.6573997204502423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.817865534623463, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.091640709340572, "policy_loss": -0.02641335624308946, "vf_loss": 7.114849584301313, "vf_explained_var": 0.09531246665865183, "kl": 0.016022414341083882, "entropy": 0.8157714836299419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 52.7, "episode_reward_mean": 222.64700000000002, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -555.6003145828362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -49.376197833549234, "predator_policy": 272.02319783354926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.1, 129.1, 148.49999999999997, 382.9, 76.79999999999961, 101.2, 314.30000000000007, 243.1, 158.0, 86.1, 168.79999999999998, 203.79999999999976, 385.4, 117.4, 371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993, 340.0000000000002, 147.09999999999982, 184.19999999999996, 96.59999999999991, 155.2, 381.6, 60.400000000000034, 236.10000000000014, 64.69999999999996, 398.2, 161.0, 244.2, 397.0, 216.0, 127.1, 88.30000000000014, 109.39999999999992, 141.29999999999998, 192.0, 360.0, 298.79999999999995, 291.1, 265.00000000000006, 52.7, 378.0, 278.4, 385.2, 167.2, 217.39999999999998, 360.4, 168.2999999999999, 261.5, 188.99999999999994, 306.3999999999999, 102.89999999999982, 325.2, 132.10000000000002, 339.1, 139.19999999999996, 113.8999999999998, 386.0, 114.6999999999999, 217.00000000000003, 270.20000000000005, 351.0, 107.39999999999998, 272.6, 285.8000000000005, 104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2, 210.89999999999998, 330.7, 81.40000000000012, 351.0, 349.4, 375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7, 210.29999999999978, 298.5000000000001, 297.79999999999995, 230.29999999999995, 291.29999999999995, 221.49999999999994, 125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0, 309.1000000000005, 138.59999999999982, 193.0, 196.8999999999999, 244.1, 56.50000000000009], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-239.10344622589733, -261.64649469257995, -239.28665619771206, 368.47680339361364, -436.3623769289565, -470.3405088020761, 185.1735371451033, -16.870531915014965, -258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428, 382.8912403034707, -376.1091552136775, 345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907, 272.7362266702808, -308.2356572479278, -203.73929621076059, -496.18081897514395, -251.75896116720725, 375.9369191281379, -555.6003145828362, 112.1699248870858, -495.5164044857149, 398.2, -265.10468534180643, -64.26343113738972, 394.2740241407002, -83.34546471769085, -266.3295715864467, -285.4757629689764, -489.5166591567843, -252.55306321993314, -178.89437914272213, 302.75638835493055, 295.16258632600113, 117.38952679689608, 113.35968708537378, -541.8718143717974, 352.183761785363, 83.0143612747008, 358.943128146272, -225.07246715041225, -3.203183252279814, 360.4, -200.78113646596265, 19.53348949504749, -204.37107034999175, 190.24638385344355, -313.7160863502901, 275.15725645594586, -410.11311290504284, 259.8767815652187, -218.89192573370144, -337.6786390685438, 364.58601347109675, -264.14322087656507, -62.81823026146773, 100.5039975628063, 245.66941226482976, -357.34898700873174, 121.05205421088753, 149.71478540129007, -350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293, -114.9466587742722, 244.92569587849493, -282.72465296750715, 283.2438984334918, 265.8883297003783, 358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426, -92.5931609506922, 173.1722934561079, 151.63013759891675, 4.073753721191082, 110.44792253647707, -10.597894350731332, -239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591, 214.1974161951068, -163.83883134736368, -114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303], "policy_predator_policy_reward": [373.20344622589727, 390.74649469257986, 387.786656197712, 14.423196606386384, 513.1623769289581, 571.5405088020761, 129.12646285489672, 259.97053191501493, 416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405, 2.5087596965293066, 493.5091552136774, 25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193, 67.2637733297196, 455.33565724792834, 387.9392962107602, 592.7808189751438, 406.9589611672073, 5.6630808718621, 616.0003145828358, 123.93007511291428, 560.2164044857149, 0.0, 426.1046853418064, 308.46343113738965, 2.725975859299783, 299.3454647176908, 393.42957158644674, 373.77576296897644, 598.9166591567846, 393.8530632199331, 370.894379142722, 57.24361164506949, 3.6374136739988248, 173.71047320310393, 151.640312914626, 594.5718143717976, 25.81623821463693, 195.38563872529923, 26.256871853728047, 392.2724671504124, 220.6031832522799, 0.0, 369.08113646596274, 241.96651050495245, 393.3710703499917, 116.15361614655636, 416.61608635029074, 50.04274354405423, 542.2131129050433, 79.2232184347813, 358.0919257337012, 451.5786390685449, 21.41398652890328, 378.84322087656494, 279.81823026146776, 169.6960024371935, 105.33058773517025, 464.74898700873183, 151.54794578911248, 136.0852145987097, 455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671, 325.84665877427216, 85.7743041215051, 364.1246529675091, 67.7561015665082, 83.51167029962173, 16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227, 302.8931609506917, 125.32770654389208, 146.16986240108318, 226.22624627880893, 180.85207746352302, 232.0978943507313, 365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883, 94.90258380489318, 302.4388313473633, 307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5226132467795694, "mean_inference_ms": 3.3575475351405224, "mean_action_processing_ms": 0.8639053648488002, "mean_env_wait_ms": 9.968883083508313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008323431015014648, "StateBufferConnector_ms": 0.003098607063293457, "ViewRequirementAgentConnector_ms": 0.104819655418396}, "num_episodes": 6, "episode_return_max": 398.2, "episode_return_min": 52.7, "episode_return_mean": 222.64700000000002, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.5657605857964, "num_env_steps_trained_throughput_per_sec": 158.5657605857964, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 26041.739, "restore_workers_time_ms": 0.02, "training_step_time_ms": 26041.484, "sample_time_ms": 1944.773, "learn_time_ms": 24068.16, "learn_throughput": 166.195, "synch_weights_time_ms": 25.737}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 81, "trial_id": "cbf82_00000", "date": "2024-08-21_13-42-12", "timestamp": 1724227932, "time_this_iter_s": 25.260310649871826, "time_total_s": 2105.682419538498, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x307376040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2105.682419538498, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 29.733333333333334, "ram_util_percent": 81.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.201174496486783, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.456490786373616, "policy_loss": -0.005830821708271591, "vf_loss": 6.460762265821298, "vf_explained_var": 0.1499913204461336, "kl": 0.007796485294481196, "entropy": 0.6713352068327367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.503253682206074, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.0049932733178135, "policy_loss": -0.025992696008082326, "vf_loss": 7.027748442192872, "vf_explained_var": 0.12418220328787963, "kl": 0.01618748544230281, "entropy": 0.8209473749622702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 52.7, "episode_reward_mean": 222.59399999999997, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -555.6003145828362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -43.78063569370999, "predator_policy": 266.37463569371}, "custom_metrics": {}, "hist_stats": {"episode_reward": [158.0, 86.1, 168.79999999999998, 203.79999999999976, 385.4, 117.4, 371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993, 340.0000000000002, 147.09999999999982, 184.19999999999996, 96.59999999999991, 155.2, 381.6, 60.400000000000034, 236.10000000000014, 64.69999999999996, 398.2, 161.0, 244.2, 397.0, 216.0, 127.1, 88.30000000000014, 109.39999999999992, 141.29999999999998, 192.0, 360.0, 298.79999999999995, 291.1, 265.00000000000006, 52.7, 378.0, 278.4, 385.2, 167.2, 217.39999999999998, 360.4, 168.2999999999999, 261.5, 188.99999999999994, 306.3999999999999, 102.89999999999982, 325.2, 132.10000000000002, 339.1, 139.19999999999996, 113.8999999999998, 386.0, 114.6999999999999, 217.00000000000003, 270.20000000000005, 351.0, 107.39999999999998, 272.6, 285.8000000000005, 104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2, 210.89999999999998, 330.7, 81.40000000000012, 351.0, 349.4, 375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7, 210.29999999999978, 298.5000000000001, 297.79999999999995, 230.29999999999995, 291.29999999999995, 221.49999999999994, 125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0, 309.1000000000005, 138.59999999999982, 193.0, 196.8999999999999, 244.1, 56.50000000000009, 121.80000000000001, 88.10000000000015, 243.0, 149.50000000000003, 249.0, 309.1, 167.3, 196.89999999999998], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-258.3494161600571, -435.00312322620954, -170.60238187480405, -47.25088915581428, 382.8912403034707, -376.1091552136775, 345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907, 272.7362266702808, -308.2356572479278, -203.73929621076059, -496.18081897514395, -251.75896116720725, 375.9369191281379, -555.6003145828362, 112.1699248870858, -495.5164044857149, 398.2, -265.10468534180643, -64.26343113738972, 394.2740241407002, -83.34546471769085, -266.3295715864467, -285.4757629689764, -489.5166591567843, -252.55306321993314, -178.89437914272213, 302.75638835493055, 295.16258632600113, 117.38952679689608, 113.35968708537378, -541.8718143717974, 352.183761785363, 83.0143612747008, 358.943128146272, -225.07246715041225, -3.203183252279814, 360.4, -200.78113646596265, 19.53348949504749, -204.37107034999175, 190.24638385344355, -313.7160863502901, 275.15725645594586, -410.11311290504284, 259.8767815652187, -218.89192573370144, -337.6786390685438, 364.58601347109675, -264.14322087656507, -62.81823026146773, 100.5039975628063, 245.66941226482976, -357.34898700873174, 121.05205421088753, 149.71478540129007, -350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293, -114.9466587742722, 244.92569587849493, -282.72465296750715, 283.2438984334918, 265.8883297003783, 358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426, -92.5931609506922, 173.1722934561079, 151.63013759891675, 4.073753721191082, 110.44792253647707, -10.597894350731332, -239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591, 214.1974161951068, -163.83883134736368, -114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303, -255.20070452384272, -36.60639096558103, 25.42981724439086, -190.5492718206215, 28.333504015585785, 181.4096757490718, -190.0791825465502, -113.14090739204971], "policy_predator_policy_reward": [416.34941616005716, 521.1031232262094, 339.40238187480384, 251.05088915581405, 2.5087596965293066, 493.5091552136774, 25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193, 67.2637733297196, 455.33565724792834, 387.9392962107602, 592.7808189751438, 406.9589611672073, 5.6630808718621, 616.0003145828358, 123.93007511291428, 560.2164044857149, 0.0, 426.1046853418064, 308.46343113738965, 2.725975859299783, 299.3454647176908, 393.42957158644674, 373.77576296897644, 598.9166591567846, 393.8530632199331, 370.894379142722, 57.24361164506949, 3.6374136739988248, 173.71047320310393, 151.640312914626, 594.5718143717976, 25.81623821463693, 195.38563872529923, 26.256871853728047, 392.2724671504124, 220.6031832522799, 0.0, 369.08113646596274, 241.96651050495245, 393.3710703499917, 116.15361614655636, 416.61608635029074, 50.04274354405423, 542.2131129050433, 79.2232184347813, 358.0919257337012, 451.5786390685449, 21.41398652890328, 378.84322087656494, 279.81823026146776, 169.6960024371935, 105.33058773517025, 464.74898700873183, 151.54794578911248, 136.0852145987097, 455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671, 325.84665877427216, 85.7743041215051, 364.1246529675091, 67.7561015665082, 83.51167029962173, 16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227, 302.8931609506917, 125.32770654389208, 146.16986240108318, 226.22624627880893, 180.85207746352302, 232.0978943507313, 365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883, 94.90258380489318, 302.4388313473633, 307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286, 377.0007045238429, 124.70639096558124, 217.57018275560915, 340.0492718206214, 220.6664959844141, 127.69032425092811, 357.37918254655034, 310.04090739204963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5200786757669453, "mean_inference_ms": 3.355747092184182, "mean_action_processing_ms": 0.8600141696248024, "mean_env_wait_ms": 9.971950062940552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008383989334106445, "StateBufferConnector_ms": 0.0031141042709350586, "ViewRequirementAgentConnector_ms": 0.10773992538452148}, "num_episodes": 8, "episode_return_max": 398.2, "episode_return_min": 52.7, "episode_return_mean": 222.59399999999997, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.12014920612313, "num_env_steps_trained_throughput_per_sec": 157.12014920612313, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 26010.817, "restore_workers_time_ms": 0.021, "training_step_time_ms": 26010.556, "sample_time_ms": 1948.989, "learn_time_ms": 24032.79, "learn_throughput": 166.439, "synch_weights_time_ms": 26.002}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 82, "trial_id": "cbf82_00000", "date": "2024-08-21_13-42-37", "timestamp": 1724227957, "time_this_iter_s": 25.466862201690674, "time_total_s": 2131.1492817401886, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075b8790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2131.1492817401886, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 30.324324324324323, "ram_util_percent": 81.09729729729729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.368948406353593, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.635930732885996, "policy_loss": -0.011039464897476137, "vf_loss": 5.644717478752137, "vf_explained_var": 0.18936579364041486, "kl": 0.011263579808413245, "entropy": 0.7322556067879001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.264252038796743, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.621773185332616, "policy_loss": -0.02244322418482625, "vf_loss": 6.6418000941475235, "vf_explained_var": 0.006451695971190929, "kl": 0.01208166833918464, "entropy": 0.8423462320119143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 52.7, "episode_reward_mean": 225.55599999999998, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -555.6003145828362, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 640.0581729944419}, "policy_reward_mean": {"prey_policy": -33.51114081278511, "predator_policy": 259.0671408127851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.1, 190.89999999999995, 363.0, 181.10000000000002, 96.10000000000002, 202.79999999999993, 340.0000000000002, 147.09999999999982, 184.19999999999996, 96.59999999999991, 155.2, 381.6, 60.400000000000034, 236.10000000000014, 64.69999999999996, 398.2, 161.0, 244.2, 397.0, 216.0, 127.1, 88.30000000000014, 109.39999999999992, 141.29999999999998, 192.0, 360.0, 298.79999999999995, 291.1, 265.00000000000006, 52.7, 378.0, 278.4, 385.2, 167.2, 217.39999999999998, 360.4, 168.2999999999999, 261.5, 188.99999999999994, 306.3999999999999, 102.89999999999982, 325.2, 132.10000000000002, 339.1, 139.19999999999996, 113.8999999999998, 386.0, 114.6999999999999, 217.00000000000003, 270.20000000000005, 351.0, 107.39999999999998, 272.6, 285.8000000000005, 104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2, 210.89999999999998, 330.7, 81.40000000000012, 351.0, 349.4, 375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7, 210.29999999999978, 298.5000000000001, 297.79999999999995, 230.29999999999995, 291.29999999999995, 221.49999999999994, 125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0, 309.1000000000005, 138.59999999999982, 193.0, 196.8999999999999, 244.1, 56.50000000000009, 121.80000000000001, 88.10000000000015, 243.0, 149.50000000000003, 249.0, 309.1, 167.3, 196.89999999999998, 350.4, 180.29999999999993, 243.79999999999987, 211.2, 275.0, 154.99999999999983], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [345.1950760115568, -221.97433839030433, 291.0586726508026, -156.67040287577566, -543.9581729944415, -120.64194118781907, 272.7362266702808, -308.2356572479278, -203.73929621076059, -496.18081897514395, -251.75896116720725, 375.9369191281379, -555.6003145828362, 112.1699248870858, -495.5164044857149, 398.2, -265.10468534180643, -64.26343113738972, 394.2740241407002, -83.34546471769085, -266.3295715864467, -285.4757629689764, -489.5166591567843, -252.55306321993314, -178.89437914272213, 302.75638835493055, 295.16258632600113, 117.38952679689608, 113.35968708537378, -541.8718143717974, 352.183761785363, 83.0143612747008, 358.943128146272, -225.07246715041225, -3.203183252279814, 360.4, -200.78113646596265, 19.53348949504749, -204.37107034999175, 190.24638385344355, -313.7160863502901, 275.15725645594586, -410.11311290504284, 259.8767815652187, -218.89192573370144, -337.6786390685438, 364.58601347109675, -264.14322087656507, -62.81823026146773, 100.5039975628063, 245.66941226482976, -357.34898700873174, 121.05205421088753, 149.71478540129007, -350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293, -114.9466587742722, 244.92569587849493, -282.72465296750715, 283.2438984334918, 265.8883297003783, 358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426, -92.5931609506922, 173.1722934561079, 151.63013759891675, 4.073753721191082, 110.44792253647707, -10.597894350731332, -239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591, 214.1974161951068, -163.83883134736368, -114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303, -255.20070452384272, -36.60639096558103, 25.42981724439086, -190.5492718206215, 28.333504015585785, 181.4096757490718, -190.0791825465502, -113.14090739204971, 283.9105615008327, -129.02234101346974, 59.67203046357031, -108.99850208412367, 113.02531134152467, -96.06129744293872], "policy_predator_policy_reward": [25.904923988443237, 412.8743383903042, 71.9413273491974, 337.7704028757758, 640.0581729944419, 323.4419411878193, 67.2637733297196, 455.33565724792834, 387.9392962107602, 592.7808189751438, 406.9589611672073, 5.6630808718621, 616.0003145828358, 123.93007511291428, 560.2164044857149, 0.0, 426.1046853418064, 308.46343113738965, 2.725975859299783, 299.3454647176908, 393.42957158644674, 373.77576296897644, 598.9166591567846, 393.8530632199331, 370.894379142722, 57.24361164506949, 3.6374136739988248, 173.71047320310393, 151.640312914626, 594.5718143717976, 25.81623821463693, 195.38563872529923, 26.256871853728047, 392.2724671504124, 220.6031832522799, 0.0, 369.08113646596274, 241.96651050495245, 393.3710703499917, 116.15361614655636, 416.61608635029074, 50.04274354405423, 542.2131129050433, 79.2232184347813, 358.0919257337012, 451.5786390685449, 21.41398652890328, 378.84322087656494, 279.81823026146776, 169.6960024371935, 105.33058773517025, 464.74898700873183, 151.54794578911248, 136.0852145987097, 455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671, 325.84665877427216, 85.7743041215051, 364.1246529675091, 67.7561015665082, 83.51167029962173, 16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227, 302.8931609506917, 125.32770654389208, 146.16986240108318, 226.22624627880893, 180.85207746352302, 232.0978943507313, 365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883, 94.90258380489318, 302.4388313473633, 307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286, 377.0007045238429, 124.70639096558124, 217.57018275560915, 340.0492718206214, 220.6664959844141, 127.69032425092811, 357.37918254655034, 310.04090739204963, 66.48943849916729, 309.32234101346944, 184.1279695364296, 320.19850208412356, 161.97468865847546, 251.06129744293867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5180801060450793, "mean_inference_ms": 3.3585700834130794, "mean_action_processing_ms": 0.850936902292285, "mean_env_wait_ms": 9.963771895894931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00835883617401123, "StateBufferConnector_ms": 0.0031156539916992188, "ViewRequirementAgentConnector_ms": 0.10868120193481445}, "num_episodes": 6, "episode_return_max": 398.2, "episode_return_min": 52.7, "episode_return_mean": 225.55599999999998, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.48594515326837, "num_env_steps_trained_throughput_per_sec": 155.48594515326837, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 25783.855, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25783.617, "sample_time_ms": 1897.541, "learn_time_ms": 23857.436, "learn_throughput": 167.663, "synch_weights_time_ms": 26.106}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "training_iteration": 83, "trial_id": "cbf82_00000", "date": "2024-08-21_13-43-03", "timestamp": 1724227983, "time_this_iter_s": 25.791558980941772, "time_total_s": 2156.9408407211304, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e34040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2156.9408407211304, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 32.13333333333333, "ram_util_percent": 82.12222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.241429440677166, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.027638730406761, "policy_loss": -0.008921622509660665, "vf_loss": 6.034196162472169, "vf_explained_var": 0.19714305040736993, "kl": 0.01182087406195933, "entropy": 0.7785593011726936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.107212021574377, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.343405319750309, "policy_loss": -0.024633960691668715, "vf_loss": 7.365403365095457, "vf_explained_var": 0.16964267635097105, "kl": 0.013179428878841767, "entropy": 0.8712024761363864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 52.7, "episode_reward_mean": 223.407, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -541.8718143717974, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 637.8788986077238}, "policy_reward_mean": {"prey_policy": -29.2148326183742, "predator_policy": 252.62183261837424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [236.10000000000014, 64.69999999999996, 398.2, 161.0, 244.2, 397.0, 216.0, 127.1, 88.30000000000014, 109.39999999999992, 141.29999999999998, 192.0, 360.0, 298.79999999999995, 291.1, 265.00000000000006, 52.7, 378.0, 278.4, 385.2, 167.2, 217.39999999999998, 360.4, 168.2999999999999, 261.5, 188.99999999999994, 306.3999999999999, 102.89999999999982, 325.2, 132.10000000000002, 339.1, 139.19999999999996, 113.8999999999998, 386.0, 114.6999999999999, 217.00000000000003, 270.20000000000005, 351.0, 107.39999999999998, 272.6, 285.8000000000005, 104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2, 210.89999999999998, 330.7, 81.40000000000012, 351.0, 349.4, 375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7, 210.29999999999978, 298.5000000000001, 297.79999999999995, 230.29999999999995, 291.29999999999995, 221.49999999999994, 125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0, 309.1000000000005, 138.59999999999982, 193.0, 196.8999999999999, 244.1, 56.50000000000009, 121.80000000000001, 88.10000000000015, 243.0, 149.50000000000003, 249.0, 309.1, 167.3, 196.89999999999998, 350.4, 180.29999999999993, 243.79999999999987, 211.2, 275.0, 154.99999999999983, 103.20000000000002, 375.3, 94.00000000000004, 145.7, 211.4, 309.00000000000006, 104.8999999999998, 245.9999999999999, 183.0, 114.29999999999978, 222.2, 273.5, 172.69999999999996], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [112.1699248870858, -495.5164044857149, 398.2, -265.10468534180643, -64.26343113738972, 394.2740241407002, -83.34546471769085, -266.3295715864467, -285.4757629689764, -489.5166591567843, -252.55306321993314, -178.89437914272213, 302.75638835493055, 295.16258632600113, 117.38952679689608, 113.35968708537378, -541.8718143717974, 352.183761785363, 83.0143612747008, 358.943128146272, -225.07246715041225, -3.203183252279814, 360.4, -200.78113646596265, 19.53348949504749, -204.37107034999175, 190.24638385344355, -313.7160863502901, 275.15725645594586, -410.11311290504284, 259.8767815652187, -218.89192573370144, -337.6786390685438, 364.58601347109675, -264.14322087656507, -62.81823026146773, 100.5039975628063, 245.66941226482976, -357.34898700873174, 121.05205421088753, 149.71478540129007, -350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293, -114.9466587742722, 244.92569587849493, -282.72465296750715, 283.2438984334918, 265.8883297003783, 358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426, -92.5931609506922, 173.1722934561079, 151.63013759891675, 4.073753721191082, 110.44792253647707, -10.597894350731332, -239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591, 214.1974161951068, -163.83883134736368, -114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303, -255.20070452384272, -36.60639096558103, 25.42981724439086, -190.5492718206215, 28.333504015585785, 181.4096757490718, -190.0791825465502, -113.14090739204971, 283.9105615008327, -129.02234101346974, 59.67203046357031, -108.99850208412367, 113.02531134152467, -96.06129744293872, -416.3894926027636, 366.0255996780056, -244.8100849227072, -269.6465534808754, -18.05775621762301, 234.58087841515268, -240.72254498042636, 39.80613516447536, -166.62531502796503, -275.6472183030759, 1.179685286714971, 44.40166823860059, -198.29719097785872], "policy_predator_policy_reward": [123.93007511291428, 560.2164044857149, 0.0, 426.1046853418064, 308.46343113738965, 2.725975859299783, 299.3454647176908, 393.42957158644674, 373.77576296897644, 598.9166591567846, 393.8530632199331, 370.894379142722, 57.24361164506949, 3.6374136739988248, 173.71047320310393, 151.640312914626, 594.5718143717976, 25.81623821463693, 195.38563872529923, 26.256871853728047, 392.2724671504124, 220.6031832522799, 0.0, 369.08113646596274, 241.96651050495245, 393.3710703499917, 116.15361614655636, 416.61608635029074, 50.04274354405423, 542.2131129050433, 79.2232184347813, 358.0919257337012, 451.5786390685449, 21.41398652890328, 378.84322087656494, 279.81823026146776, 169.6960024371935, 105.33058773517025, 464.74898700873183, 151.54794578911248, 136.0852145987097, 455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671, 325.84665877427216, 85.7743041215051, 364.1246529675091, 67.7561015665082, 83.51167029962173, 16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227, 302.8931609506917, 125.32770654389208, 146.16986240108318, 226.22624627880893, 180.85207746352302, 232.0978943507313, 365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883, 94.90258380489318, 302.4388313473633, 307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286, 377.0007045238429, 124.70639096558124, 217.57018275560915, 340.0492718206214, 220.6664959844141, 127.69032425092811, 357.37918254655034, 310.04090739204963, 66.48943849916729, 309.32234101346944, 184.1279695364296, 320.19850208412356, 161.97468865847546, 251.06129744293867, 519.5894926027638, 9.27440032199434, 338.81008492270706, 415.3465534808752, 229.45775621762303, 74.41912158484733, 345.62254498042614, 206.19386483552466, 349.62531502796486, 389.9472183030766, 221.0203147132847, 229.0983317613995, 370.9971909778587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5109415430008566, "mean_inference_ms": 3.351643704178246, "mean_action_processing_ms": 0.8476046328985997, "mean_env_wait_ms": 9.962093232500663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011247515678405762, "StateBufferConnector_ms": 0.002942800521850586, "ViewRequirementAgentConnector_ms": 0.12231528759002686}, "num_episodes": 13, "episode_return_max": 398.2, "episode_return_min": 52.7, "episode_return_mean": 223.407, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.3500690990235, "num_env_steps_trained_throughput_per_sec": 150.3500690990235, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 25569.641, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25569.409, "sample_time_ms": 1847.556, "learn_time_ms": 23692.517, "learn_throughput": 168.83, "synch_weights_time_ms": 26.957}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 84, "trial_id": "cbf82_00000", "date": "2024-08-21_13-43-30", "timestamp": 1724228010, "time_this_iter_s": 26.65981698036194, "time_total_s": 2183.6006577014923, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177ebd0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2183.6006577014923, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 35.21315789473684, "ram_util_percent": 82.40263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.159298482288917, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.047982836763064, "policy_loss": -0.008949763373918056, "vf_loss": 6.055017755925656, "vf_explained_var": 0.20148298175384602, "kl": 0.009574298744701082, "entropy": 0.6637539835646749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.671673064306379, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.037531884014607, "policy_loss": -0.0218798268562144, "vf_loss": 7.05663191229105, "vf_explained_var": 0.006804281411071618, "kl": 0.01389896069158567, "entropy": 0.8089664492756128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": 52.7, "episode_reward_mean": 219.52899999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -541.8718143717974, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 370.5781468085591, "predator_policy": 637.8788986077238}, "policy_reward_mean": {"prey_policy": -31.266229710475596, "predator_policy": 250.7952297104756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [265.00000000000006, 52.7, 378.0, 278.4, 385.2, 167.2, 217.39999999999998, 360.4, 168.2999999999999, 261.5, 188.99999999999994, 306.3999999999999, 102.89999999999982, 325.2, 132.10000000000002, 339.1, 139.19999999999996, 113.8999999999998, 386.0, 114.6999999999999, 217.00000000000003, 270.20000000000005, 351.0, 107.39999999999998, 272.6, 285.8000000000005, 104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2, 210.89999999999998, 330.7, 81.40000000000012, 351.0, 349.4, 375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7, 210.29999999999978, 298.5000000000001, 297.79999999999995, 230.29999999999995, 291.29999999999995, 221.49999999999994, 125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0, 309.1000000000005, 138.59999999999982, 193.0, 196.8999999999999, 244.1, 56.50000000000009, 121.80000000000001, 88.10000000000015, 243.0, 149.50000000000003, 249.0, 309.1, 167.3, 196.89999999999998, 350.4, 180.29999999999993, 243.79999999999987, 211.2, 275.0, 154.99999999999983, 103.20000000000002, 375.3, 94.00000000000004, 145.7, 211.4, 309.00000000000006, 104.8999999999998, 245.9999999999999, 183.0, 114.29999999999978, 222.2, 273.5, 172.69999999999996, 195.49999999999997, 236.39999999999998, 303.6, 135.79999999999998, 60.900000000000006, 210.39999999999992, 119.00000000000003, 129.09999999999982, 187.2, 241.09999999999994, 214.7999999999998, 298.6, 221.49999999999997, 204.79999999999973, 178.7], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [113.35968708537378, -541.8718143717974, 352.183761785363, 83.0143612747008, 358.943128146272, -225.07246715041225, -3.203183252279814, 360.4, -200.78113646596265, 19.53348949504749, -204.37107034999175, 190.24638385344355, -313.7160863502901, 275.15725645594586, -410.11311290504284, 259.8767815652187, -218.89192573370144, -337.6786390685438, 364.58601347109675, -264.14322087656507, -62.81823026146773, 100.5039975628063, 245.66941226482976, -357.34898700873174, 121.05205421088753, 149.71478540129007, -350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293, -114.9466587742722, 244.92569587849493, -282.72465296750715, 283.2438984334918, 265.8883297003783, 358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426, -92.5931609506922, 173.1722934561079, 151.63013759891675, 4.073753721191082, 110.44792253647707, -10.597894350731332, -239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591, 214.1974161951068, -163.83883134736368, -114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303, -255.20070452384272, -36.60639096558103, 25.42981724439086, -190.5492718206215, 28.333504015585785, 181.4096757490718, -190.0791825465502, -113.14090739204971, 283.9105615008327, -129.02234101346974, 59.67203046357031, -108.99850208412367, 113.02531134152467, -96.06129744293872, -416.3894926027636, 366.0255996780056, -244.8100849227072, -269.6465534808754, -18.05775621762301, 234.58087841515268, -240.72254498042636, 39.80613516447536, -166.62531502796503, -275.6472183030759, 1.179685286714971, 44.40166823860059, -198.29719097785872, 12.25287065826981, -64.95691719730847, 232.70477693790394, -215.62978861959647, -416.94799848798255, -28.56708584257597, -341.95621078206693, -207.67499182381263, -110.72184687120055, 65.46608621631981, 12.215394875487025, 182.4394844238611, 0.22845860928559247, -1.3428988808463718, -83.69601367772836], "policy_predator_policy_reward": [151.640312914626, 594.5718143717976, 25.81623821463693, 195.38563872529923, 26.256871853728047, 392.2724671504124, 220.6031832522799, 0.0, 369.08113646596274, 241.96651050495245, 393.3710703499917, 116.15361614655636, 416.61608635029074, 50.04274354405423, 542.2131129050433, 79.2232184347813, 358.0919257337012, 451.5786390685449, 21.41398652890328, 378.84322087656494, 279.81823026146776, 169.6960024371935, 105.33058773517025, 464.74898700873183, 151.54794578911248, 136.0852145987097, 455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671, 325.84665877427216, 85.7743041215051, 364.1246529675091, 67.7561015665082, 83.51167029962173, 16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227, 302.8931609506917, 125.32770654389208, 146.16986240108318, 226.22624627880893, 180.85207746352302, 232.0978943507313, 365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883, 94.90258380489318, 302.4388313473633, 307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286, 377.0007045238429, 124.70639096558124, 217.57018275560915, 340.0492718206214, 220.6664959844141, 127.69032425092811, 357.37918254655034, 310.04090739204963, 66.48943849916729, 309.32234101346944, 184.1279695364296, 320.19850208412356, 161.97468865847546, 251.06129744293867, 519.5894926027638, 9.27440032199434, 338.81008492270706, 415.3465534808752, 229.45775621762303, 74.41912158484733, 345.62254498042614, 206.19386483552466, 349.62531502796486, 389.9472183030766, 221.0203147132847, 229.0983317613995, 370.9971909778587, 183.24712934173024, 301.3569171973084, 70.89522306209635, 351.42978861959614, 477.84799848798264, 238.9670858425759, 460.9562107820668, 336.77499182381234, 297.9218468712004, 175.63391378368007, 202.5846051245128, 116.16051557613885, 221.2715413907145, 206.1428988808463, 262.3960136777285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5040839166800577, "mean_inference_ms": 3.3442147268799323, "mean_action_processing_ms": 0.8443553805263037, "mean_env_wait_ms": 9.960570679087628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006049990653991699, "StateBufferConnector_ms": 0.0028829574584960938, "ViewRequirementAgentConnector_ms": 0.1088646650314331}, "num_episodes": 15, "episode_return_max": 386.0, "episode_return_min": 52.7, "episode_return_mean": 219.52899999999994, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.80376493814575, "num_env_steps_trained_throughput_per_sec": 147.80376493814575, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 25713.833, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25713.679, "sample_time_ms": 1883.249, "learn_time_ms": 23802.662, "learn_throughput": 168.048, "synch_weights_time_ms": 25.198}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 85, "trial_id": "cbf82_00000", "date": "2024-08-21_13-43-57", "timestamp": 1724228037, "time_this_iter_s": 27.115598917007446, "time_total_s": 2210.7162566184998, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177ebd040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2210.7162566184998, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 36.35641025641025, "ram_util_percent": 82.22820512820513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.348600045219063, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.397933134933313, "policy_loss": -0.004484261838418509, "vf_loss": 6.4006810506184895, "vf_explained_var": 0.13076703262825806, "kl": 0.00868159934761934, "entropy": 0.7188924582675099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.488743703315656, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.196547608077526, "policy_loss": -0.021155187883414327, "vf_loss": 7.214938504993915, "vf_explained_var": -0.02368090668072303, "kl": 0.013821545739483554, "entropy": 0.8128383414198955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 393.2, "episode_reward_min": 55.5, "episode_reward_mean": 214.253, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 9.27440032199434}, "policy_reward_max": {"prey_policy": 378.82221124744996, "predator_policy": 637.8788986077238}, "policy_reward_mean": {"prey_policy": -42.46189864227874, "predator_policy": 256.71489864227874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.3999999999999, 102.89999999999982, 325.2, 132.10000000000002, 339.1, 139.19999999999996, 113.8999999999998, 386.0, 114.6999999999999, 217.00000000000003, 270.20000000000005, 351.0, 107.39999999999998, 272.6, 285.8000000000005, 104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2, 210.89999999999998, 330.7, 81.40000000000012, 351.0, 349.4, 375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7, 210.29999999999978, 298.5000000000001, 297.79999999999995, 230.29999999999995, 291.29999999999995, 221.49999999999994, 125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0, 309.1000000000005, 138.59999999999982, 193.0, 196.8999999999999, 244.1, 56.50000000000009, 121.80000000000001, 88.10000000000015, 243.0, 149.50000000000003, 249.0, 309.1, 167.3, 196.89999999999998, 350.4, 180.29999999999993, 243.79999999999987, 211.2, 275.0, 154.99999999999983, 103.20000000000002, 375.3, 94.00000000000004, 145.7, 211.4, 309.00000000000006, 104.8999999999998, 245.9999999999999, 183.0, 114.29999999999978, 222.2, 273.5, 172.69999999999996, 195.49999999999997, 236.39999999999998, 303.6, 135.79999999999998, 60.900000000000006, 210.39999999999992, 119.00000000000003, 129.09999999999982, 187.2, 241.09999999999994, 214.7999999999998, 298.6, 221.49999999999997, 204.79999999999973, 178.7, 191.19999999999993, 192.69999999999996, 393.2, 233.7999999999999, 81.49999999999983, 279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [190.24638385344355, -313.7160863502901, 275.15725645594586, -410.11311290504284, 259.8767815652187, -218.89192573370144, -337.6786390685438, 364.58601347109675, -264.14322087656507, -62.81823026146773, 100.5039975628063, 245.66941226482976, -357.34898700873174, 121.05205421088753, 149.71478540129007, -350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293, -114.9466587742722, 244.92569587849493, -282.72465296750715, 283.2438984334918, 265.8883297003783, 358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426, -92.5931609506922, 173.1722934561079, 151.63013759891675, 4.073753721191082, 110.44792253647707, -10.597894350731332, -239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591, 214.1974161951068, -163.83883134736368, -114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303, -255.20070452384272, -36.60639096558103, 25.42981724439086, -190.5492718206215, 28.333504015585785, 181.4096757490718, -190.0791825465502, -113.14090739204971, 283.9105615008327, -129.02234101346974, 59.67203046357031, -108.99850208412367, 113.02531134152467, -96.06129744293872, -416.3894926027636, 366.0255996780056, -244.8100849227072, -269.6465534808754, -18.05775621762301, 234.58087841515268, -240.72254498042636, 39.80613516447536, -166.62531502796503, -275.6472183030759, 1.179685286714971, 44.40166823860059, -198.29719097785872, 12.25287065826981, -64.95691719730847, 232.70477693790394, -215.62978861959647, -416.94799848798255, -28.56708584257597, -341.95621078206693, -207.67499182381263, -110.72184687120055, 65.46608621631981, 12.215394875487025, 182.4394844238611, 0.22845860928559247, -1.3428988808463718, -83.69601367772836, -191.56542147633462, -126.21113468127075, 378.82221124744996, 8.863219844183995, -345.88865682326406, 211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076], "policy_predator_policy_reward": [116.15361614655636, 416.61608635029074, 50.04274354405423, 542.2131129050433, 79.2232184347813, 358.0919257337012, 451.5786390685449, 21.41398652890328, 378.84322087656494, 279.81823026146776, 169.6960024371935, 105.33058773517025, 464.74898700873183, 151.54794578911248, 136.0852145987097, 455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671, 325.84665877427216, 85.7743041215051, 364.1246529675091, 67.7561015665082, 83.51167029962173, 16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227, 302.8931609506917, 125.32770654389208, 146.16986240108318, 226.22624627880893, 180.85207746352302, 232.0978943507313, 365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883, 94.90258380489318, 302.4388313473633, 307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286, 377.0007045238429, 124.70639096558124, 217.57018275560915, 340.0492718206214, 220.6664959844141, 127.69032425092811, 357.37918254655034, 310.04090739204963, 66.48943849916729, 309.32234101346944, 184.1279695364296, 320.19850208412356, 161.97468865847546, 251.06129744293867, 519.5894926027638, 9.27440032199434, 338.81008492270706, 415.3465534808752, 229.45775621762303, 74.41912158484733, 345.62254498042614, 206.19386483552466, 349.62531502796486, 389.9472183030766, 221.0203147132847, 229.0983317613995, 370.9971909778587, 183.24712934173024, 301.3569171973084, 70.89522306209635, 351.42978861959614, 477.84799848798264, 238.9670858425759, 460.9562107820668, 336.77499182381234, 297.9218468712004, 175.63391378368007, 202.5846051245128, 116.16051557613885, 221.2715413907145, 206.1428988808463, 262.3960136777285, 382.7654214763345, 318.91113468127065, 14.377788752550034, 224.93678015581585, 427.388656823265, 67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.50444036342508, "mean_inference_ms": 3.332812139685526, "mean_action_processing_ms": 0.8509566113851325, "mean_env_wait_ms": 9.959001760942446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005943894386291504, "StateBufferConnector_ms": 0.0028297901153564453, "ViewRequirementAgentConnector_ms": 0.10785412788391113}, "num_episodes": 11, "episode_return_max": 393.2, "episode_return_min": 55.5, "episode_return_mean": 214.253, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.94437725515928, "num_env_steps_trained_throughput_per_sec": 153.94437725515928, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 25726.637, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25726.483, "sample_time_ms": 1920.951, "learn_time_ms": 23777.333, "learn_throughput": 168.227, "synch_weights_time_ms": 25.461}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 86, "trial_id": "cbf82_00000", "date": "2024-08-21_13-44-23", "timestamp": 1724228063, "time_this_iter_s": 26.02142596244812, "time_total_s": 2236.737682580948, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17bf0a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2236.737682580948, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 31.081081081081074, "ram_util_percent": 81.10000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.211814086015026, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.753420463701089, "policy_loss": -0.00692921711015515, "vf_loss": 6.758599259455999, "vf_explained_var": 0.08315163099517425, "kl": 0.008751931558557165, "entropy": 0.6291306434199214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.633477733035882, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.364988692104816, "policy_loss": -0.024770539295665608, "vf_loss": 7.3870943690339725, "vf_explained_var": 0.10554722826927901, "kl": 0.01332433225955659, "entropy": 0.7650665545836091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 492.9400000000023}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 393.2, "episode_reward_min": 55.5, "episode_reward_mean": 214.136, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 9.27440032199434}, "policy_reward_max": {"prey_policy": 378.82221124744996, "predator_policy": 637.8788986077238}, "policy_reward_mean": {"prey_policy": -38.57022628164736, "predator_policy": 252.70622628164736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.20000000000005, 351.0, 107.39999999999998, 272.6, 285.8000000000005, 104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2, 210.89999999999998, 330.7, 81.40000000000012, 351.0, 349.4, 375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7, 210.29999999999978, 298.5000000000001, 297.79999999999995, 230.29999999999995, 291.29999999999995, 221.49999999999994, 125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0, 309.1000000000005, 138.59999999999982, 193.0, 196.8999999999999, 244.1, 56.50000000000009, 121.80000000000001, 88.10000000000015, 243.0, 149.50000000000003, 249.0, 309.1, 167.3, 196.89999999999998, 350.4, 180.29999999999993, 243.79999999999987, 211.2, 275.0, 154.99999999999983, 103.20000000000002, 375.3, 94.00000000000004, 145.7, 211.4, 309.00000000000006, 104.8999999999998, 245.9999999999999, 183.0, 114.29999999999978, 222.2, 273.5, 172.69999999999996, 195.49999999999997, 236.39999999999998, 303.6, 135.79999999999998, 60.900000000000006, 210.39999999999992, 119.00000000000003, 129.09999999999982, 187.2, 241.09999999999994, 214.7999999999998, 298.6, 221.49999999999997, 204.79999999999973, 178.7, 191.19999999999993, 192.69999999999996, 393.2, 233.7999999999999, 81.49999999999983, 279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984, 307.20000000000005, 179.99999999999997, 196.7999999999995, 350.0, 138.49999999999991, 173.8, 119.90000000000003, 200.09999999999954, 317.4, 181.10000000000002], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [100.5039975628063, 245.66941226482976, -357.34898700873174, 121.05205421088753, 149.71478540129007, -350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293, -114.9466587742722, 244.92569587849493, -282.72465296750715, 283.2438984334918, 265.8883297003783, 358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426, -92.5931609506922, 173.1722934561079, 151.63013759891675, 4.073753721191082, 110.44792253647707, -10.597894350731332, -239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591, 214.1974161951068, -163.83883134736368, -114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303, -255.20070452384272, -36.60639096558103, 25.42981724439086, -190.5492718206215, 28.333504015585785, 181.4096757490718, -190.0791825465502, -113.14090739204971, 283.9105615008327, -129.02234101346974, 59.67203046357031, -108.99850208412367, 113.02531134152467, -96.06129744293872, -416.3894926027636, 366.0255996780056, -244.8100849227072, -269.6465534808754, -18.05775621762301, 234.58087841515268, -240.72254498042636, 39.80613516447536, -166.62531502796503, -275.6472183030759, 1.179685286714971, 44.40166823860059, -198.29719097785872, 12.25287065826981, -64.95691719730847, 232.70477693790394, -215.62978861959647, -416.94799848798255, -28.56708584257597, -341.95621078206693, -207.67499182381263, -110.72184687120055, 65.46608621631981, 12.215394875487025, 182.4394844238611, 0.22845860928559247, -1.3428988808463718, -83.69601367772836, -191.56542147633462, -126.21113468127075, 378.82221124744996, 8.863219844183995, -345.88865682326406, 211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076, 162.39000175545462, -103.66710346648173, -12.297262919393631, 281.8834214250447, -192.62165010033627, -103.23094530352151, -275.07498121453676, 12.000268534732204, 235.5600536779543, -133.26934617568398], "policy_predator_policy_reward": [169.6960024371935, 105.33058773517025, 464.74898700873183, 151.54794578911248, 136.0852145987097, 455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671, 325.84665877427216, 85.7743041215051, 364.1246529675091, 67.7561015665082, 83.51167029962173, 16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227, 302.8931609506917, 125.32770654389208, 146.16986240108318, 226.22624627880893, 180.85207746352302, 232.0978943507313, 365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883, 94.90258380489318, 302.4388313473633, 307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286, 377.0007045238429, 124.70639096558124, 217.57018275560915, 340.0492718206214, 220.6664959844141, 127.69032425092811, 357.37918254655034, 310.04090739204963, 66.48943849916729, 309.32234101346944, 184.1279695364296, 320.19850208412356, 161.97468865847546, 251.06129744293867, 519.5894926027638, 9.27440032199434, 338.81008492270706, 415.3465534808752, 229.45775621762303, 74.41912158484733, 345.62254498042614, 206.19386483552466, 349.62531502796486, 389.9472183030766, 221.0203147132847, 229.0983317613995, 370.9971909778587, 183.24712934173024, 301.3569171973084, 70.89522306209635, 351.42978861959614, 477.84799848798264, 238.9670858425759, 460.9562107820668, 336.77499182381234, 297.9218468712004, 175.63391378368007, 202.5846051245128, 116.16051557613885, 221.2715413907145, 206.1428988808463, 262.3960136777285, 382.7654214763345, 318.91113468127065, 14.377788752550034, 224.93678015581585, 427.388656823265, 67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934, 144.80999824454523, 283.6671034664816, 209.0972629193936, 68.11657857495548, 331.121650100336, 277.03094530352143, 394.97498121453685, 188.0997314652673, 81.83994632204569, 314.36934617568386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4991957458596237, "mean_inference_ms": 3.3331668474902525, "mean_action_processing_ms": 0.845161264774024, "mean_env_wait_ms": 9.953631484164237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005871295928955078, "StateBufferConnector_ms": 0.0028401613235473633, "ViewRequirementAgentConnector_ms": 0.10395216941833496}, "num_episodes": 10, "episode_return_max": 393.2, "episode_return_min": 55.5, "episode_return_mean": 214.136, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.26457300257698, "num_env_steps_trained_throughput_per_sec": 159.26457300257698, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 25703.287, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25703.126, "sample_time_ms": 1919.496, "learn_time_ms": 23754.521, "learn_throughput": 168.389, "synch_weights_time_ms": 26.364}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 87, "trial_id": "cbf82_00000", "date": "2024-08-21_13-44-48", "timestamp": 1724228088, "time_this_iter_s": 25.143306016921997, "time_total_s": 2261.88098859787, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177ebd3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2261.88098859787, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 29.074285714285715, "ram_util_percent": 81.08285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.234927291795612, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.717372592786948, "policy_loss": -0.007771095572873795, "vf_loss": 6.72319327990214, "vf_explained_var": 0.16456571302066247, "kl": 0.00975215749980028, "entropy": 0.6296857545152307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093684128175179, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.396402743955453, "policy_loss": -0.026133314975595567, "vf_loss": 7.419805042942365, "vf_explained_var": 0.020525127400954565, "kl": 0.01365505065744704, "entropy": 0.7502539249137044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 393.2, "episode_reward_min": 55.5, "episode_reward_mean": 207.96399999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 9.27440032199434}, "policy_reward_max": {"prey_policy": 378.82221124744996, "predator_policy": 637.8788986077238}, "policy_reward_mean": {"prey_policy": -52.2296134109072, "predator_policy": 260.1936134109073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.69999999999993, 129.79999999999995, 309.2000000000001, 380.2, 210.89999999999998, 330.7, 81.40000000000012, 351.0, 349.4, 375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7, 210.29999999999978, 298.5000000000001, 297.79999999999995, 230.29999999999995, 291.29999999999995, 221.49999999999994, 125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0, 309.1000000000005, 138.59999999999982, 193.0, 196.8999999999999, 244.1, 56.50000000000009, 121.80000000000001, 88.10000000000015, 243.0, 149.50000000000003, 249.0, 309.1, 167.3, 196.89999999999998, 350.4, 180.29999999999993, 243.79999999999987, 211.2, 275.0, 154.99999999999983, 103.20000000000002, 375.3, 94.00000000000004, 145.7, 211.4, 309.00000000000006, 104.8999999999998, 245.9999999999999, 183.0, 114.29999999999978, 222.2, 273.5, 172.69999999999996, 195.49999999999997, 236.39999999999998, 303.6, 135.79999999999998, 60.900000000000006, 210.39999999999992, 119.00000000000003, 129.09999999999982, 187.2, 241.09999999999994, 214.7999999999998, 298.6, 221.49999999999997, 204.79999999999973, 178.7, 191.19999999999993, 192.69999999999996, 393.2, 233.7999999999999, 81.49999999999983, 279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984, 307.20000000000005, 179.99999999999997, 196.7999999999995, 350.0, 138.49999999999991, 173.8, 119.90000000000003, 200.09999999999954, 317.4, 181.10000000000002, 126.09999999999998, 130.3, 165.5, 123.09999999999994, 124.80000000000004], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-350.41363410449196, -355.4586441465093, 263.47041235684117, 345.10345158773293, -114.9466587742722, 244.92569587849493, -282.72465296750715, 283.2438984334918, 265.8883297003783, 358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426, -92.5931609506922, 173.1722934561079, 151.63013759891675, 4.073753721191082, 110.44792253647707, -10.597894350731332, -239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591, 214.1974161951068, -163.83883134736368, -114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303, -255.20070452384272, -36.60639096558103, 25.42981724439086, -190.5492718206215, 28.333504015585785, 181.4096757490718, -190.0791825465502, -113.14090739204971, 283.9105615008327, -129.02234101346974, 59.67203046357031, -108.99850208412367, 113.02531134152467, -96.06129744293872, -416.3894926027636, 366.0255996780056, -244.8100849227072, -269.6465534808754, -18.05775621762301, 234.58087841515268, -240.72254498042636, 39.80613516447536, -166.62531502796503, -275.6472183030759, 1.179685286714971, 44.40166823860059, -198.29719097785872, 12.25287065826981, -64.95691719730847, 232.70477693790394, -215.62978861959647, -416.94799848798255, -28.56708584257597, -341.95621078206693, -207.67499182381263, -110.72184687120055, 65.46608621631981, 12.215394875487025, 182.4394844238611, 0.22845860928559247, -1.3428988808463718, -83.69601367772836, -191.56542147633462, -126.21113468127075, 378.82221124744996, 8.863219844183995, -345.88865682326406, 211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076, 162.39000175545462, -103.66710346648173, -12.297262919393631, 281.8834214250447, -192.62165010033627, -103.23094530352151, -275.07498121453676, 12.000268534732204, 235.5600536779543, -133.26934617568398, -231.33508955511596, -141.54832636684762, -163.07124198443327, -287.28044229910694, -283.11235028939893], "policy_predator_policy_reward": [455.11363410449223, 485.2586441465094, 45.72958764315887, 35.0965484122671, 325.84665877427216, 85.7743041215051, 364.1246529675091, 67.7561015665082, 83.51167029962173, 16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227, 302.8931609506917, 125.32770654389208, 146.16986240108318, 226.22624627880893, 180.85207746352302, 232.0978943507313, 365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883, 94.90258380489318, 302.4388313473633, 307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286, 377.0007045238429, 124.70639096558124, 217.57018275560915, 340.0492718206214, 220.6664959844141, 127.69032425092811, 357.37918254655034, 310.04090739204963, 66.48943849916729, 309.32234101346944, 184.1279695364296, 320.19850208412356, 161.97468865847546, 251.06129744293867, 519.5894926027638, 9.27440032199434, 338.81008492270706, 415.3465534808752, 229.45775621762303, 74.41912158484733, 345.62254498042614, 206.19386483552466, 349.62531502796486, 389.9472183030766, 221.0203147132847, 229.0983317613995, 370.9971909778587, 183.24712934173024, 301.3569171973084, 70.89522306209635, 351.42978861959614, 477.84799848798264, 238.9670858425759, 460.9562107820668, 336.77499182381234, 297.9218468712004, 175.63391378368007, 202.5846051245128, 116.16051557613885, 221.2715413907145, 206.1428988808463, 262.3960136777285, 382.7654214763345, 318.91113468127065, 14.377788752550034, 224.93678015581585, 427.388656823265, 67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934, 144.80999824454523, 283.6671034664816, 209.0972629193936, 68.11657857495548, 331.121650100336, 277.03094530352143, 394.97498121453685, 188.0997314652673, 81.83994632204569, 314.36934617568386, 357.4350895551159, 271.8483263668477, 328.57124198443313, 410.380442299107, 407.9123502893986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.498933267464188, "mean_inference_ms": 3.3293685515082516, "mean_action_processing_ms": 0.846645510782169, "mean_env_wait_ms": 9.957929385435971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005845546722412109, "StateBufferConnector_ms": 0.0028496980667114258, "ViewRequirementAgentConnector_ms": 0.10419225692749023}, "num_episodes": 5, "episode_return_max": 393.2, "episode_return_min": 55.5, "episode_return_mean": 207.96399999999994, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.29027328208218, "num_env_steps_trained_throughput_per_sec": 160.29027328208218, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 25660.438, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25660.288, "sample_time_ms": 1909.719, "learn_time_ms": 23722.826, "learn_throughput": 168.614, "synch_weights_time_ms": 25.232}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 88, "trial_id": "cbf82_00000", "date": "2024-08-21_13-45-13", "timestamp": 1724228113, "time_this_iter_s": 24.99381709098816, "time_total_s": 2286.874805688858, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075cc820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2286.874805688858, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 29.224999999999998, "ram_util_percent": 81.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.782242520277699, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.655925207336744, "policy_loss": -0.0038799287741615746, "vf_loss": 6.658152629435063, "vf_explained_var": 0.19700454988827307, "kl": 0.008262555311133232, "entropy": 0.6209806883397202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.22764522737513, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.351580246289571, "policy_loss": -0.02737286321159142, "vf_loss": 7.376198683182398, "vf_explained_var": 0.09541657026857138, "kl": 0.01377218605048256, "entropy": 0.7339076587930322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "env_runners": {"episode_reward_max": 393.2, "episode_reward_min": 55.5, "episode_reward_mean": 203.26999999999995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 9.27440032199434}, "policy_reward_max": {"prey_policy": 378.82221124744996, "predator_policy": 637.8788986077238}, "policy_reward_mean": {"prey_policy": -58.438471752379044, "predator_policy": 261.70847175237895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.1, 210.30000000000007, 285.2000000000004, 247.80000000000007, 115.69999999999996, 195.7, 210.29999999999978, 298.5000000000001, 297.79999999999995, 230.29999999999995, 291.29999999999995, 221.49999999999994, 125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0, 309.1000000000005, 138.59999999999982, 193.0, 196.8999999999999, 244.1, 56.50000000000009, 121.80000000000001, 88.10000000000015, 243.0, 149.50000000000003, 249.0, 309.1, 167.3, 196.89999999999998, 350.4, 180.29999999999993, 243.79999999999987, 211.2, 275.0, 154.99999999999983, 103.20000000000002, 375.3, 94.00000000000004, 145.7, 211.4, 309.00000000000006, 104.8999999999998, 245.9999999999999, 183.0, 114.29999999999978, 222.2, 273.5, 172.69999999999996, 195.49999999999997, 236.39999999999998, 303.6, 135.79999999999998, 60.900000000000006, 210.39999999999992, 119.00000000000003, 129.09999999999982, 187.2, 241.09999999999994, 214.7999999999998, 298.6, 221.49999999999997, 204.79999999999973, 178.7, 191.19999999999993, 192.69999999999996, 393.2, 233.7999999999999, 81.49999999999983, 279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984, 307.20000000000005, 179.99999999999997, 196.7999999999995, 350.0, 138.49999999999991, 173.8, 119.90000000000003, 200.09999999999954, 317.4, 181.10000000000002, 126.09999999999998, 130.3, 165.5, 123.09999999999994, 124.80000000000004, 159.39999999999898, 75.20000000000005, 168.1, 261.7, 292.30000000000007, 133.7000000000002, 156.39999999999986, 290.1, 241.00000000000003], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [358.66531336631834, -21.57659392271458, 115.35694263961075, 108.38700499238944, -346.00804855467106, -101.7607492300426, -92.5931609506922, 173.1722934561079, 151.63013759891675, 4.073753721191082, 110.44792253647707, -10.597894350731332, -239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591, 214.1974161951068, -163.83883134736368, -114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303, -255.20070452384272, -36.60639096558103, 25.42981724439086, -190.5492718206215, 28.333504015585785, 181.4096757490718, -190.0791825465502, -113.14090739204971, 283.9105615008327, -129.02234101346974, 59.67203046357031, -108.99850208412367, 113.02531134152467, -96.06129744293872, -416.3894926027636, 366.0255996780056, -244.8100849227072, -269.6465534808754, -18.05775621762301, 234.58087841515268, -240.72254498042636, 39.80613516447536, -166.62531502796503, -275.6472183030759, 1.179685286714971, 44.40166823860059, -198.29719097785872, 12.25287065826981, -64.95691719730847, 232.70477693790394, -215.62978861959647, -416.94799848798255, -28.56708584257597, -341.95621078206693, -207.67499182381263, -110.72184687120055, 65.46608621631981, 12.215394875487025, 182.4394844238611, 0.22845860928559247, -1.3428988808463718, -83.69601367772836, -191.56542147633462, -126.21113468127075, 378.82221124744996, 8.863219844183995, -345.88865682326406, 211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076, 162.39000175545462, -103.66710346648173, -12.297262919393631, 281.8834214250447, -192.62165010033627, -103.23094530352151, -275.07498121453676, 12.000268534732204, 235.5600536779543, -133.26934617568398, -231.33508955511596, -141.54832636684762, -163.07124198443327, -287.28044229910694, -283.11235028939893, 54.298672266741455, -338.6356435237227, -168.71779746930787, 45.0784089613483, 128.40168846105334, -43.24764543659495, -110.32207977378329, 145.73923276792385, -34.39247243668334], "policy_predator_policy_reward": [16.434686633681657, 231.87659392271433, 169.84305736038937, 139.41299500761053, 461.7080485546711, 297.46074923004227, 302.8931609506917, 125.32770654389208, 146.16986240108318, 226.22624627880893, 180.85207746352302, 232.0978943507313, 365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883, 94.90258380489318, 302.4388313473633, 307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286, 377.0007045238429, 124.70639096558124, 217.57018275560915, 340.0492718206214, 220.6664959844141, 127.69032425092811, 357.37918254655034, 310.04090739204963, 66.48943849916729, 309.32234101346944, 184.1279695364296, 320.19850208412356, 161.97468865847546, 251.06129744293867, 519.5894926027638, 9.27440032199434, 338.81008492270706, 415.3465534808752, 229.45775621762303, 74.41912158484733, 345.62254498042614, 206.19386483552466, 349.62531502796486, 389.9472183030766, 221.0203147132847, 229.0983317613995, 370.9971909778587, 183.24712934173024, 301.3569171973084, 70.89522306209635, 351.42978861959614, 477.84799848798264, 238.9670858425759, 460.9562107820668, 336.77499182381234, 297.9218468712004, 175.63391378368007, 202.5846051245128, 116.16051557613885, 221.2715413907145, 206.1428988808463, 262.3960136777285, 382.7654214763345, 318.91113468127065, 14.377788752550034, 224.93678015581585, 427.388656823265, 67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934, 144.80999824454523, 283.6671034664816, 209.0972629193936, 68.11657857495548, 331.121650100336, 277.03094530352143, 394.97498121453685, 188.0997314652673, 81.83994632204569, 314.36934617568386, 357.4350895551159, 271.8483263668477, 328.57124198443313, 410.380442299107, 407.9123502893986, 105.10132773325876, 413.8356435237219, 336.81779746930795, 216.6215910386515, 163.89831153894664, 176.94764543659437, 266.7220797737833, 144.3607672320762, 275.39247243668336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.499558631791771, "mean_inference_ms": 3.3189508923318862, "mean_action_processing_ms": 0.8495199512349675, "mean_env_wait_ms": 9.966515189999406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005865573883056641, "StateBufferConnector_ms": 0.0027970075607299805, "ViewRequirementAgentConnector_ms": 0.1039423942565918}, "num_episodes": 9, "episode_return_max": 393.2, "episode_return_min": 55.5, "episode_return_mean": 203.26999999999995, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.50280345337276, "num_env_steps_trained_throughput_per_sec": 160.50280345337276, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 25656.305, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25656.161, "sample_time_ms": 1907.408, "learn_time_ms": 23719.643, "learn_throughput": 168.637, "synch_weights_time_ms": 26.631}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "training_iteration": 89, "trial_id": "cbf82_00000", "date": "2024-08-21_13-45-38", "timestamp": 1724228138, "time_this_iter_s": 24.94896697998047, "time_total_s": 2311.8237726688385, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e73790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2311.8237726688385, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 28.925714285714285, "ram_util_percent": 80.50285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.728354678675532, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.588650086522103, "policy_loss": -0.0053601964689733, "vf_loss": 6.59257672727108, "vf_explained_var": 0.16722302939742803, "kl": 0.007167914447927614, "entropy": 0.6128032491231958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.65699938920637, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.450839460392793, "policy_loss": -0.02189553136364945, "vf_loss": 7.470032935837905, "vf_explained_var": -0.07327212082842986, "kl": 0.01351022349796646, "entropy": 0.7055328219508131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 393.2, "episode_reward_min": 55.5, "episode_reward_mean": 191.205, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 9.27440032199434}, "policy_reward_max": {"prey_policy": 378.82221124744996, "predator_policy": 637.8788986077238}, "policy_reward_mean": {"prey_policy": -81.01615451003461, "predator_policy": 272.2211545100345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.59999999999997, 55.5, 101.10000000000002, 300.1, 386.0, 309.1000000000005, 138.59999999999982, 193.0, 196.8999999999999, 244.1, 56.50000000000009, 121.80000000000001, 88.10000000000015, 243.0, 149.50000000000003, 249.0, 309.1, 167.3, 196.89999999999998, 350.4, 180.29999999999993, 243.79999999999987, 211.2, 275.0, 154.99999999999983, 103.20000000000002, 375.3, 94.00000000000004, 145.7, 211.4, 309.00000000000006, 104.8999999999998, 245.9999999999999, 183.0, 114.29999999999978, 222.2, 273.5, 172.69999999999996, 195.49999999999997, 236.39999999999998, 303.6, 135.79999999999998, 60.900000000000006, 210.39999999999992, 119.00000000000003, 129.09999999999982, 187.2, 241.09999999999994, 214.7999999999998, 298.6, 221.49999999999997, 204.79999999999973, 178.7, 191.19999999999993, 192.69999999999996, 393.2, 233.7999999999999, 81.49999999999983, 279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984, 307.20000000000005, 179.99999999999997, 196.7999999999995, 350.0, 138.49999999999991, 173.8, 119.90000000000003, 200.09999999999954, 317.4, 181.10000000000002, 126.09999999999998, 130.3, 165.5, 123.09999999999994, 124.80000000000004, 159.39999999999898, 75.20000000000005, 168.1, 261.7, 292.30000000000007, 133.7000000000002, 156.39999999999986, 290.1, 241.00000000000003, 242.9999999999999, 158.1, 59.80000000000031, 103.19999999999939, 86.29999999999995, 197.7999999999999, 92.29999999999995, 100.59999999999893, 97.0, 288.4999999999999, 225.19999999999973, 121.19999999999996], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-239.50515103231436, -416.73105026015384, -536.7788986077245, 162.62893058639003, 370.5781468085591, 214.1974161951068, -163.83883134736368, -114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303, -255.20070452384272, -36.60639096558103, 25.42981724439086, -190.5492718206215, 28.333504015585785, 181.4096757490718, -190.0791825465502, -113.14090739204971, 283.9105615008327, -129.02234101346974, 59.67203046357031, -108.99850208412367, 113.02531134152467, -96.06129744293872, -416.3894926027636, 366.0255996780056, -244.8100849227072, -269.6465534808754, -18.05775621762301, 234.58087841515268, -240.72254498042636, 39.80613516447536, -166.62531502796503, -275.6472183030759, 1.179685286714971, 44.40166823860059, -198.29719097785872, 12.25287065826981, -64.95691719730847, 232.70477693790394, -215.62978861959647, -416.94799848798255, -28.56708584257597, -341.95621078206693, -207.67499182381263, -110.72184687120055, 65.46608621631981, 12.215394875487025, 182.4394844238611, 0.22845860928559247, -1.3428988808463718, -83.69601367772836, -191.56542147633462, -126.21113468127075, 378.82221124744996, 8.863219844183995, -345.88865682326406, 211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076, 162.39000175545462, -103.66710346648173, -12.297262919393631, 281.8834214250447, -192.62165010033627, -103.23094530352151, -275.07498121453676, 12.000268534732204, 235.5600536779543, -133.26934617568398, -231.33508955511596, -141.54832636684762, -163.07124198443327, -287.28044229910694, -283.11235028939893, 54.298672266741455, -338.6356435237227, -168.71779746930787, 45.0784089613483, 128.40168846105334, -43.24764543659495, -110.32207977378329, 145.73923276792385, -34.39247243668334, 77.80326723843106, -181.64885200983636, -220.1755407172795, -218.41396774138485, -303.6106055753068, -72.8823195648355, -363.9488718812387, -66.38319803731005, -410.3033212529699, 172.8181800666227, 26.346425735878718, -248.17255072416845], "policy_predator_policy_reward": [365.10515103231427, 472.2310502601544, 637.8788986077238, 137.47106941361, 15.421853191440883, 94.90258380489318, 302.4388313473633, 307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286, 377.0007045238429, 124.70639096558124, 217.57018275560915, 340.0492718206214, 220.6664959844141, 127.69032425092811, 357.37918254655034, 310.04090739204963, 66.48943849916729, 309.32234101346944, 184.1279695364296, 320.19850208412356, 161.97468865847546, 251.06129744293867, 519.5894926027638, 9.27440032199434, 338.81008492270706, 415.3465534808752, 229.45775621762303, 74.41912158484733, 345.62254498042614, 206.19386483552466, 349.62531502796486, 389.9472183030766, 221.0203147132847, 229.0983317613995, 370.9971909778587, 183.24712934173024, 301.3569171973084, 70.89522306209635, 351.42978861959614, 477.84799848798264, 238.9670858425759, 460.9562107820668, 336.77499182381234, 297.9218468712004, 175.63391378368007, 202.5846051245128, 116.16051557613885, 221.2715413907145, 206.1428988808463, 262.3960136777285, 382.7654214763345, 318.91113468127065, 14.377788752550034, 224.93678015581585, 427.388656823265, 67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934, 144.80999824454523, 283.6671034664816, 209.0972629193936, 68.11657857495548, 331.121650100336, 277.03094530352143, 394.97498121453685, 188.0997314652673, 81.83994632204569, 314.36934617568386, 357.4350895551159, 271.8483263668477, 328.57124198443313, 410.380442299107, 407.9123502893986, 105.10132773325876, 413.8356435237219, 336.81779746930795, 216.6215910386515, 163.89831153894664, 176.94764543659437, 266.7220797737833, 144.3607672320762, 275.39247243668336, 165.19673276156888, 339.7488520098362, 279.9755407172783, 321.6139677413844, 389.91060557530693, 270.68231956483555, 456.24887188123887, 166.98319803730902, 507.3033212529698, 115.6818199333773, 198.85357426412125, 369.3725507241686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.493664347828395, "mean_inference_ms": 3.3224737083824096, "mean_action_processing_ms": 0.8347670989161456, "mean_env_wait_ms": 9.95529286671528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005821824073791504, "StateBufferConnector_ms": 0.0027632713317871094, "ViewRequirementAgentConnector_ms": 0.09825551509857178}, "num_episodes": 12, "episode_return_max": 393.2, "episode_return_min": 55.5, "episode_return_mean": 191.205, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.008100958959, "num_env_steps_trained_throughput_per_sec": 159.008100958959, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 25620.923, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25620.766, "sample_time_ms": 1898.054, "learn_time_ms": 23694.427, "learn_throughput": 168.816, "synch_weights_time_ms": 26.015}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 90, "trial_id": "cbf82_00000", "date": "2024-08-21_13-46-03", "timestamp": 1724228163, "time_this_iter_s": 25.212363958358765, "time_total_s": 2337.0361366271973, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3950b19d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2337.0361366271973, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 28.91111111111111, "ram_util_percent": 80.16666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.525948143750429, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.656529645621776, "policy_loss": -0.0035225913462151462, "vf_loss": 6.658530026674271, "vf_explained_var": 0.10887511049707731, "kl": 0.007611123920408621, "entropy": 0.5988308300574621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.743697125464678, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.28266742626826, "policy_loss": -0.021001410847626783, "vf_loss": 7.300657181938489, "vf_explained_var": 0.12390962454179923, "kl": 0.015058165329295055, "entropy": 0.6875150750080744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "env_runners": {"episode_reward_max": 393.2, "episode_reward_min": 56.50000000000009, "episode_reward_mean": 188.95699999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 9.27440032199434}, "policy_reward_max": {"prey_policy": 378.82221124744996, "predator_policy": 600.5683263244018}, "policy_reward_mean": {"prey_policy": -83.22739509672891, "predator_policy": 272.18439509672885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.0, 196.8999999999999, 244.1, 56.50000000000009, 121.80000000000001, 88.10000000000015, 243.0, 149.50000000000003, 249.0, 309.1, 167.3, 196.89999999999998, 350.4, 180.29999999999993, 243.79999999999987, 211.2, 275.0, 154.99999999999983, 103.20000000000002, 375.3, 94.00000000000004, 145.7, 211.4, 309.00000000000006, 104.8999999999998, 245.9999999999999, 183.0, 114.29999999999978, 222.2, 273.5, 172.69999999999996, 195.49999999999997, 236.39999999999998, 303.6, 135.79999999999998, 60.900000000000006, 210.39999999999992, 119.00000000000003, 129.09999999999982, 187.2, 241.09999999999994, 214.7999999999998, 298.6, 221.49999999999997, 204.79999999999973, 178.7, 191.19999999999993, 192.69999999999996, 393.2, 233.7999999999999, 81.49999999999983, 279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984, 307.20000000000005, 179.99999999999997, 196.7999999999995, 350.0, 138.49999999999991, 173.8, 119.90000000000003, 200.09999999999954, 317.4, 181.10000000000002, 126.09999999999998, 130.3, 165.5, 123.09999999999994, 124.80000000000004, 159.39999999999898, 75.20000000000005, 168.1, 261.7, 292.30000000000007, 133.7000000000002, 156.39999999999986, 290.1, 241.00000000000003, 242.9999999999999, 158.1, 59.80000000000031, 103.19999999999939, 86.29999999999995, 197.7999999999999, 92.29999999999995, 100.59999999999893, 97.0, 288.4999999999999, 225.19999999999973, 121.19999999999996, 130.1999999999998, 154.39999999999947, 71.39999999999971, 152.29999999999967, 88.4, 230.2, 364.3], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-114.68432495458141, -151.88635391788628, 7.938775797752767, -322.79142069261303, -255.20070452384272, -36.60639096558103, 25.42981724439086, -190.5492718206215, 28.333504015585785, 181.4096757490718, -190.0791825465502, -113.14090739204971, 283.9105615008327, -129.02234101346974, 59.67203046357031, -108.99850208412367, 113.02531134152467, -96.06129744293872, -416.3894926027636, 366.0255996780056, -244.8100849227072, -269.6465534808754, -18.05775621762301, 234.58087841515268, -240.72254498042636, 39.80613516447536, -166.62531502796503, -275.6472183030759, 1.179685286714971, 44.40166823860059, -198.29719097785872, 12.25287065826981, -64.95691719730847, 232.70477693790394, -215.62978861959647, -416.94799848798255, -28.56708584257597, -341.95621078206693, -207.67499182381263, -110.72184687120055, 65.46608621631981, 12.215394875487025, 182.4394844238611, 0.22845860928559247, -1.3428988808463718, -83.69601367772836, -191.56542147633462, -126.21113468127075, 378.82221124744996, 8.863219844183995, -345.88865682326406, 211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076, 162.39000175545462, -103.66710346648173, -12.297262919393631, 281.8834214250447, -192.62165010033627, -103.23094530352151, -275.07498121453676, 12.000268534732204, 235.5600536779543, -133.26934617568398, -231.33508955511596, -141.54832636684762, -163.07124198443327, -287.28044229910694, -283.11235028939893, 54.298672266741455, -338.6356435237227, -168.71779746930787, 45.0784089613483, 128.40168846105334, -43.24764543659495, -110.32207977378329, 145.73923276792385, -34.39247243668334, 77.80326723843106, -181.64885200983636, -220.1755407172795, -218.41396774138485, -303.6106055753068, -72.8823195648355, -363.9488718812387, -66.38319803731005, -410.3033212529699, 172.8181800666227, 26.346425735878718, -248.17255072416845, -211.94718232458231, -61.844908570630736, -387.7902139073872, -140.47019783898352, -341.8656986808817, -7.8935007964064, 321.2382057919424], "policy_predator_policy_reward": [307.6843249545815, 348.7863539178862, 236.16122420224715, 379.29142069261286, 377.0007045238429, 124.70639096558124, 217.57018275560915, 340.0492718206214, 220.6664959844141, 127.69032425092811, 357.37918254655034, 310.04090739204963, 66.48943849916729, 309.32234101346944, 184.1279695364296, 320.19850208412356, 161.97468865847546, 251.06129744293867, 519.5894926027638, 9.27440032199434, 338.81008492270706, 415.3465534808752, 229.45775621762303, 74.41912158484733, 345.62254498042614, 206.19386483552466, 349.62531502796486, 389.9472183030766, 221.0203147132847, 229.0983317613995, 370.9971909778587, 183.24712934173024, 301.3569171973084, 70.89522306209635, 351.42978861959614, 477.84799848798264, 238.9670858425759, 460.9562107820668, 336.77499182381234, 297.9218468712004, 175.63391378368007, 202.5846051245128, 116.16051557613885, 221.2715413907145, 206.1428988808463, 262.3960136777285, 382.7654214763345, 318.91113468127065, 14.377788752550034, 224.93678015581585, 427.388656823265, 67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934, 144.80999824454523, 283.6671034664816, 209.0972629193936, 68.11657857495548, 331.121650100336, 277.03094530352143, 394.97498121453685, 188.0997314652673, 81.83994632204569, 314.36934617568386, 357.4350895551159, 271.8483263668477, 328.57124198443313, 410.380442299107, 407.9123502893986, 105.10132773325876, 413.8356435237219, 336.81779746930795, 216.6215910386515, 163.89831153894664, 176.94764543659437, 266.7220797737833, 144.3607672320762, 275.39247243668336, 165.19673276156888, 339.7488520098362, 279.9755407172783, 321.6139677413844, 389.91060557530693, 270.68231956483555, 456.24887188123887, 166.98319803730902, 507.3033212529698, 115.6818199333773, 198.85357426412125, 369.3725507241686, 342.147182324582, 216.24490857063023, 459.1902139073884, 292.7701978389832, 430.2656986808814, 238.09350079640637, 43.061794208057655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4902044056469776, "mean_inference_ms": 3.3168045687497982, "mean_action_processing_ms": 0.8410154280781836, "mean_env_wait_ms": 9.956680182863877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005808711051940918, "StateBufferConnector_ms": 0.0027240514755249023, "ViewRequirementAgentConnector_ms": 0.10082423686981201}, "num_episodes": 7, "episode_return_max": 393.2, "episode_return_min": 56.50000000000009, "episode_return_mean": 188.95699999999994, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.34657572276103, "num_env_steps_trained_throughput_per_sec": 157.34657572276103, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 25640.468, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25640.311, "sample_time_ms": 1902.669, "learn_time_ms": 23709.33, "learn_throughput": 168.71, "synch_weights_time_ms": 25.927}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "training_iteration": 91, "trial_id": "cbf82_00000", "date": "2024-08-21_13-46-29", "timestamp": 1724228189, "time_this_iter_s": 25.464051008224487, "time_total_s": 2362.5001876354218, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e39940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2362.5001876354218, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 30.464864864864865, "ram_util_percent": 80.52432432432433}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.719176941116651, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.594737439850966, "policy_loss": -0.00673049406032078, "vf_loss": 6.599650591611862, "vf_explained_var": 0.12378888720025619, "kl": 0.00908665084959163, "entropy": 0.6044870836039384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.490840265279015, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.335843051970005, "policy_loss": -0.02438890660996549, "vf_loss": 7.357439715663592, "vf_explained_var": -0.0185764001061519, "kl": 0.013961252069566398, "entropy": 0.6912085176135103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 393.2, "episode_reward_min": 59.80000000000031, "episode_reward_mean": 184.14999999999992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 9.27440032199434}, "policy_reward_max": {"prey_policy": 378.82221124744996, "predator_policy": 600.5683263244018}, "policy_reward_mean": {"prey_policy": -97.90205094730672, "predator_policy": 282.0520509473067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.29999999999993, 243.79999999999987, 211.2, 275.0, 154.99999999999983, 103.20000000000002, 375.3, 94.00000000000004, 145.7, 211.4, 309.00000000000006, 104.8999999999998, 245.9999999999999, 183.0, 114.29999999999978, 222.2, 273.5, 172.69999999999996, 195.49999999999997, 236.39999999999998, 303.6, 135.79999999999998, 60.900000000000006, 210.39999999999992, 119.00000000000003, 129.09999999999982, 187.2, 241.09999999999994, 214.7999999999998, 298.6, 221.49999999999997, 204.79999999999973, 178.7, 191.19999999999993, 192.69999999999996, 393.2, 233.7999999999999, 81.49999999999983, 279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984, 307.20000000000005, 179.99999999999997, 196.7999999999995, 350.0, 138.49999999999991, 173.8, 119.90000000000003, 200.09999999999954, 317.4, 181.10000000000002, 126.09999999999998, 130.3, 165.5, 123.09999999999994, 124.80000000000004, 159.39999999999898, 75.20000000000005, 168.1, 261.7, 292.30000000000007, 133.7000000000002, 156.39999999999986, 290.1, 241.00000000000003, 242.9999999999999, 158.1, 59.80000000000031, 103.19999999999939, 86.29999999999995, 197.7999999999999, 92.29999999999995, 100.59999999999893, 97.0, 288.4999999999999, 225.19999999999973, 121.19999999999996, 130.1999999999998, 154.39999999999947, 71.39999999999971, 152.29999999999967, 88.4, 230.2, 364.3, 266.99999999999994, 144.19999999999993, 126.3, 160.59999999999985, 135.10000000000002, 109.69999999999976, 139.69999999999987, 185.29999999999995, 138.09999999999997, 180.29999999999995, 166.89999999999992, 172.2, 159.49999999999983], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-129.02234101346974, 59.67203046357031, -108.99850208412367, 113.02531134152467, -96.06129744293872, -416.3894926027636, 366.0255996780056, -244.8100849227072, -269.6465534808754, -18.05775621762301, 234.58087841515268, -240.72254498042636, 39.80613516447536, -166.62531502796503, -275.6472183030759, 1.179685286714971, 44.40166823860059, -198.29719097785872, 12.25287065826981, -64.95691719730847, 232.70477693790394, -215.62978861959647, -416.94799848798255, -28.56708584257597, -341.95621078206693, -207.67499182381263, -110.72184687120055, 65.46608621631981, 12.215394875487025, 182.4394844238611, 0.22845860928559247, -1.3428988808463718, -83.69601367772836, -191.56542147633462, -126.21113468127075, 378.82221124744996, 8.863219844183995, -345.88865682326406, 211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076, 162.39000175545462, -103.66710346648173, -12.297262919393631, 281.8834214250447, -192.62165010033627, -103.23094530352151, -275.07498121453676, 12.000268534732204, 235.5600536779543, -133.26934617568398, -231.33508955511596, -141.54832636684762, -163.07124198443327, -287.28044229910694, -283.11235028939893, 54.298672266741455, -338.6356435237227, -168.71779746930787, 45.0784089613483, 128.40168846105334, -43.24764543659495, -110.32207977378329, 145.73923276792385, -34.39247243668334, 77.80326723843106, -181.64885200983636, -220.1755407172795, -218.41396774138485, -303.6106055753068, -72.8823195648355, -363.9488718812387, -66.38319803731005, -410.3033212529699, 172.8181800666227, 26.346425735878718, -248.17255072416845, -211.94718232458231, -61.844908570630736, -387.7902139073872, -140.47019783898352, -341.8656986808817, -7.8935007964064, 321.2382057919424, 93.8327159819496, -196.9060782527562, -352.6698528370045, -152.9956141939493, -277.499982976676, -223.28440072935496, -192.31685138910996, -187.92970004013162, -230.43783870454104, -140.87018181956057, -134.80548266222885, -168.69917104711692, -150.79936889339564], "policy_predator_policy_reward": [309.32234101346944, 184.1279695364296, 320.19850208412356, 161.97468865847546, 251.06129744293867, 519.5894926027638, 9.27440032199434, 338.81008492270706, 415.3465534808752, 229.45775621762303, 74.41912158484733, 345.62254498042614, 206.19386483552466, 349.62531502796486, 389.9472183030766, 221.0203147132847, 229.0983317613995, 370.9971909778587, 183.24712934173024, 301.3569171973084, 70.89522306209635, 351.42978861959614, 477.84799848798264, 238.9670858425759, 460.9562107820668, 336.77499182381234, 297.9218468712004, 175.63391378368007, 202.5846051245128, 116.16051557613885, 221.2715413907145, 206.1428988808463, 262.3960136777285, 382.7654214763345, 318.91113468127065, 14.377788752550034, 224.93678015581585, 427.388656823265, 67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934, 144.80999824454523, 283.6671034664816, 209.0972629193936, 68.11657857495548, 331.121650100336, 277.03094530352143, 394.97498121453685, 188.0997314652673, 81.83994632204569, 314.36934617568386, 357.4350895551159, 271.8483263668477, 328.57124198443313, 410.380442299107, 407.9123502893986, 105.10132773325876, 413.8356435237219, 336.81779746930795, 216.6215910386515, 163.89831153894664, 176.94764543659437, 266.7220797737833, 144.3607672320762, 275.39247243668336, 165.19673276156888, 339.7488520098362, 279.9755407172783, 321.6139677413844, 389.91060557530693, 270.68231956483555, 456.24887188123887, 166.98319803730902, 507.3033212529698, 115.6818199333773, 198.85357426412125, 369.3725507241686, 342.147182324582, 216.24490857063023, 459.1902139073884, 292.7701978389832, 430.2656986808814, 238.09350079640637, 43.061794208057655, 173.16728401805037, 341.1060782527562, 478.96985283700417, 313.5956141939494, 412.599982976676, 332.9844007293562, 332.01685138910983, 373.2297000401318, 368.5378387045411, 321.1701818195602, 301.705482662229, 340.8991710471168, 310.29936889339535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4824101778235446, "mean_inference_ms": 3.3195064693005425, "mean_action_processing_ms": 0.8299635451902552, "mean_env_wait_ms": 9.944455528902452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007683157920837402, "StateBufferConnector_ms": 0.003514885902404785, "ViewRequirementAgentConnector_ms": 0.09213137626647949}, "num_episodes": 13, "episode_return_max": 393.2, "episode_return_min": 59.80000000000031, "episode_return_mean": 184.14999999999992, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.54578772971084, "num_env_steps_trained_throughput_per_sec": 159.54578772971084, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 25601.763, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25601.608, "sample_time_ms": 1896.656, "learn_time_ms": 23677.385, "learn_throughput": 168.938, "synch_weights_time_ms": 25.191}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 92, "trial_id": "cbf82_00000", "date": "2024-08-21_13-46-54", "timestamp": 1724228214, "time_this_iter_s": 25.092195987701416, "time_total_s": 2387.592383623123, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177ebdd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2387.592383623123, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 28.582857142857147, "ram_util_percent": 81.36857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.669318130984903, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.186820944646994, "policy_loss": -0.0036891605724425364, "vf_loss": 6.188575171927611, "vf_explained_var": 0.15676390466590723, "kl": 0.009674664950337804, "entropy": 0.6633021384788056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.908368852734565, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.352336465318998, "policy_loss": -0.025760030831588666, "vf_loss": 7.375083816548188, "vf_explained_var": 0.02479600900163253, "kl": 0.015063425029802601, "entropy": 0.679394418001175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 393.2, "episode_reward_min": 59.80000000000031, "episode_reward_mean": 179.6269999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 14.377788752550034}, "policy_reward_max": {"prey_policy": 378.82221124744996, "predator_policy": 600.5683263244018}, "policy_reward_mean": {"prey_policy": -107.12911238579676, "predator_policy": 286.75611238579665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.2, 273.5, 172.69999999999996, 195.49999999999997, 236.39999999999998, 303.6, 135.79999999999998, 60.900000000000006, 210.39999999999992, 119.00000000000003, 129.09999999999982, 187.2, 241.09999999999994, 214.7999999999998, 298.6, 221.49999999999997, 204.79999999999973, 178.7, 191.19999999999993, 192.69999999999996, 393.2, 233.7999999999999, 81.49999999999983, 279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984, 307.20000000000005, 179.99999999999997, 196.7999999999995, 350.0, 138.49999999999991, 173.8, 119.90000000000003, 200.09999999999954, 317.4, 181.10000000000002, 126.09999999999998, 130.3, 165.5, 123.09999999999994, 124.80000000000004, 159.39999999999898, 75.20000000000005, 168.1, 261.7, 292.30000000000007, 133.7000000000002, 156.39999999999986, 290.1, 241.00000000000003, 242.9999999999999, 158.1, 59.80000000000031, 103.19999999999939, 86.29999999999995, 197.7999999999999, 92.29999999999995, 100.59999999999893, 97.0, 288.4999999999999, 225.19999999999973, 121.19999999999996, 130.1999999999998, 154.39999999999947, 71.39999999999971, 152.29999999999967, 88.4, 230.2, 364.3, 266.99999999999994, 144.19999999999993, 126.3, 160.59999999999985, 135.10000000000002, 109.69999999999976, 139.69999999999987, 185.29999999999995, 138.09999999999997, 180.29999999999995, 166.89999999999992, 172.2, 159.49999999999983, 113.99999999999994, 160.00000000000003, 221.19999999999982, 146.60000000000008, 360.6, 140.9999999999999, 152.09999999999948, 90.0, 109.79999999999998, 307.6, 194.59999999999997, 223.19999999999925, 78.50000000000001, 85.79999999999998, 114.80000000000007], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [1.179685286714971, 44.40166823860059, -198.29719097785872, 12.25287065826981, -64.95691719730847, 232.70477693790394, -215.62978861959647, -416.94799848798255, -28.56708584257597, -341.95621078206693, -207.67499182381263, -110.72184687120055, 65.46608621631981, 12.215394875487025, 182.4394844238611, 0.22845860928559247, -1.3428988808463718, -83.69601367772836, -191.56542147633462, -126.21113468127075, 378.82221124744996, 8.863219844183995, -345.88865682326406, 211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076, 162.39000175545462, -103.66710346648173, -12.297262919393631, 281.8834214250447, -192.62165010033627, -103.23094530352151, -275.07498121453676, 12.000268534732204, 235.5600536779543, -133.26934617568398, -231.33508955511596, -141.54832636684762, -163.07124198443327, -287.28044229910694, -283.11235028939893, 54.298672266741455, -338.6356435237227, -168.71779746930787, 45.0784089613483, 128.40168846105334, -43.24764543659495, -110.32207977378329, 145.73923276792385, -34.39247243668334, 77.80326723843106, -181.64885200983636, -220.1755407172795, -218.41396774138485, -303.6106055753068, -72.8823195648355, -363.9488718812387, -66.38319803731005, -410.3033212529699, 172.8181800666227, 26.346425735878718, -248.17255072416845, -211.94718232458231, -61.844908570630736, -387.7902139073872, -140.47019783898352, -341.8656986808817, -7.8935007964064, 321.2382057919424, 93.8327159819496, -196.9060782527562, -352.6698528370045, -152.9956141939493, -277.499982976676, -223.28440072935496, -192.31685138910996, -187.92970004013162, -230.43783870454104, -140.87018181956057, -134.80548266222885, -168.69917104711692, -150.79936889339564, -338.8600118068433, -125.44904043206118, -12.103675620153865, -160.08010289683185, 311.62956243797623, -215.50555857857324, -140.3361523169505, -344.5811774030343, -250.6755718571091, 188.62789560945018, -81.08746306720802, 158.8317947593684, -393.7712000769065, -426.1491198802001, -246.06747373316543], "policy_predator_policy_reward": [221.0203147132847, 229.0983317613995, 370.9971909778587, 183.24712934173024, 301.3569171973084, 70.89522306209635, 351.42978861959614, 477.84799848798264, 238.9670858425759, 460.9562107820668, 336.77499182381234, 297.9218468712004, 175.63391378368007, 202.5846051245128, 116.16051557613885, 221.2715413907145, 206.1428988808463, 262.3960136777285, 382.7654214763345, 318.91113468127065, 14.377788752550034, 224.93678015581585, 427.388656823265, 67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934, 144.80999824454523, 283.6671034664816, 209.0972629193936, 68.11657857495548, 331.121650100336, 277.03094530352143, 394.97498121453685, 188.0997314652673, 81.83994632204569, 314.36934617568386, 357.4350895551159, 271.8483263668477, 328.57124198443313, 410.380442299107, 407.9123502893986, 105.10132773325876, 413.8356435237219, 336.81779746930795, 216.6215910386515, 163.89831153894664, 176.94764543659437, 266.7220797737833, 144.3607672320762, 275.39247243668336, 165.19673276156888, 339.7488520098362, 279.9755407172783, 321.6139677413844, 389.91060557530693, 270.68231956483555, 456.24887188123887, 166.98319803730902, 507.3033212529698, 115.6818199333773, 198.85357426412125, 369.3725507241686, 342.147182324582, 216.24490857063023, 459.1902139073884, 292.7701978389832, 430.2656986808814, 238.09350079640637, 43.061794208057655, 173.16728401805037, 341.1060782527562, 478.96985283700417, 313.5956141939494, 412.599982976676, 332.9844007293562, 332.01685138910983, 373.2297000401318, 368.5378387045411, 321.1701818195602, 301.705482662229, 340.8991710471168, 310.29936889339535, 452.86001180684366, 285.4490404320613, 233.30367562015383, 306.6801028968317, 48.97043756202388, 356.5055585785729, 292.43615231695014, 434.58117740303453, 360.4755718571086, 118.9721043905499, 275.6874630672083, 64.36820524063087, 472.2712000769068, 511.94911988019993, 360.86747373316496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.479980173966899, "mean_inference_ms": 3.3034676791699416, "mean_action_processing_ms": 0.8375356928271088, "mean_env_wait_ms": 9.951932571605752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01733696460723877, "StateBufferConnector_ms": 0.0035060644149780273, "ViewRequirementAgentConnector_ms": 0.09317195415496826}, "num_episodes": 15, "episode_return_max": 393.2, "episode_return_min": 59.80000000000031, "episode_return_mean": 179.6269999999999, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.31223607791662, "num_env_steps_trained_throughput_per_sec": 162.31223607791662, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 25493.569, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25493.414, "sample_time_ms": 1889.145, "learn_time_ms": 23577.162, "learn_throughput": 169.656, "synch_weights_time_ms": 24.764}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 93, "trial_id": "cbf82_00000", "date": "2024-08-21_13-47-19", "timestamp": 1724228239, "time_this_iter_s": 24.67871379852295, "time_total_s": 2412.271097421646, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177ebd430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2412.271097421646, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 29.114285714285714, "ram_util_percent": 81.4057142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.879806954910358, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.2621651833256085, "policy_loss": -0.005162842291853546, "vf_loss": 6.26539473036925, "vf_explained_var": 0.17048396480580172, "kl": 0.009666306599441062, "entropy": 0.715328945685178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.105540763214231, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.87150124112765, "policy_loss": -0.021027774101336643, "vf_loss": 6.8898948336640995, "vf_explained_var": 0.1980083999534448, "kl": 0.01317086696702366, "entropy": 0.6428507103274266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 393.2, "episode_reward_min": 59.80000000000031, "episode_reward_mean": 175.2669999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 14.377788752550034}, "policy_reward_max": {"prey_policy": 378.82221124744996, "predator_policy": 600.5683263244018}, "policy_reward_mean": {"prey_policy": -118.00276772175435, "predator_policy": 293.2697677217543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.900000000000006, 210.39999999999992, 119.00000000000003, 129.09999999999982, 187.2, 241.09999999999994, 214.7999999999998, 298.6, 221.49999999999997, 204.79999999999973, 178.7, 191.19999999999993, 192.69999999999996, 393.2, 233.7999999999999, 81.49999999999983, 279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984, 307.20000000000005, 179.99999999999997, 196.7999999999995, 350.0, 138.49999999999991, 173.8, 119.90000000000003, 200.09999999999954, 317.4, 181.10000000000002, 126.09999999999998, 130.3, 165.5, 123.09999999999994, 124.80000000000004, 159.39999999999898, 75.20000000000005, 168.1, 261.7, 292.30000000000007, 133.7000000000002, 156.39999999999986, 290.1, 241.00000000000003, 242.9999999999999, 158.1, 59.80000000000031, 103.19999999999939, 86.29999999999995, 197.7999999999999, 92.29999999999995, 100.59999999999893, 97.0, 288.4999999999999, 225.19999999999973, 121.19999999999996, 130.1999999999998, 154.39999999999947, 71.39999999999971, 152.29999999999967, 88.4, 230.2, 364.3, 266.99999999999994, 144.19999999999993, 126.3, 160.59999999999985, 135.10000000000002, 109.69999999999976, 139.69999999999987, 185.29999999999995, 138.09999999999997, 180.29999999999995, 166.89999999999992, 172.2, 159.49999999999983, 113.99999999999994, 160.00000000000003, 221.19999999999982, 146.60000000000008, 360.6, 140.9999999999999, 152.09999999999948, 90.0, 109.79999999999998, 307.6, 194.59999999999997, 223.19999999999925, 78.50000000000001, 85.79999999999998, 114.80000000000007, 75.1, 228.3, 146.99999999999997, 147.5000000000001, 195.19999999999965, 144.59999999999997, 166.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-416.94799848798255, -28.56708584257597, -341.95621078206693, -207.67499182381263, -110.72184687120055, 65.46608621631981, 12.215394875487025, 182.4394844238611, 0.22845860928559247, -1.3428988808463718, -83.69601367772836, -191.56542147633462, -126.21113468127075, 378.82221124744996, 8.863219844183995, -345.88865682326406, 211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076, 162.39000175545462, -103.66710346648173, -12.297262919393631, 281.8834214250447, -192.62165010033627, -103.23094530352151, -275.07498121453676, 12.000268534732204, 235.5600536779543, -133.26934617568398, -231.33508955511596, -141.54832636684762, -163.07124198443327, -287.28044229910694, -283.11235028939893, 54.298672266741455, -338.6356435237227, -168.71779746930787, 45.0784089613483, 128.40168846105334, -43.24764543659495, -110.32207977378329, 145.73923276792385, -34.39247243668334, 77.80326723843106, -181.64885200983636, -220.1755407172795, -218.41396774138485, -303.6106055753068, -72.8823195648355, -363.9488718812387, -66.38319803731005, -410.3033212529699, 172.8181800666227, 26.346425735878718, -248.17255072416845, -211.94718232458231, -61.844908570630736, -387.7902139073872, -140.47019783898352, -341.8656986808817, -7.8935007964064, 321.2382057919424, 93.8327159819496, -196.9060782527562, -352.6698528370045, -152.9956141939493, -277.499982976676, -223.28440072935496, -192.31685138910996, -187.92970004013162, -230.43783870454104, -140.87018181956057, -134.80548266222885, -168.69917104711692, -150.79936889339564, -338.8600118068433, -125.44904043206118, -12.103675620153865, -160.08010289683185, 311.62956243797623, -215.50555857857324, -140.3361523169505, -344.5811774030343, -250.6755718571091, 188.62789560945018, -81.08746306720802, 158.8317947593684, -393.7712000769065, -426.1491198802001, -246.06747373316543, -394.51740883319985, -84.49867372453144, -216.9258292864798, -144.57821921780928, -1.760603901663121, -255.34148487306885, -178.08820943228096], "policy_predator_policy_reward": [477.84799848798264, 238.9670858425759, 460.9562107820668, 336.77499182381234, 297.9218468712004, 175.63391378368007, 202.5846051245128, 116.16051557613885, 221.2715413907145, 206.1428988808463, 262.3960136777285, 382.7654214763345, 318.91113468127065, 14.377788752550034, 224.93678015581585, 427.388656823265, 67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934, 144.80999824454523, 283.6671034664816, 209.0972629193936, 68.11657857495548, 331.121650100336, 277.03094530352143, 394.97498121453685, 188.0997314652673, 81.83994632204569, 314.36934617568386, 357.4350895551159, 271.8483263668477, 328.57124198443313, 410.380442299107, 407.9123502893986, 105.10132773325876, 413.8356435237219, 336.81779746930795, 216.6215910386515, 163.89831153894664, 176.94764543659437, 266.7220797737833, 144.3607672320762, 275.39247243668336, 165.19673276156888, 339.7488520098362, 279.9755407172783, 321.6139677413844, 389.91060557530693, 270.68231956483555, 456.24887188123887, 166.98319803730902, 507.3033212529698, 115.6818199333773, 198.85357426412125, 369.3725507241686, 342.147182324582, 216.24490857063023, 459.1902139073884, 292.7701978389832, 430.2656986808814, 238.09350079640637, 43.061794208057655, 173.16728401805037, 341.1060782527562, 478.96985283700417, 313.5956141939494, 412.599982976676, 332.9844007293562, 332.01685138910983, 373.2297000401318, 368.5378387045411, 321.1701818195602, 301.705482662229, 340.8991710471168, 310.29936889339535, 452.86001180684366, 285.4490404320613, 233.30367562015383, 306.6801028968317, 48.97043756202388, 356.5055585785729, 292.43615231695014, 434.58117740303453, 360.4755718571086, 118.9721043905499, 275.6874630672083, 64.36820524063087, 472.2712000769068, 511.94911988019993, 360.86747373316496, 469.6174088332, 312.7986737245316, 363.9258292864797, 292.07821921780936, 196.960603901663, 399.94148487306893, 344.0882094322811]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.477596654618805, "mean_inference_ms": 3.299568503418002, "mean_action_processing_ms": 0.8347253657900078, "mean_env_wait_ms": 9.945486671954098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017276644706726074, "StateBufferConnector_ms": 0.0034061670303344727, "ViewRequirementAgentConnector_ms": 0.06485617160797119}, "num_episodes": 7, "episode_return_max": 393.2, "episode_return_min": 59.80000000000031, "episode_return_mean": 175.2669999999999, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.57412197031343, "num_env_steps_trained_throughput_per_sec": 158.57412197031343, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 25355.59, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25355.458, "sample_time_ms": 1859.702, "learn_time_ms": 23468.541, "learn_throughput": 170.441, "synch_weights_time_ms": 24.986}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 94, "trial_id": "cbf82_00000", "date": "2024-08-21_13-47-44", "timestamp": 1724228264, "time_this_iter_s": 25.256813049316406, "time_total_s": 2437.5279104709625, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17bf18280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2437.5279104709625, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 30.872222222222224, "ram_util_percent": 80.94722222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.24202312702934, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.275238442420959, "policy_loss": -0.003198166635653858, "vf_loss": 5.276563620567321, "vf_explained_var": 0.18839444468418756, "kl": 0.009364981121325399, "entropy": 0.8531648668770989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.327073477829495, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.225268309811751, "policy_loss": -0.020043827940874812, "vf_loss": 6.243136202792327, "vf_explained_var": 0.10561145811031263, "kl": 0.010879685098673993, "entropy": 0.6001198554721972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 492.6999999999971}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 393.2, "episode_reward_min": 59.80000000000031, "episode_reward_mean": 177.8959999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 3.084782605575571}, "policy_reward_max": {"prey_policy": 378.82221124744996, "predator_policy": 600.5683263244018}, "policy_reward_mean": {"prey_policy": -111.93984333092529, "predator_policy": 289.8358433309252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [204.79999999999973, 178.7, 191.19999999999993, 192.69999999999996, 393.2, 233.7999999999999, 81.49999999999983, 279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984, 307.20000000000005, 179.99999999999997, 196.7999999999995, 350.0, 138.49999999999991, 173.8, 119.90000000000003, 200.09999999999954, 317.4, 181.10000000000002, 126.09999999999998, 130.3, 165.5, 123.09999999999994, 124.80000000000004, 159.39999999999898, 75.20000000000005, 168.1, 261.7, 292.30000000000007, 133.7000000000002, 156.39999999999986, 290.1, 241.00000000000003, 242.9999999999999, 158.1, 59.80000000000031, 103.19999999999939, 86.29999999999995, 197.7999999999999, 92.29999999999995, 100.59999999999893, 97.0, 288.4999999999999, 225.19999999999973, 121.19999999999996, 130.1999999999998, 154.39999999999947, 71.39999999999971, 152.29999999999967, 88.4, 230.2, 364.3, 266.99999999999994, 144.19999999999993, 126.3, 160.59999999999985, 135.10000000000002, 109.69999999999976, 139.69999999999987, 185.29999999999995, 138.09999999999997, 180.29999999999995, 166.89999999999992, 172.2, 159.49999999999983, 113.99999999999994, 160.00000000000003, 221.19999999999982, 146.60000000000008, 360.6, 140.9999999999999, 152.09999999999948, 90.0, 109.79999999999998, 307.6, 194.59999999999997, 223.19999999999925, 78.50000000000001, 85.79999999999998, 114.80000000000007, 75.1, 228.3, 146.99999999999997, 147.5000000000001, 195.19999999999965, 144.59999999999997, 166.0, 116.1, 178.3, 147.59999999999997, 163.1, 313.29999999999995, 223.2, 115.59999999999997, 359.7, 328.6], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1.3428988808463718, -83.69601367772836, -191.56542147633462, -126.21113468127075, 378.82221124744996, 8.863219844183995, -345.88865682326406, 211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076, 162.39000175545462, -103.66710346648173, -12.297262919393631, 281.8834214250447, -192.62165010033627, -103.23094530352151, -275.07498121453676, 12.000268534732204, 235.5600536779543, -133.26934617568398, -231.33508955511596, -141.54832636684762, -163.07124198443327, -287.28044229910694, -283.11235028939893, 54.298672266741455, -338.6356435237227, -168.71779746930787, 45.0784089613483, 128.40168846105334, -43.24764543659495, -110.32207977378329, 145.73923276792385, -34.39247243668334, 77.80326723843106, -181.64885200983636, -220.1755407172795, -218.41396774138485, -303.6106055753068, -72.8823195648355, -363.9488718812387, -66.38319803731005, -410.3033212529699, 172.8181800666227, 26.346425735878718, -248.17255072416845, -211.94718232458231, -61.844908570630736, -387.7902139073872, -140.47019783898352, -341.8656986808817, -7.8935007964064, 321.2382057919424, 93.8327159819496, -196.9060782527562, -352.6698528370045, -152.9956141939493, -277.499982976676, -223.28440072935496, -192.31685138910996, -187.92970004013162, -230.43783870454104, -140.87018181956057, -134.80548266222885, -168.69917104711692, -150.79936889339564, -338.8600118068433, -125.44904043206118, -12.103675620153865, -160.08010289683185, 311.62956243797623, -215.50555857857324, -140.3361523169505, -344.5811774030343, -250.6755718571091, 188.62789560945018, -81.08746306720802, 158.8317947593684, -393.7712000769065, -426.1491198802001, -246.06747373316543, -394.51740883319985, -84.49867372453144, -216.9258292864798, -144.57821921780928, -1.760603901663121, -255.34148487306885, -178.08820943228096, -252.65463679648076, -132.32260296954146, -234.42566480613146, -147.30121589029025, 310.2152173944244, -36.180074915432456, -318.17249295561464, 344.8795064970693, 226.73569384222057], "policy_predator_policy_reward": [206.1428988808463, 262.3960136777285, 382.7654214763345, 318.91113468127065, 14.377788752550034, 224.93678015581585, 427.388656823265, 67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934, 144.80999824454523, 283.6671034664816, 209.0972629193936, 68.11657857495548, 331.121650100336, 277.03094530352143, 394.97498121453685, 188.0997314652673, 81.83994632204569, 314.36934617568386, 357.4350895551159, 271.8483263668477, 328.57124198443313, 410.380442299107, 407.9123502893986, 105.10132773325876, 413.8356435237219, 336.81779746930795, 216.6215910386515, 163.89831153894664, 176.94764543659437, 266.7220797737833, 144.3607672320762, 275.39247243668336, 165.19673276156888, 339.7488520098362, 279.9755407172783, 321.6139677413844, 389.91060557530693, 270.68231956483555, 456.24887188123887, 166.98319803730902, 507.3033212529698, 115.6818199333773, 198.85357426412125, 369.3725507241686, 342.147182324582, 216.24490857063023, 459.1902139073884, 292.7701978389832, 430.2656986808814, 238.09350079640637, 43.061794208057655, 173.16728401805037, 341.1060782527562, 478.96985283700417, 313.5956141939494, 412.599982976676, 332.9844007293562, 332.01685138910983, 373.2297000401318, 368.5378387045411, 321.1701818195602, 301.705482662229, 340.8991710471168, 310.29936889339535, 452.86001180684366, 285.4490404320613, 233.30367562015383, 306.6801028968317, 48.97043756202388, 356.5055585785729, 292.43615231695014, 434.58117740303453, 360.4755718571086, 118.9721043905499, 275.6874630672083, 64.36820524063087, 472.2712000769068, 511.94911988019993, 360.86747373316496, 469.6174088332, 312.7986737245316, 363.9258292864797, 292.07821921780936, 196.960603901663, 399.94148487306893, 344.0882094322811, 368.75463679648084, 310.6226029695412, 382.02566480613154, 310.4012158902903, 3.084782605575571, 259.3800749154324, 433.77249295561467, 14.820493502930718, 101.86430615777937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4702471393140137, "mean_inference_ms": 3.297857196031988, "mean_action_processing_ms": 0.8313705140505862, "mean_env_wait_ms": 9.941251788493428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017321228981018066, "StateBufferConnector_ms": 0.003390789031982422, "ViewRequirementAgentConnector_ms": 0.06338632106781006}, "num_episodes": 9, "episode_return_max": 393.2, "episode_return_min": 59.80000000000031, "episode_return_mean": 177.8959999999999, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.01356721219784, "num_env_steps_trained_throughput_per_sec": 161.01356721219784, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 25133.558, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25133.448, "sample_time_ms": 1798.255, "learn_time_ms": 23309.216, "learn_throughput": 171.606, "synch_weights_time_ms": 24.125}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 95, "trial_id": "cbf82_00000", "date": "2024-08-21_13-48-09", "timestamp": 1724228289, "time_this_iter_s": 24.878072023391724, "time_total_s": 2462.4059824943542, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3950b19d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2462.4059824943542, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 28.836111111111116, "ram_util_percent": 81.6138888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.457110334560275, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.171485525369644, "policy_loss": -0.003980871430637005, "vf_loss": 6.173577466110388, "vf_explained_var": 0.19266392067074775, "kl": 0.009444628826410431, "entropy": 0.7110497061163187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.012232054894168, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.727384405086438, "policy_loss": -0.02527485648097354, "vf_loss": 6.749939810733, "vf_explained_var": 0.1308511033654213, "kl": 0.013597151949700978, "entropy": 0.6397674289842447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 364.3, "episode_reward_min": 59.80000000000031, "episode_reward_mean": 175.8379999999999, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.8683263244016, "predator_policy": 3.084782605575571}, "policy_reward_max": {"prey_policy": 344.8795064970693, "predator_policy": 600.5683263244018}, "policy_reward_mean": {"prey_policy": -116.40163761042669, "predator_policy": 292.2396376104267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.5000000000001, 204.39999999999992, 144.79999999999998, 187.90000000000003, 60.70000000000001, 225.79999999999984, 307.20000000000005, 179.99999999999997, 196.7999999999995, 350.0, 138.49999999999991, 173.8, 119.90000000000003, 200.09999999999954, 317.4, 181.10000000000002, 126.09999999999998, 130.3, 165.5, 123.09999999999994, 124.80000000000004, 159.39999999999898, 75.20000000000005, 168.1, 261.7, 292.30000000000007, 133.7000000000002, 156.39999999999986, 290.1, 241.00000000000003, 242.9999999999999, 158.1, 59.80000000000031, 103.19999999999939, 86.29999999999995, 197.7999999999999, 92.29999999999995, 100.59999999999893, 97.0, 288.4999999999999, 225.19999999999973, 121.19999999999996, 130.1999999999998, 154.39999999999947, 71.39999999999971, 152.29999999999967, 88.4, 230.2, 364.3, 266.99999999999994, 144.19999999999993, 126.3, 160.59999999999985, 135.10000000000002, 109.69999999999976, 139.69999999999987, 185.29999999999995, 138.09999999999997, 180.29999999999995, 166.89999999999992, 172.2, 159.49999999999983, 113.99999999999994, 160.00000000000003, 221.19999999999982, 146.60000000000008, 360.6, 140.9999999999999, 152.09999999999948, 90.0, 109.79999999999998, 307.6, 194.59999999999997, 223.19999999999925, 78.50000000000001, 85.79999999999998, 114.80000000000007, 75.1, 228.3, 146.99999999999997, 147.5000000000001, 195.19999999999965, 144.59999999999997, 166.0, 116.1, 178.3, 147.59999999999997, 163.1, 313.29999999999995, 223.2, 115.59999999999997, 359.7, 328.6, 135.39999999999995, 199.79999999999995, 208.5, 137.50000000000003, 232.5999999999999, 100.29999999999995, 255.9999999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [211.6930571580775, -159.61938012127445, -186.04318007647163, -125.4630202843264, -539.8683263244016, 67.84849455363076, 162.39000175545462, -103.66710346648173, -12.297262919393631, 281.8834214250447, -192.62165010033627, -103.23094530352151, -275.07498121453676, 12.000268534732204, 235.5600536779543, -133.26934617568398, -231.33508955511596, -141.54832636684762, -163.07124198443327, -287.28044229910694, -283.11235028939893, 54.298672266741455, -338.6356435237227, -168.71779746930787, 45.0784089613483, 128.40168846105334, -43.24764543659495, -110.32207977378329, 145.73923276792385, -34.39247243668334, 77.80326723843106, -181.64885200983636, -220.1755407172795, -218.41396774138485, -303.6106055753068, -72.8823195648355, -363.9488718812387, -66.38319803731005, -410.3033212529699, 172.8181800666227, 26.346425735878718, -248.17255072416845, -211.94718232458231, -61.844908570630736, -387.7902139073872, -140.47019783898352, -341.8656986808817, -7.8935007964064, 321.2382057919424, 93.8327159819496, -196.9060782527562, -352.6698528370045, -152.9956141939493, -277.499982976676, -223.28440072935496, -192.31685138910996, -187.92970004013162, -230.43783870454104, -140.87018181956057, -134.80548266222885, -168.69917104711692, -150.79936889339564, -338.8600118068433, -125.44904043206118, -12.103675620153865, -160.08010289683185, 311.62956243797623, -215.50555857857324, -140.3361523169505, -344.5811774030343, -250.6755718571091, 188.62789560945018, -81.08746306720802, 158.8317947593684, -393.7712000769065, -426.1491198802001, -246.06747373316543, -394.51740883319985, -84.49867372453144, -216.9258292864798, -144.57821921780928, -1.760603901663121, -255.34148487306885, -178.08820943228096, -252.65463679648076, -132.32260296954146, -234.42566480613146, -147.30121589029025, 310.2152173944244, -36.180074915432456, -318.17249295561464, 344.8795064970693, 226.73569384222057, -235.9910052555717, -70.52067432106831, -90.23528644509314, -259.4485706561957, -7.340564560943108, -263.8904206622277, 120.22839950314763], "policy_predator_policy_reward": [67.80694284192236, 364.01938012127437, 330.84318007647164, 313.36302028432607, 600.5683263244018, 157.95150544636934, 144.80999824454523, 283.6671034664816, 209.0972629193936, 68.11657857495548, 331.121650100336, 277.03094530352143, 394.97498121453685, 188.0997314652673, 81.83994632204569, 314.36934617568386, 357.4350895551159, 271.8483263668477, 328.57124198443313, 410.380442299107, 407.9123502893986, 105.10132773325876, 413.8356435237219, 336.81779746930795, 216.6215910386515, 163.89831153894664, 176.94764543659437, 266.7220797737833, 144.3607672320762, 275.39247243668336, 165.19673276156888, 339.7488520098362, 279.9755407172783, 321.6139677413844, 389.91060557530693, 270.68231956483555, 456.24887188123887, 166.98319803730902, 507.3033212529698, 115.6818199333773, 198.85357426412125, 369.3725507241686, 342.147182324582, 216.24490857063023, 459.1902139073884, 292.7701978389832, 430.2656986808814, 238.09350079640637, 43.061794208057655, 173.16728401805037, 341.1060782527562, 478.96985283700417, 313.5956141939494, 412.599982976676, 332.9844007293562, 332.01685138910983, 373.2297000401318, 368.5378387045411, 321.1701818195602, 301.705482662229, 340.8991710471168, 310.29936889339535, 452.86001180684366, 285.4490404320613, 233.30367562015383, 306.6801028968317, 48.97043756202388, 356.5055585785729, 292.43615231695014, 434.58117740303453, 360.4755718571086, 118.9721043905499, 275.6874630672083, 64.36820524063087, 472.2712000769068, 511.94911988019993, 360.86747373316496, 469.6174088332, 312.7986737245316, 363.9258292864797, 292.07821921780936, 196.960603901663, 399.94148487306893, 344.0882094322811, 368.75463679648084, 310.6226029695412, 382.02566480613154, 310.4012158902903, 3.084782605575571, 259.3800749154324, 433.77249295561467, 14.820493502930718, 101.86430615777937, 371.3910052555718, 270.32067432106834, 298.73528644509327, 396.9485706561956, 239.940564560943, 364.19042066222755, 135.77160049685233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4702391014780916, "mean_inference_ms": 3.290175099932622, "mean_action_processing_ms": 0.8256166549912389, "mean_env_wait_ms": 9.942635063538342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01728665828704834, "StateBufferConnector_ms": 0.0034192800521850586, "ViewRequirementAgentConnector_ms": 0.05718803405761719}, "num_episodes": 7, "episode_return_max": 364.3, "episode_return_min": 59.80000000000031, "episode_return_mean": 175.8379999999999, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.8174022717851, "num_env_steps_trained_throughput_per_sec": 153.8174022717851, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 25135.705, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25135.591, "sample_time_ms": 1762.164, "learn_time_ms": 23347.877, "learn_throughput": 171.322, "synch_weights_time_ms": 23.73}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 96, "trial_id": "cbf82_00000", "date": "2024-08-21_13-48-35", "timestamp": 1724228315, "time_this_iter_s": 26.032249927520752, "time_total_s": 2488.438232421875, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17bf0a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2488.438232421875, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 34.97297297297297, "ram_util_percent": 81.95135135135135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.164049302538236, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.235476413865884, "policy_loss": -0.00636884115713959, "vf_loss": 5.239522474507491, "vf_explained_var": 0.23479049603144328, "kl": 0.01161389933671065, "entropy": 0.8112877891709407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.383336049939196, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.406389777362347, "policy_loss": -0.024912717650295235, "vf_loss": 6.428565800189972, "vf_explained_var": 0.13370508638521036, "kl": 0.013683527880736316, "entropy": 0.5981476656161249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "env_runners": {"episode_reward_max": 364.3, "episode_reward_min": 59.80000000000031, "episode_reward_mean": 178.32699999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -426.1491198802001, "predator_policy": 3.084782605575571}, "policy_reward_max": {"prey_policy": 344.8795064970693, "predator_policy": 511.94911988019993}, "policy_reward_mean": {"prey_policy": -111.76749316276242, "predator_policy": 290.0944931627623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [181.10000000000002, 126.09999999999998, 130.3, 165.5, 123.09999999999994, 124.80000000000004, 159.39999999999898, 75.20000000000005, 168.1, 261.7, 292.30000000000007, 133.7000000000002, 156.39999999999986, 290.1, 241.00000000000003, 242.9999999999999, 158.1, 59.80000000000031, 103.19999999999939, 86.29999999999995, 197.7999999999999, 92.29999999999995, 100.59999999999893, 97.0, 288.4999999999999, 225.19999999999973, 121.19999999999996, 130.1999999999998, 154.39999999999947, 71.39999999999971, 152.29999999999967, 88.4, 230.2, 364.3, 266.99999999999994, 144.19999999999993, 126.3, 160.59999999999985, 135.10000000000002, 109.69999999999976, 139.69999999999987, 185.29999999999995, 138.09999999999997, 180.29999999999995, 166.89999999999992, 172.2, 159.49999999999983, 113.99999999999994, 160.00000000000003, 221.19999999999982, 146.60000000000008, 360.6, 140.9999999999999, 152.09999999999948, 90.0, 109.79999999999998, 307.6, 194.59999999999997, 223.19999999999925, 78.50000000000001, 85.79999999999998, 114.80000000000007, 75.1, 228.3, 146.99999999999997, 147.5000000000001, 195.19999999999965, 144.59999999999997, 166.0, 116.1, 178.3, 147.59999999999997, 163.1, 313.29999999999995, 223.2, 115.59999999999997, 359.7, 328.6, 135.39999999999995, 199.79999999999995, 208.5, 137.50000000000003, 232.5999999999999, 100.29999999999995, 255.9999999999999, 319.0, 224.39999999999998, 96.50000000000003, 126.10000000000002, 294.3, 163.7999999999999, 221.10000000000002, 193.19999999999996, 221.50000000000003, 257.9, 179.79999999999984, 253.40000000000003, 281.0, 204.3, 299.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-133.26934617568398, -231.33508955511596, -141.54832636684762, -163.07124198443327, -287.28044229910694, -283.11235028939893, 54.298672266741455, -338.6356435237227, -168.71779746930787, 45.0784089613483, 128.40168846105334, -43.24764543659495, -110.32207977378329, 145.73923276792385, -34.39247243668334, 77.80326723843106, -181.64885200983636, -220.1755407172795, -218.41396774138485, -303.6106055753068, -72.8823195648355, -363.9488718812387, -66.38319803731005, -410.3033212529699, 172.8181800666227, 26.346425735878718, -248.17255072416845, -211.94718232458231, -61.844908570630736, -387.7902139073872, -140.47019783898352, -341.8656986808817, -7.8935007964064, 321.2382057919424, 93.8327159819496, -196.9060782527562, -352.6698528370045, -152.9956141939493, -277.499982976676, -223.28440072935496, -192.31685138910996, -187.92970004013162, -230.43783870454104, -140.87018181956057, -134.80548266222885, -168.69917104711692, -150.79936889339564, -338.8600118068433, -125.44904043206118, -12.103675620153865, -160.08010289683185, 311.62956243797623, -215.50555857857324, -140.3361523169505, -344.5811774030343, -250.6755718571091, 188.62789560945018, -81.08746306720802, 158.8317947593684, -393.7712000769065, -426.1491198802001, -246.06747373316543, -394.51740883319985, -84.49867372453144, -216.9258292864798, -144.57821921780928, -1.760603901663121, -255.34148487306885, -178.08820943228096, -252.65463679648076, -132.32260296954146, -234.42566480613146, -147.30121589029025, 310.2152173944244, -36.180074915432456, -318.17249295561464, 344.8795064970693, 226.73569384222057, -235.9910052555717, -70.52067432106831, -90.23528644509314, -259.4485706561957, -7.340564560943108, -263.8904206622277, 120.22839950314763, 204.35832790033993, -9.783032202092187, -296.59160866363675, -228.88546691986278, 165.53457796070217, -121.22079145573207, 33.6125582654107, -127.47909403930325, -15.025239740630184, 54.444470057464045, -136.08944725789888, 21.552449291078766, 108.73741389718859, -53.332683580324435, 137.07145854787223], "policy_predator_policy_reward": [314.36934617568386, 357.4350895551159, 271.8483263668477, 328.57124198443313, 410.380442299107, 407.9123502893986, 105.10132773325876, 413.8356435237219, 336.81779746930795, 216.6215910386515, 163.89831153894664, 176.94764543659437, 266.7220797737833, 144.3607672320762, 275.39247243668336, 165.19673276156888, 339.7488520098362, 279.9755407172783, 321.6139677413844, 389.91060557530693, 270.68231956483555, 456.24887188123887, 166.98319803730902, 507.3033212529698, 115.6818199333773, 198.85357426412125, 369.3725507241686, 342.147182324582, 216.24490857063023, 459.1902139073884, 292.7701978389832, 430.2656986808814, 238.09350079640637, 43.061794208057655, 173.16728401805037, 341.1060782527562, 478.96985283700417, 313.5956141939494, 412.599982976676, 332.9844007293562, 332.01685138910983, 373.2297000401318, 368.5378387045411, 321.1701818195602, 301.705482662229, 340.8991710471168, 310.29936889339535, 452.86001180684366, 285.4490404320613, 233.30367562015383, 306.6801028968317, 48.97043756202388, 356.5055585785729, 292.43615231695014, 434.58117740303453, 360.4755718571086, 118.9721043905499, 275.6874630672083, 64.36820524063087, 472.2712000769068, 511.94911988019993, 360.86747373316496, 469.6174088332, 312.7986737245316, 363.9258292864797, 292.07821921780936, 196.960603901663, 399.94148487306893, 344.0882094322811, 368.75463679648084, 310.6226029695412, 382.02566480613154, 310.4012158902903, 3.084782605575571, 259.3800749154324, 433.77249295561467, 14.820493502930718, 101.86430615777937, 371.3910052555718, 270.32067432106834, 298.73528644509327, 396.9485706561956, 239.940564560943, 364.19042066222755, 135.77160049685233, 114.64167209966011, 234.18303220209225, 393.0916086636363, 354.9854669198626, 128.7654220392979, 285.02079145573185, 187.4874417345893, 320.67909403930304, 236.52523974063016, 203.455529942536, 315.88944725789867, 231.84755070892126, 172.2625861028114, 257.63268358032434, 162.3285414521276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.459811742709357, "mean_inference_ms": 3.27703441660455, "mean_action_processing_ms": 0.8241785672291343, "mean_env_wait_ms": 9.940156658516393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018043041229248047, "StateBufferConnector_ms": 0.0034046173095703125, "ViewRequirementAgentConnector_ms": 0.0636359453201294}, "num_episodes": 15, "episode_return_max": 364.3, "episode_return_min": 59.80000000000031, "episode_return_mean": 178.32699999999994, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.42496837483424, "num_env_steps_trained_throughput_per_sec": 159.42496837483424, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 25133.184, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25133.064, "sample_time_ms": 1766.537, "learn_time_ms": 23340.024, "learn_throughput": 171.379, "synch_weights_time_ms": 24.586}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "done": false, "training_iteration": 97, "trial_id": "cbf82_00000", "date": "2024-08-21_13-49-00", "timestamp": 1724228340, "time_this_iter_s": 25.1418879032135, "time_total_s": 2513.5801203250885, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e9a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2513.5801203250885, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 31.788571428571434, "ram_util_percent": 79.81714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.852335959797104, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.581741764644781, "policy_loss": -0.008567188093244719, "vf_loss": 5.587934737652541, "vf_explained_var": 0.17835518326610328, "kl": 0.011871147007089652, "entropy": 0.7916612746814887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.479049680754542, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.52268308699131, "policy_loss": -0.017963653163557563, "vf_loss": 6.537890437742075, "vf_explained_var": 0.1393640740464131, "kl": 0.013781535784316172, "entropy": 0.578015239847203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 385.1, "episode_reward_min": 59.80000000000031, "episode_reward_mean": 183.86899999999991, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -426.1491198802001, "predator_policy": 3.084782605575571}, "policy_reward_max": {"prey_policy": 365.741446791986, "predator_policy": 511.94911988019993}, "policy_reward_mean": {"prey_policy": -100.46731957687778, "predator_policy": 284.3363195768777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.20000000000005, 168.1, 261.7, 292.30000000000007, 133.7000000000002, 156.39999999999986, 290.1, 241.00000000000003, 242.9999999999999, 158.1, 59.80000000000031, 103.19999999999939, 86.29999999999995, 197.7999999999999, 92.29999999999995, 100.59999999999893, 97.0, 288.4999999999999, 225.19999999999973, 121.19999999999996, 130.1999999999998, 154.39999999999947, 71.39999999999971, 152.29999999999967, 88.4, 230.2, 364.3, 266.99999999999994, 144.19999999999993, 126.3, 160.59999999999985, 135.10000000000002, 109.69999999999976, 139.69999999999987, 185.29999999999995, 138.09999999999997, 180.29999999999995, 166.89999999999992, 172.2, 159.49999999999983, 113.99999999999994, 160.00000000000003, 221.19999999999982, 146.60000000000008, 360.6, 140.9999999999999, 152.09999999999948, 90.0, 109.79999999999998, 307.6, 194.59999999999997, 223.19999999999925, 78.50000000000001, 85.79999999999998, 114.80000000000007, 75.1, 228.3, 146.99999999999997, 147.5000000000001, 195.19999999999965, 144.59999999999997, 166.0, 116.1, 178.3, 147.59999999999997, 163.1, 313.29999999999995, 223.2, 115.59999999999997, 359.7, 328.6, 135.39999999999995, 199.79999999999995, 208.5, 137.50000000000003, 232.5999999999999, 100.29999999999995, 255.9999999999999, 319.0, 224.39999999999998, 96.50000000000003, 126.10000000000002, 294.3, 163.7999999999999, 221.10000000000002, 193.19999999999996, 221.50000000000003, 257.9, 179.79999999999984, 253.40000000000003, 281.0, 204.3, 299.4, 385.1, 284.0, 142.09999999999997, 167.5, 235.8, 121.79999999999998, 228.2], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-338.6356435237227, -168.71779746930787, 45.0784089613483, 128.40168846105334, -43.24764543659495, -110.32207977378329, 145.73923276792385, -34.39247243668334, 77.80326723843106, -181.64885200983636, -220.1755407172795, -218.41396774138485, -303.6106055753068, -72.8823195648355, -363.9488718812387, -66.38319803731005, -410.3033212529699, 172.8181800666227, 26.346425735878718, -248.17255072416845, -211.94718232458231, -61.844908570630736, -387.7902139073872, -140.47019783898352, -341.8656986808817, -7.8935007964064, 321.2382057919424, 93.8327159819496, -196.9060782527562, -352.6698528370045, -152.9956141939493, -277.499982976676, -223.28440072935496, -192.31685138910996, -187.92970004013162, -230.43783870454104, -140.87018181956057, -134.80548266222885, -168.69917104711692, -150.79936889339564, -338.8600118068433, -125.44904043206118, -12.103675620153865, -160.08010289683185, 311.62956243797623, -215.50555857857324, -140.3361523169505, -344.5811774030343, -250.6755718571091, 188.62789560945018, -81.08746306720802, 158.8317947593684, -393.7712000769065, -426.1491198802001, -246.06747373316543, -394.51740883319985, -84.49867372453144, -216.9258292864798, -144.57821921780928, -1.760603901663121, -255.34148487306885, -178.08820943228096, -252.65463679648076, -132.32260296954146, -234.42566480613146, -147.30121589029025, 310.2152173944244, -36.180074915432456, -318.17249295561464, 344.8795064970693, 226.73569384222057, -235.9910052555717, -70.52067432106831, -90.23528644509314, -259.4485706561957, -7.340564560943108, -263.8904206622277, 120.22839950314763, 204.35832790033993, -9.783032202092187, -296.59160866363675, -228.88546691986278, 165.53457796070217, -121.22079145573207, 33.6125582654107, -127.47909403930325, -15.025239740630184, 54.444470057464045, -136.08944725789888, 21.552449291078766, 108.73741389718859, -53.332683580324435, 137.07145854787223, 365.741446791986, 123.90534419674964, -203.6681584355929, -191.98229040482008, 84.39660373069569, -192.2585213294807, -41.43519036491887], "policy_predator_policy_reward": [413.8356435237219, 336.81779746930795, 216.6215910386515, 163.89831153894664, 176.94764543659437, 266.7220797737833, 144.3607672320762, 275.39247243668336, 165.19673276156888, 339.7488520098362, 279.9755407172783, 321.6139677413844, 389.91060557530693, 270.68231956483555, 456.24887188123887, 166.98319803730902, 507.3033212529698, 115.6818199333773, 198.85357426412125, 369.3725507241686, 342.147182324582, 216.24490857063023, 459.1902139073884, 292.7701978389832, 430.2656986808814, 238.09350079640637, 43.061794208057655, 173.16728401805037, 341.1060782527562, 478.96985283700417, 313.5956141939494, 412.599982976676, 332.9844007293562, 332.01685138910983, 373.2297000401318, 368.5378387045411, 321.1701818195602, 301.705482662229, 340.8991710471168, 310.29936889339535, 452.86001180684366, 285.4490404320613, 233.30367562015383, 306.6801028968317, 48.97043756202388, 356.5055585785729, 292.43615231695014, 434.58117740303453, 360.4755718571086, 118.9721043905499, 275.6874630672083, 64.36820524063087, 472.2712000769068, 511.94911988019993, 360.86747373316496, 469.6174088332, 312.7986737245316, 363.9258292864797, 292.07821921780936, 196.960603901663, 399.94148487306893, 344.0882094322811, 368.75463679648084, 310.6226029695412, 382.02566480613154, 310.4012158902903, 3.084782605575571, 259.3800749154324, 433.77249295561467, 14.820493502930718, 101.86430615777937, 371.3910052555718, 270.32067432106834, 298.73528644509327, 396.9485706561956, 239.940564560943, 364.19042066222755, 135.77160049685233, 114.64167209966011, 234.18303220209225, 393.0916086636363, 354.9854669198626, 128.7654220392979, 285.02079145573185, 187.4874417345893, 320.67909403930304, 236.52523974063016, 203.455529942536, 315.88944725789867, 231.84755070892126, 172.2625861028114, 257.63268358032434, 162.3285414521276, 19.358553208014058, 160.09465580325033, 345.76815843559297, 359.4822904048202, 151.40339626930435, 314.05852132948064, 269.6351903649189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4546664616807004, "mean_inference_ms": 3.2721063087101423, "mean_action_processing_ms": 0.8232306250414234, "mean_env_wait_ms": 9.939006915195833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01813948154449463, "StateBufferConnector_ms": 0.003414630889892578, "ViewRequirementAgentConnector_ms": 0.06354498863220215}, "num_episodes": 7, "episode_return_max": 385.1, "episode_return_min": 59.80000000000031, "episode_return_mean": 183.86899999999991, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.93880057815934, "num_env_steps_trained_throughput_per_sec": 159.93880057815934, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 25138.668, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25138.549, "sample_time_ms": 1772.552, "learn_time_ms": 23339.624, "learn_throughput": 171.382, "synch_weights_time_ms": 24.664}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 98, "trial_id": "cbf82_00000", "date": "2024-08-21_13-49-25", "timestamp": 1724228365, "time_this_iter_s": 25.044491052627563, "time_total_s": 2538.624611377716, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17bf18040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2538.624611377716, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 31.76388888888889, "ram_util_percent": 80.1222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.294858594611287, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.003373787055413, "policy_loss": -0.005567013154601833, "vf_loss": 5.007133524864912, "vf_explained_var": 0.18009444947044054, "kl": 0.009036286118498538, "entropy": 0.8344589229052265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.00805088368555, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 6.257681720952193, "policy_loss": -0.02077690382526877, "vf_loss": 6.276089705030123, "vf_explained_var": 0.19015495311468839, "kl": 0.011844561501493444, "entropy": 0.6142528614029288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 385.1, "episode_reward_min": 59.80000000000031, "episode_reward_mean": 183.65199999999993, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -426.1491198802001, "predator_policy": 3.084782605575571}, "policy_reward_max": {"prey_policy": 365.741446791986, "predator_policy": 511.94911988019993}, "policy_reward_mean": {"prey_policy": -103.90501385248982, "predator_policy": 287.5570138524898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [158.1, 59.80000000000031, 103.19999999999939, 86.29999999999995, 197.7999999999999, 92.29999999999995, 100.59999999999893, 97.0, 288.4999999999999, 225.19999999999973, 121.19999999999996, 130.1999999999998, 154.39999999999947, 71.39999999999971, 152.29999999999967, 88.4, 230.2, 364.3, 266.99999999999994, 144.19999999999993, 126.3, 160.59999999999985, 135.10000000000002, 109.69999999999976, 139.69999999999987, 185.29999999999995, 138.09999999999997, 180.29999999999995, 166.89999999999992, 172.2, 159.49999999999983, 113.99999999999994, 160.00000000000003, 221.19999999999982, 146.60000000000008, 360.6, 140.9999999999999, 152.09999999999948, 90.0, 109.79999999999998, 307.6, 194.59999999999997, 223.19999999999925, 78.50000000000001, 85.79999999999998, 114.80000000000007, 75.1, 228.3, 146.99999999999997, 147.5000000000001, 195.19999999999965, 144.59999999999997, 166.0, 116.1, 178.3, 147.59999999999997, 163.1, 313.29999999999995, 223.2, 115.59999999999997, 359.7, 328.6, 135.39999999999995, 199.79999999999995, 208.5, 137.50000000000003, 232.5999999999999, 100.29999999999995, 255.9999999999999, 319.0, 224.39999999999998, 96.50000000000003, 126.10000000000002, 294.3, 163.7999999999999, 221.10000000000002, 193.19999999999996, 221.50000000000003, 257.9, 179.79999999999984, 253.40000000000003, 281.0, 204.3, 299.4, 385.1, 284.0, 142.09999999999997, 167.5, 235.8, 121.79999999999998, 228.2, 333.40000000000003, 97.49999999999999, 169.69999999999996, 183.29999999999998, 292.1, 159.5, 190.2, 235.8, 178.3], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-181.64885200983636, -220.1755407172795, -218.41396774138485, -303.6106055753068, -72.8823195648355, -363.9488718812387, -66.38319803731005, -410.3033212529699, 172.8181800666227, 26.346425735878718, -248.17255072416845, -211.94718232458231, -61.844908570630736, -387.7902139073872, -140.47019783898352, -341.8656986808817, -7.8935007964064, 321.2382057919424, 93.8327159819496, -196.9060782527562, -352.6698528370045, -152.9956141939493, -277.499982976676, -223.28440072935496, -192.31685138910996, -187.92970004013162, -230.43783870454104, -140.87018181956057, -134.80548266222885, -168.69917104711692, -150.79936889339564, -338.8600118068433, -125.44904043206118, -12.103675620153865, -160.08010289683185, 311.62956243797623, -215.50555857857324, -140.3361523169505, -344.5811774030343, -250.6755718571091, 188.62789560945018, -81.08746306720802, 158.8317947593684, -393.7712000769065, -426.1491198802001, -246.06747373316543, -394.51740883319985, -84.49867372453144, -216.9258292864798, -144.57821921780928, -1.760603901663121, -255.34148487306885, -178.08820943228096, -252.65463679648076, -132.32260296954146, -234.42566480613146, -147.30121589029025, 310.2152173944244, -36.180074915432456, -318.17249295561464, 344.8795064970693, 226.73569384222057, -235.9910052555717, -70.52067432106831, -90.23528644509314, -259.4485706561957, -7.340564560943108, -263.8904206622277, 120.22839950314763, 204.35832790033993, -9.783032202092187, -296.59160866363675, -228.88546691986278, 165.53457796070217, -121.22079145573207, 33.6125582654107, -127.47909403930325, -15.025239740630184, 54.444470057464045, -136.08944725789888, 21.552449291078766, 108.73741389718859, -53.332683580324435, 137.07145854787223, 365.741446791986, 123.90534419674964, -203.6681584355929, -191.98229040482008, 84.39660373069569, -192.2585213294807, -41.43519036491887, 251.0076585969046, -311.1624722793418, -116.18555079034613, -138.07513222928412, 140.35922605234614, -171.23127074592662, -148.06409276294067, 23.80980469199101, -172.52063930594056], "policy_predator_policy_reward": [339.7488520098362, 279.9755407172783, 321.6139677413844, 389.91060557530693, 270.68231956483555, 456.24887188123887, 166.98319803730902, 507.3033212529698, 115.6818199333773, 198.85357426412125, 369.3725507241686, 342.147182324582, 216.24490857063023, 459.1902139073884, 292.7701978389832, 430.2656986808814, 238.09350079640637, 43.061794208057655, 173.16728401805037, 341.1060782527562, 478.96985283700417, 313.5956141939494, 412.599982976676, 332.9844007293562, 332.01685138910983, 373.2297000401318, 368.5378387045411, 321.1701818195602, 301.705482662229, 340.8991710471168, 310.29936889339535, 452.86001180684366, 285.4490404320613, 233.30367562015383, 306.6801028968317, 48.97043756202388, 356.5055585785729, 292.43615231695014, 434.58117740303453, 360.4755718571086, 118.9721043905499, 275.6874630672083, 64.36820524063087, 472.2712000769068, 511.94911988019993, 360.86747373316496, 469.6174088332, 312.7986737245316, 363.9258292864797, 292.07821921780936, 196.960603901663, 399.94148487306893, 344.0882094322811, 368.75463679648084, 310.6226029695412, 382.02566480613154, 310.4012158902903, 3.084782605575571, 259.3800749154324, 433.77249295561467, 14.820493502930718, 101.86430615777937, 371.3910052555718, 270.32067432106834, 298.73528644509327, 396.9485706561956, 239.940564560943, 364.19042066222755, 135.77160049685233, 114.64167209966011, 234.18303220209225, 393.0916086636363, 354.9854669198626, 128.7654220392979, 285.02079145573185, 187.4874417345893, 320.67909403930304, 236.52523974063016, 203.455529942536, 315.88944725789867, 231.84755070892126, 172.2625861028114, 257.63268358032434, 162.3285414521276, 19.358553208014058, 160.09465580325033, 345.76815843559297, 359.4822904048202, 151.40339626930435, 314.05852132948064, 269.6351903649189, 82.3923414030954, 408.6624722793418, 285.88555079034603, 321.37513222928436, 151.74077394765388, 330.73127074592657, 338.26409276294055, 211.99019530800896, 350.82063930594035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4456681432945144, "mean_inference_ms": 3.270917600540261, "mean_action_processing_ms": 0.8156177786625411, "mean_env_wait_ms": 9.930113903716787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01815485954284668, "StateBufferConnector_ms": 0.0034047365188598633, "ViewRequirementAgentConnector_ms": 0.06401562690734863}, "num_episodes": 9, "episode_return_max": 385.1, "episode_return_min": 59.80000000000031, "episode_return_mean": 183.65199999999993, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.37615178016082, "num_env_steps_trained_throughput_per_sec": 161.37615178016082, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 25125.182, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25125.049, "sample_time_ms": 1775.664, "learn_time_ms": 23324.056, "learn_throughput": 171.497, "synch_weights_time_ms": 23.534}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 99, "trial_id": "cbf82_00000", "date": "2024-08-21_13-49-50", "timestamp": 1724228390, "time_this_iter_s": 24.820471048355103, "time_total_s": 2563.445082426071, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x177e9a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2563.445082426071, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 29.034285714285712, "ram_util_percent": 79.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.327926752095421, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 4.53912201176087, "policy_loss": -0.0043575791040590655, "vf_loss": 4.5418206808467705, "vf_explained_var": 0.21644849150131146, "kl": 0.00829451479949057, "entropy": 0.8927441004663705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.455866525446375, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.553951697796583, "policy_loss": -0.025589140700079345, "vf_loss": 5.577154361704985, "vf_explained_var": 0.3493734675149123, "kl": 0.011932285690151426, "entropy": 0.6116410556249321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 385.1, "episode_reward_min": 71.39999999999971, "episode_reward_mean": 192.50599999999994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -426.1491198802001, "predator_policy": 3.084782605575571}, "policy_reward_max": {"prey_policy": 365.741446791986, "predator_policy": 511.94911988019993}, "policy_reward_mean": {"prey_policy": -85.28106972989353, "predator_policy": 277.78706972989346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.39999999999971, 152.29999999999967, 88.4, 230.2, 364.3, 266.99999999999994, 144.19999999999993, 126.3, 160.59999999999985, 135.10000000000002, 109.69999999999976, 139.69999999999987, 185.29999999999995, 138.09999999999997, 180.29999999999995, 166.89999999999992, 172.2, 159.49999999999983, 113.99999999999994, 160.00000000000003, 221.19999999999982, 146.60000000000008, 360.6, 140.9999999999999, 152.09999999999948, 90.0, 109.79999999999998, 307.6, 194.59999999999997, 223.19999999999925, 78.50000000000001, 85.79999999999998, 114.80000000000007, 75.1, 228.3, 146.99999999999997, 147.5000000000001, 195.19999999999965, 144.59999999999997, 166.0, 116.1, 178.3, 147.59999999999997, 163.1, 313.29999999999995, 223.2, 115.59999999999997, 359.7, 328.6, 135.39999999999995, 199.79999999999995, 208.5, 137.50000000000003, 232.5999999999999, 100.29999999999995, 255.9999999999999, 319.0, 224.39999999999998, 96.50000000000003, 126.10000000000002, 294.3, 163.7999999999999, 221.10000000000002, 193.19999999999996, 221.50000000000003, 257.9, 179.79999999999984, 253.40000000000003, 281.0, 204.3, 299.4, 385.1, 284.0, 142.09999999999997, 167.5, 235.8, 121.79999999999998, 228.2, 333.40000000000003, 97.49999999999999, 169.69999999999996, 183.29999999999998, 292.1, 159.5, 190.2, 235.8, 178.3, 224.39999999999998, 200.5, 149.79999999999995, 166.70000000000002, 195.0999999999998, 331.1, 122.49999999999972, 204.69999999999996, 264.29999999999995, 155.6, 271.1, 209.39999999999972, 204.79999999999953], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-387.7902139073872, -140.47019783898352, -341.8656986808817, -7.8935007964064, 321.2382057919424, 93.8327159819496, -196.9060782527562, -352.6698528370045, -152.9956141939493, -277.499982976676, -223.28440072935496, -192.31685138910996, -187.92970004013162, -230.43783870454104, -140.87018181956057, -134.80548266222885, -168.69917104711692, -150.79936889339564, -338.8600118068433, -125.44904043206118, -12.103675620153865, -160.08010289683185, 311.62956243797623, -215.50555857857324, -140.3361523169505, -344.5811774030343, -250.6755718571091, 188.62789560945018, -81.08746306720802, 158.8317947593684, -393.7712000769065, -426.1491198802001, -246.06747373316543, -394.51740883319985, -84.49867372453144, -216.9258292864798, -144.57821921780928, -1.760603901663121, -255.34148487306885, -178.08820943228096, -252.65463679648076, -132.32260296954146, -234.42566480613146, -147.30121589029025, 310.2152173944244, -36.180074915432456, -318.17249295561464, 344.8795064970693, 226.73569384222057, -235.9910052555717, -70.52067432106831, -90.23528644509314, -259.4485706561957, -7.340564560943108, -263.8904206622277, 120.22839950314763, 204.35832790033993, -9.783032202092187, -296.59160866363675, -228.88546691986278, 165.53457796070217, -121.22079145573207, 33.6125582654107, -127.47909403930325, -15.025239740630184, 54.444470057464045, -136.08944725789888, 21.552449291078766, 108.73741389718859, -53.332683580324435, 137.07145854787223, 365.741446791986, 123.90534419674964, -203.6681584355929, -191.98229040482008, 84.39660373069569, -192.2585213294807, -41.43519036491887, 251.0076585969046, -311.1624722793418, -116.18555079034613, -138.07513222928412, 140.35922605234614, -171.23127074592662, -148.06409276294067, 23.80980469199101, -172.52063930594056, 43.08373392425979, -15.6384460796896, -175.5685900065202, -80.6881086802319, -84.60894083586594, 218.11642700471964, -199.05590448331557, -31.890495553325508, 81.0507146090378, -191.8227868235577, 102.48293019689389, -3.621540289532007, 40.388706679716755], "policy_predator_policy_reward": [459.1902139073884, 292.7701978389832, 430.2656986808814, 238.09350079640637, 43.061794208057655, 173.16728401805037, 341.1060782527562, 478.96985283700417, 313.5956141939494, 412.599982976676, 332.9844007293562, 332.01685138910983, 373.2297000401318, 368.5378387045411, 321.1701818195602, 301.705482662229, 340.8991710471168, 310.29936889339535, 452.86001180684366, 285.4490404320613, 233.30367562015383, 306.6801028968317, 48.97043756202388, 356.5055585785729, 292.43615231695014, 434.58117740303453, 360.4755718571086, 118.9721043905499, 275.6874630672083, 64.36820524063087, 472.2712000769068, 511.94911988019993, 360.86747373316496, 469.6174088332, 312.7986737245316, 363.9258292864797, 292.07821921780936, 196.960603901663, 399.94148487306893, 344.0882094322811, 368.75463679648084, 310.6226029695412, 382.02566480613154, 310.4012158902903, 3.084782605575571, 259.3800749154324, 433.77249295561467, 14.820493502930718, 101.86430615777937, 371.3910052555718, 270.32067432106834, 298.73528644509327, 396.9485706561956, 239.940564560943, 364.19042066222755, 135.77160049685233, 114.64167209966011, 234.18303220209225, 393.0916086636363, 354.9854669198626, 128.7654220392979, 285.02079145573185, 187.4874417345893, 320.67909403930304, 236.52523974063016, 203.455529942536, 315.88944725789867, 231.84755070892126, 172.2625861028114, 257.63268358032434, 162.3285414521276, 19.358553208014058, 160.09465580325033, 345.76815843559297, 359.4822904048202, 151.40339626930435, 314.05852132948064, 269.6351903649189, 82.3923414030954, 408.6624722793418, 285.88555079034603, 321.37513222928436, 151.74077394765388, 330.73127074592657, 338.26409276294055, 211.99019530800896, 350.82063930594035, 181.31626607574034, 216.1384460796896, 325.3685900065201, 247.38810868023177, 279.70894083586575, 112.98357299528041, 321.55590448331554, 236.59049555332555, 183.24928539096194, 347.4227868235578, 168.6170698031061, 213.021540289532, 164.41129332028288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4416394103203545, "mean_inference_ms": 3.2537987090211438, "mean_action_processing_ms": 0.820345606676633, "mean_env_wait_ms": 9.938169331184895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018158316612243652, "StateBufferConnector_ms": 0.0033926963806152344, "ViewRequirementAgentConnector_ms": 0.07922661304473877}, "num_episodes": 13, "episode_return_max": 385.1, "episode_return_min": 71.39999999999971, "episode_return_mean": 192.50599999999994, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.20738056551264, "num_env_steps_trained_throughput_per_sec": 160.20738056551264, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 25106.348, "restore_workers_time_ms": 0.021, "training_step_time_ms": 25106.218, "sample_time_ms": 1787.749, "learn_time_ms": 23292.742, "learn_throughput": 171.727, "synch_weights_time_ms": 23.998}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": true, "training_iteration": 100, "trial_id": "cbf82_00000", "date": "2024-08-21_13-50-15", "timestamp": 1724228415, "time_this_iter_s": 24.99175214767456, "time_total_s": 2588.4368345737457, "pid": 66447, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 1, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 1, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3075cc8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2588.4368345737457, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 29.214285714285715, "ram_util_percent": 79.29714285714286}}
