{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5649347968360103, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.526375646944399, "policy_loss": -0.007021609428659002, "vf_loss": 6.531018724643364, "vf_explained_var": 0.037718871251615896, "kl": 0.01189258074520424, "entropy": 1.5975859882970336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.113960160439213, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.017159982522329, "policy_loss": -0.016807838199990027, "vf_loss": 6.030700013041496, "vf_explained_var": -0.004097178267935912, "kl": 0.016339020637842438, "entropy": 1.593701897809903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 18.37553862514383, "episode_reward_min": -10.052713164197916, "episode_reward_mean": 1.4741202542157974, "episode_len_mean": 346.7, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3467, "policy_reward_min": {"agent_policy": -18.375538625143818, "adversary_policy": -22.913137102626138}, "policy_reward_max": {"agent_policy": 10.052713164197915, "adversary_policy": 22.88996899494115}, "policy_reward_mean": {"agent_policy": -1.4741202542157972, "adversary_policy": 1.4741202542157963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.822163082040699, -2.7730039007984146, 5.155110304916533, -7.966238046470586, -8.825908070037995, -10.052713164197916, 3.6974098005712106, -3.2363724505696947, 18.37553862514383, 12.545216361560309], "episode_lengths": [21, 400, 400, 400, 400, 400, 400, 400, 400, 246], "policy_agent_policy_reward": [-7.822163082040701, 2.7730039007984146, -5.155110304916533, 7.966238046470586, 8.825908070037995, 10.052713164197915, -3.6974098005712097, 3.236372450569694, -18.375538625143818, -12.545216361560314], "policy_adversary_policy_reward": [7.190550680793116, 8.453775483288284, -7.9593678999186395, 2.41336009832181, -4.025325754617732, 14.3355463644508, -10.55092643047918, -5.3815496624619925, 5.261320962550148, -22.913137102626138, -7.252312927593973, -12.85311340080186, -1.0991891972102934, 8.494008798352713, 0.6470989443626873, -7.1198438455020785, 13.86110825534649, 22.88996899494115, 5.387764037150362, 19.70266868597026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7070867452007844, "mean_inference_ms": 2.2528609826101453, "mean_action_processing_ms": 0.3647994864177372, "mean_env_wait_ms": 0.1385360849578176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005582571029663086, "StateBufferConnector_ms": 0.0036203861236572266, "ViewRequirementAgentConnector_ms": 0.1426839828491211}, "num_episodes": 10, "episode_return_max": 18.37553862514383, "episode_return_min": -10.052713164197916, "episode_return_mean": 1.4741202542157974}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.6204169012665, "num_env_steps_trained_throughput_per_sec": 347.6204169012665, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11506.815, "restore_workers_time_ms": 0.049, "training_step_time_ms": 11506.518, "sample_time_ms": 1745.197, "learn_time_ms": 9742.877, "learn_throughput": 410.556, "synch_weights_time_ms": 14.43}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "017ef_00000", "date": "2024-08-10_12-10-28", "timestamp": 1723306228, "time_this_iter_s": 11.563249826431274, "time_total_s": 11.563249826431274, "pid": 63420, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a44570d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.563249826431274, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.08235294117647, "ram_util_percent": 83.53529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7939916811134449, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.855933409140854, "policy_loss": -0.0025108063866990426, "vf_loss": 6.857246451907688, "vf_explained_var": -0.014526471542933631, "kl": 0.005988802385086988, "entropy": 1.5931164763591907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4252626936261854, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5559543870389465, "policy_loss": -0.014859967084218322, "vf_loss": 5.567731461673975, "vf_explained_var": 0.07651971969753504, "kl": 0.015414538521795218, "entropy": 1.5662161474426588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 18.37553862514383, "episode_reward_min": -37.700591191172, "episode_reward_mean": -4.175138283195265, "episode_len_mean": 371.94736842105266, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 7067, "policy_reward_min": {"agent_policy": -18.375538625143818, "adversary_policy": -40.50134123681434}, "policy_reward_max": {"agent_policy": 37.70059119117198, "adversary_policy": 22.88996899494115}, "policy_reward_mean": {"agent_policy": 4.175138283195264, "adversary_policy": -4.1751382831952615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.822163082040699, -2.7730039007984146, 5.155110304916533, -7.966238046470586, -8.825908070037995, -10.052713164197916, 3.6974098005712106, -3.2363724505696947, 18.37553862514383, 12.545216361560309, -0.2427643300301252, 5.7654022324927645, 6.794830687019142, -37.700591191172, -13.625019474726681, -32.31892449516165, -17.36892980134197, -9.692727124085057, 4.319893574137563], "episode_lengths": [21, 400, 400, 400, 400, 400, 400, 400, 400, 246, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-7.822163082040701, 2.7730039007984146, -5.155110304916533, 7.966238046470586, 8.825908070037995, 10.052713164197915, -3.6974098005712097, 3.236372450569694, -18.375538625143818, -12.545216361560314, 0.2427643300301252, -5.7654022324927645, -6.794830687019142, 37.70059119117198, 13.625019474726681, 32.31892449516167, 17.36892980134197, 9.692727124085057, -4.319893574137563], "policy_adversary_policy_reward": [7.190550680793116, 8.453775483288284, -7.9593678999186395, 2.41336009832181, -4.025325754617732, 14.3355463644508, -10.55092643047918, -5.3815496624619925, 5.261320962550148, -22.913137102626138, -7.252312927593973, -12.85311340080186, -1.0991891972102934, 8.494008798352713, 0.6470989443626873, -7.1198438455020785, 13.86110825534649, 22.88996899494115, 5.387764037150362, 19.70266868597026, 5.252807574226868, -5.738336234287113, 19.946493259446907, -8.415688794461378, 15.04105475743575, -1.4513933833974662, -40.50134123681434, -34.8998411455295, -25.660896572276368, -1.589142377176998, -37.00821779471302, -27.629631195610298, 4.515637787047879, -39.25349738973182, -9.246212657885714, -10.1392415902844, 15.047378487595715, -6.407591339320589]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6881864403625082, "mean_inference_ms": 2.1538874916378448, "mean_action_processing_ms": 0.3459502160525837, "mean_env_wait_ms": 0.13721095189224902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005415238832172595, "StateBufferConnector_ms": 0.003196063794587788, "ViewRequirementAgentConnector_ms": 0.11658982226723119}, "num_episodes": 9, "episode_return_max": 18.37553862514383, "episode_return_min": -37.700591191172, "episode_return_mean": -4.175138283195265}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.1340825749047, "num_env_steps_trained_throughput_per_sec": 420.1340825749047, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 10513.843, "restore_workers_time_ms": 0.137, "training_step_time_ms": 10513.477, "sample_time_ms": 1626.413, "learn_time_ms": 8867.965, "learn_throughput": 451.062, "synch_weights_time_ms": 16.346}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 2, "trial_id": "017ef_00000", "date": "2024-08-10_12-10-41", "timestamp": 1723306241, "time_this_iter_s": 9.569156169891357, "time_total_s": 21.132405996322632, "pid": 63420, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4457160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21.132405996322632, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 52.038888888888884, "ram_util_percent": 83.53888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3039871104179865, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.178020256536978, "policy_loss": -0.004379639026299908, "vf_loss": 6.180685787856894, "vf_explained_var": -0.024334782078152612, "kl": 0.00857058657841768, "entropy": 1.598489003837424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4863528412766756, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4606199582417805, "policy_loss": -0.006809795510101442, "vf_loss": 5.4648632923762, "vf_explained_var": 0.09301654951026042, "kl": 0.012832231306590296, "entropy": 1.4872986380010844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 18.37553862514383, "episode_reward_min": -37.700591191172, "episode_reward_mean": -5.6928675684336065, "episode_len_mean": 360.8, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 10824, "policy_reward_min": {"agent_policy": -18.375538625143818, "adversary_policy": -40.50134123681434}, "policy_reward_max": {"agent_policy": 37.70059119117198, "adversary_policy": 23.132546830796535}, "policy_reward_mean": {"agent_policy": 5.6928675684336065, "adversary_policy": -5.692867568433605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.822163082040699, -2.7730039007984146, 5.155110304916533, -7.966238046470586, -8.825908070037995, -10.052713164197916, 3.6974098005712106, -3.2363724505696947, 18.37553862514383, 12.545216361560309, -0.2427643300301252, 5.7654022324927645, 6.794830687019142, -37.700591191172, -13.625019474726681, -32.31892449516165, -17.36892980134197, -9.692727124085057, 4.319893574137563, -21.848176134982378, 1.5411589798728857, -6.25098597311356, -17.546246671096906, -2.822168238770083, 7.03389592624676, 13.034378588102653, -9.358418134738274, -17.61685621995432, -17.9872606486913, -19.637721145173632], "episode_lengths": [21, 400, 400, 400, 400, 400, 400, 400, 400, 246, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 36, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-7.822163082040701, 2.7730039007984146, -5.155110304916533, 7.966238046470586, 8.825908070037995, 10.052713164197915, -3.6974098005712097, 3.236372450569694, -18.375538625143818, -12.545216361560314, 0.2427643300301252, -5.7654022324927645, -6.794830687019142, 37.70059119117198, 13.625019474726681, 32.31892449516167, 17.36892980134197, 9.692727124085057, -4.319893574137563, 21.848176134982374, -1.541158979872884, 6.250985973113558, 17.546246671096906, 2.822168238770083, -7.033895926246757, -13.034378588102651, 9.358418134738283, 17.616856219954325, 17.987260648691297, 19.637721145173614], "policy_adversary_policy_reward": [7.190550680793116, 8.453775483288284, -7.9593678999186395, 2.41336009832181, -4.025325754617732, 14.3355463644508, -10.55092643047918, -5.3815496624619925, 5.261320962550148, -22.913137102626138, -7.252312927593973, -12.85311340080186, -1.0991891972102934, 8.494008798352713, 0.6470989443626873, -7.1198438455020785, 13.86110825534649, 22.88996899494115, 5.387764037150362, 19.70266868597026, 5.252807574226868, -5.738336234287113, 19.946493259446907, -8.415688794461378, 15.04105475743575, -1.4513933833974662, -40.50134123681434, -34.8998411455295, -25.660896572276368, -1.589142377176998, -37.00821779471302, -27.629631195610298, 4.515637787047879, -39.25349738973182, -9.246212657885714, -10.1392415902844, 15.047378487595715, -6.407591339320589, -16.416851045283853, -27.2795012246809, -1.1792912593409621, 4.261609219086732, -32.824923701687375, 20.322951755460256, -15.474456616014688, -19.618036726179124, 7.195863232883096, -12.84019971042326, 15.478175080251269, -1.4103832277577553, 2.9362103454087674, 23.132546830796535, -31.584893319521434, 12.86805705004489, -32.040898135773226, -3.1928143041354318, -5.272904284373148, -30.701617013009443, -16.7588848529287, -22.51655743741855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6489253806881566, "mean_inference_ms": 2.0029098832532832, "mean_action_processing_ms": 0.3202960658828092, "mean_env_wait_ms": 0.13041408835782914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004826784133911133, "StateBufferConnector_ms": 0.002957582473754883, "ViewRequirementAgentConnector_ms": 0.09470661481221516}, "num_episodes": 11, "episode_return_max": 18.37553862514383, "episode_return_min": -37.700591191172, "episode_return_mean": -5.6928675684336065}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 469.5018575825575, "num_env_steps_trained_throughput_per_sec": 469.5018575825575, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 9849.132, "restore_workers_time_ms": 0.1, "training_step_time_ms": 9848.808, "sample_time_ms": 1418.432, "learn_time_ms": 8409.404, "learn_throughput": 475.658, "synch_weights_time_ms": 18.276}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 3, "trial_id": "017ef_00000", "date": "2024-08-10_12-10-50", "timestamp": 1723306250, "time_this_iter_s": 8.577505826950073, "time_total_s": 29.709911823272705, "pid": 63420, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a44575e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29.709911823272705, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 36.184615384615384, "ram_util_percent": 83.1923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.512628538236416, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.639746109644572, "policy_loss": -0.004623732851108625, "vf_loss": 5.642778826516772, "vf_explained_var": 0.07075570351863034, "kl": 0.007955032030631916, "entropy": 1.5887404103127738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8276807252628107, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.943199070294698, "policy_loss": -0.00618137204486023, "vf_loss": 4.946385613083839, "vf_explained_var": 0.020242299077411492, "kl": 0.014974200903453005, "entropy": 1.3871961861848832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 18.37553862514383, "episode_reward_min": -37.700591191172, "episode_reward_mean": -6.511643036058108, "episode_len_mean": 362.675, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 14507, "policy_reward_min": {"agent_policy": -18.375538625143818, "adversary_policy": -40.50134123681434}, "policy_reward_max": {"agent_policy": 37.70059119117198, "adversary_policy": 29.052591656817402}, "policy_reward_mean": {"agent_policy": 6.511643036058109, "adversary_policy": -6.511643036058106}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.822163082040699, -2.7730039007984146, 5.155110304916533, -7.966238046470586, -8.825908070037995, -10.052713164197916, 3.6974098005712106, -3.2363724505696947, 18.37553862514383, 12.545216361560309, -0.2427643300301252, 5.7654022324927645, 6.794830687019142, -37.700591191172, -13.625019474726681, -32.31892449516165, -17.36892980134197, -9.692727124085057, 4.319893574137563, -21.848176134982378, 1.5411589798728857, -6.25098597311356, -17.546246671096906, -2.822168238770083, 7.03389592624676, 13.034378588102653, -9.358418134738274, -17.61685621995432, -17.9872606486913, -19.637721145173632, -3.279717765839276, -14.40288814678042, -7.275456419611393, -23.13257457268486, -5.900218927941102, -19.71204980484303, -6.369080524172155, 2.8160200144915413, 0.8309990502779474, -13.254727292213392], "episode_lengths": [21, 400, 400, 400, 400, 400, 400, 400, 400, 246, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 83, 400, 400], "policy_agent_policy_reward": [-7.822163082040701, 2.7730039007984146, -5.155110304916533, 7.966238046470586, 8.825908070037995, 10.052713164197915, -3.6974098005712097, 3.236372450569694, -18.375538625143818, -12.545216361560314, 0.2427643300301252, -5.7654022324927645, -6.794830687019142, 37.70059119117198, 13.625019474726681, 32.31892449516167, 17.36892980134197, 9.692727124085057, -4.319893574137563, 21.848176134982374, -1.541158979872884, 6.250985973113558, 17.546246671096906, 2.822168238770083, -7.033895926246757, -13.034378588102651, 9.358418134738283, 17.616856219954325, 17.987260648691297, 19.637721145173614, 3.279717765839276, 14.40288814678042, 7.275456419611393, 23.132574572684863, 5.900218927941102, 19.71204980484303, 6.369080524172153, -2.816020014491541, -0.8309990502779332, 13.254727292213389], "policy_adversary_policy_reward": [7.190550680793116, 8.453775483288284, -7.9593678999186395, 2.41336009832181, -4.025325754617732, 14.3355463644508, -10.55092643047918, -5.3815496624619925, 5.261320962550148, -22.913137102626138, -7.252312927593973, -12.85311340080186, -1.0991891972102934, 8.494008798352713, 0.6470989443626873, -7.1198438455020785, 13.86110825534649, 22.88996899494115, 5.387764037150362, 19.70266868597026, 5.252807574226868, -5.738336234287113, 19.946493259446907, -8.415688794461378, 15.04105475743575, -1.4513933833974662, -40.50134123681434, -34.8998411455295, -25.660896572276368, -1.589142377176998, -37.00821779471302, -27.629631195610298, 4.515637787047879, -39.25349738973182, -9.246212657885714, -10.1392415902844, 15.047378487595715, -6.407591339320589, -16.416851045283853, -27.2795012246809, -1.1792912593409621, 4.261609219086732, -32.824923701687375, 20.322951755460256, -15.474456616014688, -19.618036726179124, 7.195863232883096, -12.84019971042326, 15.478175080251269, -1.4103832277577553, 2.9362103454087674, 23.132546830796535, -31.584893319521434, 12.86805705004489, -32.040898135773226, -3.1928143041354318, -5.272904284373148, -30.701617013009443, -16.7588848529287, -22.51655743741855, -10.24535041413899, 3.6859148824604375, -16.65115364129113, -12.154622652269708, 2.7553784699357387, -17.306291309158524, -16.56321513928443, -29.70193400608533, -22.79581445721046, 10.995376601328257, -21.16924053519026, -18.2548590744958, 6.026638310172899, -18.7647993585172, -23.420551627834325, 29.052591656817402, 20.137150768525288, -18.47515266796942, -14.818230936807016, -11.691223647619765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6221670541069055, "mean_inference_ms": 1.8917976126633742, "mean_action_processing_ms": 0.30327251858439885, "mean_env_wait_ms": 0.12474196831384583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004604458808898926, "StateBufferConnector_ms": 0.002830326557159424, "ViewRequirementAgentConnector_ms": 0.08841276168823242}, "num_episodes": 10, "episode_return_max": 18.37553862514383, "episode_return_min": -37.700591191172, "episode_return_mean": -6.511643036058108}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.7732338877758, "num_env_steps_trained_throughput_per_sec": 490.7732338877758, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 9424.456, "restore_workers_time_ms": 0.08, "training_step_time_ms": 9424.198, "sample_time_ms": 1265.687, "learn_time_ms": 8139.999, "learn_throughput": 491.401, "synch_weights_time_ms": 16.377}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 4, "trial_id": "017ef_00000", "date": "2024-08-10_12-10-58", "timestamp": 1723306258, "time_this_iter_s": 8.153443098068237, "time_total_s": 37.86335492134094, "pid": 63420, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4457820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 37.86335492134094, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.618181818181824, "ram_util_percent": 82.35454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4056926412557167, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.556623505284547, "policy_loss": -0.014184922030535601, "vf_loss": 5.566701740941043, "vf_explained_var": 0.016899766966148658, "kl": 0.020533339938084268, "entropy": 1.5558420312467707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.490178371127695, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.941112691909074, "policy_loss": -0.009419932292075828, "vf_loss": 4.948392181098461, "vf_explained_var": 0.022024787900348505, "kl": 0.010702194954038482, "entropy": 1.3739924342681964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 18.37553862514383, "episode_reward_min": -37.700591191172, "episode_reward_mean": -6.752309145102446, "episode_len_mean": 369.53061224489795, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 18107, "policy_reward_min": {"agent_policy": -18.375538625143818, "adversary_policy": -40.50134123681434}, "policy_reward_max": {"agent_policy": 37.70059119117198, "adversary_policy": 29.052591656817402}, "policy_reward_mean": {"agent_policy": 6.752309145102444, "adversary_policy": -6.752309145102443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.822163082040699, -2.7730039007984146, 5.155110304916533, -7.966238046470586, -8.825908070037995, -10.052713164197916, 3.6974098005712106, -3.2363724505696947, 18.37553862514383, 12.545216361560309, -0.2427643300301252, 5.7654022324927645, 6.794830687019142, -37.700591191172, -13.625019474726681, -32.31892449516165, -17.36892980134197, -9.692727124085057, 4.319893574137563, -21.848176134982378, 1.5411589798728857, -6.25098597311356, -17.546246671096906, -2.822168238770083, 7.03389592624676, 13.034378588102653, -9.358418134738274, -17.61685621995432, -17.9872606486913, -19.637721145173632, -3.279717765839276, -14.40288814678042, -7.275456419611393, -23.13257457268486, -5.900218927941102, -19.71204980484303, -6.369080524172155, 2.8160200144915413, 0.8309990502779474, -13.254727292213392, -10.908627156399737, -3.12861629986633, -3.375681528782051, -4.591401620337789, -14.995391201816169, -8.569969507609041, -8.896280798895503, -12.475139087409588, -3.4563194665792363], "episode_lengths": [21, 400, 400, 400, 400, 400, 400, 400, 400, 246, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-7.822163082040701, 2.7730039007984146, -5.155110304916533, 7.966238046470586, 8.825908070037995, 10.052713164197915, -3.6974098005712097, 3.236372450569694, -18.375538625143818, -12.545216361560314, 0.2427643300301252, -5.7654022324927645, -6.794830687019142, 37.70059119117198, 13.625019474726681, 32.31892449516167, 17.36892980134197, 9.692727124085057, -4.319893574137563, 21.848176134982374, -1.541158979872884, 6.250985973113558, 17.546246671096906, 2.822168238770083, -7.033895926246757, -13.034378588102651, 9.358418134738283, 17.616856219954325, 17.987260648691297, 19.637721145173614, 3.279717765839276, 14.40288814678042, 7.275456419611393, 23.132574572684863, 5.900218927941102, 19.71204980484303, 6.369080524172153, -2.816020014491541, -0.8309990502779332, 13.254727292213389, 10.908627156399739, 3.12861629986633, 3.375681528782051, 4.591401620337789, 14.995391201816169, 8.569969507609041, 8.896280798895503, 12.475139087409588, 3.456319466579237], "policy_adversary_policy_reward": [7.190550680793116, 8.453775483288284, -7.9593678999186395, 2.41336009832181, -4.025325754617732, 14.3355463644508, -10.55092643047918, -5.3815496624619925, 5.261320962550148, -22.913137102626138, -7.252312927593973, -12.85311340080186, -1.0991891972102934, 8.494008798352713, 0.6470989443626873, -7.1198438455020785, 13.86110825534649, 22.88996899494115, 5.387764037150362, 19.70266868597026, 5.252807574226868, -5.738336234287113, 19.946493259446907, -8.415688794461378, 15.04105475743575, -1.4513933833974662, -40.50134123681434, -34.8998411455295, -25.660896572276368, -1.589142377176998, -37.00821779471302, -27.629631195610298, 4.515637787047879, -39.25349738973182, -9.246212657885714, -10.1392415902844, 15.047378487595715, -6.407591339320589, -16.416851045283853, -27.2795012246809, -1.1792912593409621, 4.261609219086732, -32.824923701687375, 20.322951755460256, -15.474456616014688, -19.618036726179124, 7.195863232883096, -12.84019971042326, 15.478175080251269, -1.4103832277577553, 2.9362103454087674, 23.132546830796535, -31.584893319521434, 12.86805705004489, -32.040898135773226, -3.1928143041354318, -5.272904284373148, -30.701617013009443, -16.7588848529287, -22.51655743741855, -10.24535041413899, 3.6859148824604375, -16.65115364129113, -12.154622652269708, 2.7553784699357387, -17.306291309158524, -16.56321513928443, -29.70193400608533, -22.79581445721046, 10.995376601328257, -21.16924053519026, -18.2548590744958, 6.026638310172899, -18.7647993585172, -23.420551627834325, 29.052591656817402, 20.137150768525288, -18.47515266796942, -14.818230936807016, -11.691223647619765, -1.1861935360217117, -20.631060776777762, -29.22829962271299, 22.971067022980332, 4.942495430599402, -11.693858488163514, 0.04760212452732304, -9.230405365202902, 1.43139918007941, -31.422181583711748, -23.133935550352252, 5.9939965351341655, -10.269802616743576, -7.522758981047431, -9.951758839976918, -14.998519334842257, 17.541577007864348, -24.454215941022813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.602447332088514, "mean_inference_ms": 1.810213107745727, "mean_action_processing_ms": 0.2910489475922003, "mean_env_wait_ms": 0.12001118883474236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004580556129922672, "StateBufferConnector_ms": 0.0027912003653390066, "ViewRequirementAgentConnector_ms": 0.08493564566787408}, "num_episodes": 9, "episode_return_max": 18.37553862514383, "episode_return_min": -37.700591191172, "episode_return_mean": -6.752309145102446}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.2782058619741, "num_env_steps_trained_throughput_per_sec": 484.2782058619741, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 9191.51, "restore_workers_time_ms": 0.067, "training_step_time_ms": 9191.296, "sample_time_ms": 1176.999, "learn_time_ms": 7997.299, "learn_throughput": 500.169, "synch_weights_time_ms": 15.188}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 5, "trial_id": "017ef_00000", "date": "2024-08-10_12-11-06", "timestamp": 1723306266, "time_this_iter_s": 8.268907070159912, "time_total_s": 46.132261991500854, "pid": 63420, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4431f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46.132261991500854, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 37.141666666666666, "ram_util_percent": 82.55833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2736756674984777, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.1337186255783, "policy_loss": -0.0034633990702411487, "vf_loss": 7.135746811811256, "vf_explained_var": -0.1037927702305809, "kl": 0.004784022632619148, "entropy": 1.5419657000158198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.141244114252428, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.039509023229281, "policy_loss": -0.010174675198504702, "vf_loss": 6.046258528033892, "vf_explained_var": 0.462553140334785, "kl": 0.017125895103183283, "entropy": 1.3227581390490135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 28.48436052166445, "episode_reward_min": -53.73053806669691, "episode_reward_mean": -5.125028619941392, "episode_len_mean": 367.76666666666665, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 22066, "policy_reward_min": {"agent_policy": -28.484360521664485, "adversary_policy": -57.31552784298201}, "policy_reward_max": {"agent_policy": 53.7305380666969, "adversary_policy": 46.62781471598589}, "policy_reward_mean": {"agent_policy": 5.125028619941391, "adversary_policy": -5.125028619941391}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.822163082040699, -2.7730039007984146, 5.155110304916533, -7.966238046470586, -8.825908070037995, -10.052713164197916, 3.6974098005712106, -3.2363724505696947, 18.37553862514383, 12.545216361560309, -0.2427643300301252, 5.7654022324927645, 6.794830687019142, -37.700591191172, -13.625019474726681, -32.31892449516165, -17.36892980134197, -9.692727124085057, 4.319893574137563, -21.848176134982378, 1.5411589798728857, -6.25098597311356, -17.546246671096906, -2.822168238770083, 7.03389592624676, 13.034378588102653, -9.358418134738274, -17.61685621995432, -17.9872606486913, -19.637721145173632, -3.279717765839276, -14.40288814678042, -7.275456419611393, -23.13257457268486, -5.900218927941102, -19.71204980484303, -6.369080524172155, 2.8160200144915413, 0.8309990502779474, -13.254727292213392, -10.908627156399737, -3.12861629986633, -3.375681528782051, -4.591401620337789, -14.995391201816169, -8.569969507609041, -8.896280798895503, -12.475139087409588, -3.4563194665792363, 15.593639723286833, -53.73053806669691, -2.130015252428616, 15.916573120536018, 25.27237791317961, 5.341667308007545, -28.28583780098911, 6.863398372947325, 28.48436052166445, -13.581397807871099, 23.617202881900276], "episode_lengths": [21, 400, 400, 400, 400, 400, 400, 400, 400, 246, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 335, 400, 362, 400, 400, 400, 234, 400, 228], "policy_agent_policy_reward": [-7.822163082040701, 2.7730039007984146, -5.155110304916533, 7.966238046470586, 8.825908070037995, 10.052713164197915, -3.6974098005712097, 3.236372450569694, -18.375538625143818, -12.545216361560314, 0.2427643300301252, -5.7654022324927645, -6.794830687019142, 37.70059119117198, 13.625019474726681, 32.31892449516167, 17.36892980134197, 9.692727124085057, -4.319893574137563, 21.848176134982374, -1.541158979872884, 6.250985973113558, 17.546246671096906, 2.822168238770083, -7.033895926246757, -13.034378588102651, 9.358418134738283, 17.616856219954325, 17.987260648691297, 19.637721145173614, 3.279717765839276, 14.40288814678042, 7.275456419611393, 23.132574572684863, 5.900218927941102, 19.71204980484303, 6.369080524172153, -2.816020014491541, -0.8309990502779332, 13.254727292213389, 10.908627156399739, 3.12861629986633, 3.375681528782051, 4.591401620337789, 14.995391201816169, 8.569969507609041, 8.896280798895503, 12.475139087409588, 3.456319466579237, -15.593639723286831, 53.7305380666969, 2.130015252428624, -15.916573120536002, -25.2723779131796, -5.341667308007544, 28.28583780098911, -6.863398372947326, -28.484360521664485, 13.581397807871092, -23.617202881900248], "policy_adversary_policy_reward": [7.190550680793116, 8.453775483288284, -7.9593678999186395, 2.41336009832181, -4.025325754617732, 14.3355463644508, -10.55092643047918, -5.3815496624619925, 5.261320962550148, -22.913137102626138, -7.252312927593973, -12.85311340080186, -1.0991891972102934, 8.494008798352713, 0.6470989443626873, -7.1198438455020785, 13.86110825534649, 22.88996899494115, 5.387764037150362, 19.70266868597026, 5.252807574226868, -5.738336234287113, 19.946493259446907, -8.415688794461378, 15.04105475743575, -1.4513933833974662, -40.50134123681434, -34.8998411455295, -25.660896572276368, -1.589142377176998, -37.00821779471302, -27.629631195610298, 4.515637787047879, -39.25349738973182, -9.246212657885714, -10.1392415902844, 15.047378487595715, -6.407591339320589, -16.416851045283853, -27.2795012246809, -1.1792912593409621, 4.261609219086732, -32.824923701687375, 20.322951755460256, -15.474456616014688, -19.618036726179124, 7.195863232883096, -12.84019971042326, 15.478175080251269, -1.4103832277577553, 2.9362103454087674, 23.132546830796535, -31.584893319521434, 12.86805705004489, -32.040898135773226, -3.1928143041354318, -5.272904284373148, -30.701617013009443, -16.7588848529287, -22.51655743741855, -10.24535041413899, 3.6859148824604375, -16.65115364129113, -12.154622652269708, 2.7553784699357387, -17.306291309158524, -16.56321513928443, -29.70193400608533, -22.79581445721046, 10.995376601328257, -21.16924053519026, -18.2548590744958, 6.026638310172899, -18.7647993585172, -23.420551627834325, 29.052591656817402, 20.137150768525288, -18.47515266796942, -14.818230936807016, -11.691223647619765, -1.1861935360217117, -20.631060776777762, -29.22829962271299, 22.971067022980332, 4.942495430599402, -11.693858488163514, 0.04760212452732304, -9.230405365202902, 1.43139918007941, -31.422181583711748, -23.133935550352252, 5.9939965351341655, -10.269802616743576, -7.522758981047431, -9.951758839976918, -14.998519334842257, 17.541577007864348, -24.454215941022813, 18.413417333090003, 12.773862113483654, -57.31552784298201, -50.14554829041183, -11.284429586532312, 7.024399081675064, 14.565742734253, 17.267403506819004, 46.62781471598589, 3.9169411103732976, 3.366785576214607, 7.316549039800484, -26.027654002384438, -30.544021599593787, -13.06206336037797, 26.788860106272608, 21.05862431591681, 35.91009672741215, -11.03508256035186, -16.12771305539031, 10.286791454627668, 36.94761430917287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5857559235251266, "mean_inference_ms": 1.737677640635717, "mean_action_processing_ms": 0.27989052652153273, "mean_env_wait_ms": 0.11577033139830088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004514257113138835, "StateBufferConnector_ms": 0.002763470013936361, "ViewRequirementAgentConnector_ms": 0.08386711279551189}, "num_episodes": 11, "episode_return_max": 28.48436052166445, "episode_return_min": -53.73053806669691, "episode_return_mean": -5.125028619941392}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.2979790882492, "num_env_steps_trained_throughput_per_sec": 460.2979790882492, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 9107.931, "restore_workers_time_ms": 0.058, "training_step_time_ms": 9107.741, "sample_time_ms": 1157.136, "learn_time_ms": 7933.31, "learn_throughput": 504.203, "synch_weights_time_ms": 15.671}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 6, "trial_id": "017ef_00000", "date": "2024-08-10_12-11-15", "timestamp": 1723306275, "time_this_iter_s": 8.699597835540771, "time_total_s": 54.831859827041626, "pid": 63420, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a44575e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54.831859827041626, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.891666666666666, "ram_util_percent": 82.34166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4333324731184693, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.628872804540806, "policy_loss": -0.0021520528808068582, "vf_loss": 6.6303326526016155, "vf_explained_var": -0.42006823663358334, "kl": 0.004614672540882761, "entropy": 1.5452808674050387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5663227531438073, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.964322102814913, "policy_loss": -0.0054571617428640215, "vf_loss": 4.967806889365117, "vf_explained_var": 0.3924706509957711, "kl": 0.009861978238250064, "entropy": 1.265662920475006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 28.48436052166445, "episode_reward_min": -53.73053806669691, "episode_reward_mean": -5.1269905317272375, "episode_len_mean": 371.4347826086956, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 25629, "policy_reward_min": {"agent_policy": -28.484360521664485, "adversary_policy": -57.31552784298201}, "policy_reward_max": {"agent_policy": 53.7305380666969, "adversary_policy": 46.62781471598589}, "policy_reward_mean": {"agent_policy": 5.126990531727237, "adversary_policy": -5.126990531727235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.822163082040699, -2.7730039007984146, 5.155110304916533, -7.966238046470586, -8.825908070037995, -10.052713164197916, 3.6974098005712106, -3.2363724505696947, 18.37553862514383, 12.545216361560309, -0.2427643300301252, 5.7654022324927645, 6.794830687019142, -37.700591191172, -13.625019474726681, -32.31892449516165, -17.36892980134197, -9.692727124085057, 4.319893574137563, -21.848176134982378, 1.5411589798728857, -6.25098597311356, -17.546246671096906, -2.822168238770083, 7.03389592624676, 13.034378588102653, -9.358418134738274, -17.61685621995432, -17.9872606486913, -19.637721145173632, -3.279717765839276, -14.40288814678042, -7.275456419611393, -23.13257457268486, -5.900218927941102, -19.71204980484303, -6.369080524172155, 2.8160200144915413, 0.8309990502779474, -13.254727292213392, -10.908627156399737, -3.12861629986633, -3.375681528782051, -4.591401620337789, -14.995391201816169, -8.569969507609041, -8.896280798895503, -12.475139087409588, -3.4563194665792363, 15.593639723286833, -53.73053806669691, -2.130015252428616, 15.916573120536018, 25.27237791317961, 5.341667308007545, -28.28583780098911, 6.863398372947325, 28.48436052166445, -13.581397807871099, 23.617202881900276, 19.015057119760833, 21.999038484445073, 24.396089187802552, -37.37860770658893, -24.182456150381533, -35.77162627884892, 11.947163176460883, 21.1104242907563, -47.39571161610207], "episode_lengths": [21, 400, 400, 400, 400, 400, 400, 400, 400, 246, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 335, 400, 362, 400, 400, 400, 234, 400, 228, 374, 400, 400, 400, 400, 400, 400, 389, 400], "policy_agent_policy_reward": [-7.822163082040701, 2.7730039007984146, -5.155110304916533, 7.966238046470586, 8.825908070037995, 10.052713164197915, -3.6974098005712097, 3.236372450569694, -18.375538625143818, -12.545216361560314, 0.2427643300301252, -5.7654022324927645, -6.794830687019142, 37.70059119117198, 13.625019474726681, 32.31892449516167, 17.36892980134197, 9.692727124085057, -4.319893574137563, 21.848176134982374, -1.541158979872884, 6.250985973113558, 17.546246671096906, 2.822168238770083, -7.033895926246757, -13.034378588102651, 9.358418134738283, 17.616856219954325, 17.987260648691297, 19.637721145173614, 3.279717765839276, 14.40288814678042, 7.275456419611393, 23.132574572684863, 5.900218927941102, 19.71204980484303, 6.369080524172153, -2.816020014491541, -0.8309990502779332, 13.254727292213389, 10.908627156399739, 3.12861629986633, 3.375681528782051, 4.591401620337789, 14.995391201816169, 8.569969507609041, 8.896280798895503, 12.475139087409588, 3.456319466579237, -15.593639723286831, 53.7305380666969, 2.130015252428624, -15.916573120536002, -25.2723779131796, -5.341667308007544, 28.28583780098911, -6.863398372947326, -28.484360521664485, 13.581397807871092, -23.617202881900248, -19.015057119760836, -21.999038484445105, -24.396089187802545, 37.37860770658893, 24.182456150381533, 35.77162627884891, -11.947163176460878, -21.110424290756292, 47.395711616102076], "policy_adversary_policy_reward": [7.190550680793116, 8.453775483288284, -7.9593678999186395, 2.41336009832181, -4.025325754617732, 14.3355463644508, -10.55092643047918, -5.3815496624619925, 5.261320962550148, -22.913137102626138, -7.252312927593973, -12.85311340080186, -1.0991891972102934, 8.494008798352713, 0.6470989443626873, -7.1198438455020785, 13.86110825534649, 22.88996899494115, 5.387764037150362, 19.70266868597026, 5.252807574226868, -5.738336234287113, 19.946493259446907, -8.415688794461378, 15.04105475743575, -1.4513933833974662, -40.50134123681434, -34.8998411455295, -25.660896572276368, -1.589142377176998, -37.00821779471302, -27.629631195610298, 4.515637787047879, -39.25349738973182, -9.246212657885714, -10.1392415902844, 15.047378487595715, -6.407591339320589, -16.416851045283853, -27.2795012246809, -1.1792912593409621, 4.261609219086732, -32.824923701687375, 20.322951755460256, -15.474456616014688, -19.618036726179124, 7.195863232883096, -12.84019971042326, 15.478175080251269, -1.4103832277577553, 2.9362103454087674, 23.132546830796535, -31.584893319521434, 12.86805705004489, -32.040898135773226, -3.1928143041354318, -5.272904284373148, -30.701617013009443, -16.7588848529287, -22.51655743741855, -10.24535041413899, 3.6859148824604375, -16.65115364129113, -12.154622652269708, 2.7553784699357387, -17.306291309158524, -16.56321513928443, -29.70193400608533, -22.79581445721046, 10.995376601328257, -21.16924053519026, -18.2548590744958, 6.026638310172899, -18.7647993585172, -23.420551627834325, 29.052591656817402, 20.137150768525288, -18.47515266796942, -14.818230936807016, -11.691223647619765, -1.1861935360217117, -20.631060776777762, -29.22829962271299, 22.971067022980332, 4.942495430599402, -11.693858488163514, 0.04760212452732304, -9.230405365202902, 1.43139918007941, -31.422181583711748, -23.133935550352252, 5.9939965351341655, -10.269802616743576, -7.522758981047431, -9.951758839976918, -14.998519334842257, 17.541577007864348, -24.454215941022813, 18.413417333090003, 12.773862113483654, -57.31552784298201, -50.14554829041183, -11.284429586532312, 7.024399081675064, 14.565742734253, 17.267403506819004, 46.62781471598589, 3.9169411103732976, 3.366785576214607, 7.316549039800484, -26.027654002384438, -30.544021599593787, -13.06206336037797, 26.788860106272608, 21.05862431591681, 35.91009672741215, -11.03508256035186, -16.12771305539031, 10.286791454627668, 36.94761430917287, 37.5544442451012, 0.47566999442046054, 29.362316006209248, 14.635760962680934, 24.620017839484365, 24.172160536120717, -40.233529389434246, -34.523686023743565, -29.62027170825202, -18.744640592511047, -17.614975909760417, -53.92827664793736, 12.42794103301734, 11.466385319904427, 12.995723614702424, 29.225124966810178, -40.29294439313136, -54.498478839072796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5745626680474981, "mean_inference_ms": 1.6905077212974162, "mean_action_processing_ms": 0.27258046696779886, "mean_env_wait_ms": 0.11291403577052857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004627739173778589, "StateBufferConnector_ms": 0.0027404315229775248, "ViewRequirementAgentConnector_ms": 0.08183786834495654}, "num_episodes": 9, "episode_return_max": 28.48436052166445, "episode_return_min": -53.73053806669691, "episode_return_mean": -5.1269905317272375}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.5886525526653, "num_env_steps_trained_throughput_per_sec": 501.5886525526653, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 8946.042, "restore_workers_time_ms": 0.054, "training_step_time_ms": 8945.866, "sample_time_ms": 1119.982, "learn_time_ms": 7809.573, "learn_throughput": 512.192, "synch_weights_time_ms": 14.862}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 7, "trial_id": "017ef_00000", "date": "2024-08-10_12-11-23", "timestamp": 1723306283, "time_this_iter_s": 7.9771599769592285, "time_total_s": 62.809019804000854, "pid": 63420, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a44a2ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.809019804000854, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 34.74166666666667, "ram_util_percent": 81.31666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5887069560074933, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.166433510200056, "policy_loss": -0.007377042427841357, "vf_loss": 6.172644333360056, "vf_explained_var": -0.284051551705315, "kl": 0.015549499549491636, "entropy": 1.5543372016735177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.593760901254912, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.523798257857561, "policy_loss": -0.0030343057684755572, "vf_loss": 4.525502130140861, "vf_explained_var": 0.33312684496243794, "kl": 0.006652140609123455, "entropy": 1.2292166837801537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 28.48436052166445, "episode_reward_min": -53.73053806669691, "episode_reward_mean": -7.005875352241894, "episode_len_mean": 362.5487804878049, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 29729, "policy_reward_min": {"agent_policy": -28.484360521664485, "adversary_policy": -57.31552784298201}, "policy_reward_max": {"agent_policy": 53.7305380666969, "adversary_policy": 46.62781471598589}, "policy_reward_mean": {"agent_policy": 7.005875352241896, "adversary_policy": -7.005875352241893}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.822163082040699, -2.7730039007984146, 5.155110304916533, -7.966238046470586, -8.825908070037995, -10.052713164197916, 3.6974098005712106, -3.2363724505696947, 18.37553862514383, 12.545216361560309, -0.2427643300301252, 5.7654022324927645, 6.794830687019142, -37.700591191172, -13.625019474726681, -32.31892449516165, -17.36892980134197, -9.692727124085057, 4.319893574137563, -21.848176134982378, 1.5411589798728857, -6.25098597311356, -17.546246671096906, -2.822168238770083, 7.03389592624676, 13.034378588102653, -9.358418134738274, -17.61685621995432, -17.9872606486913, -19.637721145173632, -3.279717765839276, -14.40288814678042, -7.275456419611393, -23.13257457268486, -5.900218927941102, -19.71204980484303, -6.369080524172155, 2.8160200144915413, 0.8309990502779474, -13.254727292213392, -10.908627156399737, -3.12861629986633, -3.375681528782051, -4.591401620337789, -14.995391201816169, -8.569969507609041, -8.896280798895503, -12.475139087409588, -3.4563194665792363, 15.593639723286833, -53.73053806669691, -2.130015252428616, 15.916573120536018, 25.27237791317961, 5.341667308007545, -28.28583780098911, 6.863398372947325, 28.48436052166445, -13.581397807871099, 23.617202881900276, 19.015057119760833, 21.999038484445073, 24.396089187802552, -37.37860770658893, -24.182456150381533, -35.77162627884892, 11.947163176460883, 21.1104242907563, -47.39571161610207, -30.77946621847267, -36.779232705252824, -20.241208253974857, -2.780538595425037, -1.2949658670436808, -50.93738924639686, 20.25290453753511, -5.262157558917734, -41.336362115653976, -33.51857616166536, 3.278528465634454, 9.97662741091722, -31.297595885939863], "episode_lengths": [21, 400, 400, 400, 400, 400, 400, 400, 400, 246, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 335, 400, 362, 400, 400, 400, 234, 400, 228, 374, 400, 400, 400, 400, 400, 400, 389, 400, 400, 400, 400, 16, 8, 400, 357, 400, 400, 400, 400, 119, 400], "policy_agent_policy_reward": [-7.822163082040701, 2.7730039007984146, -5.155110304916533, 7.966238046470586, 8.825908070037995, 10.052713164197915, -3.6974098005712097, 3.236372450569694, -18.375538625143818, -12.545216361560314, 0.2427643300301252, -5.7654022324927645, -6.794830687019142, 37.70059119117198, 13.625019474726681, 32.31892449516167, 17.36892980134197, 9.692727124085057, -4.319893574137563, 21.848176134982374, -1.541158979872884, 6.250985973113558, 17.546246671096906, 2.822168238770083, -7.033895926246757, -13.034378588102651, 9.358418134738283, 17.616856219954325, 17.987260648691297, 19.637721145173614, 3.279717765839276, 14.40288814678042, 7.275456419611393, 23.132574572684863, 5.900218927941102, 19.71204980484303, 6.369080524172153, -2.816020014491541, -0.8309990502779332, 13.254727292213389, 10.908627156399739, 3.12861629986633, 3.375681528782051, 4.591401620337789, 14.995391201816169, 8.569969507609041, 8.896280798895503, 12.475139087409588, 3.456319466579237, -15.593639723286831, 53.7305380666969, 2.130015252428624, -15.916573120536002, -25.2723779131796, -5.341667308007544, 28.28583780098911, -6.863398372947326, -28.484360521664485, 13.581397807871092, -23.617202881900248, -19.015057119760836, -21.999038484445105, -24.396089187802545, 37.37860770658893, 24.182456150381533, 35.77162627884891, -11.947163176460878, -21.110424290756292, 47.395711616102076, 30.779466218472653, 36.779232705252845, 20.241208253974857, 2.7805385954250363, 1.2949658670436803, 50.937389246396855, -20.252904537535112, 5.262157558917732, 41.33636211565397, 33.518576161665365, -3.2785284656344533, -9.976627410917223, 31.297595885939884], "policy_adversary_policy_reward": [7.190550680793116, 8.453775483288284, -7.9593678999186395, 2.41336009832181, -4.025325754617732, 14.3355463644508, -10.55092643047918, -5.3815496624619925, 5.261320962550148, -22.913137102626138, -7.252312927593973, -12.85311340080186, -1.0991891972102934, 8.494008798352713, 0.6470989443626873, -7.1198438455020785, 13.86110825534649, 22.88996899494115, 5.387764037150362, 19.70266868597026, 5.252807574226868, -5.738336234287113, 19.946493259446907, -8.415688794461378, 15.04105475743575, -1.4513933833974662, -40.50134123681434, -34.8998411455295, -25.660896572276368, -1.589142377176998, -37.00821779471302, -27.629631195610298, 4.515637787047879, -39.25349738973182, -9.246212657885714, -10.1392415902844, 15.047378487595715, -6.407591339320589, -16.416851045283853, -27.2795012246809, -1.1792912593409621, 4.261609219086732, -32.824923701687375, 20.322951755460256, -15.474456616014688, -19.618036726179124, 7.195863232883096, -12.84019971042326, 15.478175080251269, -1.4103832277577553, 2.9362103454087674, 23.132546830796535, -31.584893319521434, 12.86805705004489, -32.040898135773226, -3.1928143041354318, -5.272904284373148, -30.701617013009443, -16.7588848529287, -22.51655743741855, -10.24535041413899, 3.6859148824604375, -16.65115364129113, -12.154622652269708, 2.7553784699357387, -17.306291309158524, -16.56321513928443, -29.70193400608533, -22.79581445721046, 10.995376601328257, -21.16924053519026, -18.2548590744958, 6.026638310172899, -18.7647993585172, -23.420551627834325, 29.052591656817402, 20.137150768525288, -18.47515266796942, -14.818230936807016, -11.691223647619765, -1.1861935360217117, -20.631060776777762, -29.22829962271299, 22.971067022980332, 4.942495430599402, -11.693858488163514, 0.04760212452732304, -9.230405365202902, 1.43139918007941, -31.422181583711748, -23.133935550352252, 5.9939965351341655, -10.269802616743576, -7.522758981047431, -9.951758839976918, -14.998519334842257, 17.541577007864348, -24.454215941022813, 18.413417333090003, 12.773862113483654, -57.31552784298201, -50.14554829041183, -11.284429586532312, 7.024399081675064, 14.565742734253, 17.267403506819004, 46.62781471598589, 3.9169411103732976, 3.366785576214607, 7.316549039800484, -26.027654002384438, -30.544021599593787, -13.06206336037797, 26.788860106272608, 21.05862431591681, 35.91009672741215, -11.03508256035186, -16.12771305539031, 10.286791454627668, 36.94761430917287, 37.5544442451012, 0.47566999442046054, 29.362316006209248, 14.635760962680934, 24.620017839484365, 24.172160536120717, -40.233529389434246, -34.523686023743565, -29.62027170825202, -18.744640592511047, -17.614975909760417, -53.92827664793736, 12.42794103301734, 11.466385319904427, 12.995723614702424, 29.225124966810178, -40.29294439313136, -54.498478839072796, -20.521717474562635, -41.03721496238268, -32.96325532227353, -40.59521008823205, -15.8381063897534, -24.644310118196316, -12.087882131416041, 6.5268049405659685, 0.2482002834876793, -2.83813201757504, -53.819443739166005, -48.05533475362776, -0.3569101065840652, 40.862719181654334, -6.910830874841174, -3.613484242994314, -30.359365265047536, -52.31335896626038, -34.623954083244044, -32.413198240086714, -5.481580072645322, 12.038637003914221, 9.371267292515208, 10.581987529319239, -31.629475080458974, -30.965716691420695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5602001169960934, "mean_inference_ms": 1.6330104210095677, "mean_action_processing_ms": 0.263362205118961, "mean_env_wait_ms": 0.1091693723454498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004622703645287491, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.07892628995383658}, "num_episodes": 13, "episode_return_max": 28.48436052166445, "episode_return_min": -53.73053806669691, "episode_return_mean": -7.005875352241894}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.1537190367872, "num_env_steps_trained_throughput_per_sec": 534.1537190367872, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 8763.847, "restore_workers_time_ms": 0.049, "training_step_time_ms": 8763.69, "sample_time_ms": 1071.905, "learn_time_ms": 7676.104, "learn_throughput": 521.098, "synch_weights_time_ms": 14.356}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 8, "trial_id": "017ef_00000", "date": "2024-08-10_12-11-31", "timestamp": 1723306291, "time_this_iter_s": 7.491868019104004, "time_total_s": 70.30088782310486, "pid": 63420, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a44b1ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 70.30088782310486, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 27.527272727272727, "ram_util_percent": 80.79090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.567644728034262, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.243836737435961, "policy_loss": -0.0028380242504041503, "vf_loss": 6.2459260559586625, "vf_explained_var": -0.064671936047771, "kl": 0.009982786173524745, "entropy": 1.5337231127042619, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3224831748443346, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.157466254631678, "policy_loss": -0.003022393207841863, "vf_loss": 5.159419240554174, "vf_explained_var": 0.19736677172283332, "kl": 0.005347000707346746, "entropy": 1.1828540282944837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": 28.48436052166445, "episode_reward_min": -53.73053806669691, "episode_reward_mean": -8.77895781621215, "episode_len_mean": 363.531914893617, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34172, "policy_reward_min": {"agent_policy": -28.484360521664485, "adversary_policy": -57.31552784298201}, "policy_reward_max": {"agent_policy": 53.7305380666969, "adversary_policy": 46.62781471598589}, "policy_reward_mean": {"agent_policy": 8.77895781621215, "adversary_policy": -8.77895781621215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.822163082040699, -2.7730039007984146, 5.155110304916533, -7.966238046470586, -8.825908070037995, -10.052713164197916, 3.6974098005712106, -3.2363724505696947, 18.37553862514383, 12.545216361560309, -0.2427643300301252, 5.7654022324927645, 6.794830687019142, -37.700591191172, -13.625019474726681, -32.31892449516165, -17.36892980134197, -9.692727124085057, 4.319893574137563, -21.848176134982378, 1.5411589798728857, -6.25098597311356, -17.546246671096906, -2.822168238770083, 7.03389592624676, 13.034378588102653, -9.358418134738274, -17.61685621995432, -17.9872606486913, -19.637721145173632, -3.279717765839276, -14.40288814678042, -7.275456419611393, -23.13257457268486, -5.900218927941102, -19.71204980484303, -6.369080524172155, 2.8160200144915413, 0.8309990502779474, -13.254727292213392, -10.908627156399737, -3.12861629986633, -3.375681528782051, -4.591401620337789, -14.995391201816169, -8.569969507609041, -8.896280798895503, -12.475139087409588, -3.4563194665792363, 15.593639723286833, -53.73053806669691, -2.130015252428616, 15.916573120536018, 25.27237791317961, 5.341667308007545, -28.28583780098911, 6.863398372947325, 28.48436052166445, -13.581397807871099, 23.617202881900276, 19.015057119760833, 21.999038484445073, 24.396089187802552, -37.37860770658893, -24.182456150381533, -35.77162627884892, 11.947163176460883, 21.1104242907563, -47.39571161610207, -30.77946621847267, -36.779232705252824, -20.241208253974857, -2.780538595425037, -1.2949658670436808, -50.93738924639686, 20.25290453753511, -5.262157558917734, -41.336362115653976, -33.51857616166536, 3.278528465634454, 9.97662741091722, -31.297595885939863, -31.839788508868445, 0.02202763518317319, 1.010589013541411, -40.80121636097008, 14.923653611689957, -31.625535586738884, -19.54047856973842, -43.881481421761364, 3.696297833707596, -42.167035008934214, -41.56894089444377, -18.968347582773706], "episode_lengths": [21, 400, 400, 400, 400, 400, 400, 400, 400, 246, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 335, 400, 362, 400, 400, 400, 234, 400, 228, 374, 400, 400, 400, 400, 400, 400, 389, 400, 400, 400, 400, 16, 8, 400, 357, 400, 400, 400, 400, 119, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-7.822163082040701, 2.7730039007984146, -5.155110304916533, 7.966238046470586, 8.825908070037995, 10.052713164197915, -3.6974098005712097, 3.236372450569694, -18.375538625143818, -12.545216361560314, 0.2427643300301252, -5.7654022324927645, -6.794830687019142, 37.70059119117198, 13.625019474726681, 32.31892449516167, 17.36892980134197, 9.692727124085057, -4.319893574137563, 21.848176134982374, -1.541158979872884, 6.250985973113558, 17.546246671096906, 2.822168238770083, -7.033895926246757, -13.034378588102651, 9.358418134738283, 17.616856219954325, 17.987260648691297, 19.637721145173614, 3.279717765839276, 14.40288814678042, 7.275456419611393, 23.132574572684863, 5.900218927941102, 19.71204980484303, 6.369080524172153, -2.816020014491541, -0.8309990502779332, 13.254727292213389, 10.908627156399739, 3.12861629986633, 3.375681528782051, 4.591401620337789, 14.995391201816169, 8.569969507609041, 8.896280798895503, 12.475139087409588, 3.456319466579237, -15.593639723286831, 53.7305380666969, 2.130015252428624, -15.916573120536002, -25.2723779131796, -5.341667308007544, 28.28583780098911, -6.863398372947326, -28.484360521664485, 13.581397807871092, -23.617202881900248, -19.015057119760836, -21.999038484445105, -24.396089187802545, 37.37860770658893, 24.182456150381533, 35.77162627884891, -11.947163176460878, -21.110424290756292, 47.395711616102076, 30.779466218472653, 36.779232705252845, 20.241208253974857, 2.7805385954250363, 1.2949658670436803, 50.937389246396855, -20.252904537535112, 5.262157558917732, 41.33636211565397, 33.518576161665365, -3.2785284656344533, -9.976627410917223, 31.297595885939884, 31.839788508868452, -0.0220276351831723, -1.0105890135414137, 40.80121636097009, -14.923653611689957, 31.625535586738852, 19.54047856973842, 43.88148142176137, -3.696297833707596, 42.16703500893421, 41.56894089444378, 18.968347582773706], "policy_adversary_policy_reward": [7.190550680793116, 8.453775483288284, -7.9593678999186395, 2.41336009832181, -4.025325754617732, 14.3355463644508, -10.55092643047918, -5.3815496624619925, 5.261320962550148, -22.913137102626138, -7.252312927593973, -12.85311340080186, -1.0991891972102934, 8.494008798352713, 0.6470989443626873, -7.1198438455020785, 13.86110825534649, 22.88996899494115, 5.387764037150362, 19.70266868597026, 5.252807574226868, -5.738336234287113, 19.946493259446907, -8.415688794461378, 15.04105475743575, -1.4513933833974662, -40.50134123681434, -34.8998411455295, -25.660896572276368, -1.589142377176998, -37.00821779471302, -27.629631195610298, 4.515637787047879, -39.25349738973182, -9.246212657885714, -10.1392415902844, 15.047378487595715, -6.407591339320589, -16.416851045283853, -27.2795012246809, -1.1792912593409621, 4.261609219086732, -32.824923701687375, 20.322951755460256, -15.474456616014688, -19.618036726179124, 7.195863232883096, -12.84019971042326, 15.478175080251269, -1.4103832277577553, 2.9362103454087674, 23.132546830796535, -31.584893319521434, 12.86805705004489, -32.040898135773226, -3.1928143041354318, -5.272904284373148, -30.701617013009443, -16.7588848529287, -22.51655743741855, -10.24535041413899, 3.6859148824604375, -16.65115364129113, -12.154622652269708, 2.7553784699357387, -17.306291309158524, -16.56321513928443, -29.70193400608533, -22.79581445721046, 10.995376601328257, -21.16924053519026, -18.2548590744958, 6.026638310172899, -18.7647993585172, -23.420551627834325, 29.052591656817402, 20.137150768525288, -18.47515266796942, -14.818230936807016, -11.691223647619765, -1.1861935360217117, -20.631060776777762, -29.22829962271299, 22.971067022980332, 4.942495430599402, -11.693858488163514, 0.04760212452732304, -9.230405365202902, 1.43139918007941, -31.422181583711748, -23.133935550352252, 5.9939965351341655, -10.269802616743576, -7.522758981047431, -9.951758839976918, -14.998519334842257, 17.541577007864348, -24.454215941022813, 18.413417333090003, 12.773862113483654, -57.31552784298201, -50.14554829041183, -11.284429586532312, 7.024399081675064, 14.565742734253, 17.267403506819004, 46.62781471598589, 3.9169411103732976, 3.366785576214607, 7.316549039800484, -26.027654002384438, -30.544021599593787, -13.06206336037797, 26.788860106272608, 21.05862431591681, 35.91009672741215, -11.03508256035186, -16.12771305539031, 10.286791454627668, 36.94761430917287, 37.5544442451012, 0.47566999442046054, 29.362316006209248, 14.635760962680934, 24.620017839484365, 24.172160536120717, -40.233529389434246, -34.523686023743565, -29.62027170825202, -18.744640592511047, -17.614975909760417, -53.92827664793736, 12.42794103301734, 11.466385319904427, 12.995723614702424, 29.225124966810178, -40.29294439313136, -54.498478839072796, -20.521717474562635, -41.03721496238268, -32.96325532227353, -40.59521008823205, -15.8381063897534, -24.644310118196316, -12.087882131416041, 6.5268049405659685, 0.2482002834876793, -2.83813201757504, -53.819443739166005, -48.05533475362776, -0.3569101065840652, 40.862719181654334, -6.910830874841174, -3.613484242994314, -30.359365265047536, -52.31335896626038, -34.623954083244044, -32.413198240086714, -5.481580072645322, 12.038637003914221, 9.371267292515208, 10.581987529319239, -31.629475080458974, -30.965716691420695, -37.352041294354066, -26.32753572338285, 1.307457408872427, -1.2634021385060823, -16.78193614083834, 18.803114167921166, -42.88236144358549, -38.72007127835474, 28.84685648217755, 1.0004507412023642, -26.395399482763317, -36.85567169071445, -16.330768809040293, -22.75018833043655, -40.55638092047018, -47.20658192305267, 9.46861733242531, -2.0760216650101206, -41.26784181779551, -43.06622820007295, -43.832157803979925, -39.30572398490767, -5.670716279431183, -32.26597888611623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5493594151868814, "mean_inference_ms": 1.5911016718162327, "mean_action_processing_ms": 0.2569365025481706, "mean_env_wait_ms": 0.10634372327733387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046401581865675905, "StateBufferConnector_ms": 0.0026767558239875954, "ViewRequirementAgentConnector_ms": 0.07727767558808023}, "num_episodes": 12, "episode_return_max": 28.48436052166445, "episode_return_min": -53.73053806669691, "episode_return_mean": -8.77895781621215}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.886124727335, "num_env_steps_trained_throughput_per_sec": 512.886124727335, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 8656.643, "restore_workers_time_ms": 0.045, "training_step_time_ms": 8656.499, "sample_time_ms": 1037.593, "learn_time_ms": 7603.812, "learn_throughput": 526.052, "synch_weights_time_ms": 13.871}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 9, "trial_id": "017ef_00000", "date": "2024-08-10_12-11-38", "timestamp": 1723306298, "time_this_iter_s": 7.801913261413574, "time_total_s": 78.10280108451843, "pid": 63420, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a44b1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 78.10280108451843, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.481818181818184, "ram_util_percent": 81.15454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.446566109146391, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.498279601303989, "policy_loss": -0.005825584663186597, "vf_loss": 5.503044760668719, "vf_explained_var": 0.01620626004915389, "kl": 0.01413888089821617, "entropy": 1.5417888561884563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.655840547879537, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.425443038096031, "policy_loss": -0.006615920471570765, "vf_loss": 4.429884904374679, "vf_explained_var": 0.1406242296099663, "kl": 0.01087019383750416, "entropy": 1.1737994626164436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 28.48436052166445, "episode_reward_min": -53.73053806669691, "episode_reward_mean": -10.295082103431648, "episode_len_mean": 369.51, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36951, "policy_reward_min": {"agent_policy": -28.484360521664485, "adversary_policy": -57.31552784298201}, "policy_reward_max": {"agent_policy": 53.7305380666969, "adversary_policy": 46.62781471598589}, "policy_reward_mean": {"agent_policy": 10.295082103431648, "adversary_policy": -10.29508210343165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.052713164197916, 3.6974098005712106, -3.2363724505696947, 18.37553862514383, 12.545216361560309, -0.2427643300301252, 5.7654022324927645, 6.794830687019142, -37.700591191172, -13.625019474726681, -32.31892449516165, -17.36892980134197, -9.692727124085057, 4.319893574137563, -21.848176134982378, 1.5411589798728857, -6.25098597311356, -17.546246671096906, -2.822168238770083, 7.03389592624676, 13.034378588102653, -9.358418134738274, -17.61685621995432, -17.9872606486913, -19.637721145173632, -3.279717765839276, -14.40288814678042, -7.275456419611393, -23.13257457268486, -5.900218927941102, -19.71204980484303, -6.369080524172155, 2.8160200144915413, 0.8309990502779474, -13.254727292213392, -10.908627156399737, -3.12861629986633, -3.375681528782051, -4.591401620337789, -14.995391201816169, -8.569969507609041, -8.896280798895503, -12.475139087409588, -3.4563194665792363, 15.593639723286833, -53.73053806669691, -2.130015252428616, 15.916573120536018, 25.27237791317961, 5.341667308007545, -28.28583780098911, 6.863398372947325, 28.48436052166445, -13.581397807871099, 23.617202881900276, 19.015057119760833, 21.999038484445073, 24.396089187802552, -37.37860770658893, -24.182456150381533, -35.77162627884892, 11.947163176460883, 21.1104242907563, -47.39571161610207, -30.77946621847267, -36.779232705252824, -20.241208253974857, -2.780538595425037, -1.2949658670436808, -50.93738924639686, 20.25290453753511, -5.262157558917734, -41.336362115653976, -33.51857616166536, 3.278528465634454, 9.97662741091722, -31.297595885939863, -31.839788508868445, 0.02202763518317319, 1.010589013541411, -40.80121636097008, 14.923653611689957, -31.625535586738884, -19.54047856973842, -43.881481421761364, 3.696297833707596, -42.167035008934214, -41.56894089444377, -18.968347582773706, -21.323501219430025, -17.51669383408281, -35.958349101731436, -16.540839412244615, -17.02320177765419, -9.515462129004227, -35.15776697534654, -12.83790779707276, -19.397817685393566, -25.383504104361773, -0.21900821325070652], "episode_lengths": [400, 400, 400, 400, 246, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 335, 400, 362, 400, 400, 400, 234, 400, 228, 374, 400, 400, 400, 400, 400, 400, 389, 400, 400, 400, 400, 16, 8, 400, 357, 400, 400, 400, 400, 119, 400, 400, 400, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [10.052713164197915, -3.6974098005712097, 3.236372450569694, -18.375538625143818, -12.545216361560314, 0.2427643300301252, -5.7654022324927645, -6.794830687019142, 37.70059119117198, 13.625019474726681, 32.31892449516167, 17.36892980134197, 9.692727124085057, -4.319893574137563, 21.848176134982374, -1.541158979872884, 6.250985973113558, 17.546246671096906, 2.822168238770083, -7.033895926246757, -13.034378588102651, 9.358418134738283, 17.616856219954325, 17.987260648691297, 19.637721145173614, 3.279717765839276, 14.40288814678042, 7.275456419611393, 23.132574572684863, 5.900218927941102, 19.71204980484303, 6.369080524172153, -2.816020014491541, -0.8309990502779332, 13.254727292213389, 10.908627156399739, 3.12861629986633, 3.375681528782051, 4.591401620337789, 14.995391201816169, 8.569969507609041, 8.896280798895503, 12.475139087409588, 3.456319466579237, -15.593639723286831, 53.7305380666969, 2.130015252428624, -15.916573120536002, -25.2723779131796, -5.341667308007544, 28.28583780098911, -6.863398372947326, -28.484360521664485, 13.581397807871092, -23.617202881900248, -19.015057119760836, -21.999038484445105, -24.396089187802545, 37.37860770658893, 24.182456150381533, 35.77162627884891, -11.947163176460878, -21.110424290756292, 47.395711616102076, 30.779466218472653, 36.779232705252845, 20.241208253974857, 2.7805385954250363, 1.2949658670436803, 50.937389246396855, -20.252904537535112, 5.262157558917732, 41.33636211565397, 33.518576161665365, -3.2785284656344533, -9.976627410917223, 31.297595885939884, 31.839788508868452, -0.0220276351831723, -1.0105890135414137, 40.80121636097009, -14.923653611689957, 31.625535586738852, 19.54047856973842, 43.88148142176137, -3.696297833707596, 42.16703500893421, 41.56894089444378, 18.968347582773706, 21.323501219430028, 17.516693834082808, 35.95834910173143, 16.540839412244626, 17.02320177765419, 9.515462129004227, 35.15776697534656, 12.83790779707276, 19.397817685393566, 25.383504104361773, 0.21900821325070474], "policy_adversary_policy_reward": [-7.252312927593973, -12.85311340080186, -1.0991891972102934, 8.494008798352713, 0.6470989443626873, -7.1198438455020785, 13.86110825534649, 22.88996899494115, 5.387764037150362, 19.70266868597026, 5.252807574226868, -5.738336234287113, 19.946493259446907, -8.415688794461378, 15.04105475743575, -1.4513933833974662, -40.50134123681434, -34.8998411455295, -25.660896572276368, -1.589142377176998, -37.00821779471302, -27.629631195610298, 4.515637787047879, -39.25349738973182, -9.246212657885714, -10.1392415902844, 15.047378487595715, -6.407591339320589, -16.416851045283853, -27.2795012246809, -1.1792912593409621, 4.261609219086732, -32.824923701687375, 20.322951755460256, -15.474456616014688, -19.618036726179124, 7.195863232883096, -12.84019971042326, 15.478175080251269, -1.4103832277577553, 2.9362103454087674, 23.132546830796535, -31.584893319521434, 12.86805705004489, -32.040898135773226, -3.1928143041354318, -5.272904284373148, -30.701617013009443, -16.7588848529287, -22.51655743741855, -10.24535041413899, 3.6859148824604375, -16.65115364129113, -12.154622652269708, 2.7553784699357387, -17.306291309158524, -16.56321513928443, -29.70193400608533, -22.79581445721046, 10.995376601328257, -21.16924053519026, -18.2548590744958, 6.026638310172899, -18.7647993585172, -23.420551627834325, 29.052591656817402, 20.137150768525288, -18.47515266796942, -14.818230936807016, -11.691223647619765, -1.1861935360217117, -20.631060776777762, -29.22829962271299, 22.971067022980332, 4.942495430599402, -11.693858488163514, 0.04760212452732304, -9.230405365202902, 1.43139918007941, -31.422181583711748, -23.133935550352252, 5.9939965351341655, -10.269802616743576, -7.522758981047431, -9.951758839976918, -14.998519334842257, 17.541577007864348, -24.454215941022813, 18.413417333090003, 12.773862113483654, -57.31552784298201, -50.14554829041183, -11.284429586532312, 7.024399081675064, 14.565742734253, 17.267403506819004, 46.62781471598589, 3.9169411103732976, 3.366785576214607, 7.316549039800484, -26.027654002384438, -30.544021599593787, -13.06206336037797, 26.788860106272608, 21.05862431591681, 35.91009672741215, -11.03508256035186, -16.12771305539031, 10.286791454627668, 36.94761430917287, 37.5544442451012, 0.47566999442046054, 29.362316006209248, 14.635760962680934, 24.620017839484365, 24.172160536120717, -40.233529389434246, -34.523686023743565, -29.62027170825202, -18.744640592511047, -17.614975909760417, -53.92827664793736, 12.42794103301734, 11.466385319904427, 12.995723614702424, 29.225124966810178, -40.29294439313136, -54.498478839072796, -20.521717474562635, -41.03721496238268, -32.96325532227353, -40.59521008823205, -15.8381063897534, -24.644310118196316, -12.087882131416041, 6.5268049405659685, 0.2482002834876793, -2.83813201757504, -53.819443739166005, -48.05533475362776, -0.3569101065840652, 40.862719181654334, -6.910830874841174, -3.613484242994314, -30.359365265047536, -52.31335896626038, -34.623954083244044, -32.413198240086714, -5.481580072645322, 12.038637003914221, 9.371267292515208, 10.581987529319239, -31.629475080458974, -30.965716691420695, -37.352041294354066, -26.32753572338285, 1.307457408872427, -1.2634021385060823, -16.78193614083834, 18.803114167921166, -42.88236144358549, -38.72007127835474, 28.84685648217755, 1.0004507412023642, -26.395399482763317, -36.85567169071445, -16.330768809040293, -22.75018833043655, -40.55638092047018, -47.20658192305267, 9.46861733242531, -2.0760216650101206, -41.26784181779551, -43.06622820007295, -43.832157803979925, -39.30572398490767, -5.670716279431183, -32.26597888611623, -14.476252165460249, -28.170750273399804, -20.67114234394163, -14.362245324223995, -29.216989893279568, -42.699708310183276, -35.24277158268436, 2.1610927581950854, -16.27997685362704, -17.76642670168134, -12.667052844895991, -6.363871413112463, -28.146353334496, -42.16918061619704, -1.0066017772539055, -24.669213816891613, -10.687929455676539, -28.107705915110586, -23.644282777078768, -27.12272543164478, -5.274872382930823, 4.836855956429414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320184045022048, "mean_inference_ms": 1.5115007104607807, "mean_action_processing_ms": 0.2438037821317726, "mean_env_wait_ms": 0.10185128414698913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00455319881439209, "StateBufferConnector_ms": 0.0026426315307617188, "ViewRequirementAgentConnector_ms": 0.07569301128387451}, "num_episodes": 11, "episode_return_max": 28.48436052166445, "episode_return_min": -53.73053806669691, "episode_return_mean": -10.295082103431648}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 523.5899400745811, "num_env_steps_trained_throughput_per_sec": 523.5899400745811, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 8554.936, "restore_workers_time_ms": 0.041, "training_step_time_ms": 8554.804, "sample_time_ms": 1006.402, "learn_time_ms": 7533.81, "learn_throughput": 530.94, "synch_weights_time_ms": 13.451}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 10, "trial_id": "017ef_00000", "date": "2024-08-10_12-11-46", "timestamp": 1723306306, "time_this_iter_s": 7.642529010772705, "time_total_s": 85.74533009529114, "pid": 63420, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a44a2430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 85.74533009529114, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.279999999999994, "ram_util_percent": 80.96}}
